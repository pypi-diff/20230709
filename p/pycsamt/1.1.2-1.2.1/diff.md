# Comparing `tmp/pycsamt-1.1.2.tar.gz` & `tmp/pycsamt-1.2.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pycsamt-1.1.2.tar", last modified: Wed Apr 13 09:12:30 2022, max compression
+gzip compressed data, was "pycsamt-1.2.1.tar", last modified: Sun Jul  9 08:03:01 2023, max compression
```

## Comparing `pycsamt-1.1.2.tar` & `pycsamt-1.2.1.tar`

### file list

```diff
@@ -1,125 +1,130 @@
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:30.096122 pycsamt-1.1.2/
--rw-rw-rw-   0        0        0     7652 2021-02-25 04:44:19.000000 pycsamt-1.1.2/COPYING.LESSER
--rw-rw-rw-   0        0        0    35149 2021-02-25 04:46:39.000000 pycsamt-1.1.2/LICENSE.md
--rw-rw-rw-   0        0        0      408 2022-03-12 08:00:43.000000 pycsamt-1.1.2/MANIFEST.in
--rw-rw-rw-   0        0        0     7063 2022-04-13 09:12:30.095129 pycsamt-1.1.2/PKG-INFO
--rw-rw-rw-   0        0        0    12120 2022-04-13 08:49:50.000000 pycsamt-1.1.2/README.md
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.519137 pycsamt-1.1.2/docs/
--rw-rw-rw-   0        0        0      634 2021-04-08 06:17:27.000000 pycsamt-1.1.2/docs/Makefile
--rw-rw-rw-   0        0        0     8794 2021-04-08 08:17:36.000000 pycsamt-1.1.2/docs/index.html
--rwxrwxrwx   0        0        0      795 2021-04-08 06:17:27.000000 pycsamt-1.1.2/docs/make.bat
--rw-rw-rw-   0        0        0  2844535 2022-04-13 01:49:08.000000 pycsamt-1.1.2/docs/pyCSAMT User Guide.pdf
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.635808 pycsamt-1.1.2/docs/source/
--rw-rw-rw-   0        0        0     6264 2022-03-12 08:20:35.000000 pycsamt-1.1.2/docs/source/conf.py
--rw-rw-rw-   0        0        0      616 2022-03-12 08:06:59.000000 pycsamt-1.1.2/docs/source/csamt.rst
--rw-rw-rw-   0        0        0      439 2022-03-12 08:00:43.000000 pycsamt-1.1.2/docs/source/geocore.rst
--rw-rw-rw-   0        0        0      387 2022-03-12 08:00:43.000000 pycsamt-1.1.2/docs/source/geodb.rst
--rw-rw-rw-   0        0        0      547 2022-03-12 08:05:04.000000 pycsamt-1.1.2/docs/source/index.rst
--rw-rw-rw-   0        0        0      169 2021-04-07 14:38:27.000000 pycsamt-1.1.2/docs/source/modeling.rst
--rw-rw-rw-   0        0        0      212 2022-03-12 08:00:43.000000 pycsamt-1.1.2/docs/source/processing.rst
--rw-rw-rw-   0        0        0      929 2022-03-12 08:06:06.000000 pycsamt-1.1.2/docs/source/utils.rst
--rw-rw-rw-   0        0        0      203 2021-04-08 04:30:02.000000 pycsamt-1.1.2/docs/source/viewer.rst
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.637810 pycsamt-1.1.2/pycsamt/
--rw-rw-rw-   0        0        0     3009 2022-04-13 09:03:10.000000 pycsamt-1.1.2/pycsamt/__init__.py
--rw-rw-rw-   0        0        0        0 2022-04-12 08:04:07.000000 pycsamt-1.1.2/pycsamt/__main__.py
--rw-rw-rw-   0        0        0    25657 2022-04-11 02:06:10.000000 pycsamt-1.1.2/pycsamt/bases.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.778590 pycsamt-1.1.2/pycsamt/cli/
--rw-rw-rw-   0        0        0     1113 2022-04-07 12:36:03.000000 pycsamt-1.1.2/pycsamt/cli/__init__.py
--rw-rw-rw-   0        0        0     1896 2022-04-12 11:49:59.000000 pycsamt-1.1.2/pycsamt/cli/avg2edi.py
--rw-rw-rw-   0        0        0     5105 2022-04-13 02:55:35.000000 pycsamt-1.1.2/pycsamt/cli/correctedi.py
--rw-rw-rw-   0        0        0     3432 2022-04-12 11:52:16.000000 pycsamt-1.1.2/pycsamt/cli/fitforward.py
--rw-rw-rw-   0        0        0     1451 2022-04-12 11:53:31.000000 pycsamt-1.1.2/pycsamt/cli/j2edi.py
--rw-rw-rw-   0        0        0     1586 2022-04-08 07:25:49.000000 pycsamt-1.1.2/pycsamt/cli/misfit2d.py
--rw-rw-rw-   0        0        0     3495 2022-04-12 12:03:58.000000 pycsamt-1.1.2/pycsamt/cli/myconfigfile.py
--rw-rw-rw-   0        0        0     8380 2022-04-13 05:46:42.000000 pycsamt-1.1.2/pycsamt/cli/nm.py
--rw-rw-rw-   0        0        0     9978 2022-04-12 11:47:56.000000 pycsamt-1.1.2/pycsamt/cli/occambuildinputs.py
--rw-rw-rw-   0        0        0     3788 2022-04-12 12:08:58.000000 pycsamt-1.1.2/pycsamt/cli/penetration1d.py
--rw-rw-rw-   0        0        0     3152 2022-04-12 12:09:47.000000 pycsamt-1.1.2/pycsamt/cli/penetration2d.py
--rw-rw-rw-   0        0        0     4430 2022-04-12 12:10:07.000000 pycsamt-1.1.2/pycsamt/cli/pseudocrossresistivityandphase.py
--rw-rw-rw-   0        0        0     2736 2022-04-12 12:10:21.000000 pycsamt-1.1.2/pycsamt/cli/pseudostratigraphic.py
--rw-rw-rw-   0        0        0     3296 2022-04-12 12:10:36.000000 pycsamt-1.1.2/pycsamt/cli/rewriteedi.py
--rw-rw-rw-   0        0        0     2260 2022-04-12 12:10:54.000000 pycsamt-1.1.2/pycsamt/cli/rms.py
--rw-rw-rw-   0        0        0     8177 2022-04-12 12:11:08.000000 pycsamt-1.1.2/pycsamt/cli/staticshift.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.815627 pycsamt-1.1.2/pycsamt/ff/
--rw-rw-rw-   0        0        0        6 2021-11-18 13:18:03.000000 pycsamt-1.1.2/pycsamt/ff/__init__.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.854794 pycsamt-1.1.2/pycsamt/ff/core/
--rw-rw-rw-   0        0        0       21 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/ff/core/__init__.py
--rw-rw-rw-   0        0        0   204050 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/ff/core/avg.py
--rw-rw-rw-   0        0        0    60361 2022-04-08 06:04:20.000000 pycsamt-1.1.2/pycsamt/ff/core/cs.py
--rw-rw-rw-   0        0        0   133603 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/ff/core/edi.py
--rw-rw-rw-   0        0        0    58810 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/ff/core/j.py
--rw-rw-rw-   0        0        0    58807 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/ff/core/z.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.860803 pycsamt-1.1.2/pycsamt/ff/processing/
--rw-rw-rw-   0        0        0       45 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/ff/processing/__init__.py
--rw-rw-rw-   0        0        0    84429 2022-04-12 00:36:16.000000 pycsamt-1.1.2/pycsamt/ff/processing/corr.py
--rw-rw-rw-   0        0        0    74777 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/ff/site.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.922426 pycsamt-1.1.2/pycsamt/geodrill/
--rw-rw-rw-   0        0        0        4 2021-10-25 06:58:12.000000 pycsamt-1.1.2/pycsamt/geodrill/__init__.py
--rw-rw-rw-   0        0        0     3462 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/_dictapp.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.933169 pycsamt-1.1.2/pycsamt/geodrill/_geocodes/
--rw-rw-rw-   0        0        0     5711 2020-02-07 15:43:00.000000 pycsamt-1.1.2/pycsamt/geodrill/_geocodes/AGSO.csv
--rw-rw-rw-   0        0        0      351 2020-09-28 06:38:30.000000 pycsamt-1.1.2/pycsamt/geodrill/_geocodes/AGSO_STCODES.csv
--rw-rw-rw-   0        0        0   811233 2022-04-13 01:04:39.000000 pycsamt-1.1.2/pycsamt/geodrill/_geocodes/__memory.pkl
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.983225 pycsamt-1.1.2/pycsamt/geodrill/_geomemo/
--rw-rw-rw-   0        0        0    49152 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/_geomemo/__m.sq3
--rw-rw-rw-   0        0        0    28672 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/_geomemo/memory.sq3
--rw-rw-rw-   0        0        0   232342 2022-04-11 07:25:42.000000 pycsamt-1.1.2/pycsamt/geodrill/geocore.py
--rw-rw-rw-   0        0        0    70294 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/geodatabase.py
--rw-rw-rw-   0        0        0     3726 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/ml.py
--rw-rw-rw-   0        0        0    14172 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/requestmanager.py
--rw-rw-rw-   0        0        0    12316 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/strata.py
--rw-rw-rw-   0        0        0    32032 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/structural.py
--rw-rw-rw-   0        0        0     4536 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/geodrill/update_upgrade_geoDataBase.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:30.023858 pycsamt-1.1.2/pycsamt/gui/
--rw-rw-rw-   0        0        0        0 2021-04-06 08:12:40.000000 pycsamt-1.1.2/pycsamt/gui/__init__.py
--rw-rw-rw-   0        0        0     1908 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/cmake_dh.py
--rw-rw-rw-   0        0        0     3308 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/corrected_edi.py
--rw-rw-rw-   0        0        0     4019 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/gs2f.py
--rw-rw-rw-   0        0        0     8279 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/gui_avgapp.py
--rw-rw-rw-   0        0        0    17588 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/gui_frames.py
--rw-rw-rw-   0        0        0     2234 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/maingui.py
--rw-rw-rw-   0        0        0     4181 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/oas2f.py
--rw-rw-rw-   0        0        0     4525 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/oc2d_bdin.py
--rw-rw-rw-   0        0        0     4558 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/p2log.py
--rw-rw-rw-   0        0        0     2573 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/p_moc2d.py
--rw-rw-rw-   0        0        0     1848 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/personal_frames.py
--rw-rw-rw-   0        0        0     1937 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/wa2edi.py
--rw-rw-rw-   0        0        0     2196 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/wa2j.py
--rw-rw-rw-   0        0        0     2890 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/wi2d.py
--rw-rw-rw-   0        0        0     5886 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/wrap_console_scripts.py
--rw-rw-rw-   0        0        0     2198 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/gui/write_avg2j.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:30.025860 pycsamt-1.1.2/pycsamt/metadata/
--rw-rw-rw-   0        0        0      497 2022-04-08 09:27:13.000000 pycsamt-1.1.2/pycsamt/metadata/e.g.data.json
--rw-rw-rw-   0        0        0      366 2022-04-08 09:29:50.000000 pycsamt-1.1.2/pycsamt/metadata/e.g.data.yml
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:30.028863 pycsamt-1.1.2/pycsamt/modeling/
--rw-rw-rw-   0        0        0     1165 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/modeling/__init__.py
--rw-rw-rw-   0        0        0   146316 2022-04-12 05:38:20.000000 pycsamt-1.1.2/pycsamt/modeling/occam2d.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:30.078076 pycsamt-1.1.2/pycsamt/utils/
--rw-rw-rw-   0        0        0     2040 2022-04-12 09:07:20.000000 pycsamt-1.1.2/pycsamt/utils/__init__.py
--rw-rw-rw-   0        0        0    10447 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/_csamtpylog.py
--rw-rw-rw-   0        0        0    29717 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/_p.py
--rw-rw-rw-   0        0        0    38514 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/avg_utils.py
--rw-rw-rw-   0        0        0     8938 2022-04-12 11:47:30.000000 pycsamt-1.1.2/pycsamt/utils/decorator.py
--rw-rw-rw-   0        0        0     2631 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/exceptions.py
--rw-rw-rw-   0        0        0   106989 2022-04-07 12:36:13.000000 pycsamt-1.1.2/pycsamt/utils/func_utils.py
--rw-rw-rw-   0        0        0    62116 2022-04-11 09:27:03.000000 pycsamt-1.1.2/pycsamt/utils/geo_utils.py
--rw-rw-rw-   0        0        0    36639 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/gis_tools.py
--rw-rw-rw-   0        0        0    11978 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/ml_utils.py
--rw-rw-rw-   0        0        0    24419 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/mtcalculator.py
--rw-rw-rw-   0        0        0     1599 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/p.configlog.yml
--rw-rw-rw-   0        0        0    70860 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/plot_utils.py
--rw-rw-rw-   0        0        0    55908 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/plotdecorator.py
--rw-rw-rw-   0        0        0    82535 2022-03-12 08:00:44.000000 pycsamt-1.1.2/pycsamt/utils/zcalculator.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:30.093101 pycsamt-1.1.2/pycsamt/viewer/
--rw-rw-rw-   0        0        0       42 2021-10-25 06:58:12.000000 pycsamt-1.1.2/pycsamt/viewer/__init__.py
--rw-rw-rw-   0        0        0   228329 2022-04-12 02:04:06.000000 pycsamt-1.1.2/pycsamt/viewer/plot.py
-drwxrwxrwx   0        0        0        0 2022-04-13 09:12:29.648827 pycsamt-1.1.2/pycsamt.egg-info/
--rw-rw-rw-   0        0        0     7063 2022-04-13 09:12:29.000000 pycsamt-1.1.2/pycsamt.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     2743 2022-04-13 09:12:29.000000 pycsamt-1.1.2/pycsamt.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2022-04-13 09:12:29.000000 pycsamt-1.1.2/pycsamt.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0     1091 2022-04-13 09:12:29.000000 pycsamt-1.1.2/pycsamt.egg-info/entry_points.txt
--rw-rw-rw-   0        0        0       82 2022-04-13 09:12:29.000000 pycsamt-1.1.2/pycsamt.egg-info/requires.txt
--rw-rw-rw-   0        0        0        8 2022-04-13 09:12:29.000000 pycsamt-1.1.2/pycsamt.egg-info/top_level.txt
--rw-rw-rw-   0        0        0      108 2021-10-25 06:58:12.000000 pycsamt-1.1.2/pyproject.toml
--rw-rw-rw-   0        0        0       42 2022-04-13 09:12:30.096122 pycsamt-1.1.2/setup.cfg
--rw-rw-rw-   0        0        0     8093 2022-04-12 12:04:54.000000 pycsamt-1.1.2/setup.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.260293 pycsamt-1.2.1/
+-rw-rw-rw-   0        0        0    35823 2023-07-03 11:27:24.000000 pycsamt-1.2.1/LICENSE.md
+-rw-rw-rw-   0        0        0      408 2023-07-03 11:27:24.000000 pycsamt-1.2.1/MANIFEST.in
+-rw-rw-rw-   0        0        0     7297 2023-07-09 08:03:01.259293 pycsamt-1.2.1/PKG-INFO
+-rw-rw-rw-   0        0        0     5874 2023-07-09 07:55:29.000000 pycsamt-1.2.1/README.md
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.212777 pycsamt-1.2.1/docs/
+-rw-rw-rw-   0        0        0      658 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/Makefile
+-rw-rw-rw-   0        0        0    10550 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/index.html
+-rwxrwxrwx   0        0        0      804 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/make.bat
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.218776 pycsamt-1.2.1/docs/source/
+-rw-rw-rw-   0        0        0     6562 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/conf.py
+-rw-rw-rw-   0        0        0      597 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/core.rst
+-rw-rw-rw-   0        0        0     7739 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/demo.rst
+-rw-rw-rw-   0        0        0      439 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/geocore.rst
+-rw-rw-rw-   0        0        0      387 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/geodb.rst
+-rw-rw-rw-   0        0        0      554 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/index.rst
+-rw-rw-rw-   0        0        0     1951 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/installation.rst
+-rw-rw-rw-   0        0        0      380 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/macros.hrst
+-rw-rw-rw-   0        0        0      260 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/modeling.rst
+-rw-rw-rw-   0        0        0      313 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/processing.rst
+-rw-rw-rw-   0        0        0      949 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/utils.rst
+-rw-rw-rw-   0        0        0      198 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/source/view.rst
+-rw-rw-rw-   0        0        0  2844535 2023-07-03 11:27:24.000000 pycsamt-1.2.1/docs/user_guide.pdf
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.220813 pycsamt-1.2.1/pycsamt/
+-rw-rw-rw-   0        0        0     7870 2023-07-09 07:54:36.000000 pycsamt-1.2.1/pycsamt/__init__.py
+-rw-rw-rw-   0        0        0        0 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/__main__.py
+-rw-rw-rw-   0        0        0    10447 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/_csamtpylog.py
+-rw-rw-rw-   0        0        0     1143 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/_path.py
+-rw-rw-rw-   0        0        0    25649 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/bases.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.231895 pycsamt-1.2.1/pycsamt/cli/
+-rw-rw-rw-   0        0        0     1113 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/__init__.py
+-rw-rw-rw-   0        0        0     1893 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/avg2edi.py
+-rw-rw-rw-   0        0        0     5102 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/correctedi.py
+-rw-rw-rw-   0        0        0     3432 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/fitforward.py
+-rw-rw-rw-   0        0        0     1448 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/j2edi.py
+-rw-rw-rw-   0        0        0     1586 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/misfit2d.py
+-rw-rw-rw-   0        0        0     3495 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/myconfigfile.py
+-rw-rw-rw-   0        0        0     8380 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/nm.py
+-rw-rw-rw-   0        0        0    10059 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/occambuildinputs.py
+-rw-rw-rw-   0        0        0     3786 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/penetration1d.py
+-rw-rw-rw-   0        0        0     3150 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/penetration2d.py
+-rw-rw-rw-   0        0        0     4428 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/pseudocrossresistivityandphase.py
+-rw-rw-rw-   0        0        0     2736 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/pseudostratigraphic.py
+-rw-rw-rw-   0        0        0     3293 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/rewriteedi.py
+-rw-rw-rw-   0        0        0     2258 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/rms.py
+-rw-rw-rw-   0        0        0     8175 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/cli/staticshift.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.235988 pycsamt-1.2.1/pycsamt/core/
+-rw-rw-rw-   0        0        0      552 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/core/__init__.py
+-rw-rw-rw-   0        0        0   201885 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/core/avg.py
+-rw-rw-rw-   0        0        0    63103 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/core/cs.py
+-rw-rw-rw-   0        0        0   152210 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/core/edi.py
+-rw-rw-rw-   0        0        0    58457 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/core/j.py
+-rw-rw-rw-   0        0        0     1906 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/core/wfem.py
+-rw-rw-rw-   0        0        0    58655 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/core/z.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.240687 pycsamt-1.2.1/pycsamt/geodrill/
+-rw-rw-rw-   0        0        0      504 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/geodrill/__init__.py
+-rw-rw-rw-   0        0        0     3462 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/geodrill/_dictapp.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.241686 pycsamt-1.2.1/pycsamt/geodrill/_geocodes/
+-rw-rw-rw-   0        0        0     5711 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/geodrill/_geocodes/AGSO.csv
+-rw-rw-rw-   0        0        0      351 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/geodrill/_geocodes/AGSO_STCODES.csv
+-rw-rw-rw-   0        0        0   811233 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/geodrill/_geocodes/__memory.pkl
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.242697 pycsamt-1.2.1/pycsamt/geodrill/_geomemo/
+-rw-rw-rw-   0        0        0    49152 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/geodrill/_geomemo/__m.sq3
+-rw-rw-rw-   0        0        0    28672 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/geodrill/_geomemo/memory.sq3
+-rw-rw-rw-   0        0        0   231753 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/geodrill/geocore.py
+-rw-rw-rw-   0        0        0    69682 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/geodrill/geodatabase.py
+-rw-rw-rw-   0        0        0     3720 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/geodrill/ml.py
+-rw-rw-rw-   0        0        0    14166 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/geodrill/requestmanager.py
+-rw-rw-rw-   0        0        0    12279 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/geodrill/strata.py
+-rw-rw-rw-   0        0        0    31976 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/geodrill/structural.py
+-rw-rw-rw-   0        0        0     4536 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/geodrill/update_upgrade_geoDataBase.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.249213 pycsamt-1.2.1/pycsamt/gui/
+-rw-rw-rw-   0        0        0        0 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/__init__.py
+-rw-rw-rw-   0        0        0     1908 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/cmake_dh.py
+-rw-rw-rw-   0        0        0     3308 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/corrected_edi.py
+-rw-rw-rw-   0        0        0     4019 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/gs2f.py
+-rw-rw-rw-   0        0        0     8279 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/gui_avgapp.py
+-rw-rw-rw-   0        0        0    17588 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/gui_frames.py
+-rw-rw-rw-   0        0        0     2234 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/maingui.py
+-rw-rw-rw-   0        0        0     4181 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/oas2f.py
+-rw-rw-rw-   0        0        0     4525 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/oc2d_bdin.py
+-rw-rw-rw-   0        0        0     4558 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/p2log.py
+-rw-rw-rw-   0        0        0     2573 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/p_moc2d.py
+-rw-rw-rw-   0        0        0     1848 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/personal_frames.py
+-rw-rw-rw-   0        0        0     1937 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/wa2edi.py
+-rw-rw-rw-   0        0        0     2196 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/wa2j.py
+-rw-rw-rw-   0        0        0     2890 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/wi2d.py
+-rw-rw-rw-   0        0        0     5886 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/wrap_console_scripts.py
+-rw-rw-rw-   0        0        0     2198 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/gui/write_avg2j.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.249213 pycsamt-1.2.1/pycsamt/metadata/
+-rw-rw-rw-   0        0        0      497 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/metadata/e.g.data.json
+-rw-rw-rw-   0        0        0      366 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/metadata/e.g.data.yml
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.250286 pycsamt-1.2.1/pycsamt/modeling/
+-rw-rw-rw-   0        0        0      337 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/modeling/__init__.py
+-rw-rw-rw-   0        0        0    33894 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/modeling/modem.py
+-rw-rw-rw-   0        0        0   147213 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/modeling/occam2d.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.252288 pycsamt-1.2.1/pycsamt/processing/
+-rw-rw-rw-   0        0        0      562 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/processing/__init__.py
+-rw-rw-rw-   0        0        0    96538 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/processing/corr.py
+-rw-rw-rw-   0        0        0   114623 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/processing/ctools.py
+-rw-rw-rw-   0        0        0    74385 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/site.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.257292 pycsamt-1.2.1/pycsamt/utils/
+-rw-rw-rw-   0        0        0      122 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/__init__.py
+-rw-rw-rw-   0        0        0    29435 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/_p.py
+-rw-rw-rw-   0        0        0     2473 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/_set_gdal.py
+-rw-rw-rw-   0        0        0    38510 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/avg_utils.py
+-rw-rw-rw-   0        0        0     9311 2023-07-09 07:33:03.000000 pycsamt-1.2.1/pycsamt/utils/decorator.py
+-rw-rw-rw-   0        0        0     1821 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/exceptions.py
+-rw-rw-rw-   0        0        0   128848 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/func_utils.py
+-rw-rw-rw-   0        0        0    62132 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/geo_utils.py
+-rw-rw-rw-   0        0        0    37472 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/gis_tools.py
+-rw-rw-rw-   0        0        0    11978 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/utils/ml_utils.py
+-rw-rw-rw-   0        0        0    24162 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/mtcalculator.py
+-rw-rw-rw-   0        0        0    72775 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/plot_utils.py
+-rw-rw-rw-   0        0        0    55885 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/plotdecorator.py
+-rw-rw-rw-   0        0        0    81952 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/utils/zcalculator.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.259293 pycsamt-1.2.1/pycsamt/view/
+-rw-rw-rw-   0        0        0      320 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/view/__init__.py
+-rw-rw-rw-   0        0        0    43863 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pycsamt/view/mpl.rcParams_infos.py
+-rw-rw-rw-   0        0        0   291640 2023-07-08 12:26:42.000000 pycsamt-1.2.1/pycsamt/view/plot.py
+drwxrwxrwx   0        0        0        0 2023-07-09 08:03:01.223778 pycsamt-1.2.1/pycsamt.egg-info/
+-rw-rw-rw-   0        0        0     7297 2023-07-09 08:03:01.000000 pycsamt-1.2.1/pycsamt.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     2856 2023-07-09 08:03:01.000000 pycsamt-1.2.1/pycsamt.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-07-09 08:03:01.000000 pycsamt-1.2.1/pycsamt.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0     1092 2023-07-09 08:03:01.000000 pycsamt-1.2.1/pycsamt.egg-info/entry_points.txt
+-rw-rw-rw-   0        0        0       82 2023-07-09 08:03:01.000000 pycsamt-1.2.1/pycsamt.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        8 2023-07-09 08:03:01.000000 pycsamt-1.2.1/pycsamt.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0      108 2023-07-03 11:27:24.000000 pycsamt-1.2.1/pyproject.toml
+-rw-rw-rw-   0        0        0       42 2023-07-09 08:03:01.260293 pycsamt-1.2.1/setup.cfg
+-rw-rw-rw-   0        0        0     6778 2023-07-09 07:52:11.000000 pycsamt-1.2.1/setup.py
```

### Comparing `pycsamt-1.1.2/LICENSE.md` & `pycsamt-1.2.1/LICENSE.md`

 * *Ordering differences only*

 * *Files 7% similar despite different names*

```diff
@@ -1,674 +1,674 @@
-                    GNU GENERAL PUBLIC LICENSE
-                       Version 3, 29 June 2007
-
- Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>
- Everyone is permitted to copy and distribute verbatim copies
- of this license document, but changing it is not allowed.
-
-                            Preamble
-
-  The GNU General Public License is a free, copyleft license for
-software and other kinds of works.
-
-  The licenses for most software and other practical works are designed
-to take away your freedom to share and change the works.  By contrast,
-the GNU General Public License is intended to guarantee your freedom to
-share and change all versions of a program--to make sure it remains free
-software for all its users.  We, the Free Software Foundation, use the
-GNU General Public License for most of our software; it applies also to
-any other work released this way by its authors.  You can apply it to
-your programs, too.
-
-  When we speak of free software, we are referring to freedom, not
-price.  Our General Public Licenses are designed to make sure that you
-have the freedom to distribute copies of free software (and charge for
-them if you wish), that you receive source code or can get it if you
-want it, that you can change the software or use pieces of it in new
-free programs, and that you know you can do these things.
-
-  To protect your rights, we need to prevent others from denying you
-these rights or asking you to surrender the rights.  Therefore, you have
-certain responsibilities if you distribute copies of the software, or if
-you modify it: responsibilities to respect the freedom of others.
-
-  For example, if you distribute copies of such a program, whether
-gratis or for a fee, you must pass on to the recipients the same
-freedoms that you received.  You must make sure that they, too, receive
-or can get the source code.  And you must show them these terms so they
-know their rights.
-
-  Developers that use the GNU GPL protect your rights with two steps:
-(1) assert copyright on the software, and (2) offer you this License
-giving you legal permission to copy, distribute and/or modify it.
-
-  For the developers' and authors' protection, the GPL clearly explains
-that there is no warranty for this free software.  For both users' and
-authors' sake, the GPL requires that modified versions be marked as
-changed, so that their problems will not be attributed erroneously to
-authors of previous versions.
-
-  Some devices are designed to deny users access to install or run
-modified versions of the software inside them, although the manufacturer
-can do so.  This is fundamentally incompatible with the aim of
-protecting users' freedom to change the software.  The systematic
-pattern of such abuse occurs in the area of products for individuals to
-use, which is precisely where it is most unacceptable.  Therefore, we
-have designed this version of the GPL to prohibit the practice for those
-products.  If such problems arise substantially in other domains, we
-stand ready to extend this provision to those domains in future versions
-of the GPL, as needed to protect the freedom of users.
-
-  Finally, every program is threatened constantly by software patents.
-States should not allow patents to restrict development and use of
-software on general-purpose computers, but in those that do, we wish to
-avoid the special danger that patents applied to a free program could
-make it effectively proprietary.  To prevent this, the GPL assures that
-patents cannot be used to render the program non-free.
-
-  The precise terms and conditions for copying, distribution and
-modification follow.
-
-                       TERMS AND CONDITIONS
-
-  0. Definitions.
-
-  "This License" refers to version 3 of the GNU General Public License.
-
-  "Copyright" also means copyright-like laws that apply to other kinds of
-works, such as semiconductor masks.
-
-  "The Program" refers to any copyrightable work licensed under this
-License.  Each licensee is addressed as "you".  "Licensees" and
-"recipients" may be individuals or organizations.
-
-  To "modify" a work means to copy from or adapt all or part of the work
-in a fashion requiring copyright permission, other than the making of an
-exact copy.  The resulting work is called a "modified version" of the
-earlier work or a work "based on" the earlier work.
-
-  A "covered work" means either the unmodified Program or a work based
-on the Program.
-
-  To "propagate" a work means to do anything with it that, without
-permission, would make you directly or secondarily liable for
-infringement under applicable copyright law, except executing it on a
-computer or modifying a private copy.  Propagation includes copying,
-distribution (with or without modification), making available to the
-public, and in some countries other activities as well.
-
-  To "convey" a work means any kind of propagation that enables other
-parties to make or receive copies.  Mere interaction with a user through
-a computer network, with no transfer of a copy, is not conveying.
-
-  An interactive user interface displays "Appropriate Legal Notices"
-to the extent that it includes a convenient and prominently visible
-feature that (1) displays an appropriate copyright notice, and (2)
-tells the user that there is no warranty for the work (except to the
-extent that warranties are provided), that licensees may convey the
-work under this License, and how to view a copy of this License.  If
-the interface presents a list of user commands or options, such as a
-menu, a prominent item in the list meets this criterion.
-
-  1. Source Code.
-
-  The "source code" for a work means the preferred form of the work
-for making modifications to it.  "Object code" means any non-source
-form of a work.
-
-  A "Standard Interface" means an interface that either is an official
-standard defined by a recognized standards body, or, in the case of
-interfaces specified for a particular programming language, one that
-is widely used among developers working in that language.
-
-  The "System Libraries" of an executable work include anything, other
-than the work as a whole, that (a) is included in the normal form of
-packaging a Major Component, but which is not part of that Major
-Component, and (b) serves only to enable use of the work with that
-Major Component, or to implement a Standard Interface for which an
-implementation is available to the public in source code form.  A
-"Major Component", in this context, means a major essential component
-(kernel, window system, and so on) of the specific operating system
-(if any) on which the executable work runs, or a compiler used to
-produce the work, or an object code interpreter used to run it.
-
-  The "Corresponding Source" for a work in object code form means all
-the source code needed to generate, install, and (for an executable
-work) run the object code and to modify the work, including scripts to
-control those activities.  However, it does not include the work's
-System Libraries, or general-purpose tools or generally available free
-programs which are used unmodified in performing those activities but
-which are not part of the work.  For example, Corresponding Source
-includes interface definition files associated with source files for
-the work, and the source code for shared libraries and dynamically
-linked subprograms that the work is specifically designed to require,
-such as by intimate data communication or control flow between those
-subprograms and other parts of the work.
-
-  The Corresponding Source need not include anything that users
-can regenerate automatically from other parts of the Corresponding
-Source.
-
-  The Corresponding Source for a work in source code form is that
-same work.
-
-  2. Basic Permissions.
-
-  All rights granted under this License are granted for the term of
-copyright on the Program, and are irrevocable provided the stated
-conditions are met.  This License explicitly affirms your unlimited
-permission to run the unmodified Program.  The output from running a
-covered work is covered by this License only if the output, given its
-content, constitutes a covered work.  This License acknowledges your
-rights of fair use or other equivalent, as provided by copyright law.
-
-  You may make, run and propagate covered works that you do not
-convey, without conditions so long as your license otherwise remains
-in force.  You may convey covered works to others for the sole purpose
-of having them make modifications exclusively for you, or provide you
-with facilities for running those works, provided that you comply with
-the terms of this License in conveying all material for which you do
-not control copyright.  Those thus making or running the covered works
-for you must do so exclusively on your behalf, under your direction
-and control, on terms that prohibit them from making any copies of
-your copyrighted material outside their relationship with you.
-
-  Conveying under any other circumstances is permitted solely under
-the conditions stated below.  Sublicensing is not allowed; section 10
-makes it unnecessary.
-
-  3. Protecting Users' Legal Rights From Anti-Circumvention Law.
-
-  No covered work shall be deemed part of an effective technological
-measure under any applicable law fulfilling obligations under article
-11 of the WIPO copyright treaty adopted on 20 December 1996, or
-similar laws prohibiting or restricting circumvention of such
-measures.
-
-  When you convey a covered work, you waive any legal power to forbid
-circumvention of technological measures to the extent such circumvention
-is effected by exercising rights under this License with respect to
-the covered work, and you disclaim any intention to limit operation or
-modification of the work as a means of enforcing, against the work's
-users, your or third parties' legal rights to forbid circumvention of
-technological measures.
-
-  4. Conveying Verbatim Copies.
-
-  You may convey verbatim copies of the Program's source code as you
-receive it, in any medium, provided that you conspicuously and
-appropriately publish on each copy an appropriate copyright notice;
-keep intact all notices stating that this License and any
-non-permissive terms added in accord with section 7 apply to the code;
-keep intact all notices of the absence of any warranty; and give all
-recipients a copy of this License along with the Program.
-
-  You may charge any price or no price for each copy that you convey,
-and you may offer support or warranty protection for a fee.
-
-  5. Conveying Modified Source Versions.
-
-  You may convey a work based on the Program, or the modifications to
-produce it from the Program, in the form of source code under the
-terms of section 4, provided that you also meet all of these conditions:
-
-    a) The work must carry prominent notices stating that you modified
-    it, and giving a relevant date.
-
-    b) The work must carry prominent notices stating that it is
-    released under this License and any conditions added under section
-    7.  This requirement modifies the requirement in section 4 to
-    "keep intact all notices".
-
-    c) You must license the entire work, as a whole, under this
-    License to anyone who comes into possession of a copy.  This
-    License will therefore apply, along with any applicable section 7
-    additional terms, to the whole of the work, and all its parts,
-    regardless of how they are packaged.  This License gives no
-    permission to license the work in any other way, but it does not
-    invalidate such permission if you have separately received it.
-
-    d) If the work has interactive user interfaces, each must display
-    Appropriate Legal Notices; however, if the Program has interactive
-    interfaces that do not display Appropriate Legal Notices, your
-    work need not make them do so.
-
-  A compilation of a covered work with other separate and independent
-works, which are not by their nature extensions of the covered work,
-and which are not combined with it such as to form a larger program,
-in or on a volume of a storage or distribution medium, is called an
-"aggregate" if the compilation and its resulting copyright are not
-used to limit the access or legal rights of the compilation's users
-beyond what the individual works permit.  Inclusion of a covered work
-in an aggregate does not cause this License to apply to the other
-parts of the aggregate.
-
-  6. Conveying Non-Source Forms.
-
-  You may convey a covered work in object code form under the terms
-of sections 4 and 5, provided that you also convey the
-machine-readable Corresponding Source under the terms of this License,
-in one of these ways:
-
-    a) Convey the object code in, or embodied in, a physical product
-    (including a physical distribution medium), accompanied by the
-    Corresponding Source fixed on a durable physical medium
-    customarily used for software interchange.
-
-    b) Convey the object code in, or embodied in, a physical product
-    (including a physical distribution medium), accompanied by a
-    written offer, valid for at least three years and valid for as
-    long as you offer spare parts or customer support for that product
-    model, to give anyone who possesses the object code either (1) a
-    copy of the Corresponding Source for all the software in the
-    product that is covered by this License, on a durable physical
-    medium customarily used for software interchange, for a price no
-    more than your reasonable cost of physically performing this
-    conveying of source, or (2) access to copy the
-    Corresponding Source from a network server at no charge.
-
-    c) Convey individual copies of the object code with a copy of the
-    written offer to provide the Corresponding Source.  This
-    alternative is allowed only occasionally and noncommercially, and
-    only if you received the object code with such an offer, in accord
-    with subsection 6b.
-
-    d) Convey the object code by offering access from a designated
-    place (gratis or for a charge), and offer equivalent access to the
-    Corresponding Source in the same way through the same place at no
-    further charge.  You need not require recipients to copy the
-    Corresponding Source along with the object code.  If the place to
-    copy the object code is a network server, the Corresponding Source
-    may be on a different server (operated by you or a third party)
-    that supports equivalent copying facilities, provided you maintain
-    clear directions next to the object code saying where to find the
-    Corresponding Source.  Regardless of what server hosts the
-    Corresponding Source, you remain obligated to ensure that it is
-    available for as long as needed to satisfy these requirements.
-
-    e) Convey the object code using peer-to-peer transmission, provided
-    you inform other peers where the object code and Corresponding
-    Source of the work are being offered to the general public at no
-    charge under subsection 6d.
-
-  A separable portion of the object code, whose source code is excluded
-from the Corresponding Source as a System Library, need not be
-included in conveying the object code work.
-
-  A "User Product" is either (1) a "consumer product", which means any
-tangible personal property which is normally used for personal, family,
-or household purposes, or (2) anything designed or sold for incorporation
-into a dwelling.  In determining whether a product is a consumer product,
-doubtful cases shall be resolved in favor of coverage.  For a particular
-product received by a particular user, "normally used" refers to a
-typical or common use of that class of product, regardless of the status
-of the particular user or of the way in which the particular user
-actually uses, or expects or is expected to use, the product.  A product
-is a consumer product regardless of whether the product has substantial
-commercial, industrial or non-consumer uses, unless such uses represent
-the only significant mode of use of the product.
-
-  "Installation Information" for a User Product means any methods,
-procedures, authorization keys, or other information required to install
-and execute modified versions of a covered work in that User Product from
-a modified version of its Corresponding Source.  The information must
-suffice to ensure that the continued functioning of the modified object
-code is in no case prevented or interfered with solely because
-modification has been made.
-
-  If you convey an object code work under this section in, or with, or
-specifically for use in, a User Product, and the conveying occurs as
-part of a transaction in which the right of possession and use of the
-User Product is transferred to the recipient in perpetuity or for a
-fixed term (regardless of how the transaction is characterized), the
-Corresponding Source conveyed under this section must be accompanied
-by the Installation Information.  But this requirement does not apply
-if neither you nor any third party retains the ability to install
-modified object code on the User Product (for example, the work has
-been installed in ROM).
-
-  The requirement to provide Installation Information does not include a
-requirement to continue to provide support service, warranty, or updates
-for a work that has been modified or installed by the recipient, or for
-the User Product in which it has been modified or installed.  Access to a
-network may be denied when the modification itself materially and
-adversely affects the operation of the network or violates the rules and
-protocols for communication across the network.
-
-  Corresponding Source conveyed, and Installation Information provided,
-in accord with this section must be in a format that is publicly
-documented (and with an implementation available to the public in
-source code form), and must require no special password or key for
-unpacking, reading or copying.
-
-  7. Additional Terms.
-
-  "Additional permissions" are terms that supplement the terms of this
-License by making exceptions from one or more of its conditions.
-Additional permissions that are applicable to the entire Program shall
-be treated as though they were included in this License, to the extent
-that they are valid under applicable law.  If additional permissions
-apply only to part of the Program, that part may be used separately
-under those permissions, but the entire Program remains governed by
-this License without regard to the additional permissions.
-
-  When you convey a copy of a covered work, you may at your option
-remove any additional permissions from that copy, or from any part of
-it.  (Additional permissions may be written to require their own
-removal in certain cases when you modify the work.)  You may place
-additional permissions on material, added by you to a covered work,
-for which you have or can give appropriate copyright permission.
-
-  Notwithstanding any other provision of this License, for material you
-add to a covered work, you may (if authorized by the copyright holders of
-that material) supplement the terms of this License with terms:
-
-    a) Disclaiming warranty or limiting liability differently from the
-    terms of sections 15 and 16 of this License; or
-
-    b) Requiring preservation of specified reasonable legal notices or
-    author attributions in that material or in the Appropriate Legal
-    Notices displayed by works containing it; or
-
-    c) Prohibiting misrepresentation of the origin of that material, or
-    requiring that modified versions of such material be marked in
-    reasonable ways as different from the original version; or
-
-    d) Limiting the use for publicity purposes of names of licensors or
-    authors of the material; or
-
-    e) Declining to grant rights under trademark law for use of some
-    trade names, trademarks, or service marks; or
-
-    f) Requiring indemnification of licensors and authors of that
-    material by anyone who conveys the material (or modified versions of
-    it) with contractual assumptions of liability to the recipient, for
-    any liability that these contractual assumptions directly impose on
-    those licensors and authors.
-
-  All other non-permissive additional terms are considered "further
-restrictions" within the meaning of section 10.  If the Program as you
-received it, or any part of it, contains a notice stating that it is
-governed by this License along with a term that is a further
-restriction, you may remove that term.  If a license document contains
-a further restriction but permits relicensing or conveying under this
-License, you may add to a covered work material governed by the terms
-of that license document, provided that the further restriction does
-not survive such relicensing or conveying.
-
-  If you add terms to a covered work in accord with this section, you
-must place, in the relevant source files, a statement of the
-additional terms that apply to those files, or a notice indicating
-where to find the applicable terms.
-
-  Additional terms, permissive or non-permissive, may be stated in the
-form of a separately written license, or stated as exceptions;
-the above requirements apply either way.
-
-  8. Termination.
-
-  You may not propagate or modify a covered work except as expressly
-provided under this License.  Any attempt otherwise to propagate or
-modify it is void, and will automatically terminate your rights under
-this License (including any patent licenses granted under the third
-paragraph of section 11).
-
-  However, if you cease all violation of this License, then your
-license from a particular copyright holder is reinstated (a)
-provisionally, unless and until the copyright holder explicitly and
-finally terminates your license, and (b) permanently, if the copyright
-holder fails to notify you of the violation by some reasonable means
-prior to 60 days after the cessation.
-
-  Moreover, your license from a particular copyright holder is
-reinstated permanently if the copyright holder notifies you of the
-violation by some reasonable means, this is the first time you have
-received notice of violation of this License (for any work) from that
-copyright holder, and you cure the violation prior to 30 days after
-your receipt of the notice.
-
-  Termination of your rights under this section does not terminate the
-licenses of parties who have received copies or rights from you under
-this License.  If your rights have been terminated and not permanently
-reinstated, you do not qualify to receive new licenses for the same
-material under section 10.
-
-  9. Acceptance Not Required for Having Copies.
-
-  You are not required to accept this License in order to receive or
-run a copy of the Program.  Ancillary propagation of a covered work
-occurring solely as a consequence of using peer-to-peer transmission
-to receive a copy likewise does not require acceptance.  However,
-nothing other than this License grants you permission to propagate or
-modify any covered work.  These actions infringe copyright if you do
-not accept this License.  Therefore, by modifying or propagating a
-covered work, you indicate your acceptance of this License to do so.
-
-  10. Automatic Licensing of Downstream Recipients.
-
-  Each time you convey a covered work, the recipient automatically
-receives a license from the original licensors, to run, modify and
-propagate that work, subject to this License.  You are not responsible
-for enforcing compliance by third parties with this License.
-
-  An "entity transaction" is a transaction transferring control of an
-organization, or substantially all assets of one, or subdividing an
-organization, or merging organizations.  If propagation of a covered
-work results from an entity transaction, each party to that
-transaction who receives a copy of the work also receives whatever
-licenses to the work the party's predecessor in interest had or could
-give under the previous paragraph, plus a right to possession of the
-Corresponding Source of the work from the predecessor in interest, if
-the predecessor has it or can get it with reasonable efforts.
-
-  You may not impose any further restrictions on the exercise of the
-rights granted or affirmed under this License.  For example, you may
-not impose a license fee, royalty, or other charge for exercise of
-rights granted under this License, and you may not initiate litigation
-(including a cross-claim or counterclaim in a lawsuit) alleging that
-any patent claim is infringed by making, using, selling, offering for
-sale, or importing the Program or any portion of it.
-
-  11. Patents.
-
-  A "contributor" is a copyright holder who authorizes use under this
-License of the Program or a work on which the Program is based.  The
-work thus licensed is called the contributor's "contributor version".
-
-  A contributor's "essential patent claims" are all patent claims
-owned or controlled by the contributor, whether already acquired or
-hereafter acquired, that would be infringed by some manner, permitted
-by this License, of making, using, or selling its contributor version,
-but do not include claims that would be infringed only as a
-consequence of further modification of the contributor version.  For
-purposes of this definition, "control" includes the right to grant
-patent sublicenses in a manner consistent with the requirements of
-this License.
-
-  Each contributor grants you a non-exclusive, worldwide, royalty-free
-patent license under the contributor's essential patent claims, to
-make, use, sell, offer for sale, import and otherwise run, modify and
-propagate the contents of its contributor version.
-
-  In the following three paragraphs, a "patent license" is any express
-agreement or commitment, however denominated, not to enforce a patent
-(such as an express permission to practice a patent or covenant not to
-sue for patent infringement).  To "grant" such a patent license to a
-party means to make such an agreement or commitment not to enforce a
-patent against the party.
-
-  If you convey a covered work, knowingly relying on a patent license,
-and the Corresponding Source of the work is not available for anyone
-to copy, free of charge and under the terms of this License, through a
-publicly available network server or other readily accessible means,
-then you must either (1) cause the Corresponding Source to be so
-available, or (2) arrange to deprive yourself of the benefit of the
-patent license for this particular work, or (3) arrange, in a manner
-consistent with the requirements of this License, to extend the patent
-license to downstream recipients.  "Knowingly relying" means you have
-actual knowledge that, but for the patent license, your conveying the
-covered work in a country, or your recipient's use of the covered work
-in a country, would infringe one or more identifiable patents in that
-country that you have reason to believe are valid.
-
-  If, pursuant to or in connection with a single transaction or
-arrangement, you convey, or propagate by procuring conveyance of, a
-covered work, and grant a patent license to some of the parties
-receiving the covered work authorizing them to use, propagate, modify
-or convey a specific copy of the covered work, then the patent license
-you grant is automatically extended to all recipients of the covered
-work and works based on it.
-
-  A patent license is "discriminatory" if it does not include within
-the scope of its coverage, prohibits the exercise of, or is
-conditioned on the non-exercise of one or more of the rights that are
-specifically granted under this License.  You may not convey a covered
-work if you are a party to an arrangement with a third party that is
-in the business of distributing software, under which you make payment
-to the third party based on the extent of your activity of conveying
-the work, and under which the third party grants, to any of the
-parties who would receive the covered work from you, a discriminatory
-patent license (a) in connection with copies of the covered work
-conveyed by you (or copies made from those copies), or (b) primarily
-for and in connection with specific products or compilations that
-contain the covered work, unless you entered into that arrangement,
-or that patent license was granted, prior to 28 March 2007.
-
-  Nothing in this License shall be construed as excluding or limiting
-any implied license or other defenses to infringement that may
-otherwise be available to you under applicable patent law.
-
-  12. No Surrender of Others' Freedom.
-
-  If conditions are imposed on you (whether by court order, agreement or
-otherwise) that contradict the conditions of this License, they do not
-excuse you from the conditions of this License.  If you cannot convey a
-covered work so as to satisfy simultaneously your obligations under this
-License and any other pertinent obligations, then as a consequence you may
-not convey it at all.  For example, if you agree to terms that obligate you
-to collect a royalty for further conveying from those to whom you convey
-the Program, the only way you could satisfy both those terms and this
-License would be to refrain entirely from conveying the Program.
-
-  13. Use with the GNU Affero General Public License.
-
-  Notwithstanding any other provision of this License, you have
-permission to link or combine any covered work with a work licensed
-under version 3 of the GNU Affero General Public License into a single
-combined work, and to convey the resulting work.  The terms of this
-License will continue to apply to the part which is the covered work,
-but the special requirements of the GNU Affero General Public License,
-section 13, concerning interaction through a network will apply to the
-combination as such.
-
-  14. Revised Versions of this License.
-
-  The Free Software Foundation may publish revised and/or new versions of
-the GNU General Public License from time to time.  Such new versions will
-be similar in spirit to the present version, but may differ in detail to
-address new problems or concerns.
-
-  Each version is given a distinguishing version number.  If the
-Program specifies that a certain numbered version of the GNU General
-Public License "or any later version" applies to it, you have the
-option of following the terms and conditions either of that numbered
-version or of any later version published by the Free Software
-Foundation.  If the Program does not specify a version number of the
-GNU General Public License, you may choose any version ever published
-by the Free Software Foundation.
-
-  If the Program specifies that a proxy can decide which future
-versions of the GNU General Public License can be used, that proxy's
-public statement of acceptance of a version permanently authorizes you
-to choose that version for the Program.
-
-  Later license versions may give you additional or different
-permissions.  However, no additional obligations are imposed on any
-author or copyright holder as a result of your choosing to follow a
-later version.
-
-  15. Disclaimer of Warranty.
-
-  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
-APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
-HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY
-OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
-THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
-PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM
-IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF
-ALL NECESSARY SERVICING, REPAIR OR CORRECTION.
-
-  16. Limitation of Liability.
-
-  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
-WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS
-THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
-GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE
-USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF
-DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
-PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),
-EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
-SUCH DAMAGES.
-
-  17. Interpretation of Sections 15 and 16.
-
-  If the disclaimer of warranty and limitation of liability provided
-above cannot be given local legal effect according to their terms,
-reviewing courts shall apply local law that most closely approximates
-an absolute waiver of all civil liability in connection with the
-Program, unless a warranty or assumption of liability accompanies a
-copy of the Program in return for a fee.
-
-                     END OF TERMS AND CONDITIONS
-
-            How to Apply These Terms to Your New Programs
-
-  If you develop a new program, and you want it to be of the greatest
-possible use to the public, the best way to achieve this is to make it
-free software which everyone can redistribute and change under these terms.
-
-  To do so, attach the following notices to the program.  It is safest
-to attach them to the start of each source file to most effectively
-state the exclusion of warranty; and each file should have at least
-the "copyright" line and a pointer to where the full notice is found.
-
-    <one line to give the program's name and a brief idea of what it does.>
-    Copyright (C) <year>  <name of author>
-
-    This program is free software: you can redistribute it and/or modify
-    it under the terms of the GNU General Public License as published by
-    the Free Software Foundation, either version 3 of the License, or
-    (at your option) any later version.
-
-    This program is distributed in the hope that it will be useful,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-    GNU General Public License for more details.
-
-    You should have received a copy of the GNU General Public License
-    along with this program.  If not, see <https://www.gnu.org/licenses/>.
-
-Also add information on how to contact you by electronic and paper mail.
-
-  If the program does terminal interaction, make it output a short
-notice like this when it starts in an interactive mode:
-
-    <program>  Copyright (C) <year>  <name of author>
-    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
-    This is free software, and you are welcome to redistribute it
-    under certain conditions; type `show c' for details.
-
-The hypothetical commands `show w' and `show c' should show the appropriate
-parts of the General Public License.  Of course, your program's commands
-might be different; for a GUI interface, you would use an "about box".
-
-  You should also get your employer (if you work as a programmer) or school,
-if any, to sign a "copyright disclaimer" for the program, if necessary.
-For more information on this, and how to apply and follow the GNU GPL, see
-<https://www.gnu.org/licenses/>.
-
-  The GNU General Public License does not permit incorporating your program
-into proprietary programs.  If your program is a subroutine library, you
-may consider it more useful to permit linking proprietary applications with
-the library.  If this is what you want to do, use the GNU Lesser General
-Public License instead of this License.  But first, please read
-<https://www.gnu.org/licenses/why-not-lgpl.html>.
+                    GNU GENERAL PUBLIC LICENSE
+                       Version 3, 29 June 2007
+
+ Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>
+ Everyone is permitted to copy and distribute verbatim copies
+ of this license document, but changing it is not allowed.
+
+                            Preamble
+
+  The GNU General Public License is a free, copyleft license for
+software and other kinds of works.
+
+  The licenses for most software and other practical works are designed
+to take away your freedom to share and change the works.  By contrast,
+the GNU General Public License is intended to guarantee your freedom to
+share and change all versions of a program--to make sure it remains free
+software for all its users.  We, the Free Software Foundation, use the
+GNU General Public License for most of our software; it applies also to
+any other work released this way by its authors.  You can apply it to
+your programs, too.
+
+  When we speak of free software, we are referring to freedom, not
+price.  Our General Public Licenses are designed to make sure that you
+have the freedom to distribute copies of free software (and charge for
+them if you wish), that you receive source code or can get it if you
+want it, that you can change the software or use pieces of it in new
+free programs, and that you know you can do these things.
+
+  To protect your rights, we need to prevent others from denying you
+these rights or asking you to surrender the rights.  Therefore, you have
+certain responsibilities if you distribute copies of the software, or if
+you modify it: responsibilities to respect the freedom of others.
+
+  For example, if you distribute copies of such a program, whether
+gratis or for a fee, you must pass on to the recipients the same
+freedoms that you received.  You must make sure that they, too, receive
+or can get the source code.  And you must show them these terms so they
+know their rights.
+
+  Developers that use the GNU GPL protect your rights with two steps:
+(1) assert copyright on the software, and (2) offer you this License
+giving you legal permission to copy, distribute and/or modify it.
+
+  For the developers' and authors' protection, the GPL clearly explains
+that there is no warranty for this free software.  For both users' and
+authors' sake, the GPL requires that modified versions be marked as
+changed, so that their problems will not be attributed erroneously to
+authors of previous versions.
+
+  Some devices are designed to deny users access to install or run
+modified versions of the software inside them, although the manufacturer
+can do so.  This is fundamentally incompatible with the aim of
+protecting users' freedom to change the software.  The systematic
+pattern of such abuse occurs in the area of products for individuals to
+use, which is precisely where it is most unacceptable.  Therefore, we
+have designed this version of the GPL to prohibit the practice for those
+products.  If such problems arise substantially in other domains, we
+stand ready to extend this provision to those domains in future versions
+of the GPL, as needed to protect the freedom of users.
+
+  Finally, every program is threatened constantly by software patents.
+States should not allow patents to restrict development and use of
+software on general-purpose computers, but in those that do, we wish to
+avoid the special danger that patents applied to a free program could
+make it effectively proprietary.  To prevent this, the GPL assures that
+patents cannot be used to render the program non-free.
+
+  The precise terms and conditions for copying, distribution and
+modification follow.
+
+                       TERMS AND CONDITIONS
+
+  0. Definitions.
+
+  "This License" refers to version 3 of the GNU General Public License.
+
+  "Copyright" also means copyright-like laws that apply to other kinds of
+works, such as semiconductor masks.
+
+  "The Program" refers to any copyrightable work licensed under this
+License.  Each licensee is addressed as "you".  "Licensees" and
+"recipients" may be individuals or organizations.
+
+  To "modify" a work means to copy from or adapt all or part of the work
+in a fashion requiring copyright permission, other than the making of an
+exact copy.  The resulting work is called a "modified version" of the
+earlier work or a work "based on" the earlier work.
+
+  A "covered work" means either the unmodified Program or a work based
+on the Program.
+
+  To "propagate" a work means to do anything with it that, without
+permission, would make you directly or secondarily liable for
+infringement under applicable copyright law, except executing it on a
+computer or modifying a private copy.  Propagation includes copying,
+distribution (with or without modification), making available to the
+public, and in some countries other activities as well.
+
+  To "convey" a work means any kind of propagation that enables other
+parties to make or receive copies.  Mere interaction with a user through
+a computer network, with no transfer of a copy, is not conveying.
+
+  An interactive user interface displays "Appropriate Legal Notices"
+to the extent that it includes a convenient and prominently visible
+feature that (1) displays an appropriate copyright notice, and (2)
+tells the user that there is no warranty for the work (except to the
+extent that warranties are provided), that licensees may convey the
+work under this License, and how to view a copy of this License.  If
+the interface presents a list of user commands or options, such as a
+menu, a prominent item in the list meets this criterion.
+
+  1. Source Code.
+
+  The "source code" for a work means the preferred form of the work
+for making modifications to it.  "Object code" means any non-source
+form of a work.
+
+  A "Standard Interface" means an interface that either is an official
+standard defined by a recognized standards body, or, in the case of
+interfaces specified for a particular programming language, one that
+is widely used among developers working in that language.
+
+  The "System Libraries" of an executable work include anything, other
+than the work as a whole, that (a) is included in the normal form of
+packaging a Major Component, but which is not part of that Major
+Component, and (b) serves only to enable use of the work with that
+Major Component, or to implement a Standard Interface for which an
+implementation is available to the public in source code form.  A
+"Major Component", in this context, means a major essential component
+(kernel, window system, and so on) of the specific operating system
+(if any) on which the executable work runs, or a compiler used to
+produce the work, or an object code interpreter used to run it.
+
+  The "Corresponding Source" for a work in object code form means all
+the source code needed to generate, install, and (for an executable
+work) run the object code and to modify the work, including scripts to
+control those activities.  However, it does not include the work's
+System Libraries, or general-purpose tools or generally available free
+programs which are used unmodified in performing those activities but
+which are not part of the work.  For example, Corresponding Source
+includes interface definition files associated with source files for
+the work, and the source code for shared libraries and dynamically
+linked subprograms that the work is specifically designed to require,
+such as by intimate data communication or control flow between those
+subprograms and other parts of the work.
+
+  The Corresponding Source need not include anything that users
+can regenerate automatically from other parts of the Corresponding
+Source.
+
+  The Corresponding Source for a work in source code form is that
+same work.
+
+  2. Basic Permissions.
+
+  All rights granted under this License are granted for the term of
+copyright on the Program, and are irrevocable provided the stated
+conditions are met.  This License explicitly affirms your unlimited
+permission to run the unmodified Program.  The output from running a
+covered work is covered by this License only if the output, given its
+content, constitutes a covered work.  This License acknowledges your
+rights of fair use or other equivalent, as provided by copyright law.
+
+  You may make, run and propagate covered works that you do not
+convey, without conditions so long as your license otherwise remains
+in force.  You may convey covered works to others for the sole purpose
+of having them make modifications exclusively for you, or provide you
+with facilities for running those works, provided that you comply with
+the terms of this License in conveying all material for which you do
+not control copyright.  Those thus making or running the covered works
+for you must do so exclusively on your behalf, under your direction
+and control, on terms that prohibit them from making any copies of
+your copyrighted material outside their relationship with you.
+
+  Conveying under any other circumstances is permitted solely under
+the conditions stated below.  Sublicensing is not allowed; section 10
+makes it unnecessary.
+
+  3. Protecting Users' Legal Rights From Anti-Circumvention Law.
+
+  No covered work shall be deemed part of an effective technological
+measure under any applicable law fulfilling obligations under article
+11 of the WIPO copyright treaty adopted on 20 December 1996, or
+similar laws prohibiting or restricting circumvention of such
+measures.
+
+  When you convey a covered work, you waive any legal power to forbid
+circumvention of technological measures to the extent such circumvention
+is effected by exercising rights under this License with respect to
+the covered work, and you disclaim any intention to limit operation or
+modification of the work as a means of enforcing, against the work's
+users, your or third parties' legal rights to forbid circumvention of
+technological measures.
+
+  4. Conveying Verbatim Copies.
+
+  You may convey verbatim copies of the Program's source code as you
+receive it, in any medium, provided that you conspicuously and
+appropriately publish on each copy an appropriate copyright notice;
+keep intact all notices stating that this License and any
+non-permissive terms added in accord with section 7 apply to the code;
+keep intact all notices of the absence of any warranty; and give all
+recipients a copy of this License along with the Program.
+
+  You may charge any price or no price for each copy that you convey,
+and you may offer support or warranty protection for a fee.
+
+  5. Conveying Modified Source Versions.
+
+  You may convey a work based on the Program, or the modifications to
+produce it from the Program, in the form of source code under the
+terms of section 4, provided that you also meet all of these conditions:
+
+    a) The work must carry prominent notices stating that you modified
+    it, and giving a relevant date.
+
+    b) The work must carry prominent notices stating that it is
+    released under this License and any conditions added under section
+    7.  This requirement modifies the requirement in section 4 to
+    "keep intact all notices".
+
+    c) You must license the entire work, as a whole, under this
+    License to anyone who comes into possession of a copy.  This
+    License will therefore apply, along with any applicable section 7
+    additional terms, to the whole of the work, and all its parts,
+    regardless of how they are packaged.  This License gives no
+    permission to license the work in any other way, but it does not
+    invalidate such permission if you have separately received it.
+
+    d) If the work has interactive user interfaces, each must display
+    Appropriate Legal Notices; however, if the Program has interactive
+    interfaces that do not display Appropriate Legal Notices, your
+    work need not make them do so.
+
+  A compilation of a covered work with other separate and independent
+works, which are not by their nature extensions of the covered work,
+and which are not combined with it such as to form a larger program,
+in or on a volume of a storage or distribution medium, is called an
+"aggregate" if the compilation and its resulting copyright are not
+used to limit the access or legal rights of the compilation's users
+beyond what the individual works permit.  Inclusion of a covered work
+in an aggregate does not cause this License to apply to the other
+parts of the aggregate.
+
+  6. Conveying Non-Source Forms.
+
+  You may convey a covered work in object code form under the terms
+of sections 4 and 5, provided that you also convey the
+machine-readable Corresponding Source under the terms of this License,
+in one of these ways:
+
+    a) Convey the object code in, or embodied in, a physical product
+    (including a physical distribution medium), accompanied by the
+    Corresponding Source fixed on a durable physical medium
+    customarily used for software interchange.
+
+    b) Convey the object code in, or embodied in, a physical product
+    (including a physical distribution medium), accompanied by a
+    written offer, valid for at least three years and valid for as
+    long as you offer spare parts or customer support for that product
+    model, to give anyone who possesses the object code either (1) a
+    copy of the Corresponding Source for all the software in the
+    product that is covered by this License, on a durable physical
+    medium customarily used for software interchange, for a price no
+    more than your reasonable cost of physically performing this
+    conveying of source, or (2) access to copy the
+    Corresponding Source from a network server at no charge.
+
+    c) Convey individual copies of the object code with a copy of the
+    written offer to provide the Corresponding Source.  This
+    alternative is allowed only occasionally and noncommercially, and
+    only if you received the object code with such an offer, in accord
+    with subsection 6b.
+
+    d) Convey the object code by offering access from a designated
+    place (gratis or for a charge), and offer equivalent access to the
+    Corresponding Source in the same way through the same place at no
+    further charge.  You need not require recipients to copy the
+    Corresponding Source along with the object code.  If the place to
+    copy the object code is a network server, the Corresponding Source
+    may be on a different server (operated by you or a third party)
+    that supports equivalent copying facilities, provided you maintain
+    clear directions next to the object code saying where to find the
+    Corresponding Source.  Regardless of what server hosts the
+    Corresponding Source, you remain obligated to ensure that it is
+    available for as long as needed to satisfy these requirements.
+
+    e) Convey the object code using peer-to-peer transmission, provided
+    you inform other peers where the object code and Corresponding
+    Source of the work are being offered to the general public at no
+    charge under subsection 6d.
+
+  A separable portion of the object code, whose source code is excluded
+from the Corresponding Source as a System Library, need not be
+included in conveying the object code work.
+
+  A "User Product" is either (1) a "consumer product", which means any
+tangible personal property which is normally used for personal, family,
+or household purposes, or (2) anything designed or sold for incorporation
+into a dwelling.  In determining whether a product is a consumer product,
+doubtful cases shall be resolved in favor of coverage.  For a particular
+product received by a particular user, "normally used" refers to a
+typical or common use of that class of product, regardless of the status
+of the particular user or of the way in which the particular user
+actually uses, or expects or is expected to use, the product.  A product
+is a consumer product regardless of whether the product has substantial
+commercial, industrial or non-consumer uses, unless such uses represent
+the only significant mode of use of the product.
+
+  "Installation Information" for a User Product means any methods,
+procedures, authorization keys, or other information required to install
+and execute modified versions of a covered work in that User Product from
+a modified version of its Corresponding Source.  The information must
+suffice to ensure that the continued functioning of the modified object
+code is in no case prevented or interfered with solely because
+modification has been made.
+
+  If you convey an object code work under this section in, or with, or
+specifically for use in, a User Product, and the conveying occurs as
+part of a transaction in which the right of possession and use of the
+User Product is transferred to the recipient in perpetuity or for a
+fixed term (regardless of how the transaction is characterized), the
+Corresponding Source conveyed under this section must be accompanied
+by the Installation Information.  But this requirement does not apply
+if neither you nor any third party retains the ability to install
+modified object code on the User Product (for example, the work has
+been installed in ROM).
+
+  The requirement to provide Installation Information does not include a
+requirement to continue to provide support service, warranty, or updates
+for a work that has been modified or installed by the recipient, or for
+the User Product in which it has been modified or installed.  Access to a
+network may be denied when the modification itself materially and
+adversely affects the operation of the network or violates the rules and
+protocols for communication across the network.
+
+  Corresponding Source conveyed, and Installation Information provided,
+in accord with this section must be in a format that is publicly
+documented (and with an implementation available to the public in
+source code form), and must require no special password or key for
+unpacking, reading or copying.
+
+  7. Additional Terms.
+
+  "Additional permissions" are terms that supplement the terms of this
+License by making exceptions from one or more of its conditions.
+Additional permissions that are applicable to the entire Program shall
+be treated as though they were included in this License, to the extent
+that they are valid under applicable law.  If additional permissions
+apply only to part of the Program, that part may be used separately
+under those permissions, but the entire Program remains governed by
+this License without regard to the additional permissions.
+
+  When you convey a copy of a covered work, you may at your option
+remove any additional permissions from that copy, or from any part of
+it.  (Additional permissions may be written to require their own
+removal in certain cases when you modify the work.)  You may place
+additional permissions on material, added by you to a covered work,
+for which you have or can give appropriate copyright permission.
+
+  Notwithstanding any other provision of this License, for material you
+add to a covered work, you may (if authorized by the copyright holders of
+that material) supplement the terms of this License with terms:
+
+    a) Disclaiming warranty or limiting liability differently from the
+    terms of sections 15 and 16 of this License; or
+
+    b) Requiring preservation of specified reasonable legal notices or
+    author attributions in that material or in the Appropriate Legal
+    Notices displayed by works containing it; or
+
+    c) Prohibiting misrepresentation of the origin of that material, or
+    requiring that modified versions of such material be marked in
+    reasonable ways as different from the original version; or
+
+    d) Limiting the use for publicity purposes of names of licensors or
+    authors of the material; or
+
+    e) Declining to grant rights under trademark law for use of some
+    trade names, trademarks, or service marks; or
+
+    f) Requiring indemnification of licensors and authors of that
+    material by anyone who conveys the material (or modified versions of
+    it) with contractual assumptions of liability to the recipient, for
+    any liability that these contractual assumptions directly impose on
+    those licensors and authors.
+
+  All other non-permissive additional terms are considered "further
+restrictions" within the meaning of section 10.  If the Program as you
+received it, or any part of it, contains a notice stating that it is
+governed by this License along with a term that is a further
+restriction, you may remove that term.  If a license document contains
+a further restriction but permits relicensing or conveying under this
+License, you may add to a covered work material governed by the terms
+of that license document, provided that the further restriction does
+not survive such relicensing or conveying.
+
+  If you add terms to a covered work in accord with this section, you
+must place, in the relevant source files, a statement of the
+additional terms that apply to those files, or a notice indicating
+where to find the applicable terms.
+
+  Additional terms, permissive or non-permissive, may be stated in the
+form of a separately written license, or stated as exceptions;
+the above requirements apply either way.
+
+  8. Termination.
+
+  You may not propagate or modify a covered work except as expressly
+provided under this License.  Any attempt otherwise to propagate or
+modify it is void, and will automatically terminate your rights under
+this License (including any patent licenses granted under the third
+paragraph of section 11).
+
+  However, if you cease all violation of this License, then your
+license from a particular copyright holder is reinstated (a)
+provisionally, unless and until the copyright holder explicitly and
+finally terminates your license, and (b) permanently, if the copyright
+holder fails to notify you of the violation by some reasonable means
+prior to 60 days after the cessation.
+
+  Moreover, your license from a particular copyright holder is
+reinstated permanently if the copyright holder notifies you of the
+violation by some reasonable means, this is the first time you have
+received notice of violation of this License (for any work) from that
+copyright holder, and you cure the violation prior to 30 days after
+your receipt of the notice.
+
+  Termination of your rights under this section does not terminate the
+licenses of parties who have received copies or rights from you under
+this License.  If your rights have been terminated and not permanently
+reinstated, you do not qualify to receive new licenses for the same
+material under section 10.
+
+  9. Acceptance Not Required for Having Copies.
+
+  You are not required to accept this License in order to receive or
+run a copy of the Program.  Ancillary propagation of a covered work
+occurring solely as a consequence of using peer-to-peer transmission
+to receive a copy likewise does not require acceptance.  However,
+nothing other than this License grants you permission to propagate or
+modify any covered work.  These actions infringe copyright if you do
+not accept this License.  Therefore, by modifying or propagating a
+covered work, you indicate your acceptance of this License to do so.
+
+  10. Automatic Licensing of Downstream Recipients.
+
+  Each time you convey a covered work, the recipient automatically
+receives a license from the original licensors, to run, modify and
+propagate that work, subject to this License.  You are not responsible
+for enforcing compliance by third parties with this License.
+
+  An "entity transaction" is a transaction transferring control of an
+organization, or substantially all assets of one, or subdividing an
+organization, or merging organizations.  If propagation of a covered
+work results from an entity transaction, each party to that
+transaction who receives a copy of the work also receives whatever
+licenses to the work the party's predecessor in interest had or could
+give under the previous paragraph, plus a right to possession of the
+Corresponding Source of the work from the predecessor in interest, if
+the predecessor has it or can get it with reasonable efforts.
+
+  You may not impose any further restrictions on the exercise of the
+rights granted or affirmed under this License.  For example, you may
+not impose a license fee, royalty, or other charge for exercise of
+rights granted under this License, and you may not initiate litigation
+(including a cross-claim or counterclaim in a lawsuit) alleging that
+any patent claim is infringed by making, using, selling, offering for
+sale, or importing the Program or any portion of it.
+
+  11. Patents.
+
+  A "contributor" is a copyright holder who authorizes use under this
+License of the Program or a work on which the Program is based.  The
+work thus licensed is called the contributor's "contributor version".
+
+  A contributor's "essential patent claims" are all patent claims
+owned or controlled by the contributor, whether already acquired or
+hereafter acquired, that would be infringed by some manner, permitted
+by this License, of making, using, or selling its contributor version,
+but do not include claims that would be infringed only as a
+consequence of further modification of the contributor version.  For
+purposes of this definition, "control" includes the right to grant
+patent sublicenses in a manner consistent with the requirements of
+this License.
+
+  Each contributor grants you a non-exclusive, worldwide, royalty-free
+patent license under the contributor's essential patent claims, to
+make, use, sell, offer for sale, import and otherwise run, modify and
+propagate the contents of its contributor version.
+
+  In the following three paragraphs, a "patent license" is any express
+agreement or commitment, however denominated, not to enforce a patent
+(such as an express permission to practice a patent or covenant not to
+sue for patent infringement).  To "grant" such a patent license to a
+party means to make such an agreement or commitment not to enforce a
+patent against the party.
+
+  If you convey a covered work, knowingly relying on a patent license,
+and the Corresponding Source of the work is not available for anyone
+to copy, free of charge and under the terms of this License, through a
+publicly available network server or other readily accessible means,
+then you must either (1) cause the Corresponding Source to be so
+available, or (2) arrange to deprive yourself of the benefit of the
+patent license for this particular work, or (3) arrange, in a manner
+consistent with the requirements of this License, to extend the patent
+license to downstream recipients.  "Knowingly relying" means you have
+actual knowledge that, but for the patent license, your conveying the
+covered work in a country, or your recipient's use of the covered work
+in a country, would infringe one or more identifiable patents in that
+country that you have reason to believe are valid.
+
+  If, pursuant to or in connection with a single transaction or
+arrangement, you convey, or propagate by procuring conveyance of, a
+covered work, and grant a patent license to some of the parties
+receiving the covered work authorizing them to use, propagate, modify
+or convey a specific copy of the covered work, then the patent license
+you grant is automatically extended to all recipients of the covered
+work and works based on it.
+
+  A patent license is "discriminatory" if it does not include within
+the scope of its coverage, prohibits the exercise of, or is
+conditioned on the non-exercise of one or more of the rights that are
+specifically granted under this License.  You may not convey a covered
+work if you are a party to an arrangement with a third party that is
+in the business of distributing software, under which you make payment
+to the third party based on the extent of your activity of conveying
+the work, and under which the third party grants, to any of the
+parties who would receive the covered work from you, a discriminatory
+patent license (a) in connection with copies of the covered work
+conveyed by you (or copies made from those copies), or (b) primarily
+for and in connection with specific products or compilations that
+contain the covered work, unless you entered into that arrangement,
+or that patent license was granted, prior to 28 March 2007.
+
+  Nothing in this License shall be construed as excluding or limiting
+any implied license or other defenses to infringement that may
+otherwise be available to you under applicable patent law.
+
+  12. No Surrender of Others' Freedom.
+
+  If conditions are imposed on you (whether by court order, agreement or
+otherwise) that contradict the conditions of this License, they do not
+excuse you from the conditions of this License.  If you cannot convey a
+covered work so as to satisfy simultaneously your obligations under this
+License and any other pertinent obligations, then as a consequence you may
+not convey it at all.  For example, if you agree to terms that obligate you
+to collect a royalty for further conveying from those to whom you convey
+the Program, the only way you could satisfy both those terms and this
+License would be to refrain entirely from conveying the Program.
+
+  13. Use with the GNU Affero General Public License.
+
+  Notwithstanding any other provision of this License, you have
+permission to link or combine any covered work with a work licensed
+under version 3 of the GNU Affero General Public License into a single
+combined work, and to convey the resulting work.  The terms of this
+License will continue to apply to the part which is the covered work,
+but the special requirements of the GNU Affero General Public License,
+section 13, concerning interaction through a network will apply to the
+combination as such.
+
+  14. Revised Versions of this License.
+
+  The Free Software Foundation may publish revised and/or new versions of
+the GNU General Public License from time to time.  Such new versions will
+be similar in spirit to the present version, but may differ in detail to
+address new problems or concerns.
+
+  Each version is given a distinguishing version number.  If the
+Program specifies that a certain numbered version of the GNU General
+Public License "or any later version" applies to it, you have the
+option of following the terms and conditions either of that numbered
+version or of any later version published by the Free Software
+Foundation.  If the Program does not specify a version number of the
+GNU General Public License, you may choose any version ever published
+by the Free Software Foundation.
+
+  If the Program specifies that a proxy can decide which future
+versions of the GNU General Public License can be used, that proxy's
+public statement of acceptance of a version permanently authorizes you
+to choose that version for the Program.
+
+  Later license versions may give you additional or different
+permissions.  However, no additional obligations are imposed on any
+author or copyright holder as a result of your choosing to follow a
+later version.
+
+  15. Disclaimer of Warranty.
+
+  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
+APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
+HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY
+OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
+THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM
+IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF
+ALL NECESSARY SERVICING, REPAIR OR CORRECTION.
+
+  16. Limitation of Liability.
+
+  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
+WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS
+THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
+GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE
+USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF
+DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
+PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),
+EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
+SUCH DAMAGES.
+
+  17. Interpretation of Sections 15 and 16.
+
+  If the disclaimer of warranty and limitation of liability provided
+above cannot be given local legal effect according to their terms,
+reviewing courts shall apply local law that most closely approximates
+an absolute waiver of all civil liability in connection with the
+Program, unless a warranty or assumption of liability accompanies a
+copy of the Program in return for a fee.
+
+                     END OF TERMS AND CONDITIONS
+
+            How to Apply These Terms to Your New Programs
+
+  If you develop a new program, and you want it to be of the greatest
+possible use to the public, the best way to achieve this is to make it
+free software which everyone can redistribute and change under these terms.
+
+  To do so, attach the following notices to the program.  It is safest
+to attach them to the start of each source file to most effectively
+state the exclusion of warranty; and each file should have at least
+the "copyright" line and a pointer to where the full notice is found.
+
+    <one line to give the program's name and a brief idea of what it does.>
+    Copyright (C) <year>  <name of author>
+
+    This program is free software: you can redistribute it and/or modify
+    it under the terms of the GNU General Public License as published by
+    the Free Software Foundation, either version 3 of the License, or
+    (at your option) any later version.
+
+    This program is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+    GNU General Public License for more details.
+
+    You should have received a copy of the GNU General Public License
+    along with this program.  If not, see <https://www.gnu.org/licenses/>.
+
+Also add information on how to contact you by electronic and paper mail.
+
+  If the program does terminal interaction, make it output a short
+notice like this when it starts in an interactive mode:
+
+    <program>  Copyright (C) <year>  <name of author>
+    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
+    This is free software, and you are welcome to redistribute it
+    under certain conditions; type `show c' for details.
+
+The hypothetical commands `show w' and `show c' should show the appropriate
+parts of the General Public License.  Of course, your program's commands
+might be different; for a GUI interface, you would use an "about box".
+
+  You should also get your employer (if you work as a programmer) or school,
+if any, to sign a "copyright disclaimer" for the program, if necessary.
+For more information on this, and how to apply and follow the GNU GPL, see
+<https://www.gnu.org/licenses/>.
+
+  The GNU General Public License does not permit incorporating your program
+into proprietary programs.  If your program is a subroutine library, you
+may consider it more useful to permit linking proprietary applications with
+the library.  If this is what you want to do, use the GNU Lesser General
+Public License instead of this License.  But first, please read
+<https://www.gnu.org/licenses/why-not-lgpl.html>.
```

### Comparing `pycsamt-1.1.2/docs/Makefile` & `pycsamt-1.2.1/docs/Makefile`

 * *Files 22% similar despite different names*

```diff
@@ -1,20 +1,20 @@
-# Minimal makefile for Sphinx documentation
-#
-
-# You can set these variables from the command line, and also
-# from the environment for the first two.
-SPHINXOPTS    ?=
-SPHINXBUILD   ?= sphinx-build
-SOURCEDIR     = .
-BUILDDIR      = _build
-
-# Put it first so that "make" without argument is like "make help".
-help:
-	@$(SPHINXBUILD) -M help "$(SOURCEDIR)" "$(BUILDDIR)" $(SPHINXOPTS) $(O)
-
-.PHONY: help Makefile
-
-# Catch-all target: route all unknown targets to Sphinx using the new
-# "make mode" option.  $(O) is meant as a shortcut for $(SPHINXOPTS).
-%: Makefile
-	@$(SPHINXBUILD) -M $@ "$(SOURCEDIR)" "$(BUILDDIR)" $(SPHINXOPTS) $(O)
+# Minimal makefile for Sphinx documentation
+#
+
+# You can set these variables from the command line, and also
+# from the environment for the first two.
+SPHINXOPTS    ?=
+SPHINXBUILD   ?= sphinx-build
+SOURCEDIR     = source
+BUILDDIR      = build
+
+# Put it first so that "make" without argument is like "make help".
+help:
+	@$(SPHINXBUILD) -M help "$(SOURCEDIR)" "$(BUILDDIR)" $(SPHINXOPTS) $(O)
+
+.PHONY: help Makefile
+
+# Catch-all target: route all unknown targets to Sphinx using the new
+# "make mode" option.  $(O) is meant as a shortcut for $(SPHINXOPTS).
+%: Makefile
+	@$(SPHINXBUILD) -M $@ "$(SOURCEDIR)" "$(BUILDDIR)" $(SPHINXOPTS) $(O)
```

### Comparing `pycsamt-1.1.2/docs/index.html` & `pycsamt-1.2.1/docs/index.html`

 * *Files 12% similar despite different names*

```diff
@@ -1,159 +1,184 @@
 
-<!DOCTYPE html>
 
-<html xmlns="http://www.w3.org/1999/xhtml">
+<!doctype html>
+
+<html lang="en">
   <head>
     <meta charset="utf-8" />
-    <title>Welcome to pyCSAMT’s documentation! &#8212; pyCSAMT v1.0.03 documentation</title>
-    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
-    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
+    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
+
+    <title>pycsamt documentation &#8212; pycsamt v1.1.7 documentation</title>
+    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
+    <link rel="stylesheet" type="text/css" href="_static/bizstyle.css" />
     
-    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
+    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
     <script src="_static/jquery.js"></script>
     <script src="_static/underscore.js"></script>
+    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
     <script src="_static/doctools.js"></script>
-    <script src="_static/language_data.js"></script>
-    
+    <script src="_static/bizstyle.js"></script>
     <link rel="index" title="Index" href="genindex.html" />
     <link rel="search" title="Search" href="search.html" />
-    <link rel="next" title="Package CSAMT" href="csamt.html" /> 
+    <link rel="next" title="Installation" href="installation.html" />
+    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
+    <!--[if lt IE 9]>
+    <script src="_static/css3-mediaqueries.js"></script>
+    <![endif]-->
   </head><body>
     <div class="related" role="navigation" aria-label="related navigation">
       <h3>Navigation</h3>
       <ul>
         <li class="right" style="margin-right: 10px">
           <a href="genindex.html" title="General Index"
              accesskey="I">index</a></li>
         <li class="right" >
           <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |</li>
         <li class="right" >
-          <a href="csamt.html" title="Package CSAMT"
+          <a href="installation.html" title="Installation"
              accesskey="N">next</a> |</li>
-        <li class="nav-item nav-item-0"><a href="#">pyCSAMT v1.0.03 documentation</a> &#187;</li> 
+        <li class="nav-item nav-item-0"><a href="#">pycsamt v1.1.7 documentation</a> &#187;</li>
+        <li class="nav-item nav-item-this"><a href=""><cite>pycsamt</cite> documentation</a></li> 
       </ul>
     </div>  
 
     <div class="document">
       <div class="documentwrapper">
         <div class="bodywrapper">
           <div class="body" role="main">
             
-  <div class="section" id="welcome-to-pycsamt-s-documentation">
-<h1>Welcome to pyCSAMT’s documentation!<a class="headerlink" href="#welcome-to-pycsamt-s-documentation" title="Permalink to this headline">¶</a></h1>
+  <section id="pycsamt-documentation">
+<h1><cite>pycsamt</cite> documentation<a class="headerlink" href="#pycsamt-documentation" title="Permalink to this heading">¶</a></h1>
 <div class="toctree-wrapper compound">
-<p class="caption"><span class="caption-text">Contents:</span></p>
+<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
 <ul>
-<li class="toctree-l1"><a class="reference internal" href="csamt.html">Package CSAMT</a><ul>
-<li class="toctree-l2"><a class="reference internal" href="csamt.html#module-pycsamt.ff.core.avg"><strong>Module AVG</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="csamt.html#module-pycsamt.ff.core.cs"><strong>Module CS</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="csamt.html#module-pycsamt.ff.core.edi"><strong>Module EDI</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="csamt.html#module-pycsamt.ff.core.j"><strong>Module J</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="csamt.html#module-pycsamt.ff.core.z"><strong>Module z</strong></a></li>
+<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
+<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-via-pip">Installing via pip</a></li>
+<li class="toctree-l2"><a class="reference internal" href="installation.html#intalling-from-source">Intalling from source</a></li>
+<li class="toctree-l2"><a class="reference internal" href="installation.html#required-dependencies">Required Dependencies</a></li>
+<li class="toctree-l2"><a class="reference internal" href="installation.html#optional-dependencies">Optional Dependencies</a></li>
+<li class="toctree-l2"><a class="reference internal" href="installation.html#additional-resources">Additional Resources</a></li>
+</ul>
+</li>
+<li class="toctree-l1"><a class="reference internal" href="demo.html">Demo</a><ul>
+<li class="toctree-l2"><a class="reference internal" href="demo.html#available-filters">Available filters</a></li>
+<li class="toctree-l2"><a class="reference internal" href="demo.html#plot-inversion-and-geostratigraphy-g-misfits">Plot inversion and geostratigraphy(G) misfits</a></li>
+<li class="toctree-l2"><a class="reference internal" href="demo.html#plot-the-pseudostratigraphic-log">Plot the pseudostratigraphic log</a></li>
+<li class="toctree-l2"><a class="reference internal" href="demo.html#go-deeper">Go Deeper</a></li>
+</ul>
+</li>
+<li class="toctree-l1"><a class="reference internal" href="core.html">Package Core</a><ul>
+<li class="toctree-l2"><a class="reference internal" href="core.html#module-pycsamt.core.avg"><strong>Module AVG</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="core.html#module-pycsamt.core.cs"><strong>Module CS</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="core.html#module-pycsamt.core.edi"><strong>Module EDI</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="core.html#module-pycsamt.core.j"><strong>Module J</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="core.html#module-pycsamt.core.z"><strong>Module Z</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="core.html#module-pycsamt.site"><strong>Module Site</strong></a></li>
 </ul>
 </li>
 <li class="toctree-l1"><a class="reference internal" href="processing.html">Package Processing</a><ul>
-<li class="toctree-l2"><a class="reference internal" href="processing.html#module-pycsamt.ff.processing.callffunc"><strong>Module Dispatcher</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="processing.html#module-pycsamt.ff.processing.corr"><strong>Module Shifting</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="processing.html#module-pycsamt.ff.processing.zcalculator"><strong>Module ZCalculator</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="processing.html#module-pycsamt.processing.corr"><strong>Module Processing</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="processing.html#module-pycsamt.processing.ctools"><strong>Module CTools</strong></a></li>
 </ul>
 </li>
 <li class="toctree-l1"><a class="reference internal" href="modeling.html">Package Modeling</a><ul>
 <li class="toctree-l2"><a class="reference internal" href="modeling.html#module-pycsamt.modeling.occam2d"><strong>Module Occam2D</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="modeling.html#module-pycsamt.modeling.modem"><strong>Module ModEM</strong></a></li>
 </ul>
 </li>
-<li class="toctree-l1"><a class="reference internal" href="geocore.html">Package GeoCore</a><ul>
-<li class="toctree-l2"><a class="reference internal" href="geocore.html#module-pycsamt.geodrill.geoCore.geodrill"><strong>Module Geodrill</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="geocore.html#module-pycsamt.geodrill.geoCore.structural"><strong>Module Structural</strong></a></li>
+<li class="toctree-l1"><a class="reference internal" href="geocore.html">Package GeoDrill</a><ul>
+<li class="toctree-l2"><a class="reference internal" href="geocore.html#module-pycsamt.geodrill.geocore"><strong>Module GeoCore</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="geocore.html#module-pycsamt.geodrill.structural"><strong>Module Structural</strong></a></li>
 <li class="toctree-l2"><a class="reference internal" href="geocore.html#module-strata"><strong>Module Strata</strong></a></li>
 </ul>
 </li>
-<li class="toctree-l1"><a class="reference internal" href="geodb.html">Package GeoDataBase</a><ul>
-<li class="toctree-l2"><a class="reference internal" href="geodb.html#module-pycsamt.geodrill.geoDB.sql_recorder"><strong>Module Recorder</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="geodb.html#module-pycsamt.geodrill.geoDB.interfaceDB"><strong>Module Interface</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="geodb.html#module-pycsamt.geodrill.geoDB.sqlrequests"><strong>Module Request</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="geodb.html#module-pycsamt.geodrill.geoDB.dict_app"><strong>Module DictApp</strong></a></li>
-</ul>
-</li>
 <li class="toctree-l1"><a class="reference internal" href="utils.html">Package Utils</a><ul>
-<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils.agso"><strong>Module Agso</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.bases"><strong>Module Base</strong></a></li>
 <li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils.decorator"><strong>Module Decorator</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils.func_utils"><strong>Module Func-utils</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="utils.html#module-gis-tools"><strong>Module Gis-tools</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.etc.infos"><strong>Module Infos</strong></a></li>
-<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils.plot_utils"><strong>Module Plot-utils</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils.func_utils"><strong>Module FuncUtils</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils.geo_utils"><strong>Module GeoTools</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="utils.html#module-gistools"><strong>Module GisTools</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils._p"><strong>Module Property</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils.plot_utils"><strong>Module PlotUtils</strong></a></li>
+<li class="toctree-l2"><a class="reference internal" href="utils.html#module-pycsamt.utils.zcalculator"><strong>Module ZCalculator</strong></a></li>
 </ul>
 </li>
-<li class="toctree-l1"><a class="reference internal" href="viewer.html">Package Visualization</a><ul>
-<li class="toctree-l2"><a class="reference internal" href="viewer.html#module-pycsamt.viewer.plot"><strong>Module Plot1D2D</strong></a></li>
+<li class="toctree-l1"><a class="reference internal" href="view.html">Package Visualization</a><ul>
+<li class="toctree-l2"><a class="reference internal" href="view.html#module-pycsamt.view.plot"><strong>Module Plot</strong></a></li>
 </ul>
 </li>
 </ul>
 </div>
-</div>
-<div class="section" id="indices-and-tables">
-<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
+</section>
+<section id="indices-and-tables">
+<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading">¶</a></h1>
 <ul class="simple">
 <li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
 <li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
 <li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
 </ul>
-</div>
+</section>
 
 
+            <div class="clearer"></div>
           </div>
         </div>
       </div>
       <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
         <div class="sphinxsidebarwrapper">
-  <h3><a href="#">Table of Contents</a></h3>
-  <ul>
-<li><a class="reference internal" href="#">Welcome to pyCSAMT’s documentation!</a></li>
+  <div>
+    <h3><a href="#">Table of Contents</a></h3>
+    <ul>
+<li><a class="reference internal" href="#"><cite>pycsamt</cite> documentation</a></li>
 <li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
 </ul>
 
-  <h4>Next topic</h4>
-  <p class="topless"><a href="csamt.html"
-                        title="next chapter">Package CSAMT</a></p>
+  </div>
+  <div>
+    <h4>Next topic</h4>
+    <p class="topless"><a href="installation.html"
+                          title="next chapter">Installation</a></p>
+  </div>
   <div role="note" aria-label="source link">
     <h3>This Page</h3>
     <ul class="this-page-menu">
       <li><a href="_sources/index.rst.txt"
             rel="nofollow">Show Source</a></li>
     </ul>
    </div>
 <div id="searchbox" style="display: none" role="search">
   <h3 id="searchlabel">Quick search</h3>
     <div class="searchformwrapper">
     <form class="search" action="search.html" method="get">
-      <input type="text" name="q" aria-labelledby="searchlabel" />
+      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
       <input type="submit" value="Go" />
     </form>
     </div>
 </div>
-<script>$('#searchbox').show(0);</script>
+<script>document.getElementById('searchbox').style.display = "block"</script>
         </div>
       </div>
       <div class="clearer"></div>
     </div>
     <div class="related" role="navigation" aria-label="related navigation">
       <h3>Navigation</h3>
       <ul>
         <li class="right" style="margin-right: 10px">
           <a href="genindex.html" title="General Index"
              >index</a></li>
         <li class="right" >
           <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |</li>
         <li class="right" >
-          <a href="csamt.html" title="Package CSAMT"
+          <a href="installation.html" title="Installation"
              >next</a> |</li>
-        <li class="nav-item nav-item-0"><a href="#">pyCSAMT v1.0.03 documentation</a> &#187;</li> 
+        <li class="nav-item nav-item-0"><a href="#">pycsamt v1.1.7 documentation</a> &#187;</li>
+        <li class="nav-item nav-item-this"><a href=""><cite>pycsamt</cite> documentation</a></li> 
       </ul>
     </div>
     <div class="footer" role="contentinfo">
         &#169; Copyright 2021, Kouadio K. Laurent.
-      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
+      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
     </div>
   </body>
 </html>
```

#### html2text {}

```diff
@@ -1,61 +1,76 @@
 
 
 
 
 
+
+
+
 **** Navigation ****
     * index
     * modules |
     * next |
-    * pyCSAMT_v1.0.03_documentation »
-****** Welcome to pyCSAMTâs documentation!Â¶ ******
+    * pycsamt_v1.1.7_documentation »
+    * pycsamtdocumentation
+****** pycsamtdocumentationÂ¶ ******
 Contents:
-    * Package_CSAMT
+    * Installation
+          o Installing_via_pip
+          o Intalling_from_source
+          o Required_Dependencies
+          o Optional_Dependencies
+          o Additional_Resources
+    * Demo
+          o Available_filters
+          o Plot_inversion_and_geostratigraphy(G)_misfits
+          o Plot_the_pseudostratigraphic_log
+          o Go_Deeper
+    * Package_Core
           o Module_AVG
           o Module_CS
           o Module_EDI
           o Module_J
-          o Module_z
+          o Module_Z
+          o Module_Site
     * Package_Processing
-          o Module_Dispatcher
-          o Module_Shifting
-          o Module_ZCalculator
+          o Module_Processing
+          o Module_CTools
     * Package_Modeling
           o Module_Occam2D
-    * Package_GeoCore
-          o Module_Geodrill
+          o Module_ModEM
+    * Package_GeoDrill
+          o Module_GeoCore
           o Module_Structural
           o Module_Strata
-    * Package_GeoDataBase
-          o Module_Recorder
-          o Module_Interface
-          o Module_Request
-          o Module_DictApp
     * Package_Utils
-          o Module_Agso
+          o Module_Base
           o Module_Decorator
-          o Module_Func-utils
-          o Module_Gis-tools
-          o Module_Infos
-          o Module_Plot-utils
+          o Module_FuncUtils
+          o Module_GeoTools
+          o Module_GisTools
+          o Module_Property
+          o Module_PlotUtils
+          o Module_ZCalculator
     * Package_Visualization
-          o Module_Plot1D2D
+          o Module_Plot
+
 ****** Indices and tablesÂ¶ ******
     * Index
     * Module_Index
     * Search_Page
 **** Table_of_Contents ****
-    * Welcome_to_pyCSAMTâs_documentation!
+    * pycsamtdocumentation
     * Indices_and_tables
 *** Next topic ***
-Package_CSAMT
+Installation
 **** This Page ****
     * Show_Source
 **** Quick search ****
 [q                   ] [Go]
 **** Navigation ****
     * index
     * modules |
     * next |
-    * pyCSAMT_v1.0.03_documentation »
-© Copyright 2021, Kouadio K. Laurent. Created using Sphinx 2.4.0.
+    * pycsamt_v1.1.7_documentation »
+    * pycsamtdocumentation
+© Copyright 2021, Kouadio K. Laurent. Created using Sphinx 5.0.2.
```

### Comparing `pycsamt-1.1.2/docs/make.bat` & `pycsamt-1.2.1/docs/make.bat`

 * *Files 13% similar despite different names*

```diff
@@ -3,32 +3,32 @@
 pushd %~dp0
 
 REM Command file for Sphinx documentation
 
 if "%SPHINXBUILD%" == "" (
 	set SPHINXBUILD=sphinx-build
 )
-set SOURCEDIR=.
-set BUILDDIR=_build
-
-if "%1" == "" goto help
+set SOURCEDIR=source
+set BUILDDIR=build
 
 %SPHINXBUILD% >NUL 2>NUL
 if errorlevel 9009 (
 	echo.
 	echo.The 'sphinx-build' command was not found. Make sure you have Sphinx
 	echo.installed, then set the SPHINXBUILD environment variable to point
 	echo.to the full path of the 'sphinx-build' executable. Alternatively you
 	echo.may add the Sphinx directory to PATH.
 	echo.
 	echo.If you don't have Sphinx installed, grab it from
-	echo.http://sphinx-doc.org/
+	echo.https://www.sphinx-doc.org/
 	exit /b 1
 )
 
+if "%1" == "" goto help
+
 %SPHINXBUILD% -M %1 %SOURCEDIR% %BUILDDIR% %SPHINXOPTS% %O%
 goto end
 
 :help
 %SPHINXBUILD% -M help %SOURCEDIR% %BUILDDIR% %SPHINXOPTS% %O%
 
 :end
```

### Comparing `pycsamt-1.1.2/docs/pyCSAMT User Guide.pdf` & `pycsamt-1.2.1/docs/user_guide.pdf`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/docs/source/conf.py` & `pycsamt-1.2.1/docs/source/conf.py`

 * *Files 5% similar despite different names*

```diff
@@ -10,30 +10,30 @@
 
 # If extensions (or modules to document with autodoc) are in another directory,
 # add these directories to sys.path here. If the directory is relative to the
 # documentation root, use os.path.abspath to make it absolute, like shown here.
 #
 import os
 import sys
-import sphinx_rtd_theme
+# import guzzle_sphinx_theme #, sphinx_rtd_theme
 
 sys.path.insert(0, os.path.abspath('.'))
 sys.path.insert(0, os.path.abspath('..'))
 sys.path.insert(0, os.path.abspath('../..'))
 
 # -- Project information -----------------------------------------------------
 
-project = u'pyCSAMT'
+project = u'pycsamt'
 copyright = u'2021, Kouadio K. Laurent'
 author = u'Kouadio K. Laurent'
 
 # The short X.Y version
-version = u'1.0'
+version = u'1.1'
 # The full version, including alpha/beta/rc tags
-release = u'v1.0.03'
+release = u'v1.1.7'
 
 
 # -- General configuration ---------------------------------------------------
 
 # If your documentation needs a minimal Sphinx version, state it here.
 #
 # needs_sphinx = '1.0'
@@ -46,21 +46,22 @@
     'sphinx.ext.doctest',
     'sphinx.ext.viewcode',
     'sphinx.ext.coverage',
     'sphinx.ext.imgmath',
     #'numpydoc',
     'sphinx.ext.napoleon',
     'sphinx.ext.autosummary',
-     "sphinx_rtd_theme",
+     #"sphinx_rtd_theme",
+     #"guzzle_sphinx_theme", 
     'sphinx.ext.githubpages',
 ]
 
 #Configuring Napoleon
-#napoleon_google_docstring = False
-#napoleon_numpy_docstring = True
+napoleon_google_docstring = True
+napoleon_numpy_docstring = True
 # Add any paths that contain templates here, relative to this directory.
 templates_path = ['_templates']
 
 # The suffix(es) of source filenames.
 # You can specify multiple suffix as a list of string:
 #
 # source_suffix = ['.rst', '.md']
@@ -70,15 +71,15 @@
 master_doc = 'index'
 
 # The language for content autogenerated by Sphinx. Refer to documentation
 # for a list of supported languages.
 #
 # This is also used if you do content translation via gettext catalogs.
 # Usually you set "language" from the command line for these cases.
-language = None
+language = 'en'
 
 # List of patterns, relative to source directory, that match files and
 # directories to ignore when looking for source files.
 # This pattern also affects html_static_path and html_extra_path.
 exclude_patterns = [u'_build', 'Thumbs.db', '.DS_Store']
 
 # The name of the Pygments (syntax highlighting) style to use.
@@ -87,15 +88,15 @@
 
 # -- Options for HTML output -------------------------------------------------
 
 # The theme to use for HTML and HTML Help pages.  See the documentation for
 # a list of builtin themes.
 #
 #html_theme = 'classic'
-html_theme = 'sphinx_rtd_theme'
+html_theme ='bizstyle'#'guzzle_sphinx_theme' #'sphinx_rtd_theme', #bizstyle
 
 # Theme options are theme-specific and customize the look and feel of a theme
 # further.  For a list of options available for each theme, see the
 # documentation.
 #
 # html_theme_options = {}
 
@@ -114,15 +115,15 @@
 #
 # html_sidebars = {}
 
 
 # -- Options for HTMLHelp output ---------------------------------------------
 
 # Output file base name for HTML help builder.
-htmlhelp_basename = 'pyCSAMTdoc'
+htmlhelp_basename = 'pycsamtdoc'
 
 
 # -- Options for LaTeX output ------------------------------------------------
 
 latex_elements = {
     # The paper size ('letterpaper' or 'a4paper').
     #
@@ -141,37 +142,37 @@
     # 'figure_align': 'htbp',
 }
 
 # Grouping the document tree into LaTeX files. List of tuples
 # (source start file, target name, title,
 #  author, documentclass [howto, manual, or own class]).
 latex_documents = [
-    (master_doc, 'pyCSAMT.tex', u'pyCSAMT Documentation',
+    (master_doc, 'pycsamt.tex', u'pycsamt Documentation',
      u'Kouadio K. Laurent', 'manual'),
 ]
 
 
 # -- Options for manual page output ------------------------------------------
 
 # One entry per manual page. List of tuples
 # (source start file, name, description, authors, manual section).
 man_pages = [
-    (master_doc, 'pycsamt', u'pyCSAMT Documentation',
+    (master_doc, 'pycsamt', u'pycsamt Documentation',
      [author], 1)
 ]
 
 
 # -- Options for Texinfo output ----------------------------------------------
 
 # Grouping the document tree into Texinfo files. List of tuples
 # (source start file, target name, title, author,
 #  dir menu entry, description, category)
 texinfo_documents = [
-    (master_doc, 'pyCSAMT', u'pyCSAMT Documentation',
-     author, 'pyCSAMT', 'An open source Python toolbox for controlled source audio-frequency magnetotellurics.',
+    (master_doc, 'pycsamt', u'pycsamt Documentation',
+     author, 'pycsamt', 'A package for audio-frequency magnetotellurics',
      'Miscellaneous'),
 ]
 
 
 # -- Options for Epub output -------------------------------------------------
 
 # Bibliographic Dublin Core info.
@@ -188,15 +189,20 @@
 # A unique identification for the text.
 #
 # epub_uid = ''
 
 # A list of files that should not be packed into the epub file.
 epub_exclude_files = ['search.html']
 
-
+#--- Intersphinx ----------------------
+intersphinx_mapping = {
+    'python': ('https://docs.python.org/', None),
+    'numpy': ('http://docs.scipy.org/doc/numpy/', None),
+    'mtpy': ('https://mtpy2.readthedocs.io/en/develop/', None)
+}
 
 # -- Extension configuration -------------------------------------------------
 MOCK_MODULES = [
     'osgeo',
     'osgeo.ogr',
     'osgeo.gdal',
     'osgeo.osr',
```

### Comparing `pycsamt-1.1.2/docs/source/csamt.rst` & `pycsamt-1.2.1/docs/source/core.rst`

 * *Files 25% similar despite different names*

```diff
@@ -1,44 +1,44 @@
 
 ======================
-Package CSAMT
+Package Core
 ======================
 
 	
 **Module AVG**
 =================
-.. automodule:: pycsamt.ff.core.avg
+.. automodule:: pycsamt.core.avg
 	:members:
 	
 **Module CS**
 ==================
-.. automodule:: pycsamt.ff.core.cs
+.. automodule:: pycsamt.core.cs
 	:members:
 	
 **Module EDI**
 ===================
-.. automodule:: pycsamt.ff.core.edi
+.. automodule:: pycsamt.core.edi
     :members:
 
 
 **Module J**
 ===================
-.. automodule:: pycsamt.ff.core.j
+.. automodule:: pycsamt.core.j
     :members:
 
 
-**Module z**
+**Module Z**
 ====================
-.. automodule:: pycsamt.ff.core.z
+.. automodule:: pycsamt.core.z
     :members:
 
 
 **Module Site**
 ====================
-.. automodule:: pycsamt.ff.site
+.. automodule:: pycsamt.site
     :members:
```

### Comparing `pycsamt-1.1.2/docs/source/index.rst` & `pycsamt-1.2.1/docs/source/index.rst`

 * *Files 9% similar despite different names*

```diff
@@ -1,26 +1,29 @@
-.. pyCSAMT documentation master file, created by
+.. pycsamt documentation master file, created by
    sphinx-quickstart on Sun Feb 28 23:20:06 2021.
    You can adapt this file completely to your liking, but it should at least
    contain the root `toctree` directive.
 
-Welcome to pyCSAMT's documentation!
-===================================
+`pycsamt` documentation
+===========================
 
 .. toctree::
    :maxdepth: 2
    :caption: Contents:
    
-   csamt
+   installation
+   demo
+   core
    processing
    modeling 
    geocore 
    geodatabase
    utils
-   viewer
+   view
+
 
 Indices and tables
-==================
+====================
 
 * :ref:`genindex`
 * :ref:`modindex`
 * :ref:`search`
```

### Comparing `pycsamt-1.1.2/docs/source/utils.rst` & `pycsamt-1.2.1/docs/source/utils.rst`

 * *Files 12% similar despite different names*

```diff
@@ -1,52 +1,51 @@
 
 ==============================
 Package Utils
 ==============================
 
 
 **Module Base**
-=====================
-.. automodule:: pycsamt.base
+========================
+.. automodule:: pycsamt.bases
 	:members:
 	
 **Module Decorator**
-=====================
+=========================
 .. automodule:: pycsamt.utils.decorator
 	:members:
 	
-	
-**Module Func-utils**
-=====================
+**Module FuncUtils**
+=========================
 .. automodule:: pycsamt.utils.func_utils
     :members:
 	
 	
-**Module Geo-utils**
-=====================
+**Module GeoTools**
+=========================
 .. automodule:: pycsamt.utils.geo_utils
     :members:
 
 
-**Module Gis-tools**
-=====================
+**Module GisTools**
+=========================
 .. automodule::pycsamt.utils.gis_tools
     :members:
 
 
 **Module Property**
-=====================
-.. automodule:: pycsamt.etc.infos
+=========================
+.. automodule:: pycsamt.utils._p
     :members:
     :private-members:
 
 
-**Module Plot-utils**
-=====================
+**Module PlotUtils**
+==========================
 .. automodule:: pycsamt.utils.plot_utils
     :members:
 
 
-**Module Z-Calculator**
+**Module ZCalculator**
 ========================
 .. automodule:: pycsamt.utils.zcalculator
     :members:
```

### Comparing `pycsamt-1.1.2/pycsamt/bases.py` & `pycsamt-1.2.1/pycsamt/bases.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 # -*- coding: utf-8 -*-
 #       created on Fri Oct 29 12:31:01 2021
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
-#       Licence: LGPL
+#       Licence: GPL
 import os
 import json 
 import yaml
 import csv 
 import warnings
 import copy
 import joblib 
@@ -23,15 +23,15 @@
     Dict ,
     Sequence, 
     Iterable,
     List, 
 )
 
 import pycsamt.utils.func_utils as FU
-from pycsamt.utils._csamtpylog import csamtpylog
+from pycsamt._csamtpylog import csamtpylog
 
 
 T=TypeVar('T')
 A=TypeVar('A')
 
 V= List[Union[float, int]]
 
@@ -573,15 +573,15 @@
                 if config ==c:
                     config_fname= n
                     break 
             if config_fname is None:
                 raise # and go to except  
         except: 
             #using fstring 
-            config_fname= f'{data=}'.split('=')[0]
+            config_fname= f'{data}'.split('=')[0]
             
     elif config_fname is not None: 
         config_fname= config_fname.replace(
             f'.{config}', '').replace(f'.{config}', '').replace('.yaml', '')
     
     return config_fname
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/__init__.py` & `pycsamt-1.2.1/pycsamt/cli/__init__.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/cli/avg2edi.py` & `pycsamt-1.2.1/pycsamt/cli/avg2edi.py`

 * *Files 1% similar despite different names*

```diff
@@ -5,15 +5,15 @@
     <$ avg2edi -d='data/avg/K1.AVG -p=data/avg/K1.stn -s=data/K1_edi>
     <$ python pycsamt/cli/avg2edi.py  -d='data/avg/K1.AVG -p=data/avg/K1.stn >
      
 """
 
 import os  
 import argparse 
-from pycsamt.ff.core import CSAMT
+from pycsamt.core import CSAMT
 
 PROG = os.path.basename (__file__).replace('.py', '')
 
 def main(): 
     parser =argparse.ArgumentParser(
         prog= PROG, 
         formatter_class=argparse.ArgumentDefaultsHelpFormatter ,
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/correctedi.py` & `pycsamt-1.2.1/pycsamt/cli/correctedi.py`

 * *Files 5% similar despite different names*

```diff
@@ -10,15 +10,15 @@
 
 """
 
 import os 
 import sys 
 import argparse 
 from pycsamt.utils.func_utils import smart_format 
-from pycsamt.ff.processing import Processing, corr
+from pycsamt.processing import Processing, corr
 
 PROG = os.path.basename (__file__).replace('.py', '')
 
 def main(): 
     parser =argparse.ArgumentParser(
         prog= PROG, 
         formatter_class=argparse.ArgumentDefaultsHelpFormatter ,
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/fitforward.py` & `pycsamt-1.2.1/pycsamt/cli/fitforward.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/cli/j2edi.py` & `pycsamt-1.2.1/pycsamt/cli/j2edi.py`

 * *Files 1% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 """
 
 import os 
 import sys 
 import argparse 
 
 # import pycsamt
-from pycsamt.ff.core import CSAMT
+from pycsamt.core import CSAMT
 PROG = os.path.basename (__file__).replace('.py', '')
 
 def main(): 
     parser =argparse.ArgumentParser(
         prog= PROG, 
         formatter_class=argparse.ArgumentDefaultsHelpFormatter ,
         description= "Output J-EDI from Alan G. Jones (1994)  J/DAT file",
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/misfit2d.py` & `pycsamt-1.2.1/pycsamt/cli/misfit2d.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/cli/myconfigfile.py` & `pycsamt-1.2.1/pycsamt/cli/myconfigfile.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/cli/nm.py` & `pycsamt-1.2.1/pycsamt/cli/nm.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/cli/occambuildinputs.py` & `pycsamt-1.2.1/pycsamt/cli/occambuildinputs.py`

 * *Files 1% similar despite different names*

```diff
@@ -78,19 +78,20 @@
                     default=100., 
                     help = """Number of iterations to run for building model blocks"""
                     )
     
 
     parser.add_argument( '-mode', '--occam-mode', 
                     dest ='occam_mode',
-                    choices= ('1', '2', '5', '6'), 
+                    choices= ('1', '2','4',  '5', '6'), 
                     default='6', 
                     help = """Occam model modes.
                     1 or log_all       --->   Log resistivity of TE and TM plus Tipper(MT),
                     2 or log_te_tip    --->   Log resistivity of TE plus Tipper(MT),
+                    4 or log_te_tm     --->   Log resistivity of TE and TM
                     5 or log_te        --->   Log resistivity of TE,
                     6 or log_tm        --->   Log resistivity of TM, 
                     Get more info in :doc:`~pycsamt.modeling.occam2d.Data` or 
                     refer to < http://marineemlab.ucsd.edu/Projects/Occam/sharp/index.html> 
                     If you want to implement for other modes for MT data, see <https://github.com/MTgeophysics/mtpy.git`
                     """
                     )
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/penetration1d.py` & `pycsamt-1.2.1/pycsamt/cli/penetration1d.py`

 * *Files 2% similar despite different names*

```diff
@@ -4,15 +4,15 @@
     < python penetration1d -d=data/edi -f 1024 3000 8000 -o=portrait>
 
 """
 
 import os 
 import sys 
 import argparse 
-from pycsamt.viewer.plot import Plot1d 
+from pycsamt.view.plot import Plot1d 
 
 PROG = os.path.basename (__file__).replace('.py', '')
 
 cmd = ['EXAMPLE COMMANDS: < $ penetration1d data/edi -f 1024 300 8000 -o=portrait --verbose >', 
     '< $ python pycsamt/cli/penetration1d.py data/avg/K1.avg -f=1024 -p=data/avg/K1.stn >', 
     '< $ python pycsamt/cli/penetration1d.py data/edi -f 1024 3000 8000 -o=portrait >',
 ]
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/penetration2d.py` & `pycsamt-1.2.1/pycsamt/cli/penetration2d.py`

 * *Files 0% similar despite different names*

```diff
@@ -3,15 +3,15 @@
 Created on Sat Nov 27 16:25:59 2021
     < $ penetration2d data/j --style pcolormesh>
 """
 
 import os 
 import sys 
 import argparse 
-from pycsamt.viewer.plot import Plot2d 
+from pycsamt.view.plot import Plot2d 
 
 PROG = os.path.basename (__file__).replace('.py', '')
 
 def main(): 
     parser =argparse.ArgumentParser(
         prog= PROG, 
         formatter_class=argparse.ArgumentDefaultsHelpFormatter ,
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/pseudocrossresistivityandphase.py` & `pycsamt-1.2.1/pycsamt/cli/pseudocrossresistivityandphase.py`

 * *Files 0% similar despite different names*

```diff
@@ -10,15 +10,15 @@
         
 @author: @Daniel03
 """
 
 import os 
 import sys 
 import argparse 
-from pycsamt.viewer.plot import Plot2d 
+from pycsamt.view.plot import Plot2d 
 
 PROG = os.path.basename (__file__).replace('.py', '')
 mpl_ls ='https://matplotlib.org/stable/gallery/lines_bars_and_markers/linestyles.html'
 def main(): 
     parser =argparse.ArgumentParser(
         prog= PROG, 
         formatter_class=argparse.ArgumentDefaultsHelpFormatter ,
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/pseudostratigraphic.py` & `pycsamt-1.2.1/pycsamt/cli/pseudostratigraphic.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/cli/rewriteedi.py` & `pycsamt-1.2.1/pycsamt/cli/rewriteedi.py`

 * *Files 1% similar despite different names*

```diff
@@ -8,15 +8,15 @@
     < rewriteedi -d data/edi/new_csa000.edi -n=testedi --dtype=emap --verbose=4  >
 
 """
 
 import os 
 import sys 
 import argparse 
-from pycsamt.ff.core.edi import Edi 
+from pycsamt.core.edi import Edi 
 
 PROG = os.path.basename (__file__).replace('.py', '')
 
 def main(): 
     parser =argparse.ArgumentParser(
         prog= PROG, 
         formatter_class=argparse.ArgumentDefaultsHelpFormatter ,
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/rms.py` & `pycsamt-1.2.1/pycsamt/cli/rms.py`

 * *Files 1% similar despite different names*

```diff
@@ -3,15 +3,15 @@
 Created on Sat Nov 27 16:40:47 2021
     < rms  data/occam2d/LogFile.logfile >
     
 """
 import os 
  
 import argparse 
-from pycsamt.viewer.plot import Plot1d
+from pycsamt.view.plot import Plot1d
 PROG = os.path.basename (__file__).replace('.py', '')
 
 def main (): 
     parser =argparse.ArgumentParser(
         prog= PROG, 
         formatter_class=argparse.ArgumentDefaultsHelpFormatter ,
         description= " Visualize the R.M.S of Occam2D FE forward modeling",
```

### Comparing `pycsamt-1.1.2/pycsamt/cli/staticshift.py` & `pycsamt-1.2.1/pycsamt/cli/staticshift.py`

 * *Files 1% similar despite different names*

```diff
@@ -7,15 +7,15 @@
 """
 
 
 import os 
 import sys 
 import argparse 
 from pycsamt.utils.func_utils import smart_format 
-from pycsamt.viewer.plot import Plot1d
+from pycsamt.view.plot import Plot1d
 
 PROG = os.path.basename (__file__).replace('.py', '')
 
 def main(): 
     parser =argparse.ArgumentParser(
         prog= PROG, 
         formatter_class=argparse.ArgumentDefaultsHelpFormatter ,
```

### Comparing `pycsamt-1.1.2/pycsamt/ff/core/avg.py` & `pycsamt-1.2.1/pycsamt/core/avg.py`

 * *Files 6% similar despite different names*

```diff
@@ -5,12750 +5,12614 @@
 00000040: 3230 3230 0d0a 2320 2020 2020 2020 4175  2020..#       Au
 00000050: 7468 6f72 3a20 4b6f 7561 6469 6f20 4b2e  thor: Kouadio K.
 00000060: 4c61 7572 656e 743c 6574 616e 6f79 6175  Laurent<etanoyau
 00000070: 4067 6d61 696c 2e63 6f6d 3e0d 0a23 2020  @gmail.com>..#  
 00000080: 2020 2020 204c 6963 656e 6365 3a20 4c47       Licence: LG
 00000090: 504c 0d0a 2222 220d 0a2e 2e20 5f6d 6f64  PL..""".... _mod
 000000a0: 756c 652d 6176 673a 3a20 6070 7963 7361  ule-avg:: `pycsa
-000000b0: 6d74 2e66 662e 636f 7265 2e61 7667 6020  mt.ff.core.avg` 
-000000c0: 200d 0a0d 0a20 2020 203a 7379 6e6f 7073   ....    :synops
-000000d0: 6973 3a20 4d6f 6475 6c65 2074 6f20 6465  is: Module to de
-000000e0: 616c 2077 6974 6820 4156 4720 6669 6c65  al with AVG file
-000000f0: 2e20 6561 6368 2073 6563 7469 6f6e 206f  . each section o
-00000100: 6620 4176 6720 6669 6c65 2069 7320 6120  f Avg file is a 
-00000110: 636c 6173 7320 0d0a 2020 2020 4176 6720  class ..    Avg 
-00000120: 6669 6c65 2066 726f 6d20 5a6f 6e67 6520  file from Zonge 
-00000130: 456e 6765 6e65 6572 696e 6720 636f 6d70  Engeneering comp
-00000140: 616e 7920 6973 2074 776f 2074 7970 6573  any is two types
-00000150: 202e 206d 6f64 756c 6520 7769 6c6c 2072   . module will r
-00000160: 6561 6420 0d0a 2020 2020 7468 6520 6d61  ead ..    the ma
-00000170: 696e 2066 696c 6520 7479 7065 2061 7320  in file type as 
-00000180: 5479 7065 2031 202e 2074 6865 206f 7468  Type 1 . the oth
-00000190: 6520 7479 7065 206f 6620 4156 4720 7769  e type of AVG wi
-000001a0: 6c6c 2072 6577 7269 7465 206f 6e20 740d  ll rewrite on t.
-000001b0: 0a20 2020 2074 6865 206d 6169 6e20 7479  .    the main ty
-000001c0: 7065 2e20 7468 6520 6d6f 6475 6c65 2063  pe. the module c
-000001d0: 616e 2065 7870 6f72 2074 6861 7420 6669  an expor that fi
-000001e0: 6c65 2066 6f72 206f 7468 6572 2075 7365  le for other use
-000001f0: 202e 0d0a 2020 2020 0d0a 2222 220d 0a0d   ...    .."""...
-00000200: 0a69 6d70 6f72 7420 6f73 0d0a 2320 696d  .import os..# im
-00000210: 706f 7274 2072 6520 0d0a 696d 706f 7274  port re ..import
-00000220: 2077 6172 6e69 6e67 730d 0a69 6d70 6f72   warnings..impor
-00000230: 7420 7368 7574 696c 0d0a 696d 706f 7274  t shutil..import
-00000240: 206e 756d 7079 2061 7320 6e70 0d0a 696d   numpy as np..im
-00000250: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
-00000260: 640d 0a66 726f 6d20 2064 6174 6574 696d  d..from  datetim
-00000270: 6520 696d 706f 7274 2028 6461 7465 7469  e import (dateti
-00000280: 6d65 2c20 7469 6d65 7a6f 6e65 290d 0a0d  me, timezone)...
-00000290: 0a66 726f 6d20 7079 6373 616d 742e 7574  .from pycsamt.ut
-000002a0: 696c 7320 696d 706f 7274 205f 7020 6173  ils import _p as
-000002b0: 2069 6e66 4f53 0d0a 6672 6f6d 2070 7963   infOS..from pyc
-000002c0: 7361 6d74 2e75 7469 6c73 2e64 6563 6f72  samt.utils.decor
-000002d0: 6174 6f72 2069 6d70 6f72 7420 6465 7072  ator import depr
-000002e0: 6563 6174 6564 0d0a 6672 6f6d 2070 7963  ecated..from pyc
-000002f0: 7361 6d74 2e66 662e 7369 7465 2069 6d70  samt.ff.site imp
-00000300: 6f72 7420 5369 7465 200d 0a66 726f 6d20  ort Site ..from 
-00000310: 7079 6373 616d 742e 7574 696c 7320 696d  pycsamt.utils im
-00000320: 706f 7274 207a 6361 6c63 756c 6174 6f72  port zcalculator
-00000330: 2061 7320 5a63 630d 0a66 726f 6d20 7079   as Zcc..from py
-00000340: 6373 616d 742e 7574 696c 732e 5f63 7361  csamt.utils._csa
-00000350: 6d74 7079 6c6f 6720 696d 706f 7274 2063  mtpylog import c
-00000360: 7361 6d74 7079 6c6f 670d 0a66 726f 6d20  samtpylog..from 
-00000370: 7079 6373 616d 742e 7574 696c 7320 696d  pycsamt.utils im
-00000380: 706f 7274 2061 7667 5f75 7469 6c73 2061  port avg_utils a
-00000390: 7320 6366 756e 630d 0a66 726f 6d20 7079  s cfunc..from py
-000003a0: 6373 616d 742e 7574 696c 7320 696d 706f  csamt.utils impo
-000003b0: 7274 2066 756e 635f 7574 696c 7320 6173  rt func_utils as
-000003c0: 2066 756e 630d 0a66 726f 6d20 7079 6373   func..from pycs
-000003d0: 616d 742e 7574 696c 7320 696d 706f 7274  amt.utils import
-000003e0: 2065 7863 6570 7469 6f6e 7320 6173 2043   exceptions as C
-000003f0: 5365 780d 0a0d 0a5f 6c6f 6767 6572 3d63  Sex...._logger=c
-00000400: 7361 6d74 7079 6c6f 672e 6765 745f 6373  samtpylog.get_cs
-00000410: 616d 7470 795f 6c6f 6767 6572 285f 5f6e  amtpy_logger(__n
-00000420: 616d 655f 5f29 0d0a 0d0a 0d0a 0d0a 636c  ame__)........cl
-00000430: 6173 7320 4176 6720 286f 626a 6563 7429  ass Avg (object)
-00000440: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-00000450: 4120 7375 7065 7220 636c 6173 7320 6f66  A super class of
-00000460: 2061 6c6c 2063 6f6e 7465 6e74 206f 6620   all content of 
-00000470: 4156 4720 5a6f 6e67 6520 6669 6c65 200d  AVG Zonge file .
-00000480: 0a20 2020 200d 0a20 2020 2020 2020 2044  .    ..        D
-00000490: 6561 6c20 7769 7468 205a 6f6e 6765 2045  eal with Zonge E
-000004a0: 6e67 6565 7269 6e67 2041 7667 2066 696c  ngeering Avg fil
-000004b0: 6520 2e0d 0a20 2020 2020 2020 200d 0a20  e ...        .. 
-000004c0: 2020 2041 7267 756d 656e 7473 200d 0a20     Arguments .. 
-000004d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-000004e0: 2020 2020 2020 202a 2a64 6174 615f 666e         **data_fn
-000004f0: 2a2a 3a20 7374 7220 0d0a 2020 2020 2020  **: str ..      
-00000500: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00000510: 7468 2074 6f20 4156 4720 6669 6c65 200d  th to AVG file .
-00000520: 0a20 2020 2020 2020 200d 0a20 2020 203d  .        ..    =
-00000530: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
-00000540: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d   ===========  ==
-00000550: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000560: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000570: 3d3d 3d3d 3d0d 0a20 2020 2041 7474 7269  =====..    Attri
-00000580: 6275 7465 7320 2020 2020 2020 2020 5479  butes         Ty
-00000590: 7065 2020 2020 2020 2020 4578 706c 616e  pe        Explan
-000005a0: 6174 696f 6e0d 0a20 2020 203d 3d3d 3d3d  ation..    =====
-000005b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
-000005c0: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-000005d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000005e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000005f0: 3d0d 0a20 2020 2048 6561 6465 7220 2020  =..    Header   
-00000600: 2020 2020 2020 2020 2020 636c 6173 7320            class 
-00000610: 2020 2020 2020 2063 6f6e 7461 696e 6572         container
-00000620: 206f 6620 4865 6164 6572 2069 6e66 6f72   of Header infor
-00000630: 6d61 7469 6f6e 7320 0d0a 2020 2020 4461  mations ..    Da
-00000640: 7461 5f73 6563 7469 6f6e 2020 2020 2020  ta_section      
-00000650: 2063 6c61 7373 2020 2020 2020 2020 636f   class        co
-00000660: 6e74 6169 6e65 7220 6f66 2061 6c6c 2044  ntainer of all D
-00000670: 6174 6120 696e 666f 726d 6174 696f 6e73  ata informations
-00000680: 2020 200d 0a20 2020 2053 6b69 705f 666c     ..    Skip_fl
-00000690: 6167 2020 2020 2020 2020 2020 7374 7220  ag          str 
-000006a0: 2020 2020 2020 2020 2076 616c 7565 2074           value t
-000006b0: 6f20 6a75 6764 6520 7468 6520 7175 616c  o jugde the qual
-000006c0: 6974 7920 6f66 2064 6174 6120 0d0a 2020  ity of data ..  
-000006d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000006e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000006f0: 2020 6361 6e20 6669 6c6c 6564 2061 7574    can filled aut
-00000700: 6f6d 6174 6963 616c 6c79 202e 2049 6620  omatically . If 
-00000710: 6e6f 2073 6b70 200d 0a20 2020 2020 2020  no skp ..       
-00000720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000730: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00000740: 7565 2069 7320 7072 6f76 6964 6520 2c20  ue is provide , 
-00000750: 7468 6520 7072 6f67 7261 6d20 7769 6c6c  the program will
-00000760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000780: 2020 2020 2020 6a75 6467 6520 7175 616c        judge qual
-00000790: 6974 7920 6f66 2070 726f 7669 6465 6420  ity of provided 
-000007a0: 6461 7461 200d 0a20 2020 2020 2020 2020  data ..         
+000000b0: 6d74 2e63 6f72 652e 6176 6760 2020 0d0a  mt.core.avg`  ..
+000000c0: 0d0a 2020 2020 3a73 796e 6f70 7369 733a  ..    :synopsis:
+000000d0: 204d 6f64 756c 6520 746f 2064 6561 6c20   Module to deal 
+000000e0: 7769 7468 2041 5647 2066 696c 652e 2065  with AVG file. e
+000000f0: 6163 6820 7365 6374 696f 6e20 6f66 2041  ach section of A
+00000100: 7667 2066 696c 6520 6973 2061 2063 6c61  vg file is a cla
+00000110: 7373 200d 0a20 2020 2041 7667 2066 696c  ss ..    Avg fil
+00000120: 6520 6672 6f6d 205a 6f6e 6765 2045 6e67  e from Zonge Eng
+00000130: 656e 6565 7269 6e67 2063 6f6d 7061 6e79  eneering company
+00000140: 2069 7320 7477 6f20 7479 7065 7320 2e20   is two types . 
+00000150: 6d6f 6475 6c65 2077 696c 6c20 7265 6164  module will read
+00000160: 200d 0a20 2020 2074 6865 206d 6169 6e20   ..    the main 
+00000170: 6669 6c65 2074 7970 6520 6173 2054 7970  file type as Typ
+00000180: 6520 3120 2e20 7468 6520 6f74 6865 2074  e 1 . the othe t
+00000190: 7970 6520 6f66 2041 5647 2077 696c 6c20  ype of AVG will 
+000001a0: 7265 7772 6974 6520 6f6e 2074 0d0a 2020  rewrite on t..  
+000001b0: 2020 7468 6520 6d61 696e 2074 7970 652e    the main type.
+000001c0: 2074 6865 206d 6f64 756c 6520 6361 6e20   the module can 
+000001d0: 6578 706f 7220 7468 6174 2066 696c 6520  expor that file 
+000001e0: 666f 7220 6f74 6865 7220 7573 6520 2e0d  for other use ..
+000001f0: 0a20 2020 200d 0a22 2222 0d0a 0d0a 696d  .    .."""....im
+00000200: 706f 7274 206f 730d 0a23 2069 6d70 6f72  port os..# impor
+00000210: 7420 7265 200d 0a69 6d70 6f72 7420 7761  t re ..import wa
+00000220: 726e 696e 6773 0d0a 696d 706f 7274 2073  rnings..import s
+00000230: 6875 7469 6c0d 0a69 6d70 6f72 7420 6e75  hutil..import nu
+00000240: 6d70 7920 6173 206e 700d 0a69 6d70 6f72  mpy as np..impor
+00000250: 7420 7061 6e64 6173 2061 7320 7064 0d0a  t pandas as pd..
+00000260: 6672 6f6d 2020 6461 7465 7469 6d65 2069  from  datetime i
+00000270: 6d70 6f72 7420 2864 6174 6574 696d 652c  mport (datetime,
+00000280: 2074 696d 657a 6f6e 6529 0d0a 0d0a 6672   timezone)....fr
+00000290: 6f6d 2070 7963 7361 6d74 2e5f 6373 616d  om pycsamt._csam
+000002a0: 7470 796c 6f67 2069 6d70 6f72 7420 6373  tpylog import cs
+000002b0: 616d 7470 796c 6f67 0d0a 6672 6f6d 2070  amtpylog..from p
+000002c0: 7963 7361 6d74 2e75 7469 6c73 2069 6d70  ycsamt.utils imp
+000002d0: 6f72 7420 5f70 2061 7320 696e 664f 530d  ort _p as infOS.
+000002e0: 0a66 726f 6d20 7079 6373 616d 742e 7574  .from pycsamt.ut
+000002f0: 696c 732e 6465 636f 7261 746f 7220 696d  ils.decorator im
+00000300: 706f 7274 2064 6570 7265 6361 7465 640d  port deprecated.
+00000310: 0a66 726f 6d20 7079 6373 616d 742e 7369  .from pycsamt.si
+00000320: 7465 2069 6d70 6f72 7420 5369 7465 200d  te import Site .
+00000330: 0a66 726f 6d20 7079 6373 616d 742e 7574  .from pycsamt.ut
+00000340: 696c 7320 696d 706f 7274 207a 6361 6c63  ils import zcalc
+00000350: 756c 6174 6f72 2061 7320 5a63 630d 0a66  ulator as Zcc..f
+00000360: 726f 6d20 7079 6373 616d 742e 7574 696c  rom pycsamt.util
+00000370: 7320 696d 706f 7274 2061 7667 5f75 7469  s import avg_uti
+00000380: 6c73 2061 7320 6366 756e 6320 0d0a 6672  ls as cfunc ..fr
+00000390: 6f6d 2070 7963 7361 6d74 2e75 7469 6c73  om pycsamt.utils
+000003a0: 2069 6d70 6f72 7420 6675 6e63 5f75 7469   import func_uti
+000003b0: 6c73 2061 7320 6675 6e63 0d0a 2366 726f  ls as func..#fro
+000003c0: 6d20 7079 6373 616d 742e 7574 696c 7320  m pycsamt.utils 
+000003d0: 696d 706f 7274 2065 7863 6570 7469 6f6e  import exception
+000003e0: 7320 6173 2043 5365 780d 0a66 726f 6d20  s as CSex..from 
+000003f0: 7079 6373 616d 742e 6578 6365 7074 696f  pycsamt.exceptio
+00000400: 6e73 2069 6d70 6f72 7420 2820 0d0a 2020  ns import ( ..  
+00000410: 2020 4156 4745 7272 6f72 2c20 0d0a 2020    AVGError, ..  
+00000420: 2020 436f 6e66 6967 4669 6c65 4572 726f    ConfigFileErro
+00000430: 722c 200d 0a20 2020 2046 7265 7175 656e  r, ..    Frequen
+00000440: 6379 4572 726f 722c 200d 0a20 2020 2053  cyError, ..    S
+00000450: 7461 7469 6f6e 4572 726f 722c 200d 0a20  tationError, .. 
+00000460: 2020 2048 6561 6465 7245 7272 6f72 2c20     HeaderError, 
+00000470: 0d0a 2020 2020 5a45 7272 6f72 2c20 0d0a  ..    ZError, ..
+00000480: 2020 2020 5072 6f63 6573 7369 6e67 4572      ProcessingEr
+00000490: 726f 722c 200d 0a20 2020 2052 6573 6973  ror, ..    Resis
+000004a0: 7469 7669 7479 4572 726f 722c 200d 0a20  tivityError, .. 
+000004b0: 2020 2050 6861 7365 4572 726f 722c 0d0a     PhaseError,..
+000004c0: 2020 2020 0d0a 2020 2020 290d 0a5f 6c6f      ..    ).._lo
+000004d0: 6767 6572 3d63 7361 6d74 7079 6c6f 672e  gger=csamtpylog.
+000004e0: 6765 745f 6373 616d 7470 795f 6c6f 6767  get_csamtpy_logg
+000004f0: 6572 285f 5f6e 616d 655f 5f29 0d0a 0d0a  er(__name__)....
+00000500: 0d0a 0d0a 636c 6173 7320 4176 6720 286f  ....class Avg (o
+00000510: 626a 6563 7429 3a0d 0a20 2020 2022 2222  bject):..    """
+00000520: 0d0a 2020 2020 4120 7375 7065 7220 636c  ..    A super cl
+00000530: 6173 7320 6f66 2061 6c6c 2063 6f6e 7465  ass of all conte
+00000540: 6e74 206f 6620 4156 4720 5a6f 6e67 6520  nt of AVG Zonge 
+00000550: 6669 6c65 200d 0a20 2020 200d 0a20 2020  file ..    ..   
+00000560: 2020 2020 2044 6561 6c20 7769 7468 205a       Deal with Z
+00000570: 6f6e 6765 2045 6e67 6565 7269 6e67 2041  onge Engeering A
+00000580: 7667 2066 696c 6520 2e0d 0a20 2020 2020  vg file ...     
+00000590: 2020 200d 0a20 2020 2041 7267 756d 656e     ..    Argumen
+000005a0: 7473 200d 0a20 2020 202d 2d2d 2d2d 2d2d  ts ..    -------
+000005b0: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a64  ---..        **d
+000005c0: 6174 615f 666e 2a2a 3a20 7374 7220 0d0a  ata_fn**: str ..
+000005d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000005e0: 2020 2020 7061 7468 2074 6f20 4156 4720      path to AVG 
+000005f0: 6669 6c65 200d 0a20 2020 2020 2020 200d  file ..        .
+00000600: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+00000610: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00000620: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+00000630: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000640: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+00000650: 2041 7474 7269 6275 7465 7320 2020 2020   Attributes     
+00000660: 2020 2020 5479 7065 2020 2020 2020 2020      Type        
+00000670: 4578 706c 616e 6174 696f 6e0d 0a20 2020  Explanation..   
+00000680: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00000690: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  =  ===========  
+000006a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000006b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000006c0: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2048 6561  =======..    Hea
+000006d0: 6465 7220 2020 2020 2020 2020 2020 2020  der             
+000006e0: 636c 6173 7320 2020 2020 2020 2063 6f6e  class        con
+000006f0: 7461 696e 6572 206f 6620 4865 6164 6572  tainer of Header
+00000700: 2069 6e66 6f72 6d61 7469 6f6e 7320 0d0a   informations ..
+00000710: 2020 2020 4461 7461 5f73 6563 7469 6f6e      Data_section
+00000720: 2020 2020 2020 2063 6c61 7373 2020 2020         class    
+00000730: 2020 2020 636f 6e74 6169 6e65 7220 6f66      container of
+00000740: 2061 6c6c 2044 6174 6120 696e 666f 726d   all Data inform
+00000750: 6174 696f 6e73 2020 200d 0a20 2020 2053  ations   ..    S
+00000760: 6b69 705f 666c 6167 2020 2020 2020 2020  kip_flag        
+00000770: 2020 7374 7220 2020 2020 2020 2020 2076    str          v
+00000780: 616c 7565 2074 6f20 6a75 6764 6520 7468  alue to jugde th
+00000790: 6520 7175 616c 6974 7920 6f66 2064 6174  e quality of dat
+000007a0: 6120 0d0a 2020 2020 2020 2020 2020 2020  a ..            
 000007b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000007c0: 2020 2020 2020 2020 2020 2061 6e64 2073             and s
-000007d0: 6574 2074 6f20 6869 6d20 6120 7363 6f72  et to him a scor
-000007e0: 6520 2e0d 0a20 2020 203d 3d3d 3d3d 3d3d  e ...    =======
-000007f0: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-00000800: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-00000810: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000820: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-00000830: 0a0d 0a20 2020 204d 6f72 6520 6174 7472  ...    More attr
-00000840: 6962 7574 6573 2063 616e 2062 6520 6164  ibutes can be ad
-00000850: 6465 6420 6279 2069 6e70 7574 696e 6720  ded by inputing 
-00000860: 6120 6b65 7920 776f 7264 2064 6963 7469  a key word dicti
-00000870: 6f6e 6172 790d 0a20 2020 200d 0a20 2020  onary..    ..   
-00000880: 203a 4578 616d 706c 653a 0d0a 2020 2020   :Example:..    
-00000890: 2020 2020 0d0a 2020 2020 2020 2020 3e3e      ..        >>
-000008a0: 3e20 4176 675f 6f62 6a65 6374 203d 4461  > Avg_object =Da
-000008b0: 7461 2864 6174 615f 6172 7261 793d 6176  ta(data_array=av
-000008c0: 675f 6461 7461 2029 0d0a 2020 2020 2020  g_data )..      
-000008d0: 2020 3e3e 3e20 7374 6e3d 4441 5441 2e53    >>> stn=DATA.S
-000008e0: 7461 7469 6f6e 2e6e 616d 6520 0d0a 2020  tation.name ..  
-000008f0: 2020 2020 2020 3e3e 3e20 6672 6571 3d44        >>> freq=D
-00000900: 4154 412e 4672 6571 7565 6e63 792e 7661  ATA.Frequency.va
-00000910: 6c75 650d 0a20 2020 2022 2222 0d0a 2020  lue..    """..  
-00000920: 2020 656e 636f 6461 6765 203d 2775 7466    encodage ='utf
-00000930: 3827 0d0a 2020 2020 6465 6620 5f5f 696e  8'..    def __in
-00000940: 6974 5f5f 2873 656c 662c 2064 6174 615f  it__(self, data_
-00000950: 666e 3d4e 6f6e 6520 2c20 202a 2a6b 7761  fn=None ,  **kwa
-00000960: 7267 7329 3a0d 0a20 2020 2020 2020 2073  rgs):..        s
-00000970: 656c 662e 5f6c 6f67 6769 6e67 203d 6373  elf._logging =cs
-00000980: 616d 7470 796c 6f67 2e67 6574 5f63 7361  amtpylog.get_csa
-00000990: 6d74 7079 5f6c 6f67 6765 7228 7365 6c66  mtpy_logger(self
-000009a0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-000009b0: 655f 5f29 0d0a 2020 2020 2020 2020 7365  e__)..        se
-000009c0: 6c66 2e64 6174 615f 666e 203d 6461 7461  lf.data_fn =data
-000009d0: 5f66 6e0d 0a20 2020 2020 2020 2073 656c  _fn..        sel
-000009e0: 662e 4865 6164 6572 3d48 6561 6465 7228  f.Header=Header(
-000009f0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00000a00: 4461 7461 5f73 6563 7469 6f6e 203d 4461  Data_section =Da
-00000a10: 7461 2829 0d0a 2020 2020 2020 2020 7365  ta()..        se
-00000a20: 6c66 2e53 6b69 705f 666c 6167 203d 536b  lf.Skip_flag =Sk
-00000a30: 6970 5f66 6c61 6728 290d 0a20 2020 2020  ip_flag()..     
-00000a40: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-00000a50: 662e 7072 6f66 696c 655f 666e 203d 6b77  f.profile_fn =kw
-00000a60: 6172 6773 2e70 6f70 2827 7072 6f66 696c  args.pop('profil
-00000a70: 655f 666e 272c 204e 6f6e 6529 0d0a 2020  e_fn', None)..  
-00000a80: 2020 2020 2020 0d0a 0d0a 2020 2020 2020        ....      
-00000a90: 2020 7365 6c66 2e5f 6631 5f6c 6162 656c    self._f1_label
-00000aa0: 7320 2c20 7365 6c66 2e5f 6632 5f6c 6162  s , self._f2_lab
-00000ab0: 656c 733d 5b27 736b 7027 2c27 5374 6174  els=['skp','Stat
-00000ac0: 696f 6e27 2c0d 0a20 2020 2020 2020 2020  ion',..         
-00000ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000af0: 2020 2720 4672 6571 272c 2743 6f6d 7027    ' Freq','Comp'
-00000b00: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00000b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000b20: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
-00000b30: 416d 7073 272c 2745 6d61 6727 2c0d 0a20  Amps','Emag',.. 
-00000b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000b60: 2020 2020 2020 2020 2020 2745 7068 7a27            'Ephz'
-00000b70: 2c27 486d 6167 272c 0d0a 2020 2020 2020  ,'Hmag',..      
-00000b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ba0: 2020 2020 2027 4870 687a 272c 2752 6573       'Hphz','Res
-00000bb0: 6973 7469 7669 7479 272c 0d0a 2020 2020  istivity',..    
-00000bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000be0: 2020 2020 2020 2027 5068 6173 6527 2c27         'Phase','
-00000bf0: 2545 6d61 6727 2c0d 0a20 2020 2020 2020  %Emag',..       
-00000c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c20: 2020 2020 2773 4570 687a 272c 2725 486d      'sEphz','%Hm
-00000c30: 6167 272c 0d0a 2020 2020 2020 2020 2020  ag',..          
-00000c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c60: 2027 7348 7068 7a27 2c27 2552 686f 272c   'sHphz','%Rho',
-00000c70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c90: 2020 2020 2020 2020 2020 2020 2027 7350               'sP
-00000ca0: 687a 275d 2c5b 2773 6b70 272c 0d0a 2020  hz'],['skp',..  
-00000cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ce0: 2020 2020 2020 2746 7265 7127 2c27 5478        'Freq','Tx
-00000cf0: 2e41 6d70 272c 0d0a 2020 2020 2020 2020  .Amp',..        
-00000d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000d30: 2745 2e6d 6167 272c 2745 2e70 687a 272c  'E.mag','E.phz',
-00000d40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000d70: 2020 2020 2020 2020 2020 2742 2e6d 6167            'B.mag
-00000d80: 272c 2742 2e70 687a 272c 0d0a 2020 2020  ','B.phz',..    
-00000d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000dc0: 2020 2020 275a 2e6d 6167 272c 275a 2e70      'Z.mag','Z.p
-00000dd0: 687a 272c 0d0a 2020 2020 2020 2020 2020  hz',..          
-00000de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e00: 2020 2020 2020 2020 2020 2020 2020 2741                'A
-00000e10: 5265 732e 6d61 6727 2c27 5352 6573 272c  Res.mag','SRes',
-00000e20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e50: 2020 2020 2020 2020 2020 2745 2e77 6774            'E.wgt
-00000e60: 272c 2027 422e 7767 7427 2c0d 0a20 2020  ', 'B.wgt',..   
-00000e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ea0: 2020 2020 2027 452e 2565 7272 272c 2745       'E.%err','E
-00000eb0: 2e70 6572 7227 2c0d 0a20 2020 2020 2020  .perr',..       
-00000ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ef0: 2027 422e 2565 7272 272c 2742 2e70 6572   'B.%err','B.per
-00000f00: 7227 2c0d 0a20 2020 2020 2020 2020 2020  r',..           
+000007c0: 2020 2020 2020 2020 6361 6e20 6669 6c6c          can fill
+000007d0: 6564 2061 7574 6f6d 6174 6963 616c 6c79  ed automatically
+000007e0: 202e 2049 6620 6e6f 2073 6b70 200d 0a20   . If no skp .. 
+000007f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000810: 2020 2076 616c 7565 2069 7320 7072 6f76     value is prov
+00000820: 6964 6520 2c20 7468 6520 7072 6f67 7261  ide , the progra
+00000830: 6d20 7769 6c6c 0d0a 2020 2020 2020 2020  m will..        
+00000840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000850: 2020 2020 2020 2020 2020 2020 6a75 6467              judg
+00000860: 6520 7175 616c 6974 7920 6f66 2070 726f  e quality of pro
+00000870: 7669 6465 6420 6461 7461 200d 0a20 2020  vided data ..   
+00000880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000008a0: 2061 6e64 2073 6574 2074 6f20 6869 6d20   and set to him 
+000008b0: 6120 7363 6f72 6520 2e0d 0a20 2020 203d  a score ...    =
+000008c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+000008d0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d   ===========  ==
+000008e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000008f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000900: 3d3d 3d3d 3d0d 0a0d 0a20 2020 204d 6f72  =====....    Mor
+00000910: 6520 6174 7472 6962 7574 6573 2063 616e  e attributes can
+00000920: 2062 6520 6164 6465 6420 6279 2069 6e70   be added by inp
+00000930: 7574 696e 6720 6120 6b65 7920 776f 7264  uting a key word
+00000940: 2064 6963 7469 6f6e 6172 790d 0a20 2020   dictionary..   
+00000950: 200d 0a20 2020 203a 4578 616d 706c 653a   ..    :Example:
+00000960: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00000970: 2020 2020 3e3e 3e20 4176 675f 6f62 6a65      >>> Avg_obje
+00000980: 6374 203d 4461 7461 2864 6174 615f 6172  ct =Data(data_ar
+00000990: 7261 793d 6176 675f 6461 7461 2029 0d0a  ray=avg_data )..
+000009a0: 2020 2020 2020 2020 3e3e 3e20 7374 6e3d          >>> stn=
+000009b0: 4441 5441 2e53 7461 7469 6f6e 2e6e 616d  DATA.Station.nam
+000009c0: 6520 0d0a 2020 2020 2020 2020 3e3e 3e20  e ..        >>> 
+000009d0: 6672 6571 3d44 4154 412e 4672 6571 7565  freq=DATA.Freque
+000009e0: 6e63 792e 7661 6c75 650d 0a20 2020 2022  ncy.value..    "
+000009f0: 2222 0d0a 2020 2020 656e 636f 6461 6765  ""..    encodage
+00000a00: 203d 2775 7466 3827 0d0a 2020 2020 6465   ='utf8'..    de
+00000a10: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00000a20: 2064 6174 615f 666e 3d4e 6f6e 6520 2c20   data_fn=None , 
+00000a30: 202a 2a6b 7761 7267 7329 3a0d 0a20 2020   **kwargs):..   
+00000a40: 2020 2020 2073 656c 662e 5f6c 6f67 6769       self._loggi
+00000a50: 6e67 203d 6373 616d 7470 796c 6f67 2e67  ng =csamtpylog.g
+00000a60: 6574 5f63 7361 6d74 7079 5f6c 6f67 6765  et_csamtpy_logge
+00000a70: 7228 7365 6c66 2e5f 5f63 6c61 7373 5f5f  r(self.__class__
+00000a80: 2e5f 5f6e 616d 655f 5f29 0d0a 2020 2020  .__name__)..    
+00000a90: 2020 2020 7365 6c66 2e64 6174 615f 666e      self.data_fn
+00000aa0: 203d 6461 7461 5f66 6e0d 0a20 2020 2020   =data_fn..     
+00000ab0: 2020 2073 656c 662e 4865 6164 6572 3d48     self.Header=H
+00000ac0: 6561 6465 7228 290d 0a20 2020 2020 2020  eader()..       
+00000ad0: 2073 656c 662e 4461 7461 5f73 6563 7469   self.Data_secti
+00000ae0: 6f6e 203d 4461 7461 2829 0d0a 2020 2020  on =Data()..    
+00000af0: 2020 2020 7365 6c66 2e53 6b69 705f 666c      self.Skip_fl
+00000b00: 6167 203d 536b 6970 5f66 6c61 6728 290d  ag =Skip_flag().
+00000b10: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00000b20: 2020 2073 656c 662e 7072 6f66 696c 655f     self.profile_
+00000b30: 666e 203d 6b77 6172 6773 2e70 6f70 2827  fn =kwargs.pop('
+00000b40: 7072 6f66 696c 655f 666e 272c 204e 6f6e  profile_fn', Non
+00000b50: 6529 0d0a 2020 2020 2020 2020 0d0a 0d0a  e)..        ....
+00000b60: 2020 2020 2020 2020 7365 6c66 2e5f 6631          self._f1
+00000b70: 5f6c 6162 656c 733d 5b0d 0a20 2020 2020  _labels=[..     
+00000b80: 2020 2020 2020 2027 736b 7027 2c0d 0a20         'skp',.. 
+00000b90: 2020 2020 2020 2020 2020 2027 5374 6174             'Stat
+00000ba0: 696f 6e27 2c0d 0a20 2020 2020 2020 2020  ion',..         
+00000bb0: 2020 2027 2046 7265 7127 2c0d 0a20 2020     ' Freq',..   
+00000bc0: 2020 2020 2020 2020 2027 436f 6d70 272c           'Comp',
+00000bd0: 0d0a 2020 2020 2020 2020 2020 2020 2720  ..            ' 
+00000be0: 416d 7073 272c 0d0a 2020 2020 2020 2020  Amps',..        
+00000bf0: 2020 2020 2745 6d61 6727 2c0d 0a20 2020      'Emag',..   
+00000c00: 2020 2020 2020 2020 2027 4570 687a 272c           'Ephz',
+00000c10: 0d0a 2020 2020 2020 2020 2020 2020 2748  ..            'H
+00000c20: 6d61 6727 2c0d 0a20 2020 2020 2020 2020  mag',..         
+00000c30: 2020 2027 4870 687a 272c 0d0a 2020 2020     'Hphz',..    
+00000c40: 2020 2020 2020 2020 2752 6573 6973 7469          'Resisti
+00000c50: 7669 7479 272c 0d0a 2020 2020 2020 2020  vity',..        
+00000c60: 2020 2020 2750 6861 7365 272c 0d0a 2020      'Phase',..  
+00000c70: 2020 2020 2020 2020 2020 2725 456d 6167            '%Emag
+00000c80: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+00000c90: 2773 4570 687a 272c 0d0a 2020 2020 2020  'sEphz',..      
+00000ca0: 2020 2020 2020 2725 486d 6167 272c 0d0a        '%Hmag',..
+00000cb0: 2020 2020 2020 2020 2020 2020 2773 4870              'sHp
+00000cc0: 687a 272c 0d0a 2020 2020 2020 2020 2020  hz',..          
+00000cd0: 2020 2725 5268 6f27 2c0d 0a20 2020 2020    '%Rho',..     
+00000ce0: 2020 2020 2020 2027 7350 687a 270d 0a20         'sPhz'.. 
+00000cf0: 2020 2020 2020 2020 2020 205d 0d0a 2020             ]..  
+00000d00: 2020 2020 2020 7365 6c66 2e5f 6632 5f6c        self._f2_l
+00000d10: 6162 656c 733d 5b0d 0a20 2020 2020 2020  abels=[..       
+00000d20: 2020 2020 2027 736b 7027 2c0d 0a20 2020       'skp',..   
+00000d30: 2020 2020 2020 2020 2027 4672 6571 272c           'Freq',
+00000d40: 0d0a 2020 2020 2020 2020 2020 2020 2754  ..            'T
+00000d50: 782e 416d 7027 2c0d 0a20 2020 2020 2020  x.Amp',..       
+00000d60: 2020 2020 2027 452e 6d61 6727 2c0d 0a20       'E.mag',.. 
+00000d70: 2020 2020 2020 2020 2020 2027 452e 7068             'E.ph
+00000d80: 7a27 2c0d 0a20 2020 2020 2020 2020 2020  z',..           
+00000d90: 2027 422e 6d61 6727 2c0d 0a20 2020 2020   'B.mag',..     
+00000da0: 2020 2020 2020 2027 422e 7068 7a27 2c0d         'B.phz',.
+00000db0: 0a20 2020 2020 2020 2020 2020 2027 5a2e  .            'Z.
+00000dc0: 6d61 6727 2c0d 0a20 2020 2020 2020 2020  mag',..         
+00000dd0: 2020 2027 5a2e 7068 7a27 2c0d 0a20 2020     'Z.phz',..   
+00000de0: 2020 2020 2020 2020 2027 4152 6573 2e6d           'ARes.m
+00000df0: 6167 272c 0d0a 2020 2020 2020 2020 2020  ag',..          
+00000e00: 2020 2753 5265 7327 2c0d 0a20 2020 2020    'SRes',..     
+00000e10: 2020 2020 2020 2027 452e 7767 7427 2c20         'E.wgt', 
+00000e20: 0d0a 2020 2020 2020 2020 2020 2020 2742  ..            'B
+00000e30: 2e77 6774 272c 0d0a 2020 2020 2020 2020  .wgt',..        
+00000e40: 2020 2020 2745 2e25 6572 7227 2c0d 0a20      'E.%err',.. 
+00000e50: 2020 2020 2020 2020 2020 2027 452e 7065             'E.pe
+00000e60: 7272 272c 0d0a 2020 2020 2020 2020 2020  rr',..          
+00000e70: 2020 2742 2e25 6572 7227 2c0d 0a20 2020    'B.%err',..   
+00000e80: 2020 2020 2020 2020 2027 422e 7065 7272           'B.perr
+00000e90: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+00000ea0: 275a 2e25 6572 7227 2c0d 0a20 2020 2020  'Z.%err',..     
+00000eb0: 2020 2020 2020 2027 5a2e 7065 7272 272c         'Z.perr',
+00000ec0: 0d0a 2020 2020 2020 2020 2020 2020 2741  ..            'A
+00000ed0: 5265 732e 2565 7272 270d 0a20 2020 2020  Res.%err'..     
+00000ee0: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
+00000ef0: 2020 7365 6c66 2e5f 7a6d 6172 6b3d 2724    self._zmark='$
+00000f00: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
 00000f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00000f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000f30: 2020 2020 2020 2020 2020 2020 2027 5a2e               'Z.
-00000f40: 2565 7272 272c 275a 2e70 6572 7227 2c0d  %err','Z.perr',.
-00000f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000f80: 2020 2020 2020 2020 2020 2741 5265 732e            'ARes.
-00000f90: 2565 7272 275d 0d0a 2020 2020 2020 2020  %err']..        
-00000fa0: 7365 6c66 2e5f 7a6d 6172 6b3d 2724 270d  self._zmark='$'.
-00000fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000fe0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00000ff0: 656c 662e 454d 5f7a 6f6e 6765 326a 203d  elf.EM_zonge2j =
-00001000: 207b 2745 7848 7827 3a27 5258 5827 2c20   {'ExHx':'RXX', 
-00001010: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00001020: 2020 2020 2020 2020 2020 2020 2020 2745                'E
-00001030: 7848 7927 3a27 5258 5927 2c0d 0a20 2020  xHy':'RXY',..   
-00001040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001060: 2745 7948 7827 3a27 5259 5827 2c20 0d0a  'EyHx':'RYX', ..
-00001070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001090: 2020 2027 4579 4879 273a 2752 5959 277d     'EyHy':'RYY'}
-000010a0: 0d0a 2020 0d0a 2020 2020 2020 2020 666f  ..  ..        fo
-000010b0: 7220 6b65 7920 696e 206c 6973 7428 6b77  r key in list(kw
-000010c0: 6172 6773 2e6b 6579 7328 2929 3a0d 0a20  args.keys()):.. 
-000010d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000010e0: 5f5f 7365 7461 7474 725f 5f28 6b65 792c  __setattr__(key,
-000010f0: 206b 7761 7267 735b 6b65 795d 290d 0a20   kwargs[key]).. 
-00001100: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00001110: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
-00001120: 615f 666e 2069 7320 6e6f 7420 4e6f 6e65  a_fn is not None
-00001130: 203a 2020 2020 2020 2020 2020 2020 2020   :              
-00001140: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00001150: 2020 2020 2020 2073 656c 662e 5f72 6561         self._rea
-00001160: 645f 6176 675f 6669 6c65 2028 290d 0a20  d_avg_file ().. 
-00001170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001190: 2020 2020 200d 0a20 2020 2064 6566 205f       ..    def _
-000011a0: 7265 6164 5f61 7667 5f66 696c 6520 2873  read_avg_file (s
-000011b0: 656c 662c 2064 6174 615f 666e 3d4e 6f6e  elf, data_fn=Non
-000011c0: 6520 293a 200d 0a20 2020 2020 2020 2022  e ): ..        "
-000011d0: 2222 0d0a 2020 2020 2020 2020 4d65 7468  ""..        Meth
-000011e0: 6f64 2074 6f20 7265 6164 2061 7667 2066  od to read avg f
-000011f0: 696c 6520 616e 6420 7365 7420 6561 6368  ile and set each
-00001200: 206f 626a 6563 7473 202e 0d0a 2020 2020   objects ...    
-00001210: 2020 2020 0d0a 2020 2020 2020 2020 5468      ..        Th
-00001220: 6520 6d61 696e 2073 6f75 7263 6520 7072  e main source pr
-00001230: 6f74 6f63 6f6c 6520 746f 2074 7261 6e73  otocole to trans
-00001240: 6665 7274 2064 6174 6120 696e 746f 2063  fert data into c
-00001250: 6f72 7265 7370 6f6e 6469 6e67 2063 6c61  orresponding cla
-00001260: 7373 6573 2e20 0d0a 2020 2020 2020 2020  sses. ..        
-00001270: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00001280: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00001290: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-000012a0: 2020 2020 2020 2020 2a20 6461 7461 5f66          * data_f
-000012b0: 6e3a 2073 7472 2020 0d0a 2020 2020 2020  n: str  ..      
-000012c0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-000012d0: 7468 2074 6f20 4156 4720 6669 6c65 6e61  th to AVG filena
-000012e0: 6d65 2e20 2020 2020 200d 0a20 2020 2020  me.      ..     
-000012f0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00001300: 0d0a 2020 2020 2020 2020 6966 2064 6174  ..        if dat
-00001310: 615f 666e 2069 7320 6e6f 7420 4e6f 6e65  a_fn is not None
-00001320: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00001330: 2073 656c 662e 6461 7461 5f66 6e20 3d64   self.data_fn =d
-00001340: 6174 615f 666e 200d 0a20 2020 2020 2020  ata_fn ..       
-00001350: 2069 6620 7365 6c66 2e64 6174 615f 666e   if self.data_fn
-00001360: 2069 7320 4e6f 6e65 2020 3a0d 0a20 2020   is None  :..   
-00001370: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
-00001380: 5365 782e 7079 4353 414d 5445 7272 6f72  Sex.pyCSAMTError
-00001390: 5f61 7667 5f66 696c 6528 0d0a 2020 2020  _avg_file(..    
-000013a0: 2020 2020 2020 2020 2020 2020 274e 6f20              'No 
-000013b0: 4156 4720 6669 6c65 2066 6f75 6e64 2e50  AVG file found.P
-000013c0: 6c65 6173 6520 6368 6563 6b20 270d 0a20  lease check '.. 
-000013d0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000013e0: 796f 7572 2070 6174 6866 696c 6520 3a3c  your pathfile :<
-000013f0: 7b30 7d3e 272e 666f 726d 6174 286f 732e  {0}>'.format(os.
-00001400: 6765 7463 7764 2829 2929 0d0a 2020 2020  getcwd()))..    
-00001410: 2020 2020 2320 7072 696e 7428 7365 6c66      # print(self
-00001420: 2e64 6174 615f 666e 2920 2020 2020 2020  .data_fn)       
-00001430: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00001440: 662e 6461 7461 5f66 6e20 6973 206e 6f74  f.data_fn is not
-00001450: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
-00001460: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
-00001470: 2e69 7366 696c 6528 7365 6c66 2e64 6174  .isfile(self.dat
-00001480: 615f 666e 2920 6973 2046 616c 7365 203a  a_fn) is False :
-00001490: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000014a0: 2020 7261 6973 6520 4353 6578 2e70 7943    raise CSex.pyC
-000014b0: 5341 4d54 4572 726f 725f 4156 4728 2763  SAMTError_AVG('c
-000014c0: 6f75 6c64 206e 6f74 2066 696e 6420 2573  ould not find %s
-000014d0: 272c 2073 656c 662e 6461 7461 5f66 6e29  ', self.data_fn)
-000014e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000014f0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00001500: 2e5f 6c6f 6767 696e 672e 696e 666f 2827  ._logging.info('
-00001510: 7265 6164 696e 6720 616e 6420 6368 6563  reading and chec
-00001520: 6b69 6e67 2074 6865 2041 5647 2066 696c  king the AVG fil
-00001530: 6520 2573 272c 2073 656c 662e 6461 7461  e %s', self.data
-00001540: 5f66 6e29 2020 2020 2020 2020 200d 0a20  _fn)         .. 
-00001550: 2020 2020 2020 2023 2d2d 2d2d 2d2d 2d2d         #--------
-00001560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001570: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001590: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2023  -----..        #
-000015a0: 7365 6c66 2e64 6174 615f 666e 5b2d 343a  self.data_fn[-4:
-000015b0: 5d2e 6c6f 7765 7228 2920 213d 2027 2e61  ].lower() != '.a
-000015c0: 7667 276f 720d 0a20 2020 2020 2020 2023  vg'or..        #
-000015d0: 2073 656c 662e 6461 7461 5f66 6e2e 656e   self.data_fn.en
-000015e0: 6473 7769 7468 2827 6176 6727 2e75 7070  dswith('avg'.upp
-000015f0: 6572 2829 293d 3d46 616c 7365 206f 720d  er())==False or.
-00001600: 0a20 2020 2020 2020 2069 6620 2028 7365  .        if  (se
-00001610: 6c66 2e64 6174 615f 666e 2e65 6e64 7377  lf.data_fn.endsw
-00001620: 6974 6828 2761 7667 2729 206f 7220 5c0d  ith('avg') or \.
-00001630: 0a20 2020 2020 2020 2020 2020 2020 7365  .             se
-00001640: 6c66 2e64 6174 615f 666e 2e65 6e64 7377  lf.data_fn.endsw
-00001650: 6974 6828 2761 7667 272e 7570 7065 7228  ith('avg'.upper(
-00001660: 2929 2920 3d3d 2046 616c 7365 203a 0d0a  ))) == False :..
-00001670: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00001680: 696e 6773 2e77 6172 6e28 0d0a 2020 2020  ings.warn(..    
-00001690: 2020 2020 2020 2020 2020 2020 273c 4765              '<Ge
-000016a0: 7420 6d6f 7265 2069 6e66 6f73 2061 626f  t more infos abo
-000016b0: 7574 2041 5647 3e20 3a7b 307d 272e 666f  ut AVG> :{0}'.fo
-000016c0: 726d 6174 2869 6e66 4f53 2e6e 6f74 696f  rmat(infOS.notio
-000016d0: 6e2e 4156 4729 290d 0a20 2020 2020 2020  n.AVG))..       
-000016e0: 2020 2020 2072 6169 7365 2043 5365 782e       raise CSex.
-000016f0: 7079 4353 414d 5445 7272 6f72 5f41 5647  pyCSAMTError_AVG
-00001700: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00001710: 2020 2027 6669 6c65 2070 726f 7669 6465     'file provide
-00001720: 6420 6973 206e 6f74 2061 6e20 4156 4766  d is not an AVGf
-00001730: 696c 652e 506c 6561 7365 2063 6865 636b  ile.Please check
-00001740: 2079 6f75 7220 6669 6c65 2127 290d 0a20   your file!').. 
-00001750: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00001760: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00001770: 2020 2065 6c69 6620 7365 6c66 2e64 6174     elif self.dat
-00001780: 615f 666e 2e65 6e64 7377 6974 6828 2761  a_fn.endswith('a
-00001790: 7667 2729 206f 7220 7365 6c66 2e64 6174  vg') or self.dat
-000017a0: 615f 666e 2e65 6e64 7377 6974 6828 272e  a_fn.endswith('.
-000017b0: 4156 4727 293a 0d0a 2020 2020 2020 2020  AVG'):..        
-000017c0: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
-000017d0: 6e20 2873 656c 662e 6461 7461 5f66 6e2c  n (self.data_fn,
-000017e0: 2027 7227 2c20 656e 636f 6469 6e67 3d27   'r', encoding='
-000017f0: 7574 6638 2729 2061 7320 6669 6420 3a0d  utf8') as fid :.
-00001800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001810: 2020 2020 2061 7667 5f64 6174 615f 6669       avg_data_fi
-00001820: 6c65 3d66 6964 2e72 6561 646c 696e 6573  le=fid.readlines
-00001830: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00001840: 0d0a 2020 2020 2020 2020 2320 2d2d 2d2d  ..        # ----
-00001850: 6e6f 7720 6368 6563 6820 7468 6520 6176  now chech the av
-00001860: 6720 6669 6c65 202d 2d0d 0a20 2020 2020  g file --..     
-00001870: 2020 2061 7667 5f66 696c 655f 7479 7065     avg_file_type
-00001880: 5f6e 756d 203d 2063 6675 6e63 2e5f 7661  _num = cfunc._va
-00001890: 6c69 6461 7465 5f61 7667 5f66 696c 6528  lidate_avg_file(
-000018a0: 6176 675f 6461 7461 4c69 6e65 7320 3d61  avg_dataLines =a
-000018b0: 7667 5f64 6174 615f 6669 6c65 290d 0a20  vg_data_file).. 
-000018c0: 2020 2020 2020 2023 2d2d 2d2d 2d2d 2d2d         #--------
-000018d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000018e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-000018f0: 2020 2020 2023 2d2d 2d2d 2d2d 2d2d 2d2d       #----------
-00001900: 2d2d 2d20 206d 6169 6e20 4156 4720 6669  ---  main AVG fi
-00001910: 6c65 203a 4631 2061 6e64 206b 6565 7020  le :F1 and keep 
-00001920: 6461 7461 2069 6e66 6f73 202d 2d2d 2d2d  data infos -----
-00001930: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00001940: 2020 2069 6620 6176 675f 6669 6c65 5f74     if avg_file_t
-00001950: 7970 655f 6e75 6d20 3d3d 2031 3a20 0d0a  ype_num == 1: ..
-00001960: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00001970: 2d2d 3e20 7275 6e20 7468 6520 6865 6164  --> run the head
-00001980: 6c69 6e65 7320 7468 696e 2074 6f20 6669  lines thin to fi
-00001990: 6e64 2074 6865 2077 6f72 6420 2773 6b70  nd the word 'skp
-000019a0: 270d 0a20 2020 2020 2020 2020 2020 2066  '..            f
-000019b0: 6f72 2069 6478 202c 2069 6e66 6f73 2069  or idx , infos i
-000019c0: 6e20 656e 756d 6572 6174 6520 2861 7667  n enumerate (avg
-000019d0: 5f64 6174 615f 6669 6c65 293a 200d 0a20  _data_file): .. 
-000019e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000019f0: 6620 2773 6b70 2720 696e 2069 6e66 6f73  f 'skp' in infos
-00001a00: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00001a10: 2020 2020 2020 2020 2061 7667 5f64 6174           avg_dat
-00001a20: 615f 6669 6c65 5f69 6e66 6f73 203d 2061  a_file_infos = a
-00001a30: 7667 5f64 6174 615f 6669 6c65 5b3a 6964  vg_data_file[:id
-00001a40: 785d 0d0a 2020 2020 2020 2020 2020 2020  x]..            
-00001a50: 2020 2020 2020 2020 6272 6561 6b0d 0a0d          break...
-00001a60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00001a70: 662e 4865 6164 6572 2e48 6172 6477 6172  f.Header.Hardwar
-00001a80: 6549 6e66 6f73 2e73 6574 5f68 6172 7761  eInfos.set_harwa
-00001a90: 7265 5f69 6e66 6f73 280d 0a20 2020 2020  re_infos(..     
-00001aa0: 2020 2020 2020 2020 2020 205b 6c69 6e65             [line
-00001ab0: 2e73 7472 6970 2829 2066 6f72 206c 696e  .strip() for lin
-00001ac0: 6520 2069 6e20 6176 675f 6461 7461 5f66  e  in avg_data_f
-00001ad0: 696c 655f 696e 666f 730d 0a20 2020 2020  ile_infos..     
-00001ae0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00001af0: 6c69 6e65 2e73 7461 7274 7377 6974 6828  line.startswith(
-00001b00: 275c 5c27 295d 2029 0d0a 2020 2020 2020  '\\')] )..      
-00001b10: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00001b20: 2020 2020 7365 6c66 2e48 6561 6465 722e      self.Header.
-00001b30: 5478 2e73 6574 5f74 7261 6e73 6d69 7474  Tx.set_transmitt
-00001b40: 6572 5f70 726f 7065 7274 6965 7320 280d  er_properties (.
-00001b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001b60: 2054 785f 6461 7461 203d 5b6c 696e 652e   Tx_data =[line.
-00001b70: 7374 7269 7028 2920 666f 7220 6c69 6e65  strip() for line
-00001b80: 2020 696e 2061 7667 5f64 6174 615f 6669    in avg_data_fi
-00001b90: 6c65 5f69 6e66 6f73 200d 0a20 2020 2020  le_infos ..     
-00001ba0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-00001bb0: 6e65 2e73 7461 7274 7377 6974 6828 2724  ne.startswith('$
-00001bc0: 2729 5d29 0d0a 2020 2020 2020 2020 2020  ')])..          
-00001bd0: 2020 7365 6c66 2e48 6561 6465 722e 5278    self.Header.Rx
-00001be0: 2e73 6574 5f72 6563 6569 7665 725f 7072  .set_receiver_pr
-00001bf0: 6f70 6572 7469 6573 2028 0d0a 2020 2020  operties (..    
-00001c00: 2020 2020 2020 2020 2020 2020 5278 5f64              Rx_d
-00001c10: 6174 6120 3d5b 6c69 6e65 2e73 7472 6970  ata =[line.strip
-00001c20: 2829 2066 6f72 206c 696e 6520 2069 6e20  () for line  in 
-00001c30: 6176 675f 6461 7461 5f66 696c 655f 696e  avg_data_file_in
-00001c40: 666f 730d 0a20 2020 2020 2020 2020 2020  fos..           
-00001c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c60: 2020 2020 2020 6966 206c 696e 652e 7374        if line.st
-00001c70: 6172 7473 7769 7468 2827 2427 295d 290d  artswith('$')]).
-00001c80: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00001c90: 2020 2020 2020 2020 2020 2064 6174 615f             data_
-00001ca0: 746f 5f61 7272 6179 203d 6176 675f 6461  to_array =avg_da
-00001cb0: 7461 5f66 696c 6520 5b35 3a5d 0d0a 2020  ta_file [5:]..  
-00001cc0: 2020 2020 2020 2020 2020 2320 2d2d 2d20            # --- 
-00001cd0: 7075 7420 6461 7461 206f 6e20 6c69 7374  put data on list
-00001ce0: 2061 6e64 2061 7272 6179 203a 200d 0a20   and array : .. 
-00001cf0: 2020 2020 2020 2020 2020 2064 6174 615f             data_
-00001d00: 746f 5f61 7272 6179 203d 206e 702e 6172  to_array = np.ar
-00001d10: 7261 7928 5b20 6461 7475 6d2e 7374 7269  ray([ datum.stri
-00001d20: 7028 292e 7370 6c69 7428 2920 0d0a 2020  p().split() ..  
-00001d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d50: 2020 2020 666f 7220 6461 7475 6d20 696e      for datum in
-00001d60: 2064 6174 615f 746f 5f61 7272 6179 205d   data_to_array ]
-00001d70: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-00001d80: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-00001d90: 656c 662e 736b 6970 2e73 6b70 5f66 6c61  elf.skip.skp_fla
-00001da0: 673d 3d64 6174 615f 746f 5f61 7272 6179  g==data_to_array
-00001db0: 5b30 2c30 5d20 2320 6669 6c6c 2074 6865  [0,0] # fill the
-00001dc0: 2073 6b69 7020 666c 6167 200d 0a20 2020   skip flag ..   
-00001dd0: 2020 2020 2020 2020 2073 656c 662e 536b           self.Sk
-00001de0: 6970 5f66 6c61 672e 7365 7461 6e64 6765  ip_flag.setandge
-00001df0: 745f 736b 6970 5f66 6c61 6728 736b 6970  t_skip_flag(skip
-00001e00: 5f66 6c61 673d 6461 7461 5f74 6f5f 6172  _flag=data_to_ar
-00001e10: 7261 795b 302c 305d 290d 0a20 2020 2020  ray[0,0])..     
-00001e20: 2020 2020 2020 2023 2064 656c 6574 6520         # delete 
-00001e30: 7468 6520 736b 7020 6172 7261 7920 616e  the skp array an
-00001e40: 6420 636f 6d70 205f 6172 7261 7920 0d0a  d comp _array ..
-00001e50: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00001e60: 2020 2020 2020 2020 2020 6461 7461 5f74            data_t
-00001e70: 6f5f 6172 7261 7920 3d6e 702e 6465 6c65  o_array =np.dele
-00001e80: 7465 2864 6174 615f 746f 5f61 7272 6179  te(data_to_array
-00001e90: 2c20 6e70 2e61 7272 6179 285b 302c 335d  , np.array([0,3]
-00001ea0: 292c 2061 7869 7320 3d31 2029 0d0a 0d0a  ), axis =1 )....
-00001eb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00001ec0: 2e44 6174 615f 7365 6374 696f 6e2e 5f61  .Data_section._a
-00001ed0: 7667 5f73 6574 5f63 6f6d 706f 6e65 6e74  vg_set_component
-00001ee0: 735f 6672 6f6d 5f64 6174 6128 0d0a 2020  s_from_data(..  
-00001ef0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00001f00: 7461 5f61 7272 6179 203d 2064 6174 615f  ta_array = data_
-00001f10: 746f 5f61 7272 6179 2c64 6174 615f 7479  to_array,data_ty
-00001f20: 7065 203d 6176 675f 6669 6c65 5f74 7970  pe =avg_file_typ
-00001f30: 655f 6e75 6d29 200d 0a20 2020 2020 2020  e_num) ..       
-00001f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f60: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00001f70: 2020 2020 2020 2320 536b 705f 666c 6167        # Skp_flag
-00001f80: 2873 6b69 705f 666c 6167 3d27 3227 290d  (skip_flag='2').
-00001f90: 0a20 2020 2020 2020 2023 2d2d 2d2d 2d2d  .        #------
-00001fa0: 2d2d 2d2d 2d2d 2d52 6561 6420 4153 5441  -------Read ASTA
-00001fb0: 5449 4320 6669 6c65 203a 2046 3220 616e  TIC file : F2 an
-00001fc0: 6420 6b65 6570 2064 6174 6120 696e 666f  d keep data info
-00001fd0: 7320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  s --------------
-00001fe0: 0d0a 2020 2020 2020 2020 656c 6966 2020  ..        elif  
-00001ff0: 6176 675f 6669 6c65 5f74 7970 655f 6e75  avg_file_type_nu
-00002000: 6d20 3d3d 3220 3a20 0d0a 2020 2020 2020  m ==2 : ..      
-00002010: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00002020: 2020 2020 2320 7365 7420 7a6f 6e67 6520      # set zonge 
-00002030: 4861 7264 7761 7265 7320 696e 666f 733a  Hardwares infos:
-00002040: 0d0a 2020 2020 2020 2020 2020 2020 7a6f  ..            zo
-00002050: 6e67 655f 6861 7264 775f 696e 666f 7320  nge_hardw_infos 
-00002060: 3d5b 6c69 6e65 2e73 7472 6970 2829 200d  =[line.strip() .
-00002070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002090: 2066 6f72 206c 696e 6520 2069 6e20 6176   for line  in av
-000020a0: 675f 6461 7461 5f66 696c 6520 0d0a 2020  g_data_file ..  
-000020b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000020c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000020d0: 206c 696e 652e 7374 6172 7473 7769 7468   line.startswith
-000020e0: 2827 5c5c 2729 5d0d 0a20 2020 2020 2020  ('\\')]..       
-000020f0: 2020 2020 2073 656c 662e 4865 6164 6572       self.Header
-00002100: 2e48 6172 6477 6172 6549 6e66 6f73 2e73  .HardwareInfos.s
-00002110: 6574 5f68 6172 7761 7265 5f69 6e66 6f73  et_harware_infos
-00002120: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00002130: 2020 207a 6f6e 6765 5f68 6172 6477 5f69     zonge_hardw_i
-00002140: 6e66 6f73 3d7a 6f6e 6765 5f68 6172 6477  nfos=zonge_hardw
-00002150: 5f69 6e66 6f73 290d 0a20 2020 2020 2020  _infos)..       
-00002160: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00002170: 2020 2073 656c 662e 4865 6164 6572 2e54     self.Header.T
-00002180: 782e 7365 745f 7472 616e 736d 6974 7465  x.set_transmitte
-00002190: 725f 7072 6f70 6572 7469 6573 280d 0a20  r_properties(.. 
-000021a0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-000021b0: 785f 6461 7461 3d5b 6c69 6e65 2e73 7472  x_data=[line.str
-000021c0: 6970 2829 666f 7220 6c69 6e65 2069 6e20  ip()for line in 
-000021d0: 6176 675f 6461 7461 5f66 696c 650d 0a20  avg_data_file.. 
-000021e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000021f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002200: 2020 6966 206c 696e 652e 7374 6172 7473    if line.starts
-00002210: 7769 7468 2827 2454 7827 295d 290d 0a20  with('$Tx')]).. 
-00002220: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00002230: 2020 2020 2020 2020 2066 6f72 2073 732c           for ss,
-00002240: 206c 696e 655f 6176 6720 696e 2065 6e75   line_avg in enu
-00002250: 6d65 7261 7465 2028 6176 675f 6461 7461  merate (avg_data
-00002260: 5f66 696c 6529 3a20 0d0a 2020 2020 2020  _file): ..      
-00002270: 2020 2020 2020 2020 2020 6966 206c 696e            if lin
-00002280: 655f 6176 672e 7374 6172 7473 7769 7468  e_avg.startswith
-00002290: 2827 2452 7827 293a 0d0a 2020 2020 2020  ('$Rx'):..      
-000022a0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000022b0: 6b65 6570 2074 6865 2072 656d 6169 6e73  keep the remains
-000022c0: 2064 6174 6120 2b20 5278 2d70 726f 7065   data + Rx-prope
-000022d0: 7274 6965 730d 0a20 2020 2020 2020 2020  rties..         
-000022e0: 2020 2020 2020 2020 2020 2074 656d 705f             temp_
-000022f0: 6461 7461 203d 6176 675f 6461 7461 5f66  data =avg_data_f
-00002300: 696c 655b 7373 3a5d 200d 0a20 2020 2020  ile[ss:] ..     
-00002310: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00002320: 2074 7275 6e63 6174 6520 7468 6520 6461   truncate the da
-00002330: 7461 2061 6e20 6b65 6570 2074 6865 2069  ta an keep the i
-00002340: 6e66 6f73 2061 626f 7665 2074 6869 6e20  nfos above thin 
-00002350: 2452 780d 0a20 2020 2020 2020 2020 2020  $Rx..           
-00002360: 2020 2020 2020 2020 2066 6f72 5f73 7572           for_sur
-00002370: 765f 636f 6e66 6967 416e 6e6f 743d 6176  v_configAnnot=av
-00002380: 675f 6461 7461 5f66 696c 655b 3a73 735d  g_data_file[:ss]
-00002390: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000023a0: 2020 2020 2020 2062 7265 616b 200d 0a20         break .. 
-000023b0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-000023c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000023d0: 662e 4865 6164 6572 2e53 7572 7665 7941  f.Header.SurveyA
-000023e0: 6e6e 6f74 6174 696f 6e2e 7365 745f 7375  nnotation.set_su
-000023f0: 7276 6579 5f61 6e6e 6f74 6174 696f 6e73  rvey_annotations
-00002400: 5f69 6e66 6f73 2028 0d0a 2020 2020 2020  _infos (..      
-00002410: 2020 2020 2020 2020 2020 7375 7276 6579            survey
-00002420: 5f61 6e6e 6f74 6174 696f 6e73 5f64 6174  _annotations_dat
-00002430: 6120 3d66 6f72 5f73 7572 765f 636f 6e66  a =for_surv_conf
-00002440: 6967 416e 6e6f 7429 0d0a 2020 2020 2020  igAnnot)..      
-00002450: 2020 2020 2020 7365 6c66 2e48 6561 6465        self.Heade
-00002460: 722e 5375 7276 6579 436f 6e66 6967 7572  r.SurveyConfigur
-00002470: 6174 696f 6e2e 7365 745f 7375 7276 6579  ation.set_survey
-00002480: 5f63 6f6e 6669 6775 7261 7469 6f6e 5f69  _configuration_i
-00002490: 6e66 6f73 2028 0d0a 2020 2020 2020 2020  nfos (..        
-000024a0: 2020 2020 2020 2020 7375 7276 6579 5f63          survey_c
-000024b0: 6f6e 6669 675f 6461 7461 3d66 6f72 5f73  onfig_data=for_s
-000024c0: 7572 765f 636f 6e66 6967 416e 6e6f 7429  urv_configAnnot)
-000024d0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-000024e0: 2020 2020 2020 2020 2020 2020 7465 6d5f              tem_
-000024f0: 642c 2072 785f 696e 666f 732c 2063 6f6d  d, rx_infos, com
-00002500: 705f 7265 6365 6976 5f69 6e66 6f3d 5b5d  p_receiv_info=[]
-00002510: 2c5b 5d2c 5b5d 0d0a 2020 2020 2020 2020  ,[],[]..        
-00002520: 2020 2020 666f 7220 6a6a 2c20 6974 656d      for jj, item
-00002530: 2069 6e20 656e 756d 6572 6174 6528 7465   in enumerate(te
-00002540: 6d70 5f64 6174 6129 3a20 0d0a 2020 2020  mp_data): ..    
-00002550: 2020 2020 2020 2020 2020 2023 2d2d 2d3e             #--->
-00002560: 2073 6565 6b20 7468 6520 6461 7461 2077   seek the data w
-00002570: 6974 686f 7574 2074 6865 206d 6172 6b20  ithout the mark 
-00002580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002590: 2023 6f66 2074 6865 2072 6563 6569 7665   #of the receive
-000025a0: 7220 6f66 2063 6f6d 706f 6e65 6e74 206c  r of component l
-000025b0: 6973 7420 0d0a 2020 2020 2020 2020 2020  ist ..          
-000025c0: 2020 2020 2069 6620 6974 656d 2e66 696e       if item.fin
-000025d0: 6428 275a 2e6d 6167 2729 3c30 2061 6e64  d('Z.mag')<0 and
-000025e0: 2069 7465 6d2e 6669 6e64 2827 2452 7827   item.find('$Rx'
-000025f0: 2920 3c20 3020 3a0d 0a20 2020 2020 2020  ) < 0 :..       
-00002600: 2020 2020 2020 2020 2020 2020 7373 5f5f              ss__
-00002610: 7465 6d70 3d69 7465 6d2e 7374 7269 7028  temp=item.strip(
-00002620: 292e 7370 6c69 7428 272c 2729 0d0a 2020  ).split(',')..  
-00002630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002640: 2066 6f72 206b 6b2c 2076 616c 7565 2069   for kk, value i
-00002650: 6e20 656e 756d 6572 6174 6520 2820 7373  n enumerate ( ss
-00002660: 5f5f 7465 6d70 2029 203a 200d 0a20 2020  __temp ) : ..   
-00002670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002680: 2020 2020 7472 7920 3a20 0d0a 2020 2020      try : ..    
-00002690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000026a0: 2020 2020 2020 2073 735f 5f74 656d 705b         ss__temp[
-000026b0: 6b6b 5d3d 666c 6f61 7428 7661 6c75 6529  kk]=float(value)
-000026c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000026d0: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-000026e0: 3a20 2020 2020 232d 2d3e 2069 6e20 7468  :     #--> in th
-000026f0: 6520 6361 7365 2077 6520 6d65 6574 2027  e case we meet '
-00002700: 2a27 206d 6561 6e20 6e6f 2076 616c 7565  *' mean no value
-00002710: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
-00002720: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00002730: 6620 7661 6c75 652e 7374 7269 7028 2920  f value.strip() 
-00002740: 3d3d 2027 2a27 203a 0d0a 2020 2020 2020  == '*' :..      
-00002750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002760: 2020 2020 2020 2020 2073 735f 5f74 656d           ss__tem
-00002770: 705b 6b6b 5d3d 6e70 2e6e 616e 0d0a 2020  p[kk]=np.nan..  
-00002780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002790: 2020 2020 2020 2020 2070 6173 7320 0d0a           pass ..
-000027a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000027b0: 2020 2020 2020 2023 2069 6620 7661 6c75         # if valu
-000027c0: 653d 3d27 2a27 3a20 7373 5f5f 7465 6d70  e=='*': ss__temp
-000027d0: 5b6b 6b5d 3d22 3022 0d0a 2020 2020 2020  [kk]="0"..      
-000027e0: 2020 2020 2020 2020 2020 2020 2074 656d               tem
-000027f0: 5f64 2e61 7070 656e 6428 7373 5f5f 7465  _d.append(ss__te
-00002800: 6d70 290d 0a20 2020 2020 2020 2020 2020  mp)..           
-00002810: 2020 2020 6966 2027 2452 7827 2069 6e20      if '$Rx' in 
-00002820: 6974 656d 203a 0d0a 2020 2020 2020 2020  item :..        
-00002830: 2020 2020 2020 2020 2020 2063 6f6d 705f             comp_
-00002840: 7265 6365 6976 5f69 6e66 6f2e 6170 7065  receiv_info.appe
-00002850: 6e64 2869 7465 6d29 0d0a 2020 2020 2020  nd(item)..      
-00002860: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00002870: 2020 2020 2020 2020 2020 2069 6620 2724             if '$
-00002880: 5278 2e47 6470 5374 6e27 2069 6e20 6974  Rx.GdpStn' in it
-00002890: 656d 203a 0d0a 2020 2020 2020 2020 2020  em :..          
-000028a0: 2020 2020 2020 2020 2069 7465 6d20 3d20           item = 
-000028b0: 6974 656d 2e73 7472 6970 2829 2e73 706c  item.strip().spl
-000028c0: 6974 2827 3d27 295b 2d31 5d0d 0a20 2020  it('=')[-1]..   
-000028d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028e0: 7278 5f69 6e66 6f73 2e61 7070 656e 6428  rx_infos.append(
-000028f0: 6974 656d 290d 0a20 2020 2020 2020 2020  item)..         
-00002900: 2020 2020 2020 6966 2069 7465 6d2e 6669        if item.fi
-00002910: 6e64 2827 4152 6573 2e6d 6167 2729 3e20  nd('ARes.mag')> 
-00002920: 3020 616e 6420 6974 656d 2e66 696e 6428  0 and item.find(
-00002930: 2753 5265 7327 293e 2030 203a 0d0a 2020  'SRes')> 0 :..  
-00002940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002950: 2023 2d20 6b65 6570 2074 6865 2068 6561   #- keep the hea
-00002960: 6420 636f 6d70 6f6e 656e 7420 696e 666f  d component info
-00002970: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00002980: 2020 2020 2020 2063 6f6d 705f 7365 6374         comp_sect
-00002990: 3d69 7465 6d2e 7374 7269 7028 292e 7370  =item.strip().sp
-000029a0: 6c69 7428 272c 2729 0d0a 2020 2020 2020  lit(',')..      
-000029b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000029c0: 2020 2020 232d 7365 7420 7265 6365 6976      #-set receiv
-000029d0: 6572 7320 696e 666f 7320 0d0a 2020 2020  ers infos ..    
-000029e0: 2020 2020 2020 2020 7365 6c66 2e48 6561          self.Hea
-000029f0: 6465 722e 5278 2e73 6574 5f72 6563 6569  der.Rx.set_recei
-00002a00: 7665 725f 7072 6f70 6572 7469 6573 2852  ver_properties(R
-00002a10: 785f 6461 7461 203d 636f 6d70 5f72 6563  x_data =comp_rec
-00002a20: 6569 765f 696e 666f 290d 0a20 2020 2020  eiv_info)..     
-00002a30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00002a40: 2020 2020 2023 2d2d 3e20 6465 6c65 7465       #--> delete
-00002a50: 2074 6865 206e 6f6e 6520 7661 6c75 6520   the none value 
-00002a60: 6f6e 2064 6174 6120 0d0a 2020 2020 2020  on data ..      
-00002a70: 2020 2020 2020 666f 7220 736b 202c 2069        for sk , i
-00002a80: 7465 6d6d 2069 6e20 656e 756d 6572 6174  temm in enumerat
-00002a90: 6528 7465 6d5f 6429 3a20 0d0a 2020 2020  e(tem_d): ..    
-00002aa0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00002ab0: 7465 6d6d 3d3d 5b27 275d 3a20 7465 6d5f  temm==['']: tem_
-00002ac0: 642e 706f 7028 736b 290d 0a20 2020 2020  d.pop(sk)..     
-00002ad0: 2020 2020 2020 2064 6174 613d 6e70 2e61         data=np.a
-00002ae0: 7272 6179 2874 656d 5f64 290d 0a20 2020  rray(tem_d)..   
-00002af0: 2020 2020 2020 2020 2064 6174 615f 746f           data_to
-00002b00: 5f61 7272 6179 2c20 6f74 6865 725f 636f  _array, other_co
-00002b10: 6d70 7320 3d20 6366 756e 632e 7374 7261  mps = cfunc.stra
-00002b20: 6967 6874 656e 5f63 6163 3243 5366 696c  ighten_cac2CSfil
-00002b30: 6520 280d 0a20 2020 2020 2020 2020 2020  e (..           
-00002b40: 2020 2020 2064 6174 615f 6172 7261 793d       data_array=
-00002b50: 6461 7461 2c63 6f6d 706f 6e65 6e74 5f63  data,component_c
-00002b60: 6f6c 756d 6e5f 7365 6374 696f 6e20 3d20  olumn_section = 
-00002b70: 636f 6d70 5f73 6563 7429 0d0a 2020 2020  comp_sect)..    
-00002b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ba0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-00002bb0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00002bc0: 2020 2020 2020 2020 2020 2066 7265 715f             freq_
-00002bd0: 636f 756e 7473 2c61 7272 6179 5f6f 665f  counts,array_of_
-00002be0: 7265 7065 6174 5f66 7265 7175 656e 6379  repeat_frequency
-00002bf0: 3d6e 702e 756e 6971 7565 2864 6174 615f  =np.unique(data_
-00002c00: 746f 5f61 7272 6179 5b3a 2c31 5d2c 0d0a  to_array[:,1],..
-00002c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c40: 2020 2020 7265 7475 726e 5f63 6f75 6e74      return_count
-00002c50: 733d 5472 7565 290d 0a20 2020 2020 2020  s=True)..       
-00002c60: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00002c70: 2020 2073 7461 7469 6f6e 5f6c 6973 743d     station_list=
-00002c80: 7278 5f69 6e66 6f73 202a 2066 7265 715f  rx_infos * freq_
-00002c90: 636f 756e 7473 2e73 697a 650d 0a20 2020  counts.size..   
-00002ca0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00002cb0: 2020 2020 2020 2073 7461 7469 6f6e 5f61         station_a
-00002cc0: 7272 6179 5f66 6f72 5f64 6174 613d 5b66  rray_for_data=[f
-00002cd0: 6c6f 6174 2869 6929 2066 6f72 2069 6920  loat(ii) for ii 
-00002ce0: 696e 2073 7461 7469 6f6e 5f6c 6973 745d  in station_list]
-00002cf0: 0d0a 2020 2020 2020 2020 2020 2020 7374  ..            st
-00002d00: 6174 696f 6e5f 6172 7261 795f 666f 725f  ation_array_for_
-00002d10: 6461 7461 2e73 6f72 7428 290d 0a20 2020  data.sort()..   
-00002d20: 2020 2020 2020 2020 2073 7461 7469 6f6e           station
-00002d30: 5f61 7272 6179 5f66 6f72 5f64 6174 613d  _array_for_data=
-00002d40: 6e70 2e61 7272 6179 2873 7461 7469 6f6e  np.array(station
-00002d50: 5f61 7272 6179 5f66 6f72 5f64 6174 6129  _array_for_data)
-00002d60: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00002d70: 2073 7461 7469 6f6e 5f61 7272 6179 5f66   station_array_f
-00002d80: 6f72 5f64 6174 612e 7368 6170 655b 305d  or_data.shape[0]
-00002d90: 2021 3d64 6174 615f 746f 5f61 7272 6179   !=data_to_array
-00002da0: 2e73 6861 7065 5b30 5d3a 200d 0a20 2020  .shape[0]: ..   
-00002db0: 2020 2020 2020 2020 2020 2020 205f 6c6f               _lo
-00002dc0: 6767 6572 2e65 7272 6f72 2827 5472 6f75  gger.error('Trou
-00002dd0: 626c 6520 6f63 6375 7265 6420 7768 656e  ble occured when
-00002de0: 2072 6561 6469 6e67 2041 7374 6174 6963   reading Astatic
-00002df0: 2066 696c 652e 2027 0d0a 2020 2020 2020   file. '..      
+00000f30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00000f40: 2073 656c 662e 454d 5f7a 6f6e 6765 326a   self.EM_zonge2j
+00000f50: 203d 207b 0d0a 2020 2020 2020 2020 2020   = {..          
+00000f60: 2020 2745 7848 7827 3a27 5258 5827 2c20    'ExHx':'RXX', 
+00000f70: 0d0a 2020 2020 2020 2020 2020 2020 2745  ..            'E
+00000f80: 7848 7927 3a27 5258 5927 2c0d 0a20 2020  xHy':'RXY',..   
+00000f90: 2020 2020 2020 2020 2027 4579 4878 273a           'EyHx':
+00000fa0: 2752 5958 272c 200d 0a20 2020 2020 2020  'RYX', ..       
+00000fb0: 2020 2020 2027 4579 4879 273a 2752 5959       'EyHy':'RYY
+00000fc0: 270d 0a20 2020 2020 2020 2020 2020 207d  '..            }
+00000fd0: 0d0a 2020 0d0a 2020 2020 2020 2020 666f  ..  ..        fo
+00000fe0: 7220 6b65 7920 696e 206c 6973 7428 6b77  r key in list(kw
+00000ff0: 6172 6773 2e6b 6579 7328 2929 3a0d 0a20  args.keys()):.. 
+00001000: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001010: 5f5f 7365 7461 7474 725f 5f28 6b65 792c  __setattr__(key,
+00001020: 206b 7761 7267 735b 6b65 795d 290d 0a20   kwargs[key]).. 
+00001030: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00001040: 2020 2020 2069 6620 7365 6c66 2e64 6174       if self.dat
+00001050: 615f 666e 2069 7320 6e6f 7420 4e6f 6e65  a_fn is not None
+00001060: 203a 2020 2020 2020 2020 2020 2020 2020   :              
+00001070: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00001080: 2020 2020 2020 2073 656c 662e 5f72 6561         self._rea
+00001090: 645f 6176 675f 6669 6c65 2028 290d 0a20  d_avg_file ().. 
+000010a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000010b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000010c0: 2020 2020 200d 0a20 2020 2064 6566 205f       ..    def _
+000010d0: 7265 6164 5f61 7667 5f66 696c 6520 2873  read_avg_file (s
+000010e0: 656c 662c 2064 6174 615f 666e 3d4e 6f6e  elf, data_fn=Non
+000010f0: 6520 293a 200d 0a20 2020 2020 2020 2022  e ): ..        "
+00001100: 2222 0d0a 2020 2020 2020 2020 4d65 7468  ""..        Meth
+00001110: 6f64 2074 6f20 7265 6164 2061 7667 2066  od to read avg f
+00001120: 696c 6520 616e 6420 7365 7420 6561 6368  ile and set each
+00001130: 206f 626a 6563 7473 202e 0d0a 2020 2020   objects ...    
+00001140: 2020 2020 0d0a 2020 2020 2020 2020 5468      ..        Th
+00001150: 6520 6d61 696e 2073 6f75 7263 6520 7072  e main source pr
+00001160: 6f74 6f63 6f6c 6520 746f 2074 7261 6e73  otocole to trans
+00001170: 6665 7274 2064 6174 6120 696e 746f 2063  fert data into c
+00001180: 6f72 7265 7370 6f6e 6469 6e67 2063 6c61  orresponding cla
+00001190: 7373 6573 2e20 0d0a 2020 2020 2020 2020  sses. ..        
+000011a0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000011b0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+000011c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000011d0: 2020 2020 2020 2020 2a20 6461 7461 5f66          * data_f
+000011e0: 6e3a 2073 7472 2020 0d0a 2020 2020 2020  n: str  ..      
+000011f0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00001200: 7468 2074 6f20 4156 4720 6669 6c65 6e61  th to AVG filena
+00001210: 6d65 2e20 2020 2020 200d 0a20 2020 2020  me.      ..     
+00001220: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00001230: 0d0a 2020 2020 2020 2020 6966 2064 6174  ..        if dat
+00001240: 615f 666e 2069 7320 6e6f 7420 4e6f 6e65  a_fn is not None
+00001250: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00001260: 2073 656c 662e 6461 7461 5f66 6e20 3d64   self.data_fn =d
+00001270: 6174 615f 666e 200d 0a20 2020 2020 2020  ata_fn ..       
+00001280: 2069 6620 7365 6c66 2e64 6174 615f 666e   if self.data_fn
+00001290: 2069 7320 4e6f 6e65 2020 3a0d 0a20 2020   is None  :..   
+000012a0: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
+000012b0: 5647 4572 726f 7228 0d0a 2020 2020 2020  VGError(..      
+000012c0: 2020 2020 2020 2020 2020 274e 6f20 4156            'No AV
+000012d0: 4720 6669 6c65 2066 6f75 6e64 2e50 6c65  G file found.Ple
+000012e0: 6173 6520 6368 6563 6b20 270d 0a20 2020  ase check '..   
+000012f0: 2020 2020 2020 2020 2020 2020 2027 796f               'yo
+00001300: 7572 2070 6174 6866 696c 6520 3a3c 7b30  ur pathfile :<{0
+00001310: 7d3e 272e 666f 726d 6174 286f 732e 6765  }>'.format(os.ge
+00001320: 7463 7764 2829 2929 0d0a 2020 2020 2020  tcwd()))..      
+00001330: 2020 2320 7072 696e 7428 7365 6c66 2e64    # print(self.d
+00001340: 6174 615f 666e 2920 2020 2020 2020 0d0a  ata_fn)       ..
+00001350: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00001360: 6461 7461 5f66 6e20 6973 206e 6f74 204e  data_fn is not N
+00001370: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
+00001380: 2020 2020 6966 206f 732e 7061 7468 2e69      if os.path.i
+00001390: 7366 696c 6528 7365 6c66 2e64 6174 615f  sfile(self.data_
+000013a0: 666e 2920 6973 2046 616c 7365 203a 0d0a  fn) is False :..
+000013b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000013c0: 7261 6973 6520 4156 4745 7272 6f72 2827  raise AVGError('
+000013d0: 636f 756c 6420 6e6f 7420 6669 6e64 2025  could not find %
+000013e0: 7327 2c20 7365 6c66 2e64 6174 615f 666e  s', self.data_fn
+000013f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00001400: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
+00001410: 662e 5f6c 6f67 6769 6e67 2e69 6e66 6f28  f._logging.info(
+00001420: 2772 6561 6469 6e67 2061 6e64 2063 6865  'reading and che
+00001430: 636b 696e 6720 7468 6520 4156 4720 6669  cking the AVG fi
+00001440: 6c65 2025 7327 2c20 7365 6c66 2e64 6174  le %s', self.dat
+00001450: 615f 666e 2920 2020 2020 2020 2020 0d0a  a_fn)         ..
+00001460: 2020 2020 2020 2020 232d 2d2d 2d2d 2d2d          #-------
+00001470: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000014a0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+000014b0: 2373 656c 662e 6461 7461 5f66 6e5b 2d34  #self.data_fn[-4
+000014c0: 3a5d 2e6c 6f77 6572 2829 2021 3d20 272e  :].lower() != '.
+000014d0: 6176 6727 6f72 0d0a 2020 2020 2020 2020  avg'or..        
+000014e0: 2320 7365 6c66 2e64 6174 615f 666e 2e65  # self.data_fn.e
+000014f0: 6e64 7377 6974 6828 2761 7667 272e 7570  ndswith('avg'.up
+00001500: 7065 7228 2929 3d3d 4661 6c73 6520 6f72  per())==False or
+00001510: 0d0a 2020 2020 2020 2020 6966 2020 2873  ..        if  (s
+00001520: 656c 662e 6461 7461 5f66 6e2e 656e 6473  elf.data_fn.ends
+00001530: 7769 7468 2827 6176 6727 2920 6f72 205c  with('avg') or \
+00001540: 0d0a 2020 2020 2020 2020 2020 2020 2073  ..             s
+00001550: 656c 662e 6461 7461 5f66 6e2e 656e 6473  elf.data_fn.ends
+00001560: 7769 7468 2827 6176 6727 2e75 7070 6572  with('avg'.upper
+00001570: 2829 2929 203d 3d20 4661 6c73 6520 3a0d  ())) == False :.
+00001580: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00001590: 6e69 6e67 732e 7761 726e 280d 0a20 2020  nings.warn(..   
+000015a0: 2020 2020 2020 2020 2020 2020 2027 3c47               '<G
+000015b0: 6574 206d 6f72 6520 696e 666f 7320 6162  et more infos ab
+000015c0: 6f75 7420 4156 473e 203a 7b30 7d27 2e66  out AVG> :{0}'.f
+000015d0: 6f72 6d61 7428 696e 664f 532e 6e6f 7469  ormat(infOS.noti
+000015e0: 6f6e 2e41 5647 2929 0d0a 2020 2020 2020  on.AVG))..      
+000015f0: 2020 2020 2020 7261 6973 6520 4156 4745        raise AVGE
+00001600: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00001610: 2020 2020 2020 2027 6669 6c65 2070 726f         'file pro
+00001620: 7669 6465 6420 6973 206e 6f74 2061 6e20  vided is not an 
+00001630: 4156 4766 696c 652e 506c 6561 7365 2063  AVGfile.Please c
+00001640: 6865 636b 2079 6f75 7220 6669 6c65 2127  heck your file!'
+00001650: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+00001660: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00001670: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00001680: 2e64 6174 615f 666e 2e65 6e64 7377 6974  .data_fn.endswit
+00001690: 6828 2761 7667 2729 206f 7220 7365 6c66  h('avg') or self
+000016a0: 2e64 6174 615f 666e 2e65 6e64 7377 6974  .data_fn.endswit
+000016b0: 6828 272e 4156 4727 293a 0d0a 2020 2020  h('.AVG'):..    
+000016c0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+000016d0: 206f 7065 6e20 2873 656c 662e 6461 7461   open (self.data
+000016e0: 5f66 6e2c 2027 7227 2c20 656e 636f 6469  _fn, 'r', encodi
+000016f0: 6e67 3d27 7574 6638 2729 2061 7320 6669  ng='utf8') as fi
+00001700: 6420 3a0d 0a20 2020 2020 2020 2020 2020  d :..           
+00001710: 2020 2020 2020 2020 2061 7667 5f64 6174           avg_dat
+00001720: 615f 6669 6c65 3d66 6964 2e72 6561 646c  a_file=fid.readl
+00001730: 696e 6573 2829 0d0a 2020 2020 2020 2020  ines()..        
+00001740: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+00001750: 2d2d 2d2d 6e6f 7720 6368 6563 6820 7468  ----now chech th
+00001760: 6520 6176 6720 6669 6c65 202d 2d0d 0a20  e avg file --.. 
+00001770: 2020 2020 2020 2061 7667 5f66 696c 655f         avg_file_
+00001780: 7479 7065 5f6e 756d 203d 2063 6675 6e63  type_num = cfunc
+00001790: 2e5f 7661 6c69 6461 7465 5f61 7667 5f66  ._validate_avg_f
+000017a0: 696c 6528 6176 675f 6461 7461 4c69 6e65  ile(avg_dataLine
+000017b0: 7320 3d61 7667 5f64 6174 615f 6669 6c65  s =avg_data_file
+000017c0: 290d 0a20 2020 2020 2020 2023 2d2d 2d2d  )..        #----
+000017d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000017e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
+000017f0: 0a20 2020 2020 2020 2023 2d2d 2d2d 2d2d  .        #------
+00001800: 2d2d 2d2d 2d2d 2d20 206d 6169 6e20 4156  -------  main AV
+00001810: 4720 6669 6c65 203a 4631 2061 6e64 206b  G file :F1 and k
+00001820: 6565 7020 6461 7461 2069 6e66 6f73 202d  eep data infos -
+00001830: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
+00001840: 2020 2020 2020 2069 6620 6176 675f 6669         if avg_fi
+00001850: 6c65 5f74 7970 655f 6e75 6d20 3d3d 2031  le_type_num == 1
+00001860: 3a20 0d0a 0d0a 2020 2020 2020 2020 2020  : ....          
+00001870: 2020 2320 2d2d 3e20 7275 6e20 7468 6520    # --> run the 
+00001880: 6865 6164 6c69 6e65 7320 7468 696e 2074  headlines thin t
+00001890: 6f20 6669 6e64 2074 6865 2077 6f72 6420  o find the word 
+000018a0: 2773 6b70 270d 0a20 2020 2020 2020 2020  'skp'..         
+000018b0: 2020 2066 6f72 2069 6478 202c 2069 6e66     for idx , inf
+000018c0: 6f73 2069 6e20 656e 756d 6572 6174 6520  os in enumerate 
+000018d0: 2861 7667 5f64 6174 615f 6669 6c65 293a  (avg_data_file):
+000018e0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000018f0: 2020 2069 6620 2773 6b70 2720 696e 2069     if 'skp' in i
+00001900: 6e66 6f73 203a 200d 0a20 2020 2020 2020  nfos : ..       
+00001910: 2020 2020 2020 2020 2020 2020 2061 7667               avg
+00001920: 5f64 6174 615f 6669 6c65 5f69 6e66 6f73  _data_file_infos
+00001930: 203d 2061 7667 5f64 6174 615f 6669 6c65   = avg_data_file
+00001940: 5b3a 6964 785d 0d0a 2020 2020 2020 2020  [:idx]..        
+00001950: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00001960: 6b0d 0a0d 0a20 2020 2020 2020 2020 2020  k....           
+00001970: 2073 656c 662e 4865 6164 6572 2e48 6172   self.Header.Har
+00001980: 6477 6172 6549 6e66 6f73 2e73 6574 5f68  dwareInfos.set_h
+00001990: 6172 7761 7265 5f69 6e66 6f73 280d 0a20  arware_infos(.. 
+000019a0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+000019b0: 6c69 6e65 2e73 7472 6970 2829 2066 6f72  line.strip() for
+000019c0: 206c 696e 6520 2069 6e20 6176 675f 6461   line  in avg_da
+000019d0: 7461 5f66 696c 655f 696e 666f 730d 0a20  ta_file_infos.. 
+000019e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000019f0: 2069 6620 6c69 6e65 2e73 7461 7274 7377   if line.startsw
+00001a00: 6974 6828 275c 5c27 295d 2029 0d0a 2020  ith('\\')] )..  
+00001a10: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00001a20: 2020 2020 2020 2020 7365 6c66 2e48 6561          self.Hea
+00001a30: 6465 722e 5478 2e73 6574 5f74 7261 6e73  der.Tx.set_trans
+00001a40: 6d69 7474 6572 5f70 726f 7065 7274 6965  mitter_propertie
+00001a50: 7320 280d 0a20 2020 2020 2020 2020 2020  s (..           
+00001a60: 2020 2020 2054 785f 6461 7461 203d 5b6c       Tx_data =[l
+00001a70: 696e 652e 7374 7269 7028 2920 666f 7220  ine.strip() for 
+00001a80: 6c69 6e65 2020 696e 2061 7667 5f64 6174  line  in avg_dat
+00001a90: 615f 6669 6c65 5f69 6e66 6f73 200d 0a20  a_file_infos .. 
+00001aa0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00001ab0: 6620 6c69 6e65 2e73 7461 7274 7377 6974  f line.startswit
+00001ac0: 6828 2724 2729 5d29 0d0a 2020 2020 2020  h('$')])..      
+00001ad0: 2020 2020 2020 7365 6c66 2e48 6561 6465        self.Heade
+00001ae0: 722e 5278 2e73 6574 5f72 6563 6569 7665  r.Rx.set_receive
+00001af0: 725f 7072 6f70 6572 7469 6573 2028 0d0a  r_properties (..
+00001b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001b10: 5278 5f64 6174 6120 3d5b 6c69 6e65 2e73  Rx_data =[line.s
+00001b20: 7472 6970 2829 2066 6f72 206c 696e 6520  trip() for line 
+00001b30: 2069 6e20 6176 675f 6461 7461 5f66 696c   in avg_data_fil
+00001b40: 655f 696e 666f 730d 0a20 2020 2020 2020  e_infos..       
+00001b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001b60: 2020 2020 2020 2020 2020 6966 206c 696e            if lin
+00001b70: 652e 7374 6172 7473 7769 7468 2827 2427  e.startswith('$'
+00001b80: 295d 290d 0a20 2020 2020 2020 2020 2020  )])..           
+00001b90: 200d 0a20 2020 2020 2020 2020 2020 2064   ..            d
+00001ba0: 6174 615f 746f 5f61 7272 6179 203d 6176  ata_to_array =av
+00001bb0: 675f 6461 7461 5f66 696c 6520 5b35 3a5d  g_data_file [5:]
+00001bc0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00001bd0: 2d2d 2d20 7075 7420 6461 7461 206f 6e20  --- put data on 
+00001be0: 6c69 7374 2061 6e64 2061 7272 6179 203a  list and array :
+00001bf0: 200d 0a20 2020 2020 2020 2020 2020 2064   ..            d
+00001c00: 6174 615f 746f 5f61 7272 6179 203d 206e  ata_to_array = n
+00001c10: 702e 6172 7261 7928 5b20 6461 7475 6d2e  p.array([ datum.
+00001c20: 7374 7269 7028 292e 7370 6c69 7428 2920  strip().split() 
+00001c30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001c50: 2020 2020 2020 2020 666f 7220 6461 7475          for datu
+00001c60: 6d20 696e 2064 6174 615f 746f 5f61 7272  m in data_to_arr
+00001c70: 6179 205d 290d 0a20 2020 2020 2020 2020  ay ])..         
+00001c80: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00001c90: 2023 2073 656c 662e 736b 6970 2e73 6b70   # self.skip.skp
+00001ca0: 5f66 6c61 673d 3d64 6174 615f 746f 5f61  _flag==data_to_a
+00001cb0: 7272 6179 5b30 2c30 5d20 2320 6669 6c6c  rray[0,0] # fill
+00001cc0: 2074 6865 2073 6b69 7020 666c 6167 200d   the skip flag .
+00001cd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00001ce0: 662e 536b 6970 5f66 6c61 672e 7365 7461  f.Skip_flag.seta
+00001cf0: 6e64 6765 745f 736b 6970 5f66 6c61 6728  ndget_skip_flag(
+00001d00: 736b 6970 5f66 6c61 673d 6461 7461 5f74  skip_flag=data_t
+00001d10: 6f5f 6172 7261 795b 302c 305d 290d 0a20  o_array[0,0]).. 
+00001d20: 2020 2020 2020 2020 2020 2023 2064 656c             # del
+00001d30: 6574 6520 7468 6520 736b 7020 6172 7261  ete the skp arra
+00001d40: 7920 616e 6420 636f 6d70 205f 6172 7261  y and comp _arra
+00001d50: 7920 0d0a 2020 2020 2020 2020 2020 2020  y ..            
+00001d60: 0d0a 2020 2020 2020 2020 2020 2020 6461  ..            da
+00001d70: 7461 5f74 6f5f 6172 7261 7920 3d6e 702e  ta_to_array =np.
+00001d80: 6465 6c65 7465 2864 6174 615f 746f 5f61  delete(data_to_a
+00001d90: 7272 6179 2c20 6e70 2e61 7272 6179 285b  rray, np.array([
+00001da0: 302c 335d 292c 2061 7869 7320 3d31 2029  0,3]), axis =1 )
+00001db0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00001dc0: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
+00001dd0: 6e2e 5f61 7667 5f73 6574 5f63 6f6d 706f  n._avg_set_compo
+00001de0: 6e65 6e74 735f 6672 6f6d 5f64 6174 6128  nents_from_data(
+00001df0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001e00: 2020 6461 7461 5f61 7272 6179 203d 2064    data_array = d
+00001e10: 6174 615f 746f 5f61 7272 6179 2c64 6174  ata_to_array,dat
+00001e20: 615f 7479 7065 203d 6176 675f 6669 6c65  a_type =avg_file
+00001e30: 5f74 7970 655f 6e75 6d29 200d 0a20 2020  _type_num) ..   
+00001e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e60: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00001e70: 2020 2020 2020 2020 2020 2320 536b 705f            # Skp_
+00001e80: 666c 6167 2873 6b69 705f 666c 6167 3d27  flag(skip_flag='
+00001e90: 3227 290d 0a20 2020 2020 2020 2023 2d2d  2')..        #--
+00001ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d52 6561 6420  -----------Read 
+00001eb0: 4153 5441 5449 4320 6669 6c65 203a 2046  ASTATIC file : F
+00001ec0: 3220 616e 6420 6b65 6570 2064 6174 6120  2 and keep data 
+00001ed0: 696e 666f 7320 2d2d 2d2d 2d2d 2d2d 2d2d  infos ----------
+00001ee0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 656c  ----..        el
+00001ef0: 6966 2020 6176 675f 6669 6c65 5f74 7970  if  avg_file_typ
+00001f00: 655f 6e75 6d20 3d3d 3220 3a20 0d0a 2020  e_num ==2 : ..  
+00001f10: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00001f20: 2020 2020 2020 2020 2320 7365 7420 7a6f          # set zo
+00001f30: 6e67 6520 4861 7264 7761 7265 7320 696e  nge Hardwares in
+00001f40: 666f 733a 0d0a 2020 2020 2020 2020 2020  fos:..          
+00001f50: 2020 7a6f 6e67 655f 6861 7264 775f 696e    zonge_hardw_in
+00001f60: 666f 7320 3d5b 6c69 6e65 2e73 7472 6970  fos =[line.strip
+00001f70: 2829 200d 0a20 2020 2020 2020 2020 2020  () ..           
+00001f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f90: 2020 2020 2066 6f72 206c 696e 6520 2069       for line  i
+00001fa0: 6e20 6176 675f 6461 7461 5f66 696c 6520  n avg_data_file 
+00001fb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001fd0: 2020 6966 206c 696e 652e 7374 6172 7473    if line.starts
+00001fe0: 7769 7468 2827 5c5c 2729 5d0d 0a20 2020  with('\\')]..   
+00001ff0: 2020 2020 2020 2020 2073 656c 662e 4865           self.He
+00002000: 6164 6572 2e48 6172 6477 6172 6549 6e66  ader.HardwareInf
+00002010: 6f73 2e73 6574 5f68 6172 7761 7265 5f69  os.set_harware_i
+00002020: 6e66 6f73 280d 0a20 2020 2020 2020 2020  nfos(..         
+00002030: 2020 2020 2020 207a 6f6e 6765 5f68 6172         zonge_har
+00002040: 6477 5f69 6e66 6f73 3d7a 6f6e 6765 5f68  dw_infos=zonge_h
+00002050: 6172 6477 5f69 6e66 6f73 290d 0a20 2020  ardw_infos)..   
+00002060: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00002070: 2020 2020 2020 2073 656c 662e 4865 6164         self.Head
+00002080: 6572 2e54 782e 7365 745f 7472 616e 736d  er.Tx.set_transm
+00002090: 6974 7465 725f 7072 6f70 6572 7469 6573  itter_properties
+000020a0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+000020b0: 2020 2054 785f 6461 7461 3d5b 6c69 6e65     Tx_data=[line
+000020c0: 2e73 7472 6970 2829 666f 7220 6c69 6e65  .strip()for line
+000020d0: 2069 6e20 6176 675f 6461 7461 5f66 696c   in avg_data_fil
+000020e0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+000020f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002100: 2020 2020 2020 6966 206c 696e 652e 7374        if line.st
+00002110: 6172 7473 7769 7468 2827 2454 7827 295d  artswith('$Tx')]
+00002120: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+00002130: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00002140: 2073 732c 206c 696e 655f 6176 6720 696e   ss, line_avg in
+00002150: 2065 6e75 6d65 7261 7465 2028 6176 675f   enumerate (avg_
+00002160: 6461 7461 5f66 696c 6529 3a20 0d0a 2020  data_file): ..  
+00002170: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00002180: 206c 696e 655f 6176 672e 7374 6172 7473   line_avg.starts
+00002190: 7769 7468 2827 2452 7827 293a 0d0a 2020  with('$Rx'):..  
+000021a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000021b0: 2020 2320 6b65 6570 2074 6865 2072 656d    # keep the rem
+000021c0: 6169 6e73 2064 6174 6120 2b20 5278 2d70  ains data + Rx-p
+000021d0: 726f 7065 7274 6965 730d 0a20 2020 2020  roperties..     
+000021e0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000021f0: 656d 705f 6461 7461 203d 6176 675f 6461  emp_data =avg_da
+00002200: 7461 5f66 696c 655b 7373 3a5d 200d 0a20  ta_file[ss:] .. 
+00002210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002220: 2020 2023 2074 7275 6e63 6174 6520 7468     # truncate th
+00002230: 6520 6461 7461 2061 6e20 6b65 6570 2074  e data an keep t
+00002240: 6865 2069 6e66 6f73 2061 626f 7665 2074  he infos above t
+00002250: 6869 6e20 2452 780d 0a20 2020 2020 2020  hin $Rx..       
+00002260: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00002270: 5f73 7572 765f 636f 6e66 6967 416e 6e6f  _surv_configAnno
+00002280: 743d 6176 675f 6461 7461 5f66 696c 655b  t=avg_data_file[
+00002290: 3a73 735d 200d 0a20 2020 2020 2020 2020  :ss] ..         
+000022a0: 2020 2020 2020 2020 2020 2062 7265 616b             break
+000022b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000022c0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+000022d0: 2073 656c 662e 4865 6164 6572 2e53 7572   self.Header.Sur
+000022e0: 7665 7941 6e6e 6f74 6174 696f 6e2e 7365  veyAnnotation.se
+000022f0: 745f 7375 7276 6579 5f61 6e6e 6f74 6174  t_survey_annotat
+00002300: 696f 6e73 5f69 6e66 6f73 2028 0d0a 2020  ions_infos (..  
+00002310: 2020 2020 2020 2020 2020 2020 2020 7375                su
+00002320: 7276 6579 5f61 6e6e 6f74 6174 696f 6e73  rvey_annotations
+00002330: 5f64 6174 6120 3d66 6f72 5f73 7572 765f  _data =for_surv_
+00002340: 636f 6e66 6967 416e 6e6f 7429 0d0a 2020  configAnnot)..  
+00002350: 2020 2020 2020 2020 2020 7365 6c66 2e48            self.H
+00002360: 6561 6465 722e 5375 7276 6579 436f 6e66  eader.SurveyConf
+00002370: 6967 7572 6174 696f 6e2e 7365 745f 7375  iguration.set_su
+00002380: 7276 6579 5f63 6f6e 6669 6775 7261 7469  rvey_configurati
+00002390: 6f6e 5f69 6e66 6f73 2028 0d0a 2020 2020  on_infos (..    
+000023a0: 2020 2020 2020 2020 2020 2020 7375 7276              surv
+000023b0: 6579 5f63 6f6e 6669 675f 6461 7461 3d66  ey_config_data=f
+000023c0: 6f72 5f73 7572 765f 636f 6e66 6967 416e  or_surv_configAn
+000023d0: 6e6f 7429 0d0a 2020 2020 2020 2020 2020  not)..          
+000023e0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000023f0: 7465 6d5f 642c 2072 785f 696e 666f 732c  tem_d, rx_infos,
+00002400: 2063 6f6d 705f 7265 6365 6976 5f69 6e66   comp_receiv_inf
+00002410: 6f3d 5b5d 2c5b 5d2c 5b5d 0d0a 2020 2020  o=[],[],[]..    
+00002420: 2020 2020 2020 2020 666f 7220 6a6a 2c20          for jj, 
+00002430: 6974 656d 2069 6e20 656e 756d 6572 6174  item in enumerat
+00002440: 6528 7465 6d70 5f64 6174 6129 3a20 0d0a  e(temp_data): ..
+00002450: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00002460: 2d2d 2d3e 2073 6565 6b20 7468 6520 6461  ---> seek the da
+00002470: 7461 2077 6974 686f 7574 2074 6865 206d  ta without the m
+00002480: 6172 6b20 0d0a 2020 2020 2020 2020 2020  ark ..          
+00002490: 2020 2020 2023 6f66 2074 6865 2072 6563       #of the rec
+000024a0: 6569 7665 7220 6f66 2063 6f6d 706f 6e65  eiver of compone
+000024b0: 6e74 206c 6973 7420 0d0a 2020 2020 2020  nt list ..      
+000024c0: 2020 2020 2020 2020 2069 6620 6974 656d           if item
+000024d0: 2e66 696e 6428 275a 2e6d 6167 2729 3c30  .find('Z.mag')<0
+000024e0: 2061 6e64 2069 7465 6d2e 6669 6e64 2827   and item.find('
+000024f0: 2452 7827 2920 3c20 3020 3a0d 0a20 2020  $Rx') < 0 :..   
+00002500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002510: 7373 5f5f 7465 6d70 3d69 7465 6d2e 7374  ss__temp=item.st
+00002520: 7269 7028 292e 7370 6c69 7428 272c 2729  rip().split(',')
+00002530: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002540: 2020 2020 2066 6f72 206b 6b2c 2076 616c       for kk, val
+00002550: 7565 2069 6e20 656e 756d 6572 6174 6520  ue in enumerate 
+00002560: 2820 7373 5f5f 7465 6d70 2029 203a 200d  ( ss__temp ) : .
+00002570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002580: 2020 2020 2020 2020 7472 7920 3a20 0d0a          try : ..
+00002590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000025a0: 2020 2020 2020 2020 2020 2073 735f 5f74             ss__t
+000025b0: 656d 705b 6b6b 5d3d 666c 6f61 7428 7661  emp[kk]=float(va
+000025c0: 6c75 6529 0d0a 2020 2020 2020 2020 2020  lue)..          
+000025d0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+000025e0: 6570 7420 3a20 2020 2020 232d 2d3e 2069  ept :     #--> i
+000025f0: 6e20 7468 6520 6361 7365 2077 6520 6d65  n the case we me
+00002600: 6574 2027 2a27 206d 6561 6e20 6e6f 2076  et '*' mean no v
+00002610: 616c 7565 202e 0d0a 2020 2020 2020 2020  alue ...        
+00002620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002630: 2020 2069 6620 7661 6c75 652e 7374 7269     if value.stri
+00002640: 7028 2920 3d3d 2027 2a27 203a 0d0a 2020  p() == '*' :..  
+00002650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002660: 2020 2020 2020 2020 2020 2020 2073 735f               ss_
+00002670: 5f74 656d 705b 6b6b 5d3d 6e70 2e6e 616e  _temp[kk]=np.nan
+00002680: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002690: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+000026a0: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
+000026b0: 2020 2020 2020 2020 2020 2023 2069 6620             # if 
+000026c0: 7661 6c75 653d 3d27 2a27 3a20 7373 5f5f  value=='*': ss__
+000026d0: 7465 6d70 5b6b 6b5d 3d22 3022 0d0a 2020  temp[kk]="0"..  
+000026e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000026f0: 2074 656d 5f64 2e61 7070 656e 6428 7373   tem_d.append(ss
+00002700: 5f5f 7465 6d70 290d 0a20 2020 2020 2020  __temp)..       
+00002710: 2020 2020 2020 2020 6966 2027 2452 7827          if '$Rx'
+00002720: 2069 6e20 6974 656d 203a 0d0a 2020 2020   in item :..    
+00002730: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00002740: 6f6d 705f 7265 6365 6976 5f69 6e66 6f2e  omp_receiv_info.
+00002750: 6170 7065 6e64 2869 7465 6d29 0d0a 2020  append(item)..  
+00002760: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00002770: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00002780: 6620 2724 5278 2e47 6470 5374 6e27 2069  f '$Rx.GdpStn' i
+00002790: 6e20 6974 656d 203a 0d0a 2020 2020 2020  n item :..      
+000027a0: 2020 2020 2020 2020 2020 2020 2069 7465               ite
+000027b0: 6d20 3d20 6974 656d 2e73 7472 6970 2829  m = item.strip()
+000027c0: 2e73 706c 6974 2827 3d27 295b 2d31 5d0d  .split('=')[-1].
+000027d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000027e0: 2020 2020 7278 5f69 6e66 6f73 2e61 7070      rx_infos.app
+000027f0: 656e 6428 6974 656d 290d 0a20 2020 2020  end(item)..     
+00002800: 2020 2020 2020 2020 2020 6966 2069 7465            if ite
+00002810: 6d2e 6669 6e64 2827 4152 6573 2e6d 6167  m.find('ARes.mag
+00002820: 2729 3e20 3020 616e 6420 6974 656d 2e66  ')> 0 and item.f
+00002830: 696e 6428 2753 5265 7327 293e 2030 203a  ind('SRes')> 0 :
+00002840: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002850: 2020 2020 2023 2d20 6b65 6570 2074 6865       #- keep the
+00002860: 2068 6561 6420 636f 6d70 6f6e 656e 7420   head component 
+00002870: 696e 666f 730d 0a20 2020 2020 2020 2020  infos..         
+00002880: 2020 2020 2020 2020 2020 2063 6f6d 705f             comp_
+00002890: 7365 6374 3d69 7465 6d2e 7374 7269 7028  sect=item.strip(
+000028a0: 292e 7370 6c69 7428 272c 2729 0d0a 2020  ).split(',')..  
+000028b0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+000028c0: 2020 2020 2020 2020 232d 7365 7420 7265          #-set re
+000028d0: 6365 6976 6572 7320 696e 666f 7320 0d0a  ceivers infos ..
+000028e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000028f0: 2e48 6561 6465 722e 5278 2e73 6574 5f72  .Header.Rx.set_r
+00002900: 6563 6569 7665 725f 7072 6f70 6572 7469  eceiver_properti
+00002910: 6573 2852 785f 6461 7461 203d 636f 6d70  es(Rx_data =comp
+00002920: 5f72 6563 6569 765f 696e 666f 290d 0a20  _receiv_info).. 
+00002930: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00002940: 2020 2020 2020 2020 2023 2d2d 3e20 6465           #--> de
+00002950: 6c65 7465 2074 6865 206e 6f6e 6520 7661  lete the none va
+00002960: 6c75 6520 6f6e 2064 6174 6120 0d0a 2020  lue on data ..  
+00002970: 2020 2020 2020 2020 2020 666f 7220 736b            for sk
+00002980: 202c 2069 7465 6d6d 2069 6e20 656e 756d   , itemm in enum
+00002990: 6572 6174 6528 7465 6d5f 6429 3a20 0d0a  erate(tem_d): ..
+000029a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000029b0: 6966 2069 7465 6d6d 3d3d 5b27 275d 3a20  if itemm==['']: 
+000029c0: 7465 6d5f 642e 706f 7028 736b 290d 0a20  tem_d.pop(sk).. 
+000029d0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+000029e0: 6e70 2e61 7272 6179 2874 656d 5f64 290d  np.array(tem_d).
+000029f0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00002a00: 615f 746f 5f61 7272 6179 2c20 6f74 6865  a_to_array, othe
+00002a10: 725f 636f 6d70 7320 3d20 6366 756e 632e  r_comps = cfunc.
+00002a20: 7374 7261 6967 6874 656e 5f63 6163 3243  straighten_cac2C
+00002a30: 5366 696c 6520 280d 0a20 2020 2020 2020  Sfile (..       
+00002a40: 2020 2020 2020 2020 2064 6174 615f 6172           data_ar
+00002a50: 7261 793d 6461 7461 2c63 6f6d 706f 6e65  ray=data,compone
+00002a60: 6e74 5f63 6f6c 756d 6e5f 7365 6374 696f  nt_column_sectio
+00002a70: 6e20 3d20 636f 6d70 5f73 6563 7429 0d0a  n = comp_sect)..
+00002a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ab0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00002ac0: 200d 0a20 2020 2020 2020 2020 2020 2066   ..            f
+00002ad0: 7265 715f 636f 756e 7473 2c61 7272 6179  req_counts,array
+00002ae0: 5f6f 665f 7265 7065 6174 5f66 7265 7175  _of_repeat_frequ
+00002af0: 656e 6379 3d6e 702e 756e 6971 7565 2864  ency=np.unique(d
+00002b00: 6174 615f 746f 5f61 7272 6179 5b3a 2c31  ata_to_array[:,1
+00002b10: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00002b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002b40: 2020 2020 2020 2020 7265 7475 726e 5f63          return_c
+00002b50: 6f75 6e74 733d 5472 7565 290d 0a20 2020  ounts=True)..   
+00002b60: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00002b70: 2020 2020 2020 2073 7461 7469 6f6e 5f6c         station_l
+00002b80: 6973 743d 7278 5f69 6e66 6f73 202a 2066  ist=rx_infos * f
+00002b90: 7265 715f 636f 756e 7473 2e73 697a 650d  req_counts.size.
+00002ba0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00002bb0: 2020 2020 2020 2020 2020 2073 7461 7469             stati
+00002bc0: 6f6e 5f61 7272 6179 5f66 6f72 5f64 6174  on_array_for_dat
+00002bd0: 613d 5b66 6c6f 6174 2869 6929 2066 6f72  a=[float(ii) for
+00002be0: 2069 6920 696e 2073 7461 7469 6f6e 5f6c   ii in station_l
+00002bf0: 6973 745d 0d0a 2020 2020 2020 2020 2020  ist]..          
+00002c00: 2020 7374 6174 696f 6e5f 6172 7261 795f    station_array_
+00002c10: 666f 725f 6461 7461 2e73 6f72 7428 290d  for_data.sort().
+00002c20: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+00002c30: 7469 6f6e 5f61 7272 6179 5f66 6f72 5f64  tion_array_for_d
+00002c40: 6174 613d 6e70 2e61 7272 6179 2873 7461  ata=np.array(sta
+00002c50: 7469 6f6e 5f61 7272 6179 5f66 6f72 5f64  tion_array_for_d
+00002c60: 6174 6129 0d0a 2020 2020 2020 2020 2020  ata)..          
+00002c70: 2020 6966 2073 7461 7469 6f6e 5f61 7272    if station_arr
+00002c80: 6179 5f66 6f72 5f64 6174 612e 7368 6170  ay_for_data.shap
+00002c90: 655b 305d 2021 3d64 6174 615f 746f 5f61  e[0] !=data_to_a
+00002ca0: 7272 6179 2e73 6861 7065 5b30 5d3a 200d  rray.shape[0]: .
+00002cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002cc0: 205f 6c6f 6767 6572 2e65 7272 6f72 2827   _logger.error('
+00002cd0: 5472 6f75 626c 6520 6f63 6375 7265 6420  Trouble occured 
+00002ce0: 7768 656e 2072 6561 6469 6e67 2041 7374  when reading Ast
+00002cf0: 6174 6963 2066 696c 652e 2027 0d0a 2020  atic file. '..  
+00002d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d10: 2020 2020 2020 2020 2020 2020 2749 7420              'It 
+00002d20: 7365 656d 7320 7468 6520 6672 6571 7565  seems the freque
+00002d30: 6e63 7920 6172 6520 6e6f 7420 7468 6520  ncy are not the 
+00002d40: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+00002d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d60: 2027 7361 6d65 206c 656e 6774 6820 616c   'same length al
+00002d70: 6f6e 6720 616c 6c20 7374 6174 696f 6e73  ong all stations
+00002d80: 2e27 2029 0d0a 2020 2020 2020 2020 2020  .' )..          
+00002d90: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00002da0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00002db0: 2e77 6172 6e5f 6578 706c 6963 6974 280d  .warn_explicit(.
+00002dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002dd0: 2020 2020 2027 4974 2073 6565 6d73 2073       'It seems s
+00002de0: 6f6d 6574 6869 6e67 2077 726f 6e67 2077  omething wrong w
+00002df0: 6869 6c65 2072 6561 6469 6e67 270d 0a20  hile reading'.. 
 00002e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e10: 2020 2020 2020 2020 2749 7420 7365 656d          'It seem
-00002e20: 7320 7468 6520 6672 6571 7565 6e63 7920  s the frequency 
-00002e30: 6172 6520 6e6f 7420 7468 6520 270d 0a20  are not the '.. 
-00002e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e50: 2020 2020 2020 2020 2020 2020 2027 7361               'sa
-00002e60: 6d65 206c 656e 6774 6820 616c 6f6e 6720  me length along 
-00002e70: 616c 6c20 7374 6174 696f 6e73 2e27 2029  all stations.' )
-00002e80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002e90: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00002ea0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00002eb0: 6e5f 6578 706c 6963 6974 280d 0a20 2020  n_explicit(..   
-00002ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ed0: 2027 4974 2073 6565 6d73 2073 6f6d 6574   'It seems somet
-00002ee0: 6869 6e67 2077 726f 6e67 2077 6869 6c65  hing wrong while
-00002ef0: 2072 6561 6469 6e67 270d 0a20 2020 2020   reading'..     
-00002f00: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00002f10: 2041 7374 6174 6963 2066 696c 652e 272c   Astatic file.',
-00002f20: 2063 6174 6567 6f72 793d 4465 7072 6563   category=Deprec
-00002f30: 6174 696f 6e57 6172 6e69 6e67 2c0d 0a20  ationWarning,.. 
-00002f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f50: 2020 2066 696c 656e 616d 653d 2066 756e     filename= fun
-00002f60: 632e 5f5f 6e61 6d65 5f5f 2c20 206c 696e  c.__name__,  lin
-00002f70: 656e 6f3d 3129 0d0a 2020 2020 2020 2020  eno=1)..        
-00002f80: 2020 2020 2020 2020 7261 6973 6520 4353          raise CS
-00002f90: 6578 2e70 7943 5341 4d54 4572 726f 725f  ex.pyCSAMTError_
-00002fa0: 6176 675f 6669 6c65 280d 0a20 2020 2020  avg_file(..     
-00002fb0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00002fc0: 4669 6c65 206d 6967 6874 2062 6520 636f  File might be co
-00002fd0: 7272 7570 7465 642e 206e 756d 6265 7220  rrupted. number 
-00002fe0: 6f66 2066 7265 7175 656e 6379 206d 7573  of frequency mus
-00002ff0: 7427 0d0a 2020 2020 2020 2020 2020 2020  t'..            
-00003000: 2020 2020 2020 2020 2720 6265 2074 6865          ' be the
-00003010: 2073 616d 6520 616c 6f6e 6720 616c 6f6e   same along alon
-00003020: 6720 616c 6c20 7374 6174 696f 6e73 2e20  g all stations. 
-00003030: 2027 290d 0a20 2020 2020 2020 2020 2020   ')..           
-00003040: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00003050: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00003060: 2020 2020 2064 6174 615f 746f 5f61 7272       data_to_arr
-00003070: 6179 203d 6e70 2e64 656c 6574 6528 6461  ay =np.delete(da
-00003080: 7461 5f74 6f5f 6172 7261 792c 2030 2c20  ta_to_array, 0, 
-00003090: 6178 6973 203d 3120 290d 0a20 2020 2020  axis =1 )..     
-000030a0: 2020 2020 2020 2023 2070 7269 6e74 2864         # print(d
-000030b0: 6174 615f 746f 5f61 7272 6179 2e73 6861  ata_to_array.sha
-000030c0: 7065 290d 0a20 2020 2020 2020 2020 2020  pe)..           
-000030d0: 2023 2070 7269 6e74 2820 7374 6174 696f   # print( statio
-000030e0: 6e5f 6172 7261 795f 666f 725f 6461 7461  n_array_for_data
-000030f0: 2e73 6861 7065 290d 0a20 2020 2020 2020  .shape)..       
-00003100: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00003110: 2020 2064 6174 615f 746f 5f61 7272 6179     data_to_array
-00003120: 203d 6e70 2e63 6f6e 6361 7465 6e61 7465   =np.concatenate
-00003130: 2828 7374 6174 696f 6e5f 6172 7261 795f  ((station_array_
-00003140: 666f 725f 6461 7461 2e72 6573 6861 7065  for_data.reshape
-00003150: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00003160: 2020 2073 7461 7469 6f6e 5f61 7272 6179     station_array
-00003170: 5f66 6f72 5f64 6174 612e 7368 6170 655b  _for_data.shape[
-00003180: 305d 2c31 292c 200d 0a20 2020 2020 2020  0],1), ..       
-00003190: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000031a0: 5f74 6f5f 6172 7261 7929 2c20 6178 6973  _to_array), axis
-000031b0: 3d31 2920 0d0a 2020 2020 2020 2020 2020  =1) ..          
-000031c0: 2020 2320 6461 7461 5f74 6f5f 6172 7261    # data_to_arra
-000031d0: 793d 6e70 2e69 6e73 6572 7428 6461 7461  y=np.insert(data
-000031e0: 5f74 6f5f 6172 7261 792c 2031 2c0d 0a20  _to_array, 1,.. 
-000031f0: 2020 2020 2020 2020 2020 2023 2073 7461             # sta
-00003200: 7469 6f6e 5f61 7272 6179 5f66 6f72 5f64  tion_array_for_d
-00003210: 6174 612c 2061 7869 733d 3120 290d 0a0d  ata, axis=1 )...
-00003220: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00003230: 662e 4461 7461 5f73 6563 7469 6f6e 2e5f  f.Data_section._
-00003240: 6176 675f 7365 745f 636f 6d70 6f6e 656e  avg_set_componen
-00003250: 7473 5f66 726f 6d5f 6461 7461 280d 0a20  ts_from_data(.. 
-00003260: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00003270: 6174 615f 6172 7261 7920 3d20 6461 7461  ata_array = data
-00003280: 5f74 6f5f 6172 7261 792c 0d0a 2020 2020  _to_array,..    
-00003290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000032a0: 2020 2020 6461 7461 5f74 7970 6520 3d61      data_type =a
-000032b0: 7667 5f66 696c 655f 7479 7065 5f6e 756d  vg_file_type_num
-000032c0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-000032d0: 2020 2020 2020 2020 2020 2020 6164 645f              add_
-000032e0: 6173 7461 7469 635f 6461 7461 3d20 6f74  astatic_data= ot
-000032f0: 6865 725f 636f 6d70 7329 0d0a 2020 2020  her_comps)..    
-00003300: 2020 2020 2020 2020 2320 2d2d 2077 6520          # -- we 
-00003310: 6173 7375 6d65 2074 6861 7420 6966 206e  assume that if n
-00003320: 6f74 2070 726f 626c 656d 206f 6363 7572  ot problem occur
-00003330: 6564 2074 6869 6e20 6e6f 7720 2c0d 0a20  ed thin now ,.. 
-00003340: 2020 2020 2020 2020 2020 2023 2020 7765             #  we
-00003350: 2073 6574 2073 6b69 7020 666c 6167 2074   set skip flag t
-00003360: 6f20 2732 2720 6173 2067 6f6f 6420 7175  o '2' as good qu
-00003370: 616c 6974 7920 6461 7461 200d 0a20 2020  ality data ..   
-00003380: 2020 2020 2020 2020 2073 656c 662e 536b           self.Sk
-00003390: 6970 5f66 6c61 672e 7365 7461 6e64 6765  ip_flag.setandge
-000033a0: 745f 736b 6970 5f66 6c61 6728 736b 6970  t_skip_flag(skip
-000033b0: 5f66 6c61 673d 2732 2720 2920 0d0a 2020  _flag='2' ) ..  
-000033c0: 2020 2020 2020 656c 7365 203a 200d 0a20        else : .. 
-000033d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000033e0: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-000033f0: 6f72 5f61 7667 5f66 696c 6528 0d0a 2020  or_avg_file(..  
-00003400: 2020 2020 2020 2020 2020 2020 2020 2754                'T
-00003410: 6865 206e 756d 6265 7220 7072 6f76 6964  he number provid
-00003420: 6564 2064 6f65 736e 7420 6e6f 7420 6d61  ed doesnt not ma
-00003430: 7463 6820 4176 6766 696c 652e 2729 0d0a  tch Avgfile.')..
-00003440: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00003450: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00003460: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00003470: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
-00003480: 6176 675f 7772 6974 655f 325f 746f 5f31  avg_write_2_to_1
-00003490: 2028 7365 6c66 2c20 6461 7461 5f66 6e3d   (self, data_fn=
-000034a0: 4e6f 6e65 202c 2073 6176 6570 6174 6820  None , savepath 
-000034b0: 3d4e 6f6e 6520 293a 0d0a 2020 2020 2020  =None ):..      
-000034c0: 2020 2222 2220 0d0a 2020 2020 2020 2020    """ ..        
-000034d0: 4d65 7468 6f64 2074 6f20 7265 7772 6974  Method to rewrit
-000034e0: 6520 6176 6720 4173 7461 7469 6320 6669  e avg Astatic fi
-000034f0: 6c65 2028 4632 2920 746f 206d 6169 6e20  le (F2) to main 
-00003500: 6669 6c65 2046 3120 2e0d 0a20 2020 2020  file F1 ...     
-00003510: 2020 200d 0a20 2020 2020 2020 203a 7061     ..        :pa
-00003520: 7261 6d20 6461 7461 5f66 6e3a 2041 5354  ram data_fn: AST
-00003530: 4154 4943 2046 494c 4520 0d0a 2020 2020  ATIC FILE ..    
-00003540: 2020 2020 3a74 7970 6520 6461 7461 5f66      :type data_f
-00003550: 6e3a 2073 7472 200d 0a20 2020 2020 2020  n: str ..       
-00003560: 200d 0a20 2020 2020 2020 203a 7061 7261   ..        :para
-00003570: 6d20 7361 7665 7061 7468 3a20 7061 7468  m savepath: path
-00003580: 2074 6f20 7361 7665 2079 6f75 7220 7265   to save your re
-00003590: 7772 6974 7465 6e20 6669 6c65 202e 200d  written file . .
-000035a0: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
-000035b0: 6176 6570 6174 683a 2073 7472 200d 0a20  avepath: str .. 
-000035c0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000035d0: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
-000035e0: 2064 6174 615f 666e 2069 7320 6e6f 7420   data_fn is not 
-000035f0: 4e6f 6e65 203a 2073 656c 662e 6461 7461  None : self.data
-00003600: 5f66 6e20 3d64 6174 615f 666e 200d 0a20  _fn =data_fn .. 
-00003610: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-00003620: 6174 615f 666e 2069 7320 4e6f 6e65 203a  ata_fn is None :
-00003630: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-00003640: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-00003650: 5445 7272 6f72 5f61 7667 5f66 696c 6528  TError_avg_file(
-00003660: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003670: 2020 274e 6f20 6669 6c65 2064 6574 6563    'No file detec
-00003680: 7465 642e 2063 6865 636b 2079 6f75 7220  ted. check your 
-00003690: 7269 6768 7420 7061 7468 202e 2729 0d0a  right path .')..
-000036a0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000036b0: 2020 6966 2073 656c 662e 6461 7461 5f66    if self.data_f
-000036c0: 6e20 6973 206e 6f74 204e 6f6e 6520 3a0d  n is not None :.
-000036d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000036e0: 6f73 2e70 6174 682e 6973 6669 6c65 2028  os.path.isfile (
-000036f0: 7365 6c66 2e64 6174 615f 666e 2920 6973  self.data_fn) is
-00003700: 206e 6f74 2054 7275 6520 3a0d 0a20 2020   not True :..   
-00003710: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00003720: 7365 2043 5365 782e 7079 4353 414d 5445  se CSex.pyCSAMTE
-00003730: 7272 6f72 5f61 7667 5f66 696c 6528 0d0a  rror_avg_file(..
-00003740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003750: 2020 2020 274e 6f20 6669 6c65 2064 6574      'No file det
-00003760: 6563 7465 642e 2050 6c65 6173 6520 6368  ected. Please ch
-00003770: 6563 6b20 796f 7572 2072 6967 6874 2070  eck your right p
-00003780: 6174 682e 2027 290d 0a20 2020 2020 2020  ath. ')..       
-00003790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000037a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000037b0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-000037c0: 2020 2020 2020 2023 2d2d 2063 6865 636b         #-- check
-000037d0: 2077 6865 7468 6572 2074 6865 2066 696c   whether the fil
-000037e0: 6520 6973 2061 7374 6174 6963 2066 696c  e is astatic fil
-000037f0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00003800: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00003810: 2020 2069 6620 7365 6c66 2e64 6174 615f     if self.data_
-00003820: 666e 2e65 6e64 7377 6974 6828 2761 7667  fn.endswith('avg
-00003830: 2729 206f 7220 7365 6c66 2e64 6174 615f  ') or self.data_
-00003840: 666e 2e65 6e64 7377 6974 6828 272e 4156  fn.endswith('.AV
-00003850: 4727 293a 0d0a 2020 2020 2020 2020 2020  G'):..          
-00003860: 2020 2020 2020 7769 7468 206f 7065 6e20        with open 
-00003870: 2873 656c 662e 6461 7461 5f66 6e2c 2027  (self.data_fn, '
-00003880: 7227 2c20 656e 636f 6469 6e67 3d27 7574  r', encoding='ut
-00003890: 6638 2729 2061 7320 6669 6420 3a0d 0a20  f8') as fid :.. 
+00002e10: 2020 2027 2041 7374 6174 6963 2066 696c     ' Astatic fil
+00002e20: 652e 272c 2063 6174 6567 6f72 793d 4465  e.', category=De
+00002e30: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
+00002e40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00002e50: 2020 2020 2020 2066 696c 656e 616d 653d         filename=
+00002e60: 2066 756e 632e 5f5f 6e61 6d65 5f5f 2c20   func.__name__, 
+00002e70: 206c 696e 656e 6f3d 3129 0d0a 2020 2020   lineno=1)..    
+00002e80: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00002e90: 6520 4156 4745 7272 6f72 280d 0a20 2020  e AVGError(..   
+00002ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002eb0: 2027 4669 6c65 206d 6967 6874 2062 6520   'File might be 
+00002ec0: 636f 7272 7570 7465 642e 206e 756d 6265  corrupted. numbe
+00002ed0: 7220 6f66 2066 7265 7175 656e 6379 206d  r of frequency m
+00002ee0: 7573 7427 0d0a 2020 2020 2020 2020 2020  ust'..          
+00002ef0: 2020 2020 2020 2020 2020 2720 6265 2074            ' be t
+00002f00: 6865 2073 616d 6520 616c 6f6e 6720 616c  he same along al
+00002f10: 6f6e 6720 616c 6c20 7374 6174 696f 6e73  ong all stations
+00002f20: 2e20 2027 290d 0a20 2020 2020 2020 2020  .  ')..         
+00002f30: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00002f40: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00002f50: 2020 2020 2020 2064 6174 615f 746f 5f61         data_to_a
+00002f60: 7272 6179 203d 6e70 2e64 656c 6574 6528  rray =np.delete(
+00002f70: 6461 7461 5f74 6f5f 6172 7261 792c 2030  data_to_array, 0
+00002f80: 2c20 6178 6973 203d 3120 290d 0a20 2020  , axis =1 )..   
+00002f90: 2020 2020 2020 2020 2023 2070 7269 6e74           # print
+00002fa0: 2864 6174 615f 746f 5f61 7272 6179 2e73  (data_to_array.s
+00002fb0: 6861 7065 290d 0a20 2020 2020 2020 2020  hape)..         
+00002fc0: 2020 2023 2070 7269 6e74 2820 7374 6174     # print( stat
+00002fd0: 696f 6e5f 6172 7261 795f 666f 725f 6461  ion_array_for_da
+00002fe0: 7461 2e73 6861 7065 290d 0a20 2020 2020  ta.shape)..     
+00002ff0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00003000: 2020 2020 2064 6174 615f 746f 5f61 7272       data_to_arr
+00003010: 6179 203d 6e70 2e63 6f6e 6361 7465 6e61  ay =np.concatena
+00003020: 7465 2828 7374 6174 696f 6e5f 6172 7261  te((station_arra
+00003030: 795f 666f 725f 6461 7461 2e72 6573 6861  y_for_data.resha
+00003040: 7065 280d 0a20 2020 2020 2020 2020 2020  pe(..           
+00003050: 2020 2020 2073 7461 7469 6f6e 5f61 7272       station_arr
+00003060: 6179 5f66 6f72 5f64 6174 612e 7368 6170  ay_for_data.shap
+00003070: 655b 305d 2c31 292c 200d 0a20 2020 2020  e[0],1), ..     
+00003080: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00003090: 7461 5f74 6f5f 6172 7261 7929 2c20 6178  ta_to_array), ax
+000030a0: 6973 3d31 2920 0d0a 2020 2020 2020 2020  is=1) ..        
+000030b0: 2020 2020 2320 6461 7461 5f74 6f5f 6172      # data_to_ar
+000030c0: 7261 793d 6e70 2e69 6e73 6572 7428 6461  ray=np.insert(da
+000030d0: 7461 5f74 6f5f 6172 7261 792c 2031 2c0d  ta_to_array, 1,.
+000030e0: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+000030f0: 7461 7469 6f6e 5f61 7272 6179 5f66 6f72  tation_array_for
+00003100: 5f64 6174 612c 2061 7869 733d 3120 290d  _data, axis=1 ).
+00003110: 0a0d 0a20 2020 2020 2020 2020 2020 2073  ...            s
+00003120: 656c 662e 4461 7461 5f73 6563 7469 6f6e  elf.Data_section
+00003130: 2e5f 6176 675f 7365 745f 636f 6d70 6f6e  ._avg_set_compon
+00003140: 656e 7473 5f66 726f 6d5f 6461 7461 280d  ents_from_data(.
+00003150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003160: 2064 6174 615f 6172 7261 7920 3d20 6461   data_array = da
+00003170: 7461 5f74 6f5f 6172 7261 792c 0d0a 2020  ta_to_array,..  
+00003180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003190: 2020 2020 2020 6461 7461 5f74 7970 6520        data_type 
+000031a0: 3d61 7667 5f66 696c 655f 7479 7065 5f6e  =avg_file_type_n
+000031b0: 756d 2c20 0d0a 2020 2020 2020 2020 2020  um, ..          
+000031c0: 2020 2020 2020 2020 2020 2020 2020 6164                ad
+000031d0: 645f 6173 7461 7469 635f 6461 7461 3d20  d_astatic_data= 
+000031e0: 6f74 6865 725f 636f 6d70 7329 0d0a 2020  other_comps)..  
+000031f0: 2020 2020 2020 2020 2020 2320 2d2d 2077            # -- w
+00003200: 6520 6173 7375 6d65 2074 6861 7420 6966  e assume that if
+00003210: 206e 6f74 2070 726f 626c 656d 206f 6363   not problem occ
+00003220: 7572 6564 2074 6869 6e20 6e6f 7720 2c0d  ured thin now ,.
+00003230: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
+00003240: 7765 2073 6574 2073 6b69 7020 666c 6167  we set skip flag
+00003250: 2074 6f20 2732 2720 6173 2067 6f6f 6420   to '2' as good 
+00003260: 7175 616c 6974 7920 6461 7461 200d 0a20  quality data .. 
+00003270: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00003280: 536b 6970 5f66 6c61 672e 7365 7461 6e64  Skip_flag.setand
+00003290: 6765 745f 736b 6970 5f66 6c61 6728 736b  get_skip_flag(sk
+000032a0: 6970 5f66 6c61 673d 2732 2720 2920 0d0a  ip_flag='2' ) ..
+000032b0: 2020 2020 2020 2020 656c 7365 203a 200d          else : .
+000032c0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000032d0: 7365 2041 5647 4572 726f 7228 0d0a 2020  se AVGError(..  
+000032e0: 2020 2020 2020 2020 2020 2020 2020 2754                'T
+000032f0: 6865 206e 756d 6265 7220 7072 6f76 6964  he number provid
+00003300: 6564 2064 6f65 736e 7420 6e6f 7420 6d61  ed doesnt not ma
+00003310: 7463 6820 4176 6766 696c 652e 2729 0d0a  tch Avgfile.')..
+00003320: 2020 2020 2020 2020 2020 2020 0d0a 0d0a              ....
+00003330: 2020 2020 6465 6620 6176 675f 7772 6974      def avg_writ
+00003340: 655f 325f 746f 5f31 2028 7365 6c66 2c20  e_2_to_1 (self, 
+00003350: 6461 7461 5f66 6e3d 4e6f 6e65 202c 2073  data_fn=None , s
+00003360: 6176 6570 6174 6820 3d4e 6f6e 6520 293a  avepath =None ):
+00003370: 0d0a 2020 2020 2020 2020 2222 2220 0d0a  ..        """ ..
+00003380: 2020 2020 2020 2020 4d65 7468 6f64 2074          Method t
+00003390: 6f20 7265 7772 6974 6520 6176 6720 4173  o rewrite avg As
+000033a0: 7461 7469 6320 6669 6c65 2028 4632 2920  tatic file (F2) 
+000033b0: 746f 206d 6169 6e20 6669 6c65 2046 3120  to main file F1 
+000033c0: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+000033d0: 2020 2020 203a 7061 7261 6d20 6461 7461       :param data
+000033e0: 5f66 6e3a 2041 5354 4154 4943 2046 494c  _fn: ASTATIC FIL
+000033f0: 4520 0d0a 2020 2020 2020 2020 3a74 7970  E ..        :typ
+00003400: 6520 6461 7461 5f66 6e3a 2073 7472 200d  e data_fn: str .
+00003410: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00003420: 2020 203a 7061 7261 6d20 7361 7665 7061     :param savepa
+00003430: 7468 3a20 7061 7468 2074 6f20 7361 7665  th: path to save
+00003440: 2079 6f75 7220 7265 7772 6974 7465 6e20   your rewritten 
+00003450: 6669 6c65 202e 200d 0a20 2020 2020 2020  file . ..       
+00003460: 203a 7479 7065 2073 6176 6570 6174 683a   :type savepath:
+00003470: 2073 7472 200d 0a20 2020 2020 2020 200d   str ..        .
+00003480: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00003490: 2020 2020 2020 6966 2064 6174 615f 666e        if data_fn
+000034a0: 2069 7320 6e6f 7420 4e6f 6e65 203a 2073   is not None : s
+000034b0: 656c 662e 6461 7461 5f66 6e20 3d64 6174  elf.data_fn =dat
+000034c0: 615f 666e 200d 0a20 2020 2020 2020 2069  a_fn ..        i
+000034d0: 6620 7365 6c66 2e64 6174 615f 666e 2069  f self.data_fn i
+000034e0: 7320 4e6f 6e65 203a 200d 0a20 2020 2020  s None : ..     
+000034f0: 2020 2020 2020 2072 6169 7365 2041 5647         raise AVG
+00003500: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00003510: 2020 2020 2020 2020 274e 6f20 6669 6c65          'No file
+00003520: 2064 6574 6563 7465 642e 2063 6865 636b   detected. check
+00003530: 2079 6f75 7220 7269 6768 7420 7061 7468   your right path
+00003540: 202e 2729 0d0a 2020 2020 2020 2020 0d0a   .')..        ..
+00003550: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00003560: 6461 7461 5f66 6e20 6973 206e 6f74 204e  data_fn is not N
+00003570: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
+00003580: 2020 2069 6620 6f73 2e70 6174 682e 6973     if os.path.is
+00003590: 6669 6c65 2028 7365 6c66 2e64 6174 615f  file (self.data_
+000035a0: 666e 2920 6973 206e 6f74 2054 7275 6520  fn) is not True 
+000035b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000035c0: 2020 2072 6169 7365 2041 5647 4572 726f     raise AVGErro
+000035d0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+000035e0: 2020 2020 2020 2020 274e 6f20 6669 6c65          'No file
+000035f0: 2064 6574 6563 7465 642e 2050 6c65 6173   detected. Pleas
+00003600: 6520 6368 6563 6b20 796f 7572 2072 6967  e check your rig
+00003610: 6874 2070 6174 682e 2027 290d 0a20 2020  ht path. ')..   
+00003620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003640: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00003650: 2020 2020 2020 2020 2020 2023 2d2d 2063             #-- c
+00003660: 6865 636b 2077 6865 7468 6572 2074 6865  heck whether the
+00003670: 2066 696c 6520 6973 2061 7374 6174 6963   file is astatic
+00003680: 2066 696c 6520 3a0d 0a20 2020 2020 2020   file :..       
+00003690: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+000036a0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+000036b0: 6174 615f 666e 2e65 6e64 7377 6974 6828  ata_fn.endswith(
+000036c0: 2761 7667 2729 206f 7220 7365 6c66 2e64  'avg') or self.d
+000036d0: 6174 615f 666e 2e65 6e64 7377 6974 6828  ata_fn.endswith(
+000036e0: 272e 4156 4727 293a 0d0a 2020 2020 2020  '.AVG'):..      
+000036f0: 2020 2020 2020 2020 2020 7769 7468 206f            with o
+00003700: 7065 6e20 2873 656c 662e 6461 7461 5f66  pen (self.data_f
+00003710: 6e2c 2027 7227 2c20 656e 636f 6469 6e67  n, 'r', encoding
+00003720: 3d27 7574 6638 2729 2061 7320 6669 6420  ='utf8') as fid 
+00003730: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00003740: 2020 2020 2020 2061 7667 5f64 6174 615f         avg_data_
+00003750: 6669 6c65 3d66 6964 2e72 6561 646c 696e  file=fid.readlin
+00003760: 6573 2829 2020 0d0a 2020 2020 2020 2020  es()  ..        
+00003770: 2020 2020 2020 2020 7365 6c66 2e63 6865          self.che
+00003780: 636b 6572 203d 2063 6675 6e63 2e5f 7661  cker = cfunc._va
+00003790: 6c69 6461 7465 5f61 7667 5f66 696c 6528  lidate_avg_file(
+000037a0: 6176 675f 6461 7461 5f66 696c 6529 0d0a  avg_data_file)..
+000037b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000037c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000037d0: 2020 6966 2073 656c 662e 6368 6563 6b65    if self.checke
+000037e0: 7220 3d3d 2031 203a 0d0a 2020 2020 2020  r == 1 :..      
+000037f0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00003800: 6973 6520 4156 4745 7272 6f72 280d 0a20  ise AVGError(.. 
+00003810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003820: 2020 2020 2020 2027 496e 7075 7420 4176         'Input Av
+00003830: 6766 696c 6520 3c20 7b30 7d3e 2069 7320  gfile < {0}> is 
+00003840: 6e6f 7420 5a6f 6e67 6520 4153 5441 5449  not Zonge ASTATI
+00003850: 4320 6669 6c65 2e20 270d 0a20 2020 2020  C file. '..     
+00003860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003870: 2020 2027 506c 6561 7365 2070 7574 2074     'Please put t
+00003880: 6865 2072 6967 6874 2066 696c 6520 2127  he right file !'
+00003890: 2e66 6f72 6d61 7428 0d0a 2020 2020 2020  .format(..      
 000038a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000038b0: 2020 2061 7667 5f64 6174 615f 6669 6c65     avg_data_file
-000038c0: 3d66 6964 2e72 6561 646c 696e 6573 2829  =fid.readlines()
-000038d0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-000038e0: 2020 2020 7365 6c66 2e63 6865 636b 6572      self.checker
-000038f0: 203d 2063 6675 6e63 2e5f 7661 6c69 6461   = cfunc._valida
-00003900: 7465 5f61 7667 5f66 696c 6528 6176 675f  te_avg_file(avg_
-00003910: 6461 7461 5f66 696c 6529 0d0a 2020 2020  data_file)..    
-00003920: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00003930: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00003940: 2073 656c 662e 6368 6563 6b65 7220 3d3d   self.checker ==
-00003950: 2031 203a 0d0a 2020 2020 2020 2020 2020   1 :..          
-00003960: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00003970: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00003980: 725f 6176 675f 6669 6c65 280d 0a20 2020  r_avg_file(..   
-00003990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000039a0: 2020 2020 2027 496e 7075 7420 4176 6766       'Input Avgf
-000039b0: 696c 6520 3c20 7b30 7d3e 2069 7320 6e6f  ile < {0}> is no
-000039c0: 7420 5a6f 6e67 6520 4153 5441 5449 4320  t Zonge ASTATIC 
-000039d0: 6669 6c65 2e20 270d 0a20 2020 2020 2020  file. '..       
-000039e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000039f0: 2027 506c 6561 7365 2070 7574 2074 6865   'Please put the
-00003a00: 2072 6967 6874 2066 696c 6520 2127 2e66   right file !'.f
-00003a10: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
-00003a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003a30: 2020 2020 6f73 2e70 6174 682e 6261 7365      os.path.base
-00003a40: 6e61 6d65 2873 656c 662e 6461 7461 5f66  name(self.data_f
-00003a50: 6e29 2929 0d0a 2020 2020 2020 2020 2020  n)))..          
-00003a60: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00003a70: 2020 2020 2020 2020 656c 7365 203a 0d0a          else :..
-00003a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003a90: 7261 6973 6520 4353 6578 2e70 7943 5341  raise CSex.pyCSA
-00003aa0: 4d54 4572 726f 725f 4156 4728 0d0a 2020  MTError_AVG(..  
-00003ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ac0: 2020 274e 6f20 6176 6720 6669 6c65 2064    'No avg file d
-00003ad0: 6574 6563 7465 6420 2120 506c 6561 7365  etected ! Please
-00003ae0: 2063 6865 636b 2079 6f75 7220 6669 6c65   check your file
-00003af0: 2021 2729 0d0a 2020 2020 2020 2020 2020   !')..          
-00003b00: 2020 0d0a 2020 2020 2020 2020 7772 6974    ..        writ
-00003b10: 655f 6c69 6e65 7320 3d5b 275c 5c27 5d0d  e_lines =['\\'].
-00003b20: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00003b30: 2020 2073 656c 662e 5f72 6561 645f 6176     self._read_av
-00003b40: 675f 6669 6c65 2864 6174 615f 666e 3d73  g_file(data_fn=s
-00003b50: 656c 662e 6461 7461 5f66 6e29 0d0a 2020  elf.data_fn)..  
-00003b60: 2020 2020 2020 4857 5f64 6963 7420 3d73        HW_dict =s
-00003b70: 656c 662e 4865 6164 6572 2e48 6172 6477  elf.Header.Hardw
-00003b80: 6172 6549 6e66 6f73 2e73 636f 6e66 6967  areInfos.sconfig
-00003b90: 5f64 6963 740d 0a20 2020 2020 2020 2066  _dict..        f
-00003ba0: 6f72 206b 6579 732c 2076 616c 7565 7320  or keys, values 
-00003bb0: 696e 2048 575f 6469 6374 2e69 7465 6d73  in HW_dict.items
-00003bc0: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-00003bd0: 2069 6620 2761 7374 6174 6963 2720 3d3d   if 'astatic' ==
-00003be0: 2028 7374 7228 6b65 7973 2929 2e6c 6f77   (str(keys)).low
-00003bf0: 6572 2829 206f 7220 6b65 7973 3d3d 2727  er() or keys==''
-00003c00: 203a 636f 6e74 696e 7565 0d0a 2020 2020   :continue..    
-00003c10: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
-00003c20: 6528 7661 6c75 6573 2920 6973 206c 6973  e(values) is lis
-00003c30: 743a 7661 6c75 6573 203d 2727 2e6a 6f69  t:values =''.joi
-00003c40: 6e28 5b73 7320 666f 7220 7373 2069 6e20  n([ss for ss in 
-00003c50: 7661 6c75 6573 5d29 0d0a 2020 2020 2020  values])..      
-00003c60: 2020 2020 2020 7772 6974 655f 6c69 6e65        write_line
-00003c70: 732e 6170 7065 6e64 2827 272e 6a6f 696e  s.append(''.join
-00003c80: 285b 6b65 7973 2c20 273a 272c 7661 6c75  ([keys, ':',valu
-00003c90: 6573 5d2b 5b27 2c27 5d29 290d 0a20 2020  es]+[',']))..   
-00003ca0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00003cb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00003cc0: 2023 6164 6420 636f 7079 6c65 6674 2e0d   #add copyleft..
-00003cd0: 0a20 2020 2020 2020 2077 7269 7465 5f6c  .        write_l
-00003ce0: 696e 6573 2e61 7070 656e 6428 7365 6c66  ines.append(self
-00003cf0: 2e48 6561 6465 722e 4861 7264 7761 7265  .Header.Hardware
-00003d00: 496e 666f 732e 5f77 7269 7465 725f 636f  Infos._writer_co
-00003d10: 7079 6c65 6674 2b0d 0a20 2020 2020 2020  pyleft+..       
-00003d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d30: 2020 2020 273a 207b 307d 2d7b 317d 272e      ': {0}-{1}'.
-00003d40: 666f 726d 6174 2864 6174 6574 696d 652e  format(datetime.
-00003d50: 6e6f 7728 292c 2074 696d 657a 6f6e 652e  now(), timezone.
-00003d60: 7574 6329 202b 275c 6e27 2920 2020 2020  utc) +'\n')     
-00003d70: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00003d80: 2020 2020 0d0a 2020 2020 2020 2020 2023      ..         #
-00003d90: 2073 7461 7274 2077 7269 7469 6e67 2063   start writing c
-00003da0: 6f6e 6669 6775 7265 2070 6172 742e 0d0a  onfigure part...
-00003db0: 2020 2020 2020 2020 7772 6974 655f 6c69          write_li
-00003dc0: 6e65 732e 6170 7065 6e64 2822 222e 6a6f  nes.append("".jo
-00003dd0: 696e 285b 7365 6c66 2e5f 7a6d 6172 6b2c  in([self._zmark,
-00003de0: 277b 303a 3c37 7d27 2e66 6f72 6d61 7428  '{0:<7}'.format(
-00003df0: 2720 4153 5041 4345 2729 2c0d 0a20 2020  ' ASPACE'),..   
-00003e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003e20: 2027 3d27 2c27 7b30 3a3e 377d 272e 666f   '=','{0:>7}'.fo
-00003e30: 726d 6174 2820 7365 6c66 2e48 6561 6465  rmat( self.Heade
-00003e40: 722e 5278 2e72 784c 656e 6774 6829 2c0d  r.Rx.rxLength),.
-00003e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003e70: 2020 2020 2073 656c 662e 4865 6164 6572       self.Header
-00003e80: 2e52 782e 756e 6974 5d29 2b27 5c6e 2729  .Rx.unit])+'\n')
-00003e90: 0d0a 2020 2020 2020 2020 7772 6974 655f  ..        write_
-00003ea0: 6c69 6e65 732e 6170 7065 6e64 2822 222e  lines.append("".
-00003eb0: 6a6f 696e 285b 7365 6c66 2e5f 7a6d 6172  join([self._zmar
-00003ec0: 6b2c 277b 303a 3c37 7d27 2e66 6f72 6d61  k,'{0:<7}'.forma
-00003ed0: 7428 2720 584d 5452 2729 2c0d 0a20 2020  t(' XMTR'),..   
+000038b0: 2020 2020 2020 6f73 2e70 6174 682e 6261        os.path.ba
+000038c0: 7365 6e61 6d65 2873 656c 662e 6461 7461  sename(self.data
+000038d0: 5f66 6e29 2929 0d0a 2020 2020 2020 2020  _fn)))..        
+000038e0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+000038f0: 2020 2020 2020 2020 2020 656c 7365 203a            else :
+00003900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003910: 2020 7261 6973 6520 4156 4745 7272 6f72    raise AVGError
+00003920: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00003930: 2020 2020 2020 2027 4e6f 2061 7667 2066         'No avg f
+00003940: 696c 6520 6465 7465 6374 6564 2021 2050  ile detected ! P
+00003950: 6c65 6173 6520 6368 6563 6b20 796f 7572  lease check your
+00003960: 2066 696c 6520 2127 290d 0a20 2020 2020   file !')..     
+00003970: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00003980: 2077 7269 7465 5f6c 696e 6573 203d 5b27   write_lines =['
+00003990: 5c5c 275d 0d0a 2020 2020 2020 2020 0d0a  \\']..        ..
+000039a0: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
+000039b0: 6164 5f61 7667 5f66 696c 6528 6461 7461  ad_avg_file(data
+000039c0: 5f66 6e3d 7365 6c66 2e64 6174 615f 666e  _fn=self.data_fn
+000039d0: 290d 0a20 2020 2020 2020 2048 575f 6469  )..        HW_di
+000039e0: 6374 203d 7365 6c66 2e48 6561 6465 722e  ct =self.Header.
+000039f0: 4861 7264 7761 7265 496e 666f 732e 7363  HardwareInfos.sc
+00003a00: 6f6e 6669 675f 6469 6374 0d0a 2020 2020  onfig_dict..    
+00003a10: 2020 2020 666f 7220 6b65 7973 2c20 7661      for keys, va
+00003a20: 6c75 6573 2069 6e20 4857 5f64 6963 742e  lues in HW_dict.
+00003a30: 6974 656d 7328 293a 0d0a 2020 2020 2020  items():..      
+00003a40: 2020 2020 2020 6966 2027 6173 7461 7469        if 'astati
+00003a50: 6327 203d 3d20 2873 7472 286b 6579 7329  c' == (str(keys)
+00003a60: 292e 6c6f 7765 7228 2920 6f72 206b 6579  ).lower() or key
+00003a70: 733d 3d27 2720 3a63 6f6e 7469 6e75 650d  s=='' :continue.
+00003a80: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00003a90: 6620 7479 7065 2876 616c 7565 7329 2069  f type(values) i
+00003aa0: 7320 6c69 7374 3a76 616c 7565 7320 3d27  s list:values ='
+00003ab0: 272e 6a6f 696e 285b 7373 2066 6f72 2073  '.join([ss for s
+00003ac0: 7320 696e 2076 616c 7565 735d 290d 0a20  s in values]).. 
+00003ad0: 2020 2020 2020 2020 2020 2077 7269 7465             write
+00003ae0: 5f6c 696e 6573 2e61 7070 656e 6428 2727  _lines.append(''
+00003af0: 2e6a 6f69 6e28 5b6b 6579 732c 2027 3a27  .join([keys, ':'
+00003b00: 2c76 616c 7565 735d 2b5b 272c 275d 2929  ,values]+[',']))
+00003b10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003b20: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+00003b30: 2020 2020 2020 2361 6464 2063 6f70 796c        #add copyl
+00003b40: 6566 742e 0d0a 2020 2020 2020 2020 7772  eft...        wr
+00003b50: 6974 655f 6c69 6e65 732e 6170 7065 6e64  ite_lines.append
+00003b60: 2873 656c 662e 4865 6164 6572 2e48 6172  (self.Header.Har
+00003b70: 6477 6172 6549 6e66 6f73 2e5f 7772 6974  dwareInfos._writ
+00003b80: 6572 5f63 6f70 796c 6566 742b 0d0a 2020  er_copyleft+..  
+00003b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003ba0: 2020 2020 2020 2020 2027 3a20 7b30 7d2d           ': {0}-
+00003bb0: 7b31 7d27 2e66 6f72 6d61 7428 6461 7465  {1}'.format(date
+00003bc0: 7469 6d65 2e6e 6f77 2829 2c20 7469 6d65  time.now(), time
+00003bd0: 7a6f 6e65 2e75 7463 2920 2b27 5c6e 2729  zone.utc) +'\n')
+00003be0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00003bf0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00003c00: 2020 2020 2320 7374 6172 7420 7772 6974      # start writ
+00003c10: 696e 6720 636f 6e66 6967 7572 6520 7061  ing configure pa
+00003c20: 7274 2e0d 0a20 2020 2020 2020 2077 7269  rt...        wri
+00003c30: 7465 5f6c 696e 6573 2e61 7070 656e 6428  te_lines.append(
+00003c40: 2222 2e6a 6f69 6e28 5b73 656c 662e 5f7a  "".join([self._z
+00003c50: 6d61 726b 2c27 7b30 3a3c 377d 272e 666f  mark,'{0:<7}'.fo
+00003c60: 726d 6174 2827 2041 5350 4143 4527 292c  rmat(' ASPACE'),
+00003c70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003c90: 2020 2020 2020 273d 272c 277b 303a 3e37        '=','{0:>7
+00003ca0: 7d27 2e66 6f72 6d61 7428 2073 656c 662e  }'.format( self.
+00003cb0: 4865 6164 6572 2e52 782e 7278 4c65 6e67  Header.Rx.rxLeng
+00003cc0: 7468 292c 0d0a 2020 2020 2020 2020 2020  th),..          
+00003cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003ce0: 2020 2020 2020 2020 2020 7365 6c66 2e48            self.H
+00003cf0: 6561 6465 722e 5278 2e75 6e69 745d 292b  eader.Rx.unit])+
+00003d00: 275c 6e27 290d 0a20 2020 2020 2020 2077  '\n')..        w
+00003d10: 7269 7465 5f6c 696e 6573 2e61 7070 656e  rite_lines.appen
+00003d20: 6428 2222 2e6a 6f69 6e28 5b73 656c 662e  d("".join([self.
+00003d30: 5f7a 6d61 726b 2c27 7b30 3a3c 377d 272e  _zmark,'{0:<7}'.
+00003d40: 666f 726d 6174 2827 2058 4d54 5227 292c  format(' XMTR'),
+00003d50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d70: 2020 2020 2020 273d 272c 2027 7b30 3a3e        '=', '{0:>
+00003d80: 377d 272e 666f 726d 6174 280d 0a20 2020  7}'.format(..   
+00003d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003db0: 2020 2020 2073 656c 662e 4865 6164 6572       self.Header
+00003dc0: 2e54 782e 7478 4764 7053 746e 295d 292b  .Tx.txGdpStn)])+
+00003dd0: 275c 6e27 290d 0a20 2020 2020 2020 200d  '\n')..        .
+00003de0: 0a20 2020 2020 2020 2023 2077 7269 7465  .        # write
+00003df0: 5f6c 696e 6573 2e61 7070 656e 6428 2727  _lines.append(''
+00003e00: 2e6a 6f69 6e28 5b22 7b30 3a5e 397d 222e  .join(["{0:^9}".
+00003e10: 666f 726d 6174 2869 6478 290d 0a20 2020  format(idx)..   
+00003e20: 2020 2020 2023 2066 6f72 2069 6478 2069       # for idx i
+00003e30: 6e20 7365 6c66 2e5f 6631 5f6c 6162 656c  n self._f1_label
+00003e40: 735d 292b 275c 6e27 290d 0a20 2020 2020  s])+'\n')..     
+00003e50: 2020 200d 0a20 2020 2020 2020 2023 2d2d     ..        #--
+00003e60: 2d2d 2d2d 7772 6974 6520 7468 6520 696e  ----write the in
+00003e70: 7465 726c 6967 6e65 206c 6162 656c 7320  terligne labels 
+00003e80: 616e 6420 6d61 726b 6572 7320 2d2d 2d2d  and markers ----
+00003e90: 2d2d 2d2d 2d0d 0a0d 0a20 2020 2020 2020  -----....       
+00003ea0: 2064 6566 2064 7261 775f 6663 2866 6f72   def draw_fc(for
+00003eb0: 6d61 745f 6c65 6e20 3d5b 277b 3a5e 337d  mat_len =['{:^3}
+00003ec0: 272c 277b 3a5e 377d 272c 277b 3a5e 377d  ','{:^7}','{:^7}
+00003ed0: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
 00003ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003f00: 2027 3d27 2c20 277b 303a 3e37 7d27 2e66   '=', '{0:>7}'.f
-00003f10: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
+00003ef0: 2020 2020 2027 7b3a 5e37 7d27 2c27 7b3a       '{:^7}','{:
+00003f00: 5e36 7d27 2c27 7b3a 5e31 327d 272c 0d0a  ^6}','{:^12}',..
+00003f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00003f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003f40: 7365 6c66 2e48 6561 6465 722e 5478 2e74  self.Header.Tx.t
-00003f50: 7847 6470 5374 6e29 5d29 2b27 5c6e 2729  xGdpStn)])+'\n')
-00003f60: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00003f70: 2020 2020 2320 7772 6974 655f 6c69 6e65      # write_line
-00003f80: 732e 6170 7065 6e64 2827 272e 6a6f 696e  s.append(''.join
-00003f90: 285b 227b 303a 5e39 7d22 2e66 6f72 6d61  (["{0:^9}".forma
-00003fa0: 7428 6964 7829 0d0a 2020 2020 2020 2020  t(idx)..        
-00003fb0: 2320 666f 7220 6964 7820 696e 2073 656c  # for idx in sel
-00003fc0: 662e 5f66 315f 6c61 6265 6c73 5d29 2b27  f._f1_labels])+'
-00003fd0: 5c6e 2729 0d0a 2020 2020 2020 2020 0d0a  \n')..        ..
-00003fe0: 2020 2020 2020 2020 232d 2d2d 2d2d 2d77          #------w
-00003ff0: 7269 7465 2074 6865 2069 6e74 6572 6c69  rite the interli
-00004000: 676e 6520 6c61 6265 6c73 2061 6e64 206d  gne labels and m
-00004010: 6172 6b65 7273 202d 2d2d 2d2d 2d2d 2d2d  arkers ---------
-00004020: 0d0a 0d0a 2020 2020 2020 2020 6465 6620  ....        def 
-00004030: 6472 6177 5f66 6328 666f 726d 6174 5f6c  draw_fc(format_l
-00004040: 656e 203d 5b27 7b3a 5e33 7d27 2c27 7b3a  en =['{:^3}','{:
-00004050: 5e37 7d27 2c27 7b3a 5e37 7d27 2c0d 0a20  ^7}','{:^7}',.. 
-00004060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004080: 277b 3a5e 377d 272c 277b 3a5e 367d 272c  '{:^7}','{:^6}',
-00004090: 277b 3a5e 3132 7d27 2c0d 0a20 2020 2020  '{:^12}',..     
-000040a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000040b0: 2020 2020 2020 2020 2020 2020 277b 3a5e              '{:^
-000040c0: 387d 272c 277b 3a5e 3132 7d27 2c27 7b3a  8}','{:^12}','{:
-000040d0: 5e39 7d27 2c0d 0a20 2020 2020 2020 2020  ^9}',..         
-000040e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000040f0: 2020 2020 2020 2020 277b 3a5e 3132 7d27          '{:^12}'
-00004100: 2c27 7b3a 5e39 7d27 2c27 7b3a 5e37 7d27  ,'{:^9}','{:^7}'
-00004110: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00004120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004130: 2020 2020 277b 3a5e 377d 272c 277b 3a5e      '{:^7}','{:^
-00004140: 377d 272c 277b 3a5e 377d 272c 0d0a 2020  7}','{:^7}',..  
-00004150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004160: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00004170: 7b3a 5e37 7d27 2c27 7b3a 5e37 7d27 5d20  {:^7}','{:^7}'] 
-00004180: 2c20 7661 6c75 655f 746f 5f66 6f72 6d61  , value_to_forma
-00004190: 743d 7365 6c66 2e5f 6631 5f6c 6162 656c  t=self._f1_label
-000041a0: 7329 3a0d 0a20 2020 2020 2020 2020 2020  s):..           
-000041b0: 2022 2222 200d 0a20 2020 2020 2020 2020   """ ..         
-000041c0: 2020 2044 7261 776e 2066 6f72 6d61 7461     Drawn formata
-000041d0: 6765 2063 6861 696e 202e 200d 0a20 2020  ge chain . ..   
-000041e0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-000041f0: 2020 2020 2020 203a 7061 7261 6d20 666f         :param fo
-00004200: 726d 6174 5f6c 656e 3a20 6c69 7374 206f  rmat_len: list o
-00004210: 6620 666f 726d 6174 6167 6520 696e 6469  f formatage indi
-00004220: 6361 746f 7220 2c20 666c 6578 6962 6c65  cator , flexible
-00004230: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
-00004240: 3a74 7970 6520 666f 726d 6174 5f6c 656e  :type format_len
-00004250: 3a20 6c69 7374 200d 0a20 2020 2020 2020  : list ..       
-00004260: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00004270: 2020 203a 7061 7261 6d20 7661 6c75 652d     :param value-
-00004280: 746f 2d66 6f72 6d61 743a 2074 6865 206c  to-format: the l
-00004290: 6973 7420 6f66 2069 7465 6d20 7765 2077  ist of item we w
-000042a0: 616e 7420 746f 2066 6f72 6d61 742e 0d0a  ant to format...
-000042b0: 2020 2020 2020 2020 2020 2020 3a74 7970              :typ
-000042c0: 6520 7661 6c75 655f 746f 5f66 6f72 6d61  e value_to_forma
-000042d0: 743a 206c 6973 7420 0d0a 2020 2020 2020  t: list ..      
-000042e0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000042f0: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-00004300: 3a20 7573 6572 2063 616e 2063 6861 6e67  : user can chang
-00004310: 6520 7468 6520 6469 7370 6f73 616c 206f  e the disposal o
-00004320: 6620 6176 675f 6c61 6265 6c73 2e0d 0a20  f avg_labels... 
-00004330: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00004340: 2022 2222 0d0a 2020 2020 2020 2020 2020   """..          
-00004350: 2020 666f 7220 7373 2c20 6974 656d 2069    for ss, item i
-00004360: 6e20 656e 756d 6572 6174 6528 666f 726d  n enumerate(form
-00004370: 6174 5f6c 656e 293a 0d0a 2020 2020 2020  at_len):..      
-00004380: 2020 2020 2020 2020 2020 7661 6c75 655f            value_
-00004390: 746f 5f66 6f72 6d61 745b 7373 5d3d 6974  to_format[ss]=it
-000043a0: 656d 2e66 6f72 6d61 7428 7661 6c75 655f  em.format(value_
-000043b0: 746f 5f66 6f72 6d61 745b 7373 5d29 0d0a  to_format[ss])..
-000043c0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000043d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000043e0: 2027 272e 6a6f 696e 285b 6e65 775f 6361   ''.join([new_ca
-000043f0: 7266 2066 6f72 206e 6577 5f63 6172 6620  rf for new_carf 
-00004400: 696e 2076 616c 7565 5f74 6f5f 666f 726d  in value_to_form
-00004410: 6174 5d29 0d0a 2020 2020 2020 2020 0d0a  at])..        ..
-00004420: 2020 2020 2020 2020 7772 6974 655f 6c69          write_li
-00004430: 6e65 732e 6170 7065 6e64 2864 7261 775f  nes.append(draw_
-00004440: 6663 2829 2b27 5c6e 2729 0d0a 2020 2020  fc()+'\n')..    
-00004450: 2020 2020 7772 6974 655f 6c69 6e65 732e      write_lines.
-00004460: 6170 7065 6e64 2827 5c5c 2729 0d0a 2020  append('\\')..  
-00004470: 2020 2020 2020 7772 6974 655f 6c69 6e65        write_line
-00004480: 732e 6170 7065 6e64 2827 2b2b 272e 6a6f  s.append('++'.jo
-00004490: 696e 285b 696e 7428 7373 2920 2a20 272d  in([int(ss) * '-
-000044a0: 2720 0d0a 2020 2020 2020 2020 2020 2020  ' ..            
-000044b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000044c0: 2020 2020 2020 2020 2020 666f 7220 7373            for ss
-000044d0: 2069 6e20 5b27 3127 2c27 3527 2c27 3527   in ['1','5','5'
-000044e0: 2c27 3527 2c27 3427 2c27 3130 272c 0d0a  ,'5','4','10',..
-000044f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004520: 2736 272c 2731 3027 2c27 3727 2c27 3130  '6','10','7','10
-00004530: 272c 2737 272c 2735 272c 0d0a 2020 2020  ','7','5',..    
-00004540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004560: 2020 2020 2020 2020 2020 2020 2735 272c              '5',
-00004570: 2735 272c 2735 272c 2735 272c 2735 275d  '5','5','5','5']
-00004580: 205d 292b 272b 5c6e 2729 0d0a 0d0a 2020   ])+'+\n')....  
-00004590: 2020 2020 2020 232d 2d2d 2d2d 2d2d 2d2d        #---------
-000045a0: 2d2d 2d73 7461 7274 2077 7269 7465 2062  ---start write b
-000045b0: 6c6f 636b 2064 6174 6120 2d2d 2d2d 2d2d  lock data ------
-000045c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
-000045d0: 2020 2020 2020 2073 746e 4e61 6d65 7320         stnNames 
-000045e0: 3d73 656c 662e 4461 7461 5f73 6563 7469  =self.Data_secti
-000045f0: 6f6e 2e53 7461 7469 6f6e 2e6e 616d 6573  on.Station.names
-00004600: 0d0a 0d0a 2020 2020 2020 2020 2320 6e6f  ....        # no
-00004610: 7420 7573 6566 756c 6c20 2c20 7765 2072  t usefull , we r
-00004620: 6570 6c61 6365 206e 616e 2061 7420 7468  eplace nan at th
-00004630: 6520 626f 7474 6f6d 202e 0d0a 2020 2020  e bottom ...    
-00004640: 2020 2020 6465 6620 6e61 6e5f 746f 5f7a      def nan_to_z
-00004650: 7374 6172 286e 616e 5f61 7272 6179 2c20  star(nan_array, 
-00004660: 7377 6170 6572 3d27 2a27 2029 3a20 0d0a  swaper='*' ): ..
-00004670: 2020 2020 2020 2020 2020 2020 2222 220d              """.
-00004680: 0a20 2020 2020 2020 2020 2020 2053 7761  .            Swa
-00004690: 7070 206e 702e 6e61 6e20 6e75 6d62 6572  pp np.nan number
-000046a0: 206f 6e20 7468 6520 6461 7461 202e 0d0a   on the data ...
-000046b0: 2020 2020 2020 2020 2020 2020 2222 220d              """.
-000046c0: 0a20 2020 2020 2020 2020 2020 206e 616e  .            nan
-000046d0: 5f61 7272 6179 3d20 6e70 2e6e 616e 5f74  _array= np.nan_t
-000046e0: 6f5f 6e75 6d28 6e61 6e5f 6172 7261 792c  o_num(nan_array,
-000046f0: 206e 616e 3d2d 3939 3929 0d0a 2020 2020   nan=-999)..    
-00004700: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00004710: 702e 7768 6572 6528 6e61 6e5f 6172 7261  p.where(nan_arra
-00004720: 793d 3d2d 3939 392c 2073 7761 7065 722c  y==-999, swaper,
-00004730: 206e 616e 5f61 7272 6179 290d 0a20 2020   nan_array)..   
-00004740: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00004750: 2020 2023 2d2d 6272 696e 6720 6261 636b     #--bring back
-00004760: 2061 6c6c 2064 6174 6120 2d2d 2d2d 0d0a   all data ----..
-00004770: 2020 2020 2020 2020 7374 6e3d 6e70 2e63          stn=np.c
-00004780: 6f6e 6361 7465 6e61 7465 280d 0a20 2020  oncatenate(..   
-00004790: 2020 2020 2020 2020 2028 5b73 656c 662e           ([self.
-000047a0: 4461 7461 5f73 6563 7469 6f6e 2e53 7461  Data_section.Sta
-000047b0: 7469 6f6e 2e6c 6f63 5b6e 616d 655d 200d  tion.loc[name] .
-000047c0: 0a20 2020 2020 2020 2020 2020 2020 2066  .              f
-000047d0: 6f72 2020 6e61 6d65 2069 6e20 2073 746e  or  name in  stn
-000047e0: 4e61 6d65 735d 292c 2061 7869 733d 3029  Names]), axis=0)
-000047f0: 0d0a 2020 2020 2020 2020 6672 6571 3d6e  ..        freq=n
-00004800: 702e 636f 6e63 6174 656e 6174 6528 0d0a  p.concatenate(..
-00004810: 2020 2020 2020 2020 2020 2020 285b 7365              ([se
-00004820: 6c66 2e44 6174 615f 7365 6374 696f 6e2e  lf.Data_section.
-00004830: 4672 6571 7565 6e63 792e 6c6f 635b 6e61  Frequency.loc[na
-00004840: 6d65 5d20 0d0a 2020 2020 2020 2020 2020  me] ..          
-00004850: 2020 2020 666f 7220 206e 616d 6520 696e      for  name in
-00004860: 2020 7374 6e4e 616d 6573 5d29 2c20 6178    stnNames]), ax
-00004870: 6973 3d30 290d 0a20 2020 2020 2020 2061  is=0)..        a
-00004880: 6d70 733d 6e70 2e63 6f6e 6361 7465 6e61  mps=np.concatena
-00004890: 7465 280d 0a20 2020 2020 2020 2020 2020  te(..           
-000048a0: 2028 5b73 656c 662e 4461 7461 5f73 6563   ([self.Data_sec
-000048b0: 7469 6f6e 2e41 6d70 732e 6c6f 635b 6e61  tion.Amps.loc[na
-000048c0: 6d65 5d20 0d0a 2020 2020 2020 2020 2020  me] ..          
-000048d0: 2020 2020 666f 7220 6e61 6d65 2069 6e20      for name in 
-000048e0: 7374 6e4e 616d 6573 5d29 2c20 6178 6973  stnNames]), axis
-000048f0: 3d30 290d 0a20 2020 2020 2020 2065 6d61  =0)..        ema
-00004900: 673d 6e70 2e63 6f6e 6361 7465 6e61 7465  g=np.concatenate
-00004910: 280d 0a20 2020 2020 2020 2020 2020 2028  (..            (
-00004920: 5b73 656c 662e 4461 7461 5f73 6563 7469  [self.Data_secti
-00004930: 6f6e 2e45 6d61 672e 6c6f 635b 6e61 6d65  on.Emag.loc[name
-00004940: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
-00004950: 2020 666f 7220 206e 616d 6520 696e 2020    for  name in  
-00004960: 7374 6e4e 616d 6573 5d29 2c20 6178 6973  stnNames]), axis
-00004970: 3d30 290d 0a20 2020 2020 2020 2065 7068  =0)..        eph
-00004980: 7a3d 6e70 2e63 6f6e 6361 7465 6e61 7465  z=np.concatenate
-00004990: 280d 0a20 2020 2020 2020 2020 2020 2028  (..            (
-000049a0: 5b73 656c 662e 4461 7461 5f73 6563 7469  [self.Data_secti
-000049b0: 6f6e 2e45 7068 7a2e 6c6f 635b 6e61 6d65  on.Ephz.loc[name
-000049c0: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
-000049d0: 2020 666f 7220 206e 616d 6520 696e 2020    for  name in  
-000049e0: 7374 6e4e 616d 6573 5d29 2c20 6178 6973  stnNames]), axis
-000049f0: 3d30 290d 0a20 2020 2020 2020 2062 6d61  =0)..        bma
-00004a00: 673d 6e70 2e63 6f6e 6361 7465 6e61 7465  g=np.concatenate
-00004a10: 280d 0a20 2020 2020 2020 2020 2020 2028  (..            (
-00004a20: 5b73 656c 662e 4461 7461 5f73 6563 7469  [self.Data_secti
-00004a30: 6f6e 2e48 6d61 672e 6c6f 635b 6e61 6d65  on.Hmag.loc[name
-00004a40: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
-00004a50: 2020 666f 7220 6e61 6d65 2069 6e20 2073    for name in  s
-00004a60: 746e 4e61 6d65 735d 292c 2061 7869 733d  tnNames]), axis=
-00004a70: 3029 0d0a 2020 2020 2020 2020 6270 687a  0)..        bphz
-00004a80: 3d6e 702e 636f 6e63 6174 656e 6174 6528  =np.concatenate(
-00004a90: 0d0a 2020 2020 2020 2020 2020 2020 285b  ..            ([
-00004aa0: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
-00004ab0: 6e2e 4870 687a 2e6c 6f63 5b6e 616d 655d  n.Hphz.loc[name]
+00003f30: 2027 7b3a 5e38 7d27 2c27 7b3a 5e31 327d   '{:^8}','{:^12}
+00003f40: 272c 277b 3a5e 397d 272c 0d0a 2020 2020  ','{:^9}',..    
+00003f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003f60: 2020 2020 2020 2020 2020 2020 2027 7b3a               '{:
+00003f70: 5e31 327d 272c 277b 3a5e 397d 272c 277b  ^12}','{:^9}','{
+00003f80: 3a5e 377d 272c 0d0a 2020 2020 2020 2020  :^7}',..        
+00003f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003fa0: 2020 2020 2020 2020 2027 7b3a 5e37 7d27           '{:^7}'
+00003fb0: 2c27 7b3a 5e37 7d27 2c27 7b3a 5e37 7d27  ,'{:^7}','{:^7}'
+00003fc0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00003fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003fe0: 2020 2020 277b 3a5e 377d 272c 277b 3a5e      '{:^7}','{:^
+00003ff0: 377d 275d 202c 2076 616c 7565 5f74 6f5f  7}'] , value_to_
+00004000: 666f 726d 6174 3d73 656c 662e 5f66 315f  format=self._f1_
+00004010: 6c61 6265 6c73 293a 0d0a 2020 2020 2020  labels):..      
+00004020: 2020 2020 2020 2222 2220 0d0a 2020 2020        """ ..    
+00004030: 2020 2020 2020 2020 4472 6177 6e20 666f          Drawn fo
+00004040: 726d 6174 6167 6520 6368 6169 6e20 2e20  rmatage chain . 
+00004050: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00004060: 2020 2020 2020 2020 2020 2020 3a70 6172              :par
+00004070: 616d 2066 6f72 6d61 745f 6c65 6e3a 206c  am format_len: l
+00004080: 6973 7420 6f66 2066 6f72 6d61 7461 6765  ist of formatage
+00004090: 2069 6e64 6963 6174 6f72 202c 2066 6c65   indicator , fle
+000040a0: 7869 626c 6520 2e0d 0a20 2020 2020 2020  xible ...       
+000040b0: 2020 2020 203a 7479 7065 2066 6f72 6d61       :type forma
+000040c0: 745f 6c65 6e3a 206c 6973 7420 0d0a 2020  t_len: list ..  
+000040d0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+000040e0: 2020 2020 2020 2020 3a70 6172 616d 2076          :param v
+000040f0: 616c 7565 2d74 6f2d 666f 726d 6174 3a20  alue-to-format: 
+00004100: 7468 6520 6c69 7374 206f 6620 6974 656d  the list of item
+00004110: 2077 6520 7761 6e74 2074 6f20 666f 726d   we want to form
+00004120: 6174 2e0d 0a20 2020 2020 2020 2020 2020  at...           
+00004130: 203a 7479 7065 2076 616c 7565 5f74 6f5f   :type value_to_
+00004140: 666f 726d 6174 3a20 6c69 7374 200d 0a20  format: list .. 
+00004150: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00004160: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
+00004170: 6e6f 7465 3a3a 2075 7365 7220 6361 6e20  note:: user can 
+00004180: 6368 616e 6765 2074 6865 2064 6973 706f  change the dispo
+00004190: 7361 6c20 6f66 2061 7667 5f6c 6162 656c  sal of avg_label
+000041a0: 732e 0d0a 2020 2020 0d0a 2020 2020 2020  s...    ..      
+000041b0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+000041c0: 2020 2020 2020 2066 6f72 2073 732c 2069         for ss, i
+000041d0: 7465 6d20 696e 2065 6e75 6d65 7261 7465  tem in enumerate
+000041e0: 2866 6f72 6d61 745f 6c65 6e29 3a0d 0a20  (format_len):.. 
+000041f0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00004200: 616c 7565 5f74 6f5f 666f 726d 6174 5b73  alue_to_format[s
+00004210: 735d 3d69 7465 6d2e 666f 726d 6174 2876  s]=item.format(v
+00004220: 616c 7565 5f74 6f5f 666f 726d 6174 5b73  alue_to_format[s
+00004230: 735d 290d 0a20 2020 2020 2020 2020 2020  s])..           
+00004240: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+00004250: 6574 7572 6e20 2727 2e6a 6f69 6e28 5b6e  eturn ''.join([n
+00004260: 6577 5f63 6172 6620 666f 7220 6e65 775f  ew_carf for new_
+00004270: 6361 7266 2069 6e20 7661 6c75 655f 746f  carf in value_to
+00004280: 5f66 6f72 6d61 745d 290d 0a20 2020 2020  _format])..     
+00004290: 2020 200d 0a20 2020 2020 2020 2077 7269     ..        wri
+000042a0: 7465 5f6c 696e 6573 2e61 7070 656e 6428  te_lines.append(
+000042b0: 6472 6177 5f66 6328 292b 275c 6e27 290d  draw_fc()+'\n').
+000042c0: 0a20 2020 2020 2020 2077 7269 7465 5f6c  .        write_l
+000042d0: 696e 6573 2e61 7070 656e 6428 275c 5c27  ines.append('\\'
+000042e0: 290d 0a20 2020 2020 2020 2077 7269 7465  )..        write
+000042f0: 5f6c 696e 6573 2e61 7070 656e 6428 272b  _lines.append('+
+00004300: 2b27 2e6a 6f69 6e28 5b69 6e74 2873 7329  +'.join([int(ss)
+00004310: 202a 2027 2d27 200d 0a20 2020 2020 2020   * '-' ..       
+00004320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004330: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00004340: 6f72 2073 7320 696e 205b 2731 272c 2735  or ss in ['1','5
+00004350: 272c 2735 272c 2735 272c 2734 272c 2731  ','5','5','4','1
+00004360: 3027 2c0d 0a20 2020 2020 2020 2020 2020  0',..           
+00004370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004390: 2020 2020 2027 3627 2c27 3130 272c 2737       '6','10','7
+000043a0: 272c 2731 3027 2c27 3727 2c27 3527 2c0d  ','10','7','5',.
+000043b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000043c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000043d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000043e0: 2027 3527 2c27 3527 2c27 3527 2c27 3527   '5','5','5','5'
+000043f0: 2c27 3527 5d20 5d29 2b27 2b5c 6e27 290d  ,'5'] ])+'+\n').
+00004400: 0a0d 0a20 2020 2020 2020 2023 2d2d 2d2d  ...        #----
+00004410: 2d2d 2d2d 2d2d 2d2d 7374 6172 7420 7772  --------start wr
+00004420: 6974 6520 626c 6f63 6b20 6461 7461 202d  ite block data -
+00004430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004440: 2d2d 0d0a 2020 2020 2020 2020 7374 6e4e  --..        stnN
+00004450: 616d 6573 203d 7365 6c66 2e44 6174 615f  ames =self.Data_
+00004460: 7365 6374 696f 6e2e 5374 6174 696f 6e2e  section.Station.
+00004470: 6e61 6d65 730d 0a0d 0a20 2020 2020 2020  names....       
+00004480: 2023 206e 6f74 2075 7365 6675 6c6c 202c   # not usefull ,
+00004490: 2077 6520 7265 706c 6163 6520 6e61 6e20   we replace nan 
+000044a0: 6174 2074 6865 2062 6f74 746f 6d20 2e0d  at the bottom ..
+000044b0: 0a20 2020 2020 2020 2064 6566 206e 616e  .        def nan
+000044c0: 5f74 6f5f 7a73 7461 7228 6e61 6e5f 6172  _to_zstar(nan_ar
+000044d0: 7261 792c 2073 7761 7065 723d 272a 2720  ray, swaper='*' 
+000044e0: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+000044f0: 2022 2222 0d0a 2020 2020 2020 2020 2020   """..          
+00004500: 2020 5377 6170 7020 6e70 2e6e 616e 206e    Swapp np.nan n
+00004510: 756d 6265 7220 6f6e 2074 6865 2064 6174  umber on the dat
+00004520: 6120 2e0d 0a20 2020 2020 2020 2020 2020  a ...           
+00004530: 2022 2222 0d0a 2020 2020 2020 2020 2020   """..          
+00004540: 2020 6e61 6e5f 6172 7261 793d 206e 702e    nan_array= np.
+00004550: 6e61 6e5f 746f 5f6e 756d 286e 616e 5f61  nan_to_num(nan_a
+00004560: 7272 6179 2c20 6e61 6e3d 2d39 3939 290d  rray, nan=-999).
+00004570: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00004580: 7572 6e20 6e70 2e77 6865 7265 286e 616e  urn np.where(nan
+00004590: 5f61 7272 6179 3d3d 2d39 3939 2c20 7377  _array==-999, sw
+000045a0: 6170 6572 2c20 6e61 6e5f 6172 7261 7929  aper, nan_array)
+000045b0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000045c0: 2020 2020 2020 2020 232d 2d62 7269 6e67          #--bring
+000045d0: 2062 6163 6b20 616c 6c20 6461 7461 202d   back all data -
+000045e0: 2d2d 2d0d 0a20 2020 2020 2020 2073 746e  ---..        stn
+000045f0: 3d6e 702e 636f 6e63 6174 656e 6174 6528  =np.concatenate(
+00004600: 0d0a 2020 2020 2020 2020 2020 2020 285b  ..            ([
+00004610: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
+00004620: 6e2e 5374 6174 696f 6e2e 6c6f 635b 6e61  n.Station.loc[na
+00004630: 6d65 5d20 0d0a 2020 2020 2020 2020 2020  me] ..          
+00004640: 2020 2020 666f 7220 206e 616d 6520 696e      for  name in
+00004650: 2020 7374 6e4e 616d 6573 5d29 2c20 6178    stnNames]), ax
+00004660: 6973 3d30 290d 0a20 2020 2020 2020 2066  is=0)..        f
+00004670: 7265 713d 6e70 2e63 6f6e 6361 7465 6e61  req=np.concatena
+00004680: 7465 280d 0a20 2020 2020 2020 2020 2020  te(..           
+00004690: 2028 5b73 656c 662e 4461 7461 5f73 6563   ([self.Data_sec
+000046a0: 7469 6f6e 2e46 7265 7175 656e 6379 2e6c  tion.Frequency.l
+000046b0: 6f63 5b6e 616d 655d 200d 0a20 2020 2020  oc[name] ..     
+000046c0: 2020 2020 2020 2020 2066 6f72 2020 6e61           for  na
+000046d0: 6d65 2069 6e20 2073 746e 4e61 6d65 735d  me in  stnNames]
+000046e0: 292c 2061 7869 733d 3029 0d0a 2020 2020  ), axis=0)..    
+000046f0: 2020 2020 616d 7073 3d6e 702e 636f 6e63      amps=np.conc
+00004700: 6174 656e 6174 6528 0d0a 2020 2020 2020  atenate(..      
+00004710: 2020 2020 2020 285b 7365 6c66 2e44 6174        ([self.Dat
+00004720: 615f 7365 6374 696f 6e2e 416d 7073 2e6c  a_section.Amps.l
+00004730: 6f63 5b6e 616d 655d 200d 0a20 2020 2020  oc[name] ..     
+00004740: 2020 2020 2020 2020 2066 6f72 206e 616d           for nam
+00004750: 6520 696e 2073 746e 4e61 6d65 735d 292c  e in stnNames]),
+00004760: 2061 7869 733d 3029 0d0a 2020 2020 2020   axis=0)..      
+00004770: 2020 656d 6167 3d6e 702e 636f 6e63 6174    emag=np.concat
+00004780: 656e 6174 6528 0d0a 2020 2020 2020 2020  enate(..        
+00004790: 2020 2020 285b 7365 6c66 2e44 6174 615f      ([self.Data_
+000047a0: 7365 6374 696f 6e2e 456d 6167 2e6c 6f63  section.Emag.loc
+000047b0: 5b6e 616d 655d 200d 0a20 2020 2020 2020  [name] ..       
+000047c0: 2020 2020 2020 2066 6f72 2020 6e61 6d65         for  name
+000047d0: 2069 6e20 2073 746e 4e61 6d65 735d 292c   in  stnNames]),
+000047e0: 2061 7869 733d 3029 0d0a 2020 2020 2020   axis=0)..      
+000047f0: 2020 6570 687a 3d6e 702e 636f 6e63 6174    ephz=np.concat
+00004800: 656e 6174 6528 0d0a 2020 2020 2020 2020  enate(..        
+00004810: 2020 2020 285b 7365 6c66 2e44 6174 615f      ([self.Data_
+00004820: 7365 6374 696f 6e2e 4570 687a 2e6c 6f63  section.Ephz.loc
+00004830: 5b6e 616d 655d 200d 0a20 2020 2020 2020  [name] ..       
+00004840: 2020 2020 2020 2066 6f72 2020 6e61 6d65         for  name
+00004850: 2069 6e20 2073 746e 4e61 6d65 735d 292c   in  stnNames]),
+00004860: 2061 7869 733d 3029 0d0a 2020 2020 2020   axis=0)..      
+00004870: 2020 626d 6167 3d6e 702e 636f 6e63 6174    bmag=np.concat
+00004880: 656e 6174 6528 0d0a 2020 2020 2020 2020  enate(..        
+00004890: 2020 2020 285b 7365 6c66 2e44 6174 615f      ([self.Data_
+000048a0: 7365 6374 696f 6e2e 486d 6167 2e6c 6f63  section.Hmag.loc
+000048b0: 5b6e 616d 655d 200d 0a20 2020 2020 2020  [name] ..       
+000048c0: 2020 2020 2020 2066 6f72 206e 616d 6520         for name 
+000048d0: 696e 2020 7374 6e4e 616d 6573 5d29 2c20  in  stnNames]), 
+000048e0: 6178 6973 3d30 290d 0a20 2020 2020 2020  axis=0)..       
+000048f0: 2062 7068 7a3d 6e70 2e63 6f6e 6361 7465   bphz=np.concate
+00004900: 6e61 7465 280d 0a20 2020 2020 2020 2020  nate(..         
+00004910: 2020 2028 5b73 656c 662e 4461 7461 5f73     ([self.Data_s
+00004920: 6563 7469 6f6e 2e48 7068 7a2e 6c6f 635b  ection.Hphz.loc[
+00004930: 6e61 6d65 5d20 0d0a 2020 2020 2020 2020  name] ..        
+00004940: 2020 2020 2020 666f 7220 206e 616d 6520        for  name 
+00004950: 696e 2020 7374 6e4e 616d 6573 5d29 2c20  in  stnNames]), 
+00004960: 6178 6973 3d30 290d 0a20 2020 2020 2020  axis=0)..       
+00004970: 2072 686f 3d6e 702e 636f 6e63 6174 656e   rho=np.concaten
+00004980: 6174 6528 0d0a 2020 2020 2020 2020 2020  ate(..          
+00004990: 2020 285b 7365 6c66 2e44 6174 615f 7365    ([self.Data_se
+000049a0: 6374 696f 6e2e 5265 7369 7374 6976 6974  ction.Resistivit
+000049b0: 792e 6c6f 635b 6e61 6d65 5d20 0d0a 2020  y.loc[name] ..  
+000049c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000049d0: 206e 616d 6520 696e 2020 7374 6e4e 616d   name in  stnNam
+000049e0: 6573 5d29 2c20 6178 6973 3d30 290d 0a20  es]), axis=0).. 
+000049f0: 2020 2020 2020 2070 6861 7365 3d6e 702e         phase=np.
+00004a00: 636f 6e63 6174 656e 6174 6528 0d0a 2020  concatenate(..  
+00004a10: 2020 2020 2020 2020 2020 285b 7365 6c66            ([self
+00004a20: 2e44 6174 615f 7365 6374 696f 6e2e 5068  .Data_section.Ph
+00004a30: 6173 652e 6c6f 635b 6e61 6d65 5d20 0d0a  ase.loc[name] ..
+00004a40: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00004a50: 7220 6e61 6d65 2069 6e20 2073 746e 4e61  r name in  stnNa
+00004a60: 6d65 735d 292c 2061 7869 733d 3029 0d0a  mes]), axis=0)..
+00004a70: 2020 2020 2020 2020 7063 656d 6167 3d6e          pcemag=n
+00004a80: 702e 636f 6e63 6174 656e 6174 6528 0d0a  p.concatenate(..
+00004a90: 2020 2020 2020 2020 2020 2020 285b 7365              ([se
+00004aa0: 6c66 2e44 6174 615f 7365 6374 696f 6e2e  lf.Data_section.
+00004ab0: 7063 456d 6167 2e6c 6f63 5b6e 616d 655d  pcEmag.loc[name]
 00004ac0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00004ad0: 2066 6f72 2020 6e61 6d65 2069 6e20 2073   for  name in  s
-00004ae0: 746e 4e61 6d65 735d 292c 2061 7869 733d  tnNames]), axis=
-00004af0: 3029 0d0a 2020 2020 2020 2020 7268 6f3d  0)..        rho=
+00004ad0: 2066 6f72 206e 616d 6520 696e 2073 746e   for name in stn
+00004ae0: 4e61 6d65 735d 292c 2061 7869 733d 3029  Names]), axis=0)
+00004af0: 0d0a 2020 2020 2020 2020 7365 7068 7a3d  ..        sephz=
 00004b00: 6e70 2e63 6f6e 6361 7465 6e61 7465 280d  np.concatenate(.
 00004b10: 0a20 2020 2020 2020 2020 2020 2028 5b73  .            ([s
 00004b20: 656c 662e 4461 7461 5f73 6563 7469 6f6e  elf.Data_section
-00004b30: 2e52 6573 6973 7469 7669 7479 2e6c 6f63  .Resistivity.loc
-00004b40: 5b6e 616d 655d 200d 0a20 2020 2020 2020  [name] ..       
-00004b50: 2020 2020 2020 2066 6f72 2020 6e61 6d65         for  name
-00004b60: 2069 6e20 2073 746e 4e61 6d65 735d 292c   in  stnNames]),
-00004b70: 2061 7869 733d 3029 0d0a 2020 2020 2020   axis=0)..      
-00004b80: 2020 7068 6173 653d 6e70 2e63 6f6e 6361    phase=np.conca
-00004b90: 7465 6e61 7465 280d 0a20 2020 2020 2020  tenate(..       
-00004ba0: 2020 2020 2028 5b73 656c 662e 4461 7461       ([self.Data
-00004bb0: 5f73 6563 7469 6f6e 2e50 6861 7365 2e6c  _section.Phase.l
-00004bc0: 6f63 5b6e 616d 655d 200d 0a20 2020 2020  oc[name] ..     
-00004bd0: 2020 2020 2020 2020 2066 6f72 206e 616d           for nam
-00004be0: 6520 696e 2020 7374 6e4e 616d 6573 5d29  e in  stnNames])
-00004bf0: 2c20 6178 6973 3d30 290d 0a20 2020 2020  , axis=0)..     
-00004c00: 2020 2070 6365 6d61 673d 6e70 2e63 6f6e     pcemag=np.con
-00004c10: 6361 7465 6e61 7465 280d 0a20 2020 2020  catenate(..     
-00004c20: 2020 2020 2020 2028 5b73 656c 662e 4461         ([self.Da
-00004c30: 7461 5f73 6563 7469 6f6e 2e70 6345 6d61  ta_section.pcEma
-00004c40: 672e 6c6f 635b 6e61 6d65 5d20 0d0a 2020  g.loc[name] ..  
-00004c50: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00004c60: 6e61 6d65 2069 6e20 7374 6e4e 616d 6573  name in stnNames
-00004c70: 5d29 2c20 6178 6973 3d30 290d 0a20 2020  ]), axis=0)..   
-00004c80: 2020 2020 2073 6570 687a 3d6e 702e 636f       sephz=np.co
-00004c90: 6e63 6174 656e 6174 6528 0d0a 2020 2020  ncatenate(..    
-00004ca0: 2020 2020 2020 2020 285b 7365 6c66 2e44          ([self.D
-00004cb0: 6174 615f 7365 6374 696f 6e2e 7345 7068  ata_section.sEph
-00004cc0: 7a2e 6c6f 635b 6e61 6d65 5d20 0d0a 2020  z.loc[name] ..  
-00004cd0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00004ce0: 6e61 6d65 2069 6e20 2073 746e 4e61 6d65  name in  stnName
-00004cf0: 735d 292c 2061 7869 733d 3029 0d0a 2020  s]), axis=0)..  
-00004d00: 2020 2020 2020 7063 686d 6167 3d6e 702e        pchmag=np.
-00004d10: 636f 6e63 6174 656e 6174 6528 0d0a 2020  concatenate(..  
-00004d20: 2020 2020 2020 2020 2020 285b 7365 6c66            ([self
-00004d30: 2e44 6174 615f 7365 6374 696f 6e2e 7063  .Data_section.pc
-00004d40: 486d 6167 2e6c 6f63 5b6e 616d 655d 200d  Hmag.loc[name] .
-00004d50: 0a20 2020 2020 2020 2020 2020 2020 2066  .              f
-00004d60: 6f72 2020 6e61 6d65 2069 6e20 2073 746e  or  name in  stn
-00004d70: 4e61 6d65 735d 292c 2061 7869 733d 3029  Names]), axis=0)
-00004d80: 0d0a 2020 2020 2020 2020 7368 7068 7a3d  ..        shphz=
-00004d90: 6e70 2e63 6f6e 6361 7465 6e61 7465 280d  np.concatenate(.
-00004da0: 0a20 2020 2020 2020 2020 2020 2028 5b73  .            ([s
-00004db0: 656c 662e 4461 7461 5f73 6563 7469 6f6e  elf.Data_section
-00004dc0: 2e73 4870 687a 2e6c 6f63 5b6e 616d 655d  .sHphz.loc[name]
-00004dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004de0: 666f 7220 6e61 6d65 2069 6e20 7374 6e4e  for name in stnN
-00004df0: 616d 6573 5d29 2c20 6178 6973 3d30 290d  ames]), axis=0).
-00004e00: 0a20 2020 2020 2020 2070 6372 686f 3d6e  .        pcrho=n
-00004e10: 702e 636f 6e63 6174 656e 6174 6528 0d0a  p.concatenate(..
-00004e20: 2020 2020 2020 2020 2020 2020 285b 7365              ([se
-00004e30: 6c66 2e44 6174 615f 7365 6374 696f 6e2e  lf.Data_section.
-00004e40: 7063 5268 6f2e 6c6f 635b 6e61 6d65 5d20  pcRho.loc[name] 
-00004e50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004e60: 666f 7220 206e 616d 6520 696e 2073 746e  for  name in stn
-00004e70: 4e61 6d65 735d 292c 2061 7869 733d 3029  Names]), axis=0)
-00004e80: 0d0a 2020 2020 2020 2020 7370 6861 7365  ..        sphase
-00004e90: 3d6e 702e 636f 6e63 6174 656e 6174 6528  =np.concatenate(
-00004ea0: 0d0a 2020 2020 2020 2020 2020 2020 285b  ..            ([
-00004eb0: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
-00004ec0: 6e2e 7350 687a 2e6c 6f63 5b6e 616d 655d  n.sPhz.loc[name]
-00004ed0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00004ee0: 2066 6f72 206e 616d 6520 696e 2020 7374   for name in  st
-00004ef0: 6e4e 616d 6573 5d29 2c20 6178 6973 3d30  nNames]), axis=0
-00004f00: 290d 0a0d 0a20 2020 2020 2020 2023 2062  )....        # b
-00004f10: 7569 6c64 2073 6b70 5f66 6c61 6720 2061  uild skp_flag  a
-00004f20: 6e64 2066 696c 6c20 6d65 6173 7572 6520  nd fill measure 
-00004f30: 636f 6d70 6f6e 656e 7420 7479 7065 202e  component type .
-00004f40: 2e2e 0d0a 2020 2020 2020 2020 736b 7066  ....        skpf
-00004f50: 203d 6e70 2e66 756c 6c28 2873 746e 2e73   =np.full((stn.s
-00004f60: 6861 7065 5b30 5d2c 292c 2073 656c 662e  hape[0],), self.
-00004f70: 536b 6970 5f66 6c61 672e 736b 6970 5f66  Skip_flag.skip_f
-00004f80: 6c61 6729 0d0a 2020 2020 2020 2020 0d0a  lag)..        ..
-00004f90: 2020 2020 2020 2020 636f 6d70 7320 3d6e          comps =n
-00004fa0: 702e 6675 6c6c 2828 7374 6e2e 7368 6170  p.full((stn.shap
-00004fb0: 655b 305d 2c29 2c73 656c 662e 4865 6164  e[0],),self.Head
-00004fc0: 6572 2e52 782e 7278 436f 6d70 7320 290d  er.Rx.rxComps ).
-00004fd0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00004fe0: 2020 2023 2d2d 2d2d 3e20 7772 6974 6520     #----> write 
-00004ff0: 6461 7461 206c 696e 6520 6279 206c 696e  data line by lin
-00005000: 6520 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  e ------..      
-00005010: 2020 666f 7220 6969 2069 6e20 7261 6e67    for ii in rang
-00005020: 6520 2873 6b70 662e 7368 6170 655b 305d  e (skpf.shape[0]
-00005030: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00005040: 7772 6974 655f 6c69 6e65 732e 6170 7065  write_lines.appe
-00005050: 6e64 2827 272e 6a6f 696e 285b 277b 303a  nd(''.join(['{0:
-00005060: 5e33 7d27 2e66 6f72 6d61 7428 736b 7066  ^3}'.format(skpf
-00005070: 5b69 695d 292c 0d0a 2020 2020 2020 2020  [ii]),..        
+00004b30: 2e73 4570 687a 2e6c 6f63 5b6e 616d 655d  .sEphz.loc[name]
+00004b40: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00004b50: 2066 6f72 206e 616d 6520 696e 2020 7374   for name in  st
+00004b60: 6e4e 616d 6573 5d29 2c20 6178 6973 3d30  nNames]), axis=0
+00004b70: 290d 0a20 2020 2020 2020 2070 6368 6d61  )..        pchma
+00004b80: 673d 6e70 2e63 6f6e 6361 7465 6e61 7465  g=np.concatenate
+00004b90: 280d 0a20 2020 2020 2020 2020 2020 2028  (..            (
+00004ba0: 5b73 656c 662e 4461 7461 5f73 6563 7469  [self.Data_secti
+00004bb0: 6f6e 2e70 6348 6d61 672e 6c6f 635b 6e61  on.pcHmag.loc[na
+00004bc0: 6d65 5d20 0d0a 2020 2020 2020 2020 2020  me] ..          
+00004bd0: 2020 2020 666f 7220 206e 616d 6520 696e      for  name in
+00004be0: 2020 7374 6e4e 616d 6573 5d29 2c20 6178    stnNames]), ax
+00004bf0: 6973 3d30 290d 0a20 2020 2020 2020 2073  is=0)..        s
+00004c00: 6870 687a 3d6e 702e 636f 6e63 6174 656e  hphz=np.concaten
+00004c10: 6174 6528 0d0a 2020 2020 2020 2020 2020  ate(..          
+00004c20: 2020 285b 7365 6c66 2e44 6174 615f 7365    ([self.Data_se
+00004c30: 6374 696f 6e2e 7348 7068 7a2e 6c6f 635b  ction.sHphz.loc[
+00004c40: 6e61 6d65 5d0d 0a20 2020 2020 2020 2020  name]..         
+00004c50: 2020 2020 2066 6f72 206e 616d 6520 696e       for name in
+00004c60: 2073 746e 4e61 6d65 735d 292c 2061 7869   stnNames]), axi
+00004c70: 733d 3029 0d0a 2020 2020 2020 2020 7063  s=0)..        pc
+00004c80: 7268 6f3d 6e70 2e63 6f6e 6361 7465 6e61  rho=np.concatena
+00004c90: 7465 280d 0a20 2020 2020 2020 2020 2020  te(..           
+00004ca0: 2028 5b73 656c 662e 4461 7461 5f73 6563   ([self.Data_sec
+00004cb0: 7469 6f6e 2e70 6352 686f 2e6c 6f63 5b6e  tion.pcRho.loc[n
+00004cc0: 616d 655d 200d 0a20 2020 2020 2020 2020  ame] ..         
+00004cd0: 2020 2020 2066 6f72 2020 6e61 6d65 2069       for  name i
+00004ce0: 6e20 7374 6e4e 616d 6573 5d29 2c20 6178  n stnNames]), ax
+00004cf0: 6973 3d30 290d 0a20 2020 2020 2020 2073  is=0)..        s
+00004d00: 7068 6173 653d 6e70 2e63 6f6e 6361 7465  phase=np.concate
+00004d10: 6e61 7465 280d 0a20 2020 2020 2020 2020  nate(..         
+00004d20: 2020 2028 5b73 656c 662e 4461 7461 5f73     ([self.Data_s
+00004d30: 6563 7469 6f6e 2e73 5068 7a2e 6c6f 635b  ection.sPhz.loc[
+00004d40: 6e61 6d65 5d20 0d0a 2020 2020 2020 2020  name] ..        
+00004d50: 2020 2020 2020 666f 7220 6e61 6d65 2069        for name i
+00004d60: 6e20 2073 746e 4e61 6d65 735d 292c 2061  n  stnNames]), a
+00004d70: 7869 733d 3029 0d0a 0d0a 2020 2020 2020  xis=0)....      
+00004d80: 2020 2320 6275 696c 6420 736b 705f 666c    # build skp_fl
+00004d90: 6167 2020 616e 6420 6669 6c6c 206d 6561  ag  and fill mea
+00004da0: 7375 7265 2063 6f6d 706f 6e65 6e74 2074  sure component t
+00004db0: 7970 6520 2e2e 2e0d 0a20 2020 2020 2020  ype .....       
+00004dc0: 2073 6b70 6620 3d6e 702e 6675 6c6c 2828   skpf =np.full((
+00004dd0: 7374 6e2e 7368 6170 655b 305d 2c29 2c20  stn.shape[0],), 
+00004de0: 7365 6c66 2e53 6b69 705f 666c 6167 2e73  self.Skip_flag.s
+00004df0: 6b69 705f 666c 6167 290d 0a20 2020 2020  kip_flag)..     
+00004e00: 2020 200d 0a20 2020 2020 2020 2063 6f6d     ..        com
+00004e10: 7073 203d 6e70 2e66 756c 6c28 2873 746e  ps =np.full((stn
+00004e20: 2e73 6861 7065 5b30 5d2c 292c 7365 6c66  .shape[0],),self
+00004e30: 2e48 6561 6465 722e 5278 2e72 7843 6f6d  .Header.Rx.rxCom
+00004e40: 7073 2029 0d0a 2020 2020 2020 2020 0d0a  ps )..        ..
+00004e50: 2020 2020 2020 2020 232d 2d2d 2d3e 2077          #----> w
+00004e60: 7269 7465 2064 6174 6120 6c69 6e65 2062  rite data line b
+00004e70: 7920 6c69 6e65 202d 2d2d 2d2d 2d0d 0a20  y line ------.. 
+00004e80: 2020 2020 2020 2066 6f72 2069 6920 696e         for ii in
+00004e90: 2072 616e 6765 2028 736b 7066 2e73 6861   range (skpf.sha
+00004ea0: 7065 5b30 5d29 3a0d 0a20 2020 2020 2020  pe[0]):..       
+00004eb0: 2020 2020 2077 7269 7465 5f6c 696e 6573       write_lines
+00004ec0: 2e61 7070 656e 6428 2727 2e6a 6f69 6e28  .append(''.join(
+00004ed0: 5b27 7b30 3a5e 337d 272e 666f 726d 6174  ['{0:^3}'.format
+00004ee0: 2873 6b70 665b 6969 5d29 2c0d 0a20 2020  (skpf[ii]),..   
+00004ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f10: 2020 2020 2020 2020 2020 2020 2027 7b30               '{0
+00004f20: 3a5e 377d 272e 666f 726d 6174 2828 7374  :^7}'.format((st
+00004f30: 6e5b 6969 5d29 292c 0d0a 2020 2020 2020  n[ii])),..      
+00004f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f60: 2020 2020 2020 2020 2020 277b 303a 3e37            '{0:>7
+00004f70: 7d27 2e66 6f72 6d61 7428 6672 6571 5b69  }'.format(freq[i
+00004f80: 695d 292c 200d 0a20 2020 2020 2020 2020  i]), ..         
+00004f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004fb0: 2020 2020 2020 2027 7b30 3a5e 377d 272e         '{0:^7}'.
+00004fc0: 666f 726d 6174 2863 6f6d 7073 5b69 695d  format(comps[ii]
+00004fd0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00004fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005000: 2020 2020 277b 303a 3c36 7d27 2e66 6f72      '{0:<6}'.for
+00005010: 6d61 7428 616d 7073 5b69 695d 292c 0d0a  mat(amps[ii]),..
+00005020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005050: 277b 3a31 322e 3465 7d27 2e66 6f72 6d61  '{:12.4e}'.forma
+00005060: 7428 656d 6167 5b69 695d 292c 0d0a 2020  t(emag[ii]),..  
+00005070: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050a0: 2020 2020 2020 2020 277b 303a 5e37 7d27          '{0:^7}'
-000050b0: 2e66 6f72 6d61 7428 2873 746e 5b69 695d  .format((stn[ii]
-000050c0: 2929 2c0d 0a20 2020 2020 2020 2020 2020  )),..           
+00005090: 2020 2020 2020 2020 2020 2020 2020 277b                '{
+000050a0: 3a3e 387d 272e 666f 726d 6174 2865 7068  :>8}'.format(eph
+000050b0: 7a5b 6969 5d29 2c0d 0a20 2020 2020 2020  z[ii]),..       
+000050c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000050d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050f0: 2020 2020 2027 7b30 3a3e 377d 272e 666f       '{0:>7}'.fo
-00005100: 726d 6174 2866 7265 715b 6969 5d29 2c20  rmat(freq[ii]), 
-00005110: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000050e0: 2020 2020 2020 2020 2027 7b3a 3132 2e34           '{:12.4
+000050f0: 657d 272e 666f 726d 6174 2862 6d61 675b  e}'.format(bmag[
+00005100: 6969 5d29 2c0d 0a20 2020 2020 2020 2020  ii]),..         
+00005110: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005140: 2020 277b 303a 5e37 7d27 2e66 6f72 6d61    '{0:^7}'.forma
-00005150: 7428 636f 6d70 735b 6969 5d29 2c0d 0a20  t(comps[ii]),.. 
+00005130: 2020 2020 2020 2027 7b3a 3e39 7d27 2e66         '{:>9}'.f
+00005140: 6f72 6d61 7428 6270 687a 5b69 695d 292c  ormat(bphz[ii]),
+00005150: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00005160: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005180: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00005190: 7b30 3a3c 367d 272e 666f 726d 6174 2861  {0:<6}'.format(a
-000051a0: 6d70 735b 6969 5d29 2c0d 0a20 2020 2020  mps[ii]),..     
+00005180: 2020 277b 3a31 322e 3465 7d27 2e66 6f72    '{:12.4e}'.for
+00005190: 6d61 7428 7268 6f5b 6969 5d29 2c0d 0a20  mat(rho[ii]),.. 
+000051a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000051b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051d0: 2020 2020 2020 2020 2020 2027 7b3a 3132             '{:12
-000051e0: 2e34 657d 272e 666f 726d 6174 2865 6d61  .4e}'.format(ema
-000051f0: 675b 6969 5d29 2c0d 0a20 2020 2020 2020  g[ii]),..       
+000051c0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000051d0: 7b3a 3e39 7d27 2e66 6f72 6d61 7428 7068  {:>9}'.format(ph
+000051e0: 6173 655b 6969 5d29 2c0d 0a20 2020 2020  ase[ii]),..     
+000051f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005220: 2020 2020 2020 2020 2027 7b3a 3e38 7d27           '{:>8}'
-00005230: 2e66 6f72 6d61 7428 6570 687a 5b69 695d  .format(ephz[ii]
-00005240: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00005210: 2020 2020 2020 2020 2020 2027 7b3a 3e37             '{:>7
+00005220: 7d27 2e66 6f72 6d61 7428 7063 656d 6167  }'.format(pcemag
+00005230: 5b69 695d 292c 0d0a 2020 2020 2020 2020  [ii]),..        
+00005240: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005270: 2020 2020 277b 3a31 322e 3465 7d27 2e66      '{:12.4e}'.f
-00005280: 6f72 6d61 7428 626d 6167 5b69 695d 292c  ormat(bmag[ii]),
-00005290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005260: 2020 2020 2020 2020 277b 3a3e 377d 272e          '{:>7}'.
+00005270: 666f 726d 6174 2873 6570 687a 5b69 695d  format(sephz[ii]
+00005280: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00005290: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000052a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052c0: 2020 277b 3a3e 397d 272e 666f 726d 6174    '{:>9}'.format
-000052d0: 2862 7068 7a5b 6969 5d29 2c0d 0a20 2020  (bphz[ii]),..   
+000052b0: 2020 2020 277b 3a3e 377d 272e 666f 726d      '{:>7}'.form
+000052c0: 6174 2870 6368 6d61 675b 6969 5d29 2c0d  at(pchmag[ii]),.
+000052d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000052e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000052f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005300: 2020 2020 2020 2020 2020 2020 2027 7b3a               '{:
-00005310: 3132 2e34 657d 272e 666f 726d 6174 2872  12.4e}'.format(r
-00005320: 686f 5b69 695d 292c 0d0a 2020 2020 2020  ho[ii]),..      
+00005300: 2027 7b3a 3e37 7d27 2e66 6f72 6d61 7428   '{:>7}'.format(
+00005310: 7368 7068 7a5b 6969 5d29 2c0d 0a20 2020  shphz[ii]),..   
+00005320: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005350: 2020 2020 2020 2020 2020 277b 3a3e 397d            '{:>9}
-00005360: 272e 666f 726d 6174 2870 6861 7365 5b69  '.format(phase[i
-00005370: 695d 292c 0d0a 2020 2020 2020 2020 2020  i]),..          
+00005340: 2020 2020 2020 2020 2020 2020 2027 7b3a               '{:
+00005350: 3e37 7d27 2e66 6f72 6d61 7428 7063 7268  >7}'.format(pcrh
+00005360: 6f5b 6969 5d29 2c0d 0a20 2020 2020 2020  o[ii]),..       
+00005370: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000053a0: 2020 2020 2020 277b 3a3e 377d 272e 666f        '{:>7}'.fo
-000053b0: 726d 6174 2870 6365 6d61 675b 6969 5d29  rmat(pcemag[ii])
-000053c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000053d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000053e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000053f0: 2020 2027 7b3a 3e37 7d27 2e66 6f72 6d61     '{:>7}'.forma
-00005400: 7428 7365 7068 7a5b 6969 5d29 2c0d 0a20  t(sephz[ii]),.. 
-00005410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005430: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00005440: 7b3a 3e37 7d27 2e66 6f72 6d61 7428 7063  {:>7}'.format(pc
-00005450: 686d 6167 5b69 695d 292c 0d0a 2020 2020  hmag[ii]),..    
-00005460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005480: 2020 2020 2020 2020 2020 2020 277b 3a3e              '{:>
-00005490: 377d 272e 666f 726d 6174 2873 6870 687a  7}'.format(shphz
-000054a0: 5b69 695d 292c 0d0a 2020 2020 2020 2020  [ii]),..        
-000054b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054d0: 2020 2020 2020 2020 277b 3a3e 377d 272e          '{:>7}'.
-000054e0: 666f 726d 6174 2870 6372 686f 5b69 695d  format(pcrho[ii]
-000054f0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00005500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005520: 2020 2020 277b 3a3e 377d 272e 666f 726d      '{:>7}'.form
-00005530: 6174 2873 7068 6173 655b 6969 5d29 5d29  at(sphase[ii])])
-00005540: 290d 0a20 2020 2020 2020 2020 2020 2077  )..            w
-00005550: 7269 7465 5f6c 696e 6573 2e61 7070 656e  rite_lines.appen
-00005560: 6428 275c 6e27 290d 0a20 2020 2020 2020  d('\n')..       
-00005570: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-00005580: 2d2d 2d2d 2072 6570 6c61 6365 206e 702e  ---- replace np.
-00005590: 6e61 6e20 6e75 6d62 6572 2062 7920 7a6f  nan number by zo
-000055a0: 6e67 6520 7374 6172 2077 686f 206d 6561  nge star who mea
-000055b0: 6e20 6e6f 2076 616c 7565 202d 2d2d 2d0d  n no value ----.
-000055c0: 0a20 2020 2020 2020 2066 6f72 206a 6a2c  .        for jj,
-000055d0: 206c 696e 6573 2069 6e20 656e 756d 6572   lines in enumer
-000055e0: 6174 6528 7772 6974 655f 6c69 6e65 7320  ate(write_lines 
-000055f0: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
-00005600: 2069 6620 276e 616e 2720 696e 206c 696e   if 'nan' in lin
-00005610: 6573 203a 206c 696e 6573 203d 6c69 6e65  es : lines =line
-00005620: 732e 7265 706c 6163 6528 276e 616e 272c  s.replace('nan',
-00005630: 277b 3a3e 337d 272e 666f 726d 6174 2827  '{:>3}'.format('
-00005640: 2a27 2929 0d0a 2020 2020 2020 2020 2020  *'))..          
-00005650: 2020 7772 6974 655f 6c69 6e65 735b 6a6a    write_lines[jj
-00005660: 5d3d 6c69 6e65 730d 0a20 2020 2020 2020  ]=lines..       
-00005670: 2023 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   #--------------
-00005680: 2d2d 2d2d 2d2d 2d65 6e64 206e 616e 2072  -------end nan r
-00005690: 6570 6c61 6369 6e67 202d 2d2d 2d2d 2d2d  eplacing -------
-000056a0: 2d2d 2d2d 2d2d 2d2d 2d20 2020 2020 2020  ---------       
-000056b0: 200d 0a20 2020 2020 2020 2077 6974 6820   ..        with 
-000056c0: 6f70 656e 2827 272e 6a6f 696e 285b 6f73  open(''.join([os
-000056d0: 2e70 6174 682e 6261 7365 6e61 6d65 2873  .path.basename(s
-000056e0: 656c 662e 6461 7461 5f66 6e29 5b3a 2d34  elf.data_fn)[:-4
-000056f0: 5d2c 275f 325f 746f 5f31 2e61 7667 275d  ],'_2_to_1.avg']
-00005700: 292c 200d 0a20 2020 2020 2020 2020 2020  ), ..           
-00005710: 2020 2020 2020 2027 7727 2c20 656e 636f         'w', enco
-00005720: 6469 6e67 3d27 7574 6638 2729 2061 7320  ding='utf8') as 
-00005730: 6677 3a0d 0a20 2020 2020 2020 2020 2020  fw:..           
-00005740: 2066 772e 7772 6974 656c 696e 6573 2028   fw.writelines (
-00005750: 7772 6974 655f 6c69 6e65 7329 0d0a 2020  write_lines)..  
-00005760: 2020 2020 2020 232d 2d2d 6d6f 7665 2074        #---move t
-00005770: 6f20 796f 7572 2073 6176 6570 6174 682d  o your savepath-
-00005780: 2d2d 0d0a 2020 2020 2020 2020 6966 2073  --..        if s
-00005790: 6176 6570 6174 6820 6973 206e 6f74 204e  avepath is not N
-000057a0: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
-000057b0: 2020 2020 7368 7574 696c 2e6d 6f76 6528      shutil.move(
-000057c0: 2727 2e6a 6f69 6e28 5b6f 732e 7061 7468  ''.join([os.path
-000057d0: 2e62 6173 656e 616d 6528 0d0a 2020 2020  .basename(..    
-000057e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000057f0: 2e64 6174 615f 666e 295b 3a2d 345d 2c27  .data_fn)[:-4],'
-00005800: 5f32 5f74 6f5f 312e 6176 6727 5d29 2c0d  _2_to_1.avg']),.
-00005810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005820: 2020 2020 2020 2020 2073 6176 6570 6174           savepat
-00005830: 6829 0d0a 2020 2020 2020 2020 7072 696e  h)..        prin
-00005840: 7428 272d 2d2d 3e20 2059 6f75 7220 3c7b  t('--->  Your <{
-00005850: 307d 3e20 6973 2072 6577 7269 7474 656e  0}> is rewritten
-00005860: 2074 6f20 3c7b 317d 3e20 7375 6363 6573   to <{1}> succes
-00005870: 7366 756c 6c79 2e20 3c2d 2d2d 2d2d 272e  sfully. <-----'.
-00005880: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
-00005890: 2066 6f72 6d61 7428 6f73 2e70 6174 682e   format(os.path.
-000058a0: 6261 7365 6e61 6d65 2873 656c 662e 6461  basename(self.da
-000058b0: 7461 5f66 6e29 2c20 0d0a 2020 2020 2020  ta_fn), ..      
-000058c0: 2020 2020 2020 2020 2020 2020 2027 272e               ''.
-000058d0: 6a6f 696e 285b 6f73 2e70 6174 682e 6261  join([os.path.ba
-000058e0: 7365 6e61 6d65 280d 0a20 2020 2020 2020  sename(..       
-000058f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005900: 7365 6c66 2e64 6174 615f 666e 295b 3a2d  self.data_fn)[:-
-00005910: 345d 2c27 5f32 5f74 6f5f 312e 6176 6727  4],'_2_to_1.avg'
-00005920: 5d29 2929 0d0a 2020 2020 2020 2020 2020  ])))..          
-00005930: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
-00005940: 6176 675f 746f 5f6a 6669 6c65 2028 7365  avg_to_jfile (se
-00005950: 6c66 2c20 6176 675f 6461 7461 5f66 6e3d  lf, avg_data_fn=
-00005960: 4e6f 6e65 202c 2070 726f 6669 6c65 5f66  None , profile_f
-00005970: 6e20 3d4e 6f6e 652c 2020 0d0a 2020 2020  n =None,  ..    
-00005980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005990: 2020 6a5f 6578 7465 6e73 696f 6e3d 2764    j_extension='d
-000059a0: 6174 272c 2075 746d 5f7a 6f6e 653d 2734  at', utm_zone='4
-000059b0: 394e 272c 2a2a 6b77 7329 3a0d 0a20 2020  9N',**kws):..   
-000059c0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000059d0: 2020 4d65 7468 6f64 2074 6f20 7772 6974    Method to writ
-000059e0: 6520 6176 6720 6669 6c65 2074 6f20 4a66  e avg file to Jf
-000059f0: 696c 652c 2063 6f6e 7665 7274 2062 6f74  ile, convert bot
-00005a00: 6820 6669 6c65 7320 2c20 0d0a 2020 2020  h files , ..    
-00005a10: 2020 2020 2041 7374 6174 6963 206f 7220       Astatic or 
-00005a20: 706c 6169 6e74 7920 6176 6720 6669 6c65  plainty avg file
-00005a30: 2074 6f20 412e 472e 204a 6f6e 6573 2066   to A.G. Jones f
-00005a40: 6f72 6d61 742e 0d0a 2020 2020 2020 2020  ormat...        
-00005a50: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00005a60: 7465 7273 200d 0a20 2020 2020 2020 202d  ters ..        -
-00005a70: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00005a80: 2020 2020 2020 2020 2a20 6176 675f 6461          * avg_da
-00005a90: 7461 5f66 6e3a 7374 7220 0d0a 2020 2020  ta_fn:str ..    
-00005aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ab0: 2020 2020 7061 7468 4c69 6b65 202c 2070      pathLike , p
-00005ac0: 6174 6820 746f 2079 6f75 7220 6176 6720  ath to your avg 
-00005ad0: 6669 6c65 200d 0a20 2020 2020 2020 2020  file ..         
-00005ae0: 2020 202a 2070 726f 6669 6c65 5f66 6e3a     * profile_fn:
-00005af0: 2020 7374 720d 0a20 2020 2020 2020 2020    str..         
-00005b00: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00005b10: 6174 684c 696b 652c 2070 6174 6820 746f  athLike, path to
-00005b20: 2079 6f75 7220 7072 6f66 696c 652f 7374   your profile/st
-00005b30: 6174 696f 6e20 6669 6c65 202e 0d0a 2020  ation file ...  
-00005b40: 2020 2020 2020 2020 2020 2a20 6a5f 6578            * j_ex
-00005b50: 7465 6e73 696f 6e3a 2073 7472 0d0a 2020  tension: str..  
+00005390: 2020 2020 2020 2020 2027 7b3a 3e37 7d27           '{:>7}'
+000053a0: 2e66 6f72 6d61 7428 7370 6861 7365 5b69  .format(sphase[i
+000053b0: 695d 295d 2929 0d0a 2020 2020 2020 2020  i])]))..        
+000053c0: 2020 2020 7772 6974 655f 6c69 6e65 732e      write_lines.
+000053d0: 6170 7065 6e64 2827 5c6e 2729 0d0a 2020  append('\n')..  
+000053e0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+000053f0: 2020 2020 232d 2d2d 2d20 7265 706c 6163      #---- replac
+00005400: 6520 6e70 2e6e 616e 206e 756d 6265 7220  e np.nan number 
+00005410: 6279 207a 6f6e 6765 2073 7461 7220 7768  by zonge star wh
+00005420: 6f20 6d65 616e 206e 6f20 7661 6c75 6520  o mean no value 
+00005430: 2d2d 2d2d 0d0a 2020 2020 2020 2020 666f  ----..        fo
+00005440: 7220 6a6a 2c20 6c69 6e65 7320 696e 2065  r jj, lines in e
+00005450: 6e75 6d65 7261 7465 2877 7269 7465 5f6c  numerate(write_l
+00005460: 696e 6573 2029 3a20 0d0a 2020 2020 2020  ines ): ..      
+00005470: 2020 2020 2020 6966 2027 6e61 6e27 2069        if 'nan' i
+00005480: 6e20 6c69 6e65 7320 3a20 6c69 6e65 7320  n lines : lines 
+00005490: 3d6c 696e 6573 2e72 6570 6c61 6365 2827  =lines.replace('
+000054a0: 6e61 6e27 2c27 7b3a 3e33 7d27 2e66 6f72  nan','{:>3}'.for
+000054b0: 6d61 7428 272a 2729 290d 0a20 2020 2020  mat('*'))..     
+000054c0: 2020 2020 2020 2077 7269 7465 5f6c 696e         write_lin
+000054d0: 6573 5b6a 6a5d 3d6c 696e 6573 0d0a 2020  es[jj]=lines..  
+000054e0: 2020 2020 2020 232d 2d2d 2d2d 2d2d 2d2d        #---------
+000054f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 656e 6420  ------------end 
+00005500: 6e61 6e20 7265 706c 6163 696e 6720 2d2d  nan replacing --
+00005510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2020  --------------  
+00005520: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00005530: 7769 7468 206f 7065 6e28 2727 2e6a 6f69  with open(''.joi
+00005540: 6e28 5b6f 732e 7061 7468 2e62 6173 656e  n([os.path.basen
+00005550: 616d 6528 7365 6c66 2e64 6174 615f 666e  ame(self.data_fn
+00005560: 295b 3a2d 345d 2c27 5f32 5f74 6f5f 312e  )[:-4],'_2_to_1.
+00005570: 6176 6727 5d29 2c20 0d0a 2020 2020 2020  avg']), ..      
+00005580: 2020 2020 2020 2020 2020 2020 2777 272c              'w',
+00005590: 2065 6e63 6f64 696e 673d 2775 7466 3827   encoding='utf8'
+000055a0: 2920 6173 2066 773a 0d0a 2020 2020 2020  ) as fw:..      
+000055b0: 2020 2020 2020 6677 2e77 7269 7465 6c69        fw.writeli
+000055c0: 6e65 7320 2877 7269 7465 5f6c 696e 6573  nes (write_lines
+000055d0: 290d 0a20 2020 2020 2020 2023 2d2d 2d6d  )..        #---m
+000055e0: 6f76 6520 746f 2079 6f75 7220 7361 7665  ove to your save
+000055f0: 7061 7468 2d2d 2d0d 0a20 2020 2020 2020  path---..       
+00005600: 2069 6620 7361 7665 7061 7468 2069 7320   if savepath is 
+00005610: 6e6f 7420 4e6f 6e65 203a 200d 0a20 2020  not None : ..   
+00005620: 2020 2020 2020 2020 2073 6875 7469 6c2e           shutil.
+00005630: 6d6f 7665 2827 272e 6a6f 696e 285b 6f73  move(''.join([os
+00005640: 2e70 6174 682e 6261 7365 6e61 6d65 280d  .path.basename(.
+00005650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005660: 2073 656c 662e 6461 7461 5f66 6e29 5b3a   self.data_fn)[:
+00005670: 2d34 5d2c 275f 325f 746f 5f31 2e61 7667  -4],'_2_to_1.avg
+00005680: 275d 292c 0d0a 2020 2020 2020 2020 2020  ']),..          
+00005690: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+000056a0: 7665 7061 7468 290d 0a20 2020 2020 2020  vepath)..       
+000056b0: 2070 7269 6e74 2827 2d2d 2d3e 2020 596f   print('--->  Yo
+000056c0: 7572 203c 7b30 7d3e 2069 7320 7265 7772  ur <{0}> is rewr
+000056d0: 6974 7465 6e20 746f 203c 7b31 7d3e 2073  itten to <{1}> s
+000056e0: 7563 6365 7373 6675 6c6c 792e 203c 2d2d  uccessfully. <--
+000056f0: 2d2d 2d27 2e5c 0d0a 2020 2020 2020 2020  ---'.\..        
+00005700: 2020 2020 2020 666f 726d 6174 286f 732e        format(os.
+00005710: 7061 7468 2e62 6173 656e 616d 6528 7365  path.basename(se
+00005720: 6c66 2e64 6174 615f 666e 292c 200d 0a20  lf.data_fn), .. 
+00005730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005740: 2020 2727 2e6a 6f69 6e28 5b6f 732e 7061    ''.join([os.pa
+00005750: 7468 2e62 6173 656e 616d 6528 0d0a 2020  th.basename(..  
+00005760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005770: 2020 2020 2073 656c 662e 6461 7461 5f66       self.data_f
+00005780: 6e29 5b3a 2d34 5d2c 275f 325f 746f 5f31  n)[:-4],'_2_to_1
+00005790: 2e61 7667 275d 2929 290d 0a20 2020 2020  .avg'])))..     
+000057a0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+000057b0: 2064 6566 2061 7667 5f74 6f5f 6a66 696c   def avg_to_jfil
+000057c0: 6520 2873 656c 662c 2061 7667 5f64 6174  e (self, avg_dat
+000057d0: 615f 666e 3d4e 6f6e 6520 2c20 7072 6f66  a_fn=None , prof
+000057e0: 696c 655f 666e 203d 4e6f 6e65 2c20 200d  ile_fn =None,  .
+000057f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005800: 2020 2020 2020 206a 5f65 7874 656e 7369         j_extensi
+00005810: 6f6e 3d27 6461 7427 2c20 7574 6d5f 7a6f  on='dat', utm_zo
+00005820: 6e65 3d27 3439 4e27 2c2a 2a6b 7773 293a  ne='49N',**kws):
+00005830: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00005840: 2020 2020 2020 204d 6574 686f 6420 746f         Method to
+00005850: 2077 7269 7465 2061 7667 2066 696c 6520   write avg file 
+00005860: 746f 204a 6669 6c65 2c20 636f 6e76 6572  to Jfile, conver
+00005870: 7420 626f 7468 2066 696c 6573 202c 200d  t both files , .
+00005880: 0a20 2020 2020 2020 2020 4173 7461 7469  .         Astati
+00005890: 6320 6f72 2070 6c61 696e 7479 2061 7667  c or plainty avg
+000058a0: 2066 696c 6520 746f 2041 2e47 2e20 4a6f   file to A.G. Jo
+000058b0: 6e65 7320 666f 726d 6174 2e0d 0a20 2020  nes format...   
+000058c0: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
+000058d0: 6172 616d 6574 6572 7320 0d0a 2020 2020  arameters ..    
+000058e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d      -----------.
+000058f0: 0a20 2020 2020 2020 2020 2020 202a 2061  .            * a
+00005900: 7667 5f64 6174 615f 666e 3a73 7472 200d  vg_data_fn:str .
+00005910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005920: 2020 2020 2020 2020 2070 6174 684c 696b           pathLik
+00005930: 6520 2c20 7061 7468 2074 6f20 796f 7572  e , path to your
+00005940: 2061 7667 2066 696c 6520 0d0a 2020 2020   avg file ..    
+00005950: 2020 2020 2020 2020 2a20 7072 6f66 696c          * profil
+00005960: 655f 666e 3a20 2073 7472 0d0a 2020 2020  e_fn:  str..    
+00005970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005980: 2020 2020 7061 7468 4c69 6b65 2c20 7061      pathLike, pa
+00005990: 7468 2074 6f20 796f 7572 2070 726f 6669  th to your profi
+000059a0: 6c65 2f73 7461 7469 6f6e 2066 696c 6520  le/station file 
+000059b0: 2e0d 0a20 2020 2020 2020 2020 2020 202a  ...            *
+000059c0: 206a 5f65 7874 656e 7369 6f6e 3a20 7374   j_extension: st
+000059d0: 720d 0a20 2020 2020 2020 2020 2020 2020  r..             
+000059e0: 2020 2020 2020 2020 2020 2045 7874 656e             Exten
+000059f0: 7369 6f6e 2074 7970 6520 796f 7520 7761  sion type you wa
+00005a00: 6e74 2074 6f20 6578 706f 7274 2066 696c  nt to export fil
+00005a10: 6520 2e0d 0a20 2020 2020 2020 2020 2020  e ...           
+00005a20: 2020 2020 2020 2020 2020 2020 202a 4465               *De
+00005a30: 6661 756c 742a 2069 7320 222e 6461 7422  fault* is ".dat"
+00005a40: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+00005a50: 7574 6d5f 7a6f 6e65 3a20 7374 720d 0a20  utm_zone: str.. 
+00005a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a70: 2020 2020 2020 2061 6464 2020 6966 2073         add  if s
+00005a80: 7461 7469 6f6e 5f70 726f 6669 6c65 2061  tation_profile a
+00005a90: 7265 206e 6f74 2072 6566 6572 656e 6365  re not reference
+00005aa0: 6420 7965 742e 0d0a 2020 2020 2020 2020  d yet...        
+00005ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ac0: 6c61 7465 7220 2c20 6974 2077 6f75 6c64  later , it would
+00005ad0: 2062 6520 7265 6d6f 7665 6420 2e0d 0a20   be removed ... 
+00005ae0: 2020 2020 2020 2020 2020 202a 2073 6176             * sav
+00005af0: 6570 6174 683a 2073 7472 0d0a 2020 2020  epath: str..    
+00005b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b10: 7061 7468 4c69 6b65 202c 2070 6174 6820  pathLike , path 
+00005b20: 746f 2073 6176 6520 796f 7572 206f 7574  to save your out
+00005b30: 7075 6669 6c65 200d 0a20 2020 2020 2020  pufile ..       
+00005b40: 2020 2020 202a 2077 7269 7465 5f69 6e66       * write_inf
+00005b50: 6f3a 2062 6f6f 6c0d 0a20 2020 2020 2020  o: bool..       
 00005b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b70: 2020 2020 2020 4578 7465 6e73 696f 6e20        Extension 
-00005b80: 7479 7065 2079 6f75 2077 616e 7420 746f  type you want to
-00005b90: 2065 7870 6f72 7420 6669 6c65 202e 0d0a   export file ...
+00005b70: 2077 7269 7465 2074 6865 2069 6e66 6f72   write the infor
+00005b80: 6d61 7469 6f6e 7320 6f66 2079 6f75 7220  mations of your 
+00005b90: 696e 7075 7420 6669 6c65 202c 2020 0d0a  input file ,  ..
 00005ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005bb0: 2020 2020 2020 2020 2a44 6566 6175 6c74          *Default
-00005bc0: 2a20 6973 2022 2e64 6174 220d 0a20 2020  * is ".dat"..   
-00005bd0: 2020 2020 2020 2020 202a 2075 746d 5f7a           * utm_z
-00005be0: 6f6e 653a 2073 7472 0d0a 2020 2020 2020  one: str..      
-00005bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c00: 2020 6164 6420 2069 6620 7374 6174 696f    add  if statio
-00005c10: 6e5f 7072 6f66 696c 6520 6172 6520 6e6f  n_profile are no
-00005c20: 7420 7265 6665 7265 6e63 6564 2079 6574  t referenced yet
-00005c30: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00005c40: 2020 2020 2020 2020 2020 206c 6174 6572             later
-00005c50: 202c 2069 7420 776f 756c 6420 6265 2072   , it would be r
-00005c60: 656d 6f76 6564 202e 0d0a 2020 2020 2020  emoved ...      
-00005c70: 2020 2020 2020 2a20 7361 7665 7061 7468        * savepath
-00005c80: 3a20 7374 720d 0a20 2020 2020 2020 2020  : str..         
-00005c90: 2020 2020 2020 2020 2020 2070 6174 684c             pathL
-00005ca0: 696b 6520 2c20 7061 7468 2074 6f20 7361  ike , path to sa
-00005cb0: 7665 2079 6f75 7220 6f75 7470 7566 696c  ve your outpufil
-00005cc0: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-00005cd0: 2a20 7772 6974 655f 696e 666f 3a20 626f  * write_info: bo
-00005ce0: 6f6c 0d0a 2020 2020 2020 2020 2020 2020  ol..            
-00005cf0: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-00005d00: 6520 7468 6520 696e 666f 726d 6174 696f  e the informatio
-00005d10: 6e73 206f 6620 796f 7572 2069 6e70 7574  ns of your input
-00005d20: 2066 696c 6520 2c20 200d 0a20 2020 2020   file ,  ..     
-00005d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d40: 2020 2065 7870 6f72 7420 696e 666f 726d     export inform
-00005d50: 6174 696f 6e73 2069 6e74 6f20 4a66 696c  ations into Jfil
-00005d60: 652c 2a44 6566 6175 6c74 2a20 6973 2046  e,*Default* is F
-00005d70: 616c 7365 2e0d 0a20 2020 2020 2020 2020  alse...         
-00005d80: 2020 202a 2073 7572 7665 795f 6e61 6d65     * survey_name
-00005d90: 3a20 2020 626f 6f6c 2c20 0d0a 2020 2020  :   bool, ..    
-00005da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005db0: 2020 2020 7375 7276 6579 5f61 7265 6120      survey_area 
-00005dc0: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
-00005dd0: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-00005de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005e00: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00005e10: 2020 2066 726f 6d20 7079 6373 616d 742e     from pycsamt.
-00005e20: 6666 2e63 6f72 652e 6a20 696d 706f 7274  ff.core.j import
-00005e30: 204a 5f63 6f6c 6c65 6374 696f 6e20 0d0a   J_collection ..
-00005e40: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-00005e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005e70: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00005e80: 2020 2020 0d0a 2020 2020 2020 2020 7361      ..        sa
-00005e90: 7665 7061 7468 203d 6b77 732e 706f 7028  vepath =kws.pop(
-00005ea0: 2773 6176 6570 6174 6827 2c20 4e6f 6e65  'savepath', None
-00005eb0: 290d 0a20 2020 2020 2020 2077 7269 7465  )..        write
-00005ec0: 5f69 6e66 6f20 3d6b 7773 2e70 6f70 2827  _info =kws.pop('
-00005ed0: 7772 6974 6549 6e66 6f73 272c 2046 616c  writeInfos', Fal
-00005ee0: 7365 290d 0a20 2020 2020 2020 2073 7572  se)..        sur
-00005ef0: 7665 795f 6e61 6d65 203d 6b77 732e 706f  vey_name =kws.po
-00005f00: 7028 2773 7572 7665 795f 6e61 6d65 272c  p('survey_name',
-00005f10: 204e 6f6e 6529 0d0a 2020 2020 0d0a 2020   None)..    ..  
-00005f20: 2020 2020 2020 6966 206a 5f65 7874 656e        if j_exten
-00005f30: 7369 6f6e 2069 7320 6e6f 7420 4e6f 6e65  sion is not None
-00005f40: 2061 6e64 2027 2e27 206e 6f74 2069 6e20   and '.' not in 
-00005f50: 6a5f 6578 7465 6e73 696f 6e3a 0d0a 2020  j_extension:..  
-00005f60: 2020 2020 2020 2020 2020 6a5f 6578 7465            j_exte
-00005f70: 6e73 696f 6e20 3d27 2e27 2b6a 5f65 7874  nsion ='.'+j_ext
-00005f80: 656e 7369 6f6e 0d0a 2020 2020 2020 2020  ension..        
-00005f90: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00005fa0: 2020 2020 7365 6c66 2e5f 6c6f 6767 696e      self._loggin
-00005fb0: 672e 696e 666f 2827 7772 6974 6520 4a66  g.info('write Jf
-00005fc0: 6f72 6d61 7420 6669 6c65 2729 0d0a 2020  ormat file')..  
-00005fd0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00005fe0: 6966 2061 7667 5f64 6174 615f 666e 2069  if avg_data_fn i
-00005ff0: 7320 6e6f 7420 4e6f 6e65 203a 2073 656c  s not None : sel
-00006000: 662e 6461 7461 5f66 6e20 3d20 6176 675f  f.data_fn = avg_
-00006010: 6461 7461 5f66 6e20 0d0a 2020 2020 2020  data_fn ..      
-00006020: 2020 6966 2073 656c 662e 6461 7461 5f66    if self.data_f
-00006030: 6e20 6973 204e 6f6e 6520 3a0d 0a20 2020  n is None :..   
-00006040: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
-00006050: 5365 782e 7079 4353 414d 5445 7272 6f72  Sex.pyCSAMTError
-00006060: 5f61 7667 5f66 696c 6528 0d0a 2020 2020  _avg_file(..    
-00006070: 2020 2020 2020 2020 2020 2020 2243 6f75              "Cou
-00006080: 6c64 206e 6f74 2066 696e 6420 616e 7920  ld not find any 
-00006090: 7061 7468 2074 6f20 7265 6164 202e 220d  path to read .".
-000060a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000060b0: 2020 2250 6c65 6173 6520 7072 6f76 6964    "Please provid
-000060c0: 6520 796f 7572 2072 6967 6874 2041 5647  e your right AVG
-000060d0: 2066 696c 652e 2229 0d0a 2020 2020 2020   file.")..      
-000060e0: 2020 0d0a 2020 2020 2020 2020 6966 2070    ..        if p
-000060f0: 726f 6669 6c65 5f66 6e20 6973 206e 6f74  rofile_fn is not
-00006100: 204e 6f6e 6520 3a20 7365 6c66 2e70 726f   None : self.pro
-00006110: 6669 6c65 5f66 6e20 3d20 7072 6f66 696c  file_fn = profil
-00006120: 655f 666e 200d 0a20 2020 2020 2020 200d  e_fn ..        .
-00006130: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00006140: 2e70 726f 6669 6c65 5f66 6e20 6973 2020  .profile_fn is  
-00006150: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
-00006160: 2020 2020 7261 6973 6520 4353 6578 2e70      raise CSex.p
-00006170: 7943 5341 4d54 4572 726f 725f 7374 6174  yCSAMTError_stat
-00006180: 696f 6e28 0d0a 2020 2020 2020 2020 2020  ion(..          
-00006190: 2020 2020 2020 274e 6565 6420 2061 6273        'Need  abs
-000061a0: 6f6c 7574 656c 7920 7374 6174 696f 6e20  olutely station 
-000061b0: 6669 6c65 2e27 0d0a 2020 2020 2020 2020  file.'..        
-000061c0: 2020 2020 2020 2020 2720 706c 6561 7365          ' please
-000061d0: 2070 726f 7669 6465 2079 6f75 7220 222e   provide your ".
-000061e0: 5354 4e22 2066 696c 652e 2729 0d0a 2020  STN" file.')..  
-000061f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00006200: 232d 2d2d 3e20 7265 6164 2074 6865 2061  #---> read the a
-00006210: 7667 2066 696c 6520 0d0a 2020 2020 2020  vg file ..      
-00006220: 2020 7365 6c66 2e5f 7265 6164 5f61 7667    self._read_avg
-00006230: 5f66 696c 6528 6461 7461 5f66 6e3d 7365  _file(data_fn=se
-00006240: 6c66 2e64 6174 615f 666e 290d 0a20 2020  lf.data_fn)..   
-00006250: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-00006260: 2d2d 2d3e 2072 6561 6420 7072 6f66 696c  ---> read profil
-00006270: 655f 6f62 6a20 6672 6f6d 2073 6974 6520  e_obj from site 
-00006280: 0d0a 2020 2020 2020 2020 232e 7365 745f  ..        #.set_
-00006290: 7369 7465 5f69 6e66 6f28 6461 7461 5f66  site_info(data_f
-000062a0: 6e3d 2c20 7574 6d5f 7a6f 6e65 203d 2075  n=, utm_zone = u
-000062b0: 746d 5f7a 6f6e 6529 0d0a 2020 2020 2020  tm_zone)..      
-000062c0: 2020 7369 7465 5f6f 626a 203d 2053 6974    site_obj = Sit
-000062d0: 6528 6461 7461 5f66 6e3d 7365 6c66 2e70  e(data_fn=self.p
-000062e0: 726f 6669 6c65 5f66 6e2c 2075 746d 5f7a  rofile_fn, utm_z
-000062f0: 6f6e 653d 7574 6d5f 7a6f 6e65 290d 0a0d  one=utm_zone)...
-00006300: 0a20 2020 2020 2020 2023 2d2d 2d3e 2067  .        #---> g
-00006310: 6574 2074 6865 206c 6973 7420 6f66 2073  et the list of s
-00006320: 7461 7469 6f6e 7320 0d0a 2020 2020 2020  tations ..      
-00006330: 2020 7374 6174 696f 6e5f 6c69 7374 203d    station_list =
-00006340: 2073 6f72 7465 6428 7365 6c66 2e44 6174   sorted(self.Dat
-00006350: 615f 7365 6374 696f 6e2e 5374 6174 696f  a_section.Statio
-00006360: 6e2e 6e61 6d65 7329 0d0a 2020 2020 2020  n.names)..      
-00006370: 2020 0d0a 2020 2020 2020 2020 232d 2d2d    ..        #---
-00006380: 3e20 4275 696c 6420 6a6e 616d 6573 2077  > Build jnames w
-00006390: 6974 6820 7375 7276 6579 206e 616d 6520  ith survey name 
-000063a0: 0d0a 2020 2020 2020 2020 6966 2073 7572  ..        if sur
-000063b0: 7665 795f 6e61 6d65 2069 7320 4e6f 6e65  vey_name is None
-000063c0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-000063d0: 2073 7572 7665 795f 6e61 6d65 203d 2073   survey_name = s
-000063e0: 656c 662e 4865 6164 6572 2e53 7572 7665  elf.Header.Surve
-000063f0: 7941 6e6e 6f74 6174 696f 6e2e 7072 6f6a  yAnnotation.proj
-00006400: 6563 745f 6172 6561 200d 0a20 2020 2020  ect_area ..     
-00006410: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00006420: 206a 5f6f 626a 3d4a 5f63 6f6c 6c65 6374   j_obj=J_collect
-00006430: 696f 6e28 290d 0a20 2020 2020 2020 206a  ion()..        j
-00006440: 7374 6e6e 616d 6573 203d 206a 5f6f 626a  stnnames = j_obj
-00006450: 2e4a 2e6a 6e61 6d65 286e 756d 6265 725f  .J.jname(number_
-00006460: 6f66 5f73 6974 6573 203d 206c 656e 2873  of_sites = len(s
-00006470: 7461 7469 6f6e 5f6c 6973 7429 2c0d 0a20  tation_list),.. 
-00006480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000064a0: 2073 7572 7665 795f 6e61 6d65 3d73 7572   survey_name=sur
-000064b0: 7665 795f 6e61 6d65 290d 0a20 2020 2020  vey_name)..     
-000064c0: 2020 2023 2d2d 2d3e 2067 6574 2063 6f6d     #---> get com
-000064d0: 706f 6e65 6e74 2061 6e64 2063 6865 636b  ponent and check
-000064e0: 2069 7420 7769 7468 206a 200d 0a20 2020   it with j ..   
-000064f0: 2020 2020 2073 656c 662e 4865 6164 6572       self.Header
-00006500: 2e52 782e 7278 436f 6d70 730d 0a20 2020  .Rx.rxComps..   
-00006510: 2020 2020 2066 6f72 206b 6579 2c20 636f       for key, co
-00006520: 6d70 7661 6c75 6520 696e 2073 656c 662e  mpvalue in self.
-00006530: 454d 5f7a 6f6e 6765 326a 2e69 7465 6d73  EM_zonge2j.items
-00006540: 2829 3a20 0d0a 2020 2020 2020 2020 2020  (): ..          
-00006550: 2020 6966 2073 656c 662e 4865 6164 6572    if self.Header
-00006560: 2e52 782e 7278 436f 6d70 7320 203d 3d20  .Rx.rxComps  == 
-00006570: 6b65 7920 3a20 0d0a 2020 2020 2020 2020  key : ..        
-00006580: 2020 2020 2020 2020 6a63 6f6d 7020 3d20          jcomp = 
-00006590: 6a5f 6f62 6a2e 4a2e 6a4d 6f64 6528 706f  j_obj.J.jMode(po
-000065a0: 6c61 7269 7a61 7469 6f6e 5f74 7970 6520  larization_type 
-000065b0: 3d20 636f 6d70 7661 6c75 6529 200d 0a20  = compvalue) .. 
-000065c0: 2020 2020 2020 2023 2d2d 2d3e 206e 756d         #---> num
-000065d0: 6265 7220 6f66 2070 6572 696f 6473 200d  ber of periods .
-000065e0: 0a20 2020 2020 2020 206a 6e70 6572 696f  .        jnperio
-000065f0: 6420 3d20 7365 6c66 2e44 6174 615f 7365  d = self.Data_se
-00006600: 6374 696f 6e2e 4672 6571 7565 6e63 792e  ction.Frequency.
-00006610: 6e75 6d66 7265 710d 0a20 2020 2020 2020  numfreq..       
-00006620: 2023 2066 7265 7175 656e 6379 2076 616c   # frequency val
-00006630: 7565 200d 0a20 2020 2020 2020 206a 7065  ue ..        jpe
-00006640: 7269 6f64 203d 2031 2f73 656c 662e 4461  riod = 1/self.Da
-00006650: 7461 5f73 6563 7469 6f6e 2e46 7265 7175  ta_section.Frequ
-00006660: 656e 6379 2e76 616c 7565 200d 0a20 2020  ency.value ..   
-00006670: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-00006680: 2063 616c 6c20 6461 7461 2073 6563 7469   call data secti
-00006690: 6f6e 200d 0a20 2020 2020 2020 2061 7070  on ..        app
-000066a0: 5f72 686f 5f6f 626a 203d 2073 656c 662e  _rho_obj = self.
-000066b0: 4461 7461 5f73 6563 7469 6f6e 2e52 6573  Data_section.Res
-000066c0: 6973 7469 7669 7479 2e6c 6f63 200d 0a20  istivity.loc .. 
-000066d0: 2020 2020 2020 2070 6861 7365 5f6f 626a         phase_obj
-000066e0: 203d 2073 656c 662e 4461 7461 5f73 6563   = self.Data_sec
-000066f0: 7469 6f6e 2e50 6861 7365 2e6c 6f63 0d0a  tion.Phase.loc..
-00006700: 2020 2020 2020 2020 656d 6167 5f6f 626a          emag_obj
-00006710: 203d 7365 6c66 2e44 6174 615f 7365 6374   =self.Data_sect
-00006720: 696f 6e2e 456d 6167 2e6c 6f63 0d0a 2020  ion.Emag.loc..  
-00006730: 2020 2020 2020 686d 6167 5f6f 626a 203d        hmag_obj =
-00006740: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
-00006750: 6e2e 486d 6167 2e6c 6f63 2020 0d0a 2020  n.Hmag.loc  ..  
-00006760: 2020 2020 2020 635f 7661 725f 656d 6167        c_var_emag
-00006770: 5f6f 626a 203d 2073 656c 662e 4461 7461  _obj = self.Data
-00006780: 5f73 6563 7469 6f6e 2e70 6345 6d61 672e  _section.pcEmag.
-00006790: 6c6f 6320 0d0a 2020 2020 2020 2020 635f  loc ..        c_
-000067a0: 7661 725f 686d 6167 5f6f 626a 203d 2073  var_hmag_obj = s
-000067b0: 656c 662e 4461 7461 5f73 6563 7469 6f6e  elf.Data_section
-000067c0: 2e70 6348 6d61 672e 6c6f 630d 0a20 2020  .pcHmag.loc..   
-000067d0: 2020 2020 2063 5f76 6172 5f61 7070 5f72       c_var_app_r
-000067e0: 686f 5f6f 626a 203d 7365 6c66 2e44 6174  ho_obj =self.Dat
-000067f0: 615f 7365 6374 696f 6e2e 7063 5268 6f2e  a_section.pcRho.
-00006800: 6c6f 630d 0a20 2020 2020 2020 2073 7464  loc..        std
-00006810: 5f70 6861 7365 5f6f 626a 203d 2073 656c  _phase_obj = sel
-00006820: 662e 4461 7461 5f73 6563 7469 6f6e 2e73  f.Data_section.s
-00006830: 5068 7a2e 6c6f 630d 0a20 2020 2020 2020  Phz.loc..       
-00006840: 2023 2d2d 2d3e 2063 6f6d 7075 7465 2072   #---> compute r
-00006850: 686f 6d61 7820 616e 6420 7268 6f6d 696e  homax and rhomin
-00006860: 200d 0a20 2020 2020 2020 206a 6170 705f   ..        japp_
-00006870: 7268 6f5f 6d61 782c 206a 6170 705f 7268  rho_max, japp_rh
-00006880: 6f5f 6d69 6e20 2c20 6a70 6861 7365 5f6d  o_min , jphase_m
-00006890: 6178 2c20 6a70 6861 7365 5f6d 696e 2c6a  ax, jphase_min,j
-000068a0: 7761 7070 5f72 686f 203d 205c 0d0a 2020  wapp_rho = \..  
-000068b0: 2020 2020 2020 2020 2020 5b7b 7d20 666f            [{} fo
-000068c0: 7220 6969 2069 6e20 7261 6e67 6528 3529  r ii in range(5)
-000068d0: 5d20 2320 6372 6561 7465 2034 2065 6d70  ] # create 4 emp
-000068e0: 7920 2064 6963 7473 0d0a 2020 2020 2020  y  dicts..      
-000068f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00006900: 666f 7220 6b65 792c 2076 616c 7565 2069  for key, value i
-00006910: 6e20 7365 6c66 2e44 6174 615f 7365 6374  n self.Data_sect
-00006920: 696f 6e2e 5265 7369 7374 6976 6974 792e  ion.Resistivity.
-00006930: 6c6f 632e 6974 656d 7328 293a 200d 0a20  loc.items(): .. 
-00006940: 2020 2020 2020 2020 2020 206a 6170 705f             japp_
-00006950: 7268 6f5f 6d61 785b 6b65 795d 3d20 6170  rho_max[key]= ap
-00006960: 705f 7268 6f5f 6f62 6a5b 6b65 795d 202b  p_rho_obj[key] +
-00006970: 2031 2a20 5c0d 0a20 2020 2020 2020 2020   1* \..         
-00006980: 2020 2020 2020 205a 6363 2e63 6f6d 7075         Zcc.compu
-00006990: 7465 5f73 6967 6d61 735f 655f 685f 616e  te_sigmas_e_h_an
-000069a0: 645f 7369 676d 615f 7268 6f28 0d0a 2020  d_sigma_rho(..  
+00005bb0: 2020 2020 2020 2020 6578 706f 7274 2069          export i
+00005bc0: 6e66 6f72 6d61 7469 6f6e 7320 696e 746f  nformations into
+00005bd0: 204a 6669 6c65 2c2a 4465 6661 756c 742a   Jfile,*Default*
+00005be0: 2069 7320 4661 6c73 652e 0d0a 2020 2020   is False...    
+00005bf0: 2020 2020 2020 2020 2a20 7375 7276 6579          * survey
+00005c00: 5f6e 616d 653a 2020 2062 6f6f 6c2c 200d  _name:   bool, .
+00005c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005c20: 2020 2020 2020 2020 2073 7572 7665 795f           survey_
+00005c30: 6172 6561 2020 0d0a 2020 2020 2020 2020  area  ..        
+00005c40: 2222 220d 0a20 2020 2020 2020 2023 2323  """..        ###
+00005c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00005c60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00005c70: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00005c80: 2020 2020 2020 2020 6672 6f6d 2070 7963          from pyc
+00005c90: 7361 6d74 2e63 6f72 652e 6a20 696d 706f  samt.core.j impo
+00005ca0: 7274 204a 5f63 6f6c 6c65 6374 696f 6e20  rt J_collection 
+00005cb0: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
+00005cc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00005cd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00005ce0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00005cf0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00005d00: 7361 7665 7061 7468 203d 6b77 732e 706f  savepath =kws.po
+00005d10: 7028 2773 6176 6570 6174 6827 2c20 4e6f  p('savepath', No
+00005d20: 6e65 290d 0a20 2020 2020 2020 2077 7269  ne)..        wri
+00005d30: 7465 5f69 6e66 6f20 3d6b 7773 2e70 6f70  te_info =kws.pop
+00005d40: 2827 7772 6974 6549 6e66 6f73 272c 2046  ('writeInfos', F
+00005d50: 616c 7365 290d 0a20 2020 2020 2020 2073  alse)..        s
+00005d60: 7572 7665 795f 6e61 6d65 203d 6b77 732e  urvey_name =kws.
+00005d70: 706f 7028 2773 7572 7665 795f 6e61 6d65  pop('survey_name
+00005d80: 272c 204e 6f6e 6529 0d0a 2020 2020 0d0a  ', None)..    ..
+00005d90: 2020 2020 2020 2020 6966 206a 5f65 7874          if j_ext
+00005da0: 656e 7369 6f6e 2069 7320 6e6f 7420 4e6f  ension is not No
+00005db0: 6e65 2061 6e64 2027 2e27 206e 6f74 2069  ne and '.' not i
+00005dc0: 6e20 6a5f 6578 7465 6e73 696f 6e3a 0d0a  n j_extension:..
+00005dd0: 2020 2020 2020 2020 2020 2020 6a5f 6578              j_ex
+00005de0: 7465 6e73 696f 6e20 3d27 2e27 2b6a 5f65  tension ='.'+j_e
+00005df0: 7874 656e 7369 6f6e 0d0a 2020 2020 2020  xtension..      
+00005e00: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+00005e10: 2020 2020 2020 7365 6c66 2e5f 6c6f 6767        self._logg
+00005e20: 696e 672e 696e 666f 2827 7772 6974 6520  ing.info('write 
+00005e30: 4a66 6f72 6d61 7420 6669 6c65 2729 0d0a  Jformat file')..
+00005e40: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00005e50: 2020 6966 2061 7667 5f64 6174 615f 666e    if avg_data_fn
+00005e60: 2069 7320 6e6f 7420 4e6f 6e65 203a 2073   is not None : s
+00005e70: 656c 662e 6461 7461 5f66 6e20 3d20 6176  elf.data_fn = av
+00005e80: 675f 6461 7461 5f66 6e20 0d0a 2020 2020  g_data_fn ..    
+00005e90: 2020 2020 6966 2073 656c 662e 6461 7461      if self.data
+00005ea0: 5f66 6e20 6973 204e 6f6e 6520 3a0d 0a20  _fn is None :.. 
+00005eb0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00005ec0: 2041 5647 4572 726f 7228 0d0a 2020 2020   AVGError(..    
+00005ed0: 2020 2020 2020 2020 2020 2020 2243 6f75              "Cou
+00005ee0: 6c64 206e 6f74 2066 696e 6420 616e 7920  ld not find any 
+00005ef0: 7061 7468 2074 6f20 7265 6164 202e 220d  path to read .".
+00005f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005f10: 2020 2250 6c65 6173 6520 7072 6f76 6964    "Please provid
+00005f20: 6520 796f 7572 2072 6967 6874 2041 5647  e your right AVG
+00005f30: 2066 696c 652e 2229 0d0a 2020 2020 2020   file.")..      
+00005f40: 2020 0d0a 2020 2020 2020 2020 6966 2070    ..        if p
+00005f50: 726f 6669 6c65 5f66 6e20 6973 206e 6f74  rofile_fn is not
+00005f60: 204e 6f6e 6520 3a20 7365 6c66 2e70 726f   None : self.pro
+00005f70: 6669 6c65 5f66 6e20 3d20 7072 6f66 696c  file_fn = profil
+00005f80: 655f 666e 200d 0a20 2020 2020 2020 200d  e_fn ..        .
+00005f90: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00005fa0: 2e70 726f 6669 6c65 5f66 6e20 6973 2020  .profile_fn is  
+00005fb0: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+00005fc0: 2020 2020 7261 6973 6520 5374 6174 696f      raise Statio
+00005fd0: 6e45 7272 6f72 280d 0a20 2020 2020 2020  nError(..       
+00005fe0: 2020 2020 2020 2020 2027 4e65 6564 2020           'Need  
+00005ff0: 6162 736f 6c75 7465 6c79 2073 7461 7469  absolutely stati
+00006000: 6f6e 2066 696c 652e 270d 0a20 2020 2020  on file.'..     
+00006010: 2020 2020 2020 2020 2020 2027 2070 6c65             ' ple
+00006020: 6173 6520 7072 6f76 6964 6520 796f 7572  ase provide your
+00006030: 2022 2e53 544e 2220 6669 6c65 2e27 290d   ".STN" file.').
+00006040: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00006050: 2020 2023 2d2d 2d3e 2072 6561 6420 7468     #---> read th
+00006060: 6520 6176 6720 6669 6c65 200d 0a20 2020  e avg file ..   
+00006070: 2020 2020 2073 656c 662e 5f72 6561 645f       self._read_
+00006080: 6176 675f 6669 6c65 2864 6174 615f 666e  avg_file(data_fn
+00006090: 3d73 656c 662e 6461 7461 5f66 6e29 0d0a  =self.data_fn)..
+000060a0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000060b0: 2020 232d 2d2d 3e20 7265 6164 2070 726f    #---> read pro
+000060c0: 6669 6c65 5f6f 626a 2066 726f 6d20 7369  file_obj from si
+000060d0: 7465 200d 0a20 2020 2020 2020 2023 2e73  te ..        #.s
+000060e0: 6574 5f73 6974 655f 696e 666f 2864 6174  et_site_info(dat
+000060f0: 615f 666e 3d2c 2075 746d 5f7a 6f6e 6520  a_fn=, utm_zone 
+00006100: 3d20 7574 6d5f 7a6f 6e65 290d 0a20 2020  = utm_zone)..   
+00006110: 2020 2020 2073 6974 655f 6f62 6a20 3d20       site_obj = 
+00006120: 5369 7465 2864 6174 615f 666e 3d73 656c  Site(data_fn=sel
+00006130: 662e 7072 6f66 696c 655f 666e 2c20 7574  f.profile_fn, ut
+00006140: 6d5f 7a6f 6e65 3d75 746d 5f7a 6f6e 6529  m_zone=utm_zone)
+00006150: 0d0a 0d0a 2020 2020 2020 2020 232d 2d2d  ....        #---
+00006160: 3e20 6765 7420 7468 6520 6c69 7374 206f  > get the list o
+00006170: 6620 7374 6174 696f 6e73 200d 0a20 2020  f stations ..   
+00006180: 2020 2020 2073 7461 7469 6f6e 5f6c 6973       station_lis
+00006190: 7420 3d20 736f 7274 6564 2873 656c 662e  t = sorted(self.
+000061a0: 4461 7461 5f73 6563 7469 6f6e 2e53 7461  Data_section.Sta
+000061b0: 7469 6f6e 2e6e 616d 6573 290d 0a20 2020  tion.names)..   
+000061c0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+000061d0: 2d2d 2d3e 2042 7569 6c64 206a 6e61 6d65  ---> Build jname
+000061e0: 7320 7769 7468 2073 7572 7665 7920 6e61  s with survey na
+000061f0: 6d65 200d 0a20 2020 2020 2020 2069 6620  me ..        if 
+00006200: 7375 7276 6579 5f6e 616d 6520 6973 204e  survey_name is N
+00006210: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
+00006220: 2020 2020 7375 7276 6579 5f6e 616d 6520      survey_name 
+00006230: 3d20 7365 6c66 2e48 6561 6465 722e 5375  = self.Header.Su
+00006240: 7276 6579 416e 6e6f 7461 7469 6f6e 2e70  rveyAnnotation.p
+00006250: 726f 6a65 6374 5f61 7265 6120 0d0a 2020  roject_area ..  
+00006260: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00006270: 2020 2020 6a5f 6f62 6a3d 4a5f 636f 6c6c      j_obj=J_coll
+00006280: 6563 7469 6f6e 2829 0d0a 2020 2020 2020  ection()..      
+00006290: 2020 6a73 746e 6e61 6d65 7320 3d20 6a5f    jstnnames = j_
+000062a0: 6f62 6a2e 4a2e 6a6e 616d 6528 6e75 6d62  obj.J.jname(numb
+000062b0: 6572 5f6f 665f 7369 7465 7320 3d20 6c65  er_of_sites = le
+000062c0: 6e28 7374 6174 696f 6e5f 6c69 7374 292c  n(station_list),
+000062d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000062e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000062f0: 2020 2020 7375 7276 6579 5f6e 616d 653d      survey_name=
+00006300: 7375 7276 6579 5f6e 616d 6529 0d0a 2020  survey_name)..  
+00006310: 2020 2020 2020 232d 2d2d 3e20 6765 7420        #---> get 
+00006320: 636f 6d70 6f6e 656e 7420 616e 6420 6368  component and ch
+00006330: 6563 6b20 6974 2077 6974 6820 6a20 0d0a  eck it with j ..
+00006340: 2020 2020 2020 2020 7365 6c66 2e48 6561          self.Hea
+00006350: 6465 722e 5278 2e72 7843 6f6d 7073 0d0a  der.Rx.rxComps..
+00006360: 2020 2020 2020 2020 666f 7220 6b65 792c          for key,
+00006370: 2063 6f6d 7076 616c 7565 2069 6e20 7365   compvalue in se
+00006380: 6c66 2e45 4d5f 7a6f 6e67 6532 6a2e 6974  lf.EM_zonge2j.it
+00006390: 656d 7328 293a 200d 0a20 2020 2020 2020  ems(): ..       
+000063a0: 2020 2020 2069 6620 7365 6c66 2e48 6561       if self.Hea
+000063b0: 6465 722e 5278 2e72 7843 6f6d 7073 2020  der.Rx.rxComps  
+000063c0: 3d3d 206b 6579 203a 200d 0a20 2020 2020  == key : ..     
+000063d0: 2020 2020 2020 2020 2020 206a 636f 6d70             jcomp
+000063e0: 203d 206a 5f6f 626a 2e4a 2e6a 4d6f 6465   = j_obj.J.jMode
+000063f0: 2870 6f6c 6172 697a 6174 696f 6e5f 7479  (polarization_ty
+00006400: 7065 203d 2063 6f6d 7076 616c 7565 2920  pe = compvalue) 
+00006410: 0d0a 2020 2020 2020 2020 232d 2d2d 3e20  ..        #---> 
+00006420: 6e75 6d62 6572 206f 6620 7065 7269 6f64  number of period
+00006430: 7320 0d0a 2020 2020 2020 2020 6a6e 7065  s ..        jnpe
+00006440: 7269 6f64 203d 2073 656c 662e 4461 7461  riod = self.Data
+00006450: 5f73 6563 7469 6f6e 2e46 7265 7175 656e  _section.Frequen
+00006460: 6379 2e6e 756d 6672 6571 0d0a 2020 2020  cy.numfreq..    
+00006470: 2020 2020 2320 6672 6571 7565 6e63 7920      # frequency 
+00006480: 7661 6c75 6520 0d0a 2020 2020 2020 2020  value ..        
+00006490: 6a70 6572 696f 6420 3d20 312f 7365 6c66  jperiod = 1/self
+000064a0: 2e44 6174 615f 7365 6374 696f 6e2e 4672  .Data_section.Fr
+000064b0: 6571 7565 6e63 792e 7661 6c75 6520 0d0a  equency.value ..
+000064c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000064d0: 2020 2320 6361 6c6c 2064 6174 6120 7365    # call data se
+000064e0: 6374 696f 6e20 0d0a 2020 2020 2020 2020  ction ..        
+000064f0: 6170 705f 7268 6f5f 6f62 6a20 3d20 7365  app_rho_obj = se
+00006500: 6c66 2e44 6174 615f 7365 6374 696f 6e2e  lf.Data_section.
+00006510: 5265 7369 7374 6976 6974 792e 6c6f 6320  Resistivity.loc 
+00006520: 0d0a 2020 2020 2020 2020 7068 6173 655f  ..        phase_
+00006530: 6f62 6a20 3d20 7365 6c66 2e44 6174 615f  obj = self.Data_
+00006540: 7365 6374 696f 6e2e 5068 6173 652e 6c6f  section.Phase.lo
+00006550: 630d 0a20 2020 2020 2020 2065 6d61 675f  c..        emag_
+00006560: 6f62 6a20 3d73 656c 662e 4461 7461 5f73  obj =self.Data_s
+00006570: 6563 7469 6f6e 2e45 6d61 672e 6c6f 630d  ection.Emag.loc.
+00006580: 0a20 2020 2020 2020 2068 6d61 675f 6f62  .        hmag_ob
+00006590: 6a20 3d73 656c 662e 4461 7461 5f73 6563  j =self.Data_sec
+000065a0: 7469 6f6e 2e48 6d61 672e 6c6f 6320 200d  tion.Hmag.loc  .
+000065b0: 0a20 2020 2020 2020 2063 5f76 6172 5f65  .        c_var_e
+000065c0: 6d61 675f 6f62 6a20 3d20 7365 6c66 2e44  mag_obj = self.D
+000065d0: 6174 615f 7365 6374 696f 6e2e 7063 456d  ata_section.pcEm
+000065e0: 6167 2e6c 6f63 200d 0a20 2020 2020 2020  ag.loc ..       
+000065f0: 2063 5f76 6172 5f68 6d61 675f 6f62 6a20   c_var_hmag_obj 
+00006600: 3d20 7365 6c66 2e44 6174 615f 7365 6374  = self.Data_sect
+00006610: 696f 6e2e 7063 486d 6167 2e6c 6f63 0d0a  ion.pcHmag.loc..
+00006620: 2020 2020 2020 2020 635f 7661 725f 6170          c_var_ap
+00006630: 705f 7268 6f5f 6f62 6a20 3d73 656c 662e  p_rho_obj =self.
+00006640: 4461 7461 5f73 6563 7469 6f6e 2e70 6352  Data_section.pcR
+00006650: 686f 2e6c 6f63 0d0a 2020 2020 2020 2020  ho.loc..        
+00006660: 7374 645f 7068 6173 655f 6f62 6a20 3d20  std_phase_obj = 
+00006670: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
+00006680: 6e2e 7350 687a 2e6c 6f63 0d0a 2020 2020  n.sPhz.loc..    
+00006690: 2020 2020 232d 2d2d 3e20 636f 6d70 7574      #---> comput
+000066a0: 6520 7268 6f6d 6178 2061 6e64 2072 686f  e rhomax and rho
+000066b0: 6d69 6e20 0d0a 2020 2020 2020 2020 6a61  min ..        ja
+000066c0: 7070 5f72 686f 5f6d 6178 2c20 6a61 7070  pp_rho_max, japp
+000066d0: 5f72 686f 5f6d 696e 202c 206a 7068 6173  _rho_min , jphas
+000066e0: 655f 6d61 782c 206a 7068 6173 655f 6d69  e_max, jphase_mi
+000066f0: 6e2c 6a77 6170 705f 7268 6f20 3d20 5c0d  n,jwapp_rho = \.
+00006700: 0a20 2020 2020 2020 2020 2020 205b 7b7d  .            [{}
+00006710: 2066 6f72 2069 6920 696e 2072 616e 6765   for ii in range
+00006720: 2835 295d 2023 2063 7265 6174 6520 3420  (5)] # create 4 
+00006730: 656d 7079 2020 6469 6374 730d 0a20 2020  empy  dicts..   
+00006740: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00006750: 2020 2066 6f72 206b 6579 2c20 7661 6c75     for key, valu
+00006760: 6520 696e 2073 656c 662e 4461 7461 5f73  e in self.Data_s
+00006770: 6563 7469 6f6e 2e52 6573 6973 7469 7669  ection.Resistivi
+00006780: 7479 2e6c 6f63 2e69 7465 6d73 2829 3a20  ty.loc.items(): 
+00006790: 0d0a 2020 2020 2020 2020 2020 2020 6a61  ..            ja
+000067a0: 7070 5f72 686f 5f6d 6178 5b6b 6579 5d3d  pp_rho_max[key]=
+000067b0: 2061 7070 5f72 686f 5f6f 626a 5b6b 6579   app_rho_obj[key
+000067c0: 5d20 2b20 312a 205c 0d0a 2020 2020 2020  ] + 1* \..      
+000067d0: 2020 2020 2020 2020 2020 5a63 632e 636f            Zcc.co
+000067e0: 6d70 7574 655f 7369 676d 6173 5f65 5f68  mpute_sigmas_e_h
+000067f0: 5f61 6e64 5f73 6967 6d61 5f72 686f 280d  _and_sigma_rho(.
+00006800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006810: 2020 2020 2020 2020 2070 635f 656d 6167           pc_emag
+00006820: 3d20 635f 7661 725f 656d 6167 5f6f 626a  = c_var_emag_obj
+00006830: 5b6b 6579 5d2c 0d0a 2020 2020 2020 2020  [key],..        
+00006840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006850: 7063 5f68 6d61 673d 2063 5f76 6172 5f68  pc_hmag= c_var_h
+00006860: 6d61 675f 6f62 6a5b 6b65 795d 202c 0d0a  mag_obj[key] ,..
+00006870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006880: 2020 2020 2020 2020 7063 5f61 7070 5f72          pc_app_r
+00006890: 686f 3d63 5f76 6172 5f61 7070 5f72 686f  ho=c_var_app_rho
+000068a0: 5f6f 626a 5b6b 6579 5d2c 0d0a 2020 2020  _obj[key],..    
+000068b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000068c0: 2020 2020 6170 705f 7268 6f3d 2061 7070      app_rho= app
+000068d0: 5f72 686f 5f6f 626a 5b6b 6579 5d2c 200d  _rho_obj[key], .
+000068e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000068f0: 2020 2020 2020 2020 2065 6d61 673d 2065           emag= e
+00006900: 6d61 675f 6f62 6a5b 6b65 795d 2c0d 0a20  mag_obj[key],.. 
+00006910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006920: 2020 2020 2020 2068 6d61 673d 686d 6167         hmag=hmag
+00006930: 5f6f 626a 5b6b 6579 5d29 5b2d 315d 0d0a  _obj[key])[-1]..
+00006940: 2020 2020 2020 2020 2020 2020 6a61 7070              japp
+00006950: 5f72 686f 5f6d 696e 5b6b 6579 5d3d 2061  _rho_min[key]= a
+00006960: 7070 5f72 686f 5f6f 626a 5b6b 6579 5d20  pp_rho_obj[key] 
+00006970: 2d20 3120 2a5c 0d0a 2020 2020 2020 2020  - 1 *\..        
+00006980: 2020 2020 2020 2020 5a63 632e 636f 6d70          Zcc.comp
+00006990: 7574 655f 7369 676d 6173 5f65 5f68 5f61  ute_sigmas_e_h_a
+000069a0: 6e64 5f73 6967 6d61 5f72 686f 280d 0a20  nd_sigma_rho(.. 
 000069b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069c0: 2020 2020 2020 7063 5f65 6d61 673d 2063        pc_emag= c
-000069d0: 5f76 6172 5f65 6d61 675f 6f62 6a5b 6b65  _var_emag_obj[ke
-000069e0: 795d 2c0d 0a20 2020 2020 2020 2020 2020  y],..           
-000069f0: 2020 2020 2020 2020 2020 2020 2070 635f               pc_
-00006a00: 686d 6167 3d20 635f 7661 725f 686d 6167  hmag= c_var_hmag
-00006a10: 5f6f 626a 5b6b 6579 5d20 2c0d 0a20 2020  _obj[key] ,..   
+000069c0: 2020 2020 2020 2070 635f 656d 6167 3d20         pc_emag= 
+000069d0: 635f 7661 725f 656d 6167 5f6f 626a 5b6b  c_var_emag_obj[k
+000069e0: 6579 5d2c 0d0a 2020 2020 2020 2020 2020  ey],..          
+000069f0: 2020 2020 2020 2020 2020 2020 2020 7063                pc
+00006a00: 5f68 6d61 673d 2063 5f76 6172 5f68 6d61  _hmag= c_var_hma
+00006a10: 675f 6f62 6a5b 6b65 795d 202c 0d0a 2020  g_obj[key] ,..  
 00006a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a30: 2020 2020 2070 635f 6170 705f 7268 6f3d       pc_app_rho=
-00006a40: 635f 7661 725f 6170 705f 7268 6f5f 6f62  c_var_app_rho_ob
-00006a50: 6a5b 6b65 795d 2c0d 0a20 2020 2020 2020  j[key],..       
+00006a30: 2020 2020 2020 7063 5f61 7070 5f72 686f        pc_app_rho
+00006a40: 3d63 5f76 6172 5f61 7070 5f72 686f 5f6f  =c_var_app_rho_o
+00006a50: 626a 5b6b 6579 5d2c 0d0a 2020 2020 2020  bj[key],..      
 00006a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a70: 2061 7070 5f72 686f 3d20 6170 705f 7268   app_rho= app_rh
-00006a80: 6f5f 6f62 6a5b 6b65 795d 2c20 0d0a 2020  o_obj[key], ..  
+00006a70: 2020 6170 705f 7268 6f3d 2061 7070 5f72    app_rho= app_r
+00006a80: 686f 5f6f 626a 5b6b 6579 5d2c 200d 0a20  ho_obj[key], .. 
 00006a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006aa0: 2020 2020 2020 656d 6167 3d20 656d 6167        emag= emag
-00006ab0: 5f6f 626a 5b6b 6579 5d2c 0d0a 2020 2020  _obj[key],..    
+00006aa0: 2020 2020 2020 2065 6d61 673d 2065 6d61         emag= ema
+00006ab0: 675f 6f62 6a5b 6b65 795d 2c0d 0a20 2020  g_obj[key],..   
 00006ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ad0: 2020 2020 686d 6167 3d68 6d61 675f 6f62      hmag=hmag_ob
-00006ae0: 6a5b 6b65 795d 295b 2d31 5d0d 0a20 2020  j[key])[-1]..   
-00006af0: 2020 2020 2020 2020 206a 6170 705f 7268           japp_rh
-00006b00: 6f5f 6d69 6e5b 6b65 795d 3d20 6170 705f  o_min[key]= app_
-00006b10: 7268 6f5f 6f62 6a5b 6b65 795d 202d 2031  rho_obj[key] - 1
-00006b20: 202a 5c0d 0a20 2020 2020 2020 2020 2020   *\..           
-00006b30: 2020 2020 205a 6363 2e63 6f6d 7075 7465       Zcc.compute
-00006b40: 5f73 6967 6d61 735f 655f 685f 616e 645f  _sigmas_e_h_and_
-00006b50: 7369 676d 615f 7268 6f28 0d0a 2020 2020  sigma_rho(..    
-00006b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b70: 2020 2020 7063 5f65 6d61 673d 2063 5f76      pc_emag= c_v
-00006b80: 6172 5f65 6d61 675f 6f62 6a5b 6b65 795d  ar_emag_obj[key]
-00006b90: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00006ba0: 2020 2020 2020 2020 2020 2070 635f 686d             pc_hm
-00006bb0: 6167 3d20 635f 7661 725f 686d 6167 5f6f  ag= c_var_hmag_o
-00006bc0: 626a 5b6b 6579 5d20 2c0d 0a20 2020 2020  bj[key] ,..     
+00006ad0: 2020 2020 2068 6d61 673d 686d 6167 5f6f       hmag=hmag_o
+00006ae0: 626a 5b6b 6579 5d29 5b2d 315d 0d0a 2020  bj[key])[-1]..  
+00006af0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00006b00: 2020 2020 666f 7220 6b65 792c 2076 616c      for key, val
+00006b10: 7565 2069 6e20 7365 6c66 2e44 6174 615f  ue in self.Data_
+00006b20: 7365 6374 696f 6e2e 5068 6173 652e 6c6f  section.Phase.lo
+00006b30: 632e 6974 656d 7328 293a 200d 0a20 2020  c.items(): ..   
+00006b40: 2020 2020 2020 2020 206a 7068 6173 655f           jphase_
+00006b50: 6d61 7820 5b6b 6579 5d3d 2031 3830 202a  max [key]= 180 *
+00006b60: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00006b70: 2020 2020 7068 6173 655f 6f62 6a5b 6b65      phase_obj[ke
+00006b80: 795d 202b 2031 202a 2073 7464 5f70 6861  y] + 1 * std_pha
+00006b90: 7365 5f6f 626a 5b6b 6579 5d2f 3130 3029  se_obj[key]/100)
+00006ba0: 2f6e 702e 7069 0d0a 2020 2020 2020 2020  /np.pi..        
+00006bb0: 2020 2020 6a70 6861 7365 5f6d 696e 205b      jphase_min [
+00006bc0: 6b65 795d 203d 2031 3830 202a 2028 0d0a  key] = 180 * (..
 00006bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006be0: 2020 2070 635f 6170 705f 7268 6f3d 635f     pc_app_rho=c_
-00006bf0: 7661 725f 6170 705f 7268 6f5f 6f62 6a5b  var_app_rho_obj[
-00006c00: 6b65 795d 2c0d 0a20 2020 2020 2020 2020  key],..         
-00006c10: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00006c20: 7070 5f72 686f 3d20 6170 705f 7268 6f5f  pp_rho= app_rho_
-00006c30: 6f62 6a5b 6b65 795d 2c20 0d0a 2020 2020  obj[key], ..    
-00006c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c50: 2020 2020 656d 6167 3d20 656d 6167 5f6f      emag= emag_o
-00006c60: 626a 5b6b 6579 5d2c 0d0a 2020 2020 2020  bj[key],..      
-00006c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c80: 2020 686d 6167 3d68 6d61 675f 6f62 6a5b    hmag=hmag_obj[
-00006c90: 6b65 795d 295b 2d31 5d0d 0a20 2020 2020  key])[-1]..     
-00006ca0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00006cb0: 2066 6f72 206b 6579 2c20 7661 6c75 6520   for key, value 
-00006cc0: 696e 2073 656c 662e 4461 7461 5f73 6563  in self.Data_sec
-00006cd0: 7469 6f6e 2e50 6861 7365 2e6c 6f63 2e69  tion.Phase.loc.i
-00006ce0: 7465 6d73 2829 3a20 0d0a 2020 2020 2020  tems(): ..      
-00006cf0: 2020 2020 2020 6a70 6861 7365 5f6d 6178        jphase_max
-00006d00: 205b 6b65 795d 3d20 3138 3020 2a20 280d   [key]= 180 * (.
-00006d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006d20: 2070 6861 7365 5f6f 626a 5b6b 6579 5d20   phase_obj[key] 
-00006d30: 2b20 3120 2a20 7374 645f 7068 6173 655f  + 1 * std_phase_
-00006d40: 6f62 6a5b 6b65 795d 2f31 3030 292f 6e70  obj[key]/100)/np
-00006d50: 2e70 690d 0a20 2020 2020 2020 2020 2020  .pi..           
-00006d60: 206a 7068 6173 655f 6d69 6e20 5b6b 6579   jphase_min [key
-00006d70: 5d20 3d20 3138 3020 2a20 280d 0a20 2020  ] = 180 * (..   
-00006d80: 2020 2020 2020 2020 2020 2020 2070 6861               pha
-00006d90: 7365 5f6f 626a 5b6b 6579 5d20 2d20 3120  se_obj[key] - 1 
-00006da0: 2a20 7374 645f 7068 6173 655f 6f62 6a5b  * std_phase_obj[
-00006db0: 6b65 795d 2f31 3030 292f 6e70 2e70 690d  key]/100)/np.pi.
-00006dc0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00006dd0: 2020 2023 636f 6e76 6572 7420 7068 6173     #convert phas
-00006de0: 6520 6d69 6c6c 6972 6164 2076 616c 7565  e millirad value
-00006df0: 2069 6e20 6465 6772 6565 203a 200d 0a20   in degree : .. 
-00006e00: 2020 2020 2020 2070 6861 7365 5f6f 626a         phase_obj
-00006e10: 203d 7b6b 6579 3a20 3138 3020 2a20 7068   ={key: 180 * ph
-00006e20: 6173 6520 2a20 3165 2d33 2f6e 702e 7069  ase * 1e-3/np.pi
-00006e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00006e40: 2020 2020 2020 666f 7220 6b65 792c 2070        for key, p
-00006e50: 6861 7365 2069 6e20 7068 6173 655f 6f62  hase in phase_ob
-00006e60: 6a2e 6974 656d 7328 297d 0d0a 2020 2020  j.items()}..    
-00006e70: 2020 2020 2320 636f 6d70 7574 6520 6a77      # compute jw
-00006e80: 726f 2061 6e64 206a 7770 6861 200d 0a20  ro and jwpha .. 
-00006e90: 2020 2020 2020 2023 7765 2061 7373 756d         #we assum
-00006ea0: 6520 746f 2074 616b 6520 7765 6967 6874  e to take weight
-00006eb0: 2074 6f20 312e 0d0a 2020 2020 2020 2020   to 1...        
-00006ec0: 6a77 6170 705f 7268 6f20 3d7b 206b 6579  jwapp_rho ={ key
-00006ed0: 3a76 616c 7565 2066 6f72 206b 6579 202c  :value for key ,
-00006ee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00006ef0: 2020 2020 2020 7661 6c75 6520 696e 207a        value in z
-00006f00: 6970 2873 7461 7469 6f6e 5f6c 6973 742c  ip(station_list,
-00006f10: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00006f20: 2020 2020 2020 2020 5b6e 702e 6f6e 6573          [np.ones
-00006f30: 2828 7365 6c66 2e44 6174 615f 7365 6374  ((self.Data_sect
-00006f40: 696f 6e2e 4672 6571 7565 6e63 792e 6e75  ion.Frequency.nu
-00006f50: 6d66 7265 712c 292c 200d 0a20 2020 2020  mfreq,), ..     
-00006f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006f70: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
-00006f80: 2766 6c6f 6174 3634 2729 200d 0a20 2020  'float64') ..   
-00006f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006fa0: 2020 2066 6f72 2069 6920 696e 2072 616e     for ii in ran
-00006fb0: 6765 286c 656e 2873 7461 7469 6f6e 5f6c  ge(len(station_l
-00006fc0: 6973 7429 295d 297d 0d0a 2020 2020 2020  ist))])}..      
-00006fd0: 2020 0d0a 2020 2020 2020 2020 696d 706f    ..        impo
-00006fe0: 7274 2063 6f70 7920 2023 2075 7365 2064  rt copy  # use d
-00006ff0: 6565 7020 636f 7079 2074 6f20 636f 7079  eep copy to copy
-00007000: 2074 6865 2073 616d 6520 7765 6967 6874   the same weight
-00007010: 2061 6e64 2072 6520 200d 0a20 2020 2020   and re  ..     
-00007020: 2020 206a 7770 6861 203d 2063 6f70 792e     jwpha = copy.
-00007030: 6465 6570 636f 7079 286a 7761 7070 5f72  deepcopy(jwapp_r
-00007040: 686f 290d 0a20 2020 2020 2020 200d 0a20  ho)..        .. 
-00007050: 2020 2020 2020 2023 2d2d 2d2d 2d3e 2073         #-----> s
-00007060: 7461 7274 696e 6720 7772 6974 696e 6720  tarting writing 
-00007070: 4a66 696c 6573 203c 2d2d 2d2d 2d20 0d0a  Jfiles <----- ..
-00007080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007090: 232d 2d2d 203e 2073 7461 7274 2077 7269  #--- > start wri
-000070a0: 7469 6e67 200d 0a20 2020 2020 2020 2077  ting ..        w
-000070b0: 7269 7465 5f6a 6c69 6e65 7320 3d5b 5d0d  rite_jlines =[].
-000070c0: 0a20 2020 2020 2020 2069 6620 7375 7276  .        if surv
-000070d0: 6579 5f6e 616d 6520 6973 204e 6f6e 6520  ey_name is None 
-000070e0: 3a20 636f 6465 5f6e 616d 6520 3d20 276b  : code_name = 'k
-000070f0: 737b 303a 3032 7d2d 7b31 7d27 0d0a 2020  s{0:02}-{1}'..  
-00007100: 2020 2020 2020 656c 6966 2073 7572 7665        elif surve
-00007110: 795f 6e61 6d65 2069 7320 6e6f 7420 4e6f  y_name is not No
-00007120: 6e65 203a 2063 6f64 655f 6e61 6d65 203d  ne : code_name =
-00007130: 2073 7572 7665 795f 6e61 6d65 5b3a 2d33   survey_name[:-3
-00007140: 5d2b 277b 303a 3032 7d2d 7b31 7d27 0d0a  ]+'{0:02}-{1}'..
-00007150: 2020 2020 2020 2020 636f 6465 7370 6163          codespac
-00007160: 653d 2035 2a27 2027 0d0a 2020 2020 2020  e= 5*' '..      
-00007170: 2020 0d0a 2020 2020 2020 2020 6966 2073    ..        if s
-00007180: 6176 6570 6174 6820 2069 7320 4e6f 6e65  avepath  is None
-00007190: 203a 2023 2063 7265 6174 6520 6120 666f   : # create a fo
-000071a0: 6c64 6572 2069 6e20 796f 7572 2063 7572  lder in your cur
-000071b0: 7265 6e74 2077 6f72 6b20 6469 7265 6374  rent work direct
-000071c0: 6f72 790d 0a20 2020 2020 2020 2020 2020  ory..           
-000071d0: 7472 7920 3a0d 0a20 2020 2020 2020 2020  try :..         
-000071e0: 2020 2020 2020 7361 7665 7061 7468 203d        savepath =
-000071f0: 206f 732e 7061 7468 2e6a 6f69 6e28 6f73   os.path.join(os
-00007200: 2e67 6574 6377 6428 292c 2027 5f6f 7574  .getcwd(), '_out
-00007210: 7075 744a 5f27 290d 0a20 2020 2020 2020  putJ_')..       
-00007220: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
-00007230: 732e 7061 7468 2e69 7364 6972 2873 6176  s.path.isdir(sav
-00007240: 6570 6174 6829 3a0d 0a20 2020 2020 2020  epath):..       
-00007250: 2020 2020 2020 2020 2020 2020 6f73 2e6d              os.m
-00007260: 6b64 6972 2873 6176 6570 6174 6829 0d0a  kdir(savepath)..
-00007270: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00007280: 7420 3a20 0d0a 2020 2020 2020 2020 2020  t : ..          
-00007290: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-000072a0: 726e 2822 4974 2073 6565 6d73 2074 6865  rn("It seems the
-000072b0: 2070 6174 6820 616c 7265 6164 7920 6578   path already ex
-000072c0: 6973 7473 2021 2229 0d0a 2020 2020 2020  ists !")..      
-000072d0: 2020 0d0a 2020 2020 2020 2020 666f 7220    ..        for 
-000072e0: 6969 202c 2073 746e 2069 6e20 656e 756d  ii , stn in enum
-000072f0: 6572 6174 6528 7374 6174 696f 6e5f 6c69  erate(station_li
-00007300: 7374 2920 3a20 0d0a 2020 2020 2020 2020  st) : ..        
-00007310: 2020 2020 232d 2d20 3e20 7772 6974 6520      #-- > write 
-00007320: 4865 6164 206a 200d 0a20 2020 2020 2020  Head j ..       
-00007330: 2020 2020 2077 7269 7465 5f6a 6c69 6e65       write_jline
-00007340: 732e 6170 7065 6e64 2827 272e 6a6f 696e  s.append(''.join
-00007350: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00007360: 2020 205b 6a5f 6f62 6a2e 4a2e 5f63 6f6d     [j_obj.J._com
-00007370: 6d65 6e74 5f6d 6172 6b2c 277b 303a 7d20  ment_mark,'{0:} 
-00007380: 3a27 2e66 6f72 6d61 7428 6a5f 6f62 6a2e  :'.format(j_obj.
-00007390: 4a2e 6a69 6e66 6f2e 7072 6f67 7665 7273  J.jinfo.progvers
-000073a0: 2920 2c20 0d0a 2020 2020 2020 2020 2020  ) , ..          
-000073b0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-000073c0: 6465 5f6e 616d 652e 666f 726d 6174 2869  de_name.format(i
-000073d0: 692c 2073 7461 7469 6f6e 5f6c 6973 745b  i, station_list[
-000073e0: 6969 5d29 2c20 636f 6465 7370 6163 652c  ii]), codespace,
-000073f0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00007400: 2020 2020 2020 2020 2020 2064 6174 6574             datet
-00007410: 696d 652e 6e6f 7728 292e 7374 7266 7469  ime.now().strfti
-00007420: 6d65 286a 5f6f 626a 2e4a 2e6a 666d 7469  me(j_obj.J.jfmti
-00007430: 6d65 292c 200d 0a20 2020 2020 2020 2020  me), ..         
-00007440: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00007450: 6f64 6573 7061 6365 2c20 2752 4543 5327  odespace, 'RECS'
-00007460: 5d29 2b27 5c6e 2729 0d0a 2020 2020 2020  ])+'\n')..      
-00007470: 2020 2020 2020 232d 2d3e 2077 7269 7465        #--> write
-00007480: 2069 6e66 6f20 3a20 0d0a 2020 2020 2020   info : ..      
-00007490: 2020 2020 2020 6966 2077 7269 7465 5f69        if write_i
-000074a0: 6e66 6f20 3a20 0d0a 2020 2020 2020 2020  nfo : ..        
-000074b0: 2020 2020 2020 2020 7472 7920 3a0d 0a20          try :.. 
-000074c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074d0: 2020 2063 6f75 6e74 6572 5f62 7265 616b     counter_break
-000074e0: 3d30 0d0a 2020 2020 2020 2020 2020 2020  =0..            
-000074f0: 2020 2020 2020 2020 6c69 6e65 696e 666f          lineinfo
-00007500: 3d5b 5d0d 0a20 2020 2020 2020 2020 2020  =[]..           
-00007510: 2020 2020 2020 2020 2023 2d2d 3e20 7772           #--> wr
-00007520: 6974 6520 7a6f 6e67 6548 6172 6477 6172  ite zongeHardwar
-00007530: 6520 696e 666f 7320 0d0a 2020 2020 2020  e infos ..      
-00007540: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00007550: 7220 7a6f 6e67 6569 6e66 6f20 696e 205b  r zongeinfo in [
-00007560: 7365 6c66 2e48 6561 6465 722e 4861 7264  self.Header.Hard
-00007570: 7761 7265 496e 666f 732e 7363 6f6e 6669  wareInfos.sconfi
-00007580: 675f 6469 6374 2c0d 0a20 2020 2020 2020  g_dict,..       
-00007590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000075b0: 656c 662e 4865 6164 6572 2e53 7572 7665  elf.Header.Surve
-000075c0: 7941 6e6e 6f74 6174 696f 6e2e 7363 6f6e  yAnnotation.scon
-000075d0: 6669 675f 6469 6374 2c0d 0a20 2020 2020  fig_dict,..     
-000075e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006be0: 7068 6173 655f 6f62 6a5b 6b65 795d 202d  phase_obj[key] -
+00006bf0: 2031 202a 2073 7464 5f70 6861 7365 5f6f   1 * std_phase_o
+00006c00: 626a 5b6b 6579 5d2f 3130 3029 2f6e 702e  bj[key]/100)/np.
+00006c10: 7069 0d0a 2020 2020 2020 2020 0d0a 2020  pi..        ..  
+00006c20: 2020 2020 2020 2363 6f6e 7665 7274 2070        #convert p
+00006c30: 6861 7365 206d 696c 6c69 7261 6420 7661  hase millirad va
+00006c40: 6c75 6520 696e 2064 6567 7265 6520 3a20  lue in degree : 
+00006c50: 0d0a 2020 2020 2020 2020 7068 6173 655f  ..        phase_
+00006c60: 6f62 6a20 3d7b 6b65 793a 2031 3830 202a  obj ={key: 180 *
+00006c70: 2070 6861 7365 202a 2031 652d 332f 6e70   phase * 1e-3/np
+00006c80: 2e70 690d 0a20 2020 2020 2020 2020 2020  .pi..           
+00006c90: 2020 2020 2020 2020 2066 6f72 206b 6579           for key
+00006ca0: 2c20 7068 6173 6520 696e 2070 6861 7365  , phase in phase
+00006cb0: 5f6f 626a 2e69 7465 6d73 2829 7d0d 0a20  _obj.items()}.. 
+00006cc0: 2020 2020 2020 2023 2063 6f6d 7075 7465         # compute
+00006cd0: 206a 7772 6f20 616e 6420 6a77 7068 6120   jwro and jwpha 
+00006ce0: 0d0a 2020 2020 2020 2020 2377 6520 6173  ..        #we as
+00006cf0: 7375 6d65 2074 6f20 7461 6b65 2077 6569  sume to take wei
+00006d00: 6768 7420 746f 2031 2e0d 0a20 2020 2020  ght to 1...     
+00006d10: 2020 206a 7761 7070 5f72 686f 203d 7b20     jwapp_rho ={ 
+00006d20: 6b65 793a 7661 6c75 6520 666f 7220 6b65  key:value for ke
+00006d30: 7920 2c0d 0a20 2020 2020 2020 2020 2020  y ,..           
+00006d40: 2020 2020 2020 2020 2076 616c 7565 2069           value i
+00006d50: 6e20 7a69 7028 7374 6174 696f 6e5f 6c69  n zip(station_li
+00006d60: 7374 2c20 0d0a 2020 2020 2020 2020 2020  st, ..          
+00006d70: 2020 2020 2020 2020 2020 205b 6e70 2e6f             [np.o
+00006d80: 6e65 7328 2873 656c 662e 4461 7461 5f73  nes((self.Data_s
+00006d90: 6563 7469 6f6e 2e46 7265 7175 656e 6379  ection.Frequency
+00006da0: 2e6e 756d 6672 6571 2c29 2c20 0d0a 2020  .numfreq,), ..  
+00006db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006dc0: 2020 2020 2020 2020 2020 2020 2064 7479               dty
+00006dd0: 7065 3d27 666c 6f61 7436 3427 2920 0d0a  pe='float64') ..
+00006de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006df0: 2020 2020 2020 666f 7220 6969 2069 6e20        for ii in 
+00006e00: 7261 6e67 6528 6c65 6e28 7374 6174 696f  range(len(statio
+00006e10: 6e5f 6c69 7374 2929 5d29 7d0d 0a20 2020  n_list))])}..   
+00006e20: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+00006e30: 6d70 6f72 7420 636f 7079 2020 2320 7573  mport copy  # us
+00006e40: 6520 6465 6570 2063 6f70 7920 746f 2063  e deep copy to c
+00006e50: 6f70 7920 7468 6520 7361 6d65 2077 6569  opy the same wei
+00006e60: 6768 7420 616e 6420 7265 2020 0d0a 2020  ght and re  ..  
+00006e70: 2020 2020 2020 6a77 7068 6120 3d20 636f        jwpha = co
+00006e80: 7079 2e64 6565 7063 6f70 7928 6a77 6170  py.deepcopy(jwap
+00006e90: 705f 7268 6f29 0d0a 2020 2020 2020 2020  p_rho)..        
+00006ea0: 0d0a 2020 2020 2020 2020 232d 2d2d 2d2d  ..        #-----
+00006eb0: 3e20 7374 6172 7469 6e67 2077 7269 7469  > starting writi
+00006ec0: 6e67 204a 6669 6c65 7320 3c2d 2d2d 2d2d  ng Jfiles <-----
+00006ed0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00006ee0: 2020 2023 2d2d 2d20 3e20 7374 6172 7420     #--- > start 
+00006ef0: 7772 6974 696e 6720 0d0a 2020 2020 2020  writing ..      
+00006f00: 2020 7772 6974 655f 6a6c 696e 6573 203d    write_jlines =
+00006f10: 5b5d 0d0a 2020 2020 2020 2020 6966 2073  []..        if s
+00006f20: 7572 7665 795f 6e61 6d65 2069 7320 4e6f  urvey_name is No
+00006f30: 6e65 203a 2063 6f64 655f 6e61 6d65 203d  ne : code_name =
+00006f40: 2027 6b73 7b30 3a30 327d 2d7b 317d 270d   'ks{0:02}-{1}'.
+00006f50: 0a20 2020 2020 2020 2065 6c69 6620 7375  .        elif su
+00006f60: 7276 6579 5f6e 616d 6520 6973 206e 6f74  rvey_name is not
+00006f70: 204e 6f6e 6520 3a20 636f 6465 5f6e 616d   None : code_nam
+00006f80: 6520 3d20 7375 7276 6579 5f6e 616d 655b  e = survey_name[
+00006f90: 3a2d 335d 2b27 7b30 3a30 327d 2d7b 317d  :-3]+'{0:02}-{1}
+00006fa0: 270d 0a20 2020 2020 2020 2063 6f64 6573  '..        codes
+00006fb0: 7061 6365 3d20 352a 2720 270d 0a20 2020  pace= 5*' '..   
+00006fc0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+00006fd0: 6620 7361 7665 7061 7468 2020 6973 204e  f savepath  is N
+00006fe0: 6f6e 6520 3a20 2320 6372 6561 7465 2061  one : # create a
+00006ff0: 2066 6f6c 6465 7220 696e 2079 6f75 7220   folder in your 
+00007000: 6375 7272 656e 7420 776f 726b 2064 6972  current work dir
+00007010: 6563 746f 7279 0d0a 2020 2020 2020 2020  ectory..        
+00007020: 2020 2074 7279 203a 0d0a 2020 2020 2020     try :..      
+00007030: 2020 2020 2020 2020 2073 6176 6570 6174           savepat
+00007040: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
+00007050: 286f 732e 6765 7463 7764 2829 2c20 275f  (os.getcwd(), '_
+00007060: 6f75 7470 7574 4a5f 2729 0d0a 2020 2020  outputJ_')..    
+00007070: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00007080: 7420 6f73 2e70 6174 682e 6973 6469 7228  t os.path.isdir(
+00007090: 7361 7665 7061 7468 293a 0d0a 2020 2020  savepath):..    
+000070a0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000070b0: 732e 6d6b 6469 7228 7361 7665 7061 7468  s.mkdir(savepath
+000070c0: 290d 0a20 2020 2020 2020 2020 2020 6578  )..           ex
+000070d0: 6365 7074 203a 200d 0a20 2020 2020 2020  cept : ..       
+000070e0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+000070f0: 2e77 6172 6e28 2249 7420 7365 656d 7320  .warn("It seems 
+00007100: 7468 6520 7061 7468 2061 6c72 6561 6479  the path already
+00007110: 2065 7869 7374 7320 2122 290d 0a20 2020   exists !")..   
+00007120: 2020 2020 200d 0a20 2020 2020 2020 2066       ..        f
+00007130: 6f72 2069 6920 2c20 7374 6e20 696e 2065  or ii , stn in e
+00007140: 6e75 6d65 7261 7465 2873 7461 7469 6f6e  numerate(station
+00007150: 5f6c 6973 7429 203a 200d 0a20 2020 2020  _list) : ..     
+00007160: 2020 2020 2020 2023 2d2d 203e 2077 7269         #-- > wri
+00007170: 7465 2048 6561 6420 6a20 0d0a 2020 2020  te Head j ..    
+00007180: 2020 2020 2020 2020 7772 6974 655f 6a6c          write_jl
+00007190: 696e 6573 2e61 7070 656e 6428 2727 2e6a  ines.append(''.j
+000071a0: 6f69 6e28 0d0a 2020 2020 2020 2020 2020  oin(..          
+000071b0: 2020 2020 2020 5b6a 5f6f 626a 2e4a 2e5f        [j_obj.J._
+000071c0: 636f 6d6d 656e 745f 6d61 726b 2c27 7b30  comment_mark,'{0
+000071d0: 3a7d 203a 272e 666f 726d 6174 286a 5f6f  :} :'.format(j_o
+000071e0: 626a 2e4a 2e6a 696e 666f 2e70 726f 6776  bj.J.jinfo.progv
+000071f0: 6572 7329 202c 200d 0a20 2020 2020 2020  ers) , ..       
+00007200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007210: 2063 6f64 655f 6e61 6d65 2e66 6f72 6d61   code_name.forma
+00007220: 7428 6969 2c20 7374 6174 696f 6e5f 6c69  t(ii, station_li
+00007230: 7374 5b69 695d 292c 2063 6f64 6573 7061  st[ii]), codespa
+00007240: 6365 2c20 0d0a 2020 2020 2020 2020 2020  ce, ..          
+00007250: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00007260: 7465 7469 6d65 2e6e 6f77 2829 2e73 7472  tetime.now().str
+00007270: 6674 696d 6528 6a5f 6f62 6a2e 4a2e 6a66  ftime(j_obj.J.jf
+00007280: 6d74 696d 6529 2c20 0d0a 2020 2020 2020  mtime), ..      
+00007290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000072a0: 2020 636f 6465 7370 6163 652c 2027 5245    codespace, 'RE
+000072b0: 4353 275d 292b 275c 6e27 290d 0a20 2020  CS'])+'\n')..   
+000072c0: 2020 2020 2020 2020 2023 2d2d 3e20 7772           #--> wr
+000072d0: 6974 6520 696e 666f 203a 200d 0a20 2020  ite info : ..   
+000072e0: 2020 2020 2020 2020 2069 6620 7772 6974           if writ
+000072f0: 655f 696e 666f 203a 200d 0a20 2020 2020  e_info : ..     
+00007300: 2020 2020 2020 2020 2020 2074 7279 203a             try :
+00007310: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007320: 2020 2020 2020 636f 756e 7465 725f 6272        counter_br
+00007330: 6561 6b3d 300d 0a20 2020 2020 2020 2020  eak=0..         
+00007340: 2020 2020 2020 2020 2020 206c 696e 6569             linei
+00007350: 6e66 6f3d 5b5d 0d0a 2020 2020 2020 2020  nfo=[]..        
+00007360: 2020 2020 2020 2020 2020 2020 232d 2d3e              #-->
+00007370: 2077 7269 7465 207a 6f6e 6765 4861 7264   write zongeHard
+00007380: 7761 7265 2069 6e66 6f73 200d 0a20 2020  ware infos ..   
+00007390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000073a0: 2066 6f72 207a 6f6e 6765 696e 666f 2069   for zongeinfo i
+000073b0: 6e20 5b73 656c 662e 4865 6164 6572 2e48  n [self.Header.H
+000073c0: 6172 6477 6172 6549 6e66 6f73 2e73 636f  ardwareInfos.sco
+000073d0: 6e66 6967 5f64 6963 742c 0d0a 2020 2020  nfig_dict,..    
+000073e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000073f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007400: 2020 7365 6c66 2e48 6561 6465 722e 5375    self.Header.Su
+00007410: 7276 6579 416e 6e6f 7461 7469 6f6e 2e73  rveyAnnotation.s
+00007420: 636f 6e66 6967 5f64 6963 742c 0d0a 2020  config_dict,..  
+00007430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007450: 2020 2020 7365 6c66 2e48 6561 6465 722e      self.Header.
+00007460: 5375 7276 6579 436f 6e66 6967 7572 6174  SurveyConfigurat
+00007470: 696f 6e2e 7363 6f6e 6669 675f 6469 6374  ion.sconfig_dict
+00007480: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00007490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074a0: 2020 2020 2020 2020 2073 656c 662e 4865           self.He
+000074b0: 6164 6572 2e54 782e 7363 6f6e 6669 675f  ader.Tx.sconfig_
+000074c0: 6469 6374 2c0d 0a20 2020 2020 2020 2020  dict,..         
+000074d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000074f0: 662e 4865 6164 6572 2e52 782e 7363 6f6e  f.Header.Rx.scon
+00007500: 6669 675f 6469 6374 5d3a 0d0a 2020 2020  fig_dict]:..    
+00007510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007520: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00007530: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00007540: 6e65 696e 666f 2e61 7070 656e 6428 6a5f  neinfo.append(j_
+00007550: 6f62 6a2e 4a2e 5f63 6f6d 6d65 6e74 5f6d  obj.J._comment_m
+00007560: 6172 6b29 0d0a 2020 2020 2020 2020 2020  ark)..          
+00007570: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00007580: 7220 6b65 7969 6e66 6f2c 2076 616c 7565  r keyinfo, value
+00007590: 696e 666f 2069 6e20 7a6f 6e67 6569 6e66  info in zongeinf
+000075a0: 6f2e 6974 656d 7328 293a 0d0a 2020 2020  o.items():..    
+000075b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000075c0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+000075d0: 7461 6e63 6528 7661 6c75 6569 6e66 6f2c  tance(valueinfo,
+000075e0: 206c 6973 7429 3a0d 0a20 2020 2020 2020   list):..       
 000075f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007600: 2073 656c 662e 4865 6164 6572 2e53 7572   self.Header.Sur
-00007610: 7665 7943 6f6e 6669 6775 7261 7469 6f6e  veyConfiguration
-00007620: 2e73 636f 6e66 6967 5f64 6963 742c 0d0a  .sconfig_dict,..
+00007600: 2020 2020 2020 2020 2076 616c 7565 696e           valuein
+00007610: 666f 203d 2027 272e 6a6f 696e 280d 0a20  fo = ''.join(.. 
+00007620: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00007630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007650: 2020 2020 2020 7365 6c66 2e48 6561 6465        self.Heade
-00007660: 722e 5478 2e73 636f 6e66 6967 5f64 6963  r.Tx.sconfig_dic
-00007670: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
-00007680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007690: 2020 2020 2020 2020 2020 7365 6c66 2e48            self.H
-000076a0: 6561 6465 722e 5278 2e73 636f 6e66 6967  eader.Rx.sconfig
-000076b0: 5f64 6963 745d 3a0d 0a20 2020 2020 2020  _dict]:..       
-000076c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000076d0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000076e0: 2020 2020 2020 2020 2020 206c 696e 6569             linei
-000076f0: 6e66 6f2e 6170 7065 6e64 286a 5f6f 626a  nfo.append(j_obj
-00007700: 2e4a 2e5f 636f 6d6d 656e 745f 6d61 726b  .J._comment_mark
-00007710: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00007720: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-00007730: 6579 696e 666f 2c20 7661 6c75 6569 6e66  eyinfo, valueinf
-00007740: 6f20 696e 207a 6f6e 6765 696e 666f 2e69  o in zongeinfo.i
-00007750: 7465 6d73 2829 3a0d 0a20 2020 2020 2020  tems():..       
+00007640: 2020 205b 7373 2066 6f72 2073 7320 696e     [ss for ss in
+00007650: 2076 616c 7565 696e 666f 2069 6620 7373   valueinfo if ss
+00007660: 2021 3d4e 6f6e 655d 290d 0a20 2020 2020   !=None])..     
+00007670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007680: 2020 2020 2020 2069 6620 274e 6f6e 6527         if 'None'
+00007690: 2069 6e20 7661 6c75 6569 6e66 6f3a 0d0a   in valueinfo:..
+000076a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000076b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000076c0: 7661 6c75 6569 6e66 6f3d 7661 6c75 6569  valueinfo=valuei
+000076d0: 6e66 6f2e 7265 706c 6163 6528 274e 6f6e  nfo.replace('Non
+000076e0: 6527 2c27 2a27 290d 0a20 2020 2020 2020  e','*')..       
+000076f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007700: 2020 2020 2069 6620 7661 6c75 6569 6e66       if valueinf
+00007710: 6f20 6973 206e 6f74 204e 6f6e 6520 3a20  o is not None : 
+00007720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007740: 2020 6c69 6e65 696e 666f 2e61 7070 656e    lineinfo.appen
+00007750: 6428 0d0a 2020 2020 2020 2020 2020 2020  d(..            
 00007760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007770: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00007780: 6365 2876 616c 7565 696e 666f 2c20 6c69  ce(valueinfo, li
-00007790: 7374 293a 0d0a 2020 2020 2020 2020 2020  st):..          
-000077a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077b0: 2020 2020 2020 7661 6c75 6569 6e66 6f20        valueinfo 
-000077c0: 3d20 2727 2e6a 6f69 6e28 0d0a 2020 2020  = ''.join(..    
-000077d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077f0: 5b73 7320 666f 7220 7373 2069 6e20 7661  [ss for ss in va
-00007800: 6c75 6569 6e66 6f20 6966 2073 7320 213d  lueinfo if ss !=
-00007810: 4e6f 6e65 5d29 0d0a 2020 2020 2020 2020  None])..        
-00007820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007830: 2020 2020 6966 2027 4e6f 6e65 2720 696e      if 'None' in
-00007840: 2076 616c 7565 696e 666f 3a0d 0a20 2020   valueinfo:..   
-00007850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007860: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00007870: 7565 696e 666f 3d76 616c 7565 696e 666f  ueinfo=valueinfo
-00007880: 2e72 6570 6c61 6365 2827 4e6f 6e65 272c  .replace('None',
-00007890: 272a 2729 0d0a 2020 2020 2020 2020 2020  '*')..          
-000078a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000078b0: 2020 6966 2076 616c 7565 696e 666f 2069    if valueinfo i
-000078c0: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
-000078d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000078e0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000078f0: 696e 6569 6e66 6f2e 6170 7065 6e64 280d  ineinfo.append(.
-00007900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007920: 2020 2020 2022 7b30 7d7b 313a 5e32 7d7b       "{0}{1:^2}{
-00007930: 327d 222e 666f 726d 6174 286b 6579 696e  2}".format(keyin
-00007940: 666f 2c27 3a27 2c76 616c 7565 696e 666f  fo,':',valueinfo
-00007950: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00007960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007970: 2020 2020 6c69 6e65 696e 666f 2e61 7070      lineinfo.app
-00007980: 656e 6428 277b 303a 335e 7d27 2e66 6f72  end('{0:3^}'.for
-00007990: 6d61 7428 272c 2729 290d 0a20 2020 2020  mat(','))..     
-000079a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000079b0: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
-000079c0: 6572 5f62 7265 616b 202b 3d31 200d 0a20  er_break +=1 .. 
-000079d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000079e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000079f0: 2d2d 3e20 676f 2074 6f20 6c69 6e65 2020  --> go to line  
-00007a00: 746f 206c 6574 2076 6973 6962 6c65 2069  to let visible i
-00007a10: 6e66 6f20 6f6e 0d0a 2020 2020 2020 2020  nfo on..        
-00007a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a30: 2020 2020 2020 2020 236a 6669 6c65 206d          #jfile m
-00007a40: 6f72 6520 7669 7369 626c 652e 0d0a 2020  ore visible...  
-00007a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a60: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00007a70: 2063 6f75 6e74 6572 5f62 7265 616b 3d3d   counter_break==
-00007a80: 3720 3a0d 0a20 2020 2020 2020 2020 2020  7 :..           
+00007770: 2020 2020 2020 2020 227b 307d 7b31 3a5e          "{0}{1:^
+00007780: 327d 7b32 7d22 2e66 6f72 6d61 7428 6b65  2}{2}".format(ke
+00007790: 7969 6e66 6f2c 273a 272c 7661 6c75 6569  yinfo,':',valuei
+000077a0: 6e66 6f29 290d 0a20 2020 2020 2020 2020  nfo))..         
+000077b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000077c0: 2020 2020 2020 206c 696e 6569 6e66 6f2e         lineinfo.
+000077d0: 6170 7065 6e64 2827 7b30 3a33 5e7d 272e  append('{0:3^}'.
+000077e0: 666f 726d 6174 2827 2c27 2929 0d0a 2020  format(','))..  
+000077f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007800: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00007810: 756e 7465 725f 6272 6561 6b20 2b3d 3120  unter_break +=1 
+00007820: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007840: 2020 232d 2d3e 2067 6f20 746f 206c 696e    #--> go to lin
+00007850: 6520 2074 6f20 6c65 7420 7669 7369 626c  e  to let visibl
+00007860: 6520 696e 666f 206f 6e0d 0a20 2020 2020  e info on..     
+00007870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007880: 2020 2020 2020 2020 2020 2023 6a66 696c             #jfil
+00007890: 6520 6d6f 7265 2076 6973 6962 6c65 2e0d  e more visible..
+000078a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000078b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000078c0: 2069 6620 636f 756e 7465 725f 6272 6561   if counter_brea
+000078d0: 6b3d 3d37 203a 0d0a 2020 2020 2020 2020  k==7 :..        
+000078e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000078f0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+00007900: 696e 666f 2e61 7070 656e 6428 275c 6e23  info.append('\n#
+00007910: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00007920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007930: 2020 2020 2020 2020 636f 756e 7465 725f          counter_
+00007940: 6272 6561 6b3d 300d 0a20 2020 2020 2020  break=0..       
+00007950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007960: 2063 6f75 6e74 6572 5f62 7265 616b 3d30   counter_break=0
+00007970: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00007980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007990: 2020 2020 2077 7269 7465 5f6a 6c69 6e65       write_jline
+000079a0: 732e 6170 7065 6e64 2827 272e 6a6f 696e  s.append(''.join
+000079b0: 286c 696e 6569 6e66 6f29 2b27 5c6e 2729  (lineinfo)+'\n')
+000079c0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000079d0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+000079e0: 696e 666f 3d5b 5d0d 0a0d 0a20 2020 2020  info=[]....     
+000079f0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00007a00: 7420 3a70 6173 7320 0d0a 2020 2020 200d  t :pass ..     .
+00007a10: 0a20 2020 2020 2020 2020 2020 2023 2d2d  .            #--
+00007a20: 2d20 3e20 7772 6974 6520 6a6c 6162 656c  - > write jlabel
+00007a30: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
+00007a40: 7772 6974 655f 6a6c 696e 6573 2e61 7070  write_jlines.app
+00007a50: 656e 6428 2727 2e6a 6f69 6e28 5b27 7b30  end(''.join(['{0
+00007a60: 3a3c 3133 7d27 2e66 6f72 6d61 7428 6a5f  :<13}'.format(j_
+00007a70: 6f62 6a2e 4a2e 5f6a 6c61 6265 6c73 5b30  obj.J._jlabels[0
+00007a80: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
 00007a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007aa0: 2020 2020 2020 2020 206c 696e 6569 6e66           lineinf
-00007ab0: 6f2e 6170 7065 6e64 2827 5c6e 2327 290d  o.append('\n#').
-00007ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007aa0: 2020 2020 2020 2020 2020 2020 2020 273d                '=
+00007ab0: 272c 2022 7b30 3a3e 3133 2e31 667d 222e  ', "{0:>13.1f}".
+00007ac0: 666f 726d 6174 280d 0a20 2020 2020 2020  format(..       
 00007ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ae0: 2020 2020 2063 6f75 6e74 6572 5f62 7265       counter_bre
-00007af0: 616b 3d30 0d0a 2020 2020 2020 2020 2020  ak=0..          
-00007b00: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00007b10: 756e 7465 725f 6272 6561 6b3d 3020 2020  unter_break=0   
-00007b20: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00007b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b40: 2020 7772 6974 655f 6a6c 696e 6573 2e61    write_jlines.a
-00007b50: 7070 656e 6428 2727 2e6a 6f69 6e28 6c69  ppend(''.join(li
-00007b60: 6e65 696e 666f 292b 275c 6e27 2920 200d  neinfo)+'\n')  .
-00007b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007b80: 2020 2020 2020 2020 206c 696e 6569 6e66           lineinf
-00007b90: 6f3d 5b5d 0d0a 0d0a 2020 2020 2020 2020  o=[]....        
-00007ba0: 2020 2020 2020 2020 6578 6365 7074 203a          except :
-00007bb0: 7061 7373 200d 0a20 2020 2020 0d0a 2020  pass ..     ..  
-00007bc0: 2020 2020 2020 2020 2020 232d 2d2d 203e            #--- >
-00007bd0: 2077 7269 7465 206a 6c61 6265 6c73 200d   write jlabels .
-00007be0: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
-00007bf0: 7465 5f6a 6c69 6e65 732e 6170 7065 6e64  te_jlines.append
-00007c00: 2827 272e 6a6f 696e 285b 277b 303a 3c31  (''.join(['{0:<1
-00007c10: 337d 272e 666f 726d 6174 286a 5f6f 626a  3}'.format(j_obj
-00007c20: 2e4a 2e5f 6a6c 6162 656c 735b 305d 292c  .J._jlabels[0]),
-00007c30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c50: 2020 2020 2020 2020 2020 2027 3d27 2c20             '=', 
-00007c60: 227b 303a 3e31 332e 3166 7d22 2e66 6f72  "{0:>13.1f}".for
-00007c70: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
-00007c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007af0: 2020 2020 2020 7369 7465 5f6f 626a 2e61        site_obj.a
+00007b00: 7a69 6d5b 7374 6e5d 292c 2027 5c6e 275d  zim[stn]), '\n']
+00007b10: 2029 290d 0a20 2020 2020 2020 2020 2020   ))..           
+00007b20: 2077 7269 7465 5f6a 6c69 6e65 732e 6170   write_jlines.ap
+00007b30: 7065 6e64 2827 272e 6a6f 696e 285b 277b  pend(''.join(['{
+00007b40: 303a 3c31 337d 272e 666f 726d 6174 286a  0:<13}'.format(j
+00007b50: 5f6f 626a 2e4a 2e5f 6a6c 6162 656c 735b  _obj.J._jlabels[
+00007b60: 315d 292c 0d0a 2020 2020 2020 2020 2020  1]),..          
+00007b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b80: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00007b90: 3d27 2c20 227b 303a 3e31 332e 3566 7d22  =', "{0:>13.5f}"
+00007ba0: 2e66 6f72 6d61 7428 0d0a 2020 2020 2020  .format(..      
+00007bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007bd0: 2020 2020 2020 2073 6974 655f 6f62 6a2e         site_obj.
+00007be0: 6c61 745b 7374 6e5d 292c 2027 5c6e 275d  lat[stn]), '\n']
+00007bf0: 2029 290d 0a20 2020 2020 2020 2020 2020   ))..           
+00007c00: 2077 7269 7465 5f6a 6c69 6e65 732e 6170   write_jlines.ap
+00007c10: 7065 6e64 2827 272e 6a6f 696e 285b 277b  pend(''.join(['{
+00007c20: 303a 3c31 337d 272e 666f 726d 6174 286a  0:<13}'.format(j
+00007c30: 5f6f 626a 2e4a 2e5f 6a6c 6162 656c 735b  _obj.J._jlabels[
+00007c40: 325d 292c 0d0a 2020 2020 2020 2020 2020  2]),..          
+00007c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c60: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00007c70: 3d27 2c20 227b 303a 3e31 332e 3566 7d22  =', "{0:>13.5f}"
+00007c80: 2e66 6f72 6d61 7428 0d0a 2020 2020 2020  .format(..      
 00007c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ca0: 2020 2073 6974 655f 6f62 6a2e 617a 696d     site_obj.azim
-00007cb0: 5b73 746e 5d29 2c20 275c 6e27 5d20 2929  [stn]), '\n'] ))
-00007cc0: 0d0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
-00007cd0: 6974 655f 6a6c 696e 6573 2e61 7070 656e  ite_jlines.appen
-00007ce0: 6428 2727 2e6a 6f69 6e28 5b27 7b30 3a3c  d(''.join(['{0:<
-00007cf0: 3133 7d27 2e66 6f72 6d61 7428 6a5f 6f62  13}'.format(j_ob
-00007d00: 6a2e 4a2e 5f6a 6c61 6265 6c73 5b31 5d29  j.J._jlabels[1])
-00007d10: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00007d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d30: 2020 2020 2020 2020 2020 2020 273d 272c              '=',
-00007d40: 2022 7b30 3a3e 3133 2e35 667d 222e 666f   "{0:>13.5f}".fo
-00007d50: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
-00007d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007cb0: 2020 2020 2020 2073 6974 655f 6f62 6a2e         site_obj.
+00007cc0: 6c6f 6e5b 7374 6e5d 292c 2027 5c6e 275d  lon[stn]), '\n']
+00007cd0: 2029 290d 0a20 2020 2020 2020 2020 2020   ))..           
+00007ce0: 2077 7269 7465 5f6a 6c69 6e65 732e 6170   write_jlines.ap
+00007cf0: 7065 6e64 2827 272e 6a6f 696e 285b 277b  pend(''.join(['{
+00007d00: 303a 3c31 337d 272e 666f 726d 6174 286a  0:<13}'.format(j
+00007d10: 5f6f 626a 2e4a 2e5f 6a6c 6162 656c 735b  _obj.J._jlabels[
+00007d20: 335d 292c 0d0a 2020 2020 2020 2020 2020  3]),..          
+00007d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d40: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00007d50: 3d27 2c20 227b 303a 3e31 332e 3166 7d22  =', "{0:>13.1f}"
+00007d60: 2e66 6f72 6d61 7428 0d0a 2020 2020 2020  .format(..      
 00007d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d80: 2020 2020 7369 7465 5f6f 626a 2e6c 6174      site_obj.lat
-00007d90: 5b73 746e 5d29 2c20 275c 6e27 5d20 2929  [stn]), '\n'] ))
-00007da0: 0d0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
-00007db0: 6974 655f 6a6c 696e 6573 2e61 7070 656e  ite_jlines.appen
-00007dc0: 6428 2727 2e6a 6f69 6e28 5b27 7b30 3a3c  d(''.join(['{0:<
-00007dd0: 3133 7d27 2e66 6f72 6d61 7428 6a5f 6f62  13}'.format(j_ob
-00007de0: 6a2e 4a2e 5f6a 6c61 6265 6c73 5b32 5d29  j.J._jlabels[2])
-00007df0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00007e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e10: 2020 2020 2020 2020 2020 2020 273d 272c              '=',
-00007e20: 2022 7b30 3a3e 3133 2e35 667d 222e 666f   "{0:>13.5f}".fo
-00007e30: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
+00007d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d90: 2020 2020 2020 2073 6974 655f 6f62 6a2e         site_obj.
+00007da0: 656c 6576 5b73 746e 5d29 2c20 275c 6e27  elev[stn]), '\n'
+00007db0: 5d20 2929 0d0a 2020 2020 2020 2020 2020  ] ))..          
+00007dc0: 2020 232d 2d2d 3e20 7772 6974 6520 6a6e    #---> write jn
+00007dd0: 616d 6573 202c 2063 6f6d 706f 6e65 6e74  ames , component
+00007de0: 7320 2061 6e64 206e 7065 7269 6f64 7320  s  and nperiods 
+00007df0: 0d0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
+00007e00: 6974 655f 6a6c 696e 6573 2e61 7070 656e  ite_jlines.appen
+00007e10: 6428 2727 2e6a 6f69 6e28 5b27 7b30 7d27  d(''.join(['{0}'
+00007e20: 2e66 6f72 6d61 7428 6a73 746e 6e61 6d65  .format(jstnname
+00007e30: 735b 6969 5d29 2c20 0d0a 2020 2020 2020  s[ii]), ..      
 00007e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00007e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e60: 2020 2020 7369 7465 5f6f 626a 2e6c 6f6e      site_obj.lon
-00007e70: 5b73 746e 5d29 2c20 275c 6e27 5d20 2929  [stn]), '\n'] ))
-00007e80: 0d0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
-00007e90: 6974 655f 6a6c 696e 6573 2e61 7070 656e  ite_jlines.appen
-00007ea0: 6428 2727 2e6a 6f69 6e28 5b27 7b30 3a3c  d(''.join(['{0:<
-00007eb0: 3133 7d27 2e66 6f72 6d61 7428 6a5f 6f62  13}'.format(j_ob
-00007ec0: 6a2e 4a2e 5f6a 6c61 6265 6c73 5b33 5d29  j.J._jlabels[3])
-00007ed0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00007ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ef0: 2020 2020 2020 2020 2020 2020 273d 272c              '=',
-00007f00: 2022 7b30 3a3e 3133 2e31 667d 222e 666f   "{0:>13.1f}".fo
-00007f10: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
-00007f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f40: 2020 2020 7369 7465 5f6f 626a 2e65 6c65      site_obj.ele
-00007f50: 765b 7374 6e5d 292c 2027 5c6e 275d 2029  v[stn]), '\n'] )
-00007f60: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
-00007f70: 2d2d 2d3e 2077 7269 7465 206a 6e61 6d65  ---> write jname
-00007f80: 7320 2c20 636f 6d70 6f6e 656e 7473 2020  s , components  
-00007f90: 616e 6420 6e70 6572 696f 6473 200d 0a20  and nperiods .. 
-00007fa0: 2020 2020 2020 2020 2020 2077 7269 7465             write
-00007fb0: 5f6a 6c69 6e65 732e 6170 7065 6e64 2827  _jlines.append('
-00007fc0: 272e 6a6f 696e 285b 277b 307d 272e 666f  '.join(['{0}'.fo
-00007fd0: 726d 6174 286a 7374 6e6e 616d 6573 5b69  rmat(jstnnames[i
-00007fe0: 695d 292c 200d 0a20 2020 2020 2020 2020  i]), ..         
-00007ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008010: 277b 303a 3e37 2e31 667d 272e 666f 726d  '{0:>7.1f}'.form
-00008020: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
-00008030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008050: 2020 7369 7465 5f6f 626a 2e61 7a69 6d5b    site_obj.azim[
-00008060: 7374 6e5d 292c 275c 6e27 5d29 290d 0a20  stn]),'\n'])).. 
-00008070: 2020 2020 2020 2020 2020 2077 7269 7465             write
-00008080: 5f6a 6c69 6e65 732e 6170 7065 6e64 2827  _jlines.append('
-00008090: 7b30 7d27 2e66 6f72 6d61 7428 6a63 6f6d  {0}'.format(jcom
-000080a0: 7029 2b27 5c6e 2729 0d0a 2020 2020 2020  p)+'\n')..      
-000080b0: 2020 2020 2020 7772 6974 655f 6a6c 696e        write_jlin
-000080c0: 6573 2e61 7070 656e 6428 2720 7b30 7d27  es.append(' {0}'
-000080d0: 2e66 6f72 6d61 7428 6a6e 7065 7269 6f64  .format(jnperiod
-000080e0: 292b 275c 6e27 290d 0a20 2020 2020 2020  )+'\n')..       
-000080f0: 2020 2020 2023 206e 6f77 2020 7772 6974       # now  writ
-00008100: 6520 7661 6c75 6520 3a0d 0a20 2020 2020  e value :..     
-00008110: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00008120: 2020 2020 2020 2020 2066 6f72 206a 6a20           for jj 
-00008130: 696e 2072 616e 6765 286a 6e70 6572 696f  in range(jnperio
-00008140: 6429 3a0d 0a0d 0a20 2020 2020 2020 2020  d):....         
-00008150: 2020 2020 2020 2077 7269 7465 5f6a 6c69         write_jli
-00008160: 6e65 732e 6170 7065 6e64 2028 2727 2e6a  nes.append (''.j
-00008170: 6f69 6e28 205b 0d0a 2020 2020 2020 2020  oin( [..        
-00008180: 2020 2020 2020 2020 2020 2020 277b 303a              '{0:
-00008190: 3c31 322e 3365 7d27 2e66 6f72 6d61 7428  <12.3e}'.format(
-000081a0: 6a70 6572 696f 645b 6a6a 5d29 2c20 0d0a  jperiod[jj]), ..
-000081b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000081c0: 2020 2020 277b 303a 5e31 322e 3365 7d27      '{0:^12.3e}'
-000081d0: 2e66 6f72 6d61 7428 6170 705f 7268 6f5f  .format(app_rho_
-000081e0: 6f62 6a20 5b73 746e 5d5b 6a6a 5d29 2c20  obj [stn][jj]), 
-000081f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008200: 2020 2020 2020 277b 303a 5e31 322e 3265        '{0:^12.2e
-00008210: 7d27 2e66 6f72 6d61 7428 7068 6173 655f  }'.format(phase_
-00008220: 6f62 6a5b 7374 6e5d 5b6a 6a5d 292c 200d  obj[stn][jj]), .
-00008230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008240: 2020 2020 2027 7b3a 5e31 322e 3365 7d27       '{:^12.3e}'
-00008250: 2e66 6f72 6d61 7428 6a61 7070 5f72 686f  .format(japp_rho
-00008260: 5f6d 6178 5b73 746e 5d5b 6a6a 5d29 2c20  _max[stn][jj]), 
-00008270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008280: 2020 2020 2020 277b 3a5e 3132 2e33 657d        '{:^12.3e}
-00008290: 272e 666f 726d 6174 286a 6170 705f 7268  '.format(japp_rh
-000082a0: 6f5f 6d69 6e5b 7374 6e5d 5b6a 6a5d 292c  o_min[stn][jj]),
-000082b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000082c0: 2020 2020 2020 2027 7b3a 5e31 322e 3265         '{:^12.2e
-000082d0: 7d27 2e66 6f72 6d61 7428 6a70 6861 7365  }'.format(jphase
-000082e0: 5f6d 6178 5b73 746e 5d5b 6a6a 5d29 2c20  _max[stn][jj]), 
-000082f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008300: 2020 2020 2020 277b 3a5e 3132 2e32 657d        '{:^12.2e}
-00008310: 272e 666f 726d 6174 286a 7068 6173 655f  '.format(jphase_
-00008320: 6d69 6e5b 7374 6e5d 5b6a 6a5d 292c 0d0a  min[stn][jj]),..
-00008330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008340: 2020 2020 277b 3a5e 372e 3266 7d27 2e66      '{:^7.2f}'.f
-00008350: 6f72 6d61 7428 6a77 6170 705f 7268 6f5b  ormat(jwapp_rho[
-00008360: 7374 6e5d 5b6a 6a5d 292c 200d 0a20 2020  stn][jj]), ..   
-00008370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008380: 2027 7b3a 5e37 2e32 667d 272e 666f 726d   '{:^7.2f}'.form
-00008390: 6174 286a 7770 6861 5b73 746e 5d5b 6a6a  at(jwpha[stn][jj
-000083a0: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
-000083b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083c0: 2020 2020 2020 2020 2020 205d 2929 0d0a             ]))..
-000083d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000083e0: 2020 7772 6974 655f 6a6c 696e 6573 2e61    write_jlines.a
-000083f0: 7070 656e 6428 275c 6e27 290d 0a20 2020  ppend('\n')..   
-00008400: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00008410: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00008420: 6f70 656e 2827 7b30 7d7b 317d 272e 666f  open('{0}{1}'.fo
-00008430: 726d 6174 2873 7461 7469 6f6e 5f6c 6973  rmat(station_lis
-00008440: 745b 6969 5d2c 6a5f 6578 7465 6e73 696f  t[ii],j_extensio
-00008450: 6e29 2c20 0d0a 2020 2020 2020 2020 2020  n), ..          
-00008460: 2020 2020 2020 2020 2020 2020 2777 272c              'w',
-00008470: 2065 6e63 6f64 696e 673d 2775 7466 3827   encoding='utf8'
-00008480: 2920 6173 2066 6a3a 0d0a 2020 2020 2020  ) as fj:..      
-00008490: 2020 2020 2020 2020 2020 666a 2e77 7269            fj.wri
-000084a0: 7465 6c69 6e65 7328 7772 6974 655f 6a6c  telines(write_jl
-000084b0: 696e 6573 2920 200d 0a20 2020 2020 2020  ines)  ..       
-000084c0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-000084d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000084e0: 2020 2020 2069 6620 7361 7665 7061 7468       if savepath
-000084f0: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
-00008500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008510: 2073 6875 7469 6c2e 6d6f 7665 2028 277b   shutil.move ('{
-00008520: 307d 7b31 7d27 2e66 6f72 6d61 7428 0d0a  0}{1}'.format(..
-00008530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008540: 2020 2020 7374 6174 696f 6e5f 6c69 7374      station_list
-00008550: 5b69 695d 2c6a 5f65 7874 656e 7369 6f6e  [ii],j_extension
-00008560: 292c 2073 6176 6570 6174 6829 0d0a 2020  ), savepath)..  
-00008570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085a0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-000085b0: 2020 2020 2020 2077 7269 7465 5f6a 6c69         write_jli
-000085c0: 6e65 733d 5b5d 2020 0d0a 2020 2020 2020  nes=[]  ..      
-000085d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000085e0: 2020 2020 0d0a 2020 2020 2020 2020 7072      ..        pr
-000085f0: 696e 7428 272d 272a 3737 2920 0d0a 2020  int('-'*77) ..  
-00008600: 2020 2020 2020 2320 6966 2073 6176 6570        # if savep
-00008610: 6174 6820 6973 204e 6f6e 6520 3a73 6176  ath is None :sav
-00008620: 6570 6174 6820 3d6f 732e 6765 7463 7764  epath =os.getcwd
-00008630: 2829 0d0a 2020 2020 2020 2020 7072 696e  ()..        prin
-00008640: 7428 272d 2d2d 3e20 7b30 7d20 4a2d 6669  t('---> {0} J-fi
-00008650: 6c65 7320 6861 7665 2062 6565 6e20 7265  les have been re
-00008660: 7772 6974 7465 6e2e 5c6e 2d2d 2d3e 2073  written.\n---> s
-00008670: 6565 2070 6174 683a 3c7b 317d 3e20 272e  ee path:<{1}> '.
-00008680: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
-00008690: 2066 6f72 6d61 7428 6c65 6e28 7374 6174   format(len(stat
-000086a0: 696f 6e5f 6c69 7374 292c 2073 6176 6570  ion_list), savep
-000086b0: 6174 6829 290d 0a20 2020 2020 2020 2070  ath))..        p
-000086c0: 7269 6e74 2827 2d27 2a37 3729 0d0a 2020  rint('-'*77)..  
-000086d0: 2020 2020 2020 0d0a 2020 2020 4064 6570        ..    @dep
-000086e0: 7265 6361 7465 6428 2255 7365 2060 7079  recated("Use `py
-000086f0: 6373 616d 742e 6666 2e63 6f72 652e 4353  csamt.ff.core.CS
-00008700: 414d 542e 6176 6732 6564 6920 6020 696e  AMT.avg2edi ` in
-00008710: 7374 6561 642e 2229 2020 2020 0d0a 2020  stead.")    ..  
-00008720: 2020 6465 6620 6176 675f 746f 5f65 6469    def avg_to_edi
-00008730: 6669 6c65 2028 7365 6c66 2c20 6461 7461  file (self, data
-00008740: 5f66 6e20 3d4e 6f6e 6520 2c20 7072 6f66  _fn =None , prof
-00008750: 696c 655f 666e 203d 4e6f 6e65 202c 200d  ile_fn =None , .
-00008760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008770: 2020 2020 2020 2020 2073 6176 6570 6174           savepat
-00008780: 6820 3d4e 6f6e 6520 2c20 6170 706c 795f  h =None , apply_
-00008790: 6669 6c74 6572 203d 4e6f 6e65 2c20 0d0a  filter =None, ..
-000087a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000087b0: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
-000087c0: 655f 6672 6571 7565 6e63 7920 3d4e 6f6e  e_frequency =Non
-000087d0: 652c 206e 756d 6265 725f 6f66 5f70 6f69  e, number_of_poi
-000087e0: 6e74 733d 372e 2c0d 0a20 2020 2020 2020  nts=7.,..       
-000087f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008800: 2064 6970 6f6c 655f 6c65 6e67 7468 3d35   dipole_length=5
-00008810: 302e 2c6e 756d 6265 725f 6f66 5f73 6b69  0.,number_of_ski
-00008820: 6e5f 6465 7074 683d 332e 2c20 2a2a 6b77  n_depth=3., **kw
-00008830: 6172 6773 293a 0d0a 2020 2020 2020 2020  args):..        
-00008840: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
-00008850: 686f 6420 746f 2077 7269 7465 2061 7667  hod to write avg
-00008860: 2066 696c 6520 746f 2053 4547 2d45 4449   file to SEG-EDI
-00008870: 6669 6c65 2e43 6f6e 7665 7274 2062 6f74  file.Convert bot
-00008880: 6820 6669 6c65 732e 4173 7461 7469 6320  h files.Astatic 
-00008890: 0d0a 2020 2020 2020 2020 6f72 2070 6c61  ..        or pla
-000088a0: 696e 7479 2061 7667 2066 696c 6520 2e69  inty avg file .i
-000088b0: 6620 4153 5441 5449 4320 6669 6c65 2069  f ASTATIC file i
-000088c0: 7320 7072 6f76 6964 6564 202c 2077 696c  s provided , wil
-000088d0: 6c20 6164 6420 7468 6520 6669 6c74 6572  l add the filter
-000088e0: 200d 0a20 2020 2020 2020 2061 6e64 2066   ..        and f
-000088f0: 696c 7465 7220 7661 6c75 6573 202e 6966  ilter values .if
-00008900: 2061 7667 2066 696c 6520 6973 206e 6f74   avg file is not
-00008910: 2061 7374 6174 6963 2066 696c 6520 2c20   astatic file , 
-00008920: 7573 6572 2061 6e20 6170 706c 790d 0a20  user an apply.. 
-00008930: 2020 2020 2020 2066 696c 7465 7220 6279         filter by
-00008940: 2073 6574 7469 6e67 2066 696c 7465 7220   setting filter 
-00008950: 746f 2022 746d 612c 2061 6d61 2c20 6f72  to "tma, ama, or
-00008960: 2066 6c6d 6122 2e4f 6e63 6520 6170 706c   flma".Once appl
-00008970: 7920 2c0d 0a20 2020 2020 2020 2065 6469  y ,..        edi
-00008980: 6669 6c65 7320 7769 6c6c 2065 7870 6f72  files will expor
-00008990: 7465 6420 6279 2063 6f6d 7075 7469 6e67  ted by computing
-000089a0: 2072 6573 6973 7469 7669 7469 6573 2066   resistivities f
-000089b0: 696c 7465 7265 640d 0a20 2020 2020 2020  iltered..       
-000089c0: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
-000089d0: 6574 6572 7320 0d0a 2020 2020 2020 2020  eters ..        
-000089e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-000089f0: 2020 2020 2020 2020 2a20 6461 7461 5f66          * data_f
-00008a00: 6e20 3a20 7374 7220 0d0a 2020 2020 2020  n : str ..      
-00008a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a20: 2020 6675 6c6c 2070 6174 6820 746f 2061    full path to a
-00008a30: 7667 6669 6c65 200d 0a20 2020 2020 2020  vgfile ..       
-00008a40: 2020 2020 202a 2073 6176 6570 6174 6820       * savepath 
-00008a50: 3a20 7374 7220 0d0a 2020 2020 2020 2020  : str ..        
-00008a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a70: 6f75 7464 6972 2074 6f20 7374 6f72 6520  outdir to store 
-00008a80: 6564 6966 696c 6573 2069 6620 4e6f 6e65  edifiles if None
-00008a90: 202c 0d0a 2020 2020 2020 2020 2020 2020   ,..            
-00008aa0: 2020 2020 2020 2020 2020 2020 6973 2079              is y
-00008ab0: 6f75 7220 6375 7272 656e 7420 776f 726b  our current work
-00008ac0: 2064 6972 6563 746f 7279 2020 2020 2020   directory      
-00008ad0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00008ae0: 2020 2020 2020 2020 2a20 7072 6f66 696c          * profil
-00008af0: 655f 666e 3a20 7374 7220 0d0a 2020 2020  e_fn: str ..    
-00008b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b10: 2020 2020 6675 6c6c 2070 6174 6820 2074      full path  t
-00008b20: 6f20 7374 6174 696f 6e20 5f70 726f 6669  o station _profi
-00008b30: 6c65 2066 696c 650d 0a20 2020 2020 2020  le file..       
-00008b40: 2020 2020 202a 2061 7070 6c79 5f66 696c       * apply_fil
-00008b50: 7465 723a 2073 7472 200d 0a20 2020 2020  ter: str ..     
-00008b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b70: 2020 2061 6464 2074 6865 206e 616d 6520     add the name 
-00008b80: 6f66 2066 696c 7465 7220 746f 2070 726f  of filter to pro
-00008b90: 6365 7373 2074 6865 0d0a 2020 2020 2020  cess the..      
-00008ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008bb0: 2020 6176 6720 6669 6c65 2065 7870 6f72    avg file expor
-00008bc0: 7465 6420 696e 2065 6469 6669 6c65 732e  ted in edifiles.
-00008bd0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00008be0: 2020 2020 2020 2020 2020 2063 616e 2062             can b
-00008bf0: 6520 205b 544d 4120 7c20 414d 417c 2046  e  [TMA | AMA| F
-00008c00: 4c4d 415d 0d0a 2020 2020 2020 2020 2020  LMA]..          
-00008c10: 2020 2020 2020 2020 2020 2020 2020 544d                TM
-00008c20: 4120 2d20 5472 696d 6d69 6e67 204d 6f76  A - Trimming Mov
-00008c30: 696e 6720 4176 6572 6167 650d 0a20 2020  ing Average..   
-00008c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c50: 2020 2020 2041 4d41 202d 2041 6461 7074       AMA - Adapt
-00008c60: 6174 6976 6520 4d6f 7669 6e67 2061 7661  ative Moving ava
-00008c70: 7261 6765 202c 200d 0a20 2020 2020 2020  rage , ..       
-00008c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c90: 2046 4c4d 4120 2d20 4669 7865 6420 6469   FLMA - Fixed di
-00008ca0: 706f 6c65 4c65 6e67 7468 206d 6f76 696e  poleLength movin
-00008cb0: 6720 0d0a 2020 2020 2020 2020 2020 2020  g ..            
-00008cc0: 2020 2020 2020 2020 2020 2020 6176 6572              aver
-00008cd0: 6167 6520 286e 756d 6265 7220 6f66 2070  age (number of p
-00008ce0: 6f69 6e74 3d37 290d 0a20 2020 2020 2020  oint=7)..       
-00008cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d00: 2044 6970 6f6c 656c 656e 6774 6820 7769   Dipolelength wi
-00008d10: 6c6c 6265 2063 6f6d 7075 7465 6420 6175  llbe computed au
-00008d20: 746f 6d61 7469 6361 6c6c 7920 0d0a 2020  tomatically ..  
-00008d30: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00008d40: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00008d50: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
-00008d60: 2020 2020 2020 206f 626a 2c20 6564 695f         obj, edi_
-00008d70: 6f62 6a20 200d 0a20 2020 2020 2020 2020  obj  ..         
-00008d80: 2020 2020 2020 2065 6469 206f 7574 7075         edi outpu
-00008d90: 7466 696c 6573 206f 7220 6564 6920 6669  tfiles or edi fi
-00008da0: 6c74 6572 6564 2066 696c 652e 0d0a 2020  ltered file...  
-00008db0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00008dc0: 2020 2020 486f 6c64 696e 6773 2061 6464      Holdings add
-00008dd0: 6974 696f 6e61 6c73 2070 6172 616d 6574  itionals paramet
-00008de0: 6572 7320 0d0a 2020 2020 2020 2020 2020  ers ..          
-00008df0: 2020 0d0a 2020 2020 2020 2020 3d3d 3d3d    ..        ====
-00008e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008e10: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d    ==========  ==
-00008e20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008e30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008e40: 3d3d 3d0d 0a20 2020 2020 2020 204f 7074  ===..        Opt
-00008e50: 696f 6e61 6c20 2020 2020 2020 2020 2020  ional           
-00008e60: 2020 2020 2054 7970 6520 2020 2020 2020       Type       
-00008e70: 2044 6573 6372 6970 7469 6f6e 2020 2020   Description    
-00008e80: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00008e90: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-00008ea0: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-00008eb0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-00008ec0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00008ed0: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
-00008ee0: 2020 2072 6566 6572 656e 6365 5f66 7265     reference_fre
-00008ef0: 7175 656e 6379 2020 2020 666c 6f61 7420  quency    float 
-00008f00: 2020 2020 2020 2066 7265 7175 656e 6379         frequency
-00008f10: 2061 7420 636c 6561 6e20 6461 7461 2e44   at clean data.D
-00008f20: 6566 6175 6c74 2069 7320 0d0a 2020 2020  efault is ..    
-00008f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007e60: 2020 2027 7b30 3a3e 372e 3166 7d27 2e66     '{0:>7.1f}'.f
+00007e70: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
+00007e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ea0: 2020 2020 2073 6974 655f 6f62 6a2e 617a       site_obj.az
+00007eb0: 696d 5b73 746e 5d29 2c27 5c6e 275d 2929  im[stn]),'\n']))
+00007ec0: 0d0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
+00007ed0: 6974 655f 6a6c 696e 6573 2e61 7070 656e  ite_jlines.appen
+00007ee0: 6428 277b 307d 272e 666f 726d 6174 286a  d('{0}'.format(j
+00007ef0: 636f 6d70 292b 275c 6e27 290d 0a20 2020  comp)+'\n')..   
+00007f00: 2020 2020 2020 2020 2077 7269 7465 5f6a           write_j
+00007f10: 6c69 6e65 732e 6170 7065 6e64 2827 207b  lines.append(' {
+00007f20: 307d 272e 666f 726d 6174 286a 6e70 6572  0}'.format(jnper
+00007f30: 696f 6429 2b27 5c6e 2729 0d0a 2020 2020  iod)+'\n')..    
+00007f40: 2020 2020 2020 2020 2320 6e6f 7720 2077          # now  w
+00007f50: 7269 7465 2076 616c 7565 203a 0d0a 2020  rite value :..  
+00007f60: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00007f70: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00007f80: 6a6a 2069 6e20 7261 6e67 6528 6a6e 7065  jj in range(jnpe
+00007f90: 7269 6f64 293a 0d0a 0d0a 2020 2020 2020  riod):....      
+00007fa0: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+00007fb0: 6a6c 696e 6573 2e61 7070 656e 6420 2827  jlines.append ('
+00007fc0: 272e 6a6f 696e 2820 5b0d 0a20 2020 2020  '.join( [..     
+00007fd0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00007fe0: 7b30 3a3c 3132 2e33 657d 272e 666f 726d  {0:<12.3e}'.form
+00007ff0: 6174 286a 7065 7269 6f64 5b6a 6a5d 292c  at(jperiod[jj]),
+00008000: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00008010: 2020 2020 2020 2027 7b30 3a5e 3132 2e33         '{0:^12.3
+00008020: 657d 272e 666f 726d 6174 2861 7070 5f72  e}'.format(app_r
+00008030: 686f 5f6f 626a 205b 7374 6e5d 5b6a 6a5d  ho_obj [stn][jj]
+00008040: 292c 200d 0a20 2020 2020 2020 2020 2020  ), ..           
+00008050: 2020 2020 2020 2020 2027 7b30 3a5e 3132           '{0:^12
+00008060: 2e32 657d 272e 666f 726d 6174 2870 6861  .2e}'.format(pha
+00008070: 7365 5f6f 626a 5b73 746e 5d5b 6a6a 5d29  se_obj[stn][jj])
+00008080: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00008090: 2020 2020 2020 2020 277b 3a5e 3132 2e33          '{:^12.3
+000080a0: 657d 272e 666f 726d 6174 286a 6170 705f  e}'.format(japp_
+000080b0: 7268 6f5f 6d61 785b 7374 6e5d 5b6a 6a5d  rho_max[stn][jj]
+000080c0: 292c 200d 0a20 2020 2020 2020 2020 2020  ), ..           
+000080d0: 2020 2020 2020 2020 2027 7b3a 5e31 322e           '{:^12.
+000080e0: 3365 7d27 2e66 6f72 6d61 7428 6a61 7070  3e}'.format(japp
+000080f0: 5f72 686f 5f6d 696e 5b73 746e 5d5b 6a6a  _rho_min[stn][jj
+00008100: 5d29 2c20 0d0a 2020 2020 2020 2020 2020  ]), ..          
+00008110: 2020 2020 2020 2020 2020 277b 3a5e 3132            '{:^12
+00008120: 2e32 657d 272e 666f 726d 6174 286a 7068  .2e}'.format(jph
+00008130: 6173 655f 6d61 785b 7374 6e5d 5b6a 6a5d  ase_max[stn][jj]
+00008140: 292c 200d 0a20 2020 2020 2020 2020 2020  ), ..           
+00008150: 2020 2020 2020 2020 2027 7b3a 5e31 322e           '{:^12.
+00008160: 3265 7d27 2e66 6f72 6d61 7428 6a70 6861  2e}'.format(jpha
+00008170: 7365 5f6d 696e 5b73 746e 5d5b 6a6a 5d29  se_min[stn][jj])
+00008180: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00008190: 2020 2020 2020 2027 7b3a 5e37 2e32 667d         '{:^7.2f}
+000081a0: 272e 666f 726d 6174 286a 7761 7070 5f72  '.format(jwapp_r
+000081b0: 686f 5b73 746e 5d5b 6a6a 5d29 2c20 0d0a  ho[stn][jj]), ..
+000081c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081d0: 2020 2020 277b 3a5e 372e 3266 7d27 2e66      '{:^7.2f}'.f
+000081e0: 6f72 6d61 7428 6a77 7068 615b 7374 6e5d  ormat(jwpha[stn]
+000081f0: 5b6a 6a5d 292c 0d0a 2020 2020 2020 2020  [jj]),..        
+00008200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008210: 2020 2020 2020 2020 2020 2020 2020 5d29                ])
+00008220: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00008230: 2020 2020 2077 7269 7465 5f6a 6c69 6e65       write_jline
+00008240: 732e 6170 7065 6e64 2827 5c6e 2729 0d0a  s.append('\n')..
+00008250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008260: 0d0a 2020 2020 2020 2020 2020 2020 7769  ..            wi
+00008270: 7468 206f 7065 6e28 277b 307d 7b31 7d27  th open('{0}{1}'
+00008280: 2e66 6f72 6d61 7428 7374 6174 696f 6e5f  .format(station_
+00008290: 6c69 7374 5b69 695d 2c6a 5f65 7874 656e  list[ii],j_exten
+000082a0: 7369 6f6e 292c 200d 0a20 2020 2020 2020  sion), ..       
+000082b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000082c0: 7727 2c20 656e 636f 6469 6e67 3d27 7574  w', encoding='ut
+000082d0: 6638 2729 2061 7320 666a 3a0d 0a20 2020  f8') as fj:..   
+000082e0: 2020 2020 2020 2020 2020 2020 2066 6a2e               fj.
+000082f0: 7772 6974 656c 696e 6573 2877 7269 7465  writelines(write
+00008300: 5f6a 6c69 6e65 7329 2020 0d0a 2020 2020  _jlines)  ..    
+00008310: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00008320: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00008330: 2020 2020 2020 2020 6966 2073 6176 6570          if savep
+00008340: 6174 6820 6973 206e 6f74 204e 6f6e 6520  ath is not None 
+00008350: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00008360: 2020 2020 7368 7574 696c 2e6d 6f76 6520      shutil.move 
+00008370: 2827 7b30 7d7b 317d 272e 666f 726d 6174  ('{0}{1}'.format
+00008380: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00008390: 2020 2020 2020 2073 7461 7469 6f6e 5f6c         station_l
+000083a0: 6973 745b 6969 5d2c 6a5f 6578 7465 6e73  ist[ii],j_extens
+000083b0: 696f 6e29 2c20 7361 7665 7061 7468 290d  ion), savepath).
+000083c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000083d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083f0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00008400: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+00008410: 6a6c 696e 6573 3d5b 5d20 200d 0a20 2020  jlines=[]  ..   
+00008420: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00008430: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00008440: 2070 7269 6e74 2827 2d27 2a37 3729 200d   print('-'*77) .
+00008450: 0a20 2020 2020 2020 2023 2069 6620 7361  .        # if sa
+00008460: 7665 7061 7468 2069 7320 4e6f 6e65 203a  vepath is None :
+00008470: 7361 7665 7061 7468 203d 6f73 2e67 6574  savepath =os.get
+00008480: 6377 6428 290d 0a20 2020 2020 2020 2070  cwd()..        p
+00008490: 7269 6e74 2827 2d2d 2d3e 207b 307d 204a  rint('---> {0} J
+000084a0: 2d66 696c 6573 2068 6176 6520 6265 656e  -files have been
+000084b0: 2072 6577 7269 7474 656e 2e5c 6e2d 2d2d   rewritten.\n---
+000084c0: 3e20 7365 6520 7061 7468 3a3c 7b31 7d3e  > see path:<{1}>
+000084d0: 2027 2e5c 0d0a 2020 2020 2020 2020 2020   '.\..          
+000084e0: 2020 2020 666f 726d 6174 286c 656e 2873      format(len(s
+000084f0: 7461 7469 6f6e 5f6c 6973 7429 2c20 7361  tation_list), sa
+00008500: 7665 7061 7468 2929 0d0a 2020 2020 2020  vepath))..      
+00008510: 2020 7072 696e 7428 272d 272a 3737 290d    print('-'*77).
+00008520: 0a20 2020 2020 2020 200d 0a20 2020 2040  .        ..    @
+00008530: 6465 7072 6563 6174 6564 2822 5573 6520  deprecated("Use 
+00008540: 6070 7963 7361 6d74 2e63 6f72 652e 4353  `pycsamt.core.CS
+00008550: 414d 542e 6176 6732 6564 6920 6020 696e  AMT.avg2edi ` in
+00008560: 7374 6561 642e 2229 2020 2020 0d0a 2020  stead.")    ..  
+00008570: 2020 6465 6620 6176 675f 746f 5f65 6469    def avg_to_edi
+00008580: 6669 6c65 2028 7365 6c66 2c20 6461 7461  file (self, data
+00008590: 5f66 6e20 3d4e 6f6e 6520 2c20 7072 6f66  _fn =None , prof
+000085a0: 696c 655f 666e 203d 4e6f 6e65 202c 200d  ile_fn =None , .
+000085b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000085c0: 2020 2020 2020 2020 2073 6176 6570 6174           savepat
+000085d0: 6820 3d4e 6f6e 6520 2c20 6170 706c 795f  h =None , apply_
+000085e0: 6669 6c74 6572 203d 4e6f 6e65 2c20 0d0a  filter =None, ..
+000085f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008600: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
+00008610: 655f 6672 6571 7565 6e63 7920 3d4e 6f6e  e_frequency =Non
+00008620: 652c 206e 756d 6265 725f 6f66 5f70 6f69  e, number_of_poi
+00008630: 6e74 733d 372e 2c0d 0a20 2020 2020 2020  nts=7.,..       
+00008640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008650: 2064 6970 6f6c 655f 6c65 6e67 7468 3d35   dipole_length=5
+00008660: 302e 2c6e 756d 6265 725f 6f66 5f73 6b69  0.,number_of_ski
+00008670: 6e5f 6465 7074 683d 332e 2c20 2a2a 6b77  n_depth=3., **kw
+00008680: 6172 6773 293a 0d0a 2020 2020 2020 2020  args):..        
+00008690: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
+000086a0: 686f 6420 746f 2077 7269 7465 2061 7667  hod to write avg
+000086b0: 2066 696c 6520 746f 2053 4547 2d45 4449   file to SEG-EDI
+000086c0: 6669 6c65 2e43 6f6e 7665 7274 2062 6f74  file.Convert bot
+000086d0: 6820 6669 6c65 732e 4173 7461 7469 6320  h files.Astatic 
+000086e0: 0d0a 2020 2020 2020 2020 6f72 2070 6c61  ..        or pla
+000086f0: 696e 7479 2061 7667 2066 696c 6520 2e69  inty avg file .i
+00008700: 6620 4153 5441 5449 4320 6669 6c65 2069  f ASTATIC file i
+00008710: 7320 7072 6f76 6964 6564 202c 2077 696c  s provided , wil
+00008720: 6c20 6164 6420 7468 6520 6669 6c74 6572  l add the filter
+00008730: 200d 0a20 2020 2020 2020 2061 6e64 2066   ..        and f
+00008740: 696c 7465 7220 7661 6c75 6573 202e 6966  ilter values .if
+00008750: 2061 7667 2066 696c 6520 6973 206e 6f74   avg file is not
+00008760: 2061 7374 6174 6963 2066 696c 6520 2c20   astatic file , 
+00008770: 7573 6572 2061 6e20 6170 706c 790d 0a20  user an apply.. 
+00008780: 2020 2020 2020 2066 696c 7465 7220 6279         filter by
+00008790: 2073 6574 7469 6e67 2066 696c 7465 7220   setting filter 
+000087a0: 746f 2022 746d 612c 2061 6d61 2c20 6f72  to "tma, ama, or
+000087b0: 2066 6c6d 6122 2e4f 6e63 6520 6170 706c   flma".Once appl
+000087c0: 7920 2c0d 0a20 2020 2020 2020 2065 6469  y ,..        edi
+000087d0: 6669 6c65 7320 7769 6c6c 2065 7870 6f72  files will expor
+000087e0: 7465 6420 6279 2063 6f6d 7075 7469 6e67  ted by computing
+000087f0: 2072 6573 6973 7469 7669 7469 6573 2066   resistivities f
+00008800: 696c 7465 7265 640d 0a20 2020 2020 2020  iltered..       
+00008810: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
+00008820: 6574 6572 7320 0d0a 2020 2020 2020 2020  eters ..        
+00008830: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00008840: 2020 2020 2020 2020 2a20 6461 7461 5f66          * data_f
+00008850: 6e20 3a20 7374 7220 0d0a 2020 2020 2020  n : str ..      
+00008860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008870: 2020 6675 6c6c 2070 6174 6820 746f 2061    full path to a
+00008880: 7667 6669 6c65 200d 0a20 2020 2020 2020  vgfile ..       
+00008890: 2020 2020 202a 2073 6176 6570 6174 6820       * savepath 
+000088a0: 3a20 7374 7220 0d0a 2020 2020 2020 2020  : str ..        
+000088b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000088c0: 6f75 7464 6972 2074 6f20 7374 6f72 6520  outdir to store 
+000088d0: 6564 6966 696c 6573 2069 6620 4e6f 6e65  edifiles if None
+000088e0: 202c 0d0a 2020 2020 2020 2020 2020 2020   ,..            
+000088f0: 2020 2020 2020 2020 2020 2020 6973 2079              is y
+00008900: 6f75 7220 6375 7272 656e 7420 776f 726b  our current work
+00008910: 2064 6972 6563 746f 7279 2020 2020 2020   directory      
+00008920: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00008930: 2020 2020 2020 2020 2a20 7072 6f66 696c          * profil
+00008940: 655f 666e 3a20 7374 7220 0d0a 2020 2020  e_fn: str ..    
+00008950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008960: 2020 2020 6675 6c6c 2070 6174 6820 2074      full path  t
+00008970: 6f20 7374 6174 696f 6e20 5f70 726f 6669  o station _profi
+00008980: 6c65 2066 696c 650d 0a20 2020 2020 2020  le file..       
+00008990: 2020 2020 202a 2061 7070 6c79 5f66 696c       * apply_fil
+000089a0: 7465 723a 2073 7472 200d 0a20 2020 2020  ter: str ..     
+000089b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089c0: 2020 2061 6464 2074 6865 206e 616d 6520     add the name 
+000089d0: 6f66 2066 696c 7465 7220 746f 2070 726f  of filter to pro
+000089e0: 6365 7373 2074 6865 0d0a 2020 2020 2020  cess the..      
+000089f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a00: 2020 6176 6720 6669 6c65 2065 7870 6f72    avg file expor
+00008a10: 7465 6420 696e 2065 6469 6669 6c65 732e  ted in edifiles.
+00008a20: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00008a30: 2020 2020 2020 2020 2020 2063 616e 2062             can b
+00008a40: 6520 205b 544d 4120 7c20 414d 417c 2046  e  [TMA | AMA| F
+00008a50: 4c4d 415d 0d0a 2020 2020 2020 2020 2020  LMA]..          
+00008a60: 2020 2020 2020 2020 2020 2020 2020 544d                TM
+00008a70: 4120 2d20 5472 696d 6d69 6e67 204d 6f76  A - Trimming Mov
+00008a80: 696e 6720 4176 6572 6167 650d 0a20 2020  ing Average..   
+00008a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008aa0: 2020 2020 2041 4d41 202d 2041 6461 7074       AMA - Adapt
+00008ab0: 6174 6976 6520 4d6f 7669 6e67 2061 7661  ative Moving ava
+00008ac0: 7261 6765 202c 200d 0a20 2020 2020 2020  rage , ..       
+00008ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ae0: 2046 4c4d 4120 2d20 4669 7865 6420 6469   FLMA - Fixed di
+00008af0: 706f 6c65 4c65 6e67 7468 206d 6f76 696e  poleLength movin
+00008b00: 6720 0d0a 2020 2020 2020 2020 2020 2020  g ..            
+00008b10: 2020 2020 2020 2020 2020 2020 6176 6572              aver
+00008b20: 6167 6520 286e 756d 6265 7220 6f66 2070  age (number of p
+00008b30: 6f69 6e74 3d37 290d 0a20 2020 2020 2020  oint=7)..       
+00008b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b50: 2044 6970 6f6c 656c 656e 6774 6820 7769   Dipolelength wi
+00008b60: 6c6c 6265 2063 6f6d 7075 7465 6420 6175  llbe computed au
+00008b70: 746f 6d61 7469 6361 6c6c 7920 0d0a 2020  tomatically ..  
+00008b80: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00008b90: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00008ba0: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
+00008bb0: 2020 2020 2020 206f 626a 2c20 6564 695f         obj, edi_
+00008bc0: 6f62 6a20 200d 0a20 2020 2020 2020 2020  obj  ..         
+00008bd0: 2020 2020 2020 2065 6469 206f 7574 7075         edi outpu
+00008be0: 7466 696c 6573 206f 7220 6564 6920 6669  tfiles or edi fi
+00008bf0: 6c74 6572 6564 2066 696c 652e 0d0a 2020  ltered file...  
+00008c00: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00008c10: 2020 2020 486f 6c64 696e 6773 2061 6464      Holdings add
+00008c20: 6974 696f 6e61 6c73 2070 6172 616d 6574  itionals paramet
+00008c30: 6572 7320 0d0a 2020 2020 2020 2020 2020  ers ..          
+00008c40: 2020 0d0a 2020 2020 2020 2020 3d3d 3d3d    ..        ====
+00008c50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008c60: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d    ==========  ==
+00008c70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008c80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008c90: 3d3d 3d0d 0a20 2020 2020 2020 204f 7074  ===..        Opt
+00008ca0: 696f 6e61 6c20 2020 2020 2020 2020 2020  ional           
+00008cb0: 2020 2020 2054 7970 6520 2020 2020 2020       Type       
+00008cc0: 2044 6573 6372 6970 7469 6f6e 2020 2020   Description    
+00008cd0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00008ce0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+00008cf0: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+00008d00: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+00008d10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008d20: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2020  =========..     
+00008d30: 2020 2072 6566 6572 656e 6365 5f66 7265     reference_fre
+00008d40: 7175 656e 6379 2020 2020 666c 6f61 7420  quency    float 
+00008d50: 2020 2020 2020 2066 7265 7175 656e 6379         frequency
+00008d60: 2061 7420 636c 6561 6e20 6461 7461 2e44   at clean data.D
+00008d70: 6566 6175 6c74 2069 7320 0d0a 2020 2020  efault is ..    
+00008d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008da0: 2020 2020 2020 2020 636f 6d70 7574 6564          computed
+00008db0: 2061 7574 6f6d 6174 6963 616c 6c79 0d0a   automatically..
+00008dc0: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+00008dd0: 665f 706f 696e 7473 3d37 2e20 2020 2069  f_points=7.    i
+00008de0: 6e74 2020 2020 2020 2020 2020 6e75 6d62  nt          numb
+00008df0: 6572 206f 6620 706f 696e 7420 746f 2066  er of point to f
+00008e00: 6f72 2077 6569 6768 7465 6420 200d 0a20  or weighted  .. 
+00008e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e30: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+00008e40: 772c 2e20 2a44 6566 6175 6c74 2a20 6973  w,. *Default* is
+00008e50: 2037 2e0d 0a20 2020 2020 2020 2064 6970   7...        dip
+00008e60: 6f6c 655f 6c65 6e67 7468 2020 2020 2020  ole_length      
+00008e70: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
+00008e80: 206c 656e 6774 6820 6f66 2064 6970 6f6c   length of dipol
+00008e90: 6520 696e 206d 6574 6572 2e20 466f 7220  e in meter. For 
+00008ea0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00008eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ec0: 2020 2020 2020 2020 2020 2020 2020 2043                 C
+00008ed0: 5341 4d54 2c20 2a44 6566 6175 6c74 2a20  SAMT, *Default* 
+00008ee0: 6973 2035 302e 0d0a 2020 2020 2020 2020  is 50...        
+00008ef0: 6e75 6d62 6572 5f6f 665f 736b 696e 5f64  number_of_skin_d
+00008f00: 6570 7468 2020 2066 6c6f 6174 2020 2020  epth   float    
+00008f10: 2020 2020 6e75 6d62 6572 206f 6620 736b      number of sk
+00008f20: 696e 5f64 6570 7468 2063 616e 2062 6520  in_depth can be 
+00008f30: 3120 746f 2031 300d 0a20 2020 2020 2020  1 to 10..       
 00008f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008f50: 2020 2020 2020 2020 636f 6d70 7574 6564          computed
-00008f60: 2061 7574 6f6d 6174 6963 616c 6c79 0d0a   automatically..
-00008f70: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-00008f80: 665f 706f 696e 7473 3d37 2e20 2020 2069  f_points=7.    i
-00008f90: 6e74 2020 2020 2020 2020 2020 6e75 6d62  nt          numb
-00008fa0: 6572 206f 6620 706f 696e 7420 746f 2066  er of point to f
-00008fb0: 6f72 2077 6569 6768 7465 6420 200d 0a20  or weighted  .. 
-00008fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fe0: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-00008ff0: 772c 2e20 2a44 6566 6175 6c74 2a20 6973  w,. *Default* is
-00009000: 2037 2e0d 0a20 2020 2020 2020 2064 6970   7...        dip
-00009010: 6f6c 655f 6c65 6e67 7468 2020 2020 2020  ole_length      
-00009020: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
-00009030: 206c 656e 6774 6820 6f66 2064 6970 6f6c   length of dipol
-00009040: 6520 696e 206d 6574 6572 2e20 466f 7220  e in meter. For 
-00009050: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00009060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009070: 2020 2020 2020 2020 2020 2020 2020 2043                 C
-00009080: 5341 4d54 2c20 2a44 6566 6175 6c74 2a20  SAMT, *Default* 
-00009090: 6973 2035 302e 0d0a 2020 2020 2020 2020  is 50...        
-000090a0: 6e75 6d62 6572 5f6f 665f 736b 696e 5f64  number_of_skin_d
-000090b0: 6570 7468 2020 2066 6c6f 6174 2020 2020  epth   float    
-000090c0: 2020 2020 6e75 6d62 6572 206f 6620 736b      number of sk
-000090d0: 696e 5f64 6570 7468 2063 616e 2062 6520  in_depth can be 
-000090e0: 3120 746f 2031 300d 0a20 2020 2020 2020  1 to 10..       
-000090f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009110: 2020 2020 2077 6865 6e20 7573 696e 6720       when using 
-00009120: 6669 6c74 6572 2041 4d41 2e20 0d0a 2020  filter AMA. ..  
-00009130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009150: 2020 2020 2020 2020 2020 2a44 6566 6175            *Defau
-00009160: 6c74 2a20 6973 2033 2e0d 0a20 2020 2020  lt* is 3...     
-00009170: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
-00009180: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-00009190: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-000091a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000091b0: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
-000091c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000091d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000091e0: 200d 0a20 2020 2020 2020 203a 4578 616d   ..        :Exam
-000091f0: 706c 653a 2020 200d 0a20 2020 2020 2020  ple:   ..       
-00009200: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00009210: 2020 203e 3e3e 2066 726f 6d20 7079 6373     >>> from pycs
-00009220: 616d 742e 6666 2e63 6f72 6520 696d 706f  amt.ff.core impo
-00009230: 7274 2061 7667 200d 0a20 2020 2020 2020  rt avg ..       
-00009240: 2020 2020 203e 3e3e 2061 7667 5f6f 626a       >>> avg_obj
-00009250: 3d20 6176 672e 4176 6728 290d 0a20 2020  = avg.Avg()..   
-00009260: 2020 2020 2020 2020 203e 3e3e 2061 7667           >>> avg
-00009270: 5f6f 626a 2e61 7667 5f74 6f5f 6564 6966  _obj.avg_to_edif
-00009280: 696c 6528 6461 7461 5f66 6e3d 206f 732e  ile(data_fn= os.
-00009290: 7061 7468 2e6a 6f69 6e28 0d0a 2020 2020  path.join(..    
-000092a0: 2020 2020 2020 2020 2e2e 2e20 2020 2070          ...    p
-000092b0: 6174 685f 746f 5f61 7667 6669 6c65 2c20  ath_to_avgfile, 
-000092c0: 6176 6766 696c 6529 202c 200d 0a20 2020  avgfile) , ..   
-000092d0: 2020 2020 2020 2020 202e 2e2e 2020 2020           ...    
-000092e0: 2020 2020 2020 2070 726f 6669 6c65 5f66         profile_f
-000092f0: 6e20 3d20 6f73 2e70 6174 682e 6a6f 696e  n = os.path.join
-00009300: 280d 0a20 2020 2020 2020 2020 2020 202e  (..            .
-00009310: 2e2e 2020 2020 7061 7468 5f74 6f5f 6176  ..    path_to_av
-00009320: 6766 696c 652c 2073 7461 7469 6f6e 5f70  gfile, station_p
-00009330: 726f 6669 6c65 5f66 696c 6529 2c20 0d0a  rofile_file), ..
-00009340: 2020 2020 2020 2020 2020 2020 2e2e 2e20              ... 
-00009350: 2020 2020 2020 2020 2020 7361 7665 7061            savepa
-00009360: 7468 203d 7361 7665 5f65 6469 7061 7468  th =save_edipath
-00009370: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00009380: 2e2e 2e20 2020 2020 2020 2020 2020 6170  ...           ap
-00009390: 706c 795f 6669 6c74 6572 3d4e 6f6e 6520  ply_filter=None 
-000093a0: 2920 0d0a 2020 2020 2020 2020 2222 220d  ) ..        """.
-000093b0: 0a20 2020 2020 2020 2023 2323 2323 2323  .        #######
-000093c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000093d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000093e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000093f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00009400: 0d0a 2020 2020 2020 2020 6672 6f6d 2070  ..        from p
-00009410: 7963 7361 6d74 2e66 662e 636f 7265 2e65  ycsamt.ff.core.e
-00009420: 6469 2069 6d70 6f72 7420 2845 6469 2c20  di import (Edi, 
-00009430: 486d 6561 7375 7265 6d65 6e74 2c20 456d  Hmeasurement, Em
-00009440: 6561 7375 7265 6d65 6e74 290d 0a20 2020  easurement)..   
-00009450: 2020 2020 2066 726f 6d20 7079 6373 616d       from pycsam
-00009460: 742e 6666 2e70 726f 6365 7373 696e 6720  t.ff.processing 
-00009470: 696d 706f 7274 2063 6f72 7220 0d0a 2020  import corr ..  
-00009480: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
-00009490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000094a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000094b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000094c0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-000094d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000094e0: 2075 746d 5f7a 6f6e 6520 3d20 6b77 6172   utm_zone = kwar
-000094f0: 6773 2e70 6f70 2827 7574 6d5f 7a6f 6e65  gs.pop('utm_zone
-00009500: 272c 204e 6f6e 6529 0d0a 2020 2020 2020  ', None)..      
-00009510: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
-00009520: 2020 2020 2020 6966 2064 6174 615f 666e        if data_fn
-00009530: 2069 7320 6e6f 7420 4e6f 6e65 203a 2073   is not None : s
-00009540: 656c 662e 6461 7461 5f66 6e20 3d20 6461  elf.data_fn = da
-00009550: 7461 5f66 6e20 0d0a 2020 2020 2020 2020  ta_fn ..        
-00009560: 6966 2073 656c 662e 6461 7461 5f66 6e20  if self.data_fn 
-00009570: 6973 204e 6f6e 6520 3a20 0d0a 2020 2020  is None : ..    
-00009580: 2020 2020 2020 2020 7261 6973 6520 4353          raise CS
-00009590: 6578 2e70 7943 5341 4d54 4572 726f 725f  ex.pyCSAMTError_
-000095a0: 6176 675f 6669 6c65 280d 0a20 2020 2020  avg_file(..     
-000095b0: 2020 2020 2020 2020 2020 2022 436f 756c             "Coul
-000095c0: 6420 6e6f 7420 6669 6e64 2061 6e79 2070  d not find any p
-000095d0: 6174 6820 746f 2072 6561 6420 2e22 0d0a  ath to read ."..
-000095e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095f0: 2250 6c65 6173 6520 7072 6f76 6964 6520  "Please provide 
-00009600: 796f 7572 2072 6967 6874 2041 5647 2066  your right AVG f
-00009610: 696c 652e 2229 0d0a 2020 2020 2020 2020  ile.")..        
-00009620: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00009630: 2020 2020 2320 6578 706f 7274 2074 6f20      # export to 
-00009640: 7361 7665 7061 7468 200d 0a20 2020 2020  savepath ..     
-00009650: 2020 2069 6620 7361 7665 7061 7468 2069     if savepath i
-00009660: 7320 4e6f 6e65 203a 2023 2063 7265 6174  s None : # creat
-00009670: 6520 6120 666f 6c64 6572 2069 6e20 796f  e a folder in yo
-00009680: 7572 2063 7572 7265 6e74 2077 6f72 6b20  ur current work 
-00009690: 6469 7265 6374 6f72 790d 0a20 2020 2020  directory..     
-000096a0: 2020 2020 2020 2074 7279 203a 0d0a 2020         try :..  
-000096b0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-000096c0: 7665 7061 7468 203d 206f 732e 7061 7468  vepath = os.path
-000096d0: 2e6a 6f69 6e28 6f73 2e67 6574 6377 6428  .join(os.getcwd(
-000096e0: 292c 2027 5f6f 7574 7075 7441 5647 3245  ), '_outputAVG2E
-000096f0: 4449 5f27 290d 0a20 2020 2020 2020 2020  DI_')..         
-00009700: 2020 2020 2020 2069 6620 6e6f 7420 6f73         if not os
-00009710: 2e70 6174 682e 6973 6469 7228 7361 7665  .path.isdir(save
-00009720: 7061 7468 293a 0d0a 2020 2020 2020 2020  path):..        
-00009730: 2020 2020 2020 2020 2020 2020 6f73 2e6d              os.m
-00009740: 6b64 6972 2873 6176 6570 6174 6829 2320  kdir(savepath)# 
-00009750: 206d 6f64 6520 3d30 6f36 3636 290d 0a20   mode =0o666).. 
-00009760: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00009770: 7420 3a20 0d0a 2020 2020 2020 2020 2020  t : ..          
-00009780: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00009790: 6172 6e28 2249 7420 7365 656d 7320 7468  arn("It seems th
-000097a0: 6520 7061 7468 2061 6c72 6561 6479 2065  e path already e
-000097b0: 7869 7374 7320 2122 290d 0a20 2020 2020  xists !")..     
-000097c0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-000097d0: 7072 6f66 696c 655f 666e 2069 7320 6e6f  profile_fn is no
-000097e0: 7420 4e6f 6e65 203a 2073 656c 662e 7072  t None : self.pr
-000097f0: 6f66 696c 655f 666e 203d 2070 726f 6669  ofile_fn = profi
-00009800: 6c65 5f66 6e20 0d0a 2020 2020 2020 2020  le_fn ..        
-00009810: 6966 2073 656c 662e 7072 6f66 696c 655f  if self.profile_
-00009820: 666e 2069 7320 4e6f 6e65 203a 200d 0a20  fn is None : .. 
-00009830: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-00009840: 6e67 732e 7761 726e 2028 274e 6f20 7374  ngs.warn ('No st
-00009850: 6174 696f 6e20 7072 6f66 696c 6520 6669  ation profile fi
-00009860: 6c65 2077 696c 6c20 6465 7465 6374 6564  le will detected
-00009870: 2e27 0d0a 2020 2020 2020 2020 2020 2020  .'..            
-00009880: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00009890: 2042 6520 6177 6172 6520 7375 7265 202c   Be aware sure ,
-000098a0: 2077 6520 7769 6c6c 2073 6574 206c 6f63   we will set loc
-000098b0: 6174 696f 6e20 6c6f 6e67 6974 7564 6520  ation longitude 
-000098c0: 2c27 0d0a 2020 2020 2020 2020 2020 2020  ,'..            
-000098d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098e0: 2020 2027 206c 6174 6974 7564 6520 616e     ' latitude an
-000098f0: 6420 656c 6576 6174 696f 6e20 746f 203c  d elevation to <
-00009900: 302e 3e27 290d 0a20 2020 2020 2020 200d  0.>')..        .
-00009910: 0a20 2020 2020 2020 2023 2072 6561 6420  .        # read 
-00009920: 6176 6720 6669 6c65 200d 0a20 2020 2020  avg file ..     
-00009930: 2020 2073 656c 662e 5f72 6561 645f 6176     self._read_av
-00009940: 675f 6669 6c65 2864 6174 615f 666e 3d73  g_file(data_fn=s
-00009950: 656c 662e 6461 7461 5f66 6e29 0d0a 2020  elf.data_fn)..  
-00009960: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00009970: 6966 2073 656c 662e 7072 6f66 696c 655f  if self.profile_
-00009980: 666e 2069 7320 6e6f 7420 4e6f 6e65 203a  fn is not None :
-00009990: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000099a0: 7369 7465 5f6f 626a 203d 2053 6974 6528  site_obj = Site(
-000099b0: 6461 7461 5f66 6e3d 7365 6c66 2e70 726f  data_fn=self.pro
-000099c0: 6669 6c65 5f66 6e2c 2075 746d 5f7a 6f6e  file_fn, utm_zon
-000099d0: 653d 7574 6d5f 7a6f 6e65 290d 0a20 2020  e=utm_zone)..   
-000099e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000099f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009a20: 0d0a 2020 2020 2020 2020 232d 2d2d 3e20  ..        #---> 
-00009a30: 6765 7420 7468 6520 6c69 7374 206f 6620  get the list of 
-00009a40: 7374 6174 696f 6e73 200d 0a20 2020 2020  stations ..     
-00009a50: 2020 2068 6561 645f 6461 7461 6964 5f6c     head_dataid_l
-00009a60: 6973 7420 3d20 736f 7274 6564 2873 656c  ist = sorted(sel
-00009a70: 662e 4461 7461 5f73 6563 7469 6f6e 2e53  f.Data_section.S
-00009a80: 7461 7469 6f6e 2e6e 616d 6573 290d 0a20  tation.names).. 
-00009a90: 2020 2020 2020 200d 0a0d 0a20 2020 2020         ....     
-00009aa0: 2020 2023 2d2d 2063 6f6d 7075 7465 2064     #-- compute d
-00009ab0: 6970 6f6c 6520 6c65 6e67 6874 2020 6265  ipole lenght  be
-00009ac0: 7477 6565 6e20 7374 6174 696f 6e20 636c  tween station cl
-00009ad0: 6f73 6520 0d0a 2020 2020 2020 2020 6469  ose ..        di
-00009ae0: 706f 6c65 5f6c 656e 6774 683d 2073 656c  pole_length= sel
-00009af0: 662e 4461 7461 5f73 6563 7469 6f6e 2e53  f.Data_section.S
-00009b00: 7461 7469 6f6e 2e6c 6f63 5b68 6561 645f  tation.loc[head_
-00009b10: 6461 7461 6964 5f6c 6973 7420 5b31 5d5d  dataid_list [1]]
-00009b20: 5b30 5d2d 5c0d 0a20 2020 2020 2020 2020  [0]-\..         
-00009b30: 2020 2073 656c 662e 4461 7461 5f73 6563     self.Data_sec
-00009b40: 7469 6f6e 2e53 7461 7469 6f6e 2e6c 6f63  tion.Station.loc
-00009b50: 5b68 6561 645f 6461 7461 6964 5f6c 6973  [head_dataid_lis
-00009b60: 745b 305d 5d5b 305d 0d0a 2020 2020 2020  t[0]][0]..      
-00009b70: 2020 0d0a 2020 2020 2020 2020 232d 2d3e    ..        #-->
-00009b80: 206e 6672 6571 7565 6e63 7920 3d20 0d0a   nfrequency = ..
-00009b90: 2020 2020 2020 2020 6e66 7265 7120 3d20          nfreq = 
-00009ba0: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
-00009bb0: 6e2e 4672 6571 7565 6e63 792e 7661 6c75  n.Frequency.valu
-00009bc0: 652e 7369 7a65 0d0a 2020 2020 2020 2020  e.size..        
-00009bd0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00009be0: 2020 2020 232d 2d2d 2d2d 2d2d 2d2d 2d2d      #-----------
-00009bf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009c00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009c20: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00009c30: 2020 232d 2d2d 3e20 636f 6d70 7574 6520    #---> compute 
-00009c40: 6572 726f 7220 7072 6f70 6167 6174 696f  error propagatio
-00009c50: 6e20 2c20 7068 6173 6520 616e 6420 7265  n , phase and re
-00009c60: 7369 7374 6976 6974 7920 0d0a 2020 2020  sistivity ..    
-00009c70: 2020 2020 6170 705f 7268 6f5f 6f62 6a20      app_rho_obj 
-00009c80: 3d20 7365 6c66 2e44 6174 615f 7365 6374  = self.Data_sect
-00009c90: 696f 6e2e 5265 7369 7374 6976 6974 792e  ion.Resistivity.
-00009ca0: 6c6f 6320 0d0a 0d0a 2020 2020 2020 2020  loc ....        
-00009cb0: 7068 6173 655f 6f62 6a20 3d20 7365 6c66  phase_obj = self
-00009cc0: 2e44 6174 615f 7365 6374 696f 6e2e 5068  .Data_section.Ph
-00009cd0: 6173 652e 6c6f 630d 0a20 2020 2020 2020  ase.loc..       
-00009ce0: 2065 6d61 675f 6f62 6a20 3d73 656c 662e   emag_obj =self.
-00009cf0: 4461 7461 5f73 6563 7469 6f6e 2e45 6d61  Data_section.Ema
-00009d00: 672e 6c6f 630d 0a20 2020 2020 2020 2068  g.loc..        h
-00009d10: 6d61 675f 6f62 6a20 3d73 656c 662e 4461  mag_obj =self.Da
-00009d20: 7461 5f73 6563 7469 6f6e 2e48 6d61 672e  ta_section.Hmag.
-00009d30: 6c6f 6320 0d0a 2020 2020 2020 2020 635f  loc ..        c_
-00009d40: 7661 725f 656d 6167 5f6f 626a 203d 2073  var_emag_obj = s
-00009d50: 656c 662e 4461 7461 5f73 6563 7469 6f6e  elf.Data_section
-00009d60: 2e70 6345 6d61 672e 6c6f 6320 0d0a 2020  .pcEmag.loc ..  
-00009d70: 2020 2020 2020 635f 7661 725f 686d 6167        c_var_hmag
-00009d80: 5f6f 626a 203d 2073 656c 662e 4461 7461  _obj = self.Data
-00009d90: 5f73 6563 7469 6f6e 2e70 6348 6d61 672e  _section.pcHmag.
-00009da0: 6c6f 630d 0a20 2020 2020 2020 2063 5f76  loc..        c_v
-00009db0: 6172 5f61 7070 5f72 686f 5f6f 626a 203d  ar_app_rho_obj =
-00009dc0: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
-00009dd0: 6e2e 7063 5268 6f2e 6c6f 630d 0a20 2020  n.pcRho.loc..   
-00009de0: 2020 2020 2073 7464 5f70 6861 7365 5f6f       std_phase_o
-00009df0: 626a 203d 7365 6c66 2e44 6174 615f 7365  bj =self.Data_se
-00009e00: 6374 696f 6e2e 7350 687a 2e6c 6f63 0d0a  ction.sPhz.loc..
-00009e10: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00009e20: 2020 2373 656c 662e 4865 6164 6572 2e48    #self.Header.H
-00009e30: 6172 6477 6172 6549 6e66 6f73 2e61 7374  ardwareInfos.ast
-00009e40: 6174 6963 5f76 6572 7369 6f6e 0d0a 2020  atic_version..  
-00009e50: 2020 2020 2020 2023 206d 616b 6572 2074         # maker t
-00009e60: 6f20 6368 6563 6b20 7768 6574 6865 7220  o check whether 
-00009e70: 6973 2070 6c61 696e 7479 2061 7667 2066  is plainty avg f
-00009e80: 696c 6520 6f72 2041 7374 6174 6963 2066  ile or Astatic f
-00009e90: 696c 6520 0d0a 2020 2020 2020 2020 4153  ile ..        AS
-00009ea0: 5f66 6c61 6720 3d30 2020 2020 2020 2020  _flag =0        
-00009eb0: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
-00009ec0: 6c66 2e48 6561 6465 722e 4861 7264 7761  lf.Header.Hardwa
-00009ed0: 7265 496e 666f 732e 6e75 6d66 696c 7465  reInfos.numfilte
-00009ee0: 7266 7265 7120 6973 206e 6f74 204e 6f6e  rfreq is not Non
-00009ef0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00009f00: 2023 2073 656c 662e 4865 6164 6572 2e48   # self.Header.H
-00009f10: 6172 6477 6172 6549 6e66 6f73 2e6e 756d  ardwareInfos.num
-00009f20: 6669 6c74 6572 6672 6571 2069 7320 6e6f  filterfreq is no
-00009f30: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
-00009f40: 2020 2020 2020 7072 696e 7428 272d 2d2d        print('---
-00009f50: 3e20 5265 6164 696e 6720 5a6f 6e67 6520  > Reading Zonge 
-00009f60: 6041 5354 4154 4943 6020 6669 6c65 2021  `ASTATIC` file !
-00009f70: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00009f80: 4153 5f72 686f 203d 7365 6c66 2e44 6174  AS_rho =self.Dat
-00009f90: 615f 7365 6374 696f 6e2e 5265 7369 7374  a_section.Resist
-00009fa0: 6976 6974 792e 6c6f 635f 5372 6573 0d0a  ivity.loc_Sres..
-00009fb0: 2020 2020 2020 2020 2020 2020 4153 5f66              AS_f
-00009fc0: 6c61 6720 3d31 0d0a 2020 2020 2020 2020  lag =1..        
-00009fd0: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
-00009fe0: 6372 6561 7465 2032 656d 7074 7920 2064  create 2empty  d
-00009ff0: 6963 7473 0d0a 2020 2020 2020 2020 6572  icts..        er
-0000a000: 726f 725f 7072 6f70 6167 5f72 686f 2c20  ror_propag_rho, 
-0000a010: 6572 726f 725f 7072 6f70 6167 5f70 6873  error_propag_phs
-0000a020: 203d 5b7b 7d20 666f 7220 6969 2069 6e20   =[{} for ii in 
-0000a030: 7261 6e67 6528 3229 5d20 0d0a 2020 2020  range(2)] ..    
-0000a040: 2020 2020 666f 7220 6b65 792c 2076 616c      for key, val
-0000a050: 7565 2069 6e20 7365 6c66 2e44 6174 615f  ue in self.Data_
-0000a060: 7365 6374 696f 6e2e 5265 7369 7374 6976  section.Resistiv
-0000a070: 6974 792e 6c6f 632e 6974 656d 7328 293a  ity.loc.items():
-0000a080: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
-0000a090: 7272 6f72 5f70 726f 7061 675f 7268 6f5b  rror_propag_rho[
-0000a0a0: 6b65 795d 3d20 6170 705f 7268 6f5f 6f62  key]= app_rho_ob
-0000a0b0: 6a5b 6b65 795d 202b 2031 2a20 5c0d 0a20  j[key] + 1* \.. 
-0000a0c0: 2020 2020 2020 2020 2020 2020 2020 205a                 Z
-0000a0d0: 6363 2e63 6f6d 7075 7465 5f73 6967 6d61  cc.compute_sigma
-0000a0e0: 735f 655f 685f 616e 645f 7369 676d 615f  s_e_h_and_sigma_
-0000a0f0: 7268 6f28 0d0a 2020 2020 2020 2020 2020  rho(..          
-0000a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a110: 2020 7063 5f65 6d61 673d 2063 5f76 6172    pc_emag= c_var
-0000a120: 5f65 6d61 675f 6f62 6a5b 6b65 795d 2c0d  _emag_obj[key],.
-0000a130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a140: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000a150: 635f 686d 6167 3d20 635f 7661 725f 686d  c_hmag= c_var_hm
-0000a160: 6167 5f6f 626a 5b6b 6579 5d20 2c0d 0a20  ag_obj[key] ,.. 
-0000a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a180: 2020 2020 2020 2020 2020 2020 2070 635f               pc_
-0000a190: 6170 705f 7268 6f3d 635f 7661 725f 6170  app_rho=c_var_ap
-0000a1a0: 705f 7268 6f5f 6f62 6a5b 6b65 795d 2c0d  p_rho_obj[key],.
-0000a1b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a1c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000a1d0: 7070 5f72 686f 3d20 6170 705f 7268 6f5f  pp_rho= app_rho_
-0000a1e0: 6f62 6a5b 6b65 795d 2c20 0d0a 2020 2020  obj[key], ..    
+00008f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008f60: 2020 2020 2077 6865 6e20 7573 696e 6720       when using 
+00008f70: 6669 6c74 6572 2041 4d41 2e20 0d0a 2020  filter AMA. ..  
+00008f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008fa0: 2020 2020 2020 2020 2020 2a44 6566 6175            *Defau
+00008fb0: 6c74 2a20 6973 2033 2e0d 0a20 2020 2020  lt* is 3...     
+00008fc0: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
+00008fd0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
+00008fe0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
+00008ff0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00009000: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
+00009010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009030: 200d 0a20 2020 2020 2020 203a 4578 616d   ..        :Exam
+00009040: 706c 653a 2020 200d 0a20 2020 2020 2020  ple:   ..       
+00009050: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00009060: 2020 203e 3e3e 2066 726f 6d20 7079 6373     >>> from pycs
+00009070: 616d 742e 636f 7265 2069 6d70 6f72 7420  amt.core import 
+00009080: 6176 6720 0d0a 2020 2020 2020 2020 2020  avg ..          
+00009090: 2020 3e3e 3e20 6176 675f 6f62 6a3d 2061    >>> avg_obj= a
+000090a0: 7667 2e41 7667 2829 0d0a 2020 2020 2020  vg.Avg()..      
+000090b0: 2020 2020 2020 3e3e 3e20 6176 675f 6f62        >>> avg_ob
+000090c0: 6a2e 6176 675f 746f 5f65 6469 6669 6c65  j.avg_to_edifile
+000090d0: 2864 6174 615f 666e 3d20 6f73 2e70 6174  (data_fn= os.pat
+000090e0: 682e 6a6f 696e 280d 0a20 2020 2020 2020  h.join(..       
+000090f0: 2020 2020 202e 2e2e 2020 2020 7061 7468       ...    path
+00009100: 5f74 6f5f 6176 6766 696c 652c 2061 7667  _to_avgfile, avg
+00009110: 6669 6c65 2920 2c20 0d0a 2020 2020 2020  file) , ..      
+00009120: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00009130: 2020 2020 7072 6f66 696c 655f 666e 203d      profile_fn =
+00009140: 206f 732e 7061 7468 2e6a 6f69 6e28 0d0a   os.path.join(..
+00009150: 2020 2020 2020 2020 2020 2020 2e2e 2e20              ... 
+00009160: 2020 2070 6174 685f 746f 5f61 7667 6669     path_to_avgfi
+00009170: 6c65 2c20 7374 6174 696f 6e5f 7072 6f66  le, station_prof
+00009180: 696c 655f 6669 6c65 292c 200d 0a20 2020  ile_file), ..   
+00009190: 2020 2020 2020 2020 202e 2e2e 2020 2020           ...    
+000091a0: 2020 2020 2020 2073 6176 6570 6174 6820         savepath 
+000091b0: 3d73 6176 655f 6564 6970 6174 682c 200d  =save_edipath, .
+000091c0: 0a20 2020 2020 2020 2020 2020 202e 2e2e  .            ...
+000091d0: 2020 2020 2020 2020 2020 2061 7070 6c79             apply
+000091e0: 5f66 696c 7465 723d 4e6f 6e65 2029 200d  _filter=None ) .
+000091f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00009200: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
+00009210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009240: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+00009250: 2020 2020 2020 2066 726f 6d20 7079 6373         from pycs
+00009260: 616d 742e 636f 7265 2e65 6469 2069 6d70  amt.core.edi imp
+00009270: 6f72 7420 2845 6469 2c20 486d 6561 7375  ort (Edi, Hmeasu
+00009280: 7265 6d65 6e74 2c20 456d 6561 7375 7265  rement, Emeasure
+00009290: 6d65 6e74 290d 0a20 2020 2020 2020 2066  ment)..        f
+000092a0: 726f 6d20 7079 6373 616d 742e 7072 6f63  rom pycsamt.proc
+000092b0: 6573 7369 6e67 2069 6d70 6f72 7420 636f  essing import co
+000092c0: 7272 200d 0a20 2020 2020 2020 2023 2323  rr ..        ###
+000092d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000092e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000092f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009310: 2323 2323 0d0a 2020 2020 2020 2020 0d0a  ####..        ..
+00009320: 2020 2020 2020 2020 7574 6d5f 7a6f 6e65          utm_zone
+00009330: 203d 206b 7761 7267 732e 706f 7028 2775   = kwargs.pop('u
+00009340: 746d 5f7a 6f6e 6527 2c20 4e6f 6e65 290d  tm_zone', None).
+00009350: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00009360: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+00009370: 6461 7461 5f66 6e20 6973 206e 6f74 204e  data_fn is not N
+00009380: 6f6e 6520 3a20 7365 6c66 2e64 6174 615f  one : self.data_
+00009390: 666e 203d 2064 6174 615f 666e 200d 0a20  fn = data_fn .. 
+000093a0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+000093b0: 6174 615f 666e 2069 7320 4e6f 6e65 203a  ata_fn is None :
+000093c0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+000093d0: 6169 7365 2041 5647 4572 726f 7228 0d0a  aise AVGError(..
+000093e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000093f0: 2243 6f75 6c64 206e 6f74 2066 696e 6420  "Could not find 
+00009400: 616e 7920 7061 7468 2074 6f20 7265 6164  any path to read
+00009410: 202e 220d 0a20 2020 2020 2020 2020 2020   ."..           
+00009420: 2020 2020 2022 506c 6561 7365 2070 726f       "Please pro
+00009430: 7669 6465 2079 6f75 7220 7269 6768 7420  vide your right 
+00009440: 4156 4720 6669 6c65 2e22 290d 0a20 2020  AVG file.")..   
+00009450: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
+00009460: 0a20 2020 2020 2020 2023 2065 7870 6f72  .        # expor
+00009470: 7420 746f 2073 6176 6570 6174 6820 0d0a  t to savepath ..
+00009480: 2020 2020 2020 2020 6966 2073 6176 6570          if savep
+00009490: 6174 6820 6973 204e 6f6e 6520 3a20 2320  ath is None : # 
+000094a0: 6372 6561 7465 2061 2066 6f6c 6465 7220  create a folder 
+000094b0: 696e 2079 6f75 7220 6375 7272 656e 7420  in your current 
+000094c0: 776f 726b 2064 6972 6563 746f 7279 0d0a  work directory..
+000094d0: 2020 2020 2020 2020 2020 2020 7472 7920              try 
+000094e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000094f0: 2020 2073 6176 6570 6174 6820 3d20 6f73     savepath = os
+00009500: 2e70 6174 682e 6a6f 696e 286f 732e 6765  .path.join(os.ge
+00009510: 7463 7764 2829 2c20 275f 6f75 7470 7574  tcwd(), '_output
+00009520: 4156 4732 4544 495f 2729 0d0a 2020 2020  AVG2EDI_')..    
+00009530: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00009540: 6f74 206f 732e 7061 7468 2e69 7364 6972  ot os.path.isdir
+00009550: 2873 6176 6570 6174 6829 3a0d 0a20 2020  (savepath):..   
+00009560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009570: 206f 732e 6d6b 6469 7228 7361 7665 7061   os.mkdir(savepa
+00009580: 7468 2923 2020 6d6f 6465 203d 306f 3636  th)#  mode =0o66
+00009590: 3629 0d0a 2020 2020 2020 2020 2020 2020  6)..            
+000095a0: 6578 6365 7074 203a 200d 0a20 2020 2020  except : ..     
+000095b0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+000095c0: 6e67 732e 7761 726e 2822 4974 2073 6565  ngs.warn("It see
+000095d0: 6d73 2074 6865 2070 6174 6820 616c 7265  ms the path alre
+000095e0: 6164 7920 6578 6973 7473 2021 2229 0d0a  ady exists !")..
+000095f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00009600: 2020 6966 2070 726f 6669 6c65 5f66 6e20    if profile_fn 
+00009610: 6973 206e 6f74 204e 6f6e 6520 3a20 7365  is not None : se
+00009620: 6c66 2e70 726f 6669 6c65 5f66 6e20 3d20  lf.profile_fn = 
+00009630: 7072 6f66 696c 655f 666e 200d 0a20 2020  profile_fn ..   
+00009640: 2020 2020 2069 6620 7365 6c66 2e70 726f       if self.pro
+00009650: 6669 6c65 5f66 6e20 6973 204e 6f6e 6520  file_fn is None 
+00009660: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00009670: 7761 726e 696e 6773 2e77 6172 6e20 2827  warnings.warn ('
+00009680: 4e6f 2073 7461 7469 6f6e 2070 726f 6669  No station profi
+00009690: 6c65 2066 696c 6520 7769 6c6c 2064 6574  le file will det
+000096a0: 6563 7465 642e 270d 0a20 2020 2020 2020  ected.'..       
+000096b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096c0: 2020 2020 2720 4265 2061 7761 7265 2073      ' Be aware s
+000096d0: 7572 6520 2c20 7765 2077 696c 6c20 7365  ure , we will se
+000096e0: 7420 6c6f 6361 7469 6f6e 206c 6f6e 6769  t location longi
+000096f0: 7475 6465 202c 270d 0a20 2020 2020 2020  tude ,'..       
+00009700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009710: 2020 2020 2020 2020 2720 6c61 7469 7475          ' latitu
+00009720: 6465 2061 6e64 2065 6c65 7661 7469 6f6e  de and elevation
+00009730: 2074 6f20 3c30 2e3e 2729 0d0a 2020 2020   to <0.>')..    
+00009740: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+00009750: 7265 6164 2061 7667 2066 696c 6520 0d0a  read avg file ..
+00009760: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
+00009770: 6164 5f61 7667 5f66 696c 6528 6461 7461  ad_avg_file(data
+00009780: 5f66 6e3d 7365 6c66 2e64 6174 615f 666e  _fn=self.data_fn
+00009790: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+000097a0: 2020 2020 2069 6620 7365 6c66 2e70 726f       if self.pro
+000097b0: 6669 6c65 5f66 6e20 6973 206e 6f74 204e  file_fn is not N
+000097c0: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
+000097d0: 2020 2020 2073 6974 655f 6f62 6a20 3d20       site_obj = 
+000097e0: 5369 7465 2864 6174 615f 666e 3d73 656c  Site(data_fn=sel
+000097f0: 662e 7072 6f66 696c 655f 666e 2c20 7574  f.profile_fn, ut
+00009800: 6d5f 7a6f 6e65 3d75 746d 5f7a 6f6e 6529  m_zone=utm_zone)
+00009810: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009850: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+00009860: 2d2d 2d3e 2067 6574 2074 6865 206c 6973  ---> get the lis
+00009870: 7420 6f66 2073 7461 7469 6f6e 7320 0d0a  t of stations ..
+00009880: 2020 2020 2020 2020 6865 6164 5f64 6174          head_dat
+00009890: 6169 645f 6c69 7374 203d 2073 6f72 7465  aid_list = sorte
+000098a0: 6428 7365 6c66 2e44 6174 615f 7365 6374  d(self.Data_sect
+000098b0: 696f 6e2e 5374 6174 696f 6e2e 6e61 6d65  ion.Station.name
+000098c0: 7329 0d0a 2020 2020 2020 2020 0d0a 0d0a  s)..        ....
+000098d0: 2020 2020 2020 2020 232d 2d20 636f 6d70          #-- comp
+000098e0: 7574 6520 6469 706f 6c65 206c 656e 6768  ute dipole lengh
+000098f0: 7420 2062 6574 7765 656e 2073 7461 7469  t  between stati
+00009900: 6f6e 2063 6c6f 7365 200d 0a20 2020 2020  on close ..     
+00009910: 2020 2064 6970 6f6c 655f 6c65 6e67 7468     dipole_length
+00009920: 3d20 7365 6c66 2e44 6174 615f 7365 6374  = self.Data_sect
+00009930: 696f 6e2e 5374 6174 696f 6e2e 6c6f 635b  ion.Station.loc[
+00009940: 6865 6164 5f64 6174 6169 645f 6c69 7374  head_dataid_list
+00009950: 205b 315d 5d5b 305d 2d5c 0d0a 2020 2020   [1]][0]-\..    
+00009960: 2020 2020 2020 2020 7365 6c66 2e44 6174          self.Dat
+00009970: 615f 7365 6374 696f 6e2e 5374 6174 696f  a_section.Statio
+00009980: 6e2e 6c6f 635b 6865 6164 5f64 6174 6169  n.loc[head_datai
+00009990: 645f 6c69 7374 5b30 5d5d 5b30 5d0d 0a20  d_list[0]][0].. 
+000099a0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000099b0: 2023 2d2d 3e20 6e66 7265 7175 656e 6379   #--> nfrequency
+000099c0: 203d 200d 0a20 2020 2020 2020 206e 6672   = ..        nfr
+000099d0: 6571 203d 2073 656c 662e 4461 7461 5f73  eq = self.Data_s
+000099e0: 6563 7469 6f6e 2e46 7265 7175 656e 6379  ection.Frequency
+000099f0: 2e76 616c 7565 2e73 697a 650d 0a20 2020  .value.size..   
+00009a00: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
+00009a10: 0a20 2020 2020 2020 2023 2d2d 2d2d 2d2d  .        #------
+00009a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20  -------------.. 
+00009a60: 2020 2020 2020 2023 2d2d 2d3e 2063 6f6d         #---> com
+00009a70: 7075 7465 2065 7272 6f72 2070 726f 7061  pute error propa
+00009a80: 6761 7469 6f6e 202c 2070 6861 7365 2061  gation , phase a
+00009a90: 6e64 2072 6573 6973 7469 7669 7479 200d  nd resistivity .
+00009aa0: 0a20 2020 2020 2020 2061 7070 5f72 686f  .        app_rho
+00009ab0: 5f6f 626a 203d 2073 656c 662e 4461 7461  _obj = self.Data
+00009ac0: 5f73 6563 7469 6f6e 2e52 6573 6973 7469  _section.Resisti
+00009ad0: 7669 7479 2e6c 6f63 200d 0a0d 0a20 2020  vity.loc ....   
+00009ae0: 2020 2020 2070 6861 7365 5f6f 626a 203d       phase_obj =
+00009af0: 2073 656c 662e 4461 7461 5f73 6563 7469   self.Data_secti
+00009b00: 6f6e 2e50 6861 7365 2e6c 6f63 0d0a 2020  on.Phase.loc..  
+00009b10: 2020 2020 2020 656d 6167 5f6f 626a 203d        emag_obj =
+00009b20: 7365 6c66 2e44 6174 615f 7365 6374 696f  self.Data_sectio
+00009b30: 6e2e 456d 6167 2e6c 6f63 0d0a 2020 2020  n.Emag.loc..    
+00009b40: 2020 2020 686d 6167 5f6f 626a 203d 7365      hmag_obj =se
+00009b50: 6c66 2e44 6174 615f 7365 6374 696f 6e2e  lf.Data_section.
+00009b60: 486d 6167 2e6c 6f63 200d 0a20 2020 2020  Hmag.loc ..     
+00009b70: 2020 2063 5f76 6172 5f65 6d61 675f 6f62     c_var_emag_ob
+00009b80: 6a20 3d20 7365 6c66 2e44 6174 615f 7365  j = self.Data_se
+00009b90: 6374 696f 6e2e 7063 456d 6167 2e6c 6f63  ction.pcEmag.loc
+00009ba0: 200d 0a20 2020 2020 2020 2063 5f76 6172   ..        c_var
+00009bb0: 5f68 6d61 675f 6f62 6a20 3d20 7365 6c66  _hmag_obj = self
+00009bc0: 2e44 6174 615f 7365 6374 696f 6e2e 7063  .Data_section.pc
+00009bd0: 486d 6167 2e6c 6f63 0d0a 2020 2020 2020  Hmag.loc..      
+00009be0: 2020 635f 7661 725f 6170 705f 7268 6f5f    c_var_app_rho_
+00009bf0: 6f62 6a20 3d73 656c 662e 4461 7461 5f73  obj =self.Data_s
+00009c00: 6563 7469 6f6e 2e70 6352 686f 2e6c 6f63  ection.pcRho.loc
+00009c10: 0d0a 2020 2020 2020 2020 7374 645f 7068  ..        std_ph
+00009c20: 6173 655f 6f62 6a20 3d73 656c 662e 4461  ase_obj =self.Da
+00009c30: 7461 5f73 6563 7469 6f6e 2e73 5068 7a2e  ta_section.sPhz.
+00009c40: 6c6f 630d 0a20 2020 2020 2020 200d 0a20  loc..        .. 
+00009c50: 2020 2020 2020 2023 7365 6c66 2e48 6561         #self.Hea
+00009c60: 6465 722e 4861 7264 7761 7265 496e 666f  der.HardwareInfo
+00009c70: 732e 6173 7461 7469 635f 7665 7273 696f  s.astatic_versio
+00009c80: 6e0d 0a20 2020 2020 2020 2020 2320 6d61  n..         # ma
+00009c90: 6b65 7220 746f 2063 6865 636b 2077 6865  ker to check whe
+00009ca0: 7468 6572 2069 7320 706c 6169 6e74 7920  ther is plainty 
+00009cb0: 6176 6720 6669 6c65 206f 7220 4173 7461  avg file or Asta
+00009cc0: 7469 6320 6669 6c65 200d 0a20 2020 2020  tic file ..     
+00009cd0: 2020 2041 535f 666c 6167 203d 3020 2020     AS_flag =0   
+00009ce0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00009cf0: 6966 2073 656c 662e 4865 6164 6572 2e48  if self.Header.H
+00009d00: 6172 6477 6172 6549 6e66 6f73 2e6e 756d  ardwareInfos.num
+00009d10: 6669 6c74 6572 6672 6571 2069 7320 6e6f  filterfreq is no
+00009d20: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
+00009d30: 2020 2020 2020 2320 7365 6c66 2e48 6561        # self.Hea
+00009d40: 6465 722e 4861 7264 7761 7265 496e 666f  der.HardwareInfo
+00009d50: 732e 6e75 6d66 696c 7465 7266 7265 7120  s.numfilterfreq 
+00009d60: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
+00009d70: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00009d80: 2827 2d2d 2d3e 2052 6561 6469 6e67 205a  ('---> Reading Z
+00009d90: 6f6e 6765 2060 4153 5441 5449 4360 2066  onge `ASTATIC` f
+00009da0: 696c 6520 2127 290d 0a20 2020 2020 2020  ile !')..       
+00009db0: 2020 2020 2041 535f 7268 6f20 3d73 656c       AS_rho =sel
+00009dc0: 662e 4461 7461 5f73 6563 7469 6f6e 2e52  f.Data_section.R
+00009dd0: 6573 6973 7469 7669 7479 2e6c 6f63 5f53  esistivity.loc_S
+00009de0: 7265 730d 0a20 2020 2020 2020 2020 2020  res..           
+00009df0: 2041 535f 666c 6167 203d 310d 0a20 2020   AS_flag =1..   
+00009e00: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00009e10: 2020 2023 2063 7265 6174 6520 3265 6d70     # create 2emp
+00009e20: 7479 2020 6469 6374 730d 0a20 2020 2020  ty  dicts..     
+00009e30: 2020 2065 7272 6f72 5f70 726f 7061 675f     error_propag_
+00009e40: 7268 6f2c 2065 7272 6f72 5f70 726f 7061  rho, error_propa
+00009e50: 675f 7068 7320 3d5b 7b7d 2066 6f72 2069  g_phs =[{} for i
+00009e60: 6920 696e 2072 616e 6765 2832 295d 200d  i in range(2)] .
+00009e70: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
+00009e80: 2c20 7661 6c75 6520 696e 2073 656c 662e  , value in self.
+00009e90: 4461 7461 5f73 6563 7469 6f6e 2e52 6573  Data_section.Res
+00009ea0: 6973 7469 7669 7479 2e6c 6f63 2e69 7465  istivity.loc.ite
+00009eb0: 6d73 2829 3a20 0d0a 2020 2020 2020 2020  ms(): ..        
+00009ec0: 2020 2020 6572 726f 725f 7072 6f70 6167      error_propag
+00009ed0: 5f72 686f 5b6b 6579 5d3d 2061 7070 5f72  _rho[key]= app_r
+00009ee0: 686f 5f6f 626a 5b6b 6579 5d20 2b20 312a  ho_obj[key] + 1*
+00009ef0: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+00009f00: 2020 2020 5a63 632e 636f 6d70 7574 655f      Zcc.compute_
+00009f10: 7369 676d 6173 5f65 5f68 5f61 6e64 5f73  sigmas_e_h_and_s
+00009f20: 6967 6d61 5f72 686f 280d 0a20 2020 2020  igma_rho(..     
+00009f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f40: 2020 2020 2020 2070 635f 656d 6167 3d20         pc_emag= 
+00009f50: 635f 7661 725f 656d 6167 5f6f 626a 5b6b  c_var_emag_obj[k
+00009f60: 6579 5d2c 0d0a 2020 2020 2020 2020 2020  ey],..          
+00009f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f80: 2020 2020 7063 5f68 6d61 673d 2063 5f76      pc_hmag= c_v
+00009f90: 6172 5f68 6d61 675f 6f62 6a5b 6b65 795d  ar_hmag_obj[key]
+00009fa0: 202c 0d0a 2020 2020 2020 2020 2020 2020   ,..            
+00009fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009fc0: 2020 7063 5f61 7070 5f72 686f 3d63 5f76    pc_app_rho=c_v
+00009fd0: 6172 5f61 7070 5f72 686f 5f6f 626a 5b6b  ar_app_rho_obj[k
+00009fe0: 6579 5d2c 0d0a 2020 2020 2020 2020 2020  ey],..          
+00009ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a000: 2020 2020 6170 705f 7268 6f3d 2061 7070      app_rho= app
+0000a010: 5f72 686f 5f6f 626a 5b6b 6579 5d2c 200d  _rho_obj[key], .
+0000a020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a030: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000a040: 6d61 673d 2065 6d61 675f 6f62 6a5b 6b65  mag= emag_obj[ke
+0000a050: 795d 2c0d 0a20 2020 2020 2020 2020 2020  y],..           
+0000a060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a070: 2020 2068 6d61 673d 686d 6167 5f6f 626a     hmag=hmag_obj
+0000a080: 5b6b 6579 5d29 5b2d 315d 0d0a 2020 2020  [key])[-1]..    
+0000a090: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0000a0a0: 2020 2020 2020 666f 7220 6b65 792c 2076        for key, v
+0000a0b0: 616c 7565 2069 6e20 7365 6c66 2e44 6174  alue in self.Dat
+0000a0c0: 615f 7365 6374 696f 6e2e 5068 6173 652e  a_section.Phase.
+0000a0d0: 6c6f 632e 6974 656d 7328 293a 200d 0a20  loc.items(): .. 
+0000a0e0: 2020 2020 2020 2020 2020 2023 2020 7374             #  st
+0000a0f0: 6420 3d20 7350 687a 202f 2031 3030 2023  d = sPhz / 100 #
+0000a100: 636f 6e76 6572 7465 6420 696e 2072 6164  converted in rad
+0000a110: 6961 6e73 0d0a 2020 2020 2020 2020 2020  ians..          
+0000a120: 2020 6572 726f 725f 7072 6f70 6167 5f70    error_propag_p
+0000a130: 6873 205b 6b65 795d 3d20 3138 3020 2a28  hs [key]= 180 *(
+0000a140: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000a150: 2020 2028 7374 645f 7068 6173 655f 6f62     (std_phase_ob
+0000a160: 6a5b 6b65 795d 2f31 3030 292f 3130 3030  j[key]/100)/1000
+0000a170: 292f 6e70 2e70 6920 0d0a 2020 0d0a 2020  )/np.pi ..  ..  
+0000a180: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000a190: 2363 6f6e 7665 7274 2070 6861 7365 206d  #convert phase m
+0000a1a0: 696c 6c69 7261 6420 7661 6c75 6520 696e  illirad value in
+0000a1b0: 2064 6567 7265 6520 3a20 0d0a 2020 2020   degree : ..    
+0000a1c0: 2020 2020 7068 6173 655f 6f62 6a20 3d7b      phase_obj ={
+0000a1d0: 6b65 793a 2031 3830 202a 2070 6861 7365  key: 180 * phase
+0000a1e0: 202a 2031 652d 332f 6e70 2e70 6920 0d0a   * 1e-3/np.pi ..
 0000a1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a200: 2020 2020 2020 2020 2020 656d 6167 3d20            emag= 
-0000a210: 656d 6167 5f6f 626a 5b6b 6579 5d2c 0d0a  emag_obj[key],..
-0000a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a230: 2020 2020 2020 2020 2020 2020 2020 686d                hm
-0000a240: 6167 3d68 6d61 675f 6f62 6a5b 6b65 795d  ag=hmag_obj[key]
-0000a250: 295b 2d31 5d0d 0a20 2020 2020 2020 2020  )[-1]..         
-0000a260: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000a270: 2066 6f72 206b 6579 2c20 7661 6c75 6520   for key, value 
-0000a280: 696e 2073 656c 662e 4461 7461 5f73 6563  in self.Data_sec
-0000a290: 7469 6f6e 2e50 6861 7365 2e6c 6f63 2e69  tion.Phase.loc.i
-0000a2a0: 7465 6d73 2829 3a20 0d0a 2020 2020 2020  tems(): ..      
-0000a2b0: 2020 2020 2020 2320 2073 7464 203d 2073        #  std = s
-0000a2c0: 5068 7a20 2f20 3130 3020 2363 6f6e 7665  Phz / 100 #conve
-0000a2d0: 7274 6564 2069 6e20 7261 6469 616e 730d  rted in radians.
-0000a2e0: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
-0000a2f0: 6f72 5f70 726f 7061 675f 7068 7320 5b6b  or_propag_phs [k
-0000a300: 6579 5d3d 2031 3830 202a 2820 0d0a 2020  ey]= 180 *( ..  
-0000a310: 2020 2020 2020 2020 2020 2020 2020 2873                (s
-0000a320: 7464 5f70 6861 7365 5f6f 626a 5b6b 6579  td_phase_obj[key
-0000a330: 5d2f 3130 3029 2f31 3030 3029 2f6e 702e  ]/100)/1000)/np.
-0000a340: 7069 200d 0a20 200d 0a20 2020 2020 2020  pi ..  ..       
-0000a350: 200d 0a20 2020 2020 2020 2023 636f 6e76   ..        #conv
-0000a360: 6572 7420 7068 6173 6520 6d69 6c6c 6972  ert phase millir
-0000a370: 6164 2076 616c 7565 2069 6e20 6465 6772  ad value in degr
-0000a380: 6565 203a 200d 0a20 2020 2020 2020 2070  ee : ..        p
-0000a390: 6861 7365 5f6f 626a 203d 7b6b 6579 3a20  hase_obj ={key: 
-0000a3a0: 3138 3020 2a20 7068 6173 6520 2a20 3165  180 * phase * 1e
-0000a3b0: 2d33 2f6e 702e 7069 200d 0a20 2020 2020  -3/np.pi ..     
-0000a3c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000a3d0: 6f72 206b 6579 2c20 7068 6173 6520 696e  or key, phase in
-0000a3e0: 2070 6861 7365 5f6f 626a 2e69 7465 6d73   phase_obj.items
-0000a3f0: 2829 7d0d 0a20 2020 200d 0a20 2020 2020  ()}..    ..     
-0000a400: 2020 2023 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     #------------
-0000a410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0000a440: 2d2d 2d0d 0a20 2020 2020 2020 2069 6620  ---..        if 
-0000a450: 6170 706c 795f 6669 6c74 6572 2069 7320  apply_filter is 
-0000a460: 6e6f 7420 4e6f 6e65 203a 0d0a 2020 2020  not None :..    
-0000a470: 2020 2020 2020 2020 7472 7920 3a0d 0a20          try :.. 
-0000a480: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000a490: 7070 6c79 5f66 696c 7465 723d 2061 7070  pply_filter= app
-0000a4a0: 6c79 5f66 696c 7465 722e 6c6f 7765 7228  ly_filter.lower(
-0000a4b0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0000a4c0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-0000a4d0: 2020 2020 2020 2020 7072 696e 7428 222d          print("-
-0000a4e0: 2d2d 3e20 4572 726f 7254 7970 653a 2046  --> ErrorType: F
-0000a4f0: 696c 7465 7273 2720 6e61 6d65 7320 6d75  ilters' names mu
-0000a500: 7374 2061 2073 7472 206f 6622 0d0a 2020  st a str of"..  
-0000a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a520: 2020 2020 2020 2020 2020 2020 2220 6074              " `t
-0000a530: 6d61 6020 6066 6c6d 6160 206f 7220 6061  ma` `flma` or `a
-0000a540: 6d61 602e 206e 6f74 207b 307d 222e 666f  ma`. not {0}".fo
-0000a550: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
-0000a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a570: 2020 2020 2020 2020 2074 7970 6528 6170           type(ap
-0000a580: 706c 795f 6669 6c74 6572 2929 290d 0a20  ply_filter))).. 
-0000a590: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-0000a5a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a5b0: 2077 6172 6e69 6e67 732e 7761 726e 2822   warnings.warn("
-0000a5c0: 5479 7065 4572 726f 7220 2c46 696c 7465  TypeError ,Filte
-0000a5d0: 7273 2720 6e61 6d65 7320 6d75 7374 2062  rs' names must b
-0000a5e0: 6520 6120 7374 7220 6f66 220d 0a20 2020  e a str of"..   
-0000a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a600: 2020 2020 2020 2020 2020 2022 2060 746d             " `tm
-0000a610: 6160 202c 6066 6c6d 6160 206f 7220 2060  a` ,`flma` or  `
-0000a620: 616d 6160 2e20 6e6f 7420 7b30 7d22 2e66  ama`. not {0}".f
-0000a630: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
-0000a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a650: 2020 2020 2020 2020 2020 7479 7065 2861            type(a
-0000a660: 7070 6c79 5f66 696c 7465 7229 2929 0d0a  pply_filter)))..
-0000a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a680: 6170 706c 795f 6669 6c74 6572 3d4e 6f6e  apply_filter=Non
-0000a690: 650d 0a20 2020 2020 2020 2020 2020 2065  e..            e
-0000a6a0: 6c73 6520 3a0d 0a20 2020 2020 2020 2020  lse :..         
-0000a6b0: 2020 2020 2020 2070 7269 6e74 2827 7b30         print('{0
-0000a6c0: 3a2d 5e37 377d 272e 666f 726d 6174 2827  :-^77}'.format('
-0000a6d0: 4669 6c74 6572 2049 6e66 6f73 2729 290d  Filter Infos')).
-0000a6e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a6f0: 2070 7269 6e74 2827 2a2a 207b 303a 3c32   print('** {0:<2
-0000a700: 377d 207b 317d 207b 327d 272e 666f 726d  7} {1} {2}'.form
-0000a710: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
-0000a720: 2020 2020 2020 2020 2027 4669 6c74 6572           'Filter
-0000a730: 2061 7070 6c69 6564 272c 2027 3d27 2c20   applied', '=', 
-0000a740: 6170 706c 795f 6669 6c74 6572 2e75 7070  apply_filter.upp
-0000a750: 6572 2829 2929 0d0a 2020 2020 2020 2020  er()))..        
-0000a760: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000a770: 2020 6966 2061 7070 6c79 5f66 696c 7465    if apply_filte
-0000a780: 7220 696e 205b 2761 6d61 272c 2027 746d  r in ['ama', 'tm
-0000a790: 6127 2c20 2766 6c6d 6127 5d3a 0d0a 2020  a', 'flma']:..  
-0000a7a0: 2020 2020 2020 2020 2020 2320 6372 6561            # crea
-0000a7b0: 7465 2070 726f 6365 7373 696e 675f 6f62  te processing_ob
-0000a7c0: 6a20 2c20 756e 6971 7565 206f 626a 2066  j , unique obj f
-0000a7d0: 6f72 2061 6c6c 2066 696c 7465 7273 2020  or all filters  
-0000a7e0: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-0000a7f0: 7272 5f6f 626a 3d20 636f 7272 2e73 6869  rr_obj= corr.shi
-0000a800: 6674 696e 6728 6461 7461 5f66 6e20 3d20  fting(data_fn = 
-0000a810: 7365 6c66 2e64 6174 615f 666e 2c0d 0a20  self.data_fn,.. 
-0000a820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a200: 2020 2020 666f 7220 6b65 792c 2070 6861      for key, pha
+0000a210: 7365 2069 6e20 7068 6173 655f 6f62 6a2e  se in phase_obj.
+0000a220: 6974 656d 7328 297d 0d0a 2020 2020 0d0a  items()}..    ..
+0000a230: 2020 2020 2020 2020 232d 2d2d 2d2d 2d2d          #-------
+0000a240: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a270: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0000a280: 2020 6966 2061 7070 6c79 5f66 696c 7465    if apply_filte
+0000a290: 7220 6973 206e 6f74 204e 6f6e 6520 3a0d  r is not None :.
+0000a2a0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+0000a2b0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0000a2c0: 2020 2020 6170 706c 795f 6669 6c74 6572      apply_filter
+0000a2d0: 3d20 6170 706c 795f 6669 6c74 6572 2e6c  = apply_filter.l
+0000a2e0: 6f77 6572 2829 0d0a 2020 2020 2020 2020  ower()..        
+0000a2f0: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+0000a300: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0000a310: 6e74 2822 2d2d 2d3e 2045 7272 6f72 5479  nt("---> ErrorTy
+0000a320: 7065 3a20 4669 6c74 6572 7327 206e 616d  pe: Filters' nam
+0000a330: 6573 206d 7573 7420 6120 7374 7220 6f66  es must a str of
+0000a340: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+0000a350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a360: 2022 2060 746d 6160 2060 666c 6d61 6020   " `tma` `flma` 
+0000a370: 6f72 2060 616d 6160 2e20 6e6f 7420 7b30  or `ama`. not {0
+0000a380: 7d22 2e66 6f72 6d61 7428 0d0a 2020 2020  }".format(..    
+0000a390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3a0: 2020 2020 2020 2020 2020 2020 2020 7479                ty
+0000a3b0: 7065 2861 7070 6c79 5f66 696c 7465 7229  pe(apply_filter)
+0000a3c0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0000a3d0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000a3e0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+0000a3f0: 6172 6e28 2254 7970 6545 7272 6f72 202c  arn("TypeError ,
+0000a400: 4669 6c74 6572 7327 206e 616d 6573 206d  Filters' names m
+0000a410: 7573 7420 6265 2061 2073 7472 206f 6622  ust be a str of"
+0000a420: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a440: 2220 6074 6d61 6020 2c60 666c 6d61 6020  " `tma` ,`flma` 
+0000a450: 6f72 2020 6061 6d61 602e 206e 6f74 207b  or  `ama`. not {
+0000a460: 307d 222e 666f 726d 6174 280d 0a20 2020  0}".format(..   
+0000a470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a480: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000a490: 7970 6528 6170 706c 795f 6669 6c74 6572  ype(apply_filter
+0000a4a0: 2929 290d 0a20 2020 2020 2020 2020 2020  )))..           
+0000a4b0: 2020 2020 2061 7070 6c79 5f66 696c 7465       apply_filte
+0000a4c0: 723d 4e6f 6e65 0d0a 2020 2020 2020 2020  r=None..        
+0000a4d0: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
+0000a4e0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0000a4f0: 7428 277b 303a 2d5e 3737 7d27 2e66 6f72  t('{0:-^77}'.for
+0000a500: 6d61 7428 2746 696c 7465 7220 496e 666f  mat('Filter Info
+0000a510: 7327 2929 0d0a 2020 2020 2020 2020 2020  s'))..          
+0000a520: 2020 2020 2020 7072 696e 7428 272a 2a20        print('** 
+0000a530: 7b30 3a3c 3237 7d20 7b31 7d20 7b32 7d27  {0:<27} {1} {2}'
+0000a540: 2e66 6f72 6d61 7428 0d0a 2020 2020 2020  .format(..      
+0000a550: 2020 2020 2020 2020 2020 2020 2020 2746                'F
+0000a560: 696c 7465 7220 6170 706c 6965 6427 2c20  ilter applied', 
+0000a570: 273d 272c 2061 7070 6c79 5f66 696c 7465  '=', apply_filte
+0000a580: 722e 7570 7065 7228 2929 290d 0a20 2020  r.upper()))..   
+0000a590: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+0000a5a0: 2020 2020 2020 2069 6620 6170 706c 795f         if apply_
+0000a5b0: 6669 6c74 6572 2069 6e20 5b27 616d 6127  filter in ['ama'
+0000a5c0: 2c20 2774 6d61 272c 2027 666c 6d61 275d  , 'tma', 'flma']
+0000a5d0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+0000a5e0: 2063 7265 6174 6520 7072 6f63 6573 7369   create processi
+0000a5f0: 6e67 5f6f 626a 202c 2075 6e69 7175 6520  ng_obj , unique 
+0000a600: 6f62 6a20 666f 7220 616c 6c20 6669 6c74  obj for all filt
+0000a610: 6572 7320 200d 0a20 2020 2020 2020 2020  ers  ..         
+0000a620: 2020 2063 6f72 725f 6f62 6a3d 2063 6f72     corr_obj= cor
+0000a630: 722e 7368 6966 7469 6e67 2864 6174 615f  r.shifting(data_
+0000a640: 666e 203d 2073 656c 662e 6461 7461 5f66  fn = self.data_f
+0000a650: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
+0000a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a670: 2020 2020 2020 2020 7072 6f66 696c 655f          profile_
+0000a680: 666e 3d73 656c 662e 7072 6f66 696c 655f  fn=self.profile_
+0000a690: 666e 290d 0a20 2020 2020 2020 2020 2020  fn)..           
+0000a6a0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000a6b0: 2020 2069 6620 6170 706c 795f 6669 6c74     if apply_filt
+0000a6c0: 6572 203d 3d27 746d 6127 3a0d 0a20 2020  er =='tma':..   
+0000a6d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000a6e0: 662e 5f6c 6f67 6769 6e67 2e69 6e66 6f20  f._logging.info 
+0000a6f0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0000a700: 2020 2020 2020 2027 436f 6d70 7574 696e         'Computin
+0000a710: 6720 2072 686f 2077 6974 6820 5472 696d  g  rho with Trim
+0000a720: 6d69 6e67 206d 6f76 696e 6720 6176 6572  ming moving aver
+0000a730: 6167 6520 2854 4d41 2920 6669 6c74 6572  age (TMA) filter
+0000a740: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+0000a750: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+0000a760: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000a770: 2063 6f72 725f 6f62 6a3d 2063 6f72 722e   corr_obj= corr.
+0000a780: 7368 6966 7469 6e67 2829 0d0a 2020 2020  shifting()..    
+0000a790: 2020 2020 2020 2020 2020 2020 7265 735f              res_
+0000a7a0: 544d 413d 2063 6f72 725f 6f62 6a2e 544d  TMA= corr_obj.TM
+0000a7b0: 4128 6e75 6d62 6572 5f6f 665f 544d 415f  A(number_of_TMA_
+0000a7c0: 706f 696e 7473 203d 6e75 6d62 6572 5f6f  points =number_o
+0000a7d0: 665f 706f 696e 7473 202c 200d 0a20 2020  f_points , ..   
+0000a7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a800: 2020 2072 6566 6572 656e 6365 5f66 7265     reference_fre
+0000a810: 713d 7265 6665 7265 6e63 655f 6672 6571  q=reference_freq
+0000a820: 7565 6e63 792c 200d 0a20 2020 2020 2020  uency, ..       
 0000a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a840: 2020 2070 726f 6669 6c65 5f66 6e3d 7365     profile_fn=se
-0000a850: 6c66 2e70 726f 6669 6c65 5f66 6e29 0d0a  lf.profile_fn)..
-0000a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a870: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000a880: 2061 7070 6c79 5f66 696c 7465 7220 3d3d   apply_filter ==
-0000a890: 2774 6d61 273a 0d0a 2020 2020 2020 2020  'tma':..        
-0000a8a0: 2020 2020 2020 2020 7365 6c66 2e5f 6c6f          self._lo
-0000a8b0: 6767 696e 672e 696e 666f 2028 0d0a 2020  gging.info (..  
-0000a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a8d0: 2020 2743 6f6d 7075 7469 6e67 2020 7268    'Computing  rh
-0000a8e0: 6f20 7769 7468 2054 7269 6d6d 696e 6720  o with Trimming 
-0000a8f0: 6d6f 7669 6e67 2061 7665 7261 6765 2028  moving average (
-0000a900: 544d 4129 2066 696c 7465 722e 2729 0d0a  TMA) filter.')..
+0000a840: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000a850: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a860: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000a870: 2020 2020 7265 6665 7265 6e63 655f 6672      reference_fr
+0000a880: 6571 7565 6e63 7920 3d63 6f72 725f 6f62  equency =corr_ob
+0000a890: 6a2e 7265 6665 7265 6e63 6566 7265 710d  j.referencefreq.
+0000a8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a8b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000a8c0: 2020 2070 7269 6e74 2827 2a2a 207b 303a     print('** {0:
+0000a8d0: 3c32 377d 207b 317d 207b 327d 272e 666f  <27} {1} {2}'.fo
+0000a8e0: 726d 6174 2827 544d 4120 6669 6c74 6572  rmat('TMA filter
+0000a8f0: 2070 6f69 6e74 7327 2c20 0d0a 2020 2020   points', ..    
+0000a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000a910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a920: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000a930: 2020 2020 2020 2020 2020 2320 636f 7272            # corr
-0000a940: 5f6f 626a 3d20 636f 7272 2e73 6869 6674  _obj= corr.shift
-0000a950: 696e 6728 290d 0a20 2020 2020 2020 2020  ing()..         
-0000a960: 2020 2020 2020 2072 6573 5f54 4d41 3d20         res_TMA= 
-0000a970: 636f 7272 5f6f 626a 2e54 4d41 286e 756d  corr_obj.TMA(num
-0000a980: 6265 725f 6f66 5f54 4d41 5f70 6f69 6e74  ber_of_TMA_point
-0000a990: 7320 3d6e 756d 6265 725f 6f66 5f70 6f69  s =number_of_poi
-0000a9a0: 6e74 7320 2c20 0d0a 2020 2020 2020 2020  nts , ..        
+0000a920: 2020 2020 2020 2020 2020 2020 2020 273d                '=
+0000a930: 272c 206e 756d 6265 725f 6f66 5f70 6f69  ', number_of_poi
+0000a940: 6e74 7329 290d 0a20 2020 2020 2020 2020  nts))..         
+0000a950: 2020 2020 2020 2070 7269 6e74 2827 2a2a         print('**
+0000a960: 207b 303a 3c32 377d 207b 317d 207b 327d   {0:<27} {1} {2}
+0000a970: 2048 7a2e 272e 666f 726d 6174 2827 5265   Hz.'.format('Re
+0000a980: 6665 7265 6e63 6520 6672 6571 7565 6e63  ference frequenc
+0000a990: 7927 2c0d 0a20 2020 2020 2020 2020 2020  y',..           
+0000a9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a9c0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000a9d0: 6665 7265 6e63 655f 6672 6571 3d72 6566  ference_freq=ref
-0000a9e0: 6572 656e 6365 5f66 7265 7175 656e 6379  erence_frequency
-0000a9f0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0000aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa10: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-0000aa20: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-0000aa30: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000aa40: 6566 6572 656e 6365 5f66 7265 7175 656e  eference_frequen
-0000aa50: 6379 203d 636f 7272 5f6f 626a 2e72 6566  cy =corr_obj.ref
-0000aa60: 6572 656e 6365 6672 6571 0d0a 2020 2020  erencefreq..    
-0000aa70: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0000aa80: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0000aa90: 696e 7428 272a 2a20 7b30 3a3c 3237 7d20  int('** {0:<27} 
-0000aaa0: 7b31 7d20 7b32 7d27 2e66 6f72 6d61 7428  {1} {2}'.format(
-0000aab0: 2754 4d41 2066 696c 7465 7220 706f 696e  'TMA filter poin
-0000aac0: 7473 272c 200d 0a20 2020 2020 2020 2020  ts', ..         
-0000aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aaf0: 2020 2020 2020 2020 2027 3d27 2c20 6e75           '=', nu
-0000ab00: 6d62 6572 5f6f 665f 706f 696e 7473 2929  mber_of_points))
-0000ab10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ab20: 2020 7072 696e 7428 272a 2a20 7b30 3a3c    print('** {0:<
-0000ab30: 3237 7d20 7b31 7d20 7b32 7d20 487a 2e27  27} {1} {2} Hz.'
-0000ab40: 2e66 6f72 6d61 7428 2752 6566 6572 656e  .format('Referen
-0000ab50: 6365 2066 7265 7175 656e 6379 272c 0d0a  ce frequency',..
-0000ab60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab90: 2020 2020 2020 273d 272c 2072 6566 6572        '=', refer
-0000aba0: 656e 6365 5f66 7265 7175 656e 6379 2929  ence_frequency))
-0000abb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000abc0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000abd0: 656c 6966 2061 7070 6c79 5f66 696c 7465  elif apply_filte
-0000abe0: 7220 3d3d 2766 6c6d 6127 3a0d 0a20 2020  r =='flma':..   
-0000abf0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000ac00: 662e 5f6c 6f67 6769 6e67 2e69 6e66 6f20  f._logging.info 
-0000ac10: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0000ac20: 2020 2020 2020 2027 436f 6d70 7574 696e         'Computin
-0000ac30: 6720 7268 6f20 7769 7468 2066 6978 6564  g rho with fixed
-0000ac40: 2d6c 656e 6774 6820 6d6f 7669 6e67 2061  -length moving a
-0000ac50: 7665 7261 6765 2028 464c 4d41 2920 6669  verage (FLMA) fi
-0000ac60: 6c74 6572 2e27 290d 0a20 2020 2020 0d0a  lter.')..     ..
-0000ac70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac80: 7265 735f 464c 4d41 203d 2063 6f72 725f  res_FLMA = corr_
-0000ac90: 6f62 6a2e 464c 4d41 286e 756d 6265 725f  obj.FLMA(number_
-0000aca0: 6f66 5f64 6970 6f6c 653d 6e75 6d62 6572  of_dipole=number
-0000acb0: 5f6f 665f 706f 696e 7473 2c20 0d0a 2020  _of_points, ..  
+0000a9c0: 2020 2020 2020 2020 2020 2027 3d27 2c20             '=', 
+0000a9d0: 7265 6665 7265 6e63 655f 6672 6571 7565  reference_freque
+0000a9e0: 6e63 7929 290d 0a20 2020 2020 2020 2020  ncy))..         
+0000a9f0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000aa00: 2020 2020 2065 6c69 6620 6170 706c 795f       elif apply_
+0000aa10: 6669 6c74 6572 203d 3d27 666c 6d61 273a  filter =='flma':
+0000aa20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000aa30: 2020 7365 6c66 2e5f 6c6f 6767 696e 672e    self._logging.
+0000aa40: 696e 666f 2028 0d0a 2020 2020 2020 2020  info (..        
+0000aa50: 2020 2020 2020 2020 2020 2020 2743 6f6d              'Com
+0000aa60: 7075 7469 6e67 2072 686f 2077 6974 6820  puting rho with 
+0000aa70: 6669 7865 642d 6c65 6e67 7468 206d 6f76  fixed-length mov
+0000aa80: 696e 6720 6176 6572 6167 6520 2846 4c4d  ing average (FLM
+0000aa90: 4129 2066 696c 7465 722e 2729 0d0a 2020  A) filter.')..  
+0000aaa0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000aab0: 2020 2020 2072 6573 5f46 4c4d 4120 3d20       res_FLMA = 
+0000aac0: 636f 7272 5f6f 626a 2e46 4c4d 4128 6e75  corr_obj.FLMA(nu
+0000aad0: 6d62 6572 5f6f 665f 6469 706f 6c65 3d6e  mber_of_dipole=n
+0000aae0: 756d 6265 725f 6f66 5f70 6f69 6e74 732c  umber_of_points,
+0000aaf0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000ab00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab10: 2020 2020 2020 2020 2020 2072 6566 6572             refer
+0000ab20: 656e 6365 5f66 7265 713d 7265 6665 7265  ence_freq=refere
+0000ab30: 6e63 655f 6672 6571 7565 6e63 7929 0d0a  nce_frequency)..
+0000ab40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ab60: 2020 6469 706f 6c65 6c65 6e67 7468 3d20    dipolelength= 
+0000ab70: 636f 7272 5f6f 626a 2e64 6970 6f6c 656c  corr_obj.dipolel
+0000ab80: 656e 6774 680d 0a20 2020 2020 2020 2020  ength..         
+0000ab90: 2020 2020 2020 2072 6566 6572 656e 6365         reference
+0000aba0: 5f66 7265 7175 656e 6379 203d 636f 7272  _frequency =corr
+0000abb0: 5f6f 626a 2e72 6566 6572 656e 6365 6672  _obj.referencefr
+0000abc0: 6571 0d0a 0d0a 2020 2020 2020 2020 2020  eq....          
+0000abd0: 2020 2020 2020 7072 696e 7428 272a 2a20        print('** 
+0000abe0: 7b30 3a3c 3237 7d20 7b31 7d20 7b32 7d27  {0:<27} {1} {2}'
+0000abf0: 2e66 6f72 6d61 7428 2746 4c4d 4120 6669  .format('FLMA fi
+0000ac00: 6c74 6572 2070 6f69 6e74 7327 2c0d 0a20  lter points',.. 
+0000ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac40: 2027 3d27 2c20 6e75 6d62 6572 5f6f 665f   '=', number_of_
+0000ac50: 706f 696e 7473 2929 0d0a 2020 2020 2020  points))..      
+0000ac60: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0000ac70: 272a 2a20 7b30 3a3c 3237 7d20 7b31 7d20  '** {0:<27} {1} 
+0000ac80: 7b32 7d20 487a 2e27 2e66 6f72 6d61 7428  {2} Hz.'.format(
+0000ac90: 2752 6566 6572 656e 6365 2066 7265 7175  'Reference frequ
+0000aca0: 656e 6379 272c 0d0a 2020 2020 2020 2020  ency',..        
+0000acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000acc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000acd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ace0: 2020 2020 2020 7265 6665 7265 6e63 655f        reference_
-0000acf0: 6672 6571 3d72 6566 6572 656e 6365 5f66  freq=reference_f
-0000ad00: 7265 7175 656e 6379 290d 0a20 2020 2020  requency)..     
-0000ad10: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000ad20: 2020 2020 2020 2020 2020 2020 2064 6970               dip
-0000ad30: 6f6c 656c 656e 6774 683d 2063 6f72 725f  olelength= corr_
-0000ad40: 6f62 6a2e 6469 706f 6c65 6c65 6e67 7468  obj.dipolelength
-0000ad50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ad60: 2020 7265 6665 7265 6e63 655f 6672 6571    reference_freq
-0000ad70: 7565 6e63 7920 3d63 6f72 725f 6f62 6a2e  uency =corr_obj.
-0000ad80: 7265 6665 7265 6e63 6566 7265 710d 0a0d  referencefreq...
-0000ad90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ada0: 2070 7269 6e74 2827 2a2a 207b 303a 3c32   print('** {0:<2
-0000adb0: 377d 207b 317d 207b 327d 272e 666f 726d  7} {1} {2}'.form
-0000adc0: 6174 2827 464c 4d41 2066 696c 7465 7220  at('FLMA filter 
-0000add0: 706f 696e 7473 272c 0d0a 2020 2020 2020  points',..      
-0000ade0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae00: 2020 2020 2020 2020 2020 2020 273d 272c              '=',
-0000ae10: 206e 756d 6265 725f 6f66 5f70 6f69 6e74   number_of_point
-0000ae20: 7329 290d 0a20 2020 2020 2020 2020 2020  s))..           
-0000ae30: 2020 2020 2070 7269 6e74 2827 2a2a 207b       print('** {
-0000ae40: 303a 3c32 377d 207b 317d 207b 327d 2048  0:<27} {1} {2} H
-0000ae50: 7a2e 272e 666f 726d 6174 2827 5265 6665  z.'.format('Refe
-0000ae60: 7265 6e63 6520 6672 6571 7565 6e63 7927  rence frequency'
-0000ae70: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000acd0: 2020 2020 2020 2020 2020 273d 272c 2072            '=', r
+0000ace0: 6566 6572 656e 6365 5f66 7265 7175 656e  eference_frequen
+0000acf0: 6379 2929 0d0a 2020 2020 2020 2020 2020  cy))..          
+0000ad00: 2020 2020 2020 7072 696e 7428 272a 2a20        print('** 
+0000ad10: 7b30 3a3c 3237 7d20 7b31 7d20 7b32 7d20  {0:<27} {1} {2} 
+0000ad20: 6d2e 272e 666f 726d 6174 2827 4469 706f  m.'.format('Dipo
+0000ad30: 6c65 206c 656e 6774 6820 272c 0d0a 2020  le length ',..  
+0000ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad70: 2020 2027 3d27 2c20 6469 706f 6c65 6c65     '=', dipolele
+0000ad80: 6e67 7468 2929 0d0a 2020 2020 2020 2020  ngth))..        
+0000ad90: 2020 2020 656c 6966 2061 7070 6c79 5f66      elif apply_f
+0000ada0: 696c 7465 7220 3d3d 2027 616d 6127 3a20  ilter == 'ama': 
+0000adb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000adc0: 2020 7365 6c66 2e5f 6c6f 6767 696e 672e    self._logging.
+0000add0: 696e 666f 2028 0d0a 2020 2020 2020 2020  info (..        
+0000ade0: 2020 2020 2020 2020 2020 2020 2743 6f6d              'Com
+0000adf0: 7075 7469 6e67 2072 686f 2077 6974 6820  puting rho with 
+0000ae00: 6164 6170 7461 7469 7665 206d 6f76 696e  adaptative movin
+0000ae10: 6720 6176 6572 6167 6520 2841 4d41 2920  g average (AMA) 
+0000ae20: 6669 6c74 6572 2e27 290d 0a20 2020 200d  filter.')..    .
+0000ae30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ae40: 2072 6573 5f41 4d41 203d 2063 6f72 725f   res_AMA = corr_
+0000ae50: 6f62 6a2e 414d 4128 6e75 6d62 6572 5f6f  obj.AMA(number_o
+0000ae60: 665f 736b 696e 5f64 6570 7468 3d6e 756d  f_skin_depth=num
+0000ae70: 6265 725f 6f66 5f73 6b69 6e5f 6465 7074  ber_of_skin_dept
+0000ae80: 682c 200d 0a20 2020 2020 2020 2020 2020  h, ..           
 0000ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aea0: 2020 2020 2027 3d27 2c20 7265 6665 7265       '=', refere
-0000aeb0: 6e63 655f 6672 6571 7565 6e63 7929 290d  nce_frequency)).
-0000aec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000aed0: 2070 7269 6e74 2827 2a2a 207b 303a 3c32   print('** {0:<2
-0000aee0: 377d 207b 317d 207b 327d 206d 2e27 2e66  7} {1} {2} m.'.f
-0000aef0: 6f72 6d61 7428 2744 6970 6f6c 6520 6c65  ormat('Dipole le
-0000af00: 6e67 7468 2027 2c0d 0a20 2020 2020 2020  ngth ',..       
-0000af10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af30: 2020 2020 2020 2020 2020 2020 2020 273d                '=
-0000af40: 272c 2064 6970 6f6c 656c 656e 6774 6829  ', dipolelength)
-0000af50: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0000af60: 6c69 6620 6170 706c 795f 6669 6c74 6572  lif apply_filter
-0000af70: 203d 3d20 2761 6d61 273a 200d 0a20 2020   == 'ama': ..   
-0000af80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000af90: 662e 5f6c 6f67 6769 6e67 2e69 6e66 6f20  f._logging.info 
-0000afa0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0000afb0: 2020 2020 2020 2027 436f 6d70 7574 696e         'Computin
-0000afc0: 6720 7268 6f20 7769 7468 2061 6461 7074  g rho with adapt
-0000afd0: 6174 6976 6520 6d6f 7669 6e67 2061 7665  ative moving ave
-0000afe0: 7261 6765 2028 414d 4129 2066 696c 7465  rage (AMA) filte
-0000aff0: 722e 2729 0d0a 2020 2020 0d0a 2020 2020  r.')..    ..    
-0000b000: 2020 2020 2020 2020 2020 2020 7265 735f              res_
-0000b010: 414d 4120 3d20 636f 7272 5f6f 626a 2e41  AMA = corr_obj.A
-0000b020: 4d41 286e 756d 6265 725f 6f66 5f73 6b69  MA(number_of_ski
-0000b030: 6e5f 6465 7074 683d 6e75 6d62 6572 5f6f  n_depth=number_o
-0000b040: 665f 736b 696e 5f64 6570 7468 2c20 0d0a  f_skin_depth, ..
+0000aea0: 2020 2020 2020 2020 2020 2020 2072 6566               ref
+0000aeb0: 6572 656e 6365 5f66 7265 713d 7265 6665  erence_freq=refe
+0000aec0: 7265 6e63 655f 6672 6571 7565 6e63 7929  rence_frequency)
+0000aed0: 0d0a 2020 0d0a 2020 2020 2020 2020 2020  ..  ..          
+0000aee0: 2020 2020 2020 6469 706f 6c65 6c65 6e67        dipoleleng
+0000aef0: 7468 3d20 636f 7272 5f6f 626a 2e64 6970  th= corr_obj.dip
+0000af00: 6f6c 656c 656e 6774 680d 0a20 2020 2020  olelength..     
+0000af10: 2020 2020 2020 2020 2020 2072 6566 6572             refer
+0000af20: 656e 6365 5f66 7265 7175 656e 6379 203d  ence_frequency =
+0000af30: 636f 7272 5f6f 626a 2e72 6566 6572 656e  corr_obj.referen
+0000af40: 6365 6672 6571 0d0a 2020 2020 2020 2020  cefreq..        
+0000af50: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000af60: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0000af70: 272a 2a20 7b30 3a3c 3237 7d20 7b31 7d20  '** {0:<27} {1} 
+0000af80: 7b32 7d27 2e66 6f72 6d61 7428 274e 756d  {2}'.format('Num
+0000af90: 6265 7220 6f66 2073 6b69 6e20 6465 7074  ber of skin dept
+0000afa0: 6873 272c 0d0a 2020 2020 2020 2020 2020  hs',..          
+0000afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000afc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000afd0: 2020 2020 2020 2020 273d 272c 2069 6e74          '=', int
+0000afe0: 286e 756d 6265 725f 6f66 5f73 6b69 6e5f  (number_of_skin_
+0000aff0: 6465 7074 6829 2929 0d0a 2020 2020 2020  depth)))..      
+0000b000: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0000b010: 272a 2a20 7b30 3a3c 3237 7d20 7b31 7d20  '** {0:<27} {1} 
+0000b020: 7b32 7d20 487a 2e27 2e66 6f72 6d61 7428  {2} Hz.'.format(
+0000b030: 2752 6566 6572 656e 6365 2066 7265 7175  'Reference frequ
+0000b040: 656e 6379 272c 0d0a 2020 2020 2020 2020  ency',..        
 0000b050: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000b060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b070: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
-0000b080: 655f 6672 6571 3d72 6566 6572 656e 6365  e_freq=reference
-0000b090: 5f66 7265 7175 656e 6379 290d 0a20 200d  _frequency)..  .
-0000b0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b0b0: 2064 6970 6f6c 656c 656e 6774 683d 2063   dipolelength= c
-0000b0c0: 6f72 725f 6f62 6a2e 6469 706f 6c65 6c65  orr_obj.dipolele
-0000b0d0: 6e67 7468 0d0a 2020 2020 2020 2020 2020  ngth..          
-0000b0e0: 2020 2020 2020 7265 6665 7265 6e63 655f        reference_
-0000b0f0: 6672 6571 7565 6e63 7920 3d63 6f72 725f  frequency =corr_
-0000b100: 6f62 6a2e 7265 6665 7265 6e63 6566 7265  obj.referencefre
-0000b110: 710d 0a20 2020 2020 2020 2020 2020 2020  q..             
-0000b120: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000b130: 2020 2020 2070 7269 6e74 2827 2a2a 207b       print('** {
-0000b140: 303a 3c32 377d 207b 317d 207b 327d 272e  0:<27} {1} {2}'.
-0000b150: 666f 726d 6174 2827 4e75 6d62 6572 206f  format('Number o
-0000b160: 6620 736b 696e 2064 6570 7468 7327 2c0d  f skin depths',.
-0000b170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b1a0: 2020 2027 3d27 2c20 696e 7428 6e75 6d62     '=', int(numb
-0000b1b0: 6572 5f6f 665f 736b 696e 5f64 6570 7468  er_of_skin_depth
-0000b1c0: 2929 290d 0a20 2020 2020 2020 2020 2020  )))..           
-0000b1d0: 2020 2020 2070 7269 6e74 2827 2a2a 207b       print('** {
-0000b1e0: 303a 3c32 377d 207b 317d 207b 327d 2048  0:<27} {1} {2} H
-0000b1f0: 7a2e 272e 666f 726d 6174 2827 5265 6665  z.'.format('Refe
-0000b200: 7265 6e63 6520 6672 6571 7565 6e63 7927  rence frequency'
-0000b210: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000b070: 2020 2020 2020 2020 2020 273d 272c 2072            '=', r
+0000b080: 6566 6572 656e 6365 5f66 7265 7175 656e  eference_frequen
+0000b090: 6379 2929 0d0a 2020 2020 2020 2020 2020  cy))..          
+0000b0a0: 2020 2020 2020 7072 696e 7428 272a 2a20        print('** 
+0000b0b0: 7b30 3a3c 3237 7d20 7b31 7d20 7b32 7d20  {0:<27} {1} {2} 
+0000b0c0: 6d2e 272e 666f 726d 6174 2827 4469 706f  m.'.format('Dipo
+0000b0d0: 6c65 206c 656e 6774 6820 272c 0d0a 2020  le length ',..  
+0000b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b110: 2020 2027 3d27 2c20 6469 706f 6c65 6c65     '=', dipolele
+0000b120: 6e67 7468 2929 0d0a 2020 2020 200d 0a20  ngth))..     .. 
+0000b130: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0000b140: 6170 706c 795f 6669 6c74 6572 2069 7320  apply_filter is 
+0000b150: 6e6f 7420 4e6f 6e65 2061 6e64 2061 7070  not None and app
+0000b160: 6c79 5f66 696c 7465 7220 206e 6f74 2069  ly_filter  not i
+0000b170: 6e20 5b27 746d 612c 2061 6d61 2c20 666c  n ['tma, ama, fl
+0000b180: 6d61 275d 3a20 0d0a 2020 2020 2020 2020  ma']: ..        
+0000b190: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0000b1a0: 2e77 6172 6e28 2766 696c 7465 7220 2573  .warn('filter %s
+0000b1b0: 2070 726f 7669 6465 6420 6973 2055 4e72   provided is UNr
+0000b1c0: 6563 6f67 6e69 7a69 6e67 2e27 0d0a 2020  ecognizing.'..  
+0000b1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b1e0: 2020 2020 2020 2020 2020 2020 2720 506f              ' Po
+0000b1f0: 6772 616d 2077 6f72 736b 2063 7572 7265  gram worsk curre
+0000b200: 6e74 6c79 2077 6974 6820 3a20 544d 4120  ntly with : TMA 
+0000b210: 6f72 2046 4c4d 4120 2c27 0d0a 2020 2020  or FLMA ,'..    
 0000b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b240: 2020 2020 2027 3d27 2c20 7265 6665 7265       '=', refere
-0000b250: 6e63 655f 6672 6571 7565 6e63 7929 290d  nce_frequency)).
-0000b260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b270: 2070 7269 6e74 2827 2a2a 207b 303a 3c32   print('** {0:<2
-0000b280: 377d 207b 317d 207b 327d 206d 2e27 2e66  7} {1} {2} m.'.f
-0000b290: 6f72 6d61 7428 2744 6970 6f6c 6520 6c65  ormat('Dipole le
-0000b2a0: 6e67 7468 2027 2c0d 0a20 2020 2020 2020  ngth ',..       
+0000b230: 2020 2020 2020 2020 2020 2720 506c 6561            ' Plea
+0000b240: 7365 2070 726f 7669 6465 6420 7468 6520  se provided the 
+0000b250: 7269 6768 7420 6669 6c74 6572 7327 0d0a  right filters'..
+0000b260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b270: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
+0000b280: 666f 7220 636f 6d70 7574 696e 672e 2725  for computing.'%
+0000b290: 2061 7070 6c79 5f66 696c 7465 7229 0d0a   apply_filter)..
+0000b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000b2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b2d0: 2020 2020 2020 2020 2020 2020 2020 273d                '=
-0000b2e0: 272c 2064 6970 6f6c 656c 656e 6774 6829  ', dipolelength)
-0000b2f0: 290d 0a20 2020 2020 0d0a 2020 2020 2020  )..     ..      
-0000b300: 2020 2020 2020 656c 6966 2061 7070 6c79        elif apply
-0000b310: 5f66 696c 7465 7220 6973 206e 6f74 204e  _filter is not N
-0000b320: 6f6e 6520 616e 6420 6170 706c 795f 6669  one and apply_fi
-0000b330: 6c74 6572 2020 6e6f 7420 696e 205b 2774  lter  not in ['t
-0000b340: 6d61 2c20 616d 612c 2066 6c6d 6127 5d3a  ma, ama, flma']:
-0000b350: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000b360: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0000b370: 2827 6669 6c74 6572 2025 7320 7072 6f76  ('filter %s prov
-0000b380: 6964 6564 2069 7320 554e 7265 636f 676e  ided is UNrecogn
-0000b390: 697a 696e 672e 270d 0a20 2020 2020 2020  izing.'..       
-0000b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b3b0: 2020 2020 2020 2027 2050 6f67 7261 6d20         ' Pogram 
-0000b3c0: 776f 7273 6b20 6375 7272 656e 746c 7920  worsk currently 
-0000b3d0: 7769 7468 203a 2054 4d41 206f 7220 464c  with : TMA or FL
-0000b3e0: 4d41 202c 270d 0a20 2020 2020 2020 2020  MA ,'..         
-0000b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b400: 2020 2020 2027 2050 6c65 6173 6520 7072       ' Please pr
-0000b410: 6f76 6964 6564 2074 6865 2072 6967 6874  ovided the right
-0000b420: 2066 696c 7465 7273 270d 0a20 2020 2020   filters'..     
-0000b430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b440: 2020 2020 2020 2020 2027 2066 6f72 2063           ' for c
-0000b450: 6f6d 7075 7469 6e67 2e27 2520 6170 706c  omputing.'% appl
-0000b460: 795f 6669 6c74 6572 290d 0a20 2020 2020  y_filter)..     
-0000b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b480: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-0000b490: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b4a0: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-0000b4b0: 5445 7272 6f72 5f70 726f 6365 7373 696e  TError_processin
-0000b4c0: 6728 0d0a 2020 2020 2020 2020 2020 2020  g(..            
-0000b4d0: 2020 2020 2020 2020 2746 696c 7465 7273          'Filters
-0000b4e0: 2070 726f 7669 6465 6420 6973 206e 6f74   provided is not
-0000b4f0: 2061 6363 6570 7461 626c 652e 270d 0a20   acceptable.'.. 
-0000b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b510: 2020 2027 2052 6563 6f67 6e69 7a65 6420     ' Recognized 
-0000b520: 6669 6c74 6572 7320 6172 6520 2254 4d41  filters are "TMA
-0000b530: 222c 2241 4d41 2220 414e 4420 2246 4c4d  ","AMA" AND "FLM
-0000b540: 4122 2729 0d0a 2020 2020 2020 2020 0d0a  A"')..        ..
-0000b550: 2020 2020 2020 2020 6966 2061 7070 6c79          if apply
-0000b560: 5f66 696c 7465 7220 6973 204e 6f6e 6520  _filter is None 
-0000b570: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000b580: 6966 2073 656c 662e 4865 6164 6572 2e48  if self.Header.H
-0000b590: 6172 6477 6172 6549 6e66 6f73 2e6e 756d  ardwareInfos.num
-0000b5a0: 6669 6c74 6572 6672 6571 2069 7320 4e6f  filterfreq is No
-0000b5b0: 6e65 5c0d 0a20 2020 2020 2020 2020 2020  ne\..           
-0000b5c0: 2020 2020 2061 6e64 2073 656c 662e 4865       and self.He
-0000b5d0: 6164 6572 2e48 6172 6477 6172 6549 6e66  ader.HardwareInf
-0000b5e0: 6f73 2e66 7265 715f 6669 6c74 6572 2069  os.freq_filter i
-0000b5f0: 7320 4e6f 6e65 203a 0d0a 2020 2020 2020  s None :..      
-0000b600: 2020 2020 2020 2020 2020 2061 7667 6669             avgfi
-0000b610: 6c74 6572 2c20 6465 7363 7269 7469 7066  lter, descritipf
-0000b620: 696c 7465 7220 3d20 2727 2c20 2222 2020  ilter = '', ""  
-0000b630: 200d 0a20 2020 200d 0a20 2020 2020 2020   ..    ..       
-0000b640: 2020 2020 2065 6c69 6620 7365 6c66 2e48       elif self.H
-0000b650: 6561 6465 722e 4861 7264 7761 7265 496e  eader.HardwareIn
-0000b660: 666f 732e 6173 7461 7469 635f 7665 7273  fos.astatic_vers
-0000b670: 696f 6e20 6973 206e 6f74 204e 6f6e 6520  ion is not None 
-0000b680: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000b690: 2020 2020 6176 6766 696c 7465 7220 3d22      avgfilter ="
-0000b6a0: 7b30 7d2e 7b31 7d2e 4669 6c74 6572 203d  {0}.{1}.Filter =
-0000b6b0: 544d 4120 666f 7220 3570 7473 2e22 2e66  TMA for 5pts.".f
-0000b6c0: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
-0000b6d0: 2020 2020 2020 2020 2020 2020 2741 7374              'Ast
-0000b6e0: 6174 6963 272c 7365 6c66 2e48 6561 6465  atic',self.Heade
-0000b6f0: 722e 4861 7264 7761 7265 496e 666f 732e  r.HardwareInfos.
-0000b700: 6173 7461 7469 635f 7665 7273 696f 6e20  astatic_version 
-0000b710: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000b720: 2020 2064 6573 6372 6974 6970 6669 6c74     descritipfilt
-0000b730: 6572 203d 2073 656c 662e 4865 6164 6572  er = self.Header
-0000b740: 2e48 6172 6477 6172 6549 6e66 6f73 2e73  .HardwareInfos.s
-0000b750: 636f 6e66 6967 5f64 6963 745b 2727 5d0d  config_dict[''].
-0000b760: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0000b770: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-0000b780: 3a20 6176 6766 696c 7465 722c 2064 6573  : avgfilter, des
-0000b790: 6372 6974 6970 6669 6c74 6572 203d 2027  critipfilter = '
-0000b7a0: 272c 2022 220d 0a20 2020 2020 2020 200d  ', ""..        .
-0000b7b0: 0a20 2020 2020 2020 2069 6620 6170 706c  .        if appl
-0000b7c0: 795f 6669 6c74 6572 2020 6973 206e 6f74  y_filter  is not
-0000b7d0: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
-0000b7e0: 2020 2020 206d 7366 3d27 270d 0a20 2020       msf=''..   
-0000b7f0: 2020 2020 2020 2020 2069 6620 6170 706c           if appl
-0000b800: 795f 6669 6c74 6572 203d 3d27 666c 6d61  y_filter =='flma
-0000b810: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-0000b820: 2020 2020 6465 7363 7269 7469 7066 696c      descritipfil
-0000b830: 7465 7220 3d20 2720 7b30 7d20 6469 706f  ter = ' {0} dipo
-0000b840: 6c65 7320 666f 7220 464c 4d41 2066 696c  les for FLMA fil
-0000b850: 7465 7227 5c0d 0a20 2020 2020 2020 2020  ter'\..         
-0000b860: 2020 2020 2020 2020 2020 2027 2061 7420             ' at 
-0000b870: 7b31 7d20 6865 7274 7a20 7769 7468 207b  {1} hertz with {
-0000b880: 327d 206d 2064 6970 6f6c 6520 6c65 6e67  2} m dipole leng
-0000b890: 7468 272e 666f 726d 6174 280d 0a20 2020  th'.format(..   
+0000b2c0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000b2d0: 2020 2020 7261 6973 6520 5072 6f63 6573      raise Proces
+0000b2e0: 7369 6e67 4572 726f 7228 0d0a 2020 2020  singError(..    
+0000b2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b300: 2746 696c 7465 7273 2070 726f 7669 6465  'Filters provide
+0000b310: 6420 6973 206e 6f74 2061 6363 6570 7461  d is not accepta
+0000b320: 626c 652e 270d 0a20 2020 2020 2020 2020  ble.'..         
+0000b330: 2020 2020 2020 2020 2020 2027 2052 6563             ' Rec
+0000b340: 6f67 6e69 7a65 6420 6669 6c74 6572 7320  ognized filters 
+0000b350: 6172 6520 2254 4d41 222c 2241 4d41 2220  are "TMA","AMA" 
+0000b360: 414e 4420 2246 4c4d 4122 2729 0d0a 2020  AND "FLMA"')..  
+0000b370: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000b380: 6966 2061 7070 6c79 5f66 696c 7465 7220  if apply_filter 
+0000b390: 6973 204e 6f6e 6520 3a20 0d0a 2020 2020  is None : ..    
+0000b3a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000b3b0: 4865 6164 6572 2e48 6172 6477 6172 6549  Header.HardwareI
+0000b3c0: 6e66 6f73 2e6e 756d 6669 6c74 6572 6672  nfos.numfilterfr
+0000b3d0: 6571 2069 7320 4e6f 6e65 5c0d 0a20 2020  eq is None\..   
+0000b3e0: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+0000b3f0: 2073 656c 662e 4865 6164 6572 2e48 6172   self.Header.Har
+0000b400: 6477 6172 6549 6e66 6f73 2e66 7265 715f  dwareInfos.freq_
+0000b410: 6669 6c74 6572 2069 7320 4e6f 6e65 203a  filter is None :
+0000b420: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000b430: 2020 2061 7667 6669 6c74 6572 2c20 6465     avgfilter, de
+0000b440: 7363 7269 7469 7066 696c 7465 7220 3d20  scritipfilter = 
+0000b450: 2727 2c20 2222 2020 200d 0a20 2020 200d  '', ""   ..    .
+0000b460: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0000b470: 6620 7365 6c66 2e48 6561 6465 722e 4861  f self.Header.Ha
+0000b480: 7264 7761 7265 496e 666f 732e 6173 7461  rdwareInfos.asta
+0000b490: 7469 635f 7665 7273 696f 6e20 6973 206e  tic_version is n
+0000b4a0: 6f74 204e 6f6e 6520 3a20 0d0a 2020 2020  ot None : ..    
+0000b4b0: 2020 2020 2020 2020 2020 2020 6176 6766              avgf
+0000b4c0: 696c 7465 7220 3d22 7b30 7d2e 7b31 7d2e  ilter ="{0}.{1}.
+0000b4d0: 4669 6c74 6572 203d 544d 4120 666f 7220  Filter =TMA for 
+0000b4e0: 3570 7473 2e22 2e66 6f72 6d61 7428 0d0a  5pts.".format(..
+0000b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b500: 2020 2020 2741 7374 6174 6963 272c 7365      'Astatic',se
+0000b510: 6c66 2e48 6561 6465 722e 4861 7264 7761  lf.Header.Hardwa
+0000b520: 7265 496e 666f 732e 6173 7461 7469 635f  reInfos.astatic_
+0000b530: 7665 7273 696f 6e20 290d 0a20 2020 2020  version )..     
+0000b540: 2020 2020 2020 2020 2020 2064 6573 6372             descr
+0000b550: 6974 6970 6669 6c74 6572 203d 2073 656c  itipfilter = sel
+0000b560: 662e 4865 6164 6572 2e48 6172 6477 6172  f.Header.Hardwar
+0000b570: 6549 6e66 6f73 2e73 636f 6e66 6967 5f64  eInfos.sconfig_d
+0000b580: 6963 745b 2727 5d0d 0a20 2020 2020 2020  ict['']..       
+0000b590: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000b5a0: 2020 2065 6c73 6520 3a20 6176 6766 696c     else : avgfil
+0000b5b0: 7465 722c 2064 6573 6372 6974 6970 6669  ter, descritipfi
+0000b5c0: 6c74 6572 203d 2027 272c 2022 220d 0a20  lter = '', "".. 
+0000b5d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000b5e0: 2069 6620 6170 706c 795f 6669 6c74 6572   if apply_filter
+0000b5f0: 2020 6973 206e 6f74 204e 6f6e 6520 3a0d    is not None :.
+0000b600: 0a20 2020 2020 2020 2020 2020 206d 7366  .            msf
+0000b610: 3d27 270d 0a20 2020 2020 2020 2020 2020  =''..           
+0000b620: 2069 6620 6170 706c 795f 6669 6c74 6572   if apply_filter
+0000b630: 203d 3d27 666c 6d61 273a 0d0a 2020 2020   =='flma':..    
+0000b640: 2020 2020 2020 2020 2020 2020 6465 7363              desc
+0000b650: 7269 7469 7066 696c 7465 7220 3d20 2720  ritipfilter = ' 
+0000b660: 7b30 7d20 6469 706f 6c65 7320 666f 7220  {0} dipoles for 
+0000b670: 464c 4d41 2066 696c 7465 7227 5c0d 0a20  FLMA filter'\.. 
+0000b680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b690: 2020 2027 2061 7420 7b31 7d20 6865 7274     ' at {1} hert
+0000b6a0: 7a20 7769 7468 207b 327d 206d 2064 6970  z with {2} m dip
+0000b6b0: 6f6c 6520 6c65 6e67 7468 272e 666f 726d  ole length'.form
+0000b6c0: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
+0000b6d0: 2020 2020 2069 6e74 286e 756d 6265 725f       int(number_
+0000b6e0: 6f66 5f70 6f69 6e74 7329 2c20 7265 6665  of_points), refe
+0000b6f0: 7265 6e63 655f 6672 6571 7565 6e63 792c  rence_frequency,
+0000b700: 2064 6970 6f6c 656c 656e 6774 6829 0d0a   dipolelength)..
+0000b710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b720: 6d73 663d 2764 6970 270d 0a20 2020 2020  msf='dip'..     
+0000b730: 2020 2020 2020 2065 6c69 6620 6170 706c         elif appl
+0000b740: 795f 6669 6c74 6572 203d 3d27 746d 6127  y_filter =='tma'
+0000b750: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000b760: 2020 2064 6573 6372 6974 6970 6669 6c74     descritipfilt
+0000b770: 6572 203d 2027 207b 307d 2070 6f69 6e74  er = ' {0} point
+0000b780: 7320 666f 7220 544d 4120 6669 6c74 6572  s for TMA filter
+0000b790: 2061 7420 7b31 7d20 6865 7274 7a27 2e66   at {1} hertz'.f
+0000b7a0: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
+0000b7b0: 2020 2020 2020 2020 2020 2020 696e 7428              int(
+0000b7c0: 6e75 6d62 6572 5f6f 665f 706f 696e 7473  number_of_points
+0000b7d0: 292c 2072 6566 6572 656e 6365 5f66 7265  ), reference_fre
+0000b7e0: 7175 656e 6379 290d 0a20 2020 2020 2020  quency)..       
+0000b7f0: 2020 2020 2020 2020 206d 7366 3d27 7074           msf='pt
+0000b800: 7327 200d 0a20 2020 2020 2020 2020 2020  s' ..           
+0000b810: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000b820: 2020 2065 6c69 6620 6170 706c 795f 6669     elif apply_fi
+0000b830: 6c74 6572 203d 3d27 616d 6127 3a0d 0a20  lter =='ama':.. 
+0000b840: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000b850: 6573 6372 6974 6970 6669 6c74 6572 203d  escritipfilter =
+0000b860: 2027 207b 307d 2073 6b69 6e20 6465 7074   ' {0} skin dept
+0000b870: 6873 2066 6f72 2041 4d41 2066 696c 7465  hs for AMA filte
+0000b880: 7220 6174 207b 317d 2068 6572 747a 272e  r at {1} hertz'.
+0000b890: 666f 726d 6174 280d 0a20 2020 2020 2020  format(..       
 0000b8a0: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-0000b8b0: 286e 756d 6265 725f 6f66 5f70 6f69 6e74  (number_of_point
-0000b8c0: 7329 2c20 7265 6665 7265 6e63 655f 6672  s), reference_fr
-0000b8d0: 6571 7565 6e63 792c 2064 6970 6f6c 656c  equency, dipolel
-0000b8e0: 656e 6774 6829 0d0a 2020 2020 2020 2020  ength)..        
-0000b8f0: 2020 2020 2020 2020 6d73 663d 2764 6970          msf='dip
-0000b900: 270d 0a20 2020 2020 2020 2020 2020 2065  '..            e
-0000b910: 6c69 6620 6170 706c 795f 6669 6c74 6572  lif apply_filter
-0000b920: 203d 3d27 746d 6127 3a0d 0a20 2020 2020   =='tma':..     
-0000b930: 2020 2020 2020 2020 2020 2064 6573 6372             descr
-0000b940: 6974 6970 6669 6c74 6572 203d 2027 207b  itipfilter = ' {
-0000b950: 307d 2070 6f69 6e74 7320 666f 7220 544d  0} points for TM
-0000b960: 4120 6669 6c74 6572 2061 7420 7b31 7d20  A filter at {1} 
-0000b970: 6865 7274 7a27 2e66 6f72 6d61 7428 0d0a  hertz'.format(..
-0000b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b990: 2020 2020 696e 7428 6e75 6d62 6572 5f6f      int(number_o
-0000b9a0: 665f 706f 696e 7473 292c 2072 6566 6572  f_points), refer
-0000b9b0: 656e 6365 5f66 7265 7175 656e 6379 290d  ence_frequency).
-0000b9c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b9d0: 206d 7366 3d27 7074 7327 200d 0a20 2020   msf='pts' ..   
-0000b9e0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-0000b9f0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0000ba00: 6170 706c 795f 6669 6c74 6572 203d 3d27  apply_filter =='
-0000ba10: 616d 6127 3a0d 0a20 2020 2020 2020 2020  ama':..         
-0000ba20: 2020 2020 2020 2064 6573 6372 6974 6970         descritip
-0000ba30: 6669 6c74 6572 203d 2027 207b 307d 2073  filter = ' {0} s
-0000ba40: 6b69 6e20 6465 7074 6873 2066 6f72 2041  kin depths for A
-0000ba50: 4d41 2066 696c 7465 7220 6174 207b 317d  MA filter at {1}
-0000ba60: 2068 6572 747a 272e 666f 726d 6174 280d   hertz'.format(.
-0000ba70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ba80: 2020 2020 2069 6e74 286e 756d 6265 725f       int(number_
-0000ba90: 6f66 5f73 6b69 6e5f 6465 7074 6829 2c20  of_skin_depth), 
-0000baa0: 7265 6665 7265 6e63 655f 6672 6571 7565  reference_freque
-0000bab0: 6e63 7929 0d0a 2020 2020 2020 2020 2020  ncy)..          
-0000bac0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-0000bad0: 706f 696e 7473 3d6e 756d 6265 725f 6f66  points=number_of
-0000bae0: 5f73 6b69 6e5f 6465 7074 680d 0a20 2020  _skin_depth..   
-0000baf0: 2020 2020 2020 2020 2020 2020 206d 7366               msf
-0000bb00: 3d27 7364 6570 7468 7327 0d0a 0d0a 2020  ='sdepths'....  
-0000bb10: 2020 2020 2020 2020 2020 6176 6766 696c            avgfil
-0000bb20: 7465 7220 3d22 7b30 7d2e 7b31 7d2e 4669  ter ="{0}.{1}.Fi
-0000bb30: 6c74 6572 203d 7b32 7d20 666f 7220 7b33  lter ={2} for {3
-0000bb40: 7d20 7b34 7d2e 222e 666f 726d 6174 280d  } {4}.".format(.
-0000bb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bb60: 2020 2020 2770 7963 7361 6d74 272c 2776      'pycsamt','v
-0000bb70: 312e 302e 3031 272c 2061 7070 6c79 5f66  1.0.01', apply_f
-0000bb80: 696c 7465 722e 7570 7065 7228 292c 2020  ilter.upper(),  
+0000b8b0: 286e 756d 6265 725f 6f66 5f73 6b69 6e5f  (number_of_skin_
+0000b8c0: 6465 7074 6829 2c20 7265 6665 7265 6e63  depth), referenc
+0000b8d0: 655f 6672 6571 7565 6e63 7929 0d0a 2020  e_frequency)..  
+0000b8e0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+0000b8f0: 6d62 6572 5f6f 665f 706f 696e 7473 3d6e  mber_of_points=n
+0000b900: 756d 6265 725f 6f66 5f73 6b69 6e5f 6465  umber_of_skin_de
+0000b910: 7074 680d 0a20 2020 2020 2020 2020 2020  pth..           
+0000b920: 2020 2020 206d 7366 3d27 7364 6570 7468       msf='sdepth
+0000b930: 7327 0d0a 0d0a 2020 2020 2020 2020 2020  s'....          
+0000b940: 2020 6176 6766 696c 7465 7220 3d22 7b30    avgfilter ="{0
+0000b950: 7d2e 7b31 7d2e 4669 6c74 6572 203d 7b32  }.{1}.Filter ={2
+0000b960: 7d20 666f 7220 7b33 7d20 7b34 7d2e 222e  } for {3} {4}.".
+0000b970: 666f 726d 6174 280d 0a20 2020 2020 2020  format(..       
+0000b980: 2020 2020 2020 2020 2020 2020 2770 7963              'pyc
+0000b990: 7361 6d74 272c 2776 312e 302e 3031 272c  samt','v1.0.01',
+0000b9a0: 2061 7070 6c79 5f66 696c 7465 722e 7570   apply_filter.up
+0000b9b0: 7065 7228 292c 2020 0d0a 2020 2020 2020  per(),  ..      
+0000b9c0: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+0000b9d0: 286e 756d 6265 725f 6f66 5f70 6f69 6e74  (number_of_point
+0000b9e0: 7329 202c 206d 7366 290d 0a20 2020 2020  s) , msf)..     
+0000b9f0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000ba00: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+0000ba10: 6620 7365 6c66 2e70 726f 6669 6c65 5f66  f self.profile_f
+0000ba20: 6e20 2069 7320 4e6f 6e65 203a 200d 0a20  n  is None : .. 
+0000ba30: 2020 2020 2020 2020 2020 2023 2d2d 2d3e             #--->
+0000ba40: 2073 6574 2074 6f20 302e 206c 6f6e 202c   set to 0. lon ,
+0000ba50: 206c 6174 2061 6e64 2065 6c65 7620 6966   lat and elev if
+0000ba60: 2070 726f 6669 6c65 205f 666e 2069 7320   profile _fn is 
+0000ba70: 6e6f 7420 7072 6f76 6964 6564 0d0a 2020  not provided..  
+0000ba80: 2020 2020 2020 2020 2020 232d 2d3e 2063            #--> c
+0000ba90: 7265 6174 6520 6469 6374 696f 6e6e 6172  reate dictionnar
+0000baa0: 7920 6f66 207a 6572 6f20 7661 6c75 6520  y of zero value 
+0000bab0: 6f66 206c 6174 2061 6e64 206c 6f6e 200d  of lat and lon .
+0000bac0: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+0000bad0: 6f72 7420 636f 7079 200d 0a20 2020 2020  ort copy ..     
+0000bae0: 2020 2020 2020 2023 6865 6164 5f65 6469         #head_edi
+0000baf0: 5f6c 6f6e 203d 206e 702e 6675 6c6c 2828  _lon = np.full((
+0000bb00: 6c65 6e28 6865 6164 5f64 6174 6169 645f  len(head_dataid_
+0000bb10: 6c69 7374 292c 292c 2030 2e2c 2064 7479  list),), 0., dty
+0000bb20: 7065 3d6e 702e 666c 6f61 7429 0d0a 2020  pe=np.float)..  
+0000bb30: 2020 2020 2020 2020 2020 6865 6164 5f65            head_e
+0000bb40: 6469 5f6c 6f6e 203d 207b 7374 6e3a 2076  di_lon = {stn: v
+0000bb50: 616c 7565 2066 6f72 2073 746e 202c 2076  alue for stn , v
+0000bb60: 616c 7565 2069 6e20 7a69 7020 280d 0a20  alue in zip (.. 
+0000bb70: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+0000bb80: 6561 645f 6461 7461 6964 5f6c 6973 742c  ead_dataid_list,
 0000bb90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000bba0: 2020 2020 2069 6e74 286e 756d 6265 725f       int(number_
-0000bbb0: 6f66 5f70 6f69 6e74 7329 202c 206d 7366  of_points) , msf
-0000bbc0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-0000bbd0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0000bbe0: 2020 2020 2020 2069 6620 7365 6c66 2e70         if self.p
-0000bbf0: 726f 6669 6c65 5f66 6e20 2069 7320 4e6f  rofile_fn  is No
-0000bc00: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
-0000bc10: 2020 2023 2d2d 2d3e 2073 6574 2074 6f20     #---> set to 
-0000bc20: 302e 206c 6f6e 202c 206c 6174 2061 6e64  0. lon , lat and
-0000bc30: 2065 6c65 7620 6966 2070 726f 6669 6c65   elev if profile
-0000bc40: 205f 666e 2069 7320 6e6f 7420 7072 6f76   _fn is not prov
-0000bc50: 6964 6564 0d0a 2020 2020 2020 2020 2020  ided..          
-0000bc60: 2020 232d 2d3e 2063 7265 6174 6520 6469    #--> create di
-0000bc70: 6374 696f 6e6e 6172 7920 6f66 207a 6572  ctionnary of zer
-0000bc80: 6f20 7661 6c75 6520 6f66 206c 6174 2061  o value of lat a
-0000bc90: 6e64 206c 6f6e 200d 0a20 2020 2020 2020  nd lon ..       
-0000bca0: 2020 2020 2069 6d70 6f72 7420 636f 7079       import copy
-0000bcb0: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-0000bcc0: 6865 6164 5f65 6469 5f6c 6f6e 203d 206e  head_edi_lon = n
-0000bcd0: 702e 6675 6c6c 2828 6c65 6e28 6865 6164  p.full((len(head
-0000bce0: 5f64 6174 6169 645f 6c69 7374 292c 292c  _dataid_list),),
-0000bcf0: 2030 2e2c 2064 7479 7065 3d6e 702e 666c   0., dtype=np.fl
-0000bd00: 6f61 7429 0d0a 2020 2020 2020 2020 2020  oat)..          
-0000bd10: 2020 6865 6164 5f65 6469 5f6c 6f6e 203d    head_edi_lon =
-0000bd20: 207b 7374 6e3a 2076 616c 7565 2066 6f72   {stn: value for
-0000bd30: 2073 746e 202c 2076 616c 7565 2069 6e20   stn , value in 
-0000bd40: 7a69 7020 280d 0a20 2020 2020 2020 2020  zip (..         
-0000bd50: 2020 2020 2020 2068 6561 645f 6461 7461         head_data
-0000bd60: 6964 5f6c 6973 742c 0d0a 2020 2020 2020  id_list,..      
-0000bd70: 2020 2020 2020 2020 2020 6e70 2e7a 6572            np.zer
-0000bd80: 6f73 5f6c 696b 6528 6c65 6e28 6865 6164  os_like(len(head
-0000bd90: 5f64 6174 6169 645f 6c69 7374 292c 2064  _dataid_list), d
-0000bda0: 7479 7065 3d6e 702e 666c 6f61 7429 297d  type=np.float))}
-0000bdb0: 0d0a 2020 2020 2020 2020 2020 2020 6865  ..            he
-0000bdc0: 6164 5f65 6469 5f6c 6174 203d 2063 6f70  ad_edi_lat = cop
-0000bdd0: 792e 6465 6570 636f 7079 2868 6561 645f  y.deepcopy(head_
-0000bde0: 6564 695f 6c6f 6e29 0d0a 2020 2020 2020  edi_lon)..      
-0000bdf0: 2020 2020 2020 6865 6164 5f65 6469 5f65        head_edi_e
-0000be00: 6c65 7620 3d20 636f 7079 2e64 6565 7063  lev = copy.deepc
-0000be10: 6f70 7928 6865 6164 5f65 6469 5f6c 6f6e  opy(head_edi_lon
-0000be20: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-0000be30: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0000be40: 6c66 2e70 726f 6669 6c65 5f66 6e20 6973  lf.profile_fn is
-0000be50: 206e 6f74 204e 6f6e 6520 3a20 0d0a 2020   not None : ..  
-0000be60: 2020 2020 2020 2020 2020 2068 6561 645f             head_
-0000be70: 6564 695f 6c6f 6e20 3d20 7369 7465 5f6f  edi_lon = site_o
-0000be80: 626a 2e6c 6f6e 0d0a 2020 2020 2020 2020  bj.lon..        
-0000be90: 2020 2020 2068 6561 645f 6564 695f 6c61       head_edi_la
-0000bea0: 7420 3d20 7369 7465 5f6f 626a 2e6c 6174  t = site_obj.lat
-0000beb0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000bec0: 6865 6164 5f65 6469 5f65 6c65 7620 3d20  head_edi_elev = 
-0000bed0: 7369 7465 5f6f 626a 2e65 6c65 7620 0d0a  site_obj.elev ..
-0000bee0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000bef0: 2020 232d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d    #-------------
-0000bf00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d53 5441 5254  -----------START
-0000bf10: 2053 4554 5449 4e47 2045 4449 2041 5454   SETTING EDI ATT
-0000bf20: 5249 4255 5445 202d 2d2d 2d2d 2d2d 2d2d  RIBUTE ---------
-0000bf30: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000bf40: 200d 0a20 2020 2020 2020 2023 2066 726f   ..        # fro
-0000bf50: 6d20 7079 6373 616d 742e 7574 696c 7320  m pycsamt.utils 
-0000bf60: 696d 706f 7274 2067 6973 5f74 6f6f 6c73  import gis_tools
-0000bf70: 2061 7320 6769 7320 0d0a 2020 2020 2020   as gis ..      
-0000bf80: 2020 2320 2020 666f 7220 7374 6e20 696e    #   for stn in
-0000bf90: 2068 6561 645f 6461 7461 6964 5f6c 6973   head_dataid_lis
-0000bfa0: 7420 3a20 236c 6f6f 7020 666f 7220 616c  t : #loop for al
-0000bfb0: 6c20 7374 6174 696f 6e20 6f72 2064 6174  l station or dat
-0000bfc0: 6169 6420 0d0a 2020 2020 2020 2020 666f  aid ..        fo
-0000bfd0: 7220 6969 2c20 7374 6e20 696e 2065 6e75  r ii, stn in enu
-0000bfe0: 6d65 7261 7465 2868 6561 645f 6461 7461  merate(head_data
-0000bff0: 6964 5f6c 6973 7429 3a20 0d0a 2020 2020  id_list): ..    
-0000c000: 2020 2020 2020 2020 2363 7265 6174 6520          #create 
-0000c010: 4564 696f 626a 2066 6f72 2065 6163 2064  Ediobj for eac d
-0000c020: 6174 616c 6973 7420 0d0a 2020 2020 2020  atalist ..      
-0000c030: 2020 2020 2020 6564 695f 6f62 6a20 3d45        edi_obj =E
-0000c040: 6469 2829 0d0a 2020 2020 2020 2020 2020  di()..          
-0000c050: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000c060: 233d 3d3d 3d3e 2073 6574 2065 6469 5f6f  #====> set edi_o
-0000c070: 626a 2048 6561 6465 7220 6174 7472 6962  bj Header attrib
-0000c080: 7574 6573 0d0a 2020 2020 2020 2020 2020  utes..          
-0000c090: 2020 6564 695f 6f62 6a2e 4865 6164 2e64    edi_obj.Head.d
-0000c0a0: 6174 6169 643d 2068 6561 645f 6461 7461  ataid= head_data
-0000c0b0: 6964 5f6c 6973 745b 6969 5d20 2320 6969  id_list[ii] # ii
-0000c0c0: 206d 6561 6e20 666f 7220 616c 6c20 7468   mean for all th
-0000c0d0: 6520 6c69 7374 200d 0a20 2020 2020 2020  e list ..       
-0000c0e0: 2020 2020 2065 6469 5f6f 626a 2e48 6561       edi_obj.Hea
-0000c0f0: 642e 6163 7162 7920 3d20 275a 6f6e 6765  d.acqby = 'Zonge
-0000c100: 2045 6e67 696e 6565 7269 6e67 270d 0a20   Engineering'.. 
-0000c110: 2020 2020 2020 2020 2020 2065 6469 5f6f             edi_o
-0000c120: 626a 2e48 6561 642e 6163 7164 6174 6520  bj.Head.acqdate 
-0000c130: 3d20 7365 6c66 2e48 6561 6465 722e 4861  = self.Header.Ha
-0000c140: 7264 7761 7265 496e 666f 732e 6461 7465  rdwareInfos.date
-0000c150: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
-0000c160: 6564 695f 6f62 6a2e 4865 6164 2e66 696c  edi_obj.Head.fil
-0000c170: 6562 7920 3d20 2241 4d54 4156 475f 762e  eby = "AMTAVG_v.
-0000c180: 7b30 7d22 2e66 6f72 6d61 7428 0d0a 2020  {0}".format(..  
-0000c190: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000c1a0: 6c66 2e48 6561 6465 722e 4861 7264 7761  lf.Header.Hardwa
-0000c1b0: 7265 496e 666f 732e 7665 7273 696f 6e29  reInfos.version)
-0000c1c0: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
-0000c1d0: 6620 7365 6c66 2e48 6561 6465 722e 5375  f self.Header.Su
-0000c1e0: 7276 6579 416e 6e6f 7461 7469 6f6e 2e70  rveyAnnotation.p
-0000c1f0: 726f 6a65 6374 5f6e 616d 6520 6973 204e  roject_name is N
-0000c200: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
-0000c210: 2020 2020 2020 2020 7365 6c66 2e48 6561          self.Hea
-0000c220: 6465 722e 5375 7276 6579 416e 6e6f 7461  der.SurveyAnnota
-0000c230: 7469 6f6e 2e5f 5f73 6574 6174 7472 5f5f  tion.__setattr__
-0000c240: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0000c250: 2020 2020 2020 2020 2770 726f 6a65 6374          'project
-0000c260: 5f6e 616d 6520 272c 6f73 2e70 6174 682e  _name ',os.path.
-0000c270: 6261 7365 6e61 6d65 2873 656c 662e 6461  basename(self.da
-0000c280: 7461 5f66 6e29 2920 0d0a 2020 2020 0d0a  ta_fn)) ..    ..
-0000c290: 2020 2020 2020 2020 2020 2020 6564 695f              edi_
-0000c2a0: 6f62 6a2e 4865 6164 2e6c 6f63 203d 206f  obj.Head.loc = o
-0000c2b0: 732e 7061 7468 2e62 6173 656e 616d 6528  s.path.basename(
-0000c2c0: 7365 6c66 2e64 6174 615f 666e 295b 3a2d  self.data_fn)[:-
-0000c2d0: 345d 0d0a 2020 2020 2020 2020 2020 2020  4]..            
-0000c2e0: 6564 695f 6f62 6a2e 4865 6164 2e66 696c  edi_obj.Head.fil
-0000c2f0: 6564 6174 6520 3d20 7365 6c66 2e48 6561  edate = self.Hea
-0000c300: 6465 722e 4861 7264 7761 7265 496e 666f  der.HardwareInfo
-0000c310: 732e 7072 6f63 6573 7365 640d 0a20 2020  s.processed..   
-0000c320: 2020 2020 2020 2020 2065 6469 5f6f 626a           edi_obj
-0000c330: 2e48 6561 642e 7072 6f73 7065 6374 203d  .Head.prospect =
-0000c340: 2073 656c 662e 4865 6164 6572 2e53 7572   self.Header.Sur
-0000c350: 7665 7941 6e6e 6f74 6174 696f 6e2e 636f  veyAnnotation.co
-0000c360: 6e74 7261 6374 6f72 5f6e 616d 650d 0a20  ntractor_name.. 
-0000c370: 2020 2020 2020 2020 2020 2065 6469 5f6f             edi_o
-0000c380: 626a 2e48 6561 642e 636f 756e 7479 203d  bj.Head.county =
-0000c390: 2073 656c 662e 4865 6164 6572 2e53 7572   self.Header.Sur
-0000c3a0: 7665 7941 6e6e 6f74 6174 696f 6e2e 7072  veyAnnotation.pr
-0000c3b0: 6f6a 6563 745f 6172 6561 200d 0a20 2020  oject_area ..   
-0000c3c0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000c3d0: 2020 2020 2020 2065 6469 5f6f 626a 2e48         edi_obj.H
-0000c3e0: 6561 642e 6c61 7420 3d20 6865 6164 5f65  ead.lat = head_e
-0000c3f0: 6469 5f6c 6174 5b73 746e 5d0d 0a20 2020  di_lat[stn]..   
-0000c400: 2020 2020 2020 2020 2065 6469 5f6f 626a           edi_obj
-0000c410: 2e48 6561 642e 6c6f 6e67 203d 2068 6561  .Head.long = hea
-0000c420: 645f 6564 695f 6c6f 6e5b 7374 6e5d 0d0a  d_edi_lon[stn]..
-0000c430: 2020 2020 2020 2020 2020 2020 6564 695f              edi_
-0000c440: 6f62 6a2e 4865 6164 2e65 6c65 7620 3d20  obj.Head.elev = 
-0000c450: 726f 756e 6428 6865 6164 5f65 6469 5f65  round(head_edi_e
-0000c460: 6c65 765b 7374 6e5d 2c32 290d 0a20 2020  lev[stn],2)..   
-0000c470: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000c480: 2020 2020 2020 2065 6469 5f6f 626a 2e48         edi_obj.H
-0000c490: 6561 642e 6d61 7873 6563 7420 3d31 3030  ead.maxsect =100
-0000c4a0: 300d 0a20 2020 2020 2020 2020 2020 200d  0..            .
-0000c4b0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0000c4c0: 2020 2020 2020 2020 2020 2023 3d3d 3d3d             #====
-0000c4d0: 3d3e 2020 7365 7420 6564 695f 6f62 6a5f  =>  set edi_obj_
-0000c4e0: 696e 666f 202e 200d 0a20 2020 2020 2020  info . ..       
-0000c4f0: 2020 2020 2023 2065 6469 5f6f 626a 2e49       # edi_obj.I
-0000c500: 6e66 6f2e 6d61 7869 6e66 6f20 3d20 3939  nfo.maxinfo = 99
-0000c510: 390d 0a20 2020 2020 2020 2020 2020 2065  9..            e
-0000c520: 6469 5f6f 626a 2e49 6e66 6f2e 6669 6c74  di_obj.Info.filt
-0000c530: 6572 203d 7365 6c66 2e48 6561 6465 722e  er =self.Header.
-0000c540: 4861 7264 7761 7265 496e 666f 732e 6672  HardwareInfos.fr
-0000c550: 6571 5f66 696c 7465 720d 0a20 2020 2020  eq_filter..     
-0000c560: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000c570: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000c580: 2020 2020 2020 6564 695f 6f62 6a2e 496e        edi_obj.In
-0000c590: 666f 2e53 6f75 7263 652e 5f5f 7365 7461  fo.Source.__seta
-0000c5a0: 7474 725f 5f28 0d0a 2020 2020 2020 2020  ttr__(..        
-0000c5b0: 2020 2020 2020 2020 2770 726f 6a65 6374          'project
-0000c5c0: 272c 2073 656c 662e 4865 6164 6572 2e53  ', self.Header.S
-0000c5d0: 7572 7665 7941 6e6e 6f74 6174 696f 6e2e  urveyAnnotation.
-0000c5e0: 7072 6f6a 6563 745f 6e61 6d65 290d 0a20  project_name).. 
-0000c5f0: 2020 2020 2020 2020 2020 2065 6469 5f6f             edi_o
-0000c600: 626a 2e49 6e66 6f2e 536f 7572 6365 2e5f  bj.Info.Source._
-0000c610: 5f73 6574 6174 7472 5f5f 2827 7375 7276  _setattr__('surv
-0000c620: 6579 272c 2020 6865 6164 5f64 6174 6169  ey',  head_datai
-0000c630: 645f 6c69 7374 5b69 695d 290d 0a20 2020  d_list[ii])..   
-0000c640: 2020 2020 2020 2020 2065 6469 5f6f 626a           edi_obj
-0000c650: 2e49 6e66 6f2e 536f 7572 6365 2e5f 5f73  .Info.Source.__s
-0000c660: 6574 6174 7472 5f5f 2827 7369 7465 6e61  etattr__('sitena
-0000c670: 6d65 272c 2068 6561 645f 6461 7461 6964  me', head_dataid
-0000c680: 5f6c 6973 745b 6969 5d29 0d0a 2020 2020  _list[ii])..    
-0000c690: 2020 2020 2020 2020 6564 695f 6f62 6a2e          edi_obj.
-0000c6a0: 496e 666f 2e50 726f 6365 7373 696e 672e  Info.Processing.
-0000c6b0: 5f5f 7365 7461 7474 725f 5f28 2770 726f  __setattr__('pro
-0000c6c0: 6365 7373 6564 6279 272c 2027 7079 4353  cessedby', 'pyCS
-0000c6d0: 414d 5427 2029 0d0a 2020 2020 2020 2020  AMT' )..        
-0000c6e0: 2020 2020 6564 695f 6f62 6a2e 496e 666f      edi_obj.Info
-0000c6f0: 2e50 726f 6365 7373 696e 672e 5072 6f63  .Processing.Proc
-0000c700: 6573 7369 6e67 536f 6674 7761 7265 2e5f  essingSoftware._
-0000c710: 5f73 6574 6174 7472 5f5f 280d 0a20 2020  _setattr__(..   
-0000c720: 2020 2020 2020 2020 2020 2020 2027 6e61               'na
-0000c730: 6d65 272c 2065 6469 5f6f 626a 2e48 6561  me', edi_obj.Hea
-0000c740: 642e 6669 6c65 6279 2029 0d0a 2020 2020  d.fileby )..    
-0000c750: 2020 2020 2020 2020 0d0a 2020 2020 0d0a          ..    ..
-0000c760: 2020 2020 2020 2020 2020 2020 233d 3d3d              #===
-0000c770: 3d3e 2064 6566 696e 656d 6561 7320 0d0a  => definemeas ..
-0000c780: 2020 2020 2020 2020 2020 2020 6564 695f              edi_
-0000c790: 6f62 6a2e 4465 6669 6e65 4d65 6173 7572  obj.DefineMeasur
-0000c7a0: 656d 656e 742e 6d61 7863 6861 6e20 3d34  ement.maxchan =4
-0000c7b0: 0d0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
-0000c7c0: 695f 6f62 6a2e 4465 6669 6e65 4d65 6173  i_obj.DefineMeas
-0000c7d0: 7572 656d 656e 742e 6d61 7872 756e 203d  urement.maxrun =
-0000c7e0: 206c 656e 2868 6561 645f 6461 7461 6964   len(head_dataid
-0000c7f0: 5f6c 6973 7429 0d0a 2020 2020 2020 2020  _list)..        
-0000c800: 2020 2020 6564 695f 6f62 6a2e 4465 6669      edi_obj.Defi
-0000c810: 6e65 4d65 6173 7572 656d 656e 742e 5f5f  neMeasurement.__
-0000c820: 7365 7461 7474 725f 5f28 2772 6566 7479  setattr__('refty
-0000c830: 7065 2720 2c27 4341 5254 6573 6965 6e27  pe' ,'CARTesien'
-0000c840: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0000c850: 6469 5f6f 626a 2e44 6566 696e 654d 6561  di_obj.DefineMea
-0000c860: 7375 7265 6d65 6e74 2e5f 5f73 6574 6174  surement.__setat
-0000c870: 7472 5f5f 2827 7265 666c 6174 272c 6564  tr__('reflat',ed
-0000c880: 695f 6f62 6a2e 4865 6164 2e6c 6174 2020  i_obj.Head.lat  
-0000c890: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
-0000c8a0: 6564 695f 6f62 6a2e 4465 6669 6e65 4d65  edi_obj.DefineMe
-0000c8b0: 6173 7572 656d 656e 742e 5f5f 7365 7461  asurement.__seta
-0000c8c0: 7474 725f 5f28 2772 6566 6c6f 6e67 272c  ttr__('reflong',
-0000c8d0: 2065 6469 5f6f 626a 2e48 6561 642e 6c6f   edi_obj.Head.lo
-0000c8e0: 6e67 2920 0d0a 2020 2020 2020 2020 2020  ng) ..          
-0000c8f0: 2020 6564 695f 6f62 6a2e 4465 6669 6e65    edi_obj.Define
-0000c900: 4d65 6173 7572 656d 656e 742e 5f5f 7365  Measurement.__se
-0000c910: 7461 7474 725f 5f28 2772 6566 656c 6576  tattr__('refelev
-0000c920: 272c 726f 756e 6428 6564 695f 6f62 6a2e  ',round(edi_obj.
-0000c930: 4865 6164 2e65 6c65 762c 3229 290d 0a20  Head.elev,2)).. 
-0000c940: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000c950: 2020 2020 2020 2020 2023 2063 7265 6174           # creat
-0000c960: 696e 6720 7878 6d65 6173 206f 626a 6563  ing xxmeas objec
-0000c970: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-0000c980: 636f 6465 4944 5f64 6563 203d 2027 7b30  codeID_dec = '{0
-0000c990: 7d27 2e66 6f72 6d61 7428 2869 692b 3129  }'.format((ii+1)
-0000c9a0: 2f65 6469 5f6f 626a 2e48 6561 642e 6d61  /edi_obj.Head.ma
-0000c9b0: 7873 6563 7429 0d0a 2020 2020 2020 2020  xsect)..        
-0000c9c0: 2020 2020 2320 636f 6465 4944 3d20 2027      # codeID=  '
-0000c9d0: 7b30 3a30 347d 7b31 7d27 2e66 6f72 6d61  {0:04}{1}'.forma
-0000c9e0: 7428 6969 202a 2031 3020 2b20 3120 2c20  t(ii * 10 + 1 , 
-0000c9f0: 636f 6465 4944 5f64 6563 5b31 3a5d 2029  codeID_dec[1:] )
-0000ca00: 0d0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
-0000ca10: 695f 6f62 6a2e 4465 6669 6e65 4d65 6173  i_obj.DefineMeas
-0000ca20: 7572 656d 656e 742e 5f5f 7365 7461 7474  urement.__setatt
-0000ca30: 725f 5f28 0d0a 2020 2020 2020 2020 2020  r__(..          
-0000ca40: 2020 2020 2020 276d 6561 735f 6578 272c        'meas_ex',
-0000ca50: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000ca60: 2020 2045 6d65 6173 7572 656d 656e 7428     Emeasurement(
-0000ca70: 2a2a 7b27 6964 273a 277b 303a 3034 7d7b  **{'id':'{0:04}{
-0000ca80: 317d 272e 666f 726d 6174 2869 6920 2a20  1}'.format(ii * 
-0000ca90: 3130 202b 2031 202c 200d 0a20 2020 2020  10 + 1 , ..     
-0000caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bba0: 2020 6e70 2e7a 6572 6f73 5f6c 696b 6528    np.zeros_like(
+0000bbb0: 6c65 6e28 6865 6164 5f64 6174 6169 645f  len(head_dataid_
+0000bbc0: 6c69 7374 292c 2064 7479 7065 3d6e 702e  list), dtype=np.
+0000bbd0: 666c 6f61 7429 297d 0d0a 2020 2020 2020  float))}..      
+0000bbe0: 2020 2020 2020 6865 6164 5f65 6469 5f6c        head_edi_l
+0000bbf0: 6174 203d 2063 6f70 792e 6465 6570 636f  at = copy.deepco
+0000bc00: 7079 2868 6561 645f 6564 695f 6c6f 6e29  py(head_edi_lon)
+0000bc10: 0d0a 2020 2020 2020 2020 2020 2020 6865  ..            he
+0000bc20: 6164 5f65 6469 5f65 6c65 7620 3d20 636f  ad_edi_elev = co
+0000bc30: 7079 2e64 6565 7063 6f70 7928 6865 6164  py.deepcopy(head
+0000bc40: 5f65 6469 5f6c 6f6e 290d 0a20 2020 2020  _edi_lon)..     
+0000bc50: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000bc60: 2065 6c69 6620 7365 6c66 2e70 726f 6669   elif self.profi
+0000bc70: 6c65 5f66 6e20 6973 206e 6f74 204e 6f6e  le_fn is not Non
+0000bc80: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+0000bc90: 2020 2068 6561 645f 6564 695f 6c6f 6e20     head_edi_lon 
+0000bca0: 3d20 7369 7465 5f6f 626a 2e6c 6f6e 0d0a  = site_obj.lon..
+0000bcb0: 2020 2020 2020 2020 2020 2020 2068 6561               hea
+0000bcc0: 645f 6564 695f 6c61 7420 3d20 7369 7465  d_edi_lat = site
+0000bcd0: 5f6f 626a 2e6c 6174 200d 0a20 2020 2020  _obj.lat ..     
+0000bce0: 2020 2020 2020 2020 6865 6164 5f65 6469          head_edi
+0000bcf0: 5f65 6c65 7620 3d20 7369 7465 5f6f 626a  _elev = site_obj
+0000bd00: 2e65 6c65 7620 0d0a 2020 2020 2020 2020  .elev ..        
+0000bd10: 0d0a 2020 2020 2020 2020 232d 2d2d 2d2d  ..        #-----
+0000bd20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000bd30: 2d2d 2d53 5441 5254 2053 4554 5449 4e47  ---START SETTING
+0000bd40: 2045 4449 2041 5454 5249 4255 5445 202d   EDI ATTRIBUTE -
+0000bd50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
+0000bd60: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0000bd70: 2020 2023 2066 726f 6d20 7079 6373 616d     # from pycsam
+0000bd80: 742e 7574 696c 7320 696d 706f 7274 2067  t.utils import g
+0000bd90: 6973 5f74 6f6f 6c73 2061 7320 6769 7320  is_tools as gis 
+0000bda0: 0d0a 2020 2020 2020 2020 2320 2020 666f  ..        #   fo
+0000bdb0: 7220 7374 6e20 696e 2068 6561 645f 6461  r stn in head_da
+0000bdc0: 7461 6964 5f6c 6973 7420 3a20 236c 6f6f  taid_list : #loo
+0000bdd0: 7020 666f 7220 616c 6c20 7374 6174 696f  p for all statio
+0000bde0: 6e20 6f72 2064 6174 6169 6420 0d0a 2020  n or dataid ..  
+0000bdf0: 2020 2020 2020 666f 7220 6969 2c20 7374        for ii, st
+0000be00: 6e20 696e 2065 6e75 6d65 7261 7465 2868  n in enumerate(h
+0000be10: 6561 645f 6461 7461 6964 5f6c 6973 7429  ead_dataid_list)
+0000be20: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0000be30: 2363 7265 6174 6520 4564 696f 626a 2066  #create Ediobj f
+0000be40: 6f72 2065 6163 2064 6174 616c 6973 7420  or eac datalist 
+0000be50: 0d0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
+0000be60: 695f 6f62 6a20 3d45 6469 2829 0d0a 2020  i_obj =Edi()..  
+0000be70: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000be80: 2020 2020 2020 2020 233d 3d3d 3d3e 2073          #====> s
+0000be90: 6574 2065 6469 5f6f 626a 2048 6561 6465  et edi_obj Heade
+0000bea0: 7220 6174 7472 6962 7574 6573 0d0a 2020  r attributes..  
+0000beb0: 2020 2020 2020 2020 2020 6564 695f 6f62            edi_ob
+0000bec0: 6a2e 4865 6164 2e64 6174 6169 643d 2068  j.Head.dataid= h
+0000bed0: 6561 645f 6461 7461 6964 5f6c 6973 745b  ead_dataid_list[
+0000bee0: 6969 5d20 2320 6969 206d 6561 6e20 666f  ii] # ii mean fo
+0000bef0: 7220 616c 6c20 7468 6520 6c69 7374 200d  r all the list .
+0000bf00: 0a20 2020 2020 2020 2020 2020 2065 6469  .            edi
+0000bf10: 5f6f 626a 2e48 6561 642e 6163 7162 7920  _obj.Head.acqby 
+0000bf20: 3d20 275a 6f6e 6765 2045 6e67 696e 6565  = 'Zonge Enginee
+0000bf30: 7269 6e67 270d 0a20 2020 2020 2020 2020  ring'..         
+0000bf40: 2020 2065 6469 5f6f 626a 2e48 6561 642e     edi_obj.Head.
+0000bf50: 6163 7164 6174 6520 3d20 7365 6c66 2e48  acqdate = self.H
+0000bf60: 6561 6465 722e 4861 7264 7761 7265 496e  eader.HardwareIn
+0000bf70: 666f 732e 6461 7465 6420 0d0a 2020 2020  fos.dated ..    
+0000bf80: 2020 2020 2020 2020 6564 695f 6f62 6a2e          edi_obj.
+0000bf90: 4865 6164 2e66 696c 6562 7920 3d20 2241  Head.fileby = "A
+0000bfa0: 4d54 4156 475f 762e 7b30 7d22 2e66 6f72  MTAVG_v.{0}".for
+0000bfb0: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
+0000bfc0: 2020 2020 2020 7365 6c66 2e48 6561 6465        self.Heade
+0000bfd0: 722e 4861 7264 7761 7265 496e 666f 732e  r.HardwareInfos.
+0000bfe0: 7665 7273 696f 6e29 200d 0a20 2020 2020  version) ..     
+0000bff0: 2020 2020 2020 2069 6620 7365 6c66 2e48         if self.H
+0000c000: 6561 6465 722e 5375 7276 6579 416e 6e6f  eader.SurveyAnno
+0000c010: 7461 7469 6f6e 2e70 726f 6a65 6374 5f6e  tation.project_n
+0000c020: 616d 6520 6973 204e 6f6e 6520 3a0d 0a20  ame is None :.. 
+0000c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c040: 7365 6c66 2e48 6561 6465 722e 5375 7276  self.Header.Surv
+0000c050: 6579 416e 6e6f 7461 7469 6f6e 2e5f 5f73  eyAnnotation.__s
+0000c060: 6574 6174 7472 5f5f 280d 0a20 2020 2020  etattr__(..     
+0000c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c080: 2770 726f 6a65 6374 5f6e 616d 6520 272c  'project_name ',
+0000c090: 6f73 2e70 6174 682e 6261 7365 6e61 6d65  os.path.basename
+0000c0a0: 2873 656c 662e 6461 7461 5f66 6e29 2920  (self.data_fn)) 
+0000c0b0: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
+0000c0c0: 2020 2020 6564 695f 6f62 6a2e 4865 6164      edi_obj.Head
+0000c0d0: 2e6c 6f63 203d 206f 732e 7061 7468 2e62  .loc = os.path.b
+0000c0e0: 6173 656e 616d 6528 7365 6c66 2e64 6174  asename(self.dat
+0000c0f0: 615f 666e 295b 3a2d 345d 0d0a 2020 2020  a_fn)[:-4]..    
+0000c100: 2020 2020 2020 2020 6564 695f 6f62 6a2e          edi_obj.
+0000c110: 4865 6164 2e66 696c 6564 6174 6520 3d20  Head.filedate = 
+0000c120: 7365 6c66 2e48 6561 6465 722e 4861 7264  self.Header.Hard
+0000c130: 7761 7265 496e 666f 732e 7072 6f63 6573  wareInfos.proces
+0000c140: 7365 640d 0a20 2020 2020 2020 2020 2020  sed..           
+0000c150: 2065 6469 5f6f 626a 2e48 6561 642e 7072   edi_obj.Head.pr
+0000c160: 6f73 7065 6374 203d 2073 656c 662e 4865  ospect = self.He
+0000c170: 6164 6572 2e53 7572 7665 7941 6e6e 6f74  ader.SurveyAnnot
+0000c180: 6174 696f 6e2e 636f 6e74 7261 6374 6f72  ation.contractor
+0000c190: 5f6e 616d 650d 0a20 2020 2020 2020 2020  _name..         
+0000c1a0: 2020 2065 6469 5f6f 626a 2e48 6561 642e     edi_obj.Head.
+0000c1b0: 636f 756e 7479 203d 2073 656c 662e 4865  county = self.He
+0000c1c0: 6164 6572 2e53 7572 7665 7941 6e6e 6f74  ader.SurveyAnnot
+0000c1d0: 6174 696f 6e2e 7072 6f6a 6563 745f 6172  ation.project_ar
+0000c1e0: 6561 200d 0a20 2020 2020 2020 2020 2020  ea ..           
+0000c1f0: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
+0000c200: 6469 5f6f 626a 2e48 6561 642e 6c61 7420  di_obj.Head.lat 
+0000c210: 3d20 6865 6164 5f65 6469 5f6c 6174 5b73  = head_edi_lat[s
+0000c220: 746e 5d0d 0a20 2020 2020 2020 2020 2020  tn]..           
+0000c230: 2065 6469 5f6f 626a 2e48 6561 642e 6c6f   edi_obj.Head.lo
+0000c240: 6e67 203d 2068 6561 645f 6564 695f 6c6f  ng = head_edi_lo
+0000c250: 6e5b 7374 6e5d 0d0a 2020 2020 2020 2020  n[stn]..        
+0000c260: 2020 2020 6564 695f 6f62 6a2e 4865 6164      edi_obj.Head
+0000c270: 2e65 6c65 7620 3d20 726f 756e 6428 6865  .elev = round(he
+0000c280: 6164 5f65 6469 5f65 6c65 765b 7374 6e5d  ad_edi_elev[stn]
+0000c290: 2c32 290d 0a20 2020 2020 2020 2020 2020  ,2)..           
+0000c2a0: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
+0000c2b0: 6469 5f6f 626a 2e48 6561 642e 6d61 7873  di_obj.Head.maxs
+0000c2c0: 6563 7420 3d31 3030 300d 0a20 2020 2020  ect =1000..     
+0000c2d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000c2e0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000c2f0: 2020 2023 3d3d 3d3d 3d3e 2020 7365 7420     #=====>  set 
+0000c300: 6564 695f 6f62 6a5f 696e 666f 202e 200d  edi_obj_info . .
+0000c310: 0a20 2020 2020 2020 2020 2020 2023 2065  .            # e
+0000c320: 6469 5f6f 626a 2e49 6e66 6f2e 6d61 7869  di_obj.Info.maxi
+0000c330: 6e66 6f20 3d20 3939 390d 0a20 2020 2020  nfo = 999..     
+0000c340: 2020 2020 2020 2065 6469 5f6f 626a 2e49         edi_obj.I
+0000c350: 6e66 6f2e 6669 6c74 6572 203d 7365 6c66  nfo.filter =self
+0000c360: 2e48 6561 6465 722e 4861 7264 7761 7265  .Header.Hardware
+0000c370: 496e 666f 732e 6672 6571 5f66 696c 7465  Infos.freq_filte
+0000c380: 720d 0a20 2020 2020 2020 2020 2020 200d  r..            .
+0000c390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c3a0: 0d0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
+0000c3b0: 695f 6f62 6a2e 496e 666f 2e53 6f75 7263  i_obj.Info.Sourc
+0000c3c0: 652e 5f5f 7365 7461 7474 725f 5f28 0d0a  e.__setattr__(..
+0000c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3e0: 2770 726f 6a65 6374 272c 2073 656c 662e  'project', self.
+0000c3f0: 4865 6164 6572 2e53 7572 7665 7941 6e6e  Header.SurveyAnn
+0000c400: 6f74 6174 696f 6e2e 7072 6f6a 6563 745f  otation.project_
+0000c410: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
+0000c420: 2020 2065 6469 5f6f 626a 2e49 6e66 6f2e     edi_obj.Info.
+0000c430: 536f 7572 6365 2e5f 5f73 6574 6174 7472  Source.__setattr
+0000c440: 5f5f 2827 7375 7276 6579 272c 2020 6865  __('survey',  he
+0000c450: 6164 5f64 6174 6169 645f 6c69 7374 5b69  ad_dataid_list[i
+0000c460: 695d 290d 0a20 2020 2020 2020 2020 2020  i])..           
+0000c470: 2065 6469 5f6f 626a 2e49 6e66 6f2e 536f   edi_obj.Info.So
+0000c480: 7572 6365 2e5f 5f73 6574 6174 7472 5f5f  urce.__setattr__
+0000c490: 2827 7369 7465 6e61 6d65 272c 2068 6561  ('sitename', hea
+0000c4a0: 645f 6461 7461 6964 5f6c 6973 745b 6969  d_dataid_list[ii
+0000c4b0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0000c4c0: 6564 695f 6f62 6a2e 496e 666f 2e50 726f  edi_obj.Info.Pro
+0000c4d0: 6365 7373 696e 672e 5f5f 7365 7461 7474  cessing.__setatt
+0000c4e0: 725f 5f28 2770 726f 6365 7373 6564 6279  r__('processedby
+0000c4f0: 272c 2027 7079 4353 414d 5427 2029 0d0a  ', 'pyCSAMT' )..
+0000c500: 2020 2020 2020 2020 2020 2020 6564 695f              edi_
+0000c510: 6f62 6a2e 496e 666f 2e50 726f 6365 7373  obj.Info.Process
+0000c520: 696e 672e 5072 6f63 6573 7369 6e67 536f  ing.ProcessingSo
+0000c530: 6674 7761 7265 2e5f 5f73 6574 6174 7472  ftware.__setattr
+0000c540: 5f5f 280d 0a20 2020 2020 2020 2020 2020  __(..           
+0000c550: 2020 2020 2027 6e61 6d65 272c 2065 6469       'name', edi
+0000c560: 5f6f 626a 2e48 6561 642e 6669 6c65 6279  _obj.Head.fileby
+0000c570: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+0000c580: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
+0000c590: 2020 2020 233d 3d3d 3d3e 2064 6566 696e      #====> defin
+0000c5a0: 656d 6561 7320 0d0a 2020 2020 2020 2020  emeas ..        
+0000c5b0: 2020 2020 6564 695f 6f62 6a2e 4465 6669      edi_obj.Defi
+0000c5c0: 6e65 4d65 6173 7572 656d 656e 742e 6d61  neMeasurement.ma
+0000c5d0: 7863 6861 6e20 3d34 0d0a 2020 2020 2020  xchan =4..      
+0000c5e0: 2020 2020 2020 6564 695f 6f62 6a2e 4465        edi_obj.De
+0000c5f0: 6669 6e65 4d65 6173 7572 656d 656e 742e  fineMeasurement.
+0000c600: 6d61 7872 756e 203d 206c 656e 2868 6561  maxrun = len(hea
+0000c610: 645f 6461 7461 6964 5f6c 6973 7429 0d0a  d_dataid_list)..
+0000c620: 2020 2020 2020 2020 2020 2020 6564 695f              edi_
+0000c630: 6f62 6a2e 4465 6669 6e65 4d65 6173 7572  obj.DefineMeasur
+0000c640: 656d 656e 742e 5f5f 7365 7461 7474 725f  ement.__setattr_
+0000c650: 5f28 2772 6566 7479 7065 2720 2c27 4341  _('reftype' ,'CA
+0000c660: 5254 6573 6965 6e27 290d 0a20 2020 2020  RTesien')..     
+0000c670: 2020 2020 2020 2065 6469 5f6f 626a 2e44         edi_obj.D
+0000c680: 6566 696e 654d 6561 7375 7265 6d65 6e74  efineMeasurement
+0000c690: 2e5f 5f73 6574 6174 7472 5f5f 2827 7265  .__setattr__('re
+0000c6a0: 666c 6174 272c 6564 695f 6f62 6a2e 4865  flat',edi_obj.He
+0000c6b0: 6164 2e6c 6174 2020 2920 0d0a 2020 2020  ad.lat  ) ..    
+0000c6c0: 2020 2020 2020 2020 6564 695f 6f62 6a2e          edi_obj.
+0000c6d0: 4465 6669 6e65 4d65 6173 7572 656d 656e  DefineMeasuremen
+0000c6e0: 742e 5f5f 7365 7461 7474 725f 5f28 2772  t.__setattr__('r
+0000c6f0: 6566 6c6f 6e67 272c 2065 6469 5f6f 626a  eflong', edi_obj
+0000c700: 2e48 6561 642e 6c6f 6e67 2920 0d0a 2020  .Head.long) ..  
+0000c710: 2020 2020 2020 2020 2020 6564 695f 6f62            edi_ob
+0000c720: 6a2e 4465 6669 6e65 4d65 6173 7572 656d  j.DefineMeasurem
+0000c730: 656e 742e 5f5f 7365 7461 7474 725f 5f28  ent.__setattr__(
+0000c740: 2772 6566 656c 6576 272c 726f 756e 6428  'refelev',round(
+0000c750: 6564 695f 6f62 6a2e 4865 6164 2e65 6c65  edi_obj.Head.ele
+0000c760: 762c 3229 290d 0a20 2020 2020 2020 2020  v,2))..         
+0000c770: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000c780: 2023 2063 7265 6174 696e 6720 7878 6d65   # creating xxme
+0000c790: 6173 206f 626a 6563 7420 0d0a 2020 2020  as object ..    
+0000c7a0: 2020 2020 2020 2020 636f 6465 4944 5f64          codeID_d
+0000c7b0: 6563 203d 2027 7b30 7d27 2e66 6f72 6d61  ec = '{0}'.forma
+0000c7c0: 7428 2869 692b 3129 2f65 6469 5f6f 626a  t((ii+1)/edi_obj
+0000c7d0: 2e48 6561 642e 6d61 7873 6563 7429 0d0a  .Head.maxsect)..
+0000c7e0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+0000c7f0: 6465 4944 3d20 2027 7b30 3a30 347d 7b31  deID=  '{0:04}{1
+0000c800: 7d27 2e66 6f72 6d61 7428 6969 202a 2031  }'.format(ii * 1
+0000c810: 3020 2b20 3120 2c20 636f 6465 4944 5f64  0 + 1 , codeID_d
+0000c820: 6563 5b31 3a5d 2029 0d0a 2020 2020 2020  ec[1:] )..      
+0000c830: 2020 2020 2020 6564 695f 6f62 6a2e 4465        edi_obj.De
+0000c840: 6669 6e65 4d65 6173 7572 656d 656e 742e  fineMeasurement.
+0000c850: 5f5f 7365 7461 7474 725f 5f28 0d0a 2020  __setattr__(..  
+0000c860: 2020 2020 2020 2020 2020 2020 2020 276d                'm
+0000c870: 6561 735f 6578 272c 200d 0a20 2020 2020  eas_ex', ..     
+0000c880: 2020 2020 2020 2020 2020 2045 6d65 6173             Emeas
+0000c890: 7572 656d 656e 7428 2a2a 7b27 6964 273a  urement(**{'id':
+0000c8a0: 277b 303a 3034 7d7b 317d 272e 666f 726d  '{0:04}{1}'.form
+0000c8b0: 6174 2869 6920 2a20 3130 202b 2031 202c  at(ii * 10 + 1 ,
+0000c8c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c8f0: 2020 2020 2020 2020 2020 2063 6f64 6549             codeI
+0000c900: 445f 6465 635b 313a 5d20 292c 200d 0a20  D_dec[1:] ), .. 
+0000c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c930: 2020 2020 2020 2027 6368 7479 7065 273a         'chtype':
+0000c940: 2745 5827 2c20 0d0a 2020 2020 2020 2020  'EX', ..        
+0000c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c970: 2778 273a 202d 2864 6970 6f6c 655f 6c65  'x': -(dipole_le
+0000c980: 6e67 7468 2f32 292c 200d 0a20 2020 2020  ngth/2), ..     
+0000c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9b0: 2020 2027 7927 3a20 302e 2c0d 0a20 2020     'y': 0.,..   
+0000c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9e0: 2020 2020 2027 7832 273a 6469 706f 6c65       'x2':dipole
+0000c9f0: 5f6c 656e 6774 682f 3220 2c20 0d0a 2020  _length/2 , ..  
+0000ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca20: 2020 2020 2020 2779 3227 3a30 2c20 0d0a        'y2':0, ..
+0000ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca50: 2020 2020 2020 2020 2761 6371 6368 616e          'acqchan
+0000ca60: 273a 2027 302e 3030 272c 200d 0a20 2020  ': '0.00', ..   
+0000ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca90: 2020 2020 2027 6669 6c74 6572 273a 6176       'filter':av
+0000caa0: 6766 696c 7465 722c 200d 0a20 2020 2020  gfilter, ..     
 0000cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cad0: 2020 2063 6f64 6549 445f 6465 635b 313a     codeID_dec[1:
-0000cae0: 5d20 292c 200d 0a20 2020 2020 2020 2020  ] ), ..         
-0000caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb00: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000cb10: 6368 7479 7065 273a 2745 5827 2c20 0d0a  chtype':'EX', ..
-0000cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb40: 2020 2020 2020 2020 2778 273a 202d 2864          'x': -(d
-0000cb50: 6970 6f6c 655f 6c65 6e67 7468 2f32 292c  ipole_length/2),
-0000cb60: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb80: 2020 2020 2020 2020 2020 2027 7927 3a20             'y': 
-0000cb90: 302e 2c0d 0a20 2020 2020 2020 2020 2020  0.,..           
-0000cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cbb0: 2020 2020 2020 2020 2020 2020 2027 7832               'x2
-0000cbc0: 273a 6469 706f 6c65 5f6c 656e 6774 682f  ':dipole_length/
-0000cbd0: 3220 2c20 0d0a 2020 2020 2020 2020 2020  2 , ..          
-0000cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cbf0: 2020 2020 2020 2020 2020 2020 2020 2779                'y
-0000cc00: 3227 3a30 2c20 0d0a 2020 2020 2020 2020  2':0, ..        
-0000cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc30: 2761 6371 6368 616e 273a 2027 302e 3030  'acqchan': '0.00
-0000cc40: 272c 200d 0a20 2020 2020 2020 2020 2020  ', ..           
-0000cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc60: 2020 2020 2020 2020 2020 2020 2027 6669               'fi
-0000cc70: 6c74 6572 273a 6176 6766 696c 7465 722c  lter':avgfilter,
-0000cc80: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cca0: 2020 2020 2020 2020 2020 207d 2929 0d0a             }))..
-0000ccb0: 0d0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
-0000ccc0: 695f 6f62 6a2e 4465 6669 6e65 4d65 6173  i_obj.DefineMeas
-0000ccd0: 7572 656d 656e 742e 5f5f 7365 7461 7474  urement.__setatt
-0000cce0: 725f 5f28 0d0a 2020 2020 2020 2020 2020  r__(..          
-0000ccf0: 2020 2020 2020 276d 6561 735f 6579 272c        'meas_ey',
-0000cd00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000cd10: 2020 456d 6561 7375 7265 6d65 6e74 282a    Emeasurement(*
-0000cd20: 2a7b 2769 6427 3a27 7b30 3a30 347d 7b31  *{'id':'{0:04}{1
-0000cd30: 7d27 2e66 6f72 6d61 7428 6969 202a 2031  }'.format(ii * 1
-0000cd40: 3020 2b20 3220 2c20 0d0a 2020 2020 2020  0 + 2 , ..      
-0000cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd80: 2020 636f 6465 4944 5f64 6563 5b31 3a5d    codeID_dec[1:]
-0000cd90: 292c 200d 0a20 2020 2020 2020 2020 2020  ), ..           
-0000cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cdb0: 2020 2020 2020 2020 2020 2020 2027 6368               'ch
-0000cdc0: 7479 7065 273a 2745 5927 2c20 0d0a 2020  type':'EY', ..  
+0000cad0: 2020 207d 2929 0d0a 0d0a 2020 2020 2020     }))....      
+0000cae0: 2020 2020 2020 6564 695f 6f62 6a2e 4465        edi_obj.De
+0000caf0: 6669 6e65 4d65 6173 7572 656d 656e 742e  fineMeasurement.
+0000cb00: 5f5f 7365 7461 7474 725f 5f28 0d0a 2020  __setattr__(..  
+0000cb10: 2020 2020 2020 2020 2020 2020 2020 276d                'm
+0000cb20: 6561 735f 6579 272c 0d0a 2020 2020 2020  eas_ey',..      
+0000cb30: 2020 2020 2020 2020 2020 456d 6561 7375            Emeasu
+0000cb40: 7265 6d65 6e74 282a 2a7b 2769 6427 3a27  rement(**{'id':'
+0000cb50: 7b30 3a30 347d 7b31 7d27 2e66 6f72 6d61  {0:04}{1}'.forma
+0000cb60: 7428 6969 202a 2031 3020 2b20 3220 2c20  t(ii * 10 + 2 , 
+0000cb70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cba0: 2020 2020 2020 2020 2020 636f 6465 4944            codeID
+0000cbb0: 5f64 6563 5b31 3a5d 292c 200d 0a20 2020  _dec[1:]), ..   
+0000cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cbe0: 2020 2020 2027 6368 7479 7065 273a 2745       'chtype':'E
+0000cbf0: 5927 2c20 0d0a 2020 2020 2020 2020 2020  Y', ..          
+0000cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc10: 2020 2020 2020 2020 2020 2020 2020 2778                'x
+0000cc20: 273a 302e 2c20 0d0a 2020 2020 2020 2020  ':0., ..        
+0000cc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc50: 2779 273a 202d 2864 6970 6f6c 655f 6c65  'y': -(dipole_le
+0000cc60: 6e67 7468 2f32 292c 0d0a 2020 2020 2020  ngth/2),..      
+0000cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc90: 2020 2778 3227 3a30 2e2c 200d 0a20 2020    'x2':0., ..   
+0000cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ccc0: 2020 2020 2027 7932 273a 6469 706f 6c65       'y2':dipole
+0000ccd0: 5f6c 656e 6774 682f 3220 2c20 2761 6371  _length/2 , 'acq
+0000cce0: 6368 616e 273a 2027 302e 3030 272c 200d  chan': '0.00', .
+0000ccf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cd10: 2020 2020 2020 2020 2027 6669 6c74 6572           'filter
+0000cd20: 273a 6176 6766 696c 7465 727d 2929 0d0a  ':avgfilter}))..
+0000cd30: 0d0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
+0000cd40: 695f 6f62 6a2e 4465 6669 6e65 4d65 6173  i_obj.DefineMeas
+0000cd50: 7572 656d 656e 742e 5f5f 7365 7461 7474  urement.__setatt
+0000cd60: 725f 5f28 0d0a 2020 2020 2020 2020 2020  r__(..          
+0000cd70: 2020 2020 2020 276d 6561 735f 6878 272c        'meas_hx',
+0000cd80: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000cd90: 2020 2048 6d65 6173 7572 656d 656e 7428     Hmeasurement(
+0000cda0: 2a2a 7b27 6964 273a 277b 303a 3034 7d7b  **{'id':'{0:04}{
+0000cdb0: 317d 272e 666f 726d 6174 2869 6920 2a20  1}'.format(ii * 
+0000cdc0: 3130 202b 2033 202c 200d 0a20 2020 2020  10 + 3 , ..     
 0000cdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cdf0: 2020 2020 2020 2778 273a 302e 2c20 0d0a        'x':0., ..
-0000ce00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ce10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ce20: 2020 2020 2020 2020 2779 273a 202d 2864          'y': -(d
-0000ce30: 6970 6f6c 655f 6c65 6e67 7468 2f32 292c  ipole_length/2),
-0000ce40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ce60: 2020 2020 2020 2020 2020 2778 3227 3a30            'x2':0
-0000ce70: 2e2c 200d 0a20 2020 2020 2020 2020 2020  ., ..           
-0000ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ce90: 2020 2020 2020 2020 2020 2020 2027 7932               'y2
-0000cea0: 273a 6469 706f 6c65 5f6c 656e 6774 682f  ':dipole_length/
-0000ceb0: 3220 2c20 2761 6371 6368 616e 273a 2027  2 , 'acqchan': '
-0000cec0: 302e 3030 272c 200d 0a20 2020 2020 2020  0.00', ..       
+0000cdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce00: 2020 2063 6f64 6549 445f 6465 635b 313a     codeID_dec[1:
+0000ce10: 5d20 292c 200d 0a20 2020 2020 2020 2020  ] ), ..         
+0000ce20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce40: 2020 2027 6368 7479 7065 273a 2748 5827     'chtype':'HX'
+0000ce50: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0000ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce80: 2778 273a 302e 2c20 0d0a 2020 2020 2020  'x':0., ..      
+0000ce90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ceb0: 2020 2020 2020 2779 273a 2030 2e2c 0d0a        'y': 0.,..
+0000cec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cef0: 2027 6669 6c74 6572 273a 6176 6766 696c   'filter':avgfil
-0000cf00: 7465 727d 2929 0d0a 0d0a 2020 2020 2020  ter}))....      
-0000cf10: 2020 2020 2020 6564 695f 6f62 6a2e 4465        edi_obj.De
-0000cf20: 6669 6e65 4d65 6173 7572 656d 656e 742e  fineMeasurement.
-0000cf30: 5f5f 7365 7461 7474 725f 5f28 0d0a 2020  __setattr__(..  
-0000cf40: 2020 2020 2020 2020 2020 2020 2020 276d                'm
-0000cf50: 6561 735f 6878 272c 200d 0a20 2020 2020  eas_hx', ..     
-0000cf60: 2020 2020 2020 2020 2020 2048 6d65 6173             Hmeas
-0000cf70: 7572 656d 656e 7428 2a2a 7b27 6964 273a  urement(**{'id':
-0000cf80: 277b 303a 3034 7d7b 317d 272e 666f 726d  '{0:04}{1}'.form
-0000cf90: 6174 2869 6920 2a20 3130 202b 2033 202c  at(ii * 10 + 3 ,
-0000cfa0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cfd0: 2020 2020 2020 2020 2020 2063 6f64 6549             codeI
-0000cfe0: 445f 6465 635b 313a 5d20 292c 200d 0a20  D_dec[1:] ), .. 
-0000cff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d010: 2020 2020 2020 2020 2020 2027 6368 7479             'chty
-0000d020: 7065 273a 2748 5827 2c20 0d0a 2020 2020  pe':'HX', ..    
+0000cee0: 2020 2020 2020 2020 2020 2020 2778 3227              'x2'
+0000cef0: 3a30 2e2c 200d 0a20 2020 2020 2020 2020  :0., ..         
+0000cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf20: 2020 2027 7932 273a 302e 202c 2027 6163     'y2':0. , 'ac
+0000cf30: 7163 6861 6e27 3a20 2730 2e30 3027 2c20  qchan': '0.00', 
+0000cf40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf60: 2020 2020 2020 2020 2020 2766 696c 7465            'filte
+0000cf70: 7227 3a61 7667 6669 6c74 6572 7d29 290d  r':avgfilter})).
+0000cf80: 0a0d 0a20 2020 2020 2020 2020 2020 2065  ...            e
+0000cf90: 6469 5f6f 626a 2e44 6566 696e 654d 6561  di_obj.DefineMea
+0000cfa0: 7375 7265 6d65 6e74 2e5f 5f73 6574 6174  surement.__setat
+0000cfb0: 7472 5f5f 280d 0a20 2020 2020 2020 2020  tr__(..         
+0000cfc0: 2020 2020 2020 2027 6d65 6173 5f68 7927         'meas_hy'
+0000cfd0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000cfe0: 2020 2048 6d65 6173 7572 656d 656e 7428     Hmeasurement(
+0000cff0: 2a2a 7b27 6964 273a 277b 303a 3034 7d7b  **{'id':'{0:04}{
+0000d000: 317d 272e 666f 726d 6174 2869 6920 2a20  1}'.format(ii * 
+0000d010: 3130 202b 2034 202c 0d0a 2020 2020 2020  10 + 4 ,..      
+0000d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000d040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d050: 2020 2020 2020 2020 2778 273a 302e 2c20          'x':0., 
-0000d060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d050: 2020 636f 6465 4944 5f64 6563 5b31 3a5d    codeID_dec[1:]
+0000d060: 292c 200d 0a20 2020 2020 2020 2020 2020  ), ..           
 0000d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d080: 2020 2020 2020 2020 2020 2020 2020 2779                'y
-0000d090: 273a 2030 2e2c 0d0a 2020 2020 2020 2020  ': 0.,..        
+0000d080: 2020 2020 2020 2020 2027 6368 7479 7065           'chtype
+0000d090: 273a 2748 5927 2c20 0d0a 2020 2020 2020  ':'HY', ..      
 0000d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0c0: 2020 2020 2778 3227 3a30 2e2c 200d 0a20      'x2':0., .. 
+0000d0b0: 2020 2020 2020 2020 2020 2020 2020 2778                'x
+0000d0c0: 273a 302e 2c20 0d0a 2020 2020 2020 2020  ':0., ..        
 0000d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0f0: 2020 2020 2020 2020 2020 2027 7932 273a             'y2':
-0000d100: 302e 202c 2027 6163 7163 6861 6e27 3a20  0. , 'acqchan': 
-0000d110: 2730 2e30 3027 2c20 0d0a 2020 2020 2020  '0.00', ..      
-0000d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d0e0: 2020 2020 2020 2020 2020 2020 2779 273a              'y':
+0000d0f0: 2030 2e2c 0d0a 2020 2020 2020 2020 2020   0.,..          
+0000d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d110: 2020 2020 2020 2020 2020 2778 3227 3a30            'x2':0
+0000d120: 2e2c 200d 0a20 2020 2020 2020 2020 2020  ., ..           
 0000d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d140: 2020 2766 696c 7465 7227 3a61 7667 6669    'filter':avgfi
-0000d150: 6c74 6572 7d29 290d 0a0d 0a20 2020 2020  lter}))....     
-0000d160: 2020 2020 2020 2065 6469 5f6f 626a 2e44         edi_obj.D
-0000d170: 6566 696e 654d 6561 7375 7265 6d65 6e74  efineMeasurement
-0000d180: 2e5f 5f73 6574 6174 7472 5f5f 280d 0a20  .__setattr__(.. 
-0000d190: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000d1a0: 6d65 6173 5f68 7927 2c0d 0a20 2020 2020  meas_hy',..     
-0000d1b0: 2020 2020 2020 2020 2020 2048 6d65 6173             Hmeas
-0000d1c0: 7572 656d 656e 7428 2a2a 7b27 6964 273a  urement(**{'id':
-0000d1d0: 277b 303a 3034 7d7b 317d 272e 666f 726d  '{0:04}{1}'.form
-0000d1e0: 6174 2869 6920 2a20 3130 202b 2034 202c  at(ii * 10 + 4 ,
-0000d1f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d220: 2020 2020 2020 2020 2020 636f 6465 4944            codeID
-0000d230: 5f64 6563 5b31 3a5d 292c 200d 0a20 2020  _dec[1:]), ..   
-0000d240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d260: 2027 6368 7479 7065 273a 2748 5927 2c20   'chtype':'HY', 
-0000d270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d290: 2020 2020 2020 2778 273a 302e 2c20 0d0a        'x':0., ..
-0000d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2c0: 2020 2020 2779 273a 2030 2e2c 0d0a 2020      'y': 0.,..  
-0000d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d2f0: 2020 2778 3227 3a30 2e2c 200d 0a20 2020    'x2':0., ..   
-0000d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d320: 2027 7932 273a 302e 202c 2027 6163 7163   'y2':0. , 'acqc
-0000d330: 6861 6e27 3a20 2730 2e30 3027 2c20 0d0a  han': '0.00', ..
-0000d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d360: 2766 696c 7465 7227 3a61 7667 6669 6c74  'filter':avgfilt
-0000d370: 6572 7d29 290d 0a20 2020 2020 2020 2020  er}))..         
-0000d380: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d3a0: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-0000d3b0: 3d3d 3d3d 3e20 454d 4150 5345 4354 0d0a  ====> EMAPSECT..
-0000d3c0: 2020 2020 2020 2020 2020 2020 6564 695f              edi_
-0000d3d0: 6f62 6a2e 4d54 454d 4150 2e73 6563 7469  obj.MTEMAP.secti
-0000d3e0: 6420 3d20 7374 6e20 0d0a 200d 0a20 2020  d = stn .. ..   
-0000d3f0: 2020 2020 2020 2020 2065 6469 5f6f 626a           edi_obj
-0000d400: 2e4d 5445 4d41 502e 5f5f 7365 7461 7474  .MTEMAP.__setatt
-0000d410: 725f 5f28 276e 6672 6571 272c 206e 6672  r__('nfreq', nfr
-0000d420: 6571 290d 0a20 2020 2020 2020 2020 2020  eq)..           
-0000d430: 2065 6469 5f6f 626a 2e4d 5445 4d41 502e   edi_obj.MTEMAP.
-0000d440: 5f5f 7365 7461 7474 725f 5f28 276d 6178  __setattr__('max
-0000d450: 626c 6b73 272c 2036 3429 0d0a 2020 2020  blks', 64)..    
-0000d460: 2020 2020 2020 2020 6564 695f 6f62 6a2e          edi_obj.
-0000d470: 4d54 454d 4150 2e6e 6469 706f 6c65 3d20  MTEMAP.ndipole= 
-0000d480: 206c 656e 2868 6561 645f 6461 7461 6964   len(head_dataid
-0000d490: 5f6c 6973 7429 202d 2031 200d 0a20 2020  _list) - 1 ..   
-0000d4a0: 2020 2020 2020 2020 2065 6469 5f6f 626a           edi_obj
-0000d4b0: 2e4d 5445 4d41 502e 7479 7065 203d 2064  .MTEMAP.type = d
-0000d4c0: 6573 6372 6974 6970 6669 6c74 6572 0d0a  escritipfilter..
-0000d4d0: 2020 2020 2020 2020 2020 2020 6564 695f              edi_
-0000d4e0: 6f62 6a2e 4d54 454d 4150 2e5f 5f73 6574  obj.MTEMAP.__set
-0000d4f0: 6174 7472 5f5f 2827 6878 272c 2027 7b30  attr__('hx', '{0
-0000d500: 3a30 347d 7b31 7d27 2e66 6f72 6d61 7428  :04}{1}'.format(
-0000d510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d520: 2020 6969 202a 2031 3020 2b20 3320 2c20    ii * 10 + 3 , 
-0000d530: 636f 6465 4944 5f64 6563 5b31 3a5d 2029  codeID_dec[1:] )
-0000d540: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0000d550: 6469 5f6f 626a 2e4d 5445 4d41 502e 5f5f  di_obj.MTEMAP.__
-0000d560: 7365 7461 7474 725f 5f28 2768 7927 2c20  setattr__('hy', 
-0000d570: 277b 303a 3034 7d7b 317d 272e 666f 726d  '{0:04}{1}'.form
-0000d580: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
-0000d590: 2020 2020 2069 6920 2a20 3130 202b 2034       ii * 10 + 4
-0000d5a0: 202c 2063 6f64 6549 445f 6465 635b 313a   , codeID_dec[1:
-0000d5b0: 5d20 2929 0d0a 2020 2020 2020 2020 2020  ] ))..          
-0000d5c0: 2020 6564 695f 6f62 6a2e 4d54 454d 4150    edi_obj.MTEMAP
-0000d5d0: 2e5f 5f73 6574 6174 7472 5f5f 2827 6368  .__setattr__('ch
-0000d5e0: 6b73 756d 272c 2036 3420 2a20 6e66 7265  ksum', 64 * nfre
-0000d5f0: 7129 0d0a 2020 2020 2020 2020 2020 2020  q)..            
-0000d600: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0000d610: 4672 6571 7565 6e63 7920 626c 6f63 6b73  Frequency blocks
-0000d620: 202c 2069 6d70 656e 6461 6e63 6520 616e   , impendance an
-0000d630: 6420 7265 7369 7374 6976 6974 7920 626c  d resistivity bl
-0000d640: 6f63 7320 0d0a 2020 2020 2020 2020 2020  ocs ..          
-0000d650: 2020 6564 695f 6f62 6a2e 5a2e 6672 6571    edi_obj.Z.freq
-0000d660: 203d 2073 656c 662e 4461 7461 5f73 6563   = self.Data_sec
-0000d670: 7469 6f6e 2e46 7265 7175 656e 6379 2e76  tion.Frequency.v
-0000d680: 616c 7565 200d 0a20 2020 2020 2020 2020  alue ..         
-0000d690: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000d6a0: 2023 2073 6574 2070 6861 7365 2061 6e64   # set phase and
-0000d6b0: 2072 6573 6973 7469 7469 7669 7479 2069   resistitivity i
-0000d6c0: 6e63 6c75 6469 6e67 2065 7272 6f72 2070  ncluding error p
-0000d6d0: 726f 7061 6761 7469 6f6e 200d 0a20 2020  ropagation ..   
-0000d6e0: 2020 2020 2020 2020 2023 2063 6f6d 7075           # compu
-0000d6f0: 7465 2065 7272 6f72 2070 726f 7061 6761  te error propaga
-0000d700: 7469 6f6e 2020 0d0a 2020 2020 2020 2020  tion  ..        
-0000d710: 2020 2020 232d 2d3e 2020 696e 6974 6961      #-->  initia
-0000d720: 6c69 7a65 206e 6461 7272 6179 286e 6672  lize ndarray(nfr
-0000d730: 6571 2c20 322c 2032 2920 0d0a 2020 2020  eq, 2, 2) ..    
-0000d740: 2020 2020 2020 2020 7265 735f 6172 7261          res_arra
-0000d750: 7920 3d20 6e70 2e7a 6572 6f73 2828 6e66  y = np.zeros((nf
-0000d760: 7265 712c 2032 2c32 2029 2c20 6474 7970  req, 2,2 ), dtyp
-0000d770: 6520 3d20 6e70 2e66 6c6f 6174 290d 0a20  e = np.float).. 
-0000d780: 2020 2020 2020 2020 2020 2072 6573 5f61             res_a
-0000d790: 7272 6179 5f65 7272 203d 206e 702e 7a65  rray_err = np.ze
-0000d7a0: 726f 7328 286e 6672 6571 2c20 322c 3220  ros((nfreq, 2,2 
-0000d7b0: 292c 2064 7479 7065 203d 206e 702e 666c  ), dtype = np.fl
-0000d7c0: 6f61 7429 0d0a 2020 2020 2020 2020 2020  oat)..          
-0000d7d0: 2020 7068 735f 6172 7261 7920 3d20 6e70    phs_array = np
-0000d7e0: 2e7a 6572 6f73 2828 6e66 7265 712c 2032  .zeros((nfreq, 2
-0000d7f0: 2c32 2029 2c20 6474 7970 6520 3d20 6e70  ,2 ), dtype = np
-0000d800: 2e66 6c6f 6174 290d 0a20 2020 2020 2020  .float)..       
-0000d810: 2020 2020 2070 6873 5f61 7272 6179 5f65       phs_array_e
-0000d820: 7272 203d 206e 702e 7a65 726f 7328 286e  rr = np.zeros((n
-0000d830: 6672 6571 2c20 322c 3220 292c 2064 7479  freq, 2,2 ), dty
-0000d840: 7065 203d 206e 702e 666c 6f61 7429 0d0a  pe = np.float)..
-0000d850: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000d860: 2023 6469 6374 696f 6e6e 6172 7920 6f66   #dictionnary of
-0000d870: 2063 6f6d 706f 6e65 6e74 7320 2e20 7765   components . we
-0000d880: 2073 6574 206f 6e6c 7920 636f 6d70 6f6e   set only compon
-0000d890: 656e 7420 696e 746f 2058 5920 2e20 0d0a  ent into XY . ..
-0000d8a0: 2020 2020 2020 2020 2020 2020 7265 735f              res_
-0000d8b0: 6172 7261 7920 5b3a 2c20 3020 2c20 3120  array [:, 0 , 1 
-0000d8c0: 5d20 3d20 6170 705f 7268 6f5f 6f62 6a5b  ] = app_rho_obj[
-0000d8d0: 7374 6e5d 0d0a 2020 2020 2020 2020 2020  stn]..          
-0000d8e0: 2020 7265 735f 6172 7261 795f 6572 7220    res_array_err 
-0000d8f0: 5b3a 2c20 3020 2c20 315d 203d 2020 6572  [:, 0 , 1] =  er
-0000d900: 726f 725f 7072 6f70 6167 5f72 686f 205b  ror_propag_rho [
-0000d910: 7374 6e5d 0d0a 2020 2020 2020 2020 2020  stn]..          
-0000d920: 2020 7068 735f 6172 7261 795b 3a20 2c20    phs_array[: , 
-0000d930: 302c 2031 5d20 3d20 7068 6173 655f 6f62  0, 1] = phase_ob
-0000d940: 6a5b 7374 6e5d 200d 0a20 2020 2020 2020  j[stn] ..       
-0000d950: 2020 2020 2070 6873 5f61 7272 6179 5f65       phs_array_e
-0000d960: 7272 2020 5b3a 2c20 302c 2031 5d20 203d  rr  [:, 0, 1]  =
-0000d970: 2065 7272 6f72 5f70 726f 7061 675f 7068   error_propag_ph
-0000d980: 735b 7374 6e5d 0d0a 2020 2020 2020 2020  s[stn]..        
-0000d990: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-0000d9a0: 2020 6966 2041 535f 666c 6167 203d 3d31    if AS_flag ==1
-0000d9b0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-0000d9c0: 2020 2020 2072 6573 5f61 735f 6172 7261       res_as_arra
-0000d9d0: 7920 3d20 6e70 2e7a 6572 6f73 2828 6e66  y = np.zeros((nf
-0000d9e0: 7265 712c 2032 2c32 2029 2c20 6474 7970  req, 2,2 ), dtyp
-0000d9f0: 6520 3d20 6e70 2e66 6c6f 6174 290d 0a20  e = np.float).. 
-0000da00: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000da10: 6573 5f61 735f 6172 7261 7920 5b3a 2c20  es_as_array [:, 
-0000da20: 302c 2031 5d20 203d 2041 535f 7268 6f20  0, 1]  = AS_rho 
+0000d140: 2020 2020 2020 2020 2027 7932 273a 302e           'y2':0.
+0000d150: 202c 2027 6163 7163 6861 6e27 3a20 2730   , 'acqchan': '0
+0000d160: 2e30 3027 2c20 0d0a 2020 2020 2020 2020  .00', ..        
+0000d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d180: 2020 2020 2020 2020 2766 696c 7465 7227          'filter'
+0000d190: 3a61 7667 6669 6c74 6572 7d29 290d 0a20  :avgfilter})).. 
+0000d1a0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+0000d1b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d1c0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0000d1d0: 2020 2020 2020 2023 3d3d 3d3d 3e20 454d         #====> EM
+0000d1e0: 4150 5345 4354 0d0a 2020 2020 2020 2020  APSECT..        
+0000d1f0: 2020 2020 6564 695f 6f62 6a2e 4d54 454d      edi_obj.MTEM
+0000d200: 4150 2e73 6563 7469 6420 3d20 7374 6e20  AP.sectid = stn 
+0000d210: 0d0a 200d 0a20 2020 2020 2020 2020 2020  .. ..           
+0000d220: 2065 6469 5f6f 626a 2e4d 5445 4d41 502e   edi_obj.MTEMAP.
+0000d230: 5f5f 7365 7461 7474 725f 5f28 276e 6672  __setattr__('nfr
+0000d240: 6571 272c 206e 6672 6571 290d 0a20 2020  eq', nfreq)..   
+0000d250: 2020 2020 2020 2020 2065 6469 5f6f 626a           edi_obj
+0000d260: 2e4d 5445 4d41 502e 5f5f 7365 7461 7474  .MTEMAP.__setatt
+0000d270: 725f 5f28 276d 6178 626c 6b73 272c 2036  r__('maxblks', 6
+0000d280: 3429 0d0a 2020 2020 2020 2020 2020 2020  4)..            
+0000d290: 6564 695f 6f62 6a2e 4d54 454d 4150 2e6e  edi_obj.MTEMAP.n
+0000d2a0: 6469 706f 6c65 3d20 206c 656e 2868 6561  dipole=  len(hea
+0000d2b0: 645f 6461 7461 6964 5f6c 6973 7429 202d  d_dataid_list) -
+0000d2c0: 2031 200d 0a20 2020 2020 2020 2020 2020   1 ..           
+0000d2d0: 2065 6469 5f6f 626a 2e4d 5445 4d41 502e   edi_obj.MTEMAP.
+0000d2e0: 7479 7065 203d 2064 6573 6372 6974 6970  type = descritip
+0000d2f0: 6669 6c74 6572 0d0a 2020 2020 2020 2020  filter..        
+0000d300: 2020 2020 6564 695f 6f62 6a2e 4d54 454d      edi_obj.MTEM
+0000d310: 4150 2e5f 5f73 6574 6174 7472 5f5f 2827  AP.__setattr__('
+0000d320: 6878 272c 2027 7b30 3a30 347d 7b31 7d27  hx', '{0:04}{1}'
+0000d330: 2e66 6f72 6d61 7428 0d0a 2020 2020 2020  .format(..      
+0000d340: 2020 2020 2020 2020 2020 6969 202a 2031            ii * 1
+0000d350: 3020 2b20 3320 2c20 636f 6465 4944 5f64  0 + 3 , codeID_d
+0000d360: 6563 5b31 3a5d 2029 290d 0a20 2020 2020  ec[1:] ))..     
+0000d370: 2020 2020 2020 2065 6469 5f6f 626a 2e4d         edi_obj.M
+0000d380: 5445 4d41 502e 5f5f 7365 7461 7474 725f  TEMAP.__setattr_
+0000d390: 5f28 2768 7927 2c20 277b 303a 3034 7d7b  _('hy', '{0:04}{
+0000d3a0: 317d 272e 666f 726d 6174 280d 0a20 2020  1}'.format(..   
+0000d3b0: 2020 2020 2020 2020 2020 2020 2069 6920               ii 
+0000d3c0: 2a20 3130 202b 2034 202c 2063 6f64 6549  * 10 + 4 , codeI
+0000d3d0: 445f 6465 635b 313a 5d20 2929 0d0a 2020  D_dec[1:] ))..  
+0000d3e0: 2020 2020 2020 2020 2020 6564 695f 6f62            edi_ob
+0000d3f0: 6a2e 4d54 454d 4150 2e5f 5f73 6574 6174  j.MTEMAP.__setat
+0000d400: 7472 5f5f 2827 6368 6b73 756d 272c 2036  tr__('chksum', 6
+0000d410: 3420 2a20 6e66 7265 7129 0d0a 2020 2020  4 * nfreq)..    
+0000d420: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000d430: 2020 2020 2020 2320 4672 6571 7565 6e63        # Frequenc
+0000d440: 7920 626c 6f63 6b73 202c 2069 6d70 656e  y blocks , impen
+0000d450: 6461 6e63 6520 616e 6420 7265 7369 7374  dance and resist
+0000d460: 6976 6974 7920 626c 6f63 7320 0d0a 2020  ivity blocs ..  
+0000d470: 2020 2020 2020 2020 2020 6564 695f 6f62            edi_ob
+0000d480: 6a2e 5a2e 6672 6571 203d 2073 656c 662e  j.Z.freq = self.
+0000d490: 4461 7461 5f73 6563 7469 6f6e 2e46 7265  Data_section.Fre
+0000d4a0: 7175 656e 6379 2e76 616c 7565 200d 0a20  quency.value .. 
+0000d4b0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000d4c0: 2020 2020 2020 2020 2023 2073 6574 2070           # set p
+0000d4d0: 6861 7365 2061 6e64 2072 6573 6973 7469  hase and resisti
+0000d4e0: 7469 7669 7479 2069 6e63 6c75 6469 6e67  tivity including
+0000d4f0: 2065 7272 6f72 2070 726f 7061 6761 7469   error propagati
+0000d500: 6f6e 200d 0a20 2020 2020 2020 2020 2020  on ..           
+0000d510: 2023 2063 6f6d 7075 7465 2065 7272 6f72   # compute error
+0000d520: 2070 726f 7061 6761 7469 6f6e 2020 0d0a   propagation  ..
+0000d530: 2020 2020 2020 2020 2020 2020 232d 2d3e              #-->
+0000d540: 2020 696e 6974 6961 6c69 7a65 206e 6461    initialize nda
+0000d550: 7272 6179 286e 6672 6571 2c20 322c 2032  rray(nfreq, 2, 2
+0000d560: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+0000d570: 7265 735f 6172 7261 7920 3d20 6e70 2e7a  res_array = np.z
+0000d580: 6572 6f73 2828 6e66 7265 712c 2032 2c32  eros((nfreq, 2,2
+0000d590: 2029 2c20 6474 7970 6520 3d20 6e70 2e66   ), dtype = np.f
+0000d5a0: 6c6f 6174 290d 0a20 2020 2020 2020 2020  loat)..         
+0000d5b0: 2020 2072 6573 5f61 7272 6179 5f65 7272     res_array_err
+0000d5c0: 203d 206e 702e 7a65 726f 7328 286e 6672   = np.zeros((nfr
+0000d5d0: 6571 2c20 322c 3220 292c 2064 7479 7065  eq, 2,2 ), dtype
+0000d5e0: 203d 206e 702e 666c 6f61 7429 0d0a 2020   = np.float)..  
+0000d5f0: 2020 2020 2020 2020 2020 7068 735f 6172            phs_ar
+0000d600: 7261 7920 3d20 6e70 2e7a 6572 6f73 2828  ray = np.zeros((
+0000d610: 6e66 7265 712c 2032 2c32 2029 2c20 6474  nfreq, 2,2 ), dt
+0000d620: 7970 6520 3d20 6e70 2e66 6c6f 6174 290d  ype = np.float).
+0000d630: 0a20 2020 2020 2020 2020 2020 2070 6873  .            phs
+0000d640: 5f61 7272 6179 5f65 7272 203d 206e 702e  _array_err = np.
+0000d650: 7a65 726f 7328 286e 6672 6571 2c20 322c  zeros((nfreq, 2,
+0000d660: 3220 292c 2064 7479 7065 203d 206e 702e  2 ), dtype = np.
+0000d670: 666c 6f61 7429 0d0a 2020 200d 0a20 2020  float)..   ..   
+0000d680: 2020 2020 2020 2020 2023 6469 6374 696f           #dictio
+0000d690: 6e6e 6172 7920 6f66 2063 6f6d 706f 6e65  nnary of compone
+0000d6a0: 6e74 7320 2e20 7765 2073 6574 206f 6e6c  nts . we set onl
+0000d6b0: 7920 636f 6d70 6f6e 656e 7420 696e 746f  y component into
+0000d6c0: 2058 5920 2e20 0d0a 2020 2020 2020 2020   XY . ..        
+0000d6d0: 2020 2020 7265 735f 6172 7261 7920 5b3a      res_array [:
+0000d6e0: 2c20 3020 2c20 3120 5d20 3d20 6170 705f  , 0 , 1 ] = app_
+0000d6f0: 7268 6f5f 6f62 6a5b 7374 6e5d 0d0a 2020  rho_obj[stn]..  
+0000d700: 2020 2020 2020 2020 2020 7265 735f 6172            res_ar
+0000d710: 7261 795f 6572 7220 5b3a 2c20 3020 2c20  ray_err [:, 0 , 
+0000d720: 315d 203d 2020 6572 726f 725f 7072 6f70  1] =  error_prop
+0000d730: 6167 5f72 686f 205b 7374 6e5d 0d0a 2020  ag_rho [stn]..  
+0000d740: 2020 2020 2020 2020 2020 7068 735f 6172            phs_ar
+0000d750: 7261 795b 3a20 2c20 302c 2031 5d20 3d20  ray[: , 0, 1] = 
+0000d760: 7068 6173 655f 6f62 6a5b 7374 6e5d 200d  phase_obj[stn] .
+0000d770: 0a20 2020 2020 2020 2020 2020 2070 6873  .            phs
+0000d780: 5f61 7272 6179 5f65 7272 2020 5b3a 2c20  _array_err  [:, 
+0000d790: 302c 2031 5d20 203d 2065 7272 6f72 5f70  0, 1]  = error_p
+0000d7a0: 726f 7061 675f 7068 735b 7374 6e5d 0d0a  ropag_phs[stn]..
+0000d7b0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0000d7c0: 2020 2020 2020 2020 2020 6966 2041 535f            if AS_
+0000d7d0: 666c 6167 203d 3d31 203a 200d 0a20 2020  flag ==1 : ..   
+0000d7e0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000d7f0: 5f61 735f 6172 7261 7920 3d20 6e70 2e7a  _as_array = np.z
+0000d800: 6572 6f73 2828 6e66 7265 712c 2032 2c32  eros((nfreq, 2,2
+0000d810: 2029 2c20 6474 7970 6520 3d20 6e70 2e66   ), dtype = np.f
+0000d820: 6c6f 6174 290d 0a20 2020 2020 2020 2020  loat)..         
+0000d830: 2020 2020 2020 2072 6573 5f61 735f 6172         res_as_ar
+0000d840: 7261 7920 5b3a 2c20 302c 2031 5d20 203d  ray [:, 0, 1]  =
+0000d850: 2041 535f 7268 6f20 5b73 746e 5d0d 0a20   AS_rho [stn].. 
+0000d860: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000d870: 2020 2020 2020 2020 2069 6620 6170 706c           if appl
+0000d880: 795f 6669 6c74 6572 2069 7320 6e6f 7420  y_filter is not 
+0000d890: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+0000d8a0: 2020 2020 2020 2020 2066 7265 735f 6172           fres_ar
+0000d8b0: 7261 7920 3d20 6e70 2e7a 6572 6f73 2828  ray = np.zeros((
+0000d8c0: 6e66 7265 712c 2032 2c32 2029 2c20 6474  nfreq, 2,2 ), dt
+0000d8d0: 7970 6520 3d20 6e70 2e66 6c6f 6174 290d  ype = np.float).
+0000d8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d8f0: 2069 6620 6170 706c 795f 6669 6c74 6572   if apply_filter
+0000d900: 2e6c 6f77 6572 2829 203d 3d27 746d 6127  .lower() =='tma'
+0000d910: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0000d920: 2020 2020 2020 2020 6672 6573 5f61 7272          fres_arr
+0000d930: 6179 2020 5b3a 202c 2030 202c 2031 5d20  ay  [: , 0 , 1] 
+0000d940: 203d 2072 6573 5f54 4d41 5b73 746e 5d0d   = res_TMA[stn].
+0000d950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d960: 2065 6c69 6620 6170 706c 795f 6669 6c74   elif apply_filt
+0000d970: 6572 2e6c 6f77 6572 2829 203d 3d27 666c  er.lower() =='fl
+0000d980: 6d61 2720 3a0d 0a20 2020 2020 2020 2020  ma' :..         
+0000d990: 2020 2020 2020 2020 2020 2066 7265 735f             fres_
+0000d9a0: 6172 7261 7920 205b 3a20 2c20 3020 2c20  array  [: , 0 , 
+0000d9b0: 315d 2020 3d20 7265 735f 464c 4d41 5b73  1]  = res_FLMA[s
+0000d9c0: 746e 5d0d 0a20 2020 2020 2020 2020 2020  tn]..           
+0000d9d0: 2020 2020 2065 6c69 6620 6170 706c 795f       elif apply_
+0000d9e0: 6669 6c74 6572 2e6c 6f77 6572 2829 203d  filter.lower() =
+0000d9f0: 3d27 616d 6127 203a 0d0a 2020 2020 2020  ='ama' :..      
+0000da00: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+0000da10: 6573 5f61 7272 6179 2020 5b3a 202c 2030  es_array  [: , 0
+0000da20: 202c 2031 5d20 203d 2072 6573 5f41 4d41   , 1]  = res_AMA
 0000da30: 5b73 746e 5d0d 0a20 2020 2020 2020 2020  [stn]..         
-0000da40: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000da50: 2069 6620 6170 706c 795f 6669 6c74 6572   if apply_filter
-0000da60: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
-0000da70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000da80: 2066 7265 735f 6172 7261 7920 3d20 6e70   fres_array = np
-0000da90: 2e7a 6572 6f73 2828 6e66 7265 712c 2032  .zeros((nfreq, 2
-0000daa0: 2c32 2029 2c20 6474 7970 6520 3d20 6e70  ,2 ), dtype = np
-0000dab0: 2e66 6c6f 6174 290d 0a20 2020 2020 2020  .float)..       
-0000dac0: 2020 2020 2020 2020 2069 6620 6170 706c           if appl
-0000dad0: 795f 6669 6c74 6572 2e6c 6f77 6572 2829  y_filter.lower()
-0000dae0: 203d 3d27 746d 6127 203a 0d0a 2020 2020   =='tma' :..    
-0000daf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db00: 6672 6573 5f61 7272 6179 2020 5b3a 202c  fres_array  [: ,
-0000db10: 2030 202c 2031 5d20 203d 2072 6573 5f54   0 , 1]  = res_T
-0000db20: 4d41 5b73 746e 5d0d 0a20 2020 2020 2020  MA[stn]..       
-0000db30: 2020 2020 2020 2020 2065 6c69 6620 6170           elif ap
-0000db40: 706c 795f 6669 6c74 6572 2e6c 6f77 6572  ply_filter.lower
-0000db50: 2829 203d 3d27 666c 6d61 2720 3a0d 0a20  () =='flma' :.. 
-0000db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db70: 2020 2066 7265 735f 6172 7261 7920 205b     fres_array  [
-0000db80: 3a20 2c20 3020 2c20 315d 2020 3d20 7265  : , 0 , 1]  = re
-0000db90: 735f 464c 4d41 5b73 746e 5d0d 0a20 2020  s_FLMA[stn]..   
-0000dba0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0000dbb0: 6620 6170 706c 795f 6669 6c74 6572 2e6c  f apply_filter.l
-0000dbc0: 6f77 6572 2829 203d 3d27 616d 6127 203a  ower() =='ama' :
-0000dbd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000dbe0: 2020 2020 2020 6672 6573 5f61 7272 6179        fres_array
-0000dbf0: 2020 5b3a 202c 2030 202c 2031 5d20 203d    [: , 0 , 1]  =
-0000dc00: 2072 6573 5f41 4d41 5b73 746e 5d0d 0a20   res_AMA[stn].. 
-0000dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dc20: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000dc30: 2023 2d2d 2d3e 2063 6f6d 7075 7469 6e67   #---> computing
-0000dc40: 207a 2077 6974 6820 7265 7369 7374 6976   z with resistiv
-0000dc50: 6974 6965 7320 2c20 7068 6173 6520 6279  ities , phase by
-0000dc60: 2075 7369 6e67 2070 726f 7061 6772 6174   using propagrat
-0000dc70: 696f 6e73 2065 7272 6f72 7320 0d0a 2020  ions errors ..  
-0000dc80: 2020 2020 2020 2020 2020 6564 695f 6f62            edi_ob
-0000dc90: 6a2e 5a2e 7365 745f 7265 735f 7068 6173  j.Z.set_res_phas
-0000dca0: 6528 7265 735f 6172 7261 7920 3d20 7265  e(res_array = re
-0000dcb0: 735f 6172 7261 792c 2070 6861 7365 5f61  s_array, phase_a
-0000dcc0: 7272 6179 3d70 6873 5f61 7272 6179 2c20  rray=phs_array, 
-0000dcd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dcf0: 2020 2020 2020 6672 6571 3d20 2065 6469        freq=  edi
-0000dd00: 5f6f 626a 2e5a 2e66 7265 712c 200d 0a20  _obj.Z.freq, .. 
+0000da40: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000da50: 2020 2020 2020 2020 2023 2d2d 2d3e 2063           #---> c
+0000da60: 6f6d 7075 7469 6e67 207a 2077 6974 6820  omputing z with 
+0000da70: 7265 7369 7374 6976 6974 6965 7320 2c20  resistivities , 
+0000da80: 7068 6173 6520 6279 2075 7369 6e67 2070  phase by using p
+0000da90: 726f 7061 6772 6174 696f 6e73 2065 7272  ropagrations err
+0000daa0: 6f72 7320 0d0a 2020 2020 2020 2020 2020  ors ..          
+0000dab0: 2020 6564 695f 6f62 6a2e 5a2e 7365 745f    edi_obj.Z.set_
+0000dac0: 7265 735f 7068 6173 6528 7265 735f 6172  res_phase(res_ar
+0000dad0: 7261 7920 3d20 7265 735f 6172 7261 792c  ray = res_array,
+0000dae0: 2070 6861 7365 5f61 7272 6179 3d70 6873   phase_array=phs
+0000daf0: 5f61 7272 6179 2c20 0d0a 2020 2020 2020  _array, ..      
+0000db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db10: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+0000db20: 6571 3d20 2065 6469 5f6f 626a 2e5a 2e66  eq=  edi_obj.Z.f
+0000db30: 7265 712c 200d 0a20 2020 2020 2020 2020  req, ..         
+0000db40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db50: 2020 2020 2020 2020 2020 2072 6573 5f65             res_e
+0000db60: 7272 5f61 7272 6179 3d72 6573 5f61 7272  rr_array=res_arr
+0000db70: 6179 5f65 7272 2c0d 0a20 2020 2020 2020  ay_err,..       
+0000db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db90: 2020 2020 2020 2020 2020 2020 2070 6861               pha
+0000dba0: 7365 5f65 7272 5f61 7272 6179 3d70 6873  se_err_array=phs
+0000dbb0: 5f61 7272 6179 5f65 7272 290d 0a20 2020  _array_err)..   
+0000dbc0: 2020 2020 2020 2020 2023 2077 7269 7465           # write
+0000dbd0: 2065 6469 6669 6c65 7320 2e2e 2e0d 0a20   edifiles ..... 
+0000dbe0: 2020 2020 2020 2020 2020 2069 6620 4153             if AS
+0000dbf0: 5f66 6c61 6720 3d3d 3120 3a0d 0a20 2020  _flag ==1 :..   
+0000dc00: 2020 2020 2020 2020 2020 2020 2065 6469               edi
+0000dc10: 5f6f 626a 2e77 7269 7465 5f65 6469 6669  _obj.write_edifi
+0000dc20: 6c65 2873 6176 6570 6174 6820 3d20 7361  le(savepath = sa
+0000dc30: 7665 7061 7468 2c20 0d0a 2020 2020 2020  vepath, ..      
+0000dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dc60: 6164 645f 6669 6c74 6572 5f61 7272 6179  add_filter_array
+0000dc70: 203d 7265 735f 6173 5f61 7272 6179 2029   =res_as_array )
+0000dc80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000dc90: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000dca0: 656c 6966 2061 7070 6c79 5f66 696c 7465  elif apply_filte
+0000dcb0: 7220 6973 206e 6f74 204e 6f6e 653a 0d0a  r is not None:..
+0000dcc0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000dcd0: 6469 5f6f 626a 2e77 7269 7465 5f65 6469  di_obj.write_edi
+0000dce0: 6669 6c65 2873 6176 6570 6174 6820 3d20  file(savepath = 
+0000dcf0: 7361 7665 7061 7468 2c20 0d0a 2020 2020  savepath, ..    
+0000dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd30: 2020 2072 6573 5f65 7272 5f61 7272 6179     res_err_array
-0000dd40: 3d72 6573 5f61 7272 6179 5f65 7272 2c0d  =res_array_err,.
-0000dd50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd70: 2020 2020 2070 6861 7365 5f65 7272 5f61       phase_err_a
-0000dd80: 7272 6179 3d70 6873 5f61 7272 6179 5f65  rray=phs_array_e
-0000dd90: 7272 290d 0a20 2020 2020 2020 2020 2020  rr)..           
-0000dda0: 2023 2077 7269 7465 2065 6469 6669 6c65   # write edifile
-0000ddb0: 7320 2e2e 2e0d 0a20 2020 2020 2020 2020  s .....         
-0000ddc0: 2020 2069 6620 4153 5f66 6c61 6720 3d3d     if AS_flag ==
-0000ddd0: 3120 3a0d 0a20 2020 2020 2020 2020 2020  1 :..           
-0000dde0: 2020 2020 2065 6469 5f6f 626a 2e77 7269       edi_obj.wri
-0000ddf0: 7465 5f65 6469 6669 6c65 2873 6176 6570  te_edifile(savep
-0000de00: 6174 6820 3d20 7361 7665 7061 7468 2c20  ath = savepath, 
-0000de10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de30: 2020 2020 2020 2020 6164 645f 6669 6c74          add_filt
-0000de40: 6572 5f61 7272 6179 203d 7265 735f 6173  er_array =res_as
-0000de50: 5f61 7272 6179 2029 0d0a 2020 2020 2020  _array )..      
-0000de60: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000de70: 2020 2020 2020 2020 656c 6966 2061 7070          elif app
-0000de80: 6c79 5f66 696c 7465 7220 6973 206e 6f74  ly_filter is not
-0000de90: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000dea0: 2020 2020 2020 2065 6469 5f6f 626a 2e77         edi_obj.w
-0000deb0: 7269 7465 5f65 6469 6669 6c65 2873 6176  rite_edifile(sav
-0000dec0: 6570 6174 6820 3d20 7361 7665 7061 7468  epath = savepath
-0000ded0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0000dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000def0: 2020 2020 2020 2020 2061 6464 5f66 696c           add_fil
-0000df00: 7465 725f 6172 7261 7920 3d20 6672 6573  ter_array = fres
-0000df10: 5f61 7272 6179 2029 0d0a 2020 2020 2020  _array )..      
-0000df20: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000df30: 2020 2020 2020 2065 6c73 6520 3a20 6564         else : ed
-0000df40: 695f 6f62 6a2e 7772 6974 655f 6564 6966  i_obj.write_edif
-0000df50: 696c 6528 7361 7665 7061 7468 203d 2073  ile(savepath = s
-0000df60: 6176 6570 6174 6829 0d0a 2020 2020 2020  avepath)..      
-0000df70: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000df80: 2020 2020 0d0a 2020 2020 2020 2020 7072      ..        pr
-0000df90: 696e 7428 272d 272a 3737 2920 0d0a 2020  int('-'*77) ..  
-0000dfa0: 2020 2020 2020 7072 696e 7428 272d 2d2d        print('---
-0000dfb0: 3e20 7b30 7d20 4564 692d 6669 6c65 7320  > {0} Edi-files 
-0000dfc0: 6861 7665 2062 6565 6e20 7265 7772 6974  have been rewrit
-0000dfd0: 7465 6e2e 5c6e 2d2d 2d3e 2073 6565 2070  ten.\n---> see p
-0000dfe0: 6174 683a 3c7b 317d 3e20 272e 5c0d 0a20  ath:<{1}> '.\.. 
-0000dff0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0000e000: 6d61 7428 6c65 6e28 6865 6164 5f64 6174  mat(len(head_dat
-0000e010: 6169 645f 6c69 7374 292c 2073 6176 6570  aid_list), savep
-0000e020: 6174 6829 290d 0a20 2020 2020 2020 2070  ath))..        p
-0000e030: 7269 6e74 2827 2d27 2a37 3729 0d0a 2020  rint('-'*77)..  
-0000e040: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000e050: 0d0a 636c 6173 7320 4865 6164 6572 2028  ..class Header (
-0000e060: 6f62 6a65 6374 293a 0d0a 2020 2020 0d0a  object):..    ..
-0000e070: 2020 2020 2222 220d 0a20 2020 2052 6561      """..    Rea
-0000e080: 6420 7468 6520 696e 666f 2048 6561 6465  d the info Heade
-0000e090: 7220 6f66 2041 5647 2066 696c 6520 616e  r of AVG file an
-0000e0a0: 6420 7265 7772 6974 6520 4176 6766 696c  d rewrite Avgfil
-0000e0b0: 6520 286d 6169 6e20 7479 7065 2c20 5479  e (main type, Ty
-0000e0c0: 7065 3129 202e 0d0a 2020 2020 0d0a 2020  pe1) ...    ..  
-0000e0d0: 2020 4172 6775 6d65 6e74 7320 200d 0a20    Arguments  .. 
-0000e0e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020     ---------..  
-0000e0f0: 2020 2020 2020 2a2a 6461 7461 5f66 6e2a        **data_fn*
-0000e100: 2a20 3a20 7374 7220 200d 0a20 2020 2020  * : str  ..     
-0000e110: 2020 2020 2020 2020 2020 2070 6174 6820             path 
-0000e120: 746f 2061 7667 6669 6c65 0d0a 2020 2020  to avgfile..    
-0000e130: 2020 2020 0d0a 2020 2020 3d3d 3d3d 3d3d      ..    ======
-0000e140: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e150: 2020 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d    =========  ===
-0000e160: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e170: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e180: 3d3d 0d0a 2020 2020 4174 7472 6962 7574  ==..    Attribut
-0000e190: 6573 2020 2020 2020 2020 2020 2020 2020  es              
-0000e1a0: 5479 7065 2020 2020 2020 2020 4578 706c  Type        Expl
-0000e1b0: 616e 6174 696f 6e0d 0a20 2020 203d 3d3d  anation..    ===
+0000dd20: 2061 6464 5f66 696c 7465 725f 6172 7261   add_filter_arra
+0000dd30: 7920 3d20 6672 6573 5f61 7272 6179 2029  y = fres_array )
+0000dd40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000dd50: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
+0000dd60: 6c73 6520 3a20 6564 695f 6f62 6a2e 7772  lse : edi_obj.wr
+0000dd70: 6974 655f 6564 6966 696c 6528 7361 7665  ite_edifile(save
+0000dd80: 7061 7468 203d 2073 6176 6570 6174 6829  path = savepath)
+0000dd90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000dda0: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+0000ddb0: 2020 2020 2020 7072 696e 7428 272d 272a        print('-'*
+0000ddc0: 3737 2920 0d0a 2020 2020 2020 2020 7072  77) ..        pr
+0000ddd0: 696e 7428 272d 2d2d 3e20 7b30 7d20 4564  int('---> {0} Ed
+0000dde0: 692d 6669 6c65 7320 6861 7665 2062 6565  i-files have bee
+0000ddf0: 6e20 7265 7772 6974 7465 6e2e 5c6e 2d2d  n rewritten.\n--
+0000de00: 2d3e 2073 6565 2070 6174 683a 3c7b 317d  -> see path:<{1}
+0000de10: 3e20 272e 5c0d 0a20 2020 2020 2020 2020  > '.\..         
+0000de20: 2020 2020 2066 6f72 6d61 7428 6c65 6e28       format(len(
+0000de30: 6865 6164 5f64 6174 6169 645f 6c69 7374  head_dataid_list
+0000de40: 292c 2073 6176 6570 6174 6829 290d 0a20  ), savepath)).. 
+0000de50: 2020 2020 2020 2070 7269 6e74 2827 2d27         print('-'
+0000de60: 2a37 3729 0d0a 2020 2020 2020 2020 2020  *77)..          
+0000de70: 2020 0d0a 2020 2020 0d0a 636c 6173 7320    ..    ..class 
+0000de80: 4865 6164 6572 2028 6f62 6a65 6374 293a  Header (object):
+0000de90: 0d0a 2020 2020 0d0a 2020 2020 2222 220d  ..    ..    """.
+0000dea0: 0a20 2020 2052 6561 6420 7468 6520 696e  .    Read the in
+0000deb0: 666f 2048 6561 6465 7220 6f66 2041 5647  fo Header of AVG
+0000dec0: 2066 696c 6520 616e 6420 7265 7772 6974   file and rewrit
+0000ded0: 6520 4176 6766 696c 6520 286d 6169 6e20  e Avgfile (main 
+0000dee0: 7479 7065 2c20 5479 7065 3129 202e 0d0a  type, Type1) ...
+0000def0: 2020 2020 0d0a 2020 2020 4172 6775 6d65      ..    Argume
+0000df00: 6e74 7320 200d 0a20 2020 202d 2d2d 2d2d  nts  ..    -----
+0000df10: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2a2a  ----..        **
+0000df20: 6461 7461 5f66 6e2a 2a20 3a20 7374 7220  data_fn** : str 
+0000df30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000df40: 2020 2070 6174 6820 746f 2061 7667 6669     path to avgfi
+0000df50: 6c65 0d0a 2020 2020 2020 2020 0d0a 2020  le..        ..  
+0000df60: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+0000df70: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
+0000df80: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
+0000df90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000dfa0: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
+0000dfb0: 4174 7472 6962 7574 6573 2020 2020 2020  Attributes      
+0000dfc0: 2020 2020 2020 2020 5479 7065 2020 2020          Type    
+0000dfd0: 2020 2020 4578 706c 616e 6174 696f 6e0d      Explanation.
+0000dfe0: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+0000dff0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
+0000e000: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+0000e010: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000e020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
+0000e030: 2020 2048 6172 6477 6172 6549 6e66 6f73     HardwareInfos
+0000e040: 2020 2020 2020 2020 2020 2063 6c61 7373             class
+0000e050: 2020 2020 2020 2020 7a6f 6e67 6520 4861          zonge Ha
+0000e060: 7264 7761 7265 2020 0d0a 2020 2020 5375  rdware  ..    Su
+0000e070: 7276 6579 416e 6e6f 7461 7469 6f6e 2020  rveyAnnotation  
+0000e080: 2020 2020 2020 636c 6173 7320 2020 2020        class     
+0000e090: 2020 207a 6f6e 6765 2070 726f 6a65 6374     zonge project
+0000e0a0: 2020 696e 666f 726d 6174 696f 6e73 200d    informations .
+0000e0b0: 0a20 2020 2053 7572 7665 7943 6f6e 6669  .    SurveyConfi
+0000e0c0: 6775 7261 7469 6f6e 2020 2020 2063 6c61  guration     cla
+0000e0d0: 7373 2020 2020 2020 2020 7a6f 6e67 6520  ss        zonge 
+0000e0e0: 7072 6f6a 6563 742f 6c6f 6361 7469 6f6e  project/location
+0000e0f0: 7320 7365 7474 696e 6773 200d 0a20 2020  s settings ..   
+0000e100: 2054 7820 2020 2020 2020 2020 2020 2020   Tx             
+0000e110: 2020 2020 2020 2020 2063 6c61 7373 2020           class  
+0000e120: 2020 2020 2020 7370 6563 6961 6c20 5472        special Tr
+0000e130: 616e 736d 6974 7465 7220 2070 726f 7065  ansmitter  prope
+0000e140: 7274 6965 7320 0d0a 2020 2020 5278 2020  rties ..    Rx  
+0000e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e160: 2020 2020 636c 6173 7320 2020 2020 2020      class       
+0000e170: 2073 7065 6369 616c 2072 6563 6569 7665   special receive
+0000e180: 7220 7072 6f70 6572 7469 6573 0d0a 2020  r properties..  
+0000e190: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+0000e1a0: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
+0000e1b0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
 0000e1c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e1d0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 2020  ===  =========  
-0000e1e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e1f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e200: 3d3d 3d3d 3d0d 0a20 2020 2048 6172 6477  =====..    Hardw
-0000e210: 6172 6549 6e66 6f73 2020 2020 2020 2020  areInfos        
-0000e220: 2020 2063 6c61 7373 2020 2020 2020 2020     class        
-0000e230: 7a6f 6e67 6520 4861 7264 7761 7265 2020  zonge Hardware  
-0000e240: 0d0a 2020 2020 5375 7276 6579 416e 6e6f  ..    SurveyAnno
-0000e250: 7461 7469 6f6e 2020 2020 2020 2020 636c  tation        cl
-0000e260: 6173 7320 2020 2020 2020 207a 6f6e 6765  ass        zonge
-0000e270: 2070 726f 6a65 6374 2020 696e 666f 726d   project  inform
-0000e280: 6174 696f 6e73 200d 0a20 2020 2053 7572  ations ..    Sur
-0000e290: 7665 7943 6f6e 6669 6775 7261 7469 6f6e  veyConfiguration
-0000e2a0: 2020 2020 2063 6c61 7373 2020 2020 2020       class      
-0000e2b0: 2020 7a6f 6e67 6520 7072 6f6a 6563 742f    zonge project/
-0000e2c0: 6c6f 6361 7469 6f6e 7320 7365 7474 696e  locations settin
-0000e2d0: 6773 200d 0a20 2020 2054 7820 2020 2020  gs ..    Tx     
-0000e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2f0: 2063 6c61 7373 2020 2020 2020 2020 7370   class        sp
-0000e300: 6563 6961 6c20 5472 616e 736d 6974 7465  ecial Transmitte
-0000e310: 7220 2070 726f 7065 7274 6965 7320 0d0a  r  properties ..
-0000e320: 2020 2020 5278 2020 2020 2020 2020 2020      Rx          
-0000e330: 2020 2020 2020 2020 2020 2020 636c 6173              clas
-0000e340: 7320 2020 2020 2020 2073 7065 6369 616c  s        special
-0000e350: 2072 6563 6569 7665 7220 7072 6f70 6572   receiver proper
-0000e360: 7469 6573 0d0a 2020 2020 3d3d 3d3d 3d3d  ties..    ======
-0000e370: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e380: 2020 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d    =========  ===
-0000e390: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e3a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e3b0: 3d3d 0d0a 0d0a 2020 2020 4d6f 7265 2061  ==....    More a
-0000e3c0: 7474 7269 6275 7465 7320 6361 6e20 6265  ttributes can be
-0000e3d0: 2061 6464 6564 2062 7920 696e 7075 7469   added by inputi
-0000e3e0: 6e67 2061 206b 6579 2077 6f72 6420 6469  ng a key word di
-0000e3f0: 6374 696f 6e61 7279 0d0a 2020 2020 0d0a  ctionary..    ..
-0000e400: 2020 2020 3a45 7861 6d70 6c65 3a0d 0a20      :Example:.. 
-0000e410: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000e420: 203e 3e3e 2066 726f 6d20 7079 6373 616d   >>> from pycsam
-0000e430: 742e 6666 2e63 6f72 652e 6176 6720 696d  t.ff.core.avg im
-0000e440: 706f 7274 2041 7667 0d0a 2020 2020 2020  port Avg..      
-0000e450: 2020 3e3e 3e20 7061 7468 3d6f 732e 7061    >>> path=os.pa
-0000e460: 7468 2e6a 6f69 6e28 6f73 2e65 6e76 6972  th.join(os.envir
-0000e470: 6f6e 5b22 7079 4353 414d 5422 5d2c 200d  on["pyCSAMT"], .
-0000e480: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0000e490: 2020 2020 2020 2770 7963 7361 6d74 272c        'pycsamt',
-0000e4a0: 2022 6461 7461 222c 2022 4c43 3130 312e   "data", "LC101.
-0000e4b0: 6176 6722 290d 0a20 2020 2020 2020 203e  avg")..        >
-0000e4c0: 3e3e 2061 7667 5f6f 626a 3d20 4176 6728  >> avg_obj= Avg(
-0000e4d0: 6461 7461 5f66 6e3d 7061 7468 2920 0d0a  data_fn=path) ..
-0000e4e0: 2020 2020 2020 2020 3e3e 3e20 7375 7276          >>> surv
-0000e4f0: 5f61 7265 613d 2061 7667 5f6f 626a 2e48  _area= avg_obj.H
-0000e500: 6561 6465 722e 5375 7276 6579 416e 6e6f  eader.SurveyAnno
-0000e510: 7461 7469 6f6e 2e70 726f 6a65 6374 5f61  tation.project_a
-0000e520: 7265 6120 0d0a 2020 2020 2020 2020 3e3e  rea ..        >>
-0000e530: 3e20 7072 696e 7428 7375 7276 6579 2e61  > print(survey.a
-0000e540: 7265 6129 0d0a 2020 2020 2020 2020 0d0a  rea)..        ..
-0000e550: 2020 2020 2222 220d 0a20 2020 2064 6566      """..    def
-0000e560: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-0000e570: 6865 6164 6572 5f69 6e66 6f73 203d 204e  header_infos = N
-0000e580: 6f6e 6520 2c20 2a2a 6b77 6172 6773 293a  one , **kwargs):
-0000e590: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-0000e5a0: 2e48 6172 6477 6172 6549 6e66 6f73 203d  .HardwareInfos =
-0000e5b0: 5a6f 6e67 6548 6172 6477 6172 6528 290d  ZongeHardware().
-0000e5c0: 0a20 2020 2020 2020 2073 656c 662e 5375  .        self.Su
-0000e5d0: 7276 6579 416e 6e6f 7461 7469 6f6e 3d53  rveyAnnotation=S
-0000e5e0: 7572 7665 7941 6e6e 6f74 6174 696f 6e28  urveyAnnotation(
-0000e5f0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0000e600: 5375 7276 6579 436f 6e66 6967 7572 6174  SurveyConfigurat
-0000e610: 696f 6e3d 5375 7276 6579 436f 6e66 6967  ion=SurveyConfig
-0000e620: 7572 6174 696f 6e28 290d 0a20 2020 2020  uration()..     
-0000e630: 2020 2073 656c 662e 5478 3d54 7261 6e73     self.Tx=Trans
-0000e640: 6d69 7474 6572 5072 6f70 6572 7469 6573  mitterProperties
-0000e650: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
-0000e660: 2e52 783d 5265 6365 6976 6572 5072 6f70  .Rx=ReceiverProp
-0000e670: 6572 7469 6573 2829 0d0a 0d0a 2020 2020  erties()....    
-0000e680: 2020 2020 0d0a 2020 2020 2020 2020 666f      ..        fo
-0000e690: 7220 6b65 7973 2020 696e 206c 6973 7428  r keys  in list(
-0000e6a0: 6b77 6172 6773 2e6b 6579 7328 2929 3a20  kwargs.keys()): 
-0000e6b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000e6c0: 2020 2020 7365 6c66 2e5f 5f73 6574 6174      self.__setat
-0000e6d0: 7472 5f5f 286b 6579 732c 206b 7761 7267  tr__(keys, kwarg
-0000e6e0: 735b 6b65 7973 5d29 0d0a 2020 2020 2020  s[keys])..      
-0000e6f0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-0000e700: 2e68 6561 645f 626c 6f63 6b5f 696e 666f  .head_block_info
-0000e710: 7320 3d5b 2748 6172 6477 6172 6520 696e  s =['Hardware in
-0000e720: 666f 7327 2c20 0d0a 2020 2020 2020 2020  fos', ..        
-0000e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e740: 2020 2020 2020 2020 2753 7572 7665 7920          'Survey 
-0000e750: 616e 6e6f 7461 7469 6f6e 272c 200d 0a20  annotation', .. 
-0000e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e770: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000e780: 5375 7276 6579 2063 6f6e 6669 6775 7261  Survey configura
-0000e790: 7469 6f6e 272c 200d 0a20 2020 2020 2020  tion', ..       
-0000e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7b0: 2020 2020 2020 2020 2027 5472 616e 736d           'Transm
-0000e7c0: 6974 7465 7220 7072 6f70 6572 7469 6573  itter properties
-0000e7d0: 272c 200d 0a20 2020 2020 2020 2020 2020  ', ..           
-0000e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7f0: 2020 2020 2027 5265 6365 6976 6572 2070       'Receiver p
-0000e800: 726f 7065 7274 6965 7327 2c20 0d0a 2020  roperties', ..  
-0000e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e820: 2020 2020 2020 2020 2020 2020 2020 2765                'e
-0000e830: 6e64 275d 0d0a 0d0a 2020 2020 6465 6620  nd']....    def 
-0000e840: 7772 6974 655f 6865 6164 6572 5f6c 6f67  write_header_log
-0000e850: 2873 656c 662c 2064 6174 615f 666e 3d4e  (self, data_fn=N
-0000e860: 6f6e 6520 2c20 7361 7665 7061 7468 3d4e  one , savepath=N
-0000e870: 6f6e 6520 293a 200d 0a20 2020 2020 2020  one ): ..       
-0000e880: 2022 2222 200d 0a20 2020 2020 2020 204d   """ ..        M
-0000e890: 6574 686f 6420 746f 2077 7269 7465 2079  ethod to write y
-0000e8a0: 6f75 7220 6865 6164 206c 6f67 2e20 496e  our head log. In
-0000e8b0: 2066 6163 7420 6a75 7374 2074 6f20 7365   fact just to se
-0000e8c0: 6520 7768 6574 6865 7220 796f 7572 200d  e whether your .
-0000e8d0: 0a20 2020 2020 2020 205a 6f6e 6765 2049  .        Zonge I
-0000e8e0: 6e66 6f73 2077 6173 2073 6574 2063 6f72  nfos was set cor
-0000e8f0: 7265 6374 6c79 2e0d 0a20 2020 2020 2020  rectly...       
-0000e900: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
-0000e910: 6574 6572 7320 0d0a 2020 2020 2020 2020  eters ..        
-0000e920: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-0000e930: 2020 2020 2020 2020 2a20 6461 7461 5f66          * data_f
-0000e940: 6e20 3a20 7374 7220 0d0a 2020 2020 2020  n : str ..      
-0000e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e960: 2020 7061 7468 2074 6f20 4176 6766 696c    path to Avgfil
-0000e970: 650d 0a20 2020 2020 2020 2020 2020 202a  e..            *
-0000e980: 2073 6176 6570 6174 6820 3a20 7374 7220   savepath : str 
-0000e990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e9a0: 2020 2020 2020 2020 2020 7061 7468 2074            path t
-0000e9b0: 6f20 796f 7572 2064 6573 7469 6e61 7469  o your destinati
-0000e9c0: 6f6e 2066 696c 6520 2e20 6966 204e 6f6e  on file . if Non
-0000e9d0: 6520 2c20 0d0a 2020 2020 2020 2020 2020  e , ..          
-0000e9e0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0000e9f0: 7468 2069 7320 796f 7572 2063 7572 7265  th is your curre
-0000ea00: 6e74 2077 6f72 6b20 6469 7265 6374 6f72  nt work director
-0000ea10: 7920 2e0d 0a20 2020 2020 2020 2020 2020  y ...           
-0000ea20: 200d 0a20 2020 2020 2020 203a 4578 616d   ..        :Exam
-0000ea30: 706c 653a 0d0a 2020 2020 2020 2020 2020  ple:..          
-0000ea40: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000ea50: 3e3e 3e20 6672 6f6d 2070 7963 7361 6d74  >>> from pycsamt
-0000ea60: 2e66 662e 636f 7265 2e61 7667 2e41 7667  .ff.core.avg.Avg
-0000ea70: 2069 6d70 6f72 7420 4865 6164 6572 0d0a   import Header..
-0000ea80: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0000ea90: 4865 6164 6572 2829 2e77 7269 7465 5f68  Header().write_h
-0000eaa0: 6561 6465 725f 6c6f 6728 6461 7461 5f66  eader_log(data_f
-0000eab0: 6e3d 7061 7468 2c0d 0a20 2020 2020 2020  n=path,..       
-0000eac0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0000ead0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-0000eae0: 2020 2020 2020 3e3e 3e20 6865 3d48 6561        >>> he=Hea
-0000eaf0: 6465 7228 290d 0a20 2020 2020 2020 2020  der()..         
-0000eb00: 2020 202e 2e2e 2068 652e 7772 6974 655f     ... he.write_
-0000eb10: 6865 6164 6572 5f6c 6f67 2864 6174 615f  header_log(data_
-0000eb20: 666e 3d70 6174 682c 0d0a 2020 2020 2020  fn=path,..      
-0000eb30: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0000eb40: 2020 2020 2020 2020 2020 2020 7361 7665              save
-0000eb50: 7061 7468 3d72 2743 3a2f 5573 6572 735c  path=r'C:/Users\
-0000eb60: 4164 6d69 6e69 7374 7261 746f 725c 4465  Administrator\De
-0000eb70: 736b 746f 7027 290d 0a20 2020 2020 2020  sktop')..       
-0000eb80: 2020 2020 202e 2e2e 2061 7667 5f6f 626a       ... avg_obj
-0000eb90: 2e48 6561 6465 722e 7772 6974 655f 6865  .Header.write_he
-0000eba0: 6164 6572 5f6c 6f67 2864 6174 615f 666e  ader_log(data_fn
-0000ebb0: 3d70 6174 682c 0d0a 2020 2020 2020 2020  =path,..        
-0000ebc0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0000ebd0: 2020 2020 2020 7361 7665 7061 7468 3d72        savepath=r
-0000ebe0: 2743 3a2f 5573 6572 732f 4164 6d69 6e69  'C:/Users/Admini
-0000ebf0: 7374 7261 746f 722f 4465 736b 746f 7027  strator/Desktop'
-0000ec00: 2920 0d0a 2020 2020 2020 2020 2222 220d  ) ..        """.
-0000ec10: 0a20 2020 2020 2020 2020 0d0a 2020 2020  .         ..    
-0000ec20: 2020 2020 6966 2064 6174 615f 666e 2069      if data_fn i
-0000ec30: 7320 6e6f 7420 4e6f 6e65 203a 2073 656c  s not None : sel
-0000ec40: 662e 6461 7461 5f66 6e20 3d64 6174 615f  f.data_fn =data_
-0000ec50: 666e 200d 0a20 2020 2020 2020 2069 6620  fn ..        if 
-0000ec60: 7361 7665 7061 7468 2069 7320 4e6f 6e65  savepath is None
-0000ec70: 203a 2073 6176 6570 6174 683d 6f73 2e67   : savepath=os.g
-0000ec80: 6574 6377 6428 290d 0a0d 0a20 2020 2020  etcwd()....     
-0000ec90: 2020 2069 6620 6f73 2e70 6174 682e 6973     if os.path.is
-0000eca0: 6669 6c65 2873 656c 662e 6461 7461 5f66  file(self.data_f
-0000ecb0: 6e20 2920 6973 2054 7275 6520 3a0d 0a20  n ) is True :.. 
-0000ecc0: 2020 2020 2020 2020 2020 2061 7667 5f6f             avg_o
-0000ecd0: 626a 3d41 7667 2864 6174 615f 666e 3d73  bj=Avg(data_fn=s
-0000ece0: 656c 662e 6461 7461 5f66 6e29 0d0a 2020  elf.data_fn)..  
-0000ecf0: 2020 2020 2020 2020 2020 6176 675f 6f62            avg_ob
-0000ed00: 6a2e 5f72 6561 645f 6176 675f 6669 6c65  j._read_avg_file
-0000ed10: 2864 6174 615f 666e 3d73 656c 662e 6461  (data_fn=self.da
-0000ed20: 7461 5f66 6e29 0d0a 2020 2020 2020 2020  ta_fn)..        
-0000ed30: 2020 2020 0d0a 2020 2020 2020 2020 726d      ..        rm
-0000ed40: 6c69 6e65 732c 2073 7061 635f 622c 2072  lines, spac_b, r
-0000ed50: 6574 6320 3d5b 5d2c 2022 2022 2a34 2c27  etc =[], " "*4,'
-0000ed60: 5c6e 270d 0a20 2020 2020 2020 2066 6f72  \n'..        for
-0000ed70: 2073 7320 2c20 6974 656d 7320 696e 2065   ss , items in e
-0000ed80: 6e75 6d65 7261 7465 2873 656c 662e 6865  numerate(self.he
-0000ed90: 6164 5f62 6c6f 636b 5f69 6e66 6f73 2920  ad_block_infos) 
-0000eda0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000edb0: 726d 6c69 6e65 732e 6170 7065 6e64 2827  rmlines.append('
-0000edc0: 3e27 2b20 6974 656d 7320 2b20 275c 6e27  >'+ items + '\n'
-0000edd0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-0000ede0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000edf0: 7373 3d3d 3020 3a0d 0a20 2020 2020 2020  ss==0 :..       
-0000ee00: 2020 2020 2020 2020 2066 6f72 206b 6579           for key
-0000ee10: 732c 2076 616c 7565 7320 696e 2061 7667  s, values in avg
-0000ee20: 5f6f 626a 2e48 6561 6465 722e 4861 7264  _obj.Header.Hard
-0000ee30: 7761 7265 496e 666f 732e 7363 6f6e 6669  wareInfos.sconfi
-0000ee40: 675f 6469 6374 2e69 7465 6d73 2829 3a0d  g_dict.items():.
-0000ee50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ee60: 2020 2020 2072 6d6c 696e 6573 2e61 7070       rmlines.app
-0000ee70: 656e 6428 7370 6163 5f62 290d 0a20 2020  end(spac_b)..   
-0000ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee90: 2072 6d6c 696e 6573 2e61 7070 656e 6428   rmlines.append(
-0000eea0: 2727 2e6a 6f69 6e28 5b27 7b30 7d3a 272e  ''.join(['{0}:'.
-0000eeb0: 666f 726d 6174 2873 7472 286b 6579 7329  format(str(keys)
-0000eec0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0000eed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eef0: 277b 303a 7d27 2e66 6f72 6d61 7428 7374  '{0:}'.format(st
-0000ef00: 7228 7661 6c75 6573 2929 5d29 290d 0a20  r(values))])).. 
-0000ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef20: 2020 2072 6d6c 696e 6573 2e61 7070 656e     rmlines.appen
-0000ef30: 6428 7265 7463 290d 0a20 2020 2020 2020  d(retc)..       
-0000ef40: 2020 2020 2065 6c69 6620 7373 3d3d 3120       elif ss==1 
-0000ef50: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000ef60: 2020 2020 666f 7220 6b65 7973 202c 2076      for keys , v
-0000ef70: 616c 7565 7320 696e 2061 7667 5f6f 626a  alues in avg_obj
-0000ef80: 2e48 6561 6465 722e 5375 7276 6579 416e  .Header.SurveyAn
-0000ef90: 6e6f 7461 7469 6f6e 2e73 636f 6e66 6967  notation.sconfig
-0000efa0: 5f64 6963 742e 6974 656d 7328 293a 0d0a  _dict.items():..
+0000e1d0: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a 2020  ==========....  
+0000e1e0: 2020 4d6f 7265 2061 7474 7269 6275 7465    More attribute
+0000e1f0: 7320 6361 6e20 6265 2061 6464 6564 2062  s can be added b
+0000e200: 7920 696e 7075 7469 6e67 2061 206b 6579  y inputing a key
+0000e210: 2077 6f72 6420 6469 6374 696f 6e61 7279   word dictionary
+0000e220: 0d0a 2020 2020 0d0a 2020 2020 3a45 7861  ..    ..    :Exa
+0000e230: 6d70 6c65 3a0d 0a20 2020 2020 2020 200d  mple:..        .
+0000e240: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0000e250: 6d20 7079 6373 616d 742e 636f 7265 2e61  m pycsamt.core.a
+0000e260: 7667 2069 6d70 6f72 7420 4176 670d 0a20  vg import Avg.. 
+0000e270: 2020 2020 2020 203e 3e3e 2070 6174 683d         >>> path=
+0000e280: 6f73 2e70 6174 682e 6a6f 696e 286f 732e  os.path.join(os.
+0000e290: 656e 7669 726f 6e5b 2270 7943 5341 4d54  environ["pyCSAMT
+0000e2a0: 225d 2c20 0d0a 2020 2020 2020 2020 2e2e  "], ..        ..
+0000e2b0: 2e20 2020 2020 2020 2020 2027 7079 6373  .          'pycs
+0000e2c0: 616d 7427 2c20 2264 6174 6122 2c20 224c  amt', "data", "L
+0000e2d0: 4331 3031 2e61 7667 2229 0d0a 2020 2020  C101.avg")..    
+0000e2e0: 2020 2020 3e3e 3e20 6176 675f 6f62 6a3d      >>> avg_obj=
+0000e2f0: 2041 7667 2864 6174 615f 666e 3d70 6174   Avg(data_fn=pat
+0000e300: 6829 200d 0a20 2020 2020 2020 203e 3e3e  h) ..        >>>
+0000e310: 2073 7572 765f 6172 6561 3d20 6176 675f   surv_area= avg_
+0000e320: 6f62 6a2e 4865 6164 6572 2e53 7572 7665  obj.Header.Surve
+0000e330: 7941 6e6e 6f74 6174 696f 6e2e 7072 6f6a  yAnnotation.proj
+0000e340: 6563 745f 6172 6561 200d 0a20 2020 2020  ect_area ..     
+0000e350: 2020 203e 3e3e 2070 7269 6e74 2873 7572     >>> print(sur
+0000e360: 7665 792e 6172 6561 290d 0a20 2020 2020  vey.area)..     
+0000e370: 2020 200d 0a20 2020 2022 2222 0d0a 2020     ..    """..  
+0000e380: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+0000e390: 656c 662c 2068 6561 6465 725f 696e 666f  elf, header_info
+0000e3a0: 7320 3d20 4e6f 6e65 202c 202a 2a6b 7761  s = None , **kwa
+0000e3b0: 7267 7329 3a0d 0a0d 0a20 2020 2020 2020  rgs):....       
+0000e3c0: 2073 656c 662e 4861 7264 7761 7265 496e   self.HardwareIn
+0000e3d0: 666f 7320 3d5a 6f6e 6765 4861 7264 7761  fos =ZongeHardwa
+0000e3e0: 7265 2829 0d0a 2020 2020 2020 2020 7365  re()..        se
+0000e3f0: 6c66 2e53 7572 7665 7941 6e6e 6f74 6174  lf.SurveyAnnotat
+0000e400: 696f 6e3d 5375 7276 6579 416e 6e6f 7461  ion=SurveyAnnota
+0000e410: 7469 6f6e 2829 0d0a 2020 2020 2020 2020  tion()..        
+0000e420: 7365 6c66 2e53 7572 7665 7943 6f6e 6669  self.SurveyConfi
+0000e430: 6775 7261 7469 6f6e 3d53 7572 7665 7943  guration=SurveyC
+0000e440: 6f6e 6669 6775 7261 7469 6f6e 2829 0d0a  onfiguration()..
+0000e450: 2020 2020 2020 2020 7365 6c66 2e54 783d          self.Tx=
+0000e460: 5472 616e 736d 6974 7465 7250 726f 7065  TransmitterPrope
+0000e470: 7274 6965 7328 290d 0a20 2020 2020 2020  rties()..       
+0000e480: 2073 656c 662e 5278 3d52 6563 6569 7665   self.Rx=Receive
+0000e490: 7250 726f 7065 7274 6965 7328 290d 0a0d  rProperties()...
+0000e4a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0000e4b0: 2020 2066 6f72 206b 6579 7320 2069 6e20     for keys  in 
+0000e4c0: 6c69 7374 286b 7761 7267 732e 6b65 7973  list(kwargs.keys
+0000e4d0: 2829 293a 2020 2020 2020 200d 0a20 2020  ()):       ..   
+0000e4e0: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+0000e4f0: 7365 7461 7474 725f 5f28 6b65 7973 2c20  setattr__(keys, 
+0000e500: 6b77 6172 6773 5b6b 6579 735d 290d 0a20  kwargs[keys]).. 
+0000e510: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000e520: 2073 656c 662e 6865 6164 5f62 6c6f 636b   self.head_block
+0000e530: 5f69 6e66 6f73 203d 5b27 4861 7264 7761  _infos =['Hardwa
+0000e540: 7265 2069 6e66 6f73 272c 200d 0a20 2020  re infos', ..   
+0000e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e560: 2020 2020 2020 2020 2020 2020 2027 5375               'Su
+0000e570: 7276 6579 2061 6e6e 6f74 6174 696f 6e27  rvey annotation'
+0000e580: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0000e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5a0: 2020 2020 2753 7572 7665 7920 636f 6e66      'Survey conf
+0000e5b0: 6967 7572 6174 696f 6e27 2c20 0d0a 2020  iguration', ..  
+0000e5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5d0: 2020 2020 2020 2020 2020 2020 2020 2754                'T
+0000e5e0: 7261 6e73 6d69 7474 6572 2070 726f 7065  ransmitter prope
+0000e5f0: 7274 6965 7327 2c20 0d0a 2020 2020 2020  rties', ..      
+0000e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e610: 2020 2020 2020 2020 2020 2752 6563 6569            'Recei
+0000e620: 7665 7220 7072 6f70 6572 7469 6573 272c  ver properties',
+0000e630: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e650: 2020 2027 656e 6427 5d0d 0a0d 0a20 2020     'end']....   
+0000e660: 2064 6566 2077 7269 7465 5f68 6561 6465   def write_heade
+0000e670: 725f 6c6f 6728 7365 6c66 2c20 6461 7461  r_log(self, data
+0000e680: 5f66 6e3d 4e6f 6e65 202c 2073 6176 6570  _fn=None , savep
+0000e690: 6174 683d 4e6f 6e65 2029 3a20 0d0a 2020  ath=None ): ..  
+0000e6a0: 2020 2020 2020 2222 2220 0d0a 2020 2020        """ ..    
+0000e6b0: 2020 2020 4d65 7468 6f64 2074 6f20 7772      Method to wr
+0000e6c0: 6974 6520 796f 7572 2068 6561 6420 6c6f  ite your head lo
+0000e6d0: 672e 2049 6e20 6661 6374 206a 7573 7420  g. In fact just 
+0000e6e0: 746f 2073 6565 2077 6865 7468 6572 2079  to see whether y
+0000e6f0: 6f75 7220 0d0a 2020 2020 2020 2020 5a6f  our ..        Zo
+0000e700: 6e67 6520 496e 666f 7320 7761 7320 7365  nge Infos was se
+0000e710: 7420 636f 7272 6563 746c 792e 0d0a 2020  t correctly...  
+0000e720: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000e730: 5061 7261 6d65 7465 7273 200d 0a20 2020  Parameters ..   
+0000e740: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0000e750: 0a20 2020 2020 2020 2020 2020 202a 2064  .            * d
+0000e760: 6174 615f 666e 203a 2073 7472 200d 0a20  ata_fn : str .. 
+0000e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e780: 2020 2020 2020 2070 6174 6820 746f 2041         path to A
+0000e790: 7667 6669 6c65 0d0a 2020 2020 2020 2020  vgfile..        
+0000e7a0: 2020 2020 2a20 7361 7665 7061 7468 203a      * savepath :
+0000e7b0: 2073 7472 200d 0a20 2020 2020 2020 2020   str ..         
+0000e7c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000e7d0: 6174 6820 746f 2079 6f75 7220 6465 7374  ath to your dest
+0000e7e0: 696e 6174 696f 6e20 6669 6c65 202e 2069  ination file . i
+0000e7f0: 6620 4e6f 6e65 202c 200d 0a20 2020 2020  f None , ..     
+0000e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e810: 2020 2070 6174 6820 6973 2079 6f75 7220     path is your 
+0000e820: 6375 7272 656e 7420 776f 726b 2064 6972  current work dir
+0000e830: 6563 746f 7279 202e 0d0a 2020 2020 2020  ectory ...      
+0000e840: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000e850: 3a45 7861 6d70 6c65 3a0d 0a20 2020 2020  :Example:..     
+0000e860: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000e870: 2020 2020 203e 3e3e 2066 726f 6d20 7079       >>> from py
+0000e880: 6373 616d 742e 636f 7265 2e61 7667 2e41  csamt.core.avg.A
+0000e890: 7667 2069 6d70 6f72 7420 4865 6164 6572  vg import Header
+0000e8a0: 0d0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
+0000e8b0: 3e20 4865 6164 6572 2829 2e77 7269 7465  > Header().write
+0000e8c0: 5f68 6561 6465 725f 6c6f 6728 6461 7461  _header_log(data
+0000e8d0: 5f66 6e3d 7061 7468 2c0d 0a20 2020 2020  _fn=path,..     
+0000e8e0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0000e8f0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+0000e900: 2020 2020 2020 2020 3e3e 3e20 6865 3d48          >>> he=H
+0000e910: 6561 6465 7228 290d 0a20 2020 2020 2020  eader()..       
+0000e920: 2020 2020 202e 2e2e 2068 652e 7772 6974       ... he.writ
+0000e930: 655f 6865 6164 6572 5f6c 6f67 2864 6174  e_header_log(dat
+0000e940: 615f 666e 3d70 6174 682c 0d0a 2020 2020  a_fn=path,..    
+0000e950: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0000e960: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+0000e970: 7665 7061 7468 3d72 2743 3a2f 5573 6572  vepath=r'C:/User
+0000e980: 735c 4164 6d69 6e69 7374 7261 746f 725c  s\Administrator\
+0000e990: 4465 736b 746f 7027 290d 0a20 2020 2020  Desktop')..     
+0000e9a0: 2020 2020 2020 202e 2e2e 2061 7667 5f6f         ... avg_o
+0000e9b0: 626a 2e48 6561 6465 722e 7772 6974 655f  bj.Header.write_
+0000e9c0: 6865 6164 6572 5f6c 6f67 2864 6174 615f  header_log(data_
+0000e9d0: 666e 3d70 6174 682c 0d0a 2020 2020 2020  fn=path,..      
+0000e9e0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0000e9f0: 2020 2020 2020 2020 7361 7665 7061 7468          savepath
+0000ea00: 3d72 2743 3a2f 5573 6572 732f 4164 6d69  =r'C:/Users/Admi
+0000ea10: 6e69 7374 7261 746f 722f 4465 736b 746f  nistrator/Deskto
+0000ea20: 7027 2920 0d0a 2020 2020 2020 2020 2222  p') ..        ""
+0000ea30: 220d 0a20 2020 2020 2020 2020 0d0a 2020  "..         ..  
+0000ea40: 2020 2020 2020 6966 2064 6174 615f 666e        if data_fn
+0000ea50: 2069 7320 6e6f 7420 4e6f 6e65 203a 2073   is not None : s
+0000ea60: 656c 662e 6461 7461 5f66 6e20 3d64 6174  elf.data_fn =dat
+0000ea70: 615f 666e 200d 0a20 2020 2020 2020 2069  a_fn ..        i
+0000ea80: 6620 7361 7665 7061 7468 2069 7320 4e6f  f savepath is No
+0000ea90: 6e65 203a 2073 6176 6570 6174 683d 6f73  ne : savepath=os
+0000eaa0: 2e67 6574 6377 6428 290d 0a0d 0a20 2020  .getcwd()....   
+0000eab0: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
+0000eac0: 6973 6669 6c65 2873 656c 662e 6461 7461  isfile(self.data
+0000ead0: 5f66 6e20 2920 6973 2054 7275 6520 3a0d  _fn ) is True :.
+0000eae0: 0a20 2020 2020 2020 2020 2020 2061 7667  .            avg
+0000eaf0: 5f6f 626a 3d41 7667 2864 6174 615f 666e  _obj=Avg(data_fn
+0000eb00: 3d73 656c 662e 6461 7461 5f66 6e29 0d0a  =self.data_fn)..
+0000eb10: 2020 2020 2020 2020 2020 2020 6176 675f              avg_
+0000eb20: 6f62 6a2e 5f72 6561 645f 6176 675f 6669  obj._read_avg_fi
+0000eb30: 6c65 2864 6174 615f 666e 3d73 656c 662e  le(data_fn=self.
+0000eb40: 6461 7461 5f66 6e29 0d0a 2020 2020 2020  data_fn)..      
+0000eb50: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000eb60: 726d 6c69 6e65 732c 2073 7061 635f 622c  rmlines, spac_b,
+0000eb70: 2072 6574 6320 3d5b 5d2c 2022 2022 2a34   retc =[], " "*4
+0000eb80: 2c27 5c6e 270d 0a20 2020 2020 2020 2066  ,'\n'..        f
+0000eb90: 6f72 2073 7320 2c20 6974 656d 7320 696e  or ss , items in
+0000eba0: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
+0000ebb0: 6865 6164 5f62 6c6f 636b 5f69 6e66 6f73  head_block_infos
+0000ebc0: 2920 3a20 0d0a 2020 2020 2020 2020 2020  ) : ..          
+0000ebd0: 2020 726d 6c69 6e65 732e 6170 7065 6e64    rmlines.append
+0000ebe0: 2827 3e27 2b20 6974 656d 7320 2b20 275c  ('>'+ items + '\
+0000ebf0: 6e27 290d 0a20 2020 2020 2020 2020 2020  n')..           
+0000ec00: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
+0000ec10: 6620 7373 3d3d 3020 3a0d 0a20 2020 2020  f ss==0 :..     
+0000ec20: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+0000ec30: 6579 732c 2076 616c 7565 7320 696e 2061  eys, values in a
+0000ec40: 7667 5f6f 626a 2e48 6561 6465 722e 4861  vg_obj.Header.Ha
+0000ec50: 7264 7761 7265 496e 666f 732e 7363 6f6e  rdwareInfos.scon
+0000ec60: 6669 675f 6469 6374 2e69 7465 6d73 2829  fig_dict.items()
+0000ec70: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000ec80: 2020 2020 2020 2072 6d6c 696e 6573 2e61         rmlines.a
+0000ec90: 7070 656e 6428 7370 6163 5f62 290d 0a20  ppend(spac_b).. 
+0000eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ecb0: 2020 2072 6d6c 696e 6573 2e61 7070 656e     rmlines.appen
+0000ecc0: 6428 2727 2e6a 6f69 6e28 5b27 7b30 7d3a  d(''.join(['{0}:
+0000ecd0: 272e 666f 726d 6174 2873 7472 286b 6579  '.format(str(key
+0000ece0: 7329 292c 0d0a 2020 2020 2020 2020 2020  s)),..          
+0000ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed10: 2020 277b 303a 7d27 2e66 6f72 6d61 7428    '{0:}'.format(
+0000ed20: 7374 7228 7661 6c75 6573 2929 5d29 290d  str(values))])).
+0000ed30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ed40: 2020 2020 2072 6d6c 696e 6573 2e61 7070       rmlines.app
+0000ed50: 656e 6428 7265 7463 290d 0a20 2020 2020  end(retc)..     
+0000ed60: 2020 2020 2020 2065 6c69 6620 7373 3d3d         elif ss==
+0000ed70: 3120 3a20 0d0a 2020 2020 2020 2020 2020  1 : ..          
+0000ed80: 2020 2020 2020 666f 7220 6b65 7973 202c        for keys ,
+0000ed90: 2076 616c 7565 7320 696e 2061 7667 5f6f   values in avg_o
+0000eda0: 626a 2e48 6561 6465 722e 5375 7276 6579  bj.Header.Survey
+0000edb0: 416e 6e6f 7461 7469 6f6e 2e73 636f 6e66  Annotation.sconf
+0000edc0: 6967 5f64 6963 742e 6974 656d 7328 293a  ig_dict.items():
+0000edd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ede0: 2020 2020 2020 726d 6c69 6e65 732e 6170        rmlines.ap
+0000edf0: 7065 6e64 2873 7061 635f 6229 0d0a 2020  pend(spac_b)..  
+0000ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee10: 2020 726d 6c69 6e65 732e 6170 7065 6e64    rmlines.append
+0000ee20: 2827 272e 6a6f 696e 285b 277b 307d 3a27  (''.join(['{0}:'
+0000ee30: 2e66 6f72 6d61 7428 7374 7228 6b65 7973  .format(str(keys
+0000ee40: 2929 2c0d 0a20 2020 2020 2020 2020 2020  )),..           
+0000ee50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee70: 2027 7b30 3a7d 272e 666f 726d 6174 2873   '{0:}'.format(s
+0000ee80: 7472 2876 616c 7565 7329 295d 2929 0d0a  tr(values))]))..
+0000ee90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eea0: 2020 2020 726d 6c69 6e65 732e 6170 7065      rmlines.appe
+0000eeb0: 6e64 2872 6574 6329 0d0a 2020 2020 2020  nd(retc)..      
+0000eec0: 2020 2020 2020 656c 6966 2073 733d 3d32        elif ss==2
+0000eed0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0000eee0: 2020 2020 666f 7220 6b65 7973 202c 2076      for keys , v
+0000eef0: 616c 7565 7320 696e 2061 7667 5f6f 626a  alues in avg_obj
+0000ef00: 2e48 6561 6465 722e 5375 7276 6579 436f  .Header.SurveyCo
+0000ef10: 6e66 6967 7572 6174 696f 6e2e 7363 6f6e  nfiguration.scon
+0000ef20: 6669 675f 6469 6374 2e69 7465 6d73 2829  fig_dict.items()
+0000ef30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000ef40: 2020 2020 2020 2072 6d6c 696e 6573 2e61         rmlines.a
+0000ef50: 7070 656e 6428 7370 6163 5f62 290d 0a20  ppend(spac_b).. 
+0000ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef70: 2020 2072 6d6c 696e 6573 2e61 7070 656e     rmlines.appen
+0000ef80: 6428 2727 2e6a 6f69 6e28 5b27 7b30 7d3a  d(''.join(['{0}:
+0000ef90: 272e 666f 726d 6174 2873 7472 286b 6579  '.format(str(key
+0000efa0: 7329 292c 0d0a 2020 2020 2020 2020 2020  s)),..          
 0000efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000efc0: 2020 2020 726d 6c69 6e65 732e 6170 7065      rmlines.appe
-0000efd0: 6e64 2873 7061 635f 6229 0d0a 2020 2020  nd(spac_b)..    
-0000efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eff0: 726d 6c69 6e65 732e 6170 7065 6e64 2827  rmlines.append('
-0000f000: 272e 6a6f 696e 285b 277b 307d 3a27 2e66  '.join(['{0}:'.f
-0000f010: 6f72 6d61 7428 7374 7228 6b65 7973 2929  ormat(str(keys))
-0000f020: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f040: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000f050: 7b30 3a7d 272e 666f 726d 6174 2873 7472  {0:}'.format(str
-0000f060: 2876 616c 7565 7329 295d 2929 0d0a 2020  (values))]))..  
-0000f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f080: 2020 726d 6c69 6e65 732e 6170 7065 6e64    rmlines.append
-0000f090: 2872 6574 6329 0d0a 2020 2020 2020 2020  (retc)..        
-0000f0a0: 2020 2020 656c 6966 2073 733d 3d32 203a      elif ss==2 :
-0000f0b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f0c0: 2020 666f 7220 6b65 7973 202c 2076 616c    for keys , val
-0000f0d0: 7565 7320 696e 2061 7667 5f6f 626a 2e48  ues in avg_obj.H
-0000f0e0: 6561 6465 722e 5375 7276 6579 436f 6e66  eader.SurveyConf
-0000f0f0: 6967 7572 6174 696f 6e2e 7363 6f6e 6669  iguration.sconfi
-0000f100: 675f 6469 6374 2e69 7465 6d73 2829 3a0d  g_dict.items():.
-0000f110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f120: 2020 2020 2072 6d6c 696e 6573 2e61 7070       rmlines.app
-0000f130: 656e 6428 7370 6163 5f62 290d 0a20 2020  end(spac_b)..   
-0000f140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f150: 2072 6d6c 696e 6573 2e61 7070 656e 6428   rmlines.append(
-0000f160: 2727 2e6a 6f69 6e28 5b27 7b30 7d3a 272e  ''.join(['{0}:'.
-0000f170: 666f 726d 6174 2873 7472 286b 6579 7329  format(str(keys)
-0000f180: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0000f190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1b0: 277b 303a 7d27 2e66 6f72 6d61 7428 7374  '{0:}'.format(st
-0000f1c0: 7228 7661 6c75 6573 2929 5d29 290d 0a20  r(values))])).. 
-0000f1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1e0: 2020 2072 6d6c 696e 6573 2e61 7070 656e     rmlines.appen
-0000f1f0: 6428 7265 7463 290d 0a20 2020 2020 2020  d(retc)..       
-0000f200: 2020 2020 2065 6c69 6620 7373 203d 3d33       elif ss ==3
-0000f210: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0000f220: 2020 2020 666f 7220 6b65 7973 202c 2076      for keys , v
-0000f230: 616c 7565 7320 696e 2061 7667 5f6f 626a  alues in avg_obj
-0000f240: 2e48 6561 6465 722e 5478 2e73 636f 6e66  .Header.Tx.sconf
-0000f250: 6967 5f64 6963 742e 6974 656d 7328 293a  ig_dict.items():
-0000f260: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f270: 2020 2020 2020 726d 6c69 6e65 732e 6170        rmlines.ap
-0000f280: 7065 6e64 2873 7061 635f 6229 0d0a 2020  pend(spac_b)..  
-0000f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2a0: 2020 726d 6c69 6e65 732e 6170 7065 6e64    rmlines.append
-0000f2b0: 2827 272e 6a6f 696e 285b 277b 307d 3a27  (''.join(['{0}:'
-0000f2c0: 2e66 6f72 6d61 7428 7374 7228 6b65 7973  .format(str(keys
-0000f2d0: 2929 2c0d 0a20 2020 2020 2020 2020 2020  )),..           
-0000f2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f300: 2027 7b30 3a7d 272e 666f 726d 6174 2873   '{0:}'.format(s
-0000f310: 7472 2876 616c 7565 7329 295d 2929 0d0a  tr(values))]))..
-0000f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f330: 2020 2020 726d 6c69 6e65 732e 6170 7065      rmlines.appe
-0000f340: 6e64 2872 6574 6329 0d0a 2020 2020 2020  nd(retc)..      
-0000f350: 2020 2020 2020 656c 6966 2073 7320 3d3d        elif ss ==
-0000f360: 2034 203a 200d 0a20 2020 2020 2020 2020   4 : ..         
-0000f370: 2020 2020 2020 2066 6f72 206b 6579 7320         for keys 
-0000f380: 2c20 7661 6c75 6573 2069 6e20 6176 675f  , values in avg_
-0000f390: 6f62 6a2e 4865 6164 6572 2e52 782e 7363  obj.Header.Rx.sc
-0000f3a0: 6f6e 6669 675f 6469 6374 2e69 7465 6d73  onfig_dict.items
-0000f3b0: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-0000f3c0: 2020 2020 2020 2020 2072 6d6c 696e 6573           rmlines
-0000f3d0: 2e61 7070 656e 6428 7370 6163 5f62 290d  .append(spac_b).
-0000f3e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f3f0: 2020 2020 2072 6d6c 696e 6573 2e61 7070       rmlines.app
-0000f400: 656e 6428 2727 2e6a 6f69 6e28 5b27 7b30  end(''.join(['{0
-0000f410: 7d3a 272e 666f 726d 6174 2873 7472 286b  }:'.format(str(k
-0000f420: 6579 7329 292c 0d0a 2020 2020 2020 2020  eys)),..        
-0000f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f450: 2020 2020 277b 303a 7d27 2e66 6f72 6d61      '{0:}'.forma
-0000f460: 7428 7374 7228 7661 6c75 6573 2929 5d29  t(str(values))])
-0000f470: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000f480: 2020 2020 2020 2072 6d6c 696e 6573 2e61         rmlines.a
-0000f490: 7070 656e 6428 7265 7463 290d 0a20 2020  ppend(retc)..   
-0000f4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f4b0: 200d 0a20 2020 2020 2020 2077 6974 6820   ..        with 
-0000f4c0: 6f70 656e 2028 2727 2e6a 6f69 6e28 5b6f  open (''.join([o
-0000f4d0: 732e 7061 7468 2e62 6173 656e 616d 6528  s.path.basename(
-0000f4e0: 7365 6c66 2e64 6174 615f 666e 292c 275f  self.data_fn),'_
-0000f4f0: 7079 4353 272c 222e 6c6f 6722 5d29 2c0d  pyCS',".log"]),.
-0000f500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f510: 2020 2020 2777 272c 2065 6e63 6f64 696e      'w', encodin
-0000f520: 673d 2775 7466 3827 2920 6173 2066 643a  g='utf8') as fd:
-0000f530: 0d0a 2020 2020 2020 2020 2020 2020 6664  ..            fd
-0000f540: 2e77 7269 7465 6c69 6e65 7328 726d 6c69  .writelines(rmli
-0000f550: 6e65 7329 0d0a 2020 2020 2020 2020 2020  nes)..          
-0000f560: 2020 0d0a 2020 2020 2020 2020 6966 2073    ..        if s
-0000f570: 6176 6570 6174 6820 6973 206e 6f74 204e  avepath is not N
-0000f580: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
-0000f590: 2020 2073 6875 7469 6c2e 6d6f 7665 2028     shutil.move (
-0000f5a0: 2727 2e6a 6f69 6e28 5b0d 0a20 2020 2020  ''.join([..     
-0000f5b0: 2020 2020 2020 2020 2020 206f 732e 7061             os.pa
-0000f5c0: 7468 2e62 6173 656e 616d 6528 7365 6c66  th.basename(self
-0000f5d0: 2e64 6174 615f 666e 292c 275f 7079 4353  .data_fn),'_pyCS
-0000f5e0: 272c 222e 6c6f 6722 5d29 2c73 6176 6570  ',".log"]),savep
-0000f5f0: 6174 6829 0d0a 2020 2020 2020 2020 0d0a  ath)..        ..
-0000f600: 2020 2020 2020 2020 7072 696e 7428 272d          print('-
-0000f610: 2d2d 3e20 596f 7572 2048 6c6f 6720 6669  --> Your Hlog fi
-0000f620: 6c65 203c 7b30 7d3e 2068 6173 2062 6565  le <{0}> has bee
-0000f630: 6e20 7772 6974 7465 6e20 7375 6363 6573  n written succes
-0000f640: 7366 756c 6c79 2021 3c2d 2d2d 272e 5c0d  sfully !<---'.\.
-0000f650: 0a20 2020 2020 2020 2020 2020 2020 2066  .              f
-0000f660: 6f72 6d61 7428 2727 2e6a 6f69 6e28 5b6f  ormat(''.join([o
-0000f670: 732e 7061 7468 2e62 6173 656e 616d 6528  s.path.basename(
-0000f680: 7365 6c66 2e64 6174 615f 666e 292c 275f  self.data_fn),'_
-0000f690: 7079 4353 272c 222e 6c6f 6722 5d29 2929  pyCS',".log"])))
-0000f6a0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-0000f6b0: 0d0a 636c 6173 7320 5375 7276 6579 416e  ..class SurveyAn
-0000f6c0: 6e6f 7461 7469 6f6e 2028 6f62 6a65 6374  notation (object
-0000f6d0: 2920 3a20 0d0a 2020 2020 2222 220d 0a20  ) : ..    """.. 
-0000f6e0: 2020 2043 6c61 7373 2066 6f72 2073 7572     Class for sur
-0000f6f0: 7665 7920 616e 6e6f 7461 7469 6f6e 732e  vey annotations.
-0000f700: 0d0a 2020 2020 2020 2020 200d 0a20 2020  ..         ..   
-0000f710: 2041 7267 756d 656e 7473 2020 0d0a 2020   Arguments  ..  
-0000f720: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20    -----------.. 
-0000f730: 2020 2020 2020 202a 2a73 7572 7665 795f         **survey_
-0000f740: 616e 6e6f 7461 7469 6f6e 735f 6461 7461  annotations_data
-0000f750: 2a2a 3a20 6c69 7374 202c 2073 7472 2020  **: list , str  
-0000f760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f780: 2020 2020 2020 7061 7468 2074 6f20 796f        path to yo
-0000f790: 7572 2061 6e6e 6f74 6174 696f 6e20 6669  ur annotation fi
-0000f7a0: 6c65 206f 7220 200d 0a20 2020 2020 2020  le or  ..       
-0000f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7c0: 2020 2020 2020 2020 2020 2020 2046 696c               Fil
-0000f7d0: 6c65 6420 6175 746f 6d61 7469 6361 6c6c  led automaticall
-0000f7e0: 790d 0a20 2020 2020 2020 200d 0a20 2020  y..        ..   
-0000f7f0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-0000f800: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-0000f810: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-0000f820: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f830: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2041  =========..    A
-0000f840: 7474 7269 6275 7465 7320 2020 2020 2020  ttributes       
-0000f850: 2020 2020 2020 2054 7970 6520 2020 2020         Type     
-0000f860: 2020 2045 7870 6c61 6e61 7469 6f6e 0d0a     Explanation..
-0000f870: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
-0000f880: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-0000f890: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
-0000f8a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000f8b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
-0000f8c0: 2020 7072 6f6a 6563 745f 6e61 6d65 2020    project_name  
-0000f8d0: 2020 2020 2020 2020 2020 7374 7220 2020            str   
-0000f8e0: 2020 2020 2020 7072 6f6a 6563 7420 6e61        project na
-0000f8f0: 6d65 200d 0a20 2020 2070 726f 6a65 6374  me ..    project
-0000f900: 5f61 7265 6120 2020 2020 2020 2020 2020  _area           
-0000f910: 2073 7472 2020 2020 2020 2020 2070 726f   str         pro
-0000f920: 6a65 6374 2061 7265 6120 0d0a 2020 2020  ject area ..    
-0000f930: 6375 7374 756d 6572 5f6e 616d 6520 2020  custumer_name   
-0000f940: 2020 2020 2020 2020 7374 7220 2020 2020          str     
-0000f950: 2020 2020 636f 6d70 616e 7920 6e61 6d65      company name
-0000f960: 200d 0a20 2020 2063 6f6e 7472 6163 746f   ..    contracto
-0000f970: 725f 6e61 6d65 2020 2020 2020 2020 2073  r_name         s
-0000f980: 7472 2020 2020 2020 2020 2063 6f6e 7472  tr         contr
-0000f990: 6163 746f 7220 6e61 6d65 200d 0a20 2020  actor name ..   
-0000f9a0: 2070 726f 6a65 745f 6c61 6265 6c20 2020   projet_label   
-0000f9b0: 2020 2020 2020 2020 2073 7472 2020 2020           str    
-0000f9c0: 2020 2020 206c 6162 656c 206f 7220 6e75       label or nu
-0000f9d0: 6d62 6572 200d 0a20 2020 2061 6371 6461  mber ..    acqda
-0000f9e0: 7465 2020 2020 2020 2020 2020 2020 2020  te              
-0000f9f0: 2020 2073 7472 2020 2020 2020 2020 2064     str         d
-0000fa00: 6174 6120 6163 7175 6973 6974 696f 6e20  ata acquisition 
-0000fa10: 6461 7465 200d 0a20 2020 2073 636f 6e66  date ..    sconf
-0000fa20: 6967 5f64 6963 7420 2020 2020 2020 2020  ig_dict         
-0000fa30: 2020 2064 6963 7420 2020 2020 2020 2073     dict        s
-0000fa40: 7572 7665 7920 616e 6e6f 7461 7469 6f6e  urvey annotation
-0000fa50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa70: 2020 2020 2020 2020 2020 6469 6374 696f            dictio
-0000fa80: 6e6e 6172 7920 2020 2020 2020 0d0a 2020  nnary       ..  
-0000fa90: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-0000faa0: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-0000fab0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-0000fac0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000fad0: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
-0000fae0: 0d0a 2020 2020 4d6f 7265 2061 7474 7269  ..    More attri
-0000faf0: 6275 7465 7320 6361 6e20 6265 2061 6464  butes can be add
-0000fb00: 6564 2062 7920 696e 7075 7469 6e67 2061  ed by inputing a
-0000fb10: 206b 6579 2077 6f72 6420 6469 6374 696f   key word dictio
-0000fb20: 6e61 7279 0d0a 2020 2020 0d0a 2020 2020  nary..    ..    
-0000fb30: 3a45 7861 6d70 6c65 3a0d 0a20 2020 2020  :Example:..     
-0000fb40: 2020 2020 0d0a 2020 2020 2020 2020 3e3e      ..        >>
-0000fb50: 3e20 6672 6f6d 2070 7963 7361 6d74 2e66  > from pycsamt.f
-0000fb60: 662e 636f 7265 2e61 7667 2069 6d70 6f72  f.core.avg impor
-0000fb70: 7420 4176 6720 0d0a 2020 2020 2020 2020  t Avg ..        
-0000fb80: 3e3e 3e20 6176 675f 6f62 6a3d 2041 7667  >>> avg_obj= Avg
-0000fb90: 2864 6174 615f 666e 3d70 6174 6829 200d  (data_fn=path) .
-0000fba0: 0a20 2020 2020 2020 203e 3e3e 2073 7572  .        >>> sur
-0000fbb0: 765f 6172 6561 3d20 6176 675f 6f62 6a2e  v_area= avg_obj.
-0000fbc0: 4865 6164 6572 2e53 7572 7665 7941 6e6e  Header.SurveyAnn
-0000fbd0: 6f74 6174 696f 6e2e 7072 6f6a 6563 745f  otation.project_
-0000fbe0: 6172 6561 200d 0a20 2020 2020 2020 202e  area ..        .
-0000fbf0: 2e2e 2073 7572 7665 795f 6172 6561 0d0a  .. survey_area..
-0000fc00: 2020 2020 2020 2020 2e2e 2e20 6176 675f          ... avg_
-0000fc10: 6f62 6a2e 4865 6164 6572 2e53 7572 7665  obj.Header.Surve
-0000fc20: 7941 6e6e 6f74 6174 696f 6e2e 7363 6f6e  yAnnotation.scon
-0000fc30: 6669 675f 6469 6374 5b27 4a6f 622e 4279  fig_dict['Job.By
-0000fc40: 275d 0d0a 2020 2020 2222 220d 0a20 2020  ']..    """..   
-0000fc50: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0000fc60: 6c66 2c20 7375 7276 6579 5f61 6e6e 6f74  lf, survey_annot
-0000fc70: 6174 696f 6e73 5f64 6174 6120 3d4e 6f6e  ations_data =Non
-0000fc80: 6520 202c 2020 2a2a 6b77 6172 6773 293a  e  ,  **kwargs):
-0000fc90: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-0000fca0: 2e7a 6f6e 5f73 6572 765f 616e 6e6f 7461  .zon_serv_annota
-0000fcb0: 7469 6f6e 7320 3d20 7375 7276 6579 5f61  tions = survey_a
-0000fcc0: 6e6e 6f74 6174 696f 6e73 5f64 6174 610d  nnotations_data.
-0000fcd0: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
-0000fce0: 6f6a 6563 745f 6e61 6d65 203d 2743 5341  oject_name ='CSA
-0000fcf0: 4d54 5f73 7572 7665 7927 0d0a 2020 2020  MT_survey'..    
-0000fd00: 2020 2020 7365 6c66 2e70 726f 6a65 6374      self.project
-0000fd10: 5f61 7265 6120 3d4e 6f6e 650d 0a20 2020  _area =None..   
-0000fd20: 2020 2020 2073 656c 662e 6375 7374 756d       self.custum
-0000fd30: 6572 5f6e 616d 6520 3d27 5a6f 6e67 6520  er_name ='Zonge 
-0000fd40: 456e 6769 6e65 6572 696e 6722 2720 0d0a  Engineering"' ..
-0000fd50: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
-0000fd60: 7472 6163 746f 725f 6e61 6d65 203d 275a  tractor_name ='Z
-0000fd70: 6f6e 6765 270d 0a20 2020 2020 2020 2073  onge'..        s
-0000fd80: 656c 662e 7072 6f6a 6563 745f 6c61 6265  elf.project_labe
-0000fd90: 6c20 3d20 2770 7943 5341 4d54 2720 0d0a  l = 'pyCSAMT' ..
-0000fda0: 2020 2020 2020 2020 7365 6c66 2e61 6371          self.acq
-0000fdb0: 6461 7465 203d 277b 307d 2d7b 317d 272e  date ='{0}-{1}'.
-0000fdc0: 666f 726d 6174 2864 6174 6574 696d 652e  format(datetime.
-0000fdd0: 6e6f 7728 292c 2074 696d 657a 6f6e 652e  now(), timezone.
-0000fde0: 7574 6329 0d0a 2020 2020 2020 2020 7365  utc)..        se
-0000fdf0: 6c66 2e73 636f 6e66 6967 5f64 6963 743d  lf.sconfig_dict=
-0000fe00: 7b27 4a6f 622e 4e61 6d65 273a 7365 6c66  {'Job.Name':self
-0000fe10: 2e70 726f 6a65 6374 5f6e 616d 6520 2c20  .project_name , 
-0000fe20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000fe30: 2020 2020 2020 2020 274a 6f62 2e41 7265          'Job.Are
-0000fe40: 6127 3a73 656c 662e 7072 6f6a 6563 745f  a':self.project_
-0000fe50: 6172 6561 202c 200d 0a20 2020 2020 2020  area , ..       
-0000fe60: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000fe70: 4a6f 622e 466f 7227 3a73 656c 662e 6375  Job.For':self.cu
-0000fe80: 7374 756d 6572 5f6e 616d 652c 200d 0a20  stumer_name, .. 
-0000fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fea0: 2020 2020 2027 4a6f 622e 4279 273a 7365       'Job.By':se
-0000feb0: 6c66 2e63 6f6e 7472 6163 746f 725f 6e61  lf.contractor_na
-0000fec0: 6d65 2c20 0d0a 2020 2020 2020 2020 2020  me, ..          
-0000fed0: 2020 2020 2020 2020 2020 2020 274a 6f62              'Job
-0000fee0: 2e4e 756d 6265 7227 3a73 656c 662e 7072  .Number':self.pr
-0000fef0: 6f6a 6563 745f 6c61 6265 6c20 2c20 0d0a  oject_label , ..
-0000ff00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ff10: 2020 2020 2020 274a 6f62 2e44 6174 6527        'Job.Date'
-0000ff20: 3a20 7365 6c66 2e61 6371 6461 7465 2c20  : self.acqdate, 
-0000ff30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ff40: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
-0000ff50: 2020 200d 0a20 2020 2020 2020 2066 6f72     ..        for
-0000ff60: 206b 6579 7320 696e 206c 6973 7428 6b77   keys in list(kw
-0000ff70: 6172 6773 2e6b 6579 7328 2929 3a0d 0a20  args.keys()):.. 
-0000ff80: 2020 2020 2020 2020 2020 2069 6620 6b65             if ke
-0000ff90: 7973 206e 6f74 2069 6e20 5375 7276 6579  ys not in Survey
-0000ffa0: 416e 6e6f 7461 7469 6f6e 2e5f 5f64 6963  Annotation.__dic
-0000ffb0: 745f 5f2e 6b65 7973 2829 3a0d 0a20 2020  t__.keys():..   
-0000ffc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000ffd0: 662e 5f5f 7365 7461 7474 725f 5f28 6b65  f.__setattr__(ke
-0000ffe0: 7973 2c20 6b77 6172 6773 5b6b 6579 735d  ys, kwargs[keys]
-0000fff0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00010000: 2020 2073 656c 662e 7363 6f6e 6669 675f     self.sconfig_
-00010010: 6469 6374 2e5f 5f73 6574 6974 656d 5f5f  dict.__setitem__
-00010020: 286b 6579 732c 206b 7761 7267 735b 6b65  (keys, kwargs[ke
-00010030: 7973 5d29 0d0a 2020 2020 2020 2020 2020  ys])..          
-00010040: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
-00010050: 7365 745f 7375 7276 6579 5f61 6e6e 6f74  set_survey_annot
-00010060: 6174 696f 6e73 5f69 6e66 6f73 2028 7365  ations_infos (se
-00010070: 6c66 2c20 7375 7276 6579 5f61 6e6e 6f74  lf, survey_annot
-00010080: 6174 696f 6e73 5f64 6174 6120 3d4e 6f6e  ations_data =Non
-00010090: 6529 3a20 0d0a 2020 2020 2020 2020 2222  e): ..        ""
-000100a0: 220d 0a20 2020 2020 2020 204d 6574 686f  "..        Metho
-000100b0: 6420 746f 2073 6574 205f 7375 7276 6579  d to set _survey
-000100c0: 2061 6e6e 6f74 6174 696f 6e73 2069 6e66   annotations inf
-000100d0: 6f72 6d61 7469 6f6e 7320 2e0d 0a20 2020  ormations ...   
-000100e0: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
-000100f0: 6172 616d 6574 6572 7320 0d0a 2020 2020  arameters ..    
-00010100: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00010110: 2020 2020 2020 2020 2020 2020 2a20 7375              * su
-00010120: 7276 6579 5f61 6e6e 6f74 6174 696f 6e20  rvey_annotation 
-00010130: 3a20 6c69 7374 200d 0a20 2020 2020 2020  : list ..       
-00010140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010150: 2020 2020 2020 2020 2063 6f6e 7461 696e           contain
-00010160: 6572 206f 6620 7375 7276 6579 2061 6e6e  er of survey ann
-00010170: 6f74 6174 696f 6e73 2069 6e66 6f73 2e20  otations infos. 
-00010180: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00010190: 2020 2020 2020 205f 6c6f 6767 6572 2e69         _logger.i
-000101a0: 6e66 6f28 2752 6561 6469 6e67 2061 6e64  nfo('Reading and
-000101b0: 2073 6574 7469 6e67 207a 6f6e 6765 2073   setting zonge s
-000101c0: 7572 7665 7920 416e 6e6f 7461 7469 6f6e  urvey Annotation
-000101d0: 7320 696e 666f 7320 2127 290d 0a20 2020  s infos !')..   
-000101e0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-000101f0: 6620 7375 7276 6579 5f61 6e6e 6f74 6174  f survey_annotat
-00010200: 696f 6e73 5f64 6174 6120 6973 206e 6f74  ions_data is not
-00010210: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
-00010220: 2020 2020 2020 7365 6c66 2e7a 6f6e 5f73        self.zon_s
-00010230: 6572 765f 616e 6e6f 7461 7469 6f6e 7320  erv_annotations 
-00010240: 3d20 7375 7276 6579 5f61 6e6e 6f74 6174  = survey_annotat
-00010250: 696f 6e73 5f64 6174 610d 0a20 2020 2020  ions_data..     
-00010260: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00010270: 2069 6620 7365 6c66 2e7a 6f6e 5f73 6572   if self.zon_ser
-00010280: 765f 616e 6e6f 7461 7469 6f6e 7320 6973  v_annotations is
-00010290: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
-000102a0: 2020 2020 2020 4353 6578 2e70 7943 5341        CSex.pyCSA
-000102b0: 4d54 4572 726f 725f 696e 7075 7461 7267  MTError_inputarg
-000102c0: 756d 656e 7473 280d 0a20 2020 2020 2020  uments(..       
-000102d0: 2020 2020 2020 2020 2027 4e6f 2073 7572           'No sur
-000102e0: 7665 795f 616e 6e6f 7461 7469 6f6e 7320  vey_annotations 
-000102f0: 696e 666f 726d 6174 696f 6e73 2066 6f75  informations fou
-00010300: 6e64 2127 290d 0a20 2020 2020 2020 2020  nd!')..         
-00010310: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00010320: 200d 0a20 2020 2020 2020 2069 6620 7479   ..        if ty
-00010330: 7065 2873 656c 662e 7a6f 6e5f 7365 7276  pe(self.zon_serv
-00010340: 5f61 6e6e 6f74 6174 696f 6e73 2029 2069  _annotations ) i
-00010350: 7320 6e6f 7420 6c69 7374 3a20 0d0a 2020  s not list: ..  
-00010360: 2020 2020 2020 2020 2020 7472 7920 3a0d            try :.
-00010370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010380: 2069 6620 6f73 2e70 6174 682e 6973 6669   if os.path.isfi
-00010390: 6c65 2873 656c 662e 7a6f 6e5f 7365 7276  le(self.zon_serv
-000103a0: 5f61 6e6e 6f74 6174 696f 6e73 2029 2069  _annotations ) i
-000103b0: 7320 5472 7565 203a 0d0a 2020 2020 2020  s True :..      
-000103c0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-000103d0: 7468 206f 7065 6e20 2873 656c 662e 7a6f  th open (self.zo
-000103e0: 6e5f 7365 7276 5f61 6e6e 6f74 6174 696f  n_serv_annotatio
-000103f0: 6e73 202c 2027 7227 2c0d 0a20 2020 2020  ns , 'r',..     
-00010400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010410: 2020 2020 2020 2020 2020 656e 636f 6469            encodi
-00010420: 6e67 203d 2775 7466 3827 2920 6173 2066  ng ='utf8') as f
-00010430: 6964 203a 0d0a 2020 2020 2020 2020 2020  id :..          
-00010440: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00010450: 6c66 2e7a 6f6e 5f73 6572 765f 616e 6e6f  lf.zon_serv_anno
-00010460: 7461 7469 6f6e 7320 3d66 6964 2e72 6561  tations =fid.rea
-00010470: 646c 696e 6573 2829 0d0a 2020 2020 2020  dlines()..      
-00010480: 2020 2020 2020 6578 6365 7074 203a 2072        except : r
-00010490: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-000104a0: 5445 7272 6f72 5f48 6561 6465 7228 0d0a  TError_Header(..
-000104b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104c0: 2020 2020 2250 6c65 6173 6520 6368 6563      "Please chec
-000104d0: 6b20 796f 7572 2061 6e6e 6f74 6174 696f  k your annotatio
-000104e0: 6e20 6461 7461 2021 2022 0d0a 2020 2020  n data ! "..    
-000104f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010500: 2020 224d 7573 7420 6265 2062 6520 6120    "Must be be a 
-00010510: 6c69 7374 206f 7220 6669 6c65 2022 2920  list or file ") 
-00010520: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00010530: 2020 2020 2020 2020 666f 7220 7a6f 6e73          for zons
-00010540: 7572 7661 2069 6e20 7365 6c66 2e7a 6f6e  urva in self.zon
-00010550: 5f73 6572 765f 616e 6e6f 7461 7469 6f6e  _serv_annotation
-00010560: 7320 3a0d 0a0d 0a20 2020 2020 2020 2020  s :....         
-00010570: 2020 207a 6f6e 7375 7276 6120 3d7a 6f6e     zonsurva =zon
-00010580: 7375 7276 612e 7374 7269 7028 292e 7370  surva.strip().sp
-00010590: 6c69 7428 273d 2729 0d0a 2020 2020 2020  lit('=')..      
-000105a0: 2020 2020 2020 6966 2027 6a6f 622e 6e61        if 'job.na
-000105b0: 6d65 2720 696e 207a 6f6e 7375 7276 615b  me' in zonsurva[
-000105c0: 305d 2e6c 6f77 6572 2829 3a20 0d0a 2020  0].lower(): ..  
-000105d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000105e0: 207a 6f6e 7375 7276 615b 315d 2020 213d   zonsurva[1]  !=
-000105f0: 2727 3a20 0d0a 2020 2020 2020 2020 2020  '': ..          
-00010600: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00010610: 726f 6a65 6374 5f6e 616d 653d 7a6f 6e73  roject_name=zons
-00010620: 7572 7661 5b31 5d0d 0a20 2020 2020 2020  urva[1]..       
-00010630: 2020 2020 2069 6620 276a 6f62 2e61 7265       if 'job.are
-00010640: 6127 2069 6e20 7a6f 6e73 7572 7661 5b30  a' in zonsurva[0
-00010650: 5d2e 6c6f 7765 7228 2920 3a0d 0a20 2020  ].lower() :..   
-00010660: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00010670: 662e 7072 6f6a 6563 745f 6172 6561 203d  f.project_area =
-00010680: 7a6f 6e73 7572 7661 5b31 5d0d 0a20 2020  zonsurva[1]..   
-00010690: 2020 2020 2020 2020 2069 6620 276a 6f62           if 'job
-000106a0: 2e66 6f72 2720 696e 207a 6f6e 7375 7276  .for' in zonsurv
-000106b0: 615b 305d 2e6c 6f77 6572 2829 203a 0d0a  a[0].lower() :..
-000106c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000106d0: 6966 207a 6f6e 7375 7276 615b 315d 2020  if zonsurva[1]  
-000106e0: 213d 2727 203a 0d0a 2020 2020 2020 2020  !='' :..        
-000106f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010700: 2e63 7573 7475 6d65 725f 6e61 6d65 203d  .custumer_name =
-00010710: 207a 6f6e 7375 7276 615b 315d 0d0a 2020   zonsurva[1]..  
-00010720: 2020 2020 2020 2020 2020 6966 2027 6a6f            if 'jo
-00010730: 622e 6279 2769 6e20 7a6f 6e73 7572 7661  b.by'in zonsurva
-00010740: 5b30 5d2e 6c6f 7765 7228 2920 3a0d 0a20  [0].lower() :.. 
-00010750: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00010760: 6620 7a6f 6e73 7572 7661 5b31 5d20 2021  f zonsurva[1]  !
-00010770: 3d27 2720 3a0d 0a20 2020 2020 2020 2020  ='' :..         
-00010780: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00010790: 636f 6e74 7261 6374 6f72 5f6e 616d 6520  contractor_name 
-000107a0: 3d20 207a 6f6e 7375 7276 615b 315d 0d0a  =  zonsurva[1]..
-000107b0: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-000107c0: 6a6f 622e 6e75 6d62 6572 2769 6e20 7a6f  job.number'in zo
-000107d0: 6e73 7572 7661 5b30 5d2e 6c6f 7765 7228  nsurva[0].lower(
-000107e0: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-000107f0: 2020 2020 2069 6620 7a6f 6e73 7572 7661       if zonsurva
-00010800: 5b31 5d20 2021 3d27 2720 3a0d 0a20 2020  [1]  !='' :..   
-00010810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010820: 2073 656c 662e 7072 6f6a 6563 745f 6c61   self.project_la
-00010830: 6265 6c3d 2020 7a6f 6e73 7572 7661 5b31  bel=  zonsurva[1
-00010840: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
-00010850: 6966 2027 6a6f 622e 6461 7465 2769 6e20  if 'job.date'in 
-00010860: 7a6f 6e73 7572 7661 5b30 5d2e 6c6f 7765  zonsurva[0].lowe
-00010870: 7228 2920 3a0d 0a20 2020 2020 2020 2020  r() :..         
-00010880: 2020 2020 2020 2069 6620 7a6f 6e73 7572         if zonsur
-00010890: 7661 5b31 5d20 2021 3d27 2720 3a20 0d0a  va[1]  !='' : ..
-000108a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108b0: 2020 2020 7365 6c66 2e61 6371 6461 7465      self.acqdate
-000108c0: 203d 2020 7a6f 6e73 7572 7661 5b31 5d20   =  zonsurva[1] 
-000108d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000108e0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-000108f0: 656c 662e 7363 6f6e 6669 675f 6469 6374  elf.sconfig_dict
-00010900: 3d7b 274a 6f62 2e4e 616d 6527 3a73 656c  ={'Job.Name':sel
-00010910: 662e 7072 6f6a 6563 745f 6e61 6d65 202c  f.project_name ,
-00010920: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00010930: 2020 2020 2027 4a6f 622e 4172 6561 273a       'Job.Area':
-00010940: 7365 6c66 2e70 726f 6a65 6374 5f61 7265  self.project_are
-00010950: 6120 2c20 0d0a 2020 2020 2020 2020 2020  a , ..          
-00010960: 2020 2020 2020 2020 274a 6f62 2e46 6f72          'Job.For
-00010970: 273a 7365 6c66 2e63 7573 7475 6d65 725f  ':self.custumer_
-00010980: 6e61 6d65 2c20 0d0a 2020 2020 2020 2020  name, ..        
-00010990: 2020 2020 2020 2020 2020 274a 6f62 2e42            'Job.B
-000109a0: 7927 3a73 656c 662e 636f 6e74 7261 6374  y':self.contract
-000109b0: 6f72 5f6e 616d 652c 200d 0a20 2020 2020  or_name, ..     
-000109c0: 2020 2020 2020 2020 2020 2020 2027 4a6f               'Jo
-000109d0: 622e 4e75 6d62 6572 273a 7365 6c66 2e70  b.Number':self.p
-000109e0: 726f 6a65 6374 5f6c 6162 656c 202c 200d  roject_label , .
-000109f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010a00: 2020 2027 4a6f 622e 4461 7465 273a 2073     'Job.Date': s
-00010a10: 656c 662e 6163 7164 6174 652c 200d 0a20  elf.acqdate, .. 
-00010a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a30: 207d 0d0a 2020 2020 2020 2020 0d0a 0d0a   }..        ....
-00010a40: 0d0a 636c 6173 7320 5375 7276 6579 436f  ..class SurveyCo
-00010a50: 6e66 6967 7572 6174 696f 6e28 6f62 6a65  nfiguration(obje
-00010a60: 6374 2920 3a20 0d0a 2020 2020 2222 220d  ct) : ..    """.
-00010a70: 0a20 2020 2043 6c61 7373 2066 6f72 2073  .    Class for s
-00010a80: 7572 7665 7920 5375 7276 6579 2063 6f6e  urvey Survey con
-00010a90: 6669 6775 7261 7469 6f6e 2e0d 0a20 2020  figuration...   
-00010aa0: 2020 2020 2020 0d0a 2020 2020 4172 6775        ..    Argu
-00010ab0: 6d65 6e74 7320 200d 0a20 2020 202d 2d2d  ments  ..    ---
-00010ac0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00010ad0: 2a2a 7375 7276 6579 5f63 6f6e 6669 675f  **survey_config_
-00010ae0: 6461 7461 2a2a 203a 206c 6973 7420 0d0a  data** : list ..
-00010af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b10: 636f 6e66 6967 7572 6174 696f 6e20 6c69  configuration li
-00010b20: 7374 0d0a 2020 2020 2020 2020 0d0a 2020  st..        ..  
-00010b30: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-00010b40: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d20  ===  ========== 
-00010b50: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-00010b60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00010b70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
-00010b80: 2020 2041 7474 7269 6275 7465 7320 2020     Attributes   
-00010b90: 2020 2020 2020 5479 7065 2020 2020 2020        Type      
-00010ba0: 2020 4578 706c 616e 6174 696f 6e0d 0a20    Explanation.. 
-00010bb0: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
-00010bc0: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-00010bd0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-00010be0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00010bf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-00010c00: 2020 2020 7375 7276 6579 5479 7065 2020      surveyType  
-00010c10: 2020 2020 2020 2020 7374 7220 2020 2020          str     
-00010c20: 2020 2020 7375 7276 6579 2074 7970 6520      survey type 
-00010c30: 2843 5341 4d54 2c20 5445 4d2c 2043 522c  (CSAMT, TEM, CR,
-00010c40: 2054 4449 5029 2020 2020 2020 2020 0d0a   TDIP)        ..
-00010c50: 2020 2020 7375 7276 6579 4172 7261 7920      surveyArray 
-00010c60: 2020 2020 2020 2020 7374 7220 2020 2020          str     
-00010c70: 2020 2020 6172 7261 7920 7479 7065 2866      array type(f
-00010c80: 6f72 2043 5341 4d54 3a53 6361 6c61 722c  or CSAMT:Scalar,
-00010c90: 2056 6563 746f 722c 2054 656e 736f 7229   Vector, Tensor)
-00010ca0: 0d0a 2020 2020 6c69 6e65 4e61 6d65 2020  ..    lineName  
-00010cb0: 2020 2020 2020 2020 2020 7374 7220 2020            str   
-00010cc0: 2020 2020 2020 6c69 6e65 206c 6162 656c        line label
-00010cd0: 200d 0a20 2020 206c 696e 654e 756d 6265   ..    lineNumbe
-00010ce0: 7220 2020 2020 2020 2020 2066 6c6f 6174  r          float
-00010cf0: 2020 2020 2020 206c 696e 6520 6e75 6d62         line numb
-00010d00: 6572 200d 0a20 2020 2061 7a69 6d75 7468  er ..    azimuth
-00010d10: 2020 2020 2020 2020 2020 2020 2073 7472               str
-00010d20: 2020 2020 2020 2020 206c 696e 6520 617a           line az
-00010d30: 696d 7574 6820 2820 6465 6720 4520 6f66  imuth ( deg E of
-00010d40: 204e 2920 0d0a 2020 2020 7374 6e47 6470   N) ..    stnGdp
-00010d50: 4265 6720 2020 2020 2020 2020 2020 666c  Beg           fl
-00010d60: 6f61 7420 2020 2020 2020 6669 7273 7420  oat       first 
-00010d70: 4744 5020 7374 6174 696f 6e20 6e75 6d62  GDP station numb
-00010d80: 6572 200d 0a20 2020 2053 746e 4764 7049  er ..    StnGdpI
-00010d90: 6e63 2020 2020 2020 2020 2020 2066 6c6f  nc           flo
-00010da0: 6174 2020 2020 2020 2047 4450 2073 7461  at       GDP sta
-00010db0: 7469 6f6e 206e 756d 6265 7220 696e 6372  tion number incr
-00010dc0: 656d 656e 740d 0a20 2020 2073 746e 4265  ement..    stnBe
-00010dd0: 6720 2020 2020 2020 2020 2020 2020 2066  g              f
-00010de0: 6c6f 6174 2020 2020 2020 2070 6f73 7369  loat       possi
-00010df0: 626c 7920 7265 7363 616c 6564 2066 6972  bly rescaled fir
-00010e00: 7374 2073 7461 7469 6f6e 206e 756d 6265  st station numbe
-00010e10: 720d 0a20 2020 2073 746e 496e 6320 2020  r..    stnInc   
-00010e20: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
-00010e30: 2020 2020 2020 2070 6f73 7369 626c 7920         possibly 
-00010e40: 7265 7363 616c 6564 2073 7461 7469 6f6e  rescaled station
-00010e50: 206e 756d 6265 7220 696e 6372 656d 656e   number incremen
-00010e60: 740d 0a20 2020 2073 746e 4c65 6674 2020  t..    stnLeft  
-00010e70: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
-00010e80: 2020 2020 2020 2072 6573 6361 6c65 6420         rescaled 
-00010e90: 7374 6174 696f 6e20 6e75 6d62 6572 206f  station number o
-00010ea0: 6e20 206c 6566 7420 6564 6765 206f 660d  n  left edge of.
-00010eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ed0: 2020 2020 2070 7365 7564 6f73 6563 7469       pseudosecti
-00010ee0: 6f6e 2070 6c6f 7420 0d0a 2020 2020 7374  on plot ..    st
-00010ef0: 6e52 6967 6874 2020 2020 2020 2020 2020  nRight          
-00010f00: 2020 666c 6f61 7420 2020 2020 2020 7265    float       re
-00010f10: 7363 616c 6564 2073 7461 7469 6f6e 206e  scaled station n
-00010f20: 756d 6265 7220 6f6e 2072 6967 6874 2020  umber on right  
-00010f30: 6564 6765 206f 6620 200d 0a20 2020 2020  edge of  ..     
-00010f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f50: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00010f60: 7365 7564 6f73 6563 7469 6f6e 2070 6c6f  seudosection plo
-00010f70: 7420 0d0a 2020 2020 756e 6974 4c65 6e67  t ..    unitLeng
-00010f80: 7468 2020 2020 2020 2020 2020 666c 6f61  th          floa
-00010f90: 7420 2020 2020 2020 6c65 6e67 7468 2075  t       length u
-00010fa0: 6e69 7473 2028 6d2c 6674 290d 0a20 2020  nits (m,ft)..   
-00010fb0: 2075 6e69 7445 6d61 6720 2020 2020 2020   unitEmag       
-00010fc0: 2020 2020 2073 7472 2020 2020 2020 2020       str        
-00010fd0: 2066 6965 6c64 2075 6e69 7473 2028 6e56   field units (nV
-00010fe0: 2f6d 2c6e 562f 416d 290d 0a20 2020 2075  /m,nV/Am)..    u
-00010ff0: 6e69 7448 6669 656c 6420 2020 2020 2020  nitHfield       
-00011000: 2020 2073 7472 2020 2020 2020 2020 2066     str         f
-00011010: 6965 6c64 2075 6e69 7473 2028 7054 2c70  ield units (pT,p
-00011020: 542f 410d 0a20 2020 2075 6e69 7450 6861  T/A..    unitPha
-00011030: 7365 2020 2020 2020 2020 2020 2073 7472  se           str
-00011040: 2020 2020 2020 2020 2075 6e69 7473 2028           units (
-00011050: 6d72 6164 2c64 6567 290d 0a20 2020 2073  mrad,deg)..    s
-00011060: 636f 6e66 6967 5f64 6963 7420 2020 2020  config_dict     
-00011070: 2020 2064 6963 7420 2020 2020 2020 2073     dict        s
-00011080: 7572 7665 7963 6f6e 6669 6775 7261 7469  urveyconfigurati
-00011090: 6f6e 2064 6963 7420 656c 6d74 730d 0a20  on dict elmts.. 
-000110a0: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
-000110b0: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-000110c0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-000110d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000110e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-000110f0: 2020 2020 2020 2020 0d0a 2020 2020 4d6f          ..    Mo
-00011100: 7265 2061 7474 7269 6275 7465 7320 6361  re attributes ca
-00011110: 6e20 6265 2061 6464 6564 2062 7920 696e  n be added by in
-00011120: 7075 7469 6e67 2061 206b 6579 2077 6f72  puting a key wor
-00011130: 6420 6469 6374 696f 6e61 7279 0d0a 2020  d dictionary..  
-00011140: 2020 0d0a 2020 2020 3a45 7861 6d70 6c65    ..    :Example
-00011150: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
-00011160: 2020 2020 203e 3e3e 2066 726f 6d20 7079       >>> from py
-00011170: 6373 616d 742e 6666 2e63 6f72 6520 696d  csamt.ff.core im
-00011180: 706f 7274 2041 7667 0d0a 2020 2020 2020  port Avg..      
-00011190: 2020 3e3e 3e20 6176 675f 6f62 6a3d 2041    >>> avg_obj= A
-000111a0: 7667 2864 6174 615f 666e 3d70 6174 6829  vg(data_fn=path)
-000111b0: 200d 0a20 2020 2020 2020 203e 3e3e 2073   ..        >>> s
-000111c0: 7572 765f 6e61 6d65 4c69 6e65 3d20 6176  urv_nameLine= av
-000111d0: 675f 6f62 6a2e 4865 6164 6572 2e53 7572  g_obj.Header.Sur
-000111e0: 7665 7943 6f6e 6669 6775 7261 7469 6f6e  veyConfiguration
-000111f0: 2e6c 696e 654e 616d 6520 0d0a 2020 2020  .lineName ..    
-00011200: 2020 2020 2e2e 2e20 7375 7276 5f6e 616d      ... surv_nam
-00011210: 654c 696e 650d 0a20 2020 2020 2020 202e  eLine..        .
-00011220: 2e2e 2061 7667 5f6f 626a 2e48 6561 6465  .. avg_obj.Heade
-00011230: 722e 5375 7276 6579 436f 6e66 6967 7572  r.SurveyConfigur
-00011240: 6174 696f 6e2e 7363 6f6e 6669 675f 6469  ation.sconfig_di
-00011250: 6374 5b27 5374 6e2e 5269 6768 7427 5d0d  ct['Stn.Right'].
-00011260: 0a20 2020 2020 2020 200d 0a20 2020 2022  .        ..    "
-00011270: 2222 0d0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-00011280: 6974 5f5f 2873 656c 662c 2073 7572 7665  it__(self, surve
-00011290: 795f 636f 6e66 6967 5f64 6174 6120 3d4e  y_config_data =N
-000112a0: 6f6e 6520 2c20 2a2a 6b77 6172 6773 293a  one , **kwargs):
-000112b0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000112c0: 2020 2020 7365 6c66 2e7a 6f6e 5f73 7572      self.zon_sur
-000112d0: 765f 636f 6e66 6967 203d 2073 7572 7665  v_config = surve
-000112e0: 795f 636f 6e66 6967 5f64 6174 6120 0d0a  y_config_data ..
-000112f0: 2020 2020 2020 2020 7365 6c66 2e73 7572          self.sur
-00011300: 7665 7954 7970 6520 3d27 4353 414d 542c  veyType ='CSAMT,
-00011310: 2054 454d 2c20 4352 2c20 5444 4950 2720   TEM, CR, TDIP' 
-00011320: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00011330: 7572 7665 7941 7272 6179 203d 2743 5341  urveyArray ='CSA
-00011340: 4d54 3a20 5363 616c 6172 2c20 5665 6374  MT: Scalar, Vect
-00011350: 6f72 2c20 5465 6e73 6f72 2720 0d0a 2020  or, Tensor' ..  
-00011360: 2020 2020 2020 7365 6c66 2e6c 696e 654e        self.lineN
-00011370: 616d 653d 2770 7943 5341 4d54 6c69 6e65  ame='pyCSAMTline
-00011380: 2720 0d0a 2020 2020 2020 2020 7365 6c66  ' ..        self
-00011390: 2e6c 696e 654e 756d 6265 723d 2766 6c6f  .lineNumber='flo
-000113a0: 6174 3a30 3027 200d 0a20 2020 2020 2020  at:00' ..       
-000113b0: 2073 656c 662e 617a 696d 7574 6820 3d27   self.azimuth ='
-000113c0: 2030 2064 6567 2045 206f 6620 4e27 0d0a   0 deg E of N'..
-000113d0: 2020 2020 2020 2020 7365 6c66 2e73 746e          self.stn
-000113e0: 4764 7042 6567 3d4e 6f6e 6520 0d0a 2020  GdpBeg=None ..  
-000113f0: 2020 2020 2020 7365 6c66 2e73 746e 4764        self.stnGd
-00011400: 7049 6e63 203d 4e6f 6e65 200d 0a20 2020  pInc =None ..   
-00011410: 2020 2020 2073 656c 662e 7374 6e42 6567       self.stnBeg
-00011420: 203d 4e6f 6e65 200d 0a20 2020 2020 2020   =None ..       
-00011430: 2073 656c 662e 7374 6e49 6e63 3d4e 6f6e   self.stnInc=Non
-00011440: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
-00011450: 2e73 746e 4c65 6674 3d4e 6f6e 6520 0d0a  .stnLeft=None ..
-00011460: 2020 2020 2020 2020 7365 6c66 2e73 746e          self.stn
-00011470: 5269 6768 7420 3d4e 6f6e 6520 0d0a 2020  Right =None ..  
-00011480: 2020 2020 2020 7365 6c66 2e75 6e69 744c        self.unitL
-00011490: 656e 6774 6820 3d27 6d2c 6674 2720 0d0a  ength ='m,ft' ..
-000114a0: 2020 2020 2020 2020 7365 6c66 2e75 6e69          self.uni
-000114b0: 7445 6d61 6720 3d27 6e56 2f6d 4120 6f72  tEmag ='nV/mA or
-000114c0: 206d 6963 6f56 2f6b 6d41 2720 0d0a 2020   micoV/kmA' ..  
-000114d0: 2020 2020 2020 7365 6c66 2e75 6e69 7448        self.unitH
-000114e0: 6669 656c 6420 3d27 7054 2c20 7069 636f  field ='pT, pico
-000114f0: 542f 4127 200d 0a20 2020 2020 2020 2073  T/A' ..        s
-00011500: 656c 662e 756e 6974 5068 6173 6520 3d27  elf.unitPhase ='
-00011510: 6d72 6164 2c64 6567 270d 0a20 2020 2020  mrad,deg'..     
-00011520: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00011530: 2020 2020 2020 2073 656c 662e 7363 6f6e         self.scon
-00011540: 6669 675f 6469 6374 3d20 7b27 5375 7276  fig_dict= {'Surv
-00011550: 6579 2e54 7970 6527 3a73 656c 662e 7375  ey.Type':self.su
-00011560: 7276 6579 5479 7065 2c0d 0a20 2020 2020  rveyType,..     
-00011570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011580: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00011590: 5375 7276 6579 2e41 7272 6179 273a 7365  Survey.Array':se
-000115a0: 6c66 2e73 7572 7665 7941 7272 6179 202c  lf.surveyArray ,
-000115b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efd0: 2020 277b 303a 7d27 2e66 6f72 6d61 7428    '{0:}'.format(
+0000efe0: 7374 7228 7661 6c75 6573 2929 5d29 290d  str(values))])).
+0000eff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f000: 2020 2020 2072 6d6c 696e 6573 2e61 7070       rmlines.app
+0000f010: 656e 6428 7265 7463 290d 0a20 2020 2020  end(retc)..     
+0000f020: 2020 2020 2020 2065 6c69 6620 7373 203d         elif ss =
+0000f030: 3d33 203a 0d0a 2020 2020 2020 2020 2020  =3 :..          
+0000f040: 2020 2020 2020 666f 7220 6b65 7973 202c        for keys ,
+0000f050: 2076 616c 7565 7320 696e 2061 7667 5f6f   values in avg_o
+0000f060: 626a 2e48 6561 6465 722e 5478 2e73 636f  bj.Header.Tx.sco
+0000f070: 6e66 6967 5f64 6963 742e 6974 656d 7328  nfig_dict.items(
+0000f080: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000f090: 2020 2020 2020 2020 726d 6c69 6e65 732e          rmlines.
+0000f0a0: 6170 7065 6e64 2873 7061 635f 6229 0d0a  append(spac_b)..
+0000f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0c0: 2020 2020 726d 6c69 6e65 732e 6170 7065      rmlines.appe
+0000f0d0: 6e64 2827 272e 6a6f 696e 285b 277b 307d  nd(''.join(['{0}
+0000f0e0: 3a27 2e66 6f72 6d61 7428 7374 7228 6b65  :'.format(str(ke
+0000f0f0: 7973 2929 2c0d 0a20 2020 2020 2020 2020  ys)),..         
+0000f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f120: 2020 2027 7b30 3a7d 272e 666f 726d 6174     '{0:}'.format
+0000f130: 2873 7472 2876 616c 7565 7329 295d 2929  (str(values))]))
+0000f140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f150: 2020 2020 2020 726d 6c69 6e65 732e 6170        rmlines.ap
+0000f160: 7065 6e64 2872 6574 6329 0d0a 2020 2020  pend(retc)..    
+0000f170: 2020 2020 2020 2020 656c 6966 2073 7320          elif ss 
+0000f180: 3d3d 2034 203a 200d 0a20 2020 2020 2020  == 4 : ..       
+0000f190: 2020 2020 2020 2020 2066 6f72 206b 6579           for key
+0000f1a0: 7320 2c20 7661 6c75 6573 2069 6e20 6176  s , values in av
+0000f1b0: 675f 6f62 6a2e 4865 6164 6572 2e52 782e  g_obj.Header.Rx.
+0000f1c0: 7363 6f6e 6669 675f 6469 6374 2e69 7465  sconfig_dict.ite
+0000f1d0: 6d73 2829 3a0d 0a20 2020 2020 2020 2020  ms():..         
+0000f1e0: 2020 2020 2020 2020 2020 2072 6d6c 696e             rmlin
+0000f1f0: 6573 2e61 7070 656e 6428 7370 6163 5f62  es.append(spac_b
+0000f200: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000f210: 2020 2020 2020 2072 6d6c 696e 6573 2e61         rmlines.a
+0000f220: 7070 656e 6428 2727 2e6a 6f69 6e28 5b27  ppend(''.join(['
+0000f230: 7b30 7d3a 272e 666f 726d 6174 2873 7472  {0}:'.format(str
+0000f240: 286b 6579 7329 292c 0d0a 2020 2020 2020  (keys)),..      
+0000f250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f270: 2020 2020 2020 277b 303a 7d27 2e66 6f72        '{0:}'.for
+0000f280: 6d61 7428 7374 7228 7661 6c75 6573 2929  mat(str(values))
+0000f290: 5d29 290d 0a20 2020 2020 2020 2020 2020  ]))..           
+0000f2a0: 2020 2020 2020 2020 2072 6d6c 696e 6573           rmlines
+0000f2b0: 2e61 7070 656e 6428 7265 7463 290d 0a20  .append(retc).. 
+0000f2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f2d0: 2020 200d 0a20 2020 2020 2020 2077 6974     ..        wit
+0000f2e0: 6820 6f70 656e 2028 2727 2e6a 6f69 6e28  h open (''.join(
+0000f2f0: 5b6f 732e 7061 7468 2e62 6173 656e 616d  [os.path.basenam
+0000f300: 6528 7365 6c66 2e64 6174 615f 666e 292c  e(self.data_fn),
+0000f310: 275f 7079 4353 272c 222e 6c6f 6722 5d29  '_pyCS',".log"])
+0000f320: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000f330: 2020 2020 2020 2777 272c 2065 6e63 6f64        'w', encod
+0000f340: 696e 673d 2775 7466 3827 2920 6173 2066  ing='utf8') as f
+0000f350: 643a 0d0a 2020 2020 2020 2020 2020 2020  d:..            
+0000f360: 6664 2e77 7269 7465 6c69 6e65 7328 726d  fd.writelines(rm
+0000f370: 6c69 6e65 7329 0d0a 2020 2020 2020 2020  lines)..        
+0000f380: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+0000f390: 2073 6176 6570 6174 6820 6973 206e 6f74   savepath is not
+0000f3a0: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
+0000f3b0: 2020 2020 2073 6875 7469 6c2e 6d6f 7665       shutil.move
+0000f3c0: 2028 2727 2e6a 6f69 6e28 5b0d 0a20 2020   (''.join([..   
+0000f3d0: 2020 2020 2020 2020 2020 2020 206f 732e               os.
+0000f3e0: 7061 7468 2e62 6173 656e 616d 6528 7365  path.basename(se
+0000f3f0: 6c66 2e64 6174 615f 666e 292c 275f 7079  lf.data_fn),'_py
+0000f400: 4353 272c 222e 6c6f 6722 5d29 2c73 6176  CS',".log"]),sav
+0000f410: 6570 6174 6829 0d0a 2020 2020 2020 2020  epath)..        
+0000f420: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0000f430: 272d 2d2d 3e20 596f 7572 2048 6c6f 6720  '---> Your Hlog 
+0000f440: 6669 6c65 203c 7b30 7d3e 2068 6173 2062  file <{0}> has b
+0000f450: 6565 6e20 7772 6974 7465 6e20 7375 6363  een written succ
+0000f460: 6573 7366 756c 6c79 2021 3c2d 2d2d 272e  essfully !<---'.
+0000f470: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
+0000f480: 2066 6f72 6d61 7428 2727 2e6a 6f69 6e28   format(''.join(
+0000f490: 5b6f 732e 7061 7468 2e62 6173 656e 616d  [os.path.basenam
+0000f4a0: 6528 7365 6c66 2e64 6174 615f 666e 292c  e(self.data_fn),
+0000f4b0: 275f 7079 4353 272c 222e 6c6f 6722 5d29  '_pyCS',".log"])
+0000f4c0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0000f4d0: 0d0a 0d0a 636c 6173 7320 5375 7276 6579  ....class Survey
+0000f4e0: 416e 6e6f 7461 7469 6f6e 2028 6f62 6a65  Annotation (obje
+0000f4f0: 6374 2920 3a20 0d0a 2020 2020 2222 220d  ct) : ..    """.
+0000f500: 0a20 2020 2043 6c61 7373 2066 6f72 2073  .    Class for s
+0000f510: 7572 7665 7920 616e 6e6f 7461 7469 6f6e  urvey annotation
+0000f520: 732e 0d0a 2020 2020 2020 2020 200d 0a20  s...         .. 
+0000f530: 2020 2041 7267 756d 656e 7473 2020 0d0a     Arguments  ..
+0000f540: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d      -----------.
+0000f550: 0a20 2020 2020 2020 202a 2a73 7572 7665  .        **surve
+0000f560: 795f 616e 6e6f 7461 7469 6f6e 735f 6461  y_annotations_da
+0000f570: 7461 2a2a 3a20 6c69 7374 202c 2073 7472  ta**: list , str
+0000f580: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f5a0: 2020 2020 2020 2020 7061 7468 2074 6f20          path to 
+0000f5b0: 796f 7572 2061 6e6e 6f74 6174 696f 6e20  your annotation 
+0000f5c0: 6669 6c65 206f 7220 200d 0a20 2020 2020  file or  ..     
+0000f5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f5e0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+0000f5f0: 696c 6c65 6420 6175 746f 6d61 7469 6361  illed automatica
+0000f600: 6c6c 790d 0a20 2020 2020 2020 200d 0a20  lly..        .. 
+0000f610: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
+0000f620: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+0000f630: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
+0000f640: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f650: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+0000f660: 2041 7474 7269 6275 7465 7320 2020 2020   Attributes     
+0000f670: 2020 2020 2020 2020 2054 7970 6520 2020           Type   
+0000f680: 2020 2020 2045 7870 6c61 6e61 7469 6f6e       Explanation
+0000f690: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
+0000f6a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
+0000f6b0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
+0000f6c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f6d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+0000f6e0: 2020 2020 7072 6f6a 6563 745f 6e61 6d65      project_name
+0000f6f0: 2020 2020 2020 2020 2020 2020 7374 7220              str 
+0000f700: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+0000f710: 6e61 6d65 200d 0a20 2020 2070 726f 6a65  name ..    proje
+0000f720: 6374 5f61 7265 6120 2020 2020 2020 2020  ct_area         
+0000f730: 2020 2073 7472 2020 2020 2020 2020 2070     str         p
+0000f740: 726f 6a65 6374 2061 7265 6120 0d0a 2020  roject area ..  
+0000f750: 2020 6375 7374 756d 6572 5f6e 616d 6520    custumer_name 
+0000f760: 2020 2020 2020 2020 2020 7374 7220 2020            str   
+0000f770: 2020 2020 2020 636f 6d70 616e 7920 6e61        company na
+0000f780: 6d65 200d 0a20 2020 2063 6f6e 7472 6163  me ..    contrac
+0000f790: 746f 725f 6e61 6d65 2020 2020 2020 2020  tor_name        
+0000f7a0: 2073 7472 2020 2020 2020 2020 2063 6f6e   str         con
+0000f7b0: 7472 6163 746f 7220 6e61 6d65 200d 0a20  tractor name .. 
+0000f7c0: 2020 2070 726f 6a65 745f 6c61 6265 6c20     projet_label 
+0000f7d0: 2020 2020 2020 2020 2020 2073 7472 2020             str  
+0000f7e0: 2020 2020 2020 206c 6162 656c 206f 7220         label or 
+0000f7f0: 6e75 6d62 6572 200d 0a20 2020 2061 6371  number ..    acq
+0000f800: 6461 7465 2020 2020 2020 2020 2020 2020  date            
+0000f810: 2020 2020 2073 7472 2020 2020 2020 2020       str        
+0000f820: 2064 6174 6120 6163 7175 6973 6974 696f   data acquisitio
+0000f830: 6e20 6461 7465 200d 0a20 2020 2073 636f  n date ..    sco
+0000f840: 6e66 6967 5f64 6963 7420 2020 2020 2020  nfig_dict       
+0000f850: 2020 2020 2064 6963 7420 2020 2020 2020       dict       
+0000f860: 2073 7572 7665 7920 616e 6e6f 7461 7469   survey annotati
+0000f870: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
+0000f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f890: 2020 2020 2020 2020 2020 2020 6469 6374              dict
+0000f8a0: 696f 6e6e 6172 7920 2020 2020 2020 0d0a  ionnary       ..
+0000f8b0: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
+0000f8c0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
+0000f8d0: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+0000f8e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000f8f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+0000f900: 2020 0d0a 2020 2020 4d6f 7265 2061 7474    ..    More att
+0000f910: 7269 6275 7465 7320 6361 6e20 6265 2061  ributes can be a
+0000f920: 6464 6564 2062 7920 696e 7075 7469 6e67  dded by inputing
+0000f930: 2061 206b 6579 2077 6f72 6420 6469 6374   a key word dict
+0000f940: 696f 6e61 7279 0d0a 2020 2020 0d0a 2020  ionary..    ..  
+0000f950: 2020 3a45 7861 6d70 6c65 3a0d 0a20 2020    :Example:..   
+0000f960: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000f970: 3e3e 3e20 6672 6f6d 2070 7963 7361 6d74  >>> from pycsamt
+0000f980: 2e63 6f72 652e 6176 6720 696d 706f 7274  .core.avg import
+0000f990: 2041 7667 200d 0a20 2020 2020 2020 203e   Avg ..        >
+0000f9a0: 3e3e 2061 7667 5f6f 626a 3d20 4176 6728  >> avg_obj= Avg(
+0000f9b0: 6461 7461 5f66 6e3d 7061 7468 2920 0d0a  data_fn=path) ..
+0000f9c0: 2020 2020 2020 2020 3e3e 3e20 7375 7276          >>> surv
+0000f9d0: 5f61 7265 613d 2061 7667 5f6f 626a 2e48  _area= avg_obj.H
+0000f9e0: 6561 6465 722e 5375 7276 6579 416e 6e6f  eader.SurveyAnno
+0000f9f0: 7461 7469 6f6e 2e70 726f 6a65 6374 5f61  tation.project_a
+0000fa00: 7265 6120 0d0a 2020 2020 2020 2020 2e2e  rea ..        ..
+0000fa10: 2e20 7375 7276 6579 5f61 7265 610d 0a20  . survey_area.. 
+0000fa20: 2020 2020 2020 202e 2e2e 2061 7667 5f6f         ... avg_o
+0000fa30: 626a 2e48 6561 6465 722e 5375 7276 6579  bj.Header.Survey
+0000fa40: 416e 6e6f 7461 7469 6f6e 2e73 636f 6e66  Annotation.sconf
+0000fa50: 6967 5f64 6963 745b 274a 6f62 2e42 7927  ig_dict['Job.By'
+0000fa60: 5d0d 0a20 2020 2022 2222 0d0a 2020 2020  ]..    """..    
+0000fa70: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+0000fa80: 662c 2073 7572 7665 795f 616e 6e6f 7461  f, survey_annota
+0000fa90: 7469 6f6e 735f 6461 7461 203d 4e6f 6e65  tions_data =None
+0000faa0: 2020 2c20 202a 2a6b 7761 7267 7329 3a0d    ,  **kwargs):.
+0000fab0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+0000fac0: 7a6f 6e5f 7365 7276 5f61 6e6e 6f74 6174  zon_serv_annotat
+0000fad0: 696f 6e73 203d 2073 7572 7665 795f 616e  ions = survey_an
+0000fae0: 6e6f 7461 7469 6f6e 735f 6461 7461 0d0a  notations_data..
+0000faf0: 2020 2020 2020 2020 7365 6c66 2e70 726f          self.pro
+0000fb00: 6a65 6374 5f6e 616d 6520 3d27 4353 414d  ject_name ='CSAM
+0000fb10: 545f 7375 7276 6579 270d 0a20 2020 2020  T_survey'..     
+0000fb20: 2020 2073 656c 662e 7072 6f6a 6563 745f     self.project_
+0000fb30: 6172 6561 203d 4e6f 6e65 0d0a 2020 2020  area =None..    
+0000fb40: 2020 2020 7365 6c66 2e63 7573 7475 6d65      self.custume
+0000fb50: 725f 6e61 6d65 203d 275a 6f6e 6765 2045  r_name ='Zonge E
+0000fb60: 6e67 696e 6565 7269 6e67 2227 200d 0a20  ngineering"' .. 
+0000fb70: 2020 2020 2020 2073 656c 662e 636f 6e74         self.cont
+0000fb80: 7261 6374 6f72 5f6e 616d 6520 3d27 5a6f  ractor_name ='Zo
+0000fb90: 6e67 6527 0d0a 2020 2020 2020 2020 7365  nge'..        se
+0000fba0: 6c66 2e70 726f 6a65 6374 5f6c 6162 656c  lf.project_label
+0000fbb0: 203d 2027 7079 4353 414d 5427 200d 0a20   = 'pyCSAMT' .. 
+0000fbc0: 2020 2020 2020 2073 656c 662e 6163 7164         self.acqd
+0000fbd0: 6174 6520 3d27 7b30 7d2d 7b31 7d27 2e66  ate ='{0}-{1}'.f
+0000fbe0: 6f72 6d61 7428 6461 7465 7469 6d65 2e6e  ormat(datetime.n
+0000fbf0: 6f77 2829 2c20 7469 6d65 7a6f 6e65 2e75  ow(), timezone.u
+0000fc00: 7463 290d 0a20 2020 2020 2020 2073 656c  tc)..        sel
+0000fc10: 662e 7363 6f6e 6669 675f 6469 6374 3d7b  f.sconfig_dict={
+0000fc20: 274a 6f62 2e4e 616d 6527 3a73 656c 662e  'Job.Name':self.
+0000fc30: 7072 6f6a 6563 745f 6e61 6d65 202c 200d  project_name , .
+0000fc40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fc50: 2020 2020 2020 2027 4a6f 622e 4172 6561         'Job.Area
+0000fc60: 273a 7365 6c66 2e70 726f 6a65 6374 5f61  ':self.project_a
+0000fc70: 7265 6120 2c20 0d0a 2020 2020 2020 2020  rea , ..        
+0000fc80: 2020 2020 2020 2020 2020 2020 2020 274a                'J
+0000fc90: 6f62 2e46 6f72 273a 7365 6c66 2e63 7573  ob.For':self.cus
+0000fca0: 7475 6d65 725f 6e61 6d65 2c20 0d0a 2020  tumer_name, ..  
+0000fcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fcc0: 2020 2020 274a 6f62 2e42 7927 3a73 656c      'Job.By':sel
+0000fcd0: 662e 636f 6e74 7261 6374 6f72 5f6e 616d  f.contractor_nam
+0000fce0: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
+0000fcf0: 2020 2020 2020 2020 2020 2027 4a6f 622e             'Job.
+0000fd00: 4e75 6d62 6572 273a 7365 6c66 2e70 726f  Number':self.pro
+0000fd10: 6a65 6374 5f6c 6162 656c 202c 200d 0a20  ject_label , .. 
+0000fd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd30: 2020 2020 2027 4a6f 622e 4461 7465 273a       'Job.Date':
+0000fd40: 2073 656c 662e 6163 7164 6174 652c 200d   self.acqdate, .
+0000fd50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fd60: 2020 2020 2020 207d 0d0a 2020 2020 2020         }..      
+0000fd70: 2020 0d0a 2020 2020 2020 2020 666f 7220    ..        for 
+0000fd80: 6b65 7973 2069 6e20 6c69 7374 286b 7761  keys in list(kwa
+0000fd90: 7267 732e 6b65 7973 2829 293a 0d0a 2020  rgs.keys()):..  
+0000fda0: 2020 2020 2020 2020 2020 6966 206b 6579            if key
+0000fdb0: 7320 6e6f 7420 696e 2053 7572 7665 7941  s not in SurveyA
+0000fdc0: 6e6e 6f74 6174 696f 6e2e 5f5f 6469 6374  nnotation.__dict
+0000fdd0: 5f5f 2e6b 6579 7328 293a 0d0a 2020 2020  __.keys():..    
+0000fde0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000fdf0: 2e5f 5f73 6574 6174 7472 5f5f 286b 6579  .__setattr__(key
+0000fe00: 732c 206b 7761 7267 735b 6b65 7973 5d29  s, kwargs[keys])
+0000fe10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000fe20: 2020 7365 6c66 2e73 636f 6e66 6967 5f64    self.sconfig_d
+0000fe30: 6963 742e 5f5f 7365 7469 7465 6d5f 5f28  ict.__setitem__(
+0000fe40: 6b65 7973 2c20 6b77 6172 6773 5b6b 6579  keys, kwargs[key
+0000fe50: 735d 290d 0a20 2020 2020 2020 2020 2020  s])..           
+0000fe60: 2020 2020 200d 0a20 2020 2064 6566 2073       ..    def s
+0000fe70: 6574 5f73 7572 7665 795f 616e 6e6f 7461  et_survey_annota
+0000fe80: 7469 6f6e 735f 696e 666f 7320 2873 656c  tions_infos (sel
+0000fe90: 662c 2073 7572 7665 795f 616e 6e6f 7461  f, survey_annota
+0000fea0: 7469 6f6e 735f 6461 7461 203d 4e6f 6e65  tions_data =None
+0000feb0: 293a 200d 0a20 2020 2020 2020 2022 2222  ): ..        """
+0000fec0: 0d0a 2020 2020 2020 2020 4d65 7468 6f64  ..        Method
+0000fed0: 2074 6f20 7365 7420 5f73 7572 7665 7920   to set _survey 
+0000fee0: 616e 6e6f 7461 7469 6f6e 7320 696e 666f  annotations info
+0000fef0: 726d 6174 696f 6e73 202e 0d0a 2020 2020  rmations ...    
+0000ff00: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+0000ff10: 7261 6d65 7465 7273 200d 0a20 2020 2020  rameters ..     
+0000ff20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0000ff30: 2020 2020 2020 2020 2020 202a 2073 7572             * sur
+0000ff40: 7665 795f 616e 6e6f 7461 7469 6f6e 203a  vey_annotation :
+0000ff50: 206c 6973 7420 0d0a 2020 2020 2020 2020   list ..        
+0000ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ff70: 2020 2020 2020 2020 636f 6e74 6169 6e65          containe
+0000ff80: 7220 6f66 2073 7572 7665 7920 616e 6e6f  r of survey anno
+0000ff90: 7461 7469 6f6e 7320 696e 666f 732e 200d  tations infos. .
+0000ffa0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0000ffb0: 2020 2020 2020 5f6c 6f67 6765 722e 696e        _logger.in
+0000ffc0: 666f 2827 5265 6164 696e 6720 616e 6420  fo('Reading and 
+0000ffd0: 7365 7474 696e 6720 7a6f 6e67 6520 7375  setting zonge su
+0000ffe0: 7276 6579 2041 6e6e 6f74 6174 696f 6e73  rvey Annotations
+0000fff0: 2069 6e66 6f73 2021 2729 0d0a 2020 2020   infos !')..    
+00010000: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+00010010: 2073 7572 7665 795f 616e 6e6f 7461 7469   survey_annotati
+00010020: 6f6e 735f 6461 7461 2069 7320 6e6f 7420  ons_data is not 
+00010030: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+00010040: 2020 2020 2073 656c 662e 7a6f 6e5f 7365       self.zon_se
+00010050: 7276 5f61 6e6e 6f74 6174 696f 6e73 203d  rv_annotations =
+00010060: 2073 7572 7665 795f 616e 6e6f 7461 7469   survey_annotati
+00010070: 6f6e 735f 6461 7461 0d0a 2020 2020 2020  ons_data..      
+00010080: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00010090: 6966 2073 656c 662e 7a6f 6e5f 7365 7276  if self.zon_serv
+000100a0: 5f61 6e6e 6f74 6174 696f 6e73 2069 7320  _annotations is 
+000100b0: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+000100c0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000100d0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+000100e0: 2020 2020 2020 2020 274e 6f20 7375 7276          'No surv
+000100f0: 6579 5f61 6e6e 6f74 6174 696f 6e73 2069  ey_annotations i
+00010100: 6e66 6f72 6d61 7469 6f6e 7320 666f 756e  nformations foun
+00010110: 6421 2729 0d0a 2020 2020 2020 2020 2020  d!')..          
+00010120: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00010130: 0d0a 2020 2020 2020 2020 6966 2074 7970  ..        if typ
+00010140: 6528 7365 6c66 2e7a 6f6e 5f73 6572 765f  e(self.zon_serv_
+00010150: 616e 6e6f 7461 7469 6f6e 7320 2920 6973  annotations ) is
+00010160: 206e 6f74 206c 6973 743a 200d 0a20 2020   not list: ..   
+00010170: 2020 2020 2020 2020 2074 7279 203a 0d0a           try :..
+00010180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010190: 6966 206f 732e 7061 7468 2e69 7366 696c  if os.path.isfil
+000101a0: 6528 7365 6c66 2e7a 6f6e 5f73 6572 765f  e(self.zon_serv_
+000101b0: 616e 6e6f 7461 7469 6f6e 7320 2920 6973  annotations ) is
+000101c0: 2054 7275 6520 3a0d 0a20 2020 2020 2020   True :..       
+000101d0: 2020 2020 2020 2020 2020 2020 2077 6974               wit
+000101e0: 6820 6f70 656e 2028 7365 6c66 2e7a 6f6e  h open (self.zon
+000101f0: 5f73 6572 765f 616e 6e6f 7461 7469 6f6e  _serv_annotation
+00010200: 7320 2c20 2772 272c 0d0a 2020 2020 2020  s , 'r',..      
+00010210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010220: 2020 2020 2020 2020 2065 6e63 6f64 696e           encodin
+00010230: 6720 3d27 7574 6638 2729 2061 7320 6669  g ='utf8') as fi
+00010240: 6420 3a0d 0a20 2020 2020 2020 2020 2020  d :..           
+00010250: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00010260: 662e 7a6f 6e5f 7365 7276 5f61 6e6e 6f74  f.zon_serv_annot
+00010270: 6174 696f 6e73 203d 6669 642e 7265 6164  ations =fid.read
+00010280: 6c69 6e65 7328 290d 0a20 2020 2020 2020  lines()..       
+00010290: 2020 2020 2065 7863 6570 7420 3a20 7261       except : ra
+000102a0: 6973 6520 4865 6164 6572 4572 726f 7228  ise HeaderError(
+000102b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000102c0: 2020 2020 2020 2250 6c65 6173 6520 6368        "Please ch
+000102d0: 6563 6b20 796f 7572 2061 6e6e 6f74 6174  eck your annotat
+000102e0: 696f 6e20 6461 7461 2021 2022 0d0a 2020  ion data ! "..  
+000102f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010300: 2020 2020 224d 7573 7420 6265 2062 6520      "Must be be 
+00010310: 6120 6c69 7374 206f 7220 6669 6c65 2022  a list or file "
+00010320: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+00010330: 0d0a 2020 2020 2020 2020 666f 7220 7a6f  ..        for zo
+00010340: 6e73 7572 7661 2069 6e20 7365 6c66 2e7a  nsurva in self.z
+00010350: 6f6e 5f73 6572 765f 616e 6e6f 7461 7469  on_serv_annotati
+00010360: 6f6e 7320 3a0d 0a0d 0a20 2020 2020 2020  ons :....       
+00010370: 2020 2020 207a 6f6e 7375 7276 6120 3d7a       zonsurva =z
+00010380: 6f6e 7375 7276 612e 7374 7269 7028 292e  onsurva.strip().
+00010390: 7370 6c69 7428 273d 2729 0d0a 2020 2020  split('=')..    
+000103a0: 2020 2020 2020 2020 6966 2027 6a6f 622e          if 'job.
+000103b0: 6e61 6d65 2720 696e 207a 6f6e 7375 7276  name' in zonsurv
+000103c0: 615b 305d 2e6c 6f77 6572 2829 3a20 0d0a  a[0].lower(): ..
+000103d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103e0: 6966 207a 6f6e 7375 7276 615b 315d 2020  if zonsurva[1]  
+000103f0: 213d 2727 3a20 0d0a 2020 2020 2020 2020  !='': ..        
+00010400: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00010410: 2e70 726f 6a65 6374 5f6e 616d 653d 7a6f  .project_name=zo
+00010420: 6e73 7572 7661 5b31 5d0d 0a20 2020 2020  nsurva[1]..     
+00010430: 2020 2020 2020 2069 6620 276a 6f62 2e61         if 'job.a
+00010440: 7265 6127 2069 6e20 7a6f 6e73 7572 7661  rea' in zonsurva
+00010450: 5b30 5d2e 6c6f 7765 7228 2920 3a0d 0a20  [0].lower() :.. 
+00010460: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00010470: 656c 662e 7072 6f6a 6563 745f 6172 6561  elf.project_area
+00010480: 203d 7a6f 6e73 7572 7661 5b31 5d0d 0a20   =zonsurva[1].. 
+00010490: 2020 2020 2020 2020 2020 2069 6620 276a             if 'j
+000104a0: 6f62 2e66 6f72 2720 696e 207a 6f6e 7375  ob.for' in zonsu
+000104b0: 7276 615b 305d 2e6c 6f77 6572 2829 203a  rva[0].lower() :
+000104c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000104d0: 2020 6966 207a 6f6e 7375 7276 615b 315d    if zonsurva[1]
+000104e0: 2020 213d 2727 203a 0d0a 2020 2020 2020    !='' :..      
+000104f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00010500: 6c66 2e63 7573 7475 6d65 725f 6e61 6d65  lf.custumer_name
+00010510: 203d 207a 6f6e 7375 7276 615b 315d 0d0a   = zonsurva[1]..
+00010520: 2020 2020 2020 2020 2020 2020 6966 2027              if '
+00010530: 6a6f 622e 6279 2769 6e20 7a6f 6e73 7572  job.by'in zonsur
+00010540: 7661 5b30 5d2e 6c6f 7765 7228 2920 3a0d  va[0].lower() :.
+00010550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010560: 2069 6620 7a6f 6e73 7572 7661 5b31 5d20   if zonsurva[1] 
+00010570: 2021 3d27 2720 3a0d 0a20 2020 2020 2020   !='' :..       
+00010580: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00010590: 662e 636f 6e74 7261 6374 6f72 5f6e 616d  f.contractor_nam
+000105a0: 6520 3d20 207a 6f6e 7375 7276 615b 315d  e =  zonsurva[1]
+000105b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000105c0: 2027 6a6f 622e 6e75 6d62 6572 2769 6e20   'job.number'in 
+000105d0: 7a6f 6e73 7572 7661 5b30 5d2e 6c6f 7765  zonsurva[0].lowe
+000105e0: 7228 2920 3a0d 0a20 2020 2020 2020 2020  r() :..         
+000105f0: 2020 2020 2020 2069 6620 7a6f 6e73 7572         if zonsur
+00010600: 7661 5b31 5d20 2021 3d27 2720 3a0d 0a20  va[1]  !='' :.. 
+00010610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010620: 2020 2073 656c 662e 7072 6f6a 6563 745f     self.project_
+00010630: 6c61 6265 6c3d 2020 7a6f 6e73 7572 7661  label=  zonsurva
+00010640: 5b31 5d20 0d0a 2020 2020 2020 2020 2020  [1] ..          
+00010650: 2020 6966 2027 6a6f 622e 6461 7465 2769    if 'job.date'i
+00010660: 6e20 7a6f 6e73 7572 7661 5b30 5d2e 6c6f  n zonsurva[0].lo
+00010670: 7765 7228 2920 3a0d 0a20 2020 2020 2020  wer() :..       
+00010680: 2020 2020 2020 2020 2069 6620 7a6f 6e73           if zons
+00010690: 7572 7661 5b31 5d20 2021 3d27 2720 3a20  urva[1]  !='' : 
+000106a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000106b0: 2020 2020 2020 7365 6c66 2e61 6371 6461        self.acqda
+000106c0: 7465 203d 2020 7a6f 6e73 7572 7661 5b31  te =  zonsurva[1
+000106d0: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
+000106e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000106f0: 2073 656c 662e 7363 6f6e 6669 675f 6469   self.sconfig_di
+00010700: 6374 3d7b 274a 6f62 2e4e 616d 6527 3a73  ct={'Job.Name':s
+00010710: 656c 662e 7072 6f6a 6563 745f 6e61 6d65  elf.project_name
+00010720: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
+00010730: 2020 2020 2020 2027 4a6f 622e 4172 6561         'Job.Area
+00010740: 273a 7365 6c66 2e70 726f 6a65 6374 5f61  ':self.project_a
+00010750: 7265 6120 2c20 0d0a 2020 2020 2020 2020  rea , ..        
+00010760: 2020 2020 2020 2020 2020 274a 6f62 2e46            'Job.F
+00010770: 6f72 273a 7365 6c66 2e63 7573 7475 6d65  or':self.custume
+00010780: 725f 6e61 6d65 2c20 0d0a 2020 2020 2020  r_name, ..      
+00010790: 2020 2020 2020 2020 2020 2020 274a 6f62              'Job
+000107a0: 2e42 7927 3a73 656c 662e 636f 6e74 7261  .By':self.contra
+000107b0: 6374 6f72 5f6e 616d 652c 200d 0a20 2020  ctor_name, ..   
+000107c0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000107d0: 4a6f 622e 4e75 6d62 6572 273a 7365 6c66  Job.Number':self
+000107e0: 2e70 726f 6a65 6374 5f6c 6162 656c 202c  .project_label ,
+000107f0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00010800: 2020 2020 2027 4a6f 622e 4461 7465 273a       'Job.Date':
+00010810: 2073 656c 662e 6163 7164 6174 652c 200d   self.acqdate, .
+00010820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010830: 2020 207d 0d0a 2020 2020 2020 2020 0d0a     }..        ..
+00010840: 0d0a 0d0a 636c 6173 7320 5375 7276 6579  ....class Survey
+00010850: 436f 6e66 6967 7572 6174 696f 6e28 6f62  Configuration(ob
+00010860: 6a65 6374 2920 3a20 0d0a 2020 2020 2222  ject) : ..    ""
+00010870: 220d 0a20 2020 2043 6c61 7373 2066 6f72  "..    Class for
+00010880: 2073 7572 7665 7920 5375 7276 6579 2063   survey Survey c
+00010890: 6f6e 6669 6775 7261 7469 6f6e 2e0d 0a20  onfiguration... 
+000108a0: 2020 2020 2020 2020 0d0a 2020 2020 4172          ..    Ar
+000108b0: 6775 6d65 6e74 7320 200d 0a20 2020 202d  guments  ..    -
+000108c0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+000108d0: 2020 2a2a 7375 7276 6579 5f63 6f6e 6669    **survey_confi
+000108e0: 675f 6461 7461 2a2a 203a 206c 6973 7420  g_data** : list 
+000108f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010910: 2020 636f 6e66 6967 7572 6174 696f 6e20    configuration 
+00010920: 6c69 7374 0d0a 2020 2020 2020 2020 0d0a  list..        ..
+00010930: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
+00010940: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00010950: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
+00010960: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00010970: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+00010980: 0a20 2020 2041 7474 7269 6275 7465 7320  .    Attributes 
+00010990: 2020 2020 2020 2020 5479 7065 2020 2020          Type    
+000109a0: 2020 2020 4578 706c 616e 6174 696f 6e0d      Explanation.
+000109b0: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+000109c0: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+000109d0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+000109e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000109f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00010a00: 0d0a 2020 2020 7375 7276 6579 5479 7065  ..    surveyType
+00010a10: 2020 2020 2020 2020 2020 7374 7220 2020            str   
+00010a20: 2020 2020 2020 7375 7276 6579 2074 7970        survey typ
+00010a30: 6520 2843 5341 4d54 2c20 5445 4d2c 2043  e (CSAMT, TEM, C
+00010a40: 522c 2054 4449 5029 2020 2020 2020 2020  R, TDIP)        
+00010a50: 0d0a 2020 2020 7375 7276 6579 4172 7261  ..    surveyArra
+00010a60: 7920 2020 2020 2020 2020 7374 7220 2020  y         str   
+00010a70: 2020 2020 2020 6172 7261 7920 7479 7065        array type
+00010a80: 2866 6f72 2043 5341 4d54 3a53 6361 6c61  (for CSAMT:Scala
+00010a90: 722c 2056 6563 746f 722c 2054 656e 736f  r, Vector, Tenso
+00010aa0: 7229 0d0a 2020 2020 6c69 6e65 4e61 6d65  r)..    lineName
+00010ab0: 2020 2020 2020 2020 2020 2020 7374 7220              str 
+00010ac0: 2020 2020 2020 2020 6c69 6e65 206c 6162          line lab
+00010ad0: 656c 200d 0a20 2020 206c 696e 654e 756d  el ..    lineNum
+00010ae0: 6265 7220 2020 2020 2020 2020 2066 6c6f  ber          flo
+00010af0: 6174 2020 2020 2020 206c 696e 6520 6e75  at       line nu
+00010b00: 6d62 6572 200d 0a20 2020 2061 7a69 6d75  mber ..    azimu
+00010b10: 7468 2020 2020 2020 2020 2020 2020 2073  th             s
+00010b20: 7472 2020 2020 2020 2020 206c 696e 6520  tr         line 
+00010b30: 617a 696d 7574 6820 2820 6465 6720 4520  azimuth ( deg E 
+00010b40: 6f66 204e 2920 0d0a 2020 2020 7374 6e47  of N) ..    stnG
+00010b50: 6470 4265 6720 2020 2020 2020 2020 2020  dpBeg           
+00010b60: 666c 6f61 7420 2020 2020 2020 6669 7273  float       firs
+00010b70: 7420 4744 5020 7374 6174 696f 6e20 6e75  t GDP station nu
+00010b80: 6d62 6572 200d 0a20 2020 2053 746e 4764  mber ..    StnGd
+00010b90: 7049 6e63 2020 2020 2020 2020 2020 2066  pInc           f
+00010ba0: 6c6f 6174 2020 2020 2020 2047 4450 2073  loat       GDP s
+00010bb0: 7461 7469 6f6e 206e 756d 6265 7220 696e  tation number in
+00010bc0: 6372 656d 656e 740d 0a20 2020 2073 746e  crement..    stn
+00010bd0: 4265 6720 2020 2020 2020 2020 2020 2020  Beg             
+00010be0: 2066 6c6f 6174 2020 2020 2020 2070 6f73   float       pos
+00010bf0: 7369 626c 7920 7265 7363 616c 6564 2066  sibly rescaled f
+00010c00: 6972 7374 2073 7461 7469 6f6e 206e 756d  irst station num
+00010c10: 6265 720d 0a20 2020 2073 746e 496e 6320  ber..    stnInc 
+00010c20: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
+00010c30: 6174 2020 2020 2020 2070 6f73 7369 626c  at       possibl
+00010c40: 7920 7265 7363 616c 6564 2073 7461 7469  y rescaled stati
+00010c50: 6f6e 206e 756d 6265 7220 696e 6372 656d  on number increm
+00010c60: 656e 740d 0a20 2020 2073 746e 4c65 6674  ent..    stnLeft
+00010c70: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
+00010c80: 6174 2020 2020 2020 2072 6573 6361 6c65  at       rescale
+00010c90: 6420 7374 6174 696f 6e20 6e75 6d62 6572  d station number
+00010ca0: 206f 6e20 206c 6566 7420 6564 6765 206f   on  left edge o
+00010cb0: 660d 0a20 2020 2020 2020 2020 2020 2020  f..             
+00010cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010cd0: 2020 2020 2020 2070 7365 7564 6f73 6563         pseudosec
+00010ce0: 7469 6f6e 2070 6c6f 7420 0d0a 2020 2020  tion plot ..    
+00010cf0: 7374 6e52 6967 6874 2020 2020 2020 2020  stnRight        
+00010d00: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
+00010d10: 7265 7363 616c 6564 2073 7461 7469 6f6e  rescaled station
+00010d20: 206e 756d 6265 7220 6f6e 2072 6967 6874   number on right
+00010d30: 2020 6564 6765 206f 6620 200d 0a20 2020    edge of  ..   
+00010d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d60: 2070 7365 7564 6f73 6563 7469 6f6e 2070   pseudosection p
+00010d70: 6c6f 7420 0d0a 2020 2020 756e 6974 4c65  lot ..    unitLe
+00010d80: 6e67 7468 2020 2020 2020 2020 2020 666c  ngth          fl
+00010d90: 6f61 7420 2020 2020 2020 6c65 6e67 7468  oat       length
+00010da0: 2075 6e69 7473 2028 6d2c 6674 290d 0a20   units (m,ft).. 
+00010db0: 2020 2075 6e69 7445 6d61 6720 2020 2020     unitEmag     
+00010dc0: 2020 2020 2020 2073 7472 2020 2020 2020         str      
+00010dd0: 2020 2066 6965 6c64 2075 6e69 7473 2028     field units (
+00010de0: 6e56 2f6d 2c6e 562f 416d 290d 0a20 2020  nV/m,nV/Am)..   
+00010df0: 2075 6e69 7448 6669 656c 6420 2020 2020   unitHfield     
+00010e00: 2020 2020 2073 7472 2020 2020 2020 2020       str        
+00010e10: 2066 6965 6c64 2075 6e69 7473 2028 7054   field units (pT
+00010e20: 2c70 542f 410d 0a20 2020 2075 6e69 7450  ,pT/A..    unitP
+00010e30: 6861 7365 2020 2020 2020 2020 2020 2073  hase           s
+00010e40: 7472 2020 2020 2020 2020 2075 6e69 7473  tr         units
+00010e50: 2028 6d72 6164 2c64 6567 290d 0a20 2020   (mrad,deg)..   
+00010e60: 2073 636f 6e66 6967 5f64 6963 7420 2020   sconfig_dict   
+00010e70: 2020 2020 2064 6963 7420 2020 2020 2020       dict       
+00010e80: 2073 7572 7665 7963 6f6e 6669 6775 7261   surveyconfigura
+00010e90: 7469 6f6e 2064 6963 7420 656c 6d74 730d  tion dict elmts.
+00010ea0: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+00010eb0: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+00010ec0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+00010ed0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00010ee0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00010ef0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00010f00: 4d6f 7265 2061 7474 7269 6275 7465 7320  More attributes 
+00010f10: 6361 6e20 6265 2061 6464 6564 2062 7920  can be added by 
+00010f20: 696e 7075 7469 6e67 2061 206b 6579 2077  inputing a key w
+00010f30: 6f72 6420 6469 6374 696f 6e61 7279 0d0a  ord dictionary..
+00010f40: 2020 2020 0d0a 2020 2020 3a45 7861 6d70      ..    :Examp
+00010f50: 6c65 3a0d 0a20 2020 2020 2020 200d 0a20  le:..        .. 
+00010f60: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00010f70: 7079 6373 616d 742e 636f 7265 2069 6d70  pycsamt.core imp
+00010f80: 6f72 7420 4176 670d 0a20 2020 2020 2020  ort Avg..       
+00010f90: 203e 3e3e 2061 7667 5f6f 626a 3d20 4176   >>> avg_obj= Av
+00010fa0: 6728 6461 7461 5f66 6e3d 7061 7468 2920  g(data_fn=path) 
+00010fb0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7375  ..        >>> su
+00010fc0: 7276 5f6e 616d 654c 696e 653d 2061 7667  rv_nameLine= avg
+00010fd0: 5f6f 626a 2e48 6561 6465 722e 5375 7276  _obj.Header.Surv
+00010fe0: 6579 436f 6e66 6967 7572 6174 696f 6e2e  eyConfiguration.
+00010ff0: 6c69 6e65 4e61 6d65 200d 0a20 2020 2020  lineName ..     
+00011000: 2020 202e 2e2e 2073 7572 765f 6e61 6d65     ... surv_name
+00011010: 4c69 6e65 0d0a 2020 2020 2020 2020 2e2e  Line..        ..
+00011020: 2e20 6176 675f 6f62 6a2e 4865 6164 6572  . avg_obj.Header
+00011030: 2e53 7572 7665 7943 6f6e 6669 6775 7261  .SurveyConfigura
+00011040: 7469 6f6e 2e73 636f 6e66 6967 5f64 6963  tion.sconfig_dic
+00011050: 745b 2753 746e 2e52 6967 6874 275d 0d0a  t['Stn.Right']..
+00011060: 2020 2020 2020 2020 0d0a 2020 2020 2222          ..    ""
+00011070: 220d 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+00011080: 745f 5f28 7365 6c66 2c20 7375 7276 6579  t__(self, survey
+00011090: 5f63 6f6e 6669 675f 6461 7461 203d 4e6f  _config_data =No
+000110a0: 6e65 202c 202a 2a6b 7761 7267 7329 3a0d  ne , **kwargs):.
+000110b0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+000110c0: 2020 2073 656c 662e 7a6f 6e5f 7375 7276     self.zon_surv
+000110d0: 5f63 6f6e 6669 6720 3d20 7375 7276 6579  _config = survey
+000110e0: 5f63 6f6e 6669 675f 6461 7461 200d 0a20  _config_data .. 
+000110f0: 2020 2020 2020 2073 656c 662e 7375 7276         self.surv
+00011100: 6579 5479 7065 203d 2743 5341 4d54 2c20  eyType ='CSAMT, 
+00011110: 5445 4d2c 2043 522c 2054 4449 5027 200d  TEM, CR, TDIP' .
+00011120: 0a20 2020 2020 2020 2073 656c 662e 7375  .        self.su
+00011130: 7276 6579 4172 7261 7920 3d27 4353 414d  rveyArray ='CSAM
+00011140: 543a 2053 6361 6c61 722c 2056 6563 746f  T: Scalar, Vecto
+00011150: 722c 2054 656e 736f 7227 200d 0a20 2020  r, Tensor' ..   
+00011160: 2020 2020 2073 656c 662e 6c69 6e65 4e61       self.lineNa
+00011170: 6d65 3d27 7079 4353 414d 546c 696e 6527  me='pyCSAMTline'
+00011180: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00011190: 6c69 6e65 4e75 6d62 6572 3d27 666c 6f61  lineNumber='floa
+000111a0: 743a 3030 2720 0d0a 2020 2020 2020 2020  t:00' ..        
+000111b0: 7365 6c66 2e61 7a69 6d75 7468 203d 2720  self.azimuth =' 
+000111c0: 3020 6465 6720 4520 6f66 204e 270d 0a20  0 deg E of N'.. 
+000111d0: 2020 2020 2020 2073 656c 662e 7374 6e47         self.stnG
+000111e0: 6470 4265 673d 4e6f 6e65 200d 0a20 2020  dpBeg=None ..   
+000111f0: 2020 2020 2073 656c 662e 7374 6e47 6470       self.stnGdp
+00011200: 496e 6320 3d4e 6f6e 6520 0d0a 2020 2020  Inc =None ..    
+00011210: 2020 2020 7365 6c66 2e73 746e 4265 6720      self.stnBeg 
+00011220: 3d4e 6f6e 6520 0d0a 2020 2020 2020 2020  =None ..        
+00011230: 7365 6c66 2e73 746e 496e 633d 4e6f 6e65  self.stnInc=None
+00011240: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00011250: 7374 6e4c 6566 743d 4e6f 6e65 200d 0a20  stnLeft=None .. 
+00011260: 2020 2020 2020 2073 656c 662e 7374 6e52         self.stnR
+00011270: 6967 6874 203d 4e6f 6e65 200d 0a20 2020  ight =None ..   
+00011280: 2020 2020 2073 656c 662e 756e 6974 4c65       self.unitLe
+00011290: 6e67 7468 203d 276d 2c66 7427 200d 0a20  ngth ='m,ft' .. 
+000112a0: 2020 2020 2020 2073 656c 662e 756e 6974         self.unit
+000112b0: 456d 6167 203d 276e 562f 6d41 206f 7220  Emag ='nV/mA or 
+000112c0: 6d69 636f 562f 6b6d 4127 200d 0a20 2020  micoV/kmA' ..   
+000112d0: 2020 2020 2073 656c 662e 756e 6974 4866       self.unitHf
+000112e0: 6965 6c64 203d 2770 542c 2070 6963 6f54  ield ='pT, picoT
+000112f0: 2f41 2720 0d0a 2020 2020 2020 2020 7365  /A' ..        se
+00011300: 6c66 2e75 6e69 7450 6861 7365 203d 276d  lf.unitPhase ='m
+00011310: 7261 642c 6465 6727 0d0a 2020 2020 2020  rad,deg'..      
+00011320: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+00011330: 2020 2020 2020 7365 6c66 2e73 636f 6e66        self.sconf
+00011340: 6967 5f64 6963 743d 207b 2753 7572 7665  ig_dict= {'Surve
+00011350: 792e 5479 7065 273a 7365 6c66 2e73 7572  y.Type':self.sur
+00011360: 7665 7954 7970 652c 0d0a 2020 2020 2020  veyType,..      
+00011370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011380: 2020 2020 2020 2020 2020 2020 2020 2753                'S
+00011390: 7572 7665 792e 4172 7261 7927 3a73 656c  urvey.Array':sel
+000113a0: 662e 7375 7276 6579 4172 7261 7920 2c20  f.surveyArray , 
+000113b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000113c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000113d0: 2020 2020 2020 274c 696e 652e 4e61 6d65        'Line.Name
+000113e0: 273a 7365 6c66 2e6c 696e 654e 616d 652c  ':self.lineName,
+000113f0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00011400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011410: 2020 2020 2020 2027 4c69 6e65 2e4e 756d         'Line.Num
+00011420: 6265 7227 3a73 656c 662e 6c69 6e65 4e75  ber':self.lineNu
+00011430: 6d62 6572 202c 200d 0a20 2020 2020 2020  mber , ..       
+00011440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011450: 2020 2020 2020 2020 2020 2020 2027 4c69               'Li
+00011460: 6e65 2e41 7a69 6d75 7468 273a 7365 6c66  ne.Azimuth':self
+00011470: 2e61 7a69 6d75 7468 2c20 0d0a 2020 2020  .azimuth, ..    
+00011480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114a0: 2753 746e 2e47 6470 4265 6727 3a73 656c  'Stn.GdpBeg':sel
+000114b0: 662e 7374 6e47 6470 4265 6720 2c20 0d0a  f.stnGdpBeg , ..
+000114c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114e0: 2020 2020 2753 746e 2e47 6470 496e 6327      'Stn.GdpInc'
+000114f0: 3a73 656c 662e 7374 6e47 6470 496e 632c  :self.stnGdpInc,
+00011500: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00011510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011520: 2020 2020 2020 2027 5374 6e2e 4265 6727         'Stn.Beg'
+00011530: 3a73 656c 662e 7374 6e42 6567 202c 200d  :self.stnBeg , .
+00011540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011560: 2020 2020 2027 5374 6e2e 496e 6327 3a73       'Stn.Inc':s
+00011570: 656c 662e 7374 6e49 6e63 202c 200d 0a20  elf.stnInc , .. 
+00011580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115a0: 2020 2027 5374 6e2e 4c65 6674 273a 7365     'Stn.Left':se
+000115b0: 6c66 2e73 746e 4c65 6674 202c 200d 0a20  lf.stnLeft , .. 
 000115c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000115d0: 2020 2020 2020 2027 4c69 6e65 2e4e 616d         'Line.Nam
-000115e0: 6527 3a73 656c 662e 6c69 6e65 4e61 6d65  e':self.lineName
-000115f0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+000115d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115e0: 2020 2027 5374 6e2e 5269 6768 7427 3a73     'Stn.Right':s
+000115f0: 656c 662e 7374 6e52 6967 6874 2c20 0d0a  elf.stnRight, ..
 00011600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011610: 2020 2020 2020 2020 274c 696e 652e 4e75          'Line.Nu
-00011620: 6d62 6572 273a 7365 6c66 2e6c 696e 654e  mber':self.lineN
-00011630: 756d 6265 7220 2c20 0d0a 2020 2020 2020  umber , ..      
-00011640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011650: 2020 2020 2020 2020 2020 2020 2020 274c                'L
-00011660: 696e 652e 417a 696d 7574 6827 3a73 656c  ine.Azimuth':sel
-00011670: 662e 617a 696d 7574 682c 200d 0a20 2020  f.azimuth, ..   
-00011680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011620: 2020 2020 2755 6e69 742e 4c65 6e67 7468      'Unit.Length
+00011630: 273a 7365 6c66 2e75 6e69 744c 656e 6774  ':self.unitLengt
+00011640: 682c 200d 0a20 2020 2020 2020 2020 2020  h, ..           
+00011650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011660: 2020 2020 2020 2020 2027 556e 6974 2e45           'Unit.E
+00011670: 273a 7365 6c66 2e75 6e69 7445 6d61 672c  ':self.unitEmag,
+00011680: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
 00011690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000116a0: 2027 5374 6e2e 4764 7042 6567 273a 7365   'Stn.GdpBeg':se
-000116b0: 6c66 2e73 746e 4764 7042 6567 202c 200d  lf.stnGdpBeg , .
-000116c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000116a0: 2020 2020 2020 2027 556e 6974 2e42 273a         'Unit.B':
+000116b0: 7365 6c66 2e75 6e69 7448 6669 656c 642c  self.unitHfield,
+000116c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
 000116d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000116e0: 2020 2020 2027 5374 6e2e 4764 7049 6e63       'Stn.GdpInc
-000116f0: 273a 7365 6c66 2e73 746e 4764 7049 6e63  ':self.stnGdpInc
-00011700: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+000116e0: 2020 2020 2020 2027 556e 6974 2e50 6861         'Unit.Pha
+000116f0: 7365 273a 7365 6c66 2e75 6e69 7450 6861  se':self.unitPha
+00011700: 7365 2c20 0d0a 2020 2020 2020 2020 2020  se, ..          
 00011710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011720: 2020 2020 2020 2020 2753 746e 2e42 6567          'Stn.Beg
-00011730: 273a 7365 6c66 2e73 746e 4265 6720 2c20  ':self.stnBeg , 
-00011740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011760: 2020 2020 2020 2753 746e 2e49 6e63 273a        'Stn.Inc':
-00011770: 7365 6c66 2e73 746e 496e 6320 2c20 0d0a  self.stnInc , ..
-00011780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117a0: 2020 2020 2753 746e 2e4c 6566 7427 3a73      'Stn.Left':s
-000117b0: 656c 662e 7374 6e4c 6566 7420 2c20 0d0a  elf.stnLeft , ..
-000117c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117e0: 2020 2020 2753 746e 2e52 6967 6874 273a      'Stn.Right':
-000117f0: 7365 6c66 2e73 746e 5269 6768 742c 200d  self.stnRight, .
-00011800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011820: 2020 2020 2027 556e 6974 2e4c 656e 6774       'Unit.Lengt
-00011830: 6827 3a73 656c 662e 756e 6974 4c65 6e67  h':self.unitLeng
-00011840: 7468 2c20 0d0a 2020 2020 2020 2020 2020  th, ..          
-00011850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011860: 2020 2020 2020 2020 2020 2755 6e69 742e            'Unit.
-00011870: 4527 3a73 656c 662e 756e 6974 456d 6167  E':self.unitEmag
-00011880: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00011890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118a0: 2020 2020 2020 2020 2755 6e69 742e 4227          'Unit.B'
-000118b0: 3a73 656c 662e 756e 6974 4866 6965 6c64  :self.unitHfield
-000118c0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-000118d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118e0: 2020 2020 2020 2020 2755 6e69 742e 5068          'Unit.Ph
-000118f0: 6173 6527 3a73 656c 662e 756e 6974 5068  ase':self.unitPh
-00011900: 6173 652c 200d 0a20 2020 2020 2020 2020  ase, ..         
-00011910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011920: 2020 2020 2020 2020 2020 207d 0d0a 2020             }..  
-00011930: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00011940: 666f 7220 6b65 7973 2069 6e20 6c69 7374  for keys in list
-00011950: 286b 7761 7267 732e 6b65 7973 2829 293a  (kwargs.keys()):
-00011960: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00011970: 6c69 7374 613d 5b6b 6579 2066 6f72 206b  lista=[key for k
-00011980: 6579 2069 6e20 5465 7374 2e5f 5f64 6963  ey in Test.__dic
-00011990: 745f 5f2e 6b65 7973 2829 2069 6620 6e6f  t__.keys() if no
-000119a0: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-000119b0: 2328 6b65 792e 7374 6172 7473 7769 7468  #(key.startswith
-000119c0: 2827 5f5f 2729 2061 6e64 206b 6579 2e65  ('__') and key.e
-000119d0: 6e64 7377 6974 6828 275f 5f27 2929 5d0d  ndswith('__'))].
-000119e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000119f0: 6b65 7973 206e 6f74 2069 6e20 5375 7276  keys not in Surv
-00011a00: 6579 436f 6e66 6967 7572 6174 696f 6e2e  eyConfiguration.
-00011a10: 5f5f 6469 6374 5f5f 2e6b 6579 7328 293a  __dict__.keys():
-00011a20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011a30: 2020 7365 6c66 2e5f 5f73 6574 6174 7472    self.__setattr
-00011a40: 5f5f 286b 6579 732c 206b 7761 7267 735b  __(keys, kwargs[
-00011a50: 6b65 7973 5d29 0d0a 2020 2020 2020 2020  keys])..        
-00011a60: 2020 2020 2020 2020 7365 6c66 2e73 636f          self.sco
-00011a70: 6e66 6967 5f64 6963 742e 5f5f 7365 7469  nfig_dict.__seti
-00011a80: 7465 6d5f 5f28 6b65 7973 2c20 6b77 6172  tem__(keys, kwar
-00011a90: 6773 5b6b 6579 735d 290d 0a20 2020 2020  gs[keys])..     
-00011aa0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00011ab0: 2064 6566 2073 6574 5f73 7572 7665 795f   def set_survey_
-00011ac0: 636f 6e66 6967 7572 6174 696f 6e5f 696e  configuration_in
-00011ad0: 666f 7320 2873 656c 662c 2073 7572 7665  fos (self, surve
-00011ae0: 795f 636f 6e66 6967 5f64 6174 6120 3d4e  y_config_data =N
-00011af0: 6f6e 6529 3a20 0d0a 2020 2020 2020 2020  one): ..        
-00011b00: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
-00011b10: 686f 6420 746f 2073 6574 205f 7375 7276  hod to set _surv
-00011b20: 6579 2063 6f6e 6669 6775 7261 7469 6f6e  ey configuration
-00011b30: 7320 696e 666f 726d 6174 696f 6e73 202e  s informations .
-00011b40: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00011b50: 2020 2020 2050 6172 616d 6574 6572 7320       Parameters 
-00011b60: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00011b70: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2020  ----..          
-00011b80: 2020 2a20 7375 7276 6579 5f63 6f6e 6669    * survey_confi
-00011b90: 675f 6461 7461 203a 206c 6973 7420 6f72  g_data : list or
-00011ba0: 2070 6174 684c 696b 6520 7374 7220 0d0a   pathLike str ..
-00011bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011bd0: 636f 6e74 6169 6e65 7220 6f66 2073 7572  container of sur
-00011be0: 7665 7920 636f 6e66 6967 7572 6174 696f  vey configuratio
-00011bf0: 6e73 2020 696e 666f 732e 200d 0a20 2020  ns  infos. ..   
-00011c00: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00011c10: 2020 5f6c 6f67 6765 722e 696e 666f 2827    _logger.info('
-00011c20: 5265 6164 696e 6720 616e 6420 7365 7474  Reading and sett
-00011c30: 696e 6720 7375 7276 6579 2063 6f6e 6669  ing survey confi
-00011c40: 6775 7261 7469 6f6e 7320 696e 666f 726d  gurations inform
-00011c50: 6174 696f 6e73 2127 290d 0a0d 0a20 2020  ations!')....   
-00011c60: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-00011c70: 6620 7375 7276 6579 5f63 6f6e 6669 675f  f survey_config_
-00011c80: 6461 7461 2069 7320 6e6f 7420 4e6f 6e65  data is not None
-00011c90: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00011ca0: 2073 656c 662e 7a6f 6e5f 7375 7276 5f63   self.zon_surv_c
-00011cb0: 6f6e 6669 6720 3d20 7375 7276 6579 5f63  onfig = survey_c
-00011cc0: 6f6e 6669 675f 6461 7461 0d0a 2020 2020  onfig_data..    
-00011cd0: 2020 2020 6966 2073 656c 662e 7a6f 6e5f      if self.zon_
-00011ce0: 7375 7276 5f63 6f6e 6669 6720 6973 204e  surv_config is N
-00011cf0: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
-00011d00: 2020 2072 6169 7365 2043 5365 782e 7079     raise CSex.py
-00011d10: 4353 414d 5445 7272 6f72 5f48 6561 6465  CSAMTError_Heade
-00011d20: 7228 224e 6f20 5375 7276 6579 2063 6f6e  r("No Survey con
-00011d30: 6669 6775 7261 7469 6f6e 2064 6174 6120  figuration data 
-00011d40: 666f 756e 642e 220d 0a20 2020 2020 2020  found."..       
-00011d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d70: 2020 2020 2020 2220 506c 6561 7365 2063        " Please c
-00011d80: 6865 636b 2079 6f75 7220 636f 6e66 6967  heck your config
-00011d90: 7572 6174 696f 6e20 6669 6c65 2e22 290d  uration file.").
-00011da0: 0a20 2020 2020 2020 2069 6620 7479 7065  .        if type
-00011db0: 2873 656c 662e 7a6f 6e5f 7375 7276 5f63  (self.zon_surv_c
-00011dc0: 6f6e 6669 6729 2069 7320 6e6f 7420 6c69  onfig) is not li
-00011dd0: 7374 3a20 0d0a 2020 2020 2020 2020 2020  st: ..          
-00011de0: 2020 7472 7920 3a0d 0a20 2020 2020 2020    try :..       
-00011df0: 2020 2020 2020 2020 2069 6620 6f73 2e70           if os.p
-00011e00: 6174 682e 6973 6669 6c65 2873 656c 662e  ath.isfile(self.
-00011e10: 7a6f 6e5f 7375 7276 5f63 6f6e 6669 6729  zon_surv_config)
-00011e20: 2069 7320 5472 7565 203a 0d0a 2020 2020   is True :..    
-00011e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e40: 7769 7468 206f 7065 6e20 2873 656c 662e  with open (self.
-00011e50: 7a6f 6e5f 7375 7276 5f63 6f6e 6669 672c  zon_surv_config,
-00011e60: 2027 7227 2c20 656e 636f 6469 6e67 203d   'r', encoding =
-00011e70: 2775 7466 3827 2920 6173 2066 6964 203a  'utf8') as fid :
-00011e80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011e90: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
-00011ea0: 6f6e 5f73 7572 765f 636f 6e66 6967 3d66  on_surv_config=f
-00011eb0: 6964 2e72 6561 646c 696e 6573 2829 0d0a  id.readlines()..
-00011ec0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00011ed0: 7074 203a 2072 6169 7365 2043 5365 782e  pt : raise CSex.
-00011ee0: 7079 4353 414d 5445 7272 6f72 5f48 6561  pyCSAMTError_Hea
-00011ef0: 6465 7228 0d0a 2020 2020 2020 2020 2020  der(..          
-00011f00: 2020 2020 2020 2020 2020 2279 6f75 7220            "your 
-00011f10: 636f 6e66 6967 7572 6174 696f 6e20 6461  configuration da
-00011f20: 7461 206d 7573 7420 6265 2065 6974 6865  ta must be eithe
-00011f30: 7220 6120 6c69 7374 206f 7220 6120 6669  r a list or a fi
-00011f40: 6c65 2e22 290d 0a20 2020 2020 2020 2020  le.")..         
-00011f50: 2020 200d 0a20 2020 2020 2020 2023 2070     ..        # p
-00011f60: 7269 6e74 2873 656c 662e 7a6f 6e5f 7375  rint(self.zon_su
-00011f70: 7276 5f63 6f6e 6669 6729 0d0a 2020 2020  rv_config)..    
-00011f80: 2020 2020 666f 7220 636f 6e66 6967 496e      for configIn
-00011f90: 666f 7320 696e 2073 656c 662e 7a6f 6e5f  fos in self.zon_
-00011fa0: 7375 7276 5f63 6f6e 6669 6720 3a0d 0a20  surv_config :.. 
-00011fb0: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
-00011fc0: 6749 6e66 6f73 3d63 6f6e 6669 6749 6e66  gInfos=configInf
-00011fd0: 6f73 2e73 7472 6970 2829 2e73 706c 6974  os.strip().split
-00011fe0: 2827 3d27 290d 0a0d 0a20 2020 2020 2020  ('=')....       
-00011ff0: 2020 2020 2069 6620 2773 7572 7665 792e       if 'survey.
-00012000: 7479 7065 2720 696e 2063 6f6e 6669 6749  type' in configI
-00012010: 6e66 6f73 5b30 5d2e 6c6f 7765 7228 293a  nfos[0].lower():
-00012020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012030: 2020 6966 2063 6f6e 6669 6749 6e66 6f73    if configInfos
-00012040: 5b31 5d20 213d 2027 273a 200d 0a20 2020  [1] != '': ..   
-00012050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012060: 2073 656c 662e 7375 7276 6579 5479 7065   self.surveyType
-00012070: 3d63 6f6e 6669 6749 6e66 6f73 5b31 5d0d  =configInfos[1].
-00012080: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00012090: 2773 7572 7665 792e 6172 7261 7927 2069  'survey.array' i
-000120a0: 6e20 636f 6e66 6967 496e 666f 735b 305d  n configInfos[0]
-000120b0: 2e6c 6f77 6572 2829 3a0d 0a20 2020 2020  .lower():..     
-000120c0: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-000120d0: 6e66 6967 496e 666f 735b 315d 2021 3d20  nfigInfos[1] != 
-000120e0: 2727 3a20 0d0a 2020 2020 2020 2020 2020  '': ..          
-000120f0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00012100: 7572 7665 7941 7272 6179 3d63 6f6e 6669  urveyArray=confi
-00012110: 6749 6e66 6f73 5b31 5d0d 0a20 2020 2020  gInfos[1]..     
-00012120: 2020 2020 2020 2069 6620 276c 696e 652e         if 'line.
-00012130: 6e61 6d65 2720 696e 2063 6f6e 6669 6749  name' in configI
-00012140: 6e66 6f73 5b30 5d2e 6c6f 7765 7228 293a  nfos[0].lower():
-00012150: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012160: 2020 6966 2063 6f6e 6669 6749 6e66 6f73    if configInfos
-00012170: 5b31 5d20 213d 2027 273a 200d 0a20 2020  [1] != '': ..   
-00012180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012190: 2073 656c 662e 6c69 6e65 4e61 6d65 3d63   self.lineName=c
-000121a0: 6f6e 6669 6749 6e66 6f73 5b31 5d20 0d0a  onfigInfos[1] ..
-000121b0: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-000121c0: 6c69 6e65 2e6e 756d 6265 7227 2069 6e20  line.number' in 
-000121d0: 636f 6e66 6967 496e 666f 735b 305d 2e6c  configInfos[0].l
-000121e0: 6f77 6572 2829 3a0d 0a20 2020 2020 2020  ower():..       
-000121f0: 2020 2020 2020 2020 2069 6620 636f 6e66           if conf
-00012200: 6967 496e 666f 735b 315d 2021 3d20 2727  igInfos[1] != ''
-00012210: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00012220: 2020 2020 2020 2020 7365 6c66 2e6c 696e          self.lin
-00012230: 654e 756d 6265 723d 636f 6e66 6967 496e  eNumber=configIn
-00012240: 666f 735b 315d 200d 0a20 2020 2020 2020  fos[1] ..       
-00012250: 2020 2020 2069 6620 276c 696e 652e 617a       if 'line.az
-00012260: 696d 7574 6827 2069 6e20 636f 6e66 6967  imuth' in config
-00012270: 496e 666f 735b 305d 2e6c 6f77 6572 2829  Infos[0].lower()
-00012280: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00012290: 2020 2069 6620 636f 6e66 6967 496e 666f     if configInfo
-000122a0: 735b 315d 2021 3d20 2727 3a20 0d0a 2020  s[1] != '': ..  
-000122b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122c0: 2020 7365 6c66 2e61 7a69 6d75 7468 3d63    self.azimuth=c
-000122d0: 6f6e 6669 6749 6e66 6f73 5b31 5d20 0d0a  onfigInfos[1] ..
-000122e0: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-000122f0: 7374 6e2e 6764 7062 6567 2720 696e 2063  stn.gdpbeg' in c
-00012300: 6f6e 6669 6749 6e66 6f73 5b30 5d2e 6c6f  onfigInfos[0].lo
-00012310: 7765 7228 293a 0d0a 2020 2020 2020 2020  wer():..        
-00012320: 2020 2020 2020 2020 7365 6c66 2e73 746e          self.stn
-00012330: 4764 7042 6567 3d63 6f6e 6669 6749 6e66  GdpBeg=configInf
-00012340: 6f73 5b31 5d20 0d0a 2020 2020 2020 2020  os[1] ..        
-00012350: 2020 2020 6966 2027 7374 6e2e 6764 7069      if 'stn.gdpi
-00012360: 6e63 2720 696e 2063 6f6e 6669 6749 6e66  nc' in configInf
-00012370: 6f73 5b30 5d2e 6c6f 7765 7228 293a 0d0a  os[0].lower():..
-00012380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012390: 7365 6c66 2e73 746e 4764 7049 6e63 3d63  self.stnGdpInc=c
-000123a0: 6f6e 6669 6749 6e66 6f73 5b31 5d20 0d0a  onfigInfos[1] ..
-000123b0: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-000123c0: 7374 6e2e 6265 6727 2069 6e20 636f 6e66  stn.beg' in conf
-000123d0: 6967 496e 666f 735b 305d 2e6c 6f77 6572  igInfos[0].lower
-000123e0: 2829 3a20 0d0a 2020 2020 2020 2020 2020  (): ..          
-000123f0: 2020 2020 2020 7365 6c66 2e73 746e 4265        self.stnBe
-00012400: 673d 636f 6e66 6967 496e 666f 735b 315d  g=configInfos[1]
-00012410: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
-00012420: 6620 2773 746e 2e69 6e63 2720 696e 2063  f 'stn.inc' in c
-00012430: 6f6e 6669 6749 6e66 6f73 5b30 5d2e 6c6f  onfigInfos[0].lo
-00012440: 7765 7228 293a 200d 0a20 2020 2020 2020  wer(): ..       
-00012450: 2020 2020 2020 2020 2073 656c 662e 7374           self.st
-00012460: 6e49 6e63 3d63 6f6e 6669 6749 6e66 6f73  nInc=configInfos
-00012470: 5b31 5d20 0d0a 2020 2020 2020 2020 2020  [1] ..          
-00012480: 2020 6966 2027 7374 6e2e 6c65 6674 2720    if 'stn.left' 
-00012490: 696e 2063 6f6e 6669 6749 6e66 6f73 5b30  in configInfos[0
-000124a0: 5d2e 6c6f 7765 7228 293a 0d0a 2020 2020  ].lower():..    
-000124b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000124c0: 2e73 746e 4c65 6674 3d63 6f6e 6669 6749  .stnLeft=configI
-000124d0: 6e66 6f73 5b31 5d20 0d0a 2020 2020 2020  nfos[1] ..      
-000124e0: 2020 2020 2020 6966 2027 7374 6e2e 7269        if 'stn.ri
-000124f0: 6768 7427 2069 6e20 636f 6e66 6967 496e  ght' in configIn
-00012500: 666f 735b 305d 2e6c 6f77 6572 2829 3a20  fos[0].lower(): 
-00012510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012520: 2020 7365 6c66 2e73 746e 5269 6768 743d    self.stnRight=
-00012530: 636f 6e66 6967 496e 666f 735b 315d 0d0a  configInfos[1]..
-00012540: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-00012550: 7374 6e2e 6c65 6e67 7468 2720 696e 2063  stn.length' in c
-00012560: 6f6e 6669 6749 6e66 6f73 5b30 5d2e 6c6f  onfigInfos[0].lo
-00012570: 7765 7228 293a 0d0a 2020 2020 2020 2020  wer():..        
-00012580: 2020 2020 2020 2020 7365 6c66 2e75 6e69          self.uni
-00012590: 744c 656e 6774 683d 636f 6e66 6967 496e  tLength=configIn
-000125a0: 666f 735b 315d 200d 0a20 2020 2020 2020  fos[1] ..       
-000125b0: 2020 2020 2069 6620 2775 6e69 742e 6527       if 'unit.e'
-000125c0: 2069 6e20 636f 6e66 6967 496e 666f 735b   in configInfos[
-000125d0: 305d 2e6c 6f77 6572 2829 3a0d 0a20 2020  0].lower():..   
-000125e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000125f0: 636f 6e66 6967 496e 666f 735b 315d 2021  configInfos[1] !
-00012600: 3d20 2727 3a0d 0a20 2020 2020 2020 2020  = '':..         
-00012610: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012620: 756e 6974 456d 6167 3d63 6f6e 6669 6749  unitEmag=configI
-00012630: 6e66 6f73 5b31 5d20 0d0a 2020 2020 2020  nfos[1] ..      
-00012640: 2020 2020 2020 6966 2027 756e 6974 2e62        if 'unit.b
-00012650: 2720 696e 2063 6f6e 6669 6749 6e66 6f73  ' in configInfos
-00012660: 5b30 5d2e 6c6f 7765 7228 293a 0d0a 2020  [0].lower():..  
-00012670: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00012680: 2063 6f6e 6669 6749 6e66 6f73 5b31 5d20   configInfos[1] 
-00012690: 213d 2027 273a 200d 0a20 2020 2020 2020  != '': ..       
-000126a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000126b0: 662e 756e 6974 4866 6965 6c64 3d63 6f6e  f.unitHfield=con
-000126c0: 6669 6749 6e66 6f73 5b31 5d20 0d0a 2020  figInfos[1] ..  
-000126d0: 2020 2020 2020 2020 2020 6966 2027 756e            if 'un
-000126e0: 6974 2e70 6861 7365 2720 696e 2063 6f6e  it.phase' in con
-000126f0: 6669 6749 6e66 6f73 5b30 5d2e 6c6f 7765  figInfos[0].lowe
-00012700: 7228 293a 0d0a 2020 2020 2020 2020 2020  r():..          
-00012710: 2020 2020 2020 6966 2063 6f6e 6669 6749        if configI
-00012720: 6e66 6f73 5b31 5d20 213d 2027 273a 200d  nfos[1] != '': .
-00012730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012740: 2020 2020 2073 656c 662e 756e 6974 5068       self.unitPh
-00012750: 6173 653d 636f 6e66 6967 496e 666f 735b  ase=configInfos[
-00012760: 315d 200d 0a0d 0a20 2020 2020 2020 2073  1] ....        s
-00012770: 656c 662e 7363 6f6e 6669 675f 6469 6374  elf.sconfig_dict
-00012780: 3d20 7b27 5375 7276 6579 2e54 7970 6527  = {'Survey.Type'
-00012790: 3a73 656c 662e 7375 7276 6579 5479 7065  :self.surveyType
-000127a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00011720: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
+00011730: 2020 2020 200d 0a20 2020 2020 2020 2066       ..        f
+00011740: 6f72 206b 6579 7320 696e 206c 6973 7428  or keys in list(
+00011750: 6b77 6172 6773 2e6b 6579 7328 2929 3a0d  kwargs.keys()):.
+00011760: 0a20 2020 2020 2020 2020 2020 2023 206c  .            # l
+00011770: 6973 7461 3d5b 6b65 7920 666f 7220 6b65  ista=[key for ke
+00011780: 7920 696e 2054 6573 742e 5f5f 6469 6374  y in Test.__dict
+00011790: 5f5f 2e6b 6579 7328 2920 6966 206e 6f74  __.keys() if not
+000117a0: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
+000117b0: 286b 6579 2e73 7461 7274 7377 6974 6828  (key.startswith(
+000117c0: 275f 5f27 2920 616e 6420 6b65 792e 656e  '__') and key.en
+000117d0: 6473 7769 7468 2827 5f5f 2729 295d 0d0a  dswith('__'))]..
+000117e0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+000117f0: 6579 7320 6e6f 7420 696e 2053 7572 7665  eys not in Surve
+00011800: 7943 6f6e 6669 6775 7261 7469 6f6e 2e5f  yConfiguration._
+00011810: 5f64 6963 745f 5f2e 6b65 7973 2829 3a0d  _dict__.keys():.
+00011820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011830: 2073 656c 662e 5f5f 7365 7461 7474 725f   self.__setattr_
+00011840: 5f28 6b65 7973 2c20 6b77 6172 6773 5b6b  _(keys, kwargs[k
+00011850: 6579 735d 290d 0a20 2020 2020 2020 2020  eys])..         
+00011860: 2020 2020 2020 2073 656c 662e 7363 6f6e         self.scon
+00011870: 6669 675f 6469 6374 2e5f 5f73 6574 6974  fig_dict.__setit
+00011880: 656d 5f5f 286b 6579 732c 206b 7761 7267  em__(keys, kwarg
+00011890: 735b 6b65 7973 5d29 0d0a 2020 2020 2020  s[keys])..      
+000118a0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+000118b0: 6465 6620 7365 745f 7375 7276 6579 5f63  def set_survey_c
+000118c0: 6f6e 6669 6775 7261 7469 6f6e 5f69 6e66  onfiguration_inf
+000118d0: 6f73 2028 7365 6c66 2c20 7375 7276 6579  os (self, survey
+000118e0: 5f63 6f6e 6669 675f 6461 7461 203d 4e6f  _config_data =No
+000118f0: 6e65 293a 200d 0a20 2020 2020 2020 2022  ne): ..        "
+00011900: 2222 0d0a 2020 2020 2020 2020 4d65 7468  ""..        Meth
+00011910: 6f64 2074 6f20 7365 7420 5f73 7572 7665  od to set _surve
+00011920: 7920 636f 6e66 6967 7572 6174 696f 6e73  y configurations
+00011930: 2069 6e66 6f72 6d61 7469 6f6e 7320 2e20   informations . 
+00011940: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00011950: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
+00011960: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00011970: 2d2d 2d0d 0a20 2020 2020 2020 2020 2020  ---..           
+00011980: 202a 2073 7572 7665 795f 636f 6e66 6967   * survey_config
+00011990: 5f64 6174 6120 3a20 6c69 7374 206f 7220  _data : list or 
+000119a0: 7061 7468 4c69 6b65 2073 7472 200d 0a20  pathLike str .. 
+000119b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119c0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000119d0: 6f6e 7461 696e 6572 206f 6620 7375 7276  ontainer of surv
+000119e0: 6579 2063 6f6e 6669 6775 7261 7469 6f6e  ey configuration
+000119f0: 7320 2069 6e66 6f73 2e20 0d0a 2020 2020  s  infos. ..    
+00011a00: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00011a10: 205f 6c6f 6767 6572 2e69 6e66 6f28 2752   _logger.info('R
+00011a20: 6561 6469 6e67 2061 6e64 2073 6574 7469  eading and setti
+00011a30: 6e67 2073 7572 7665 7920 636f 6e66 6967  ng survey config
+00011a40: 7572 6174 696f 6e73 2069 6e66 6f72 6d61  urations informa
+00011a50: 7469 6f6e 7321 2729 0d0a 0d0a 2020 2020  tions!')....    
+00011a60: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+00011a70: 2073 7572 7665 795f 636f 6e66 6967 5f64   survey_config_d
+00011a80: 6174 6120 6973 206e 6f74 204e 6f6e 6520  ata is not None 
+00011a90: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00011aa0: 7365 6c66 2e7a 6f6e 5f73 7572 765f 636f  self.zon_surv_co
+00011ab0: 6e66 6967 203d 2073 7572 7665 795f 636f  nfig = survey_co
+00011ac0: 6e66 6967 5f64 6174 610d 0a20 2020 2020  nfig_data..     
+00011ad0: 2020 2069 6620 7365 6c66 2e7a 6f6e 5f73     if self.zon_s
+00011ae0: 7572 765f 636f 6e66 6967 2069 7320 4e6f  urv_config is No
+00011af0: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
+00011b00: 2020 7261 6973 6520 4865 6164 6572 4572    raise HeaderEr
+00011b10: 726f 7228 224e 6f20 5375 7276 6579 2063  ror("No Survey c
+00011b20: 6f6e 6669 6775 7261 7469 6f6e 2064 6174  onfiguration dat
+00011b30: 6120 666f 756e 642e 220d 0a20 2020 2020  a found."..     
+00011b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b60: 2020 2020 2020 2020 2220 506c 6561 7365          " Please
+00011b70: 2063 6865 636b 2079 6f75 7220 636f 6e66   check your conf
+00011b80: 6967 7572 6174 696f 6e20 6669 6c65 2e22  iguration file."
+00011b90: 290d 0a20 2020 2020 2020 2069 6620 7479  )..        if ty
+00011ba0: 7065 2873 656c 662e 7a6f 6e5f 7375 7276  pe(self.zon_surv
+00011bb0: 5f63 6f6e 6669 6729 2069 7320 6e6f 7420  _config) is not 
+00011bc0: 6c69 7374 3a20 0d0a 2020 2020 2020 2020  list: ..        
+00011bd0: 2020 2020 7472 7920 3a0d 0a20 2020 2020      try :..     
+00011be0: 2020 2020 2020 2020 2020 2069 6620 6f73             if os
+00011bf0: 2e70 6174 682e 6973 6669 6c65 2873 656c  .path.isfile(sel
+00011c00: 662e 7a6f 6e5f 7375 7276 5f63 6f6e 6669  f.zon_surv_confi
+00011c10: 6729 2069 7320 5472 7565 203a 0d0a 2020  g) is True :..  
+00011c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c30: 2020 7769 7468 206f 7065 6e20 2873 656c    with open (sel
+00011c40: 662e 7a6f 6e5f 7375 7276 5f63 6f6e 6669  f.zon_surv_confi
+00011c50: 672c 2027 7227 2c20 656e 636f 6469 6e67  g, 'r', encoding
+00011c60: 203d 2775 7466 3827 2920 6173 2066 6964   ='utf8') as fid
+00011c70: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00011c80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011c90: 2e7a 6f6e 5f73 7572 765f 636f 6e66 6967  .zon_surv_config
+00011ca0: 3d66 6964 2e72 6561 646c 696e 6573 2829  =fid.readlines()
+00011cb0: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+00011cc0: 6365 7074 203a 2072 6169 7365 2048 6561  cept : raise Hea
+00011cd0: 6465 7245 7272 6f72 280d 0a20 2020 2020  derError(..     
+00011ce0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00011cf0: 796f 7572 2063 6f6e 6669 6775 7261 7469  your configurati
+00011d00: 6f6e 2064 6174 6120 6d75 7374 2062 6520  on data must be 
+00011d10: 6569 7468 6572 2061 206c 6973 7420 6f72  either a list or
+00011d20: 2061 2066 696c 652e 2229 0d0a 2020 2020   a file.")..    
+00011d30: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00011d40: 2020 2320 7072 696e 7428 7365 6c66 2e7a    # print(self.z
+00011d50: 6f6e 5f73 7572 765f 636f 6e66 6967 290d  on_surv_config).
+00011d60: 0a20 2020 2020 2020 2066 6f72 2063 6f6e  .        for con
+00011d70: 6669 6749 6e66 6f73 2069 6e20 7365 6c66  figInfos in self
+00011d80: 2e7a 6f6e 5f73 7572 765f 636f 6e66 6967  .zon_surv_config
+00011d90: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00011da0: 636f 6e66 6967 496e 666f 733d 636f 6e66  configInfos=conf
+00011db0: 6967 496e 666f 732e 7374 7269 7028 292e  igInfos.strip().
+00011dc0: 7370 6c69 7428 273d 2729 0d0a 0d0a 2020  split('=')....  
+00011dd0: 2020 2020 2020 2020 2020 6966 2027 7375            if 'su
+00011de0: 7276 6579 2e74 7970 6527 2069 6e20 636f  rvey.type' in co
+00011df0: 6e66 6967 496e 666f 735b 305d 2e6c 6f77  nfigInfos[0].low
+00011e00: 6572 2829 3a0d 0a20 2020 2020 2020 2020  er():..         
+00011e10: 2020 2020 2020 2069 6620 636f 6e66 6967         if config
+00011e20: 496e 666f 735b 315d 2021 3d20 2727 3a20  Infos[1] != '': 
+00011e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00011e40: 2020 2020 2020 7365 6c66 2e73 7572 7665        self.surve
+00011e50: 7954 7970 653d 636f 6e66 6967 496e 666f  yType=configInfo
+00011e60: 735b 315d 0d0a 2020 2020 2020 2020 2020  s[1]..          
+00011e70: 2020 6966 2027 7375 7276 6579 2e61 7272    if 'survey.arr
+00011e80: 6179 2720 696e 2063 6f6e 6669 6749 6e66  ay' in configInf
+00011e90: 6f73 5b30 5d2e 6c6f 7765 7228 293a 0d0a  os[0].lower():..
+00011ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011eb0: 6966 2063 6f6e 6669 6749 6e66 6f73 5b31  if configInfos[1
+00011ec0: 5d20 213d 2027 273a 200d 0a20 2020 2020  ] != '': ..     
+00011ed0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00011ee0: 656c 662e 7375 7276 6579 4172 7261 793d  elf.surveyArray=
+00011ef0: 636f 6e66 6967 496e 666f 735b 315d 0d0a  configInfos[1]..
+00011f00: 2020 2020 2020 2020 2020 2020 6966 2027              if '
+00011f10: 6c69 6e65 2e6e 616d 6527 2069 6e20 636f  line.name' in co
+00011f20: 6e66 6967 496e 666f 735b 305d 2e6c 6f77  nfigInfos[0].low
+00011f30: 6572 2829 3a0d 0a20 2020 2020 2020 2020  er():..         
+00011f40: 2020 2020 2020 2069 6620 636f 6e66 6967         if config
+00011f50: 496e 666f 735b 315d 2021 3d20 2727 3a20  Infos[1] != '': 
+00011f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00011f70: 2020 2020 2020 7365 6c66 2e6c 696e 654e        self.lineN
+00011f80: 616d 653d 636f 6e66 6967 496e 666f 735b  ame=configInfos[
+00011f90: 315d 200d 0a20 2020 2020 2020 2020 2020  1] ..           
+00011fa0: 2069 6620 276c 696e 652e 6e75 6d62 6572   if 'line.number
+00011fb0: 2720 696e 2063 6f6e 6669 6749 6e66 6f73  ' in configInfos
+00011fc0: 5b30 5d2e 6c6f 7765 7228 293a 0d0a 2020  [0].lower():..  
+00011fd0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00011fe0: 2063 6f6e 6669 6749 6e66 6f73 5b31 5d20   configInfos[1] 
+00011ff0: 213d 2027 273a 200d 0a20 2020 2020 2020  != '': ..       
+00012000: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012010: 662e 6c69 6e65 4e75 6d62 6572 3d63 6f6e  f.lineNumber=con
+00012020: 6669 6749 6e66 6f73 5b31 5d20 0d0a 2020  figInfos[1] ..  
+00012030: 2020 2020 2020 2020 2020 6966 2027 6c69            if 'li
+00012040: 6e65 2e61 7a69 6d75 7468 2720 696e 2063  ne.azimuth' in c
+00012050: 6f6e 6669 6749 6e66 6f73 5b30 5d2e 6c6f  onfigInfos[0].lo
+00012060: 7765 7228 293a 0d0a 2020 2020 2020 2020  wer():..        
+00012070: 2020 2020 2020 2020 6966 2063 6f6e 6669          if confi
+00012080: 6749 6e66 6f73 5b31 5d20 213d 2027 273a  gInfos[1] != '':
+00012090: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000120a0: 2020 2020 2020 2073 656c 662e 617a 696d         self.azim
+000120b0: 7574 683d 636f 6e66 6967 496e 666f 735b  uth=configInfos[
+000120c0: 315d 200d 0a20 2020 2020 2020 2020 2020  1] ..           
+000120d0: 2069 6620 2773 746e 2e67 6470 6265 6727   if 'stn.gdpbeg'
+000120e0: 2069 6e20 636f 6e66 6967 496e 666f 735b   in configInfos[
+000120f0: 305d 2e6c 6f77 6572 2829 3a0d 0a20 2020  0].lower():..   
+00012100: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012110: 662e 7374 6e47 6470 4265 673d 636f 6e66  f.stnGdpBeg=conf
+00012120: 6967 496e 666f 735b 315d 200d 0a20 2020  igInfos[1] ..   
+00012130: 2020 2020 2020 2020 2069 6620 2773 746e           if 'stn
+00012140: 2e67 6470 696e 6327 2069 6e20 636f 6e66  .gdpinc' in conf
+00012150: 6967 496e 666f 735b 305d 2e6c 6f77 6572  igInfos[0].lower
+00012160: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+00012170: 2020 2020 2073 656c 662e 7374 6e47 6470       self.stnGdp
+00012180: 496e 633d 636f 6e66 6967 496e 666f 735b  Inc=configInfos[
+00012190: 315d 200d 0a20 2020 2020 2020 2020 2020  1] ..           
+000121a0: 2069 6620 2773 746e 2e62 6567 2720 696e   if 'stn.beg' in
+000121b0: 2063 6f6e 6669 6749 6e66 6f73 5b30 5d2e   configInfos[0].
+000121c0: 6c6f 7765 7228 293a 200d 0a20 2020 2020  lower(): ..     
+000121d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000121e0: 7374 6e42 6567 3d63 6f6e 6669 6749 6e66  stnBeg=configInf
+000121f0: 6f73 5b31 5d20 0d0a 2020 2020 2020 2020  os[1] ..        
+00012200: 2020 2020 6966 2027 7374 6e2e 696e 6327      if 'stn.inc'
+00012210: 2069 6e20 636f 6e66 6967 496e 666f 735b   in configInfos[
+00012220: 305d 2e6c 6f77 6572 2829 3a20 0d0a 2020  0].lower(): ..  
+00012230: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00012240: 6c66 2e73 746e 496e 633d 636f 6e66 6967  lf.stnInc=config
+00012250: 496e 666f 735b 315d 200d 0a20 2020 2020  Infos[1] ..     
+00012260: 2020 2020 2020 2069 6620 2773 746e 2e6c         if 'stn.l
+00012270: 6566 7427 2069 6e20 636f 6e66 6967 496e  eft' in configIn
+00012280: 666f 735b 305d 2e6c 6f77 6572 2829 3a0d  fos[0].lower():.
+00012290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000122a0: 2073 656c 662e 7374 6e4c 6566 743d 636f   self.stnLeft=co
+000122b0: 6e66 6967 496e 666f 735b 315d 200d 0a20  nfigInfos[1] .. 
+000122c0: 2020 2020 2020 2020 2020 2069 6620 2773             if 's
+000122d0: 746e 2e72 6967 6874 2720 696e 2063 6f6e  tn.right' in con
+000122e0: 6669 6749 6e66 6f73 5b30 5d2e 6c6f 7765  figInfos[0].lowe
+000122f0: 7228 293a 200d 0a20 2020 2020 2020 2020  r(): ..         
+00012300: 2020 2020 2020 2073 656c 662e 7374 6e52         self.stnR
+00012310: 6967 6874 3d63 6f6e 6669 6749 6e66 6f73  ight=configInfos
+00012320: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
+00012330: 2069 6620 2773 746e 2e6c 656e 6774 6827   if 'stn.length'
+00012340: 2069 6e20 636f 6e66 6967 496e 666f 735b   in configInfos[
+00012350: 305d 2e6c 6f77 6572 2829 3a0d 0a20 2020  0].lower():..   
+00012360: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012370: 662e 756e 6974 4c65 6e67 7468 3d63 6f6e  f.unitLength=con
+00012380: 6669 6749 6e66 6f73 5b31 5d20 0d0a 2020  figInfos[1] ..  
+00012390: 2020 2020 2020 2020 2020 6966 2027 756e            if 'un
+000123a0: 6974 2e65 2720 696e 2063 6f6e 6669 6749  it.e' in configI
+000123b0: 6e66 6f73 5b30 5d2e 6c6f 7765 7228 293a  nfos[0].lower():
+000123c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000123d0: 2020 6966 2063 6f6e 6669 6749 6e66 6f73    if configInfos
+000123e0: 5b31 5d20 213d 2027 273a 0d0a 2020 2020  [1] != '':..    
+000123f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012400: 7365 6c66 2e75 6e69 7445 6d61 673d 636f  self.unitEmag=co
+00012410: 6e66 6967 496e 666f 735b 315d 200d 0a20  nfigInfos[1] .. 
+00012420: 2020 2020 2020 2020 2020 2069 6620 2775             if 'u
+00012430: 6e69 742e 6227 2069 6e20 636f 6e66 6967  nit.b' in config
+00012440: 496e 666f 735b 305d 2e6c 6f77 6572 2829  Infos[0].lower()
+00012450: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00012460: 2020 2069 6620 636f 6e66 6967 496e 666f     if configInfo
+00012470: 735b 315d 2021 3d20 2727 3a20 0d0a 2020  s[1] != '': ..  
+00012480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012490: 2020 7365 6c66 2e75 6e69 7448 6669 656c    self.unitHfiel
+000124a0: 643d 636f 6e66 6967 496e 666f 735b 315d  d=configInfos[1]
+000124b0: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
+000124c0: 6620 2775 6e69 742e 7068 6173 6527 2069  f 'unit.phase' i
+000124d0: 6e20 636f 6e66 6967 496e 666f 735b 305d  n configInfos[0]
+000124e0: 2e6c 6f77 6572 2829 3a0d 0a20 2020 2020  .lower():..     
+000124f0: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+00012500: 6e66 6967 496e 666f 735b 315d 2021 3d20  nfigInfos[1] != 
+00012510: 2727 3a20 0d0a 2020 2020 2020 2020 2020  '': ..          
+00012520: 2020 2020 2020 2020 2020 7365 6c66 2e75            self.u
+00012530: 6e69 7450 6861 7365 3d63 6f6e 6669 6749  nitPhase=configI
+00012540: 6e66 6f73 5b31 5d20 0d0a 0d0a 2020 2020  nfos[1] ....    
+00012550: 2020 2020 7365 6c66 2e73 636f 6e66 6967      self.sconfig
+00012560: 5f64 6963 743d 207b 2753 7572 7665 792e  _dict= {'Survey.
+00012570: 5479 7065 273a 7365 6c66 2e73 7572 7665  Type':self.surve
+00012580: 7954 7970 652c 0d0a 2020 2020 2020 2020  yType,..        
+00012590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125a0: 2020 2020 2020 2020 2020 2020 2753 7572              'Sur
+000125b0: 7665 792e 4172 7261 7927 3a73 656c 662e  vey.Array':self.
+000125c0: 7375 7276 6579 4172 7261 7920 2c20 0d0a  surveyArray , ..
+000125d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125f0: 2020 2020 274c 696e 652e 4e61 6d65 273a      'Line.Name':
+00012600: 7365 6c66 2e6c 696e 654e 616d 652c 200d  self.lineName, .
+00012610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012630: 2020 2020 2027 4c69 6e65 2e4e 756d 6265       'Line.Numbe
+00012640: 7227 3a73 656c 662e 6c69 6e65 4e75 6d62  r':self.lineNumb
+00012650: 6572 202c 200d 0a20 2020 2020 2020 2020  er , ..         
+00012660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012670: 2020 2020 2020 2020 2020 2027 4c69 6e65             'Line
+00012680: 2e41 7a69 6d75 7468 273a 7365 6c66 2e61  .Azimuth':self.a
+00012690: 7a69 6d75 7468 2c20 0d0a 2020 2020 2020  zimuth, ..      
+000126a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000126b0: 2020 2020 2020 2020 2020 2020 2020 2753                'S
+000126c0: 746e 2e47 6470 4265 6727 3a73 656c 662e  tn.GdpBeg':self.
+000126d0: 7374 6e47 6470 4265 6720 2c20 0d0a 2020  stnGdpBeg , ..  
+000126e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000126f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012700: 2020 2753 746e 2e47 6470 496e 6327 3a73    'Stn.GdpInc':s
+00012710: 656c 662e 7374 6e47 6470 496e 632c 200d  elf.stnGdpInc, .
+00012720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012740: 2020 2020 2027 5374 6e2e 4265 6727 3a73       'Stn.Beg':s
+00012750: 656c 662e 7374 6e42 6567 202c 200d 0a20  elf.stnBeg , .. 
+00012760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012780: 2020 2027 5374 6e2e 496e 6327 3a73 656c     'Stn.Inc':sel
+00012790: 662e 7374 6e49 6e63 202c 200d 0a20 2020  f.stnInc , ..   
+000127a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000127b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000127c0: 2020 2020 2020 2027 5375 7276 6579 2e41         'Survey.A
-000127d0: 7272 6179 273a 7365 6c66 2e73 7572 7665  rray':self.surve
-000127e0: 7941 7272 6179 202c 200d 0a20 2020 2020  yArray , ..     
+000127c0: 2027 5374 6e2e 4c65 6674 273a 7365 6c66   'Stn.Left':self
+000127d0: 2e73 746e 4c65 6674 202c 200d 0a20 2020  .stnLeft , ..   
+000127e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000127f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012800: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00012810: 4c69 6e65 2e4e 616d 6527 3a73 656c 662e  Line.Name':self.
-00012820: 6c69 6e65 4e61 6d65 2c20 0d0a 2020 2020  lineName, ..    
+00012800: 2027 5374 6e2e 5269 6768 7427 3a73 656c   'Stn.Right':sel
+00012810: 662e 7374 6e52 6967 6874 2c20 0d0a 2020  f.stnRight, ..  
+00012820: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00012830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012850: 274c 696e 652e 4e75 6d62 6572 273a 7365  'Line.Number':se
-00012860: 6c66 2e6c 696e 654e 756d 6265 7220 2c20  lf.lineNumber , 
-00012870: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012890: 2020 2020 2020 274c 696e 652e 417a 696d        'Line.Azim
-000128a0: 7574 6827 3a73 656c 662e 617a 696d 7574  uth':self.azimut
-000128b0: 682c 200d 0a20 2020 2020 2020 2020 2020  h, ..           
-000128c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000128d0: 2020 2020 2020 2020 2027 5374 6e2e 4764           'Stn.Gd
-000128e0: 7042 6567 273a 7365 6c66 2e73 746e 4764  pBeg':self.stnGd
-000128f0: 7042 6567 202c 200d 0a20 2020 2020 2020  pBeg , ..       
-00012900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012910: 2020 2020 2020 2020 2020 2020 2027 5374               'St
-00012920: 6e2e 4764 7049 6e63 273a 7365 6c66 2e73  n.GdpInc':self.s
-00012930: 746e 4764 7049 6e63 2c20 0d0a 2020 2020  tnGdpInc, ..    
-00012940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012960: 2753 746e 2e42 6567 273a 7365 6c66 2e73  'Stn.Beg':self.s
-00012970: 746e 4265 6720 2c20 0d0a 2020 2020 2020  tnBeg , ..      
-00012980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012990: 2020 2020 2020 2020 2020 2020 2020 2753                'S
-000129a0: 746e 2e49 6e63 273a 7365 6c66 2e73 746e  tn.Inc':self.stn
-000129b0: 496e 6320 2c20 0d0a 2020 2020 2020 2020  Inc , ..        
-000129c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000129d0: 2020 2020 2020 2020 2020 2020 2753 746e              'Stn
-000129e0: 2e4c 6566 7427 3a73 656c 662e 7374 6e4c  .Left':self.stnL
-000129f0: 6566 7420 2c20 0d0a 2020 2020 2020 2020  eft , ..        
-00012a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a10: 2020 2020 2020 2020 2020 2020 2753 746e              'Stn
-00012a20: 2e52 6967 6874 273a 7365 6c66 2e73 746e  .Right':self.stn
-00012a30: 5269 6768 742c 200d 0a20 2020 2020 2020  Right, ..       
-00012a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a50: 2020 2020 2020 2020 2020 2020 2027 556e               'Un
-00012a60: 6974 2e4c 656e 6774 6827 3a73 656c 662e  it.Length':self.
-00012a70: 756e 6974 4c65 6e67 7468 2c20 0d0a 2020  unitLength, ..  
-00012a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012aa0: 2020 2755 6e69 742e 4527 3a73 656c 662e    'Unit.E':self.
-00012ab0: 756e 6974 456d 6167 2c20 0d0a 2020 2020  unitEmag, ..    
-00012ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ae0: 2755 6e69 742e 4227 3a73 656c 662e 756e  'Unit.B':self.un
-00012af0: 6974 4866 6965 6c64 2c20 0d0a 2020 2020  itHfield, ..    
-00012b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b20: 2755 6e69 742e 5068 6173 6527 3a73 656c  'Unit.Phase':sel
-00012b30: 662e 756e 6974 5068 6173 652c 200d 0a20  f.unitPhase, .. 
-00012b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012840: 2020 2755 6e69 742e 4c65 6e67 7468 273a    'Unit.Length':
+00012850: 7365 6c66 2e75 6e69 744c 656e 6774 682c  self.unitLength,
+00012860: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00012870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012880: 2020 2020 2020 2027 556e 6974 2e45 273a         'Unit.E':
+00012890: 7365 6c66 2e75 6e69 7445 6d61 672c 200d  self.unitEmag, .
+000128a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000128b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000128c0: 2020 2020 2027 556e 6974 2e42 273a 7365       'Unit.B':se
+000128d0: 6c66 2e75 6e69 7448 6669 656c 642c 200d  lf.unitHfield, .
+000128e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000128f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012900: 2020 2020 2027 556e 6974 2e50 6861 7365       'Unit.Phase
+00012910: 273a 7365 6c66 2e75 6e69 7450 6861 7365  ':self.unitPhase
+00012920: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00012930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012940: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
+00012950: 2020 200d 0a20 2020 2020 2020 200d 0a63     ..        ..c
+00012960: 6c61 7373 2054 7261 6e73 6d69 7474 6572  lass Transmitter
+00012970: 5072 6f70 6572 7469 6573 286f 626a 6563  Properties(objec
+00012980: 7429 3a0d 0a20 2020 200d 0a20 2020 2022  t):..    ..    "
+00012990: 2222 0d0a 2020 2020 436c 6173 7320 666f  ""..    Class fo
+000129a0: 7220 7472 616e 736d 6974 7465 7220 2070  r transmitter  p
+000129b0: 726f 7065 7274 6965 732e 0d0a 2020 2020  roperties...    
+000129c0: 200d 0a20 2020 2041 7267 756d 656e 7473   ..    Arguments
+000129d0: 2020 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d    ..    --------
+000129e0: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a64  ---..        **d
+000129f0: 6174 615f 666e 2a2a 203a 2073 7472 2020  ata_fn** : str  
+00012a00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012a10: 2020 7061 7468 2074 6f20 6176 6766 696c    path to avgfil
+00012a20: 650d 0a20 2020 2020 2020 200d 0a20 2020  e..        ..   
+00012a30: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00012a40: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==  ==========  
+00012a50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012a60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012a70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+00012a80: 2020 4174 7472 6962 7574 6573 2020 2020    Attributes    
+00012a90: 2020 2020 2054 7970 6520 2020 2020 2020       Type       
+00012aa0: 2045 7870 6c61 6e61 7469 6f6e 0d0a 2020   Explanation..  
+00012ab0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+00012ac0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d20  ===  ========== 
+00012ad0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00012ae0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00012af0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
+00012b00: 2020 2074 7854 7970 6520 2020 2020 2020     txType       
+00012b10: 2020 2020 2020 2073 7472 2020 2020 2020         str      
+00012b20: 2020 2073 6f75 7263 6520 7479 7065 2028     source type (
+00012b30: 666f 7220 4e53 414d 5420 2f43 5341 4d54  for NSAMT /CSAMT
+00012b40: 3a4e 6174 7572 616c 2c20 0d0a 2020 2020  :Natural, ..    
 00012b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b60: 2020 207d 0d0a 2020 2020 2020 2020 0d0a     }..        ..
-00012b70: 2020 2020 2020 2020 0d0a 636c 6173 7320          ..class 
-00012b80: 5472 616e 736d 6974 7465 7250 726f 7065  TransmitterPrope
-00012b90: 7274 6965 7328 6f62 6a65 6374 293a 0d0a  rties(object):..
-00012ba0: 2020 2020 0d0a 2020 2020 2222 220d 0a20      ..    """.. 
-00012bb0: 2020 2043 6c61 7373 2066 6f72 2074 7261     Class for tra
-00012bc0: 6e73 6d69 7474 6572 2020 7072 6f70 6572  nsmitter  proper
-00012bd0: 7469 6573 2e0d 0a20 2020 2020 0d0a 2020  ties...     ..  
-00012be0: 2020 4172 6775 6d65 6e74 7320 200d 0a20    Arguments  .. 
-00012bf0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a     -----------..
-00012c00: 2020 2020 2020 2020 2a2a 6461 7461 5f66          **data_f
-00012c10: 6e2a 2a20 3a20 7374 7220 200d 0a20 2020  n** : str  ..   
-00012c20: 2020 2020 2020 2020 2020 2020 2070 6174               pat
-00012c30: 6820 746f 2061 7667 6669 6c65 0d0a 2020  h to avgfile..  
-00012c40: 2020 2020 2020 0d0a 2020 2020 3d3d 3d3d        ..    ====
-00012c50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
-00012c60: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-00012c70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012c80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012c90: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2041 7474  =======..    Att
-00012ca0: 7269 6275 7465 7320 2020 2020 2020 2020  ributes         
-00012cb0: 5479 7065 2020 2020 2020 2020 4578 706c  Type        Expl
-00012cc0: 616e 6174 696f 6e0d 0a20 2020 203d 3d3d  anation..    ===
-00012cd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==============  
-00012ce0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-00012cf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012d00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00012d10: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 7478  ========..    tx
-00012d20: 5479 7065 2020 2020 2020 2020 2020 2020  Type            
-00012d30: 2020 7374 7220 2020 2020 2020 2020 736f    str         so
-00012d40: 7572 6365 2074 7970 6520 2866 6f72 204e  urce type (for N
-00012d50: 5341 4d54 202f 4353 414d 543a 4e61 7475  SAMT /CSAMT:Natu
-00012d60: 7261 6c2c 200d 0a20 2020 2020 2020 2020  ral, ..         
-00012d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d80: 2020 2020 2020 2020 2020 2020 4269 706f              Bipo
-00012d90: 6c65 2c4c 6f6f 7029 0d0a 2020 2020 7478  le,Loop)..    tx
-00012da0: 4764 7053 746e 2020 2020 2020 2020 2020  GdpStn          
-00012db0: 2020 7374 7220 2020 2020 2020 2020 7472    str         tr
-00012dc0: 616e 736d 6974 7465 7220 4944 2066 726f  ansmitter ID fro
-00012dd0: 6d20 4744 5020 5478 2066 6965 6c64 200d  m GDP Tx field .
-00012de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012b70: 2042 6970 6f6c 652c 4c6f 6f70 290d 0a20   Bipole,Loop).. 
+00012b80: 2020 2074 7847 6470 5374 6e20 2020 2020     txGdpStn     
+00012b90: 2020 2020 2020 2073 7472 2020 2020 2020         str      
+00012ba0: 2020 2074 7261 6e73 6d69 7474 6572 2049     transmitter I
+00012bb0: 4420 6672 6f6d 2047 4450 2054 7820 6669  D from GDP Tx fi
+00012bc0: 656c 6420 0d0a 2020 2020 2020 2020 2020  eld ..          
+00012bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012be0: 2020 2020 2020 2020 2020 2847 4450 2073            (GDP s
+00012bf0: 746e 2023 2920 2861 6c69 6173 203d 2058  tn #) (alias = X
+00012c00: 4d54 5229 0d0a 2020 2020 7478 5374 6e20  MTR)..    txStn 
+00012c10: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00012c20: 7220 2020 2020 2020 2020 7265 7363 616c  r         rescal
+00012c30: 6564 2054 7820 4944 200d 0a20 2020 2020  ed Tx ID ..     
+00012c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012c50: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00012c60: 7265 7363 616c 6564 2063 6c69 656e 7420  rescaled client 
+00012c70: 7374 6e20 2329 0d0a 2020 2020 7478 4365  stn #)..    txCe
+00012c80: 6e74 6572 2020 2020 2020 2020 2020 2020  nter            
+00012c90: 666c 6f61 7420 2020 2020 2020 7472 616e  float       tran
+00012ca0: 736d 6974 7465 7220 6365 6e74 6572 2d70  smitter center-p
+00012cb0: 6f69 6e74 2065 6173 7469 6e67 2c0d 0a20  oint easting,.. 
+00012cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012ce0: 2020 206e 6f72 7468 696e 672c 656c 6576     northing,elev
+00012cf0: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
+00012d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012d10: 2020 2020 2020 2020 2020 2028 666c 6f61             (floa
+00012d20: 742c 206c 656e 6774 6820 756e 6974 7329  t, length units)
+00012d30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012d50: 2020 2020 2020 2861 6c69 6173 6573 203d        (aliases =
+00012d60: 2054 7843 582c 2054 7843 5929 0d0a 2020   TxCX, TxCY)..  
+00012d70: 2020 7478 4850 5220 2020 2020 2020 2020    txHPR         
+00012d80: 2020 2020 2020 696e 7420 2020 2020 2020        int       
+00012d90: 2020 7472 616e 736d 6974 7465 7220 6f72    transmitter or
+00012da0: 6965 6e74 6174 696f 6e20 0d0a 2020 2020  ientation ..    
+00012db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012dd0: 6865 6164 696e 672c 2070 6974 6368 2c20  heading, pitch, 
+00012de0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00012df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e00: 2020 2020 2028 4744 5020 7374 6e20 2329       (GDP stn #)
-00012e10: 2028 616c 6961 7320 3d20 584d 5452 290d   (alias = XMTR).
-00012e20: 0a20 2020 2074 7853 746e 2020 2020 2020  .    txStn      
-00012e30: 2020 2020 2020 2020 2073 7472 2020 2020           str    
-00012e40: 2020 2020 2072 6573 6361 6c65 6420 5478       rescaled Tx
-00012e50: 2049 4420 0d0a 2020 2020 2020 2020 2020   ID ..          
-00012e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e70: 2020 2020 2020 2020 2020 2872 6573 6361            (resca
-00012e80: 6c65 6420 636c 6965 6e74 2073 746e 2023  led client stn #
-00012e90: 290d 0a20 2020 2074 7843 656e 7465 7220  )..    txCenter 
-00012ea0: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
-00012eb0: 2020 2020 2020 2074 7261 6e73 6d69 7474         transmitt
-00012ec0: 6572 2063 656e 7465 722d 706f 696e 7420  er center-point 
-00012ed0: 6561 7374 696e 672c 0d0a 2020 2020 2020  easting,..      
-00012ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ef0: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-00012f00: 7274 6869 6e67 2c65 6c65 7661 7469 6f6e  rthing,elevation
-00012f10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f30: 2020 2020 2020 2866 6c6f 6174 2c20 6c65        (float, le
-00012f40: 6e67 7468 2075 6e69 7473 290d 0a20 2020  ngth units)..   
+00012e00: 2020 2020 2020 726f 6c6c 2028 5478 2068        roll (Tx h
+00012e10: 6561 6469 6e67 2061 6c69 6173 203d 2054  eading alias = T
+00012e20: 7842 7267 290d 0a20 2020 2020 2020 2020  xBrg)..         
+00012e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012e40: 2020 2020 2020 2020 2020 2028 6865 6164             (head
+00012e50: 696e 6720 3d20 6269 706f 6c65 2061 7a69  ing = bipole azi
+00012e60: 6d75 7468 2c20 7069 7463 683d 302c 2072  muth, pitch=0, r
+00012e70: 6f6c 6c3d 3020 0d0a 2020 2020 2020 2020  oll=0 ..        
+00012e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012e90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00012ea0: 7a2b 7570 206f 7220 3138 3020 666f 7220  z+up or 180 for 
+00012eb0: 7a20 706f 7369 7469 7665 2064 6f77 6e29  z positive down)
+00012ec0: 0d0a 2020 2020 7478 4c65 6e67 7468 2020  ..    txLength  
+00012ed0: 2020 2020 2020 2020 2020 7374 7220 2020            str   
+00012ee0: 2020 2020 2020 7472 616e 736d 6974 7465        transmitte
+00012ef0: 7220 6269 706f 6c65 206c 656e 6774 6820  r bipole length 
+00012f00: 6f72 2073 7175 6172 650d 0a20 2020 2020  or square..     
+00012f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f20: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00012f30: 6f6f 7020 7769 6474 6820 0d0a 2020 2020  oop width ..    
+00012f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00012f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f70: 2028 616c 6961 7365 7320 3d20 5478 4358   (aliases = TxCX
-00012f80: 2c20 5478 4359 290d 0a20 2020 2074 7848  , TxCY)..    txH
-00012f90: 5052 2020 2020 2020 2020 2020 2020 2020  PR              
-00012fa0: 2069 6e74 2020 2020 2020 2020 2074 7261   int         tra
-00012fb0: 6e73 6d69 7474 6572 206f 7269 656e 7461  nsmitter orienta
-00012fc0: 7469 6f6e 200d 0a20 2020 2020 2020 2020  tion ..         
+00012f60: 2870 6f73 6974 6976 6520 666c 6f61 742c  (positive float,
+00012f70: 206c 656e 6774 6820 756e 6974 7329 0d0a   length units)..
+00012f80: 2020 2020 7363 6f6e 6669 675f 6469 6374      sconfig_dict
+00012f90: 2020 2020 2020 2020 6469 6374 2020 2020          dict    
+00012fa0: 2020 2020 7061 7261 6d73 2063 6f6e 6669      params confi
+00012fb0: 6720 6469 6374 696f 6e6e 6172 7920 200d  g dictionnary  .
+00012fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00012fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fe0: 2020 2020 2020 2020 2020 2068 6561 6469             headi
-00012ff0: 6e67 2c20 7069 7463 682c 200d 0a20 2020  ng, pitch, ..   
-00013000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013020: 2072 6f6c 6c20 2854 7820 6865 6164 696e   roll (Tx headin
-00013030: 6720 616c 6961 7320 3d20 5478 4272 6729  g alias = TxBrg)
-00013040: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013060: 2020 2020 2020 2868 6561 6469 6e67 203d        (heading =
-00013070: 2062 6970 6f6c 6520 617a 696d 7574 682c   bipole azimuth,
-00013080: 2070 6974 6368 3d30 2c20 726f 6c6c 3d30   pitch=0, roll=0
-00013090: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000130a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000130b0: 2020 2020 2020 2066 6f72 207a 2b75 7020         for z+up 
-000130c0: 6f72 2031 3830 2066 6f72 207a 2070 6f73  or 180 for z pos
-000130d0: 6974 6976 6520 646f 776e 290d 0a20 2020  itive down)..   
-000130e0: 2074 784c 656e 6774 6820 2020 2020 2020   txLength       
-000130f0: 2020 2020 2073 7472 2020 2020 2020 2020       str        
-00013100: 2074 7261 6e73 6d69 7474 6572 2062 6970   transmitter bip
-00013110: 6f6c 6520 6c65 6e67 7468 206f 7220 7371  ole length or sq
-00013120: 7561 7265 0d0a 2020 2020 2020 2020 2020  uare..          
-00013130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013140: 2020 2020 2020 2020 2020 6c6f 6f70 2077            loop w
-00013150: 6964 7468 200d 0a20 2020 2020 2020 2020  idth ..         
-00013160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013170: 2020 2020 2020 2020 2020 2028 706f 7369             (posi
-00013180: 7469 7665 2066 6c6f 6174 2c20 6c65 6e67  tive float, leng
-00013190: 7468 2075 6e69 7473 290d 0a20 2020 2073  th units)..    s
-000131a0: 636f 6e66 6967 5f64 6963 7420 2020 2020  config_dict     
-000131b0: 2020 2064 6963 7420 2020 2020 2020 2070     dict        p
-000131c0: 6172 616d 7320 636f 6e66 6967 2064 6963  arams config dic
-000131d0: 7469 6f6e 6e61 7279 2020 0d0a 2020 2020  tionnary  ..    
-000131e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000131f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013200: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
-00013210: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-00013220: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-00013230: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013240: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013250: 3d0d 0a20 2020 200d 0a20 2020 204d 6f72  =..    ..    Mor
-00013260: 6520 6174 7472 6962 7574 6573 2063 616e  e attributes can
-00013270: 2062 6520 6164 6465 6420 6279 2069 6e70   be added by inp
-00013280: 7574 696e 6720 6120 6b65 7920 776f 7264  uting a key word
-00013290: 2064 6963 7469 6f6e 6172 790d 0a20 2020   dictionary..   
-000132a0: 2020 0d0a 2020 2020 3a45 7861 6d70 6c65    ..    :Example
-000132b0: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
-000132c0: 2020 2020 203e 3e3e 2066 726f 6d20 7079       >>> from py
-000132d0: 6373 616d 742e 6666 2e63 6f72 6520 696d  csamt.ff.core im
-000132e0: 706f 7274 2041 7667 0d0a 2020 2020 2020  port Avg..      
-000132f0: 2020 3e3e 3e20 7061 7468 3d20 6f73 2e70    >>> path= os.p
-00013300: 6174 682e 6a6f 696e 286f 732e 656e 7669  ath.join(os.envi
-00013310: 726f 6e5b 2770 7943 5341 4d54 275d 2c20  ron['pyCSAMT'], 
-00013320: 0d0a 2020 2020 2020 2020 2e2e 2e20 2020  ..        ...   
-00013330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013340: 2020 2020 2020 2770 7963 7361 6d74 272c        'pycsamt',
-00013350: 2064 6174 612c 2027 4c43 5330 312e 4156   data, 'LCS01.AV
-00013360: 4727 290d 0a20 2020 2020 2020 203e 3e3e  G')..        >>>
-00013370: 2061 7667 5f6f 626a 3d20 4176 6728 6461   avg_obj= Avg(da
-00013380: 7461 5f66 6e3d 7061 7468 2920 0d0a 2020  ta_fn=path) ..  
-00013390: 2020 2020 2020 3e3e 3e20 6176 675f 6f62        >>> avg_ob
-000133a0: 6a2e 4865 6164 6572 2e54 782e 7478 4764  j.Header.Tx.txGd
-000133b0: 7053 746e 0d0a 2020 2020 2020 2020 3e3e  pStn..        >>
-000133c0: 3e20 6176 675f 6f62 6a2e 4865 6164 6572  > avg_obj.Header
-000133d0: 2e54 782e 7478 5374 6e0d 0a20 2020 2020  .Tx.txStn..     
-000133e0: 2020 203e 3e3e 2061 7667 5f6f 626a 2e48     >>> avg_obj.H
-000133f0: 6561 6465 722e 5478 2e73 636f 6e66 6967  eader.Tx.sconfig
-00013400: 5f64 6963 745b 2754 782e 5479 7065 275d  _dict['Tx.Type']
-00013410: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00013420: 2022 2222 0d0a 2020 2020 6465 6620 5f5f   """..    def __
-00013430: 696e 6974 5f5f 2873 656c 662c 202a 2a6b  init__(self, **k
-00013440: 7761 7267 7329 3a0d 0a0d 0a20 2020 200d  wargs):....    .
-00013450: 0a20 2020 2020 2020 2073 656c 662e 7478  .        self.tx
-00013460: 5479 7065 203d 274e 5341 4d54 202f 4353  Type ='NSAMT /CS
-00013470: 414d 543a 204e 6174 7572 616c 2c20 4269  AMT: Natural, Bi
-00013480: 706f 6c65 2c4c 6f6f 7027 200d 0a20 2020  pole,Loop' ..   
-00013490: 2020 2020 2073 656c 662e 7478 4764 7053       self.txGdpS
-000134a0: 746e 203d 2758 4d54 5220 2720 0d0a 2020  tn ='XMTR ' ..  
-000134b0: 2020 2020 2020 7365 6c66 2e74 7853 746e        self.txStn
-000134c0: 3d27 5478 2049 4427 200d 0a20 2020 2020  ='Tx ID' ..     
-000134d0: 2020 2073 656c 662e 7478 4365 6e74 6572     self.txCenter
-000134e0: 3d27 5478 4358 2c20 5478 4359 2720 0d0a  ='TxCX, TxCY' ..
-000134f0: 2020 2020 2020 2020 7365 6c66 2e74 7848          self.txH
-00013500: 5052 3d27 6269 706f 6c65 2061 7a69 6d75  PR='bipole azimu
-00013510: 7468 2c20 7069 7463 683d 302c 2072 6f6c  th, pitch=0, rol
-00013520: 6c3d 3020 666f 7220 7a2b 7570 206f 7220  l=0 for z+up or 
-00013530: 3138 3020 666f 7220 7a20 706f 7369 7469  180 for z positi
-00013540: 7665 2064 6f77 6e27 200d 0a20 2020 2020  ve down' ..     
-00013550: 2020 2073 656c 662e 7478 4c65 6e67 7468     self.txLength
-00013560: 3d27 706f 7369 7469 7665 2066 6c6f 6174  ='positive float
-00013570: 2c20 6c65 6e67 7468 2075 6e69 7473 270d  , length units'.
-00013580: 0a20 2020 2020 2020 200d 0a0d 0a20 2020  .        ....   
-00013590: 2020 2020 200d 0a20 2020 2020 2020 2066       ..        f
-000135a0: 6f72 206b 6579 7320 696e 206c 6973 7428  or keys in list(
-000135b0: 6b77 6172 6773 2e6b 6579 7328 2929 3a0d  kwargs.keys()):.
-000135c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000135d0: 6b65 7973 206e 6f74 2069 6e20 5472 616e  keys not in Tran
-000135e0: 736d 6974 7465 7250 726f 7065 7274 6965  smitterPropertie
-000135f0: 732e 5f5f 6469 6374 5f5f 2e6b 6579 7328  s.__dict__.keys(
-00013600: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00013610: 2020 2020 7365 6c66 2e5f 5f73 6574 6174      self.__setat
-00013620: 7472 5f5f 286b 6579 732c 206b 7761 7267  tr__(keys, kwarg
-00013630: 735b 6b65 7973 5d29 0d0a 2020 2020 2020  s[keys])..      
-00013640: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00013650: 636f 6e66 6967 5f64 6963 742e 5f5f 7365  config_dict.__se
-00013660: 7469 7465 6d5f 5f28 6b65 7973 2c20 6b77  titem__(keys, kw
-00013670: 6172 6773 5b6b 6579 735d 2920 0d0a 2020  args[keys]) ..  
-00013680: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-00013690: 2020 2020 6465 6620 7365 745f 7472 616e      def set_tran
-000136a0: 736d 6974 7465 725f 7072 6f70 6572 7469  smitter_properti
-000136b0: 6573 2873 656c 662c 2054 785f 6461 7461  es(self, Tx_data
-000136c0: 203d 4e6f 6e65 293a 0d0a 2020 2020 2020   =None):..      
-000136d0: 2020 2222 220d 0a20 2020 2020 2020 204d    """..        M
-000136e0: 6574 686f 6420 746f 2073 6574 5f54 785f  ethod to set_Tx_
-000136f0: 7072 6f70 6572 7469 6573 2e0d 0a20 2020  properties...   
-00013700: 2020 2020 200d 0a20 2020 2020 2020 203a       ..        :
-00013710: 7061 7261 6d20 7478 5f64 6174 613a 206c  param tx_data: l
-00013720: 6973 7420 6f66 2054 782d 696e 666f 7320  ist of Tx-infos 
-00013730: 6672 6f6d 2041 5647 2066 696c 656e 616d  from AVG filenam
-00013740: 6520 0d0a 2020 2020 2020 2020 3a74 7970  e ..        :typ
-00013750: 6520 7478 5f64 6174 613a 6c69 7374 200d  e tx_data:list .
-00013760: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00013770: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00013780: 0d0a 2020 2020 2020 2020 6966 2054 785f  ..        if Tx_
-00013790: 6461 7461 2069 7320 4e6f 6e65 203a 200d  data is None : .
-000137a0: 0a20 2020 2020 2020 2020 2020 2043 5365  .            CSe
-000137b0: 782e 7079 4353 414d 5445 7272 6f72 5f69  x.pyCSAMTError_i
-000137c0: 6e70 7574 6172 6775 6d65 6e74 7328 274e  nputarguments('N
-000137d0: 6f20 5478 2d70 726f 7072 6572 7469 6573  o Tx-proprerties
-000137e0: 2066 6f75 6e64 2021 2729 0d0a 2020 2020   found !')..    
-000137f0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-00013800: 2054 785f 6461 7461 2069 7320 6e6f 7420   Tx_data is not 
-00013810: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
-00013820: 2020 2020 2066 6f72 2074 785f 696e 666f       for tx_info
-00013830: 7320 696e 2054 785f 6461 7461 203a 200d  s in Tx_data : .
-00013840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013850: 2069 6620 2724 2058 4d54 5227 2069 6e20   if '$ XMTR' in 
-00013860: 7478 5f69 6e66 6f73 206f 7220 2754 782e  tx_infos or 'Tx.
-00013870: 4764 7053 746e 2720 696e 2074 785f 696e  GdpStn' in tx_in
-00013880: 666f 733a 200d 0a20 2020 2020 2020 2020  fos: ..         
-00013890: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000138a0: 7478 4764 7053 746e 3d6e 702e 666c 6f61  txGdpStn=np.floa
-000138b0: 7428 7478 5f69 6e66 6f73 2e73 7472 6970  t(tx_infos.strip
-000138c0: 2829 2e73 706c 6974 2827 3d27 295b 2d31  ().split('=')[-1
-000138d0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-000138e0: 2020 2020 6966 2027 2454 782e 5374 6e27      if '$Tx.Stn'
-000138f0: 2069 6e20 7478 5f69 6e66 6f73 203a 200d   in tx_infos : .
-00013900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013910: 2020 2020 2073 656c 662e 7478 5374 6e20       self.txStn 
-00013920: 3d6e 702e 666c 6f61 7428 7478 5f69 6e66  =np.float(tx_inf
-00013930: 6f73 2e73 7472 6970 2829 2e73 706c 6974  os.strip().split
-00013940: 2827 3d27 295b 2d31 5d29 0d0a 2020 2020  ('=')[-1])..    
-00013950: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-00013960: 5478 2e54 7970 6527 2069 6e20 7478 5f69  Tx.Type' in tx_i
-00013970: 6e66 6f73 203a 0d0a 2020 2020 2020 2020  nfos :..        
-00013980: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00013990: 2e74 7854 7970 653d 2074 785f 696e 666f  .txType= tx_info
-000139a0: 732e 7374 7269 7028 292e 7370 6c69 7428  s.strip().split(
-000139b0: 273d 2729 5b2d 315d 0d0a 2020 2020 2020  '=')[-1]..      
-000139c0: 2020 2020 2020 2020 2020 6966 2027 5478            if 'Tx
-000139d0: 2e48 5052 2720 696e 2074 785f 696e 666f  .HPR' in tx_info
-000139e0: 7320 3a0d 0a20 2020 2020 2020 2020 2020  s :..           
-000139f0: 2020 2020 2020 2020 2073 656c 662e 7478           self.tx
-00013a00: 4850 523d 5b66 6c6f 6174 2873 7329 2066  HPR=[float(ss) f
-00013a10: 6f72 2073 7320 696e 200d 0a20 2020 2020  or ss in ..     
-00013a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a30: 2074 785f 696e 666f 732e 7374 7269 7028   tx_infos.strip(
-00013a40: 292e 7370 6c69 7428 273d 2729 5b2d 315d  ).split('=')[-1]
-00013a50: 2e73 706c 6974 2827 2c27 295d 0d0a 2020  .split(',')]..  
-00013a60: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00013a70: 2027 5478 2e4c 656e 6774 6827 696e 2074   'Tx.Length'in t
-00013a80: 785f 696e 666f 7320 3a20 0d0a 2020 2020  x_infos : ..    
-00013a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013aa0: 7365 6c66 2e74 784c 656e 6774 683d 666c  self.txLength=fl
-00013ab0: 6f61 7428 7478 5f69 6e66 6f73 2e73 7472  oat(tx_infos.str
-00013ac0: 6970 2829 2e73 706c 6974 2827 3d27 295b  ip().split('=')[
-00013ad0: 2d31 5d2e 7370 6c69 7428 295b 2d32 5d29  -1].split()[-2])
-00013ae0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b10: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00013b20: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00013b30: 2020 2020 2320 2d2d 3e20 7365 7420 636f      # --> set co
-00013b40: 6e66 6967 7572 6174 696f 6e20 2d64 6963  nfiguration -dic
-00013b50: 7469 6f6e 6e61 7279 2020 2020 2020 2020  tionnary        
-00013b60: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00013b70: 2073 656c 662e 7363 6f6e 6669 675f 6469   self.sconfig_di
-00013b80: 6374 3d7b 2754 782e 5479 7065 273a 7365  ct={'Tx.Type':se
-00013b90: 6c66 2e74 7854 7970 652c 200d 0a20 2020  lf.txType, ..   
-00013ba0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00013bb0: 5478 2e47 6470 5374 6e27 3a73 656c 662e  Tx.GdpStn':self.
-00013bc0: 7478 4764 7053 746e 2c20 0d0a 2020 2020  txGdpStn, ..    
-00013bd0: 2020 2020 2020 2020 2020 2020 2020 2754                'T
-00013be0: 782e 5374 6e27 3a73 656c 662e 7478 5374  x.Stn':self.txSt
-00013bf0: 6e2c 200d 0a20 2020 2020 2020 2020 2020  n, ..           
-00013c00: 2020 2020 2020 2027 5478 2e43 656e 7465         'Tx.Cente
-00013c10: 7227 3a73 656c 662e 7478 4365 6e74 6572  r':self.txCenter
-00013c20: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00013c30: 2020 2020 2020 2754 782e 4850 5227 3a20        'Tx.HPR': 
-00013c40: 7365 6c66 2e74 7848 5052 2c0d 0a20 2020  self.txHPR,..   
-00013c50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00013c60: 5478 2e4c 656e 6774 6827 3a73 656c 662e  Tx.Length':self.
-00013c70: 7478 4c65 6e67 7468 2c0d 0a20 2020 2020  txLength,..     
-00013c80: 2020 2020 2020 2020 207d 0d0a 2020 2020           }..    
-00013c90: 2020 2020 0d0a 636c 6173 7320 5265 6365      ..class Rece
-00013ca0: 6976 6572 5072 6f70 6572 7469 6573 286f  iverProperties(o
-00013cb0: 626a 6563 7429 3a0d 0a20 2020 200d 0a20  bject):..    .. 
-00013cc0: 2020 2022 2222 0d0a 2020 2020 436c 6173     """..    Clas
-00013cd0: 7320 666f 7220 7265 6365 6976 6572 2020  s for receiver  
-00013ce0: 7072 6f70 6572 7469 6573 2e0d 0a20 2020  properties...   
-00013cf0: 2020 200d 0a20 2020 2041 7267 756d 656e     ..    Argumen
-00013d00: 7473 200d 0a20 2020 202d 2d2d 2d2d 2d2d  ts ..    -------
-00013d10: 2d2d 2d20 0d0a 2020 2020 2020 2020 2a2a  --- ..        **
-00013d20: 5278 5f64 6174 612a 2a20 3a20 6c69 7374  Rx_data** : list
-00013d30: 206f 7220 7374 7220 0d0a 2020 2020 2020   or str ..      
-00013d40: 2020 2020 2020 2020 2020 2020 2020 4669                Fi
-00013d50: 6c6c 6564 2061 7574 6f6d 6174 6963 616c  lled automatical
-00013d60: 6c79 206f 7220 7061 7468 2074 6f20 796f  ly or path to yo
-00013d70: 7572 0d0a 2020 2020 2020 2020 2020 2020  ur..            
-00013d80: 2020 2020 2020 2020 7265 6365 6976 6572          receiver
-00013d90: 2070 726f 7065 7274 6965 7320 6669 6c65   properties file
-00013da0: 2e0d 0a0d 0a20 2020 203d 3d3d 3d3d 3d3d  .....    =======
-00013db0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-00013dc0: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-00013dd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013de0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013df0: 3d3d 3d3d 0d0a 2020 2020 4174 7472 6962  ====..    Attrib
-00013e00: 7574 6573 2020 2020 2020 2020 2054 7970  utes         Typ
-00013e10: 6520 2020 2020 2020 2045 7870 6c61 6e61  e        Explana
-00013e20: 7469 6f6e 0d0a 2020 2020 3d3d 3d3d 3d3d  tion..    ======
-00013e30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
-00013e40: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-00013e50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013e60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00013e70: 3d3d 3d3d 3d0d 0a20 2020 2072 7847 6470  =====..    rxGdp
-00013e80: 5374 6e20 2020 2020 2020 2020 2020 2073  Stn            s
-00013e90: 7472 2020 2020 2020 2020 2072 6563 6569  tr         recei
-00013ea0: 7665 7220 4744 5020 7374 6174 696f 6e20  ver GDP station 
-00013eb0: 6e75 6d62 6572 2028 616c 6961 7320 3d20  number (alias = 
-00013ec0: 5374 6174 696f 6e29 200d 0a20 2020 2072  Station) ..    r
-00013ed0: 7853 746e 2020 2020 2020 2020 2020 2020  xStn            
-00013ee0: 2020 2073 7472 2020 2020 2020 2020 2072     str         r
-00013ef0: 6563 6569 7665 7220 636c 6965 6e74 2073  eceiver client s
-00013f00: 7461 7469 6f6e 206e 756d 6265 720d 0a20  tation number.. 
-00013f10: 2020 2072 7848 5052 2020 2020 2020 2020     rxHPR        
-00013f20: 2020 2020 2020 2069 6e74 2020 2020 2020         int      
-00013f30: 2020 2045 4d20 636f 6d70 6f6e 656e 7420     EM component 
-00013f40: 6865 6164 696e 672c 2070 6974 6368 2c20  heading, pitch, 
-00013f50: 726f 6c6c 200d 0a20 2020 2020 2020 2020  roll ..         
-00013f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f70: 2020 2020 2020 2020 2020 2028 666c 6f61             (floa
-00013f80: 7473 2c20 5278 2068 6561 6469 6e67 2020  ts, Rx heading  
-00013f90: 616c 6961 7320 3d20 5278 4272 672c 2045  alias = RxBrg, E
-00013fa0: 7841 7a6d 290d 0a20 2020 2020 2020 2020  xAzm)..         
+00012fe0: 2020 2020 200d 0a20 2020 203d 3d3d 3d3d       ..    =====
+00012ff0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
+00013000: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
+00013010: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00013020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00013030: 3d3d 3d3d 3d3d 0d0a 2020 2020 0d0a 2020  ======..    ..  
+00013040: 2020 4d6f 7265 2061 7474 7269 6275 7465    More attribute
+00013050: 7320 6361 6e20 6265 2061 6464 6564 2062  s can be added b
+00013060: 7920 696e 7075 7469 6e67 2061 206b 6579  y inputing a key
+00013070: 2077 6f72 6420 6469 6374 696f 6e61 7279   word dictionary
+00013080: 0d0a 2020 2020 200d 0a20 2020 203a 4578  ..     ..    :Ex
+00013090: 616d 706c 653a 0d0a 2020 2020 2020 2020  ample:..        
+000130a0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+000130b0: 6f6d 2070 7963 7361 6d74 2e63 6f72 6520  om pycsamt.core 
+000130c0: 696d 706f 7274 2041 7667 0d0a 2020 2020  import Avg..    
+000130d0: 2020 2020 3e3e 3e20 7061 7468 3d20 6f73      >>> path= os
+000130e0: 2e70 6174 682e 6a6f 696e 286f 732e 656e  .path.join(os.en
+000130f0: 7669 726f 6e5b 2770 7943 5341 4d54 275d  viron['pyCSAMT']
+00013100: 2c20 0d0a 2020 2020 2020 2020 2e2e 2e20  , ..        ... 
+00013110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013120: 2020 2020 2020 2020 2770 7963 7361 6d74          'pycsamt
+00013130: 272c 2064 6174 612c 2027 4c43 5330 312e  ', data, 'LCS01.
+00013140: 4156 4727 290d 0a20 2020 2020 2020 203e  AVG')..        >
+00013150: 3e3e 2061 7667 5f6f 626a 3d20 4176 6728  >> avg_obj= Avg(
+00013160: 6461 7461 5f66 6e3d 7061 7468 2920 0d0a  data_fn=path) ..
+00013170: 2020 2020 2020 2020 3e3e 3e20 6176 675f          >>> avg_
+00013180: 6f62 6a2e 4865 6164 6572 2e54 782e 7478  obj.Header.Tx.tx
+00013190: 4764 7053 746e 0d0a 2020 2020 2020 2020  GdpStn..        
+000131a0: 3e3e 3e20 6176 675f 6f62 6a2e 4865 6164  >>> avg_obj.Head
+000131b0: 6572 2e54 782e 7478 5374 6e0d 0a20 2020  er.Tx.txStn..   
+000131c0: 2020 2020 203e 3e3e 2061 7667 5f6f 626a       >>> avg_obj
+000131d0: 2e48 6561 6465 722e 5478 2e73 636f 6e66  .Header.Tx.sconf
+000131e0: 6967 5f64 6963 745b 2754 782e 5479 7065  ig_dict['Tx.Type
+000131f0: 275d 0d0a 2020 2020 2020 2020 0d0a 2020  ']..        ..  
+00013200: 2020 2022 2222 0d0a 2020 2020 6465 6620     """..    def 
+00013210: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
+00013220: 2a6b 7761 7267 7329 3a0d 0a0d 0a20 2020  *kwargs):....   
+00013230: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00013240: 7478 5479 7065 203d 274e 5341 4d54 202f  txType ='NSAMT /
+00013250: 4353 414d 543a 204e 6174 7572 616c 2c20  CSAMT: Natural, 
+00013260: 4269 706f 6c65 2c4c 6f6f 7027 200d 0a20  Bipole,Loop' .. 
+00013270: 2020 2020 2020 2073 656c 662e 7478 4764         self.txGd
+00013280: 7053 746e 203d 2758 4d54 5220 2720 0d0a  pStn ='XMTR ' ..
+00013290: 2020 2020 2020 2020 7365 6c66 2e74 7853          self.txS
+000132a0: 746e 3d27 5478 2049 4427 200d 0a20 2020  tn='Tx ID' ..   
+000132b0: 2020 2020 2073 656c 662e 7478 4365 6e74       self.txCent
+000132c0: 6572 3d27 5478 4358 2c20 5478 4359 2720  er='TxCX, TxCY' 
+000132d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+000132e0: 7848 5052 3d27 6269 706f 6c65 2061 7a69  xHPR='bipole azi
+000132f0: 6d75 7468 2c20 7069 7463 683d 302c 2072  muth, pitch=0, r
+00013300: 6f6c 6c3d 3020 666f 7220 7a2b 7570 206f  oll=0 for z+up o
+00013310: 7220 3138 3020 666f 7220 7a20 706f 7369  r 180 for z posi
+00013320: 7469 7665 2064 6f77 6e27 200d 0a20 2020  tive down' ..   
+00013330: 2020 2020 2073 656c 662e 7478 4c65 6e67       self.txLeng
+00013340: 7468 3d27 706f 7369 7469 7665 2066 6c6f  th='positive flo
+00013350: 6174 2c20 6c65 6e67 7468 2075 6e69 7473  at, length units
+00013360: 270d 0a20 2020 2020 2020 200d 0a0d 0a20  '..        .... 
+00013370: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00013380: 2066 6f72 206b 6579 7320 696e 206c 6973   for keys in lis
+00013390: 7428 6b77 6172 6773 2e6b 6579 7328 2929  t(kwargs.keys())
+000133a0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+000133b0: 6620 6b65 7973 206e 6f74 2069 6e20 5472  f keys not in Tr
+000133c0: 616e 736d 6974 7465 7250 726f 7065 7274  ansmitterPropert
+000133d0: 6965 732e 5f5f 6469 6374 5f5f 2e6b 6579  ies.__dict__.key
+000133e0: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
+000133f0: 2020 2020 2020 7365 6c66 2e5f 5f73 6574        self.__set
+00013400: 6174 7472 5f5f 286b 6579 732c 206b 7761  attr__(keys, kwa
+00013410: 7267 735b 6b65 7973 5d29 0d0a 2020 2020  rgs[keys])..    
+00013420: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00013430: 2e73 636f 6e66 6967 5f64 6963 742e 5f5f  .sconfig_dict.__
+00013440: 7365 7469 7465 6d5f 5f28 6b65 7973 2c20  setitem__(keys, 
+00013450: 6b77 6172 6773 5b6b 6579 735d 2920 0d0a  kwargs[keys]) ..
+00013460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013470: 0d0a 2020 2020 6465 6620 7365 745f 7472  ..    def set_tr
+00013480: 616e 736d 6974 7465 725f 7072 6f70 6572  ansmitter_proper
+00013490: 7469 6573 2873 656c 662c 2054 785f 6461  ties(self, Tx_da
+000134a0: 7461 203d 4e6f 6e65 293a 0d0a 2020 2020  ta =None):..    
+000134b0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+000134c0: 204d 6574 686f 6420 746f 2073 6574 5f54   Method to set_T
+000134d0: 785f 7072 6f70 6572 7469 6573 2e0d 0a20  x_properties... 
+000134e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000134f0: 203a 7061 7261 6d20 7478 5f64 6174 613a   :param tx_data:
+00013500: 206c 6973 7420 6f66 2054 782d 696e 666f   list of Tx-info
+00013510: 7320 6672 6f6d 2041 5647 2066 696c 656e  s from AVG filen
+00013520: 616d 6520 0d0a 2020 2020 2020 2020 3a74  ame ..        :t
+00013530: 7970 6520 7478 5f64 6174 613a 6c69 7374  ype tx_data:list
+00013540: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00013550: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00013560: 2020 0d0a 2020 2020 2020 2020 6966 2054    ..        if T
+00013570: 785f 6461 7461 2069 7320 4e6f 6e65 203a  x_data is None :
+00013580: 200d 0a20 2020 2020 2020 2020 2020 2054   ..            T
+00013590: 7970 6545 7272 6f72 2827 4e6f 2054 782d  ypeError('No Tx-
+000135a0: 7072 6f70 7265 7274 6965 7320 666f 756e  proprerties foun
+000135b0: 6420 2127 290d 0a20 2020 2020 2020 200d  d !')..        .
+000135c0: 0a20 2020 2020 2020 2069 6620 5478 5f64  .        if Tx_d
+000135d0: 6174 6120 6973 206e 6f74 204e 6f6e 6520  ata is not None 
+000135e0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000135f0: 666f 7220 7478 5f69 6e66 6f73 2069 6e20  for tx_infos in 
+00013600: 5478 5f64 6174 6120 3a20 0d0a 2020 2020  Tx_data : ..    
+00013610: 2020 2020 2020 2020 2020 2020 6966 2027              if '
+00013620: 2420 584d 5452 2720 696e 2074 785f 696e  $ XMTR' in tx_in
+00013630: 666f 7320 6f72 2027 5478 2e47 6470 5374  fos or 'Tx.GdpSt
+00013640: 6e27 2069 6e20 7478 5f69 6e66 6f73 3a20  n' in tx_infos: 
+00013650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013660: 2020 2020 2020 7365 6c66 2e74 7847 6470        self.txGdp
+00013670: 5374 6e3d 6e70 2e66 6c6f 6174 2874 785f  Stn=np.float(tx_
+00013680: 696e 666f 732e 7374 7269 7028 292e 7370  infos.strip().sp
+00013690: 6c69 7428 273d 2729 5b2d 315d 290d 0a20  lit('=')[-1]).. 
+000136a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000136b0: 6620 2724 5478 2e53 746e 2720 696e 2074  f '$Tx.Stn' in t
+000136c0: 785f 696e 666f 7320 3a20 0d0a 2020 2020  x_infos : ..    
+000136d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136e0: 7365 6c66 2e74 7853 746e 203d 6e70 2e66  self.txStn =np.f
+000136f0: 6c6f 6174 2874 785f 696e 666f 732e 7374  loat(tx_infos.st
+00013700: 7269 7028 292e 7370 6c69 7428 273d 2729  rip().split('=')
+00013710: 5b2d 315d 290d 0a20 2020 2020 2020 2020  [-1])..         
+00013720: 2020 2020 2020 2069 6620 2754 782e 5479         if 'Tx.Ty
+00013730: 7065 2720 696e 2074 785f 696e 666f 7320  pe' in tx_infos 
+00013740: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00013750: 2020 2020 2020 2073 656c 662e 7478 5479         self.txTy
+00013760: 7065 3d20 7478 5f69 6e66 6f73 2e73 7472  pe= tx_infos.str
+00013770: 6970 2829 2e73 706c 6974 2827 3d27 295b  ip().split('=')[
+00013780: 2d31 5d0d 0a20 2020 2020 2020 2020 2020  -1]..           
+00013790: 2020 2020 2069 6620 2754 782e 4850 5227       if 'Tx.HPR'
+000137a0: 2069 6e20 7478 5f69 6e66 6f73 203a 0d0a   in tx_infos :..
+000137b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000137c0: 2020 2020 7365 6c66 2e74 7848 5052 3d5b      self.txHPR=[
+000137d0: 666c 6f61 7428 7373 2920 666f 7220 7373  float(ss) for ss
+000137e0: 2069 6e20 0d0a 2020 2020 2020 2020 2020   in ..          
+000137f0: 2020 2020 2020 2020 2020 2020 7478 5f69              tx_i
+00013800: 6e66 6f73 2e73 7472 6970 2829 2e73 706c  nfos.strip().spl
+00013810: 6974 2827 3d27 295b 2d31 5d2e 7370 6c69  it('=')[-1].spli
+00013820: 7428 272c 2729 5d0d 0a20 2020 2020 2020  t(',')]..       
+00013830: 2020 2020 2020 2020 2069 6620 2754 782e           if 'Tx.
+00013840: 4c65 6e67 7468 2769 6e20 7478 5f69 6e66  Length'in tx_inf
+00013850: 6f73 203a 200d 0a20 2020 2020 2020 2020  os : ..         
+00013860: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00013870: 7478 4c65 6e67 7468 3d66 6c6f 6174 2874  txLength=float(t
+00013880: 785f 696e 666f 732e 7374 7269 7028 292e  x_infos.strip().
+00013890: 7370 6c69 7428 273d 2729 5b2d 315d 2e73  split('=')[-1].s
+000138a0: 706c 6974 2829 5b2d 325d 290d 0a20 2020  plit()[-2])..   
+000138b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138e0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000138f0: 2020 2020 0d0a 2020 2020 2020 2020 2023      ..         #
+00013900: 202d 2d3e 2073 6574 2063 6f6e 6669 6775   --> set configu
+00013910: 7261 7469 6f6e 202d 6469 6374 696f 6e6e  ration -dictionn
+00013920: 6172 7920 2020 2020 2020 2020 2020 2020  ary             
+00013930: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+00013940: 2e73 636f 6e66 6967 5f64 6963 743d 7b27  .sconfig_dict={'
+00013950: 5478 2e54 7970 6527 3a73 656c 662e 7478  Tx.Type':self.tx
+00013960: 5479 7065 2c20 0d0a 2020 2020 2020 2020  Type, ..        
+00013970: 2020 2020 2020 2020 2020 2754 782e 4764            'Tx.Gd
+00013980: 7053 746e 273a 7365 6c66 2e74 7847 6470  pStn':self.txGdp
+00013990: 5374 6e2c 200d 0a20 2020 2020 2020 2020  Stn, ..         
+000139a0: 2020 2020 2020 2020 2027 5478 2e53 746e           'Tx.Stn
+000139b0: 273a 7365 6c66 2e74 7853 746e 2c20 0d0a  ':self.txStn, ..
+000139c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139d0: 2020 2754 782e 4365 6e74 6572 273a 7365    'Tx.Center':se
+000139e0: 6c66 2e74 7843 656e 7465 722c 200d 0a20  lf.txCenter, .. 
+000139f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a00: 2027 5478 2e48 5052 273a 2073 656c 662e   'Tx.HPR': self.
+00013a10: 7478 4850 522c 0d0a 2020 2020 2020 2020  txHPR,..        
+00013a20: 2020 2020 2020 2020 2020 2754 782e 4c65            'Tx.Le
+00013a30: 6e67 7468 273a 7365 6c66 2e74 784c 656e  ngth':self.txLen
+00013a40: 6774 682c 0d0a 2020 2020 2020 2020 2020  gth,..          
+00013a50: 2020 2020 7d0d 0a20 2020 2020 2020 200d      }..        .
+00013a60: 0a63 6c61 7373 2052 6563 6569 7665 7250  .class ReceiverP
+00013a70: 726f 7065 7274 6965 7328 6f62 6a65 6374  roperties(object
+00013a80: 293a 0d0a 2020 2020 0d0a 2020 2020 2222  ):..    ..    ""
+00013a90: 220d 0a20 2020 2043 6c61 7373 2066 6f72  "..    Class for
+00013aa0: 2072 6563 6569 7665 7220 2070 726f 7065   receiver  prope
+00013ab0: 7274 6965 732e 0d0a 2020 2020 2020 0d0a  rties...      ..
+00013ac0: 2020 2020 4172 6775 6d65 6e74 7320 0d0a      Arguments ..
+00013ad0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 200d      ---------- .
+00013ae0: 0a20 2020 2020 2020 202a 2a52 785f 6461  .        **Rx_da
+00013af0: 7461 2a2a 203a 206c 6973 7420 6f72 2073  ta** : list or s
+00013b00: 7472 200d 0a20 2020 2020 2020 2020 2020  tr ..           
+00013b10: 2020 2020 2020 2020 2046 696c 6c65 6420           Filled 
+00013b20: 6175 746f 6d61 7469 6361 6c6c 7920 6f72  automatically or
+00013b30: 2070 6174 6820 746f 2079 6f75 720d 0a20   path to your.. 
+00013b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b50: 2020 2072 6563 6569 7665 7220 7072 6f70     receiver prop
+00013b60: 6572 7469 6573 2066 696c 652e 0d0a 0d0a  erties file.....
+00013b70: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
+00013b80: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00013b90: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
+00013ba0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00013bb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+00013bc0: 0a20 2020 2041 7474 7269 6275 7465 7320  .    Attributes 
+00013bd0: 2020 2020 2020 2020 5479 7065 2020 2020          Type    
+00013be0: 2020 2020 4578 706c 616e 6174 696f 6e0d      Explanation.
+00013bf0: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+00013c00: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+00013c10: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+00013c20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00013c30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00013c40: 0d0a 2020 2020 7278 4764 7053 746e 2020  ..    rxGdpStn  
+00013c50: 2020 2020 2020 2020 2020 7374 7220 2020            str   
+00013c60: 2020 2020 2020 7265 6365 6976 6572 2047        receiver G
+00013c70: 4450 2073 7461 7469 6f6e 206e 756d 6265  DP station numbe
+00013c80: 7220 2861 6c69 6173 203d 2053 7461 7469  r (alias = Stati
+00013c90: 6f6e 2920 0d0a 2020 2020 7278 5374 6e20  on) ..    rxStn 
+00013ca0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00013cb0: 7220 2020 2020 2020 2020 7265 6365 6976  r         receiv
+00013cc0: 6572 2063 6c69 656e 7420 7374 6174 696f  er client statio
+00013cd0: 6e20 6e75 6d62 6572 0d0a 2020 2020 7278  n number..    rx
+00013ce0: 4850 5220 2020 2020 2020 2020 2020 2020  HPR             
+00013cf0: 2020 696e 7420 2020 2020 2020 2020 454d    int         EM
+00013d00: 2063 6f6d 706f 6e65 6e74 2068 6561 6469   component headi
+00013d10: 6e67 2c20 7069 7463 682c 2072 6f6c 6c20  ng, pitch, roll 
+00013d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d40: 2020 2020 2020 2866 6c6f 6174 732c 2052        (floats, R
+00013d50: 7820 6865 6164 696e 6720 2061 6c69 6173  x heading  alias
+00013d60: 203d 2052 7842 7267 2c20 4578 417a 6d29   = RxBrg, ExAzm)
+00013d70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d90: 2020 2020 2020 2868 6561 6469 6e67 203d        (heading =
+00013da0: 2078 2063 6f6d 706f 6e65 6e74 2061 7a69   x component azi
+00013db0: 6d75 7468 2069 6e20 6465 6772 6565 7320  muth in degrees 
+00013dc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013de0: 2020 2020 2020 6561 7374 206f 6620 6e6f        east of no
+00013df0: 7274 682c 2070 6974 6368 203d 2078 2020  rth, pitch = x  
+00013e00: 636f 6d70 6f6e 656e 740d 0a20 2020 2020  component..     
+00013e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e20: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00013e30: 7269 656e 7461 7469 6f6e 2069 6e20 6465  rientation in de
+00013e40: 6772 6565 732e 2020 7570 2066 726f 6d20  grees.  up from 
+00013e50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e70: 2020 2020 2020 686f 7269 7a6f 6e74 616c        horizontal
+00013e80: 2c20 7069 7463 6820 3d20 7a20 636d 7020  , pitch = z cmp 
+00013e90: 2072 6f74 6174 696f 6e20 6162 6f75 7420   rotation about 
+00013ea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ec0: 2020 2020 2020 7820 636d 702c 2020 303d        x cmp,  0=
+00013ed0: 7a2b 7570 2c20 3138 3020 3d20 7a2b 2064  z+up, 180 = z+ d
+00013ee0: 6f77 6e29 0d0a 2020 2020 7278 4c65 6e67  own)..    rxLeng
+00013ef0: 7468 2020 2020 2020 2020 2020 2020 7374  th            st
+00013f00: 7220 2020 2020 2020 2020 452d 6669 656c  r         E-fiel
+00013f10: 6420 6469 706f 6c65 206c 656e 6774 6820  d dipole length 
+00013f20: 6f72 2020 6c6f 6f70 2077 6964 7468 7328  or  loop widths(
+00013f30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f50: 2020 2020 2020 706f 7369 7469 7665 2066        positive f
+00013f60: 6c6f 6174 2873 292c 6c65 6e67 7468 2075  loat(s),length u
+00013f70: 6e69 7473 2920 0d0a 2020 2020 2020 2020  nits) ..        
+00013f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f90: 2020 2020 2020 2020 2020 2020 2861 6c69              (ali
+00013fa0: 6173 203d 2061 7370 6163 6529 0d0a 2020  as = aspace)..  
 00013fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fc0: 2020 2020 2020 2020 2020 2028 6865 6164             (head
-00013fd0: 696e 6720 3d20 7820 636f 6d70 6f6e 656e  ing = x componen
-00013fe0: 7420 617a 696d 7574 6820 696e 2064 6567  t azimuth in deg
-00013ff0: 7265 6573 200d 0a20 2020 2020 2020 2020  rees ..         
-00014000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014010: 2020 2020 2020 2020 2020 2065 6173 7420             east 
-00014020: 6f66 206e 6f72 7468 2c20 7069 7463 6820  of north, pitch 
-00014030: 3d20 7820 2063 6f6d 706f 6e65 6e74 0d0a  = x  component..
-00014040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fd0: 2020 2870 6f73 6974 6976 6520 666c 6f61    (positive floa
+00013fe0: 742c 206c 656e 6774 6820 756e 6974 7329  t, length units)
+00013ff0: 0d0a 2020 2020 7278 436f 6d70 7320 2020  ..    rxComps   
+00014000: 2020 2020 2020 2020 2020 7374 7220 2020            str   
+00014010: 2020 2020 2020 454d 2063 6f6d 706f 6e65        EM compone
+00014020: 6e74 2f69 6d70 6564 616e 6365 206c 6162  nt/impedance lab
+00014030: 656c 2845 7848 782c 2045 7848 792c 200d  el(ExHx, ExHy, .
+00014040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00014050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014060: 2020 2020 6f72 6965 6e74 6174 696f 6e20      orientation 
-00014070: 696e 2064 6567 7265 6573 2e20 2075 7020  in degrees.  up 
-00014080: 6672 6f6d 200d 0a20 2020 2020 2020 2020  from ..         
-00014090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140a0: 2020 2020 2020 2020 2020 2068 6f72 697a             horiz
-000140b0: 6f6e 7461 6c2c 2070 6974 6368 203d 207a  ontal, pitch = z
-000140c0: 2063 6d70 2020 726f 7461 7469 6f6e 2061   cmp  rotation a
-000140d0: 626f 7574 200d 0a20 2020 2020 2020 2020  bout ..         
-000140e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140f0: 2020 2020 2020 2020 2020 2078 2063 6d70             x cmp
-00014100: 2c20 2030 3d7a 2b75 702c 2031 3830 203d  ,  0=z+up, 180 =
-00014110: 207a 2b20 646f 776e 290d 0a20 2020 2072   z+ down)..    r
-00014120: 784c 656e 6774 6820 2020 2020 2020 2020  xLength         
-00014130: 2020 2073 7472 2020 2020 2020 2020 2045     str         E
-00014140: 2d66 6965 6c64 2064 6970 6f6c 6520 6c65  -field dipole le
-00014150: 6e67 7468 206f 7220 206c 6f6f 7020 7769  ngth or  loop wi
-00014160: 6474 6873 280d 0a20 2020 2020 2020 2020  dths(..         
-00014170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014180: 2020 2020 2020 2020 2020 2070 6f73 6974             posit
-00014190: 6976 6520 666c 6f61 7428 7329 2c6c 656e  ive float(s),len
-000141a0: 6774 6820 756e 6974 7329 200d 0a20 2020  gth units) ..   
-000141b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141d0: 2028 616c 6961 7320 3d20 6173 7061 6365   (alias = aspace
-000141e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000141f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014200: 2020 2020 2020 2028 706f 7369 7469 7665         (positive
-00014210: 2066 6c6f 6174 2c20 6c65 6e67 7468 2075   float, length u
-00014220: 6e69 7473 290d 0a20 2020 2072 7843 6f6d  nits)..    rxCom
-00014230: 7073 2020 2020 2020 2020 2020 2020 2073  ps             s
-00014240: 7472 2020 2020 2020 2020 2045 4d20 636f  tr         EM co
-00014250: 6d70 6f6e 656e 742f 696d 7065 6461 6e63  mponent/impedanc
-00014260: 6520 6c61 6265 6c28 4578 4878 2c20 4578  e label(ExHx, Ex
-00014270: 4879 2c20 0d0a 2020 2020 2020 2020 2020  Hy, ..          
-00014280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014290: 2020 2020 2020 2020 2020 4579 4878 2c20            EyHx, 
-000142a0: 4579 4879 2c20 5a78 782c 205a 7879 2c20  EyHy, Zxx, Zxy, 
-000142b0: 5a79 782c 205a 7979 2c20 205a 7665 632c  Zyx, Zyy,  Zvec,
-000142c0: 205a 6465 7429 2020 200d 0a20 2020 2073   Zdet)   ..    s
-000142d0: 636f 6e66 6967 5f64 6963 7420 2020 2020  config_dict     
-000142e0: 2020 2064 6963 7420 2020 2020 2020 2070     dict        p
-000142f0: 6172 616d 6574 6572 7320 6469 6374 2063  arameters dict c
-00014300: 6f6e 6669 6720 2020 2020 2020 2020 2020  onfig           
-00014310: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
-00014320: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-00014330: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-00014340: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014350: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00014360: 3d3d 0d0a 2020 2020 2020 2020 200d 0a20  ==..         .. 
-00014370: 2020 204d 6f72 6520 6174 7472 6962 7574     More attribut
-00014380: 6573 2063 616e 2062 6520 6164 6465 6420  es can be added 
-00014390: 6279 2069 6e70 7574 696e 6720 6120 6b65  by inputing a ke
-000143a0: 7920 776f 7264 2064 6963 7469 6f6e 6172  y word dictionar
-000143b0: 790d 0a20 2020 2020 0d0a 2020 2020 3a45  y..     ..    :E
-000143c0: 7861 6d70 6c65 3a0d 0a20 2020 2020 2020  xample:..       
-000143d0: 2020 0d0a 2020 2020 2020 2020 3e3e 3e20    ..        >>> 
-000143e0: 6672 6f6d 2070 7963 7361 6d74 2e66 662e  from pycsamt.ff.
-000143f0: 636f 7265 2069 6d70 6f72 7420 4176 670d  core import Avg.
-00014400: 0a20 2020 2020 2020 203e 3e3e 2070 6174  .        >>> pat
-00014410: 683d 206f 732e 7061 7468 2e6a 6f69 6e28  h= os.path.join(
-00014420: 6f73 2e65 6e76 6972 6f6e 5b27 7079 4353  os.environ['pyCS
-00014430: 414d 5427 5d2c 200d 0a20 2020 2020 2020  AMT'], ..       
-00014440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014450: 2020 2020 2020 2020 2020 2770 7963 7361            'pycsa
-00014460: 6d74 272c 2064 6174 612c 2027 4c43 5330  mt', data, 'LCS0
-00014470: 312e 4156 4727 290d 0a20 2020 2020 2020  1.AVG')..       
-00014480: 203e 3e3e 2061 7667 5f6f 626a 3d20 4176   >>> avg_obj= Av
-00014490: 6728 6461 7461 5f66 6e3d 7061 7468 2920  g(data_fn=path) 
-000144a0: 0d0a 2020 2020 2020 2020 2e2e 2e20 6176  ..        ... av
-000144b0: 675f 6f62 6a2e 4865 6164 6572 2e52 782e  g_obj.Header.Rx.
-000144c0: 7478 4764 7053 746e 0d0a 2020 2020 2020  txGdpStn..      
-000144d0: 2020 2e2e 2e20 6176 675f 6f62 6a2e 4865    ... avg_obj.He
-000144e0: 6164 6572 2e52 782e 7478 5374 6e0d 0a20  ader.Rx.txStn.. 
-000144f0: 2020 2020 2020 202e 2e2e 2061 7667 5f6f         ... avg_o
-00014500: 626a 2e48 6561 6465 722e 5278 2e73 636f  bj.Header.Rx.sco
-00014510: 6e66 6967 5f64 6963 745b 2754 782e 4c65  nfig_dict['Tx.Le
-00014520: 6e67 7468 275d 0d0a 2020 2020 2022 2222  ngth']..     """
-00014530: 0d0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-00014540: 5f5f 2873 656c 662c 2052 785f 6461 7461  __(self, Rx_data
-00014550: 3d4e 6f6e 6520 2c20 202a 2a6b 7761 7267  =None ,  **kwarg
-00014560: 7329 3a0d 0a0d 0a20 2020 2020 2020 2073  s):....        s
-00014570: 656c 662e 7278 5f64 6174 6120 3d52 785f  elf.rx_data =Rx_
-00014580: 6461 7461 200d 0a20 2020 2020 2020 2073  data ..        s
-00014590: 656c 662e 7278 4764 7053 746e 203d 4e6f  elf.rxGdpStn =No
-000145a0: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
-000145b0: 662e 7278 5374 6e3d 4e6f 6e65 200d 0a20  f.rxStn=None .. 
-000145c0: 2020 2020 2020 2073 656c 662e 7278 4850         self.rxHP
-000145d0: 523d 4e6f 6e65 200d 0a20 2020 2020 2020  R=None ..       
-000145e0: 2073 656c 662e 7278 4c65 6e67 7468 3d4e   self.rxLength=N
-000145f0: 6f6e 650d 0a20 2020 2020 2020 2073 656c  one..        sel
-00014600: 662e 7278 436f 6d70 733d 2745 7848 7927  f.rxComps='ExHy'
-00014610: 0d0a 2020 2020 2020 2020 7365 6c66 2e75  ..        self.u
-00014620: 6e69 743d 4e6f 6e65 0d0a 2020 2020 2020  nit=None..      
-00014630: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00014640: 2e73 636f 6e66 6967 5f64 6963 743d 7b27  .sconfig_dict={'
-00014650: 5278 2e47 6470 5374 6e27 3a73 656c 662e  Rx.GdpStn':self.
-00014660: 7278 4764 7053 746e 2c20 0d0a 2020 2020  rxGdpStn, ..    
-00014670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014680: 2020 2020 2020 2752 782e 5374 6e27 3a73        'Rx.Stn':s
-00014690: 656c 662e 7278 5374 6e2c 200d 0a20 2020  elf.rxStn, ..   
-000146a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146b0: 2020 2020 2020 2027 5278 2e48 5052 273a         'Rx.HPR':
-000146c0: 7365 6c66 2e72 7848 5052 202c 200d 0a20  self.rxHPR , .. 
-000146d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146e0: 2020 2020 2020 2020 2027 5278 2e4c 656e           'Rx.Len
-000146f0: 6774 6827 3a20 7365 6c66 2e72 784c 656e  gth': self.rxLen
-00014700: 6774 682c 0d0a 2020 2020 2020 2020 2020  gth,..          
-00014710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014720: 2752 782e 436d 7027 3a73 656c 662e 7278  'Rx.Cmp':self.rx
-00014730: 436f 6d70 732c 0d0a 2020 2020 2020 2020  Comps,..        
-00014740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014750: 2020 7d0d 0a0d 0a0d 0a20 2020 2020 2020    }......       
-00014760: 2066 6f72 206b 6579 7320 696e 206c 6973   for keys in lis
-00014770: 7428 6b77 6172 6773 2e6b 6579 7328 2929  t(kwargs.keys())
-00014780: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00014790: 6620 6b65 7973 206e 6f74 2069 6e20 5265  f keys not in Re
-000147a0: 6365 6976 6572 5072 6f70 6572 7469 6573  ceiverProperties
-000147b0: 2e5f 5f64 6963 745f 5f2e 6b65 7973 2829  .__dict__.keys()
-000147c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000147d0: 2020 2073 656c 662e 5f5f 7365 7461 7474     self.__setatt
-000147e0: 725f 5f28 6b65 7973 2c20 6b77 6172 6773  r__(keys, kwargs
-000147f0: 5b6b 6579 735d 290d 0a20 2020 2020 2020  [keys])..       
-00014800: 2020 2020 2020 2020 2073 656c 662e 7363           self.sc
-00014810: 6f6e 6669 675f 6469 6374 2e5f 5f73 6574  onfig_dict.__set
-00014820: 6974 656d 5f5f 286b 6579 732c 206b 7761  item__(keys, kwa
-00014830: 7267 735b 6b65 7973 5d29 0d0a 2020 2020  rgs[keys])..    
-00014840: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00014850: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-00014860: 2020 2020 6465 6620 7365 745f 7265 6365      def set_rece
-00014870: 6976 6572 5f70 726f 7065 7274 6965 7328  iver_properties(
-00014880: 7365 6c66 2c20 5278 5f64 6174 6120 3d4e  self, Rx_data =N
-00014890: 6f6e 6520 293a 0d0a 2020 2020 2020 2020  one ):..        
-000148a0: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
-000148b0: 686f 6473 2020 746f 2073 6574 2052 6563  hods  to set Rec
-000148c0: 6569 7665 7273 202d 2070 726f 7065 7274  eivers - propert
-000148d0: 6965 7320 696e 666f 7320 6672 6f6d 2041  ies infos from A
-000148e0: 5647 2066 696c 6573 2e20 0d0a 0d0a 2020  VG files. ....  
-000148f0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00014900: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00014910: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2a20  ----..        * 
-00014920: 5278 5f64 6174 6120 3a20 6c69 7374 2c20  Rx_data : list, 
-00014930: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-00014940: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00014950: 6e74 6169 6e65 7220 696e 666f 7320 6f66  ntainer infos of
-00014960: 2072 6563 6569 7665 7273 2e20 5468 6520   receivers. The 
-00014970: 6465 6661 756c 7420 6973 204e 6f6e 652e  default is None.
-00014980: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00014990: 2020 2020 2020 2069 6620 5278 5f64 6174         if Rx_dat
-000149a0: 6120 6973 206e 6f74 204e 6f6e 6520 3a20  a is not None : 
-000149b0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-000149c0: 6c66 2e72 785f 6461 7461 203d 2052 785f  lf.rx_data = Rx_
-000149d0: 6461 7461 0d0a 2020 2020 2020 2020 0d0a  data..        ..
-000149e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000149f0: 7278 5f64 6174 6120 6973 204e 6f6e 6520  rx_data is None 
-00014a00: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00014a10: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00014a20: 725f 696e 7075 7461 7267 756d 656e 7473  r_inputarguments
-00014a30: 2827 4e6f 205a 6f6e 6765 2052 782d 7072  ('No Zonge Rx-pr
-00014a40: 6f70 7265 7274 6965 7320 666f 756e 6420  oprerties found 
-00014a50: 2127 290d 0a20 2020 2020 2020 2020 2020  !')..           
-00014a60: 200d 0a20 2020 2020 2020 2069 6620 7479   ..        if ty
-00014a70: 7065 2873 656c 662e 7278 5f64 6174 6129  pe(self.rx_data)
-00014a80: 2069 7320 6e6f 7420 6c69 7374 203a 0d0a   is not list :..
-00014a90: 2020 2020 2020 2020 2020 2020 7472 7920              try 
-00014aa0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00014ab0: 2020 2020 6966 206f 732e 7061 7468 2e69      if os.path.i
-00014ac0: 7366 696c 6528 7365 6c66 2e72 785f 6461  sfile(self.rx_da
-00014ad0: 7461 2920 3d3d 5472 7565 203a 200d 0a20  ta) ==True : .. 
-00014ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014af0: 2020 2077 6974 6820 6f70 656e 2873 656c     with open(sel
-00014b00: 662e 7278 5f64 6174 612c 2027 7227 2c20  f.rx_data, 'r', 
-00014b10: 656e 636f 6469 6e67 3d27 7574 662d 3827  encoding='utf-8'
-00014b20: 2920 6173 2066 7278 3a0d 0a20 2020 2020  ) as frx:..     
-00014b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b40: 2020 2073 656c 662e 7278 5f64 6174 6120     self.rx_data 
-00014b50: 3d66 7278 2e72 6561 646c 696e 6573 2829  =frx.readlines()
-00014b60: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-00014b70: 6365 7074 203a 2072 6169 7365 2043 5365  cept : raise CSe
-00014b80: 782e 7079 4353 414d 5445 7272 6f72 5f48  x.pyCSAMTError_H
-00014b90: 6561 6465 7228 0d0a 2020 2020 2020 2020  eader(..        
-00014ba0: 2020 2020 2020 2020 2020 2020 2741 7267              'Arg
-00014bb0: 756d 656e 7420 7072 6f76 6964 6564 2066  ument provided f
-00014bc0: 6f72 2072 785f 6461 7461 2061 7265 2077  or rx_data are w
-00014bd0: 726f 6e67 2021 270d 0a20 2020 2020 2020  rong !'..       
-00014be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014bf0: 2020 2020 2020 2020 2020 2027 204d 7573             ' Mus
-00014c00: 7420 6265 2061 206c 6973 7420 6f66 2066  t be a list of f
-00014c10: 696c 652e 2729 0d0a 2020 2020 2020 2020  ile.')..        
-00014c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c30: 0d0a 0d0a 2020 2020 2020 2020 666f 7220  ....        for 
-00014c40: 7278 5f69 6e66 6f73 2069 6e20 7365 6c66  rx_infos in self
-00014c50: 2e72 785f 6461 7461 203a 200d 0a20 2020  .rx_data : ..   
-00014c60: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00014c70: 2020 2020 2020 2069 6620 2724 5278 2e53         if '$Rx.S
-00014c80: 746e 2720 696e 2072 785f 696e 666f 7320  tn' in rx_infos 
-00014c90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00014ca0: 2020 2073 656c 662e 7278 5374 6e20 3d6e     self.rxStn =n
-00014cb0: 702e 666c 6f61 7428 7278 5f69 6e66 6f73  p.float(rx_infos
-00014cc0: 2e73 7472 6970 2829 2e73 706c 6974 2827  .strip().split('
-00014cd0: 3d27 295b 2d31 5d29 0d0a 2020 2020 2020  =')[-1])..      
-00014ce0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00014cf0: 2020 2020 2020 2020 6966 2027 5278 2e43          if 'Rx.C
-00014d00: 6d70 2720 696e 2072 785f 696e 666f 7320  mp' in rx_infos 
-00014d10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00014d20: 2020 2073 656c 662e 7278 436f 6d70 733d     self.rxComps=
-00014d30: 2072 785f 696e 666f 732e 7374 7269 7028   rx_infos.strip(
-00014d40: 292e 7370 6c69 7428 273d 2729 5b2d 315d  ).split('=')[-1]
-00014d50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014d60: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00014d70: 6966 2027 5278 2e48 5052 2720 696e 2072  if 'Rx.HPR' in r
-00014d80: 785f 696e 666f 7320 3a0d 0a20 2020 2020  x_infos :..     
-00014d90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00014da0: 7278 4850 523d 5b66 6c6f 6174 2873 7329  rxHPR=[float(ss)
-00014db0: 2066 6f72 2073 7320 696e 200d 0a20 2020   for ss in ..   
-00014dc0: 2020 2020 2020 2020 2020 2020 2020 7278                rx
-00014dd0: 5f69 6e66 6f73 2e73 7472 6970 2829 2e73  _infos.strip().s
-00014de0: 706c 6974 2827 3d27 295b 2d31 5d2e 7370  plit('=')[-1].sp
-00014df0: 6c69 7428 272c 2729 5d0d 0a20 2020 2020  lit(',')]..     
-00014e00: 2020 2020 2020 2069 6620 2827 2420 4153         if ('$ AS
-00014e10: 5041 4345 2720 696e 2072 785f 696e 666f  PACE' in rx_info
-00014e20: 7329 206f 7220 2028 2752 782e 4c65 6e67  s) or  ('Rx.Leng
-00014e30: 7468 2769 6e20 7278 5f69 6e66 6f73 2920  th'in rx_infos) 
-00014e40: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00014e50: 2020 2020 2020 2020 232d 2d20 6974 2073          #-- it s
-00014e60: 6565 6d73 2073 6f6d 6574 696d 6573 2066  eems sometimes f
-00014e70: 696c 6520 676f 7420 7468 6520 756e 6974  ile got the unit
-00014e80: 2061 7420 7468 6520 656e 6420 6569 7468   at the end eith
-00014e90: 6572 200d 0a20 2020 2020 2020 2020 2020  er ..           
-00014ea0: 2020 2020 2020 2020 2023 2027 6d27 206f           # 'm' o
-00014eb0: 7220 6674 2773 686f 756c 6420 7265 6d6f  r ft'should remo
-00014ec0: 7665 2069 7420 6265 666f 7265 2063 6f6e  ve it before con
-00014ed0: 7665 7274 696e 6720 6f6e 2066 6c6f 6174  verting on float
-00014ee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014ef0: 2020 7478 203d 2072 785f 696e 666f 732e    tx = rx_infos.
-00014f00: 7374 7269 7028 292e 7370 6c69 7428 273d  strip().split('=
-00014f10: 2729 5b2d 315d 0d0a 2020 2020 2020 2020  ')[-1]..        
-00014f20: 2020 2020 2020 2020 6966 206e 6f74 2034          if not 4
-00014f30: 3620 3c20 6f72 6428 7278 5f69 6e66 6f73  6 < ord(rx_infos
-00014f40: 2e73 7472 6970 2829 2e73 706c 6974 2827  .strip().split('
-00014f50: 3d27 295b 2d31 5d5b 2d31 5d29 203c 2035  =')[-1][-1]) < 5
-00014f60: 3820 3a20 200d 0a20 2020 2020 2020 2020  8 :  ..         
-00014f70: 2020 2020 2020 2020 2020 2074 7820 3d66             tx =f
-00014f80: 756e 632e 5f72 656d 6f76 655f 7374 725f  unc._remove_str_
-00014f90: 776f 7264 280d 0a20 2020 2020 2020 2020  word(..         
-00014fa0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00014fb0: 6861 723d 7478 2c77 6f72 645f 746f 5f72  har=tx,word_to_r
-00014fc0: 656d 6f76 653d 7278 5f69 6e66 6f73 2e73  emove=rx_infos.s
-00014fd0: 7472 6970 2829 2e73 706c 6974 2827 3d27  trip().split('='
-00014fe0: 295b 2d31 5d5b 2d31 5d2c 0d0a 2020 2020  )[-1][-1],..    
-00014ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015000: 2020 2020 2020 2020 2020 6465 6570 5f72            deep_r
-00015010: 656d 6f76 653d 4661 6c73 6529 0d0a 2020  emove=False)..  
-00015020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015030: 2020 7365 6c66 2e72 784c 656e 6774 6820    self.rxLength 
-00015040: 3d6e 702e 666c 6f61 7428 7478 290d 0a20  =np.float(tx).. 
-00015050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015060: 2020 2073 656c 662e 756e 6974 203d 2072     self.unit = r
-00015070: 785f 696e 666f 732e 7374 7269 7028 292e  x_infos.strip().
-00015080: 7370 6c69 7428 273d 2729 5b2d 315d 5b2d  split('=')[-1][-
-00015090: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-000150a0: 2020 2020 656c 7365 203a 7365 6c66 2e72      else :self.r
-000150b0: 784c 656e 6774 683d 6e70 2e66 6c6f 6174  xLength=np.float
-000150c0: 2874 7829 0d0a 200d 0a20 2020 2020 2020  (tx).. ..       
-000150d0: 2020 2020 2069 6620 2724 5278 2e47 6470       if '$Rx.Gdp
-000150e0: 5374 6e27 2069 6e20 7278 5f69 6e66 6f73  Stn' in rx_infos
-000150f0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00015100: 2020 2020 2073 656c 662e 7278 4764 7053       self.rxGdpS
-00015110: 746e 203d 6e70 2e66 6c6f 6174 2872 785f  tn =np.float(rx_
-00015120: 696e 666f 732e 7374 7269 7028 292e 7370  infos.strip().sp
-00015130: 6c69 7428 273d 2729 5b2d 315d 290d 0a20  lit('=')[-1]).. 
-00015140: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-00015150: 0a20 2020 2020 2020 2073 656c 662e 7363  .        self.sc
-00015160: 6f6e 6669 675f 6469 6374 3d7b 2752 782e  onfig_dict={'Rx.
-00015170: 4764 7053 746e 273a 7365 6c66 2e72 7847  GdpStn':self.rxG
-00015180: 6470 5374 6e2c 200d 0a20 2020 2020 2020  dpStn, ..       
+00014060: 2020 2020 2045 7948 782c 2045 7948 792c       EyHx, EyHy,
+00014070: 205a 7878 2c20 5a78 792c 205a 7978 2c20   Zxx, Zxy, Zyx, 
+00014080: 5a79 792c 2020 5a76 6563 2c20 5a64 6574  Zyy,  Zvec, Zdet
+00014090: 2920 2020 0d0a 2020 2020 7363 6f6e 6669  )   ..    sconfi
+000140a0: 675f 6469 6374 2020 2020 2020 2020 6469  g_dict        di
+000140b0: 6374 2020 2020 2020 2020 7061 7261 6d65  ct        parame
+000140c0: 7465 7273 2064 6963 7420 636f 6e66 6967  ters dict config
+000140d0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+000140e0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+000140f0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d20  ===  ========== 
+00014100: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00014110: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00014120: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
+00014130: 2020 2020 2020 2020 0d0a 2020 2020 4d6f          ..    Mo
+00014140: 7265 2061 7474 7269 6275 7465 7320 6361  re attributes ca
+00014150: 6e20 6265 2061 6464 6564 2062 7920 696e  n be added by in
+00014160: 7075 7469 6e67 2061 206b 6579 2077 6f72  puting a key wor
+00014170: 6420 6469 6374 696f 6e61 7279 0d0a 2020  d dictionary..  
+00014180: 2020 200d 0a20 2020 203a 4578 616d 706c     ..    :Exampl
+00014190: 653a 0d0a 2020 2020 2020 2020 200d 0a20  e:..         .. 
+000141a0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+000141b0: 7079 6373 616d 742e 636f 7265 2069 6d70  pycsamt.core imp
+000141c0: 6f72 7420 4176 670d 0a20 2020 2020 2020  ort Avg..       
+000141d0: 203e 3e3e 2070 6174 683d 206f 732e 7061   >>> path= os.pa
+000141e0: 7468 2e6a 6f69 6e28 6f73 2e65 6e76 6972  th.join(os.envir
+000141f0: 6f6e 5b27 7079 4353 414d 5427 5d2c 200d  on['pyCSAMT'], .
+00014200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014220: 2020 2770 7963 7361 6d74 272c 2064 6174    'pycsamt', dat
+00014230: 612c 2027 4c43 5330 312e 4156 4727 290d  a, 'LCS01.AVG').
+00014240: 0a20 2020 2020 2020 203e 3e3e 2061 7667  .        >>> avg
+00014250: 5f6f 626a 3d20 4176 6728 6461 7461 5f66  _obj= Avg(data_f
+00014260: 6e3d 7061 7468 2920 0d0a 2020 2020 2020  n=path) ..      
+00014270: 2020 2e2e 2e20 6176 675f 6f62 6a2e 4865    ... avg_obj.He
+00014280: 6164 6572 2e52 782e 7478 4764 7053 746e  ader.Rx.txGdpStn
+00014290: 0d0a 2020 2020 2020 2020 2e2e 2e20 6176  ..        ... av
+000142a0: 675f 6f62 6a2e 4865 6164 6572 2e52 782e  g_obj.Header.Rx.
+000142b0: 7478 5374 6e0d 0a20 2020 2020 2020 202e  txStn..        .
+000142c0: 2e2e 2061 7667 5f6f 626a 2e48 6561 6465  .. avg_obj.Heade
+000142d0: 722e 5278 2e73 636f 6e66 6967 5f64 6963  r.Rx.sconfig_dic
+000142e0: 745b 2754 782e 4c65 6e67 7468 275d 0d0a  t['Tx.Length']..
+000142f0: 2020 2020 2022 2222 0d0a 2020 2020 6465       """..    de
+00014300: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00014310: 2052 785f 6461 7461 3d4e 6f6e 6520 2c20   Rx_data=None , 
+00014320: 202a 2a6b 7761 7267 7329 3a0d 0a0d 0a20   **kwargs):.... 
+00014330: 2020 2020 2020 2073 656c 662e 7278 5f64         self.rx_d
+00014340: 6174 6120 3d52 785f 6461 7461 200d 0a20  ata =Rx_data .. 
+00014350: 2020 2020 2020 2073 656c 662e 7278 4764         self.rxGd
+00014360: 7053 746e 203d 4e6f 6e65 200d 0a20 2020  pStn =None ..   
+00014370: 2020 2020 2073 656c 662e 7278 5374 6e3d       self.rxStn=
+00014380: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
+00014390: 656c 662e 7278 4850 523d 4e6f 6e65 200d  elf.rxHPR=None .
+000143a0: 0a20 2020 2020 2020 2073 656c 662e 7278  .        self.rx
+000143b0: 4c65 6e67 7468 3d4e 6f6e 650d 0a20 2020  Length=None..   
+000143c0: 2020 2020 2073 656c 662e 7278 436f 6d70       self.rxComp
+000143d0: 733d 2745 7848 7927 0d0a 2020 2020 2020  s='ExHy'..      
+000143e0: 2020 7365 6c66 2e75 6e69 743d 4e6f 6e65    self.unit=None
+000143f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00014400: 2020 2020 7365 6c66 2e73 636f 6e66 6967      self.sconfig
+00014410: 5f64 6963 743d 7b27 5278 2e47 6470 5374  _dict={'Rx.GdpSt
+00014420: 6e27 3a73 656c 662e 7278 4764 7053 746e  n':self.rxGdpStn
+00014430: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00014440: 2020 2020 2020 2020 2020 2020 2020 2752                'R
+00014450: 782e 5374 6e27 3a73 656c 662e 7278 5374  x.Stn':self.rxSt
+00014460: 6e2c 200d 0a20 2020 2020 2020 2020 2020  n, ..           
+00014470: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00014480: 5278 2e48 5052 273a 7365 6c66 2e72 7848  Rx.HPR':self.rxH
+00014490: 5052 202c 200d 0a20 2020 2020 2020 2020  PR , ..         
+000144a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144b0: 2027 5278 2e4c 656e 6774 6827 3a20 7365   'Rx.Length': se
+000144c0: 6c66 2e72 784c 656e 6774 682c 0d0a 2020  lf.rxLength,..  
+000144d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144e0: 2020 2020 2020 2020 2752 782e 436d 7027          'Rx.Cmp'
+000144f0: 3a73 656c 662e 7278 436f 6d70 732c 0d0a  :self.rxComps,..
+00014500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014510: 2020 2020 2020 2020 2020 7d0d 0a0d 0a0d            }.....
+00014520: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
+00014530: 7320 696e 206c 6973 7428 6b77 6172 6773  s in list(kwargs
+00014540: 2e6b 6579 7328 2929 3a0d 0a20 2020 2020  .keys()):..     
+00014550: 2020 2020 2020 2069 6620 6b65 7973 206e         if keys n
+00014560: 6f74 2069 6e20 5265 6365 6976 6572 5072  ot in ReceiverPr
+00014570: 6f70 6572 7469 6573 2e5f 5f64 6963 745f  operties.__dict_
+00014580: 5f2e 6b65 7973 2829 3a0d 0a20 2020 2020  _.keys():..     
+00014590: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000145a0: 5f5f 7365 7461 7474 725f 5f28 6b65 7973  __setattr__(keys
+000145b0: 2c20 6b77 6172 6773 5b6b 6579 735d 290d  , kwargs[keys]).
+000145c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000145d0: 2073 656c 662e 7363 6f6e 6669 675f 6469   self.sconfig_di
+000145e0: 6374 2e5f 5f73 6574 6974 656d 5f5f 286b  ct.__setitem__(k
+000145f0: 6579 732c 206b 7761 7267 735b 6b65 7973  eys, kwargs[keys
+00014600: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00014610: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00014620: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
+00014630: 7365 745f 7265 6365 6976 6572 5f70 726f  set_receiver_pro
+00014640: 7065 7274 6965 7328 7365 6c66 2c20 5278  perties(self, Rx
+00014650: 5f64 6174 6120 3d4e 6f6e 6520 293a 0d0a  _data =None ):..
+00014660: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00014670: 2020 2020 204d 6574 686f 6473 2020 746f       Methods  to
+00014680: 2073 6574 2052 6563 6569 7665 7273 202d   set Receivers -
+00014690: 2070 726f 7065 7274 6965 7320 696e 666f   properties info
+000146a0: 7320 6672 6f6d 2041 5647 2066 696c 6573  s from AVG files
+000146b0: 2e20 0d0a 0d0a 2020 2020 2020 2020 5061  . ....        Pa
+000146c0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+000146d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+000146e0: 2020 2020 2020 2a20 5278 5f64 6174 6120        * Rx_data 
+000146f0: 3a20 6c69 7374 2c20 6f70 7469 6f6e 616c  : list, optional
+00014700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014710: 2020 2020 2020 636f 6e74 6169 6e65 7220        container 
+00014720: 696e 666f 7320 6f66 2072 6563 6569 7665  infos of receive
+00014730: 7273 2e20 5468 6520 6465 6661 756c 7420  rs. The default 
+00014740: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
+00014750: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
+00014760: 6620 5278 5f64 6174 6120 6973 206e 6f74  f Rx_data is not
+00014770: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
+00014780: 2020 2020 2020 7365 6c66 2e72 785f 6461        self.rx_da
+00014790: 7461 203d 2052 785f 6461 7461 0d0a 2020  ta = Rx_data..  
+000147a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000147b0: 6966 2073 656c 662e 7278 5f64 6174 6120  if self.rx_data 
+000147c0: 6973 204e 6f6e 6520 3a20 0d0a 2020 2020  is None : ..    
+000147d0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000147e0: 6c75 6545 7272 6f72 2827 4e6f 205a 6f6e  lueError('No Zon
+000147f0: 6765 2052 782d 7072 6f70 7265 7274 6965  ge Rx-proprertie
+00014800: 7320 666f 756e 6420 2127 290d 0a20 2020  s found !')..   
+00014810: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00014820: 2020 2069 6620 7479 7065 2873 656c 662e     if type(self.
+00014830: 7278 5f64 6174 6129 2069 7320 6e6f 7420  rx_data) is not 
+00014840: 6c69 7374 203a 0d0a 2020 2020 2020 2020  list :..        
+00014850: 2020 2020 7472 7920 3a20 0d0a 2020 2020      try : ..    
+00014860: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+00014870: 732e 7061 7468 2e69 7366 696c 6528 7365  s.path.isfile(se
+00014880: 6c66 2e72 785f 6461 7461 2920 3d3d 5472  lf.rx_data) ==Tr
+00014890: 7565 203a 200d 0a20 2020 2020 2020 2020  ue : ..         
+000148a0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+000148b0: 6f70 656e 2873 656c 662e 7278 5f64 6174  open(self.rx_dat
+000148c0: 612c 2027 7227 2c20 656e 636f 6469 6e67  a, 'r', encoding
+000148d0: 3d27 7574 662d 3827 2920 6173 2066 7278  ='utf-8') as frx
+000148e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000148f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00014900: 7278 5f64 6174 6120 3d66 7278 2e72 6561  rx_data =frx.rea
+00014910: 646c 696e 6573 2829 0d0a 2020 2020 2020  dlines()..      
+00014920: 2020 2020 2020 6578 6365 7074 203a 2072        except : r
+00014930: 6169 7365 2048 6561 6465 7245 7272 6f72  aise HeaderError
+00014940: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00014950: 2020 2020 2020 2027 4172 6775 6d65 6e74         'Argument
+00014960: 2070 726f 7669 6465 6420 666f 7220 7278   provided for rx
+00014970: 5f64 6174 6120 6172 6520 7772 6f6e 6720  _data are wrong 
+00014980: 2127 0d0a 2020 2020 2020 2020 2020 2020  !'..            
+00014990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000149a0: 2020 2020 2020 2720 4d75 7374 2062 6520        ' Must be 
+000149b0: 6120 6c69 7374 206f 6620 6669 6c65 2e27  a list of file.'
+000149c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000149d0: 2020 2020 2020 2020 2020 200d 0a0d 0a20             .... 
+000149e0: 2020 2020 2020 2066 6f72 2072 785f 696e         for rx_in
+000149f0: 666f 7320 696e 2073 656c 662e 7278 5f64  fos in self.rx_d
+00014a00: 6174 6120 3a20 0d0a 2020 2020 2020 2020  ata : ..        
+00014a10: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00014a20: 2020 6966 2027 2452 782e 5374 6e27 2069    if '$Rx.Stn' i
+00014a30: 6e20 7278 5f69 6e66 6f73 203a 0d0a 2020  n rx_infos :..  
+00014a40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00014a50: 6c66 2e72 7853 746e 203d 6e70 2e66 6c6f  lf.rxStn =np.flo
+00014a60: 6174 2872 785f 696e 666f 732e 7374 7269  at(rx_infos.stri
+00014a70: 7028 292e 7370 6c69 7428 273d 2729 5b2d  p().split('=')[-
+00014a80: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+00014a90: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00014aa0: 2020 2069 6620 2752 782e 436d 7027 2069     if 'Rx.Cmp' i
+00014ab0: 6e20 7278 5f69 6e66 6f73 203a 0d0a 2020  n rx_infos :..  
+00014ac0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00014ad0: 6c66 2e72 7843 6f6d 7073 3d20 7278 5f69  lf.rxComps= rx_i
+00014ae0: 6e66 6f73 2e73 7472 6970 2829 2e73 706c  nfos.strip().spl
+00014af0: 6974 2827 3d27 295b 2d31 5d0d 0a20 2020  it('=')[-1]..   
+00014b00: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00014b10: 2020 2020 2020 2020 2020 2069 6620 2752             if 'R
+00014b20: 782e 4850 5227 2069 6e20 7278 5f69 6e66  x.HPR' in rx_inf
+00014b30: 6f73 203a 0d0a 2020 2020 2020 2020 2020  os :..          
+00014b40: 2020 2020 2020 7365 6c66 2e72 7848 5052        self.rxHPR
+00014b50: 3d5b 666c 6f61 7428 7373 2920 666f 7220  =[float(ss) for 
+00014b60: 7373 2069 6e20 0d0a 2020 2020 2020 2020  ss in ..        
+00014b70: 2020 2020 2020 2020 2072 785f 696e 666f           rx_info
+00014b80: 732e 7374 7269 7028 292e 7370 6c69 7428  s.strip().split(
+00014b90: 273d 2729 5b2d 315d 2e73 706c 6974 2827  '=')[-1].split('
+00014ba0: 2c27 295d 0d0a 2020 2020 2020 2020 2020  ,')]..          
+00014bb0: 2020 6966 2028 2724 2041 5350 4143 4527    if ('$ ASPACE'
+00014bc0: 2069 6e20 7278 5f69 6e66 6f73 2920 6f72   in rx_infos) or
+00014bd0: 2020 2827 5278 2e4c 656e 6774 6827 696e    ('Rx.Length'in
+00014be0: 2072 785f 696e 666f 7329 203a 200d 0a20   rx_infos) : .. 
+00014bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c00: 2020 2023 2d2d 2069 7420 7365 656d 7320     #-- it seems 
+00014c10: 736f 6d65 7469 6d65 7320 6669 6c65 2067  sometimes file g
+00014c20: 6f74 2074 6865 2075 6e69 7420 6174 2074  ot the unit at t
+00014c30: 6865 2065 6e64 2065 6974 6865 7220 0d0a  he end either ..
+00014c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c50: 2020 2020 2320 276d 2720 6f72 2066 7427      # 'm' or ft'
+00014c60: 7368 6f75 6c64 2072 656d 6f76 6520 6974  should remove it
+00014c70: 2062 6566 6f72 6520 636f 6e76 6572 7469   before converti
+00014c80: 6e67 206f 6e20 666c 6f61 740d 0a20 2020  ng on float..   
+00014c90: 2020 2020 2020 2020 2020 2020 2074 7820               tx 
+00014ca0: 3d20 7278 5f69 6e66 6f73 2e73 7472 6970  = rx_infos.strip
+00014cb0: 2829 2e73 706c 6974 2827 3d27 295b 2d31  ().split('=')[-1
+00014cc0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00014cd0: 2020 2069 6620 6e6f 7420 3436 203c 206f     if not 46 < o
+00014ce0: 7264 2872 785f 696e 666f 732e 7374 7269  rd(rx_infos.stri
+00014cf0: 7028 292e 7370 6c69 7428 273d 2729 5b2d  p().split('=')[-
+00014d00: 315d 5b2d 315d 2920 3c20 3538 203a 2020  1][-1]) < 58 :  
+00014d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014d20: 2020 2020 2020 7478 203d 6675 6e63 2e5f        tx =func._
+00014d30: 7265 6d6f 7665 5f73 7472 5f77 6f72 6428  remove_str_word(
+00014d40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014d50: 2020 2020 2020 2020 2020 6368 6172 3d74            char=t
+00014d60: 782c 776f 7264 5f74 6f5f 7265 6d6f 7665  x,word_to_remove
+00014d70: 3d72 785f 696e 666f 732e 7374 7269 7028  =rx_infos.strip(
+00014d80: 292e 7370 6c69 7428 273d 2729 5b2d 315d  ).split('=')[-1]
+00014d90: 5b2d 315d 2c0d 0a20 2020 2020 2020 2020  [-1],..         
+00014da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014db0: 2020 2020 2064 6565 705f 7265 6d6f 7665       deep_remove
+00014dc0: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+00014dd0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00014de0: 662e 7278 4c65 6e67 7468 203d 6e70 2e66  f.rxLength =np.f
+00014df0: 6c6f 6174 2874 7829 0d0a 2020 2020 2020  loat(tx)..      
+00014e00: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00014e10: 6c66 2e75 6e69 7420 3d20 7278 5f69 6e66  lf.unit = rx_inf
+00014e20: 6f73 2e73 7472 6970 2829 2e73 706c 6974  os.strip().split
+00014e30: 2827 3d27 295b 2d31 5d5b 2d31 5d0d 0a20  ('=')[-1][-1].. 
+00014e40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00014e50: 6c73 6520 3a73 656c 662e 7278 4c65 6e67  lse :self.rxLeng
+00014e60: 7468 3d6e 702e 666c 6f61 7428 7478 290d  th=np.float(tx).
+00014e70: 0a20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
+00014e80: 6966 2027 2452 782e 4764 7053 746e 2720  if '$Rx.GdpStn' 
+00014e90: 696e 2072 785f 696e 666f 7320 3a20 0d0a  in rx_infos : ..
+00014ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014eb0: 7365 6c66 2e72 7847 6470 5374 6e20 3d6e  self.rxGdpStn =n
+00014ec0: 702e 666c 6f61 7428 7278 5f69 6e66 6f73  p.float(rx_infos
+00014ed0: 2e73 7472 6970 2829 2e73 706c 6974 2827  .strip().split('
+00014ee0: 3d27 295b 2d31 5d29 0d0a 2020 2020 2020  =')[-1])..      
+00014ef0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00014f00: 2020 2020 7365 6c66 2e73 636f 6e66 6967      self.sconfig
+00014f10: 5f64 6963 743d 7b27 5278 2e47 6470 5374  _dict={'Rx.GdpSt
+00014f20: 6e27 3a73 656c 662e 7278 4764 7053 746e  n':self.rxGdpStn
+00014f30: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00014f40: 2020 2020 2020 2020 2020 2020 2020 2752                'R
+00014f50: 782e 5374 6e27 3a73 656c 662e 7278 5374  x.Stn':self.rxSt
+00014f60: 6e2c 200d 0a20 2020 2020 2020 2020 2020  n, ..           
+00014f70: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00014f80: 5278 2e48 5052 273a 7365 6c66 2e72 7848  Rx.HPR':self.rxH
+00014f90: 5052 202c 200d 0a20 2020 2020 2020 2020  PR , ..         
+00014fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fb0: 2027 5278 2e4c 656e 6774 6827 3a20 7365   'Rx.Length': se
+00014fc0: 6c66 2e72 784c 656e 6774 682c 0d0a 2020  lf.rxLength,..  
+00014fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fe0: 2020 2020 2020 2020 2752 782e 436d 7027          'Rx.Cmp'
+00014ff0: 3a73 656c 662e 7278 436f 6d70 732c 0d0a  :self.rxComps,..
+00015000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015010: 2020 2020 2020 2020 2020 7d0d 0a0d 0a20            }.... 
+00015020: 2020 2020 200d 0a0d 0a63 6c61 7373 2053       ....class S
+00015030: 6b69 705f 666c 6167 2028 6f62 6a65 6374  kip_flag (object
+00015040: 2920 3a20 0d0a 2020 2020 2222 220d 0a20  ) : ..    """.. 
+00015050: 2020 2073 6b69 7020 666c 6167 2076 616c     skip flag val
+00015060: 7565 7320 0d0a 2020 2020 0d0a 2020 2020  ues ..    ..    
+00015070: 2020 2020 2d20 302e 2064 726f 7020 6461      - 0. drop da
+00015080: 7461 200d 0a20 2020 2020 2020 202d 2031  ta ..        - 1
+00015090: 2e20 736b 6970 2064 6174 6120 0d0a 2020  . skip data ..  
+000150a0: 2020 2020 2020 2d20 322e 2067 6f6f 6420        - 2. good 
+000150b0: 7175 616c 6974 7920 6f66 2064 6174 610d  quality of data.
+000150c0: 0a20 2020 200d 0a20 2020 2041 7267 756d  .    ..    Argum
+000150d0: 656e 7473 200d 0a20 2020 202d 2d2d 2d2d  ents ..    -----
+000150e0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
+000150f0: 2a73 6b69 705f 666c 6167 2a2a 203a 2073  *skip_flag** : s
+00015100: 7472 206f 7220 696e 7420 2c20 0d0a 2020  tr or int , ..  
+00015110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015120: 2020 736b 6970 5f66 6c61 6720 7661 6c75    skip_flag valu
+00015130: 6520 7365 7420 6175 746f 6d61 7469 6361  e set automatica
+00015140: 6c6c 7920 2e0d 0a20 2020 2020 2020 2020  lly ...         
+00015150: 2020 2020 2020 2020 2020 2073 6f6d 6520             some 
+00015160: 6173 7461 7469 6320 6669 6c65 2064 6f65  astatic file doe
+00015170: 736e 7420 6d65 6e74 696f 6e20 7468 6520  snt mention the 
+00015180: 6e75 6d62 6572 206f 6620 0d0a 2020 2020  number of ..    
 00015190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151a0: 2020 2027 5278 2e53 746e 273a 7365 6c66     'Rx.Stn':self
-000151b0: 2e72 7853 746e 2c20 0d0a 2020 2020 2020  .rxStn, ..      
-000151c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151d0: 2020 2020 2752 782e 4850 5227 3a73 656c      'Rx.HPR':sel
-000151e0: 662e 7278 4850 5220 2c20 0d0a 2020 2020  f.rxHPR , ..    
-000151f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015200: 2020 2020 2020 2752 782e 4c65 6e67 7468        'Rx.Length
-00015210: 273a 2073 656c 662e 7278 4c65 6e67 7468  ': self.rxLength
-00015220: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00015230: 2020 2020 2020 2020 2020 2020 2027 5278               'Rx
-00015240: 2e43 6d70 273a 7365 6c66 2e72 7843 6f6d  .Cmp':self.rxCom
-00015250: 7073 2c0d 0a20 2020 2020 2020 2020 2020  ps,..           
-00015260: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00015270: 0d0a 0d0a 2020 2020 2020 0d0a 0d0a 636c  ....      ....cl
-00015280: 6173 7320 536b 6970 5f66 6c61 6720 286f  ass Skip_flag (o
-00015290: 626a 6563 7429 203a 200d 0a20 2020 2022  bject) : ..    "
-000152a0: 2222 0d0a 2020 2020 736b 6970 2066 6c61  ""..    skip fla
-000152b0: 6720 7661 6c75 6573 200d 0a20 2020 200d  g values ..    .
-000152c0: 0a20 2020 2020 2020 202d 2030 2e20 6472  .        - 0. dr
-000152d0: 6f70 2064 6174 6120 0d0a 2020 2020 2020  op data ..      
-000152e0: 2020 2d20 312e 2073 6b69 7020 6461 7461    - 1. skip data
-000152f0: 200d 0a20 2020 2020 2020 202d 2032 2e20   ..        - 2. 
-00015300: 676f 6f64 2071 7561 6c69 7479 206f 6620  good quality of 
-00015310: 6461 7461 0d0a 2020 2020 0d0a 2020 2020  data..    ..    
-00015320: 4172 6775 6d65 6e74 7320 0d0a 2020 2020  Arguments ..    
-00015330: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00015340: 2020 2020 2a2a 736b 6970 5f66 6c61 672a      **skip_flag*
-00015350: 2a20 3a20 7374 7220 6f72 2069 6e74 202c  * : str or int ,
-00015360: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00015370: 2020 2020 2020 2073 6b69 705f 666c 6167         skip_flag
-00015380: 2076 616c 7565 2073 6574 2061 7574 6f6d   value set autom
-00015390: 6174 6963 616c 6c79 202e 0d0a 2020 2020  atically ...    
-000153a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000153b0: 736f 6d65 2061 7374 6174 6963 2066 696c  some astatic fil
-000153c0: 6520 646f 6573 6e74 206d 656e 7469 6f6e  e doesnt mention
-000153d0: 2074 6865 206e 756d 6265 7220 6f66 200d   the number of .
-000153e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000153f0: 2020 2020 2073 6b69 705f 666c 6167 202e       skip_flag .
-00015400: 4465 6661 756c 7420 6973 2027 3227 2e0d  Default is '2'..
-00015410: 0a20 0d0a 2020 2020 3a45 7861 6d70 6c65  . ..    :Example
-00015420: 3a0d 0a20 2020 2020 2020 2020 2020 200d  :..            .
-00015430: 0a20 2020 2020 2020 2020 3e3e 3e20 6672  .         >>> fr
-00015440: 6f6d 2070 7963 7361 6d74 2e66 662e 636f  om pycsamt.ff.co
-00015450: 7265 2069 6d70 6f72 7420 4176 670d 0a20  re import Avg.. 
-00015460: 2020 2020 2020 2020 3e3e 3e20 7061 7468          >>> path
-00015470: 3d20 6f73 2e70 6174 682e 6a6f 696e 286f  = os.path.join(o
-00015480: 732e 656e 7669 726f 6e5b 2770 7943 5341  s.environ['pyCSA
-00015490: 4d54 275d 2c20 0d0a 2020 2020 2020 2020  MT'], ..        
-000154a0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-000154b0: 2020 2020 2020 2020 2020 2020 2027 7079               'py
-000154c0: 6373 616d 7427 2c20 6461 7461 2c20 274c  csamt', data, 'L
-000154d0: 4353 3031 2e41 5647 2729 0d0a 2020 2020  CS01.AVG')..    
-000154e0: 2020 2020 203e 3e3e 2061 7667 5f6f 626a       >>> avg_obj
-000154f0: 3d20 4176 6728 6461 7461 5f66 6e3d 7061  = Avg(data_fn=pa
-00015500: 7468 2920 0d0a 2020 2020 2020 2020 203e  th) ..         >
-00015510: 3e3e 2061 7667 5f6f 626a 2e53 6b69 705f  >> avg_obj.Skip_
-00015520: 666c 6167 2e73 6b69 705f 666c 6167 0d0a  flag.skip_flag..
-00015530: 2020 2020 2020 2020 203e 3e3e 2061 7667           >>> avg
-00015540: 5f6f 626a 2e53 6b69 705f 666c 6167 2e67  _obj.Skip_flag.g
-00015550: 6574 5f73 6b69 705f 666c 6167 0d0a 2020  et_skip_flag..  
-00015560: 2020 2222 220d 0a20 2020 200d 0a20 2020    """..    ..   
-00015570: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00015580: 6c66 2c20 736b 6970 5f66 6c61 673d 4e6f  lf, skip_flag=No
-00015590: 6e65 202c 202a 2a6b 7761 7267 7329 3a0d  ne , **kwargs):.
-000155a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000155b0: 2020 2073 656c 662e 736b 6970 5f66 6c61     self.skip_fla
-000155c0: 673d 2073 6b69 705f 666c 6167 0d0a 2020  g= skip_flag..  
-000155d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000155e0: 7365 6c66 2e67 6574 5f73 6b69 705f 666c  self.get_skip_fl
-000155f0: 6167 3d4e 6f6e 6520 0d0a 2020 2020 2020  ag=None ..      
-00015600: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00015610: 2e73 6b69 705f 666c 6167 5f64 6963 7420  .skip_flag_dict 
-00015620: 3d7b 2732 273a 2747 6f6f 6420 6461 7461  ={'2':'Good data
-00015630: 2071 7561 6c69 7479 272c 200d 0a20 2020   quality', ..   
-00015640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015650: 2020 2020 2020 2020 2027 3127 3a20 2744           '1': 'D
-00015660: 6174 6120 736b 6970 7065 6427 2c20 0d0a  ata skipped', ..
-00015670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015680: 2020 2020 2020 2020 2020 2020 2730 2720              '0' 
-00015690: 3a27 4461 7461 2072 656a 6563 7465 6427  :'Data rejected'
-000156a0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+000151a0: 736b 6970 5f66 6c61 6720 2e44 6566 6175  skip_flag .Defau
+000151b0: 6c74 2069 7320 2732 272e 0d0a 200d 0a20  lt is '2'... .. 
+000151c0: 2020 203a 4578 616d 706c 653a 0d0a 2020     :Example:..  
+000151d0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+000151e0: 2020 2020 203e 3e3e 2066 726f 6d20 7079       >>> from py
+000151f0: 6373 616d 742e 636f 7265 2069 6d70 6f72  csamt.core impor
+00015200: 7420 4176 670d 0a20 2020 2020 2020 2020  t Avg..         
+00015210: 3e3e 3e20 7061 7468 3d20 6f73 2e70 6174  >>> path= os.pat
+00015220: 682e 6a6f 696e 286f 732e 656e 7669 726f  h.join(os.enviro
+00015230: 6e5b 2770 7943 5341 4d54 275d 2c20 0d0a  n['pyCSAMT'], ..
+00015240: 2020 2020 2020 2020 202e 2e2e 2020 2020           ...    
+00015250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015260: 2020 2020 2027 7079 6373 616d 7427 2c20       'pycsamt', 
+00015270: 6461 7461 2c20 274c 4353 3031 2e41 5647  data, 'LCS01.AVG
+00015280: 2729 0d0a 2020 2020 2020 2020 203e 3e3e  ')..         >>>
+00015290: 2061 7667 5f6f 626a 3d20 4176 6728 6461   avg_obj= Avg(da
+000152a0: 7461 5f66 6e3d 7061 7468 2920 0d0a 2020  ta_fn=path) ..  
+000152b0: 2020 2020 2020 203e 3e3e 2061 7667 5f6f         >>> avg_o
+000152c0: 626a 2e53 6b69 705f 666c 6167 2e73 6b69  bj.Skip_flag.ski
+000152d0: 705f 666c 6167 0d0a 2020 2020 2020 2020  p_flag..        
+000152e0: 203e 3e3e 2061 7667 5f6f 626a 2e53 6b69   >>> avg_obj.Ski
+000152f0: 705f 666c 6167 2e67 6574 5f73 6b69 705f  p_flag.get_skip_
+00015300: 666c 6167 0d0a 2020 2020 2222 220d 0a20  flag..    """.. 
+00015310: 2020 200d 0a20 2020 2064 6566 205f 5f69     ..    def __i
+00015320: 6e69 745f 5f28 7365 6c66 2c20 736b 6970  nit__(self, skip
+00015330: 5f66 6c61 673d 4e6f 6e65 202c 202a 2a6b  _flag=None , **k
+00015340: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
+00015350: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00015360: 736b 6970 5f66 6c61 673d 2073 6b69 705f  skip_flag= skip_
+00015370: 666c 6167 0d0a 2020 2020 2020 2020 0d0a  flag..        ..
+00015380: 2020 2020 2020 2020 7365 6c66 2e67 6574          self.get
+00015390: 5f73 6b69 705f 666c 6167 3d4e 6f6e 6520  _skip_flag=None 
+000153a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000153b0: 2020 2020 7365 6c66 2e73 6b69 705f 666c      self.skip_fl
+000153c0: 6167 5f64 6963 7420 3d7b 2732 273a 2747  ag_dict ={'2':'G
+000153d0: 6f6f 6420 6461 7461 2071 7561 6c69 7479  ood data quality
+000153e0: 272c 200d 0a20 2020 2020 2020 2020 2020  ', ..           
+000153f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015400: 2027 3127 3a20 2744 6174 6120 736b 6970   '1': 'Data skip
+00015410: 7065 6427 2c20 0d0a 2020 2020 2020 2020  ped', ..        
+00015420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015430: 2020 2020 2730 2720 3a27 4461 7461 2072      '0' :'Data r
+00015440: 656a 6563 7465 6427 2c20 0d0a 2020 2020  ejected', ..    
+00015450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015460: 2020 2020 2020 2020 272a 273a 2027 4e6f          '*': 'No
+00015470: 2064 6174 6120 6f62 7461 696e 6564 277d   data obtained'}
+00015480: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00015490: 2020 2020 0d0a 2020 2020 2020 2020 666f      ..        fo
+000154a0: 7220 6b65 7973 2069 6e20 6c69 7374 286b  r keys in list(k
+000154b0: 7761 7267 732e 6b65 7973 2829 293a 200d  wargs.keys()): .
+000154c0: 0a20 2020 2020 2020 2020 2020 2073 6574  .            set
+000154d0: 6174 7472 2873 656c 662c 206b 6579 7320  attr(self, keys 
+000154e0: 2c20 6b77 6172 6773 5b6b 6579 735d 290d  , kwargs[keys]).
+000154f0: 0a20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
+00015500: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
+00015510: 7365 7461 6e64 6765 745f 736b 6970 5f66  setandget_skip_f
+00015520: 6c61 6720 2873 656c 662c 2073 6b69 705f  lag (self, skip_
+00015530: 666c 6167 3d4e 6f6e 6529 3a0d 0a20 2020  flag=None):..   
+00015540: 2020 2020 2022 2222 200d 0a20 2020 2020       """ ..     
+00015550: 2020 2073 696d 706c 6520 6d65 7468 6f64     simple method
+00015560: 2074 6f20 7365 7420 616e 6420 6765 7420   to set and get 
+00015570: 736b 6970 5f66 6c61 672e 0d0a 2020 2020  skip_flag...    
+00015580: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+00015590: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+000155a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+000155b0: 2020 2020 2020 2020 2020 202a 2073 6b69             * ski
+000155c0: 705f 666c 6167 3a20 2073 7472 200d 0a20  p_flag:  str .. 
+000155d0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+000155e0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+000155f0: 2073 6b69 705f 666c 6167 2069 7320 6e6f   skip_flag is no
+00015600: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
+00015610: 2020 2020 2020 2069 6620 736b 6970 5f66         if skip_f
+00015620: 6c61 6720 6e6f 7420 696e 206c 6973 7428  lag not in list(
+00015630: 7365 6c66 2e73 6b69 705f 666c 6167 5f64  self.skip_flag_d
+00015640: 6963 742e 6b65 7973 2829 293a 0d0a 2020  ict.keys()):..  
+00015650: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00015660: 6973 6520 436f 6e66 6967 4669 6c65 4572  ise ConfigFileEr
+00015670: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+00015680: 2020 2020 2020 2020 2020 2757 726f 6e67            'Wrong
+00015690: 2049 6e70 7574 2021 2073 6b69 7020 666c   Input ! skip fl
+000156a0: 6167 206d 7573 7420 6265 270d 0a20 2020  ag must be'..   
 000156b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156c0: 272a 273a 2027 4e6f 2064 6174 6120 6f62  '*': 'No data ob
-000156d0: 7461 696e 6564 277d 0d0a 2020 2020 2020  tained'}..      
-000156e0: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
-000156f0: 2020 2020 2020 666f 7220 6b65 7973 2069        for keys i
-00015700: 6e20 6c69 7374 286b 7761 7267 732e 6b65  n list(kwargs.ke
-00015710: 7973 2829 293a 200d 0a20 2020 2020 2020  ys()): ..       
-00015720: 2020 2020 2073 6574 6174 7472 2873 656c       setattr(sel
-00015730: 662c 206b 6579 7320 2c20 6b77 6172 6773  f, keys , kwargs
-00015740: 5b6b 6579 735d 290d 0a20 0d0a 2020 2020  [keys]).. ..    
-00015750: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
-00015760: 2020 2020 6465 6620 7365 7461 6e64 6765      def setandge
-00015770: 745f 736b 6970 5f66 6c61 6720 2873 656c  t_skip_flag (sel
-00015780: 662c 2073 6b69 705f 666c 6167 3d4e 6f6e  f, skip_flag=Non
-00015790: 6529 3a0d 0a20 2020 2020 2020 2022 2222  e):..        """
-000157a0: 200d 0a20 2020 2020 2020 2073 696d 706c   ..        simpl
-000157b0: 6520 6d65 7468 6f64 2074 6f20 7365 7420  e method to set 
-000157c0: 616e 6420 6765 7420 736b 6970 5f66 6c61  and get skip_fla
-000157d0: 672e 0d0a 2020 2020 2020 2020 0d0a 2020  g...        ..  
-000157e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000157f0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00015800: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2020  ----..          
-00015810: 2020 202a 2073 6b69 705f 666c 6167 3a20     * skip_flag: 
-00015820: 2073 7472 200d 0a20 2020 2020 2020 2022   str ..        "
-00015830: 2222 0d0a 2020 2020 2020 2020 0d0a 2020  ""..        ..  
-00015840: 2020 2020 2020 6966 2073 6b69 705f 666c        if skip_fl
-00015850: 6167 2069 7320 6e6f 7420 4e6f 6e65 203a  ag is not None :
-00015860: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
-00015870: 6620 736b 6970 5f66 6c61 6720 6e6f 7420  f skip_flag not 
-00015880: 696e 206c 6973 7428 7365 6c66 2e73 6b69  in list(self.ski
-00015890: 705f 666c 6167 5f64 6963 742e 6b65 7973  p_flag_dict.keys
-000158a0: 2829 293a 0d0a 2020 2020 2020 2020 2020  ()):..          
-000158b0: 2020 2020 2020 7261 6973 6520 4353 6578        raise CSex
-000158c0: 2e70 7943 5341 4d54 4572 726f 725f 636f  .pyCSAMTError_co
-000158d0: 6e66 6967 5f66 696c 6528 0d0a 2020 2020  nfig_file(..    
-000158e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000158f0: 2757 726f 6e67 2049 6e70 7574 2021 2073  'Wrong Input ! s
-00015900: 6b69 7020 666c 6167 206d 7573 7420 6265  kip flag must be
-00015910: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00015920: 2020 2020 2020 2020 2720 616d 6f6e 6720          ' among 
-00015930: 3a20 7b30 7d27 2e66 6f72 6d61 7428 6c69  : {0}'.format(li
-00015940: 7374 2873 656c 662e 736b 6970 5f66 6c61  st(self.skip_fla
-00015950: 675f 6469 6374 2e6b 6579 7328 2929 2929  g_dict.keys())))
-00015960: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00015970: 6c66 2e73 6b69 705f 666c 6167 203d 2073  lf.skip_flag = s
-00015980: 7472 2873 6b69 705f 666c 6167 290d 0a0d  tr(skip_flag)...
-00015990: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
-000159a0: 7320 2c20 7661 6c75 6573 2020 696e 2073  s , values  in s
-000159b0: 656c 662e 736b 6970 5f66 6c61 675f 6469  elf.skip_flag_di
-000159c0: 6374 2e69 7465 6d73 2829 3a20 0d0a 2020  ct.items(): ..  
-000159d0: 2020 2020 2020 2020 2020 6966 206b 6579            if key
-000159e0: 733d 3d73 656c 662e 736b 6970 5f66 6c61  s==self.skip_fla
-000159f0: 6720 3a20 0d0a 2020 2020 2020 2020 2020  g : ..          
-00015a00: 2020 2020 2020 7365 6c66 2e67 6574 5f73        self.get_s
-00015a10: 6b69 705f 666c 6167 203d 2076 616c 7565  kip_flag = value
-00015a20: 730d 0a20 2020 2020 2020 2020 2020 200d  s..            .
-00015a30: 0a20 200d 0a63 6c61 7373 205a 6f6e 6765  .  ..class Zonge
-00015a40: 4861 7264 7761 7265 286f 626a 6563 7429  Hardware(object)
-00015a50: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-00015a60: 536f 6d65 2066 6561 7475 7265 7320 6f66  Some features of
-00015a70: 207a 6f6e 6765 2041 4d54 4156 4720 736f   zonge AMTAVG so
-00015a80: 6674 7761 7265 2e20 0d0a 2020 2020 0d0a  ftware. ..    ..
-00015a90: 2020 2020 4172 6775 6d65 6e74 730d 0a20      Arguments.. 
-00015aa0: 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020     ---------..  
-00015ab0: 2020 2020 2020 2a2a 7a6f 6e67 655f 6861        **zonge_ha
-00015ac0: 7264 775f 696e 666f 732a 2a20 3a20 6c69  rdw_infos** : li
-00015ad0: 7374 206f 7220 7374 7220 2c20 0d0a 2020  st or str , ..  
-00015ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015af0: 2020 2020 2020 2020 2020 6669 6c6c 6564            filled
-00015b00: 2061 7574 6f6d 6174 6963 616c 6c79 206f   automatically o
-00015b10: 7220 7061 7468 2074 6f20 796f 7572 200d  r path to your .
-00015b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015b30: 2020 2020 2020 2020 2020 2020 2068 6172               har
-00015b40: 6477 6172 6520 7365 7474 696e 6720 6669  dware setting fi
-00015b50: 6c65 2e0d 0a20 2020 2020 2020 2020 2020  le...           
-00015b60: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
-00015b70: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-00015b80: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-00015b90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015ba0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-00015bb0: 0a20 2020 2041 7474 7269 6275 7465 7320  .    Attributes 
-00015bc0: 2020 2020 2020 2020 5479 7065 2020 2020          Type    
-00015bd0: 2020 2020 4578 706c 616e 6174 696f 6e0d      Explanation.
-00015be0: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
-00015bf0: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-00015c00: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-00015c10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015c20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
-00015c30: 2020 2076 6572 7369 6f6e 2020 2020 2020     version      
-00015c40: 2020 2020 2020 2073 7472 2020 2020 2020         str      
-00015c50: 2020 2076 6572 7369 6f6e 206f 6620 414d     version of AM
-00015c60: 5441 5647 2073 6f66 7477 6172 650d 0a20  TAVG software.. 
-00015c70: 2020 2064 6174 6564 2020 2020 2020 2020     dated        
-00015c80: 2020 2020 2020 2073 7472 2020 2020 2020         str      
-00015c90: 2020 2064 6174 6520 6f66 2062 7569 6c64     date of build
-00015ca0: 696e 6720 4176 6720 6669 6c65 200d 0a20  ing Avg file .. 
-00015cb0: 2020 2070 726f 6365 7373 6564 2020 2020     processed    
-00015cc0: 2020 2020 2020 2073 7472 2020 2020 2020         str      
-00015cd0: 2020 2064 6174 6520 6f66 2064 6174 6120     date of data 
-00015ce0: 7072 6570 726f 6365 7373 696e 670d 0a20  preprocessing.. 
-00015cf0: 2020 2066 726f 6d5f 666c 645f 6669 6c65     from_fld_file
-00015d00: 2020 2020 2020 2073 7472 2020 2020 2020         str      
-00015d10: 2020 2070 6172 656e 7420 6f66 2061 7667     parent of avg
-00015d20: 2066 696c 6520 0d0a 2020 2020 6173 7461   file ..    asta
-00015d30: 6374 6963 5f76 6572 7369 6f6e 2020 2020  ctic_version    
-00015d40: 7374 7220 2020 2020 2020 2020 7a6f 6e67  str         zong
-00015d50: 6520 6173 7461 6374 6963 2073 6f66 7761  e astactic sofwa
-00015d60: 7265 2076 6572 7369 6f6e 0d0a 2020 2020  re version..    
-00015d70: 7570 6461 7465 645f 6461 7461 2020 2020  updated_data    
-00015d80: 2020 2020 7374 7220 2020 2020 2020 2020      str         
-00015d90: 6461 7465 2077 6572 6520 6461 7461 2077  date were data w
-00015da0: 6572 6520 7570 6461 7465 6420 0d0a 2020  ere updated ..  
-00015db0: 2020 6e75 6d66 696c 7465 7266 7265 7120    numfilterfreq 
-00015dc0: 2020 2020 2020 696e 7420 2020 2020 2020        int       
-00015dd0: 2020 6e75 6d62 6572 206f 6620 706f 696e    number of poin
-00015de0: 7420 7468 6174 2054 4d41 2075 7365 6420  t that TMA used 
-00015df0: 746f 2066 696c 7465 7220 0d0a 2020 2020  to filter ..    
-00015e00: 6672 6571 5f66 696c 7465 7220 2020 2020  freq_filter     
-00015e10: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
-00015e20: 7661 6c75 6520 6f66 2054 4d41 2066 696c  value of TMA fil
-00015e30: 7465 7220 6672 6571 7565 6e63 790d 0a20  ter frequency.. 
-00015e40: 2020 2065 6e64 5f61 7374 6174 6963 5f66     end_astatic_f
-00015e50: 696c 6520 2020 2073 7472 2020 2020 2020  ile    str      
-00015e60: 2020 2065 6e64 2066 696c 6520 6465 7363     end file desc
-00015e70: 7269 7074 696f 6e2e 0d0a 2020 2020 3d3d  ription...    ==
-00015e80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
-00015e90: 203d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d   ==========  ===
-00015ea0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015eb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00015ec0: 3d3d 3d3d 3d3d 0d0a 2020 2020 2020 2020  ======..        
-00015ed0: 0d0a 2020 2020 4d6f 7265 2063 616e 2062  ..    More can b
-00015ee0: 6520 6164 6465 6420 6279 2069 6e70 7574  e added by input
-00015ef0: 696e 6720 6120 6b65 7920 776f 7264 2064  ing a key word d
-00015f00: 6963 7469 6f6e 6172 790d 0a20 2020 200d  ictionary..    .
-00015f10: 0a20 2020 203a 4578 616d 706c 653a 0d0a  .    :Example:..
-00015f20: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00015f30: 2020 203e 3e3e 2066 726f 6d20 7079 6373     >>> from pycs
-00015f40: 616d 742e 6666 2e63 6f72 6520 696d 706f  amt.ff.core impo
-00015f50: 7274 2041 7667 0d0a 2020 2020 2020 2020  rt Avg..        
-00015f60: 3e3e 3e20 7061 7468 3d20 6f73 2e70 6174  >>> path= os.pat
-00015f70: 682e 6a6f 696e 286f 732e 656e 7669 726f  h.join(os.enviro
-00015f80: 6e5b 2770 7943 5341 4d54 275d 2c20 0d0a  n['pyCSAMT'], ..
-00015f90: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00015fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fb0: 2770 7963 7361 6d74 272c 2064 6174 612c  'pycsamt', data,
-00015fc0: 2027 4c43 5330 312e 4156 4727 290d 0a20   'LCS01.AVG').. 
-00015fd0: 2020 2020 2020 203e 3e3e 2061 7667 5f6f         >>> avg_o
-00015fe0: 626a 3d20 4176 6728 6461 7461 5f66 6e3d  bj= Avg(data_fn=
-00015ff0: 7061 7468 2920 0d0a 2020 2020 2020 2020  path) ..        
-00016000: 3e3e 3e20 6176 675f 6f62 6a2e 4865 6164  >>> avg_obj.Head
-00016010: 6572 2e48 6172 6477 6172 6549 6e66 6f73  er.HardwareInfos
-00016020: 2e66 7265 715f 6669 6c74 6572 290d 0a20  .freq_filter).. 
-00016030: 2020 2020 2020 203e 3e3e 2061 7667 5f6f         >>> avg_o
-00016040: 626a 2e48 6561 6465 722e 4861 7264 7761  bj.Header.Hardwa
-00016050: 7265 496e 666f 732e 7363 6f6e 6669 675f  reInfos.sconfig_
-00016060: 6469 6374 5b27 414d 5441 5647 275d 290d  dict['AMTAVG']).
-00016070: 0a20 2020 2022 2222 0d0a 0d0a 2020 2020  .    """....    
-00016080: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00016090: 662c 7a6f 6e67 655f 6861 7264 775f 696e  f,zonge_hardw_in
-000160a0: 666f 733d 4e6f 6e65 202c 2020 2a2a 6b77  fos=None ,  **kw
-000160b0: 6172 6773 293a 0d0a 2020 2020 2020 2020  args):..        
-000160c0: 0d0a 2020 2020 2020 2020 7365 6c66 2e7a  ..        self.z
-000160d0: 6f6e 6765 5f68 6172 6477 5f69 6e66 6f73  onge_hardw_infos
-000160e0: 3d7a 6f6e 6765 5f68 6172 6477 5f69 6e66  =zonge_hardw_inf
-000160f0: 6f73 0d0a 2020 2020 2020 2020 7365 6c66  os..        self
-00016100: 2e76 6572 7369 6f6e 203d 2737 2e37 3627  .version ='7.76'
-00016110: 0d0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
-00016120: 726f 6d5f 666c 645f 6669 6c65 203d 204e  rom_fld_file = N
-00016130: 6f6e 6520 0d0a 2020 2020 2020 2020 7365  one ..        se
-00016140: 6c66 2e64 6174 6564 3d4e 6f6e 6520 0d0a  lf.dated=None ..
-00016150: 2020 2020 2020 2020 7365 6c66 2e70 726f          self.pro
-00016160: 6365 7373 6564 3d20 4e6f 6e65 200d 0a20  cessed= None .. 
-00016170: 2020 2020 2020 2073 656c 662e 6173 7461         self.asta
-00016180: 7469 635f 7665 7273 696f 6e20 3d20 2776  tic_version = 'v
-00016190: 332e 3630 270d 0a20 2020 2020 2020 2073  3.60'..        s
-000161a0: 656c 662e 7570 6461 7465 5f64 6174 6120  elf.update_data 
-000161b0: 3d4e 6f6e 6520 0d0a 2020 2020 2020 2020  =None ..        
-000161c0: 7365 6c66 2e6e 756d 6669 6c74 6572 6672  self.numfilterfr
-000161d0: 6571 3d4e 6f6e 650d 0a20 2020 2020 2020  eq=None..       
-000161e0: 2073 656c 662e 6672 6571 5f66 696c 7465   self.freq_filte
-000161f0: 723d 4e6f 6e65 200d 0a20 2020 2020 2020  r=None ..       
-00016200: 2073 656c 662e 7363 6f6e 6669 675f 6469   self.sconfig_di
-00016210: 6374 3d7b 2741 4d54 4156 4727 3a20 5b73  ct={'AMTAVG': [s
-00016220: 656c 662e 7665 7273 696f 6e2c 7365 6c66  elf.version,self
-00016230: 2e66 726f 6d5f 666c 645f 6669 6c65 5d2c  .from_fld_file],
-00016240: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00016250: 2020 2020 2020 2020 2020 2020 2020 2744                'D
-00016260: 6174 6564 273a 7365 6c66 2e64 6174 6564  ated':self.dated
-00016270: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00016280: 2020 2020 2020 2020 2020 2020 2020 2750                'P
-00016290: 726f 6365 7373 6564 273a 7365 6c66 2e70  rocessed':self.p
-000162a0: 726f 6365 7373 6564 2c20 0d0a 2020 2020  rocessed, ..    
-000162b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162c0: 2020 2020 2020 2027 4153 5441 5449 4327         'ASTATIC'
-000162d0: 3a5b 7365 6c66 2e61 7374 6174 6963 5f76  :[self.astatic_v
-000162e0: 6572 7369 6f6e 2c20 7365 6c66 2e75 7064  ersion, self.upd
-000162f0: 6174 655f 6461 7461 205d 2c0d 0a20 2020  ate_data ],..   
-00016300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016310: 2020 2020 2020 2020 2222 3a27 7b30 7d20          "":'{0} 
-00016320: 544d 4120 4669 6c74 6572 2061 7420 7b31  TMA Filter at {1
-00016330: 7d20 6865 7274 7a27 2e66 6f72 6d61 7428  } hertz'.format(
-00016340: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016360: 2073 656c 662e 6e75 6d66 696c 7465 7266   self.numfilterf
-00016370: 7265 712c 7365 6c66 2e66 7265 715f 6669  req,self.freq_fi
-00016380: 6c74 6572 2029 7d0d 0a20 2020 2020 2020  lter )}..       
-00016390: 2073 656c 662e 5f77 7269 7465 725f 636f   self._writer_co
-000163a0: 7079 6c65 6674 203d 2740 6279 5f70 7943  pyleft ='@by_pyC
-000163b0: 5341 4d54 270d 0a20 2020 2020 2020 2020  SAMT'..         
-000163c0: 2020 200d 0a20 2020 2020 2020 2066 6f72     ..        for
-000163d0: 206b 6579 2069 6e20 6c69 7374 2028 6b77   key in list (kw
-000163e0: 6172 6773 2e6b 6579 7328 2929 3a0d 0a20  args.keys()):.. 
-000163f0: 2020 2020 2020 2020 2020 2069 6620 6b65             if ke
-00016400: 7920 6e6f 7420 696e 205a 6f6e 6765 4861  y not in ZongeHa
-00016410: 7264 7761 7265 2e5f 5f64 6963 745f 5f2e  rdware.__dict__.
-00016420: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
-00016430: 2020 2020 2020 2020 2073 6574 6174 7472           setattr
-00016440: 286b 6579 2c20 6b77 6172 6773 5b6b 6579  (key, kwargs[key
-00016450: 5d29 0d0a 2020 2020 2020 2020 0d0a 2020  ])..        ..  
-00016460: 2020 6465 6620 7365 745f 6861 7277 6172    def set_harwar
-00016470: 655f 696e 666f 7320 2873 656c 662c 207a  e_infos (self, z
-00016480: 6f6e 6765 5f68 6172 6477 5f69 6e66 6f73  onge_hardw_infos
-00016490: 203d 4e6f 6e65 2029 3a0d 0a20 2020 2020   =None ):..     
-000164a0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000164b0: 4d65 7468 6f64 2074 6f20 7365 7420 4861  Method to set Ha
-000164c0: 7277 6172 6573 2069 6e66 6f73 2e0d 0a20  rwares infos... 
-000164d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000164e0: 2050 6172 616d 6574 6572 7320 0d0a 2020   Parameters ..  
-000164f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00016500: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-00016510: 7a6f 6e67 655f 6861 7264 775f 696e 666f  zonge_hardw_info
-00016520: 7320 3a20 6c69 7374 200d 0a20 2020 2020  s : list ..     
-00016530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016540: 2020 2020 2020 2020 2020 2048 6172 6477             Hardw
-00016550: 6172 6520 696e 666f 726d 6174 696f 6e73  are informations
-00016560: 2063 6f6c 6c65 6374 6564 2020 0d0a 2020   collected  ..  
-00016570: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00016580: 2020 205f 6c6f 6767 6572 2e69 6e66 6f20     _logger.info 
-00016590: 2827 5265 6164 696e 6720 616e 6420 7365  ('Reading and se
-000165a0: 7474 696e 6720 4861 7277 7761 7265 2069  tting Harwware i
-000165b0: 6e66 6f72 6d61 7469 6f6e 7320 2127 290d  nformations !').
-000165c0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000165d0: 2020 2069 6620 7a6f 6e67 655f 6861 7264     if zonge_hard
-000165e0: 775f 696e 666f 7320 6973 206e 6f74 204e  w_infos is not N
-000165f0: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
-00016600: 2020 2020 7365 6c66 2e7a 6f6e 6765 5f68      self.zonge_h
-00016610: 6172 6477 5f69 6e66 6f73 3d7a 6f6e 6765  ardw_infos=zonge
-00016620: 5f68 6172 6477 5f69 6e66 6f73 200d 0a20  _hardw_infos .. 
-00016630: 2020 2020 2020 2069 6620 7365 6c66 2e7a         if self.z
-00016640: 6f6e 6765 5f68 6172 6477 5f69 6e66 6f73  onge_hardw_infos
-00016650: 2069 7320 4e6f 6e65 203a 200d 0a20 2020   is None : ..   
-00016660: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
-00016670: 5365 782e 7079 4353 414d 5445 7272 6f72  Sex.pyCSAMTError
-00016680: 5f48 6561 6465 7228 0d0a 2020 2020 2020  _Header(..      
-00016690: 2020 2020 2020 2020 2020 274e 6f20 696e            'No in
-000166a0: 666f 726d 6174 696f 6e73 2066 726f 6d20  formations from 
-000166b0: 6861 7264 7761 7265 2066 6f75 6e64 2021  hardware found !
-000166c0: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
-000166d0: 2020 2020 2020 6966 2074 7970 6520 2873        if type (s
-000166e0: 656c 662e 7a6f 6e67 655f 6861 7264 775f  elf.zonge_hardw_
-000166f0: 696e 666f 7329 2069 7320 6e6f 7420 6c69  infos) is not li
-00016700: 7374 203a 200d 0a20 2020 2020 2020 2020  st : ..         
-00016710: 2020 2074 7279 203a 200d 0a20 2020 2020     try : ..     
-00016720: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00016730: 6f70 656e 2873 656c 662e 7a6f 6e67 655f  open(self.zonge_
-00016740: 6861 7264 775f 696e 666f 732c 2027 7227  hardw_infos, 'r'
-00016750: 2c20 656e 636f 6469 6e67 3d27 7574 6638  , encoding='utf8
-00016760: 2729 2061 7320 667a 6820 3a20 0d0a 2020  ') as fzh : ..  
-00016770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016780: 2020 7365 6c66 2e7a 6f6e 6765 5f68 6172    self.zonge_har
-00016790: 6477 5f69 6e66 6f73 3d20 667a 682e 7265  dw_infos= fzh.re
-000167a0: 6164 6c69 6e65 7328 290d 0a20 2020 2020  adlines()..     
-000167b0: 2020 2020 2020 2065 7863 6570 7420 3a0d         except :.
-000167c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000167d0: 2072 6169 7365 2043 5365 782e 7079 4353   raise CSex.pyCS
-000167e0: 414d 5445 7272 6f72 5f48 6561 6465 7228  AMTError_Header(
-000167f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016800: 2020 2020 2020 2248 6172 7761 7265 202d        "Harware -
-00016810: 2069 6e66 6f73 206d 7573 7420 6265 2065   infos must be e
-00016820: 6974 6865 7220 6120 6c69 7374 206f 7220  ither a list or 
-00016830: 2066 696c 6520 2122 290d 0a0d 0a20 2020   file !")....   
-00016840: 2020 2020 2066 6f72 2020 696e 666f 7320       for  infos 
-00016850: 696e 2073 656c 662e 7a6f 6e67 655f 6861  in self.zonge_ha
-00016860: 7264 775f 696e 666f 7320 3a20 0d0a 2020  rdw_infos : ..  
-00016870: 2020 2020 2020 2020 2020 6966 2027 414d            if 'AM
-00016880: 5441 5647 2720 696e 2069 6e66 6f73 2020  TAVG' in infos  
-00016890: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-000168a0: 2020 2020 7465 6d5f 683d 696e 666f 732e      tem_h=infos.
-000168b0: 7374 7269 7028 292e 7370 6c69 7428 272c  strip().split(',
-000168c0: 2729 200d 0a20 2020 2020 2020 2020 2020  ') ..           
-000168d0: 2020 2020 2073 656c 662e 7072 6f63 6573       self.proces
-000168e0: 7365 6420 3d66 756e 632e 5f72 656d 6f76  sed =func._remov
-000168f0: 655f 7374 725f 776f 7264 2863 6861 723d  e_str_word(char=
-00016900: 7465 6d5f 685b 2d31 5d2c 200d 0a20 2020  tem_h[-1], ..   
-00016910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016940: 776f 7264 5f74 6f5f 7265 6d6f 7665 3d27  word_to_remove='
-00016950: 5072 6f63 6573 7365 6427 290d 0a20 2020  Processed')..   
-00016960: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00016970: 662e 6461 7465 643d 6675 6e63 2e5f 7265  f.dated=func._re
-00016980: 6d6f 7665 5f73 7472 5f77 6f72 6428 6368  move_str_word(ch
-00016990: 6172 3d74 656d 5f68 205b 2d32 5d2c 200d  ar=tem_h [-2], .
-000169a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000156c0: 2020 2720 616d 6f6e 6720 3a20 7b30 7d27    ' among : {0}'
+000156d0: 2e66 6f72 6d61 7428 6c69 7374 2873 656c  .format(list(sel
+000156e0: 662e 736b 6970 5f66 6c61 675f 6469 6374  f.skip_flag_dict
+000156f0: 2e6b 6579 7328 2929 2929 0d0a 2020 2020  .keys())))..    
+00015700: 2020 2020 2020 2020 7365 6c66 2e73 6b69          self.ski
+00015710: 705f 666c 6167 203d 2073 7472 2873 6b69  p_flag = str(ski
+00015720: 705f 666c 6167 290d 0a0d 0a20 2020 2020  p_flag)....     
+00015730: 2020 2066 6f72 206b 6579 7320 2c20 7661     for keys , va
+00015740: 6c75 6573 2020 696e 2073 656c 662e 736b  lues  in self.sk
+00015750: 6970 5f66 6c61 675f 6469 6374 2e69 7465  ip_flag_dict.ite
+00015760: 6d73 2829 3a20 0d0a 2020 2020 2020 2020  ms(): ..        
+00015770: 2020 2020 6966 206b 6579 733d 3d73 656c      if keys==sel
+00015780: 662e 736b 6970 5f66 6c61 6720 3a20 0d0a  f.skip_flag : ..
+00015790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000157a0: 7365 6c66 2e67 6574 5f73 6b69 705f 666c  self.get_skip_fl
+000157b0: 6167 203d 2076 616c 7565 730d 0a20 2020  ag = values..   
+000157c0: 2020 2020 2020 2020 200d 0a20 200d 0a63           ..  ..c
+000157d0: 6c61 7373 205a 6f6e 6765 4861 7264 7761  lass ZongeHardwa
+000157e0: 7265 286f 626a 6563 7429 3a0d 0a20 2020  re(object):..   
+000157f0: 2022 2222 0d0a 2020 2020 536f 6d65 2066   """..    Some f
+00015800: 6561 7475 7265 7320 6f66 207a 6f6e 6765  eatures of zonge
+00015810: 2041 4d54 4156 4720 736f 6674 7761 7265   AMTAVG software
+00015820: 2e20 0d0a 2020 2020 0d0a 2020 2020 4172  . ..    ..    Ar
+00015830: 6775 6d65 6e74 730d 0a20 2020 202d 2d2d  guments..    ---
+00015840: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00015850: 2a2a 7a6f 6e67 655f 6861 7264 775f 696e  **zonge_hardw_in
+00015860: 666f 732a 2a20 3a20 6c69 7374 206f 7220  fos** : list or 
+00015870: 7374 7220 2c20 0d0a 2020 2020 2020 2020  str , ..        
+00015880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015890: 2020 2020 6669 6c6c 6564 2061 7574 6f6d      filled autom
+000158a0: 6174 6963 616c 6c79 206f 7220 7061 7468  atically or path
+000158b0: 2074 6f20 796f 7572 200d 0a20 2020 2020   to your ..     
+000158c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000158d0: 2020 2020 2020 2068 6172 6477 6172 6520         hardware 
+000158e0: 7365 7474 696e 6720 6669 6c65 2e0d 0a20  setting file... 
+000158f0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00015900: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00015910: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==  ==========  
+00015920: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015930: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015940: 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020 2041  =========..    A
+00015950: 7474 7269 6275 7465 7320 2020 2020 2020  ttributes       
+00015960: 2020 5479 7065 2020 2020 2020 2020 4578    Type        Ex
+00015970: 706c 616e 6174 696f 6e0d 0a20 2020 203d  planation..    =
+00015980: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015990: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d    ==========  ==
+000159a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000159b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000159c0: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2076 6572  =======..    ver
+000159d0: 7369 6f6e 2020 2020 2020 2020 2020 2020  sion            
+000159e0: 2073 7472 2020 2020 2020 2020 2076 6572   str         ver
+000159f0: 7369 6f6e 206f 6620 414d 5441 5647 2073  sion of AMTAVG s
+00015a00: 6f66 7477 6172 650d 0a20 2020 2064 6174  oftware..    dat
+00015a10: 6564 2020 2020 2020 2020 2020 2020 2020  ed              
+00015a20: 2073 7472 2020 2020 2020 2020 2064 6174   str         dat
+00015a30: 6520 6f66 2062 7569 6c64 696e 6720 4176  e of building Av
+00015a40: 6720 6669 6c65 200d 0a20 2020 2070 726f  g file ..    pro
+00015a50: 6365 7373 6564 2020 2020 2020 2020 2020  cessed          
+00015a60: 2073 7472 2020 2020 2020 2020 2064 6174   str         dat
+00015a70: 6520 6f66 2064 6174 6120 7072 6570 726f  e of data prepro
+00015a80: 6365 7373 696e 670d 0a20 2020 2066 726f  cessing..    fro
+00015a90: 6d5f 666c 645f 6669 6c65 2020 2020 2020  m_fld_file      
+00015aa0: 2073 7472 2020 2020 2020 2020 2070 6172   str         par
+00015ab0: 656e 7420 6f66 2061 7667 2066 696c 6520  ent of avg file 
+00015ac0: 0d0a 2020 2020 6173 7461 6374 6963 5f76  ..    astactic_v
+00015ad0: 6572 7369 6f6e 2020 2020 7374 7220 2020  ersion    str   
+00015ae0: 2020 2020 2020 7a6f 6e67 6520 6173 7461        zonge asta
+00015af0: 6374 6963 2073 6f66 7761 7265 2076 6572  ctic sofware ver
+00015b00: 7369 6f6e 0d0a 2020 2020 7570 6461 7465  sion..    update
+00015b10: 645f 6461 7461 2020 2020 2020 2020 7374  d_data        st
+00015b20: 7220 2020 2020 2020 2020 6461 7465 2077  r         date w
+00015b30: 6572 6520 6461 7461 2077 6572 6520 7570  ere data were up
+00015b40: 6461 7465 6420 0d0a 2020 2020 6e75 6d66  dated ..    numf
+00015b50: 696c 7465 7266 7265 7120 2020 2020 2020  ilterfreq       
+00015b60: 696e 7420 2020 2020 2020 2020 6e75 6d62  int         numb
+00015b70: 6572 206f 6620 706f 696e 7420 7468 6174  er of point that
+00015b80: 2054 4d41 2075 7365 6420 746f 2066 696c   TMA used to fil
+00015b90: 7465 7220 0d0a 2020 2020 6672 6571 5f66  ter ..    freq_f
+00015ba0: 696c 7465 7220 2020 2020 2020 2020 666c  ilter         fl
+00015bb0: 6f61 7420 2020 2020 2020 7661 6c75 6520  oat       value 
+00015bc0: 6f66 2054 4d41 2066 696c 7465 7220 6672  of TMA filter fr
+00015bd0: 6571 7565 6e63 790d 0a20 2020 2065 6e64  equency..    end
+00015be0: 5f61 7374 6174 6963 5f66 696c 6520 2020  _astatic_file   
+00015bf0: 2073 7472 2020 2020 2020 2020 2065 6e64   str         end
+00015c00: 2066 696c 6520 6465 7363 7269 7074 696f   file descriptio
+00015c10: 6e2e 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d  n...    ========
+00015c20: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+00015c30: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00015c40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015c50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00015c60: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00015c70: 4d6f 7265 2063 616e 2062 6520 6164 6465  More can be adde
+00015c80: 6420 6279 2069 6e70 7574 696e 6720 6120  d by inputing a 
+00015c90: 6b65 7920 776f 7264 2064 6963 7469 6f6e  key word diction
+00015ca0: 6172 790d 0a20 2020 200d 0a20 2020 203a  ary..    ..    :
+00015cb0: 4578 616d 706c 653a 0d0a 2020 2020 2020  Example:..      
+00015cc0: 2020 200d 0a20 2020 2020 2020 203e 3e3e     ..        >>>
+00015cd0: 2066 726f 6d20 7079 6373 616d 742e 636f   from pycsamt.co
+00015ce0: 7265 2069 6d70 6f72 7420 4176 670d 0a20  re import Avg.. 
+00015cf0: 2020 2020 2020 203e 3e3e 2070 6174 683d         >>> path=
+00015d00: 206f 732e 7061 7468 2e6a 6f69 6e28 6f73   os.path.join(os
+00015d10: 2e65 6e76 6972 6f6e 5b27 7079 4353 414d  .environ['pyCSAM
+00015d20: 5427 5d2c 200d 0a20 2020 2020 2020 202e  T'], ..        .
+00015d30: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00015d40: 2020 2020 2020 2027 7079 6373 616d 7427         'pycsamt'
+00015d50: 2c20 6461 7461 2c20 274c 4353 3031 2e41  , data, 'LCS01.A
+00015d60: 5647 2729 0d0a 2020 2020 2020 2020 3e3e  VG')..        >>
+00015d70: 3e20 6176 675f 6f62 6a3d 2041 7667 2864  > avg_obj= Avg(d
+00015d80: 6174 615f 666e 3d70 6174 6829 200d 0a20  ata_fn=path) .. 
+00015d90: 2020 2020 2020 203e 3e3e 2061 7667 5f6f         >>> avg_o
+00015da0: 626a 2e48 6561 6465 722e 4861 7264 7761  bj.Header.Hardwa
+00015db0: 7265 496e 666f 732e 6672 6571 5f66 696c  reInfos.freq_fil
+00015dc0: 7465 7229 0d0a 2020 2020 2020 2020 3e3e  ter)..        >>
+00015dd0: 3e20 6176 675f 6f62 6a2e 4865 6164 6572  > avg_obj.Header
+00015de0: 2e48 6172 6477 6172 6549 6e66 6f73 2e73  .HardwareInfos.s
+00015df0: 636f 6e66 6967 5f64 6963 745b 2741 4d54  config_dict['AMT
+00015e00: 4156 4727 5d29 0d0a 2020 2020 2222 220d  AVG'])..    """.
+00015e10: 0a0d 0a20 2020 2064 6566 205f 5f69 6e69  ...    def __ini
+00015e20: 745f 5f28 7365 6c66 2c7a 6f6e 6765 5f68  t__(self,zonge_h
+00015e30: 6172 6477 5f69 6e66 6f73 3d4e 6f6e 6520  ardw_infos=None 
+00015e40: 2c20 202a 2a6b 7761 7267 7329 3a0d 0a20  ,  **kwargs):.. 
+00015e50: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00015e60: 2073 656c 662e 7a6f 6e67 655f 6861 7264   self.zonge_hard
+00015e70: 775f 696e 666f 733d 7a6f 6e67 655f 6861  w_infos=zonge_ha
+00015e80: 7264 775f 696e 666f 730d 0a20 2020 2020  rdw_infos..     
+00015e90: 2020 2073 656c 662e 7665 7273 696f 6e20     self.version 
+00015ea0: 3d27 372e 3736 270d 0a20 2020 2020 2020  ='7.76'..       
+00015eb0: 2073 656c 662e 6672 6f6d 5f66 6c64 5f66   self.from_fld_f
+00015ec0: 696c 6520 3d20 4e6f 6e65 200d 0a20 2020  ile = None ..   
+00015ed0: 2020 2020 2073 656c 662e 6461 7465 643d       self.dated=
+00015ee0: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
+00015ef0: 656c 662e 7072 6f63 6573 7365 643d 204e  elf.processed= N
+00015f00: 6f6e 6520 0d0a 2020 2020 2020 2020 7365  one ..        se
+00015f10: 6c66 2e61 7374 6174 6963 5f76 6572 7369  lf.astatic_versi
+00015f20: 6f6e 203d 2027 7633 2e36 3027 0d0a 2020  on = 'v3.60'..  
+00015f30: 2020 2020 2020 7365 6c66 2e75 7064 6174        self.updat
+00015f40: 655f 6461 7461 203d 4e6f 6e65 200d 0a20  e_data =None .. 
+00015f50: 2020 2020 2020 2073 656c 662e 6e75 6d66         self.numf
+00015f60: 696c 7465 7266 7265 713d 4e6f 6e65 0d0a  ilterfreq=None..
+00015f70: 2020 2020 2020 2020 7365 6c66 2e66 7265          self.fre
+00015f80: 715f 6669 6c74 6572 3d4e 6f6e 6520 0d0a  q_filter=None ..
+00015f90: 2020 2020 2020 2020 7365 6c66 2e73 636f          self.sco
+00015fa0: 6e66 6967 5f64 6963 743d 7b27 414d 5441  nfig_dict={'AMTA
+00015fb0: 5647 273a 205b 7365 6c66 2e76 6572 7369  VG': [self.versi
+00015fc0: 6f6e 2c73 656c 662e 6672 6f6d 5f66 6c64  on,self.from_fld
+00015fd0: 5f66 696c 655d 2c20 0d0a 2020 2020 2020  _file], ..      
+00015fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ff0: 2020 2020 2027 4461 7465 6427 3a73 656c       'Dated':sel
+00016000: 662e 6461 7465 642c 0d0a 2020 2020 2020  f.dated,..      
+00016010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016020: 2020 2020 2027 5072 6f63 6573 7365 6427       'Processed'
+00016030: 3a73 656c 662e 7072 6f63 6573 7365 642c  :self.processed,
+00016040: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00016050: 2020 2020 2020 2020 2020 2020 2020 2741                'A
+00016060: 5354 4154 4943 273a 5b73 656c 662e 6173  STATIC':[self.as
+00016070: 7461 7469 635f 7665 7273 696f 6e2c 2073  tatic_version, s
+00016080: 656c 662e 7570 6461 7465 5f64 6174 6120  elf.update_data 
+00016090: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+000160a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000160b0: 223a 277b 307d 2054 4d41 2046 696c 7465  ":'{0} TMA Filte
+000160c0: 7220 6174 207b 317d 2068 6572 747a 272e  r at {1} hertz'.
+000160d0: 666f 726d 6174 280d 0a20 2020 2020 2020  format(..       
+000160e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160f0: 2020 2020 2020 2020 7365 6c66 2e6e 756d          self.num
+00016100: 6669 6c74 6572 6672 6571 2c73 656c 662e  filterfreq,self.
+00016110: 6672 6571 5f66 696c 7465 7220 297d 0d0a  freq_filter )}..
+00016120: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00016130: 6974 6572 5f63 6f70 796c 6566 7420 3d27  iter_copyleft ='
+00016140: 4062 795f 7079 4353 414d 5427 0d0a 2020  @by_pyCSAMT'..  
+00016150: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00016160: 2020 2020 666f 7220 6b65 7920 696e 206c      for key in l
+00016170: 6973 7420 286b 7761 7267 732e 6b65 7973  ist (kwargs.keys
+00016180: 2829 293a 0d0a 2020 2020 2020 2020 2020  ()):..          
+00016190: 2020 6966 206b 6579 206e 6f74 2069 6e20    if key not in 
+000161a0: 5a6f 6e67 6548 6172 6477 6172 652e 5f5f  ZongeHardware.__
+000161b0: 6469 6374 5f5f 2e6b 6579 7328 293a 0d0a  dict__.keys():..
+000161c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000161d0: 7365 7461 7474 7228 6b65 792c 206b 7761  setattr(key, kwa
+000161e0: 7267 735b 6b65 795d 290d 0a20 2020 2020  rgs[key])..     
+000161f0: 2020 200d 0a20 2020 2064 6566 2073 6574     ..    def set
+00016200: 5f68 6172 7761 7265 5f69 6e66 6f73 2028  _harware_infos (
+00016210: 7365 6c66 2c20 7a6f 6e67 655f 6861 7264  self, zonge_hard
+00016220: 775f 696e 666f 7320 3d4e 6f6e 6520 293a  w_infos =None ):
+00016230: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00016240: 2020 2020 2020 204d 6574 686f 6420 746f         Method to
+00016250: 2073 6574 2048 6172 7761 7265 7320 696e   set Harwares in
+00016260: 666f 732e 0d0a 2020 2020 2020 2020 0d0a  fos...        ..
+00016270: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00016280: 7273 200d 0a20 2020 2020 2020 202d 2d2d  rs ..        ---
+00016290: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+000162a0: 2020 2020 202a 207a 6f6e 6765 5f68 6172       * zonge_har
+000162b0: 6477 5f69 6e66 6f73 203a 206c 6973 7420  dw_infos : list 
+000162c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000162d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162e0: 2020 4861 7264 7761 7265 2069 6e66 6f72    Hardware infor
+000162f0: 6d61 7469 6f6e 7320 636f 6c6c 6563 7465  mations collecte
+00016300: 6420 200d 0a20 2020 2020 2020 2022 2222  d  ..        """
+00016310: 0d0a 2020 2020 2020 2020 5f6c 6f67 6765  ..        _logge
+00016320: 722e 696e 666f 2028 2752 6561 6469 6e67  r.info ('Reading
+00016330: 2061 6e64 2073 6574 7469 6e67 2048 6172   and setting Har
+00016340: 7777 6172 6520 696e 666f 726d 6174 696f  wware informatio
+00016350: 6e73 2021 2729 0d0a 2020 2020 2020 2020  ns !')..        
+00016360: 0d0a 2020 2020 2020 2020 6966 207a 6f6e  ..        if zon
+00016370: 6765 5f68 6172 6477 5f69 6e66 6f73 2069  ge_hardw_infos i
+00016380: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
+00016390: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000163a0: 7a6f 6e67 655f 6861 7264 775f 696e 666f  zonge_hardw_info
+000163b0: 733d 7a6f 6e67 655f 6861 7264 775f 696e  s=zonge_hardw_in
+000163c0: 666f 7320 0d0a 2020 2020 2020 2020 6966  fos ..        if
+000163d0: 2073 656c 662e 7a6f 6e67 655f 6861 7264   self.zonge_hard
+000163e0: 775f 696e 666f 7320 6973 204e 6f6e 6520  w_infos is None 
+000163f0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00016400: 7261 6973 6520 4865 6164 6572 4572 726f  raise HeaderErro
+00016410: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00016420: 2020 2020 274e 6f20 696e 666f 726d 6174      'No informat
+00016430: 696f 6e73 2066 726f 6d20 6861 7264 7761  ions from hardwa
+00016440: 7265 2066 6f75 6e64 2021 2729 0d0a 2020  re found !')..  
+00016450: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00016460: 6966 2074 7970 6520 2873 656c 662e 7a6f  if type (self.zo
+00016470: 6e67 655f 6861 7264 775f 696e 666f 7329  nge_hardw_infos)
+00016480: 2069 7320 6e6f 7420 6c69 7374 203a 200d   is not list : .
+00016490: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+000164a0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+000164b0: 2020 2020 2077 6974 6820 6f70 656e 2873       with open(s
+000164c0: 656c 662e 7a6f 6e67 655f 6861 7264 775f  elf.zonge_hardw_
+000164d0: 696e 666f 732c 2027 7227 2c20 656e 636f  infos, 'r', enco
+000164e0: 6469 6e67 3d27 7574 6638 2729 2061 7320  ding='utf8') as 
+000164f0: 667a 6820 3a20 0d0a 2020 2020 2020 2020  fzh : ..        
+00016500: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00016510: 2e7a 6f6e 6765 5f68 6172 6477 5f69 6e66  .zonge_hardw_inf
+00016520: 6f73 3d20 667a 682e 7265 6164 6c69 6e65  os= fzh.readline
+00016530: 7328 290d 0a20 2020 2020 2020 2020 2020  s()..           
+00016540: 2065 7863 6570 7420 3a0d 0a20 2020 2020   except :..     
+00016550: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00016560: 2048 6561 6465 7245 7272 6f72 280d 0a20   HeaderError(.. 
+00016570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016580: 2020 2022 4861 7277 6172 6520 2d20 696e     "Harware - in
+00016590: 666f 7320 6d75 7374 2062 6520 6569 7468  fos must be eith
+000165a0: 6572 2061 206c 6973 7420 6f72 2020 6669  er a list or  fi
+000165b0: 6c65 2021 2229 0d0a 0d0a 2020 2020 2020  le !")....      
+000165c0: 2020 666f 7220 2069 6e66 6f73 2069 6e20    for  infos in 
+000165d0: 7365 6c66 2e7a 6f6e 6765 5f68 6172 6477  self.zonge_hardw
+000165e0: 5f69 6e66 6f73 203a 200d 0a20 2020 2020  _infos : ..     
+000165f0: 2020 2020 2020 2069 6620 2741 4d54 4156         if 'AMTAV
+00016600: 4727 2069 6e20 696e 666f 7320 203a 200d  G' in infos  : .
+00016610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016620: 2074 656d 5f68 3d69 6e66 6f73 2e73 7472   tem_h=infos.str
+00016630: 6970 2829 2e73 706c 6974 2827 2c27 2920  ip().split(',') 
+00016640: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016650: 2020 7365 6c66 2e70 726f 6365 7373 6564    self.processed
+00016660: 203d 6675 6e63 2e5f 7265 6d6f 7665 5f73   =func._remove_s
+00016670: 7472 5f77 6f72 6428 6368 6172 3d74 656d  tr_word(char=tem
+00016680: 5f68 5b2d 315d 2c20 0d0a 2020 2020 2020  _h[-1], ..      
+00016690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166b0: 2020 2020 2020 2020 2020 2020 2077 6f72               wor
+000166c0: 645f 746f 5f72 656d 6f76 653d 2750 726f  d_to_remove='Pro
+000166d0: 6365 7373 6564 2729 0d0a 2020 2020 2020  cessed')..      
+000166e0: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
+000166f0: 6174 6564 3d66 756e 632e 5f72 656d 6f76  ated=func._remov
+00016700: 655f 7374 725f 776f 7264 2863 6861 723d  e_str_word(char=
+00016710: 7465 6d5f 6820 5b2d 325d 2c20 0d0a 2020  tem_h [-2], ..  
+00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016750: 2077 6f72 645f 746f 5f72 656d 6f76 653d   word_to_remove=
+00016760: 2744 6174 6564 2729 0d0a 2020 200d 0a20  'Dated')..   .. 
+00016770: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00016780: 656c 662e 6672 6f6d 5f66 6c64 5f66 696c  elf.from_fld_fil
+00016790: 653d 7465 6d5f 685b 305d 2e73 706c 6974  e=tem_h[0].split
+000167a0: 2827 3a27 295b 2d31 5d0d 0a20 2020 2020  (':')[-1]..     
+000167b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000167c0: 7665 7273 696f 6e20 3d20 7465 6d5f 685b  version = tem_h[
+000167d0: 305d 2e73 706c 6974 2829 5b32 5d0d 0a20  0].split()[2].. 
+000167e0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+000167f0: 2741 5354 4154 4943 2720 696e 2069 6e66  'ASTATIC' in inf
+00016800: 6f73 203a 200d 0a20 2020 2020 2020 2020  os : ..         
+00016810: 2020 2020 2020 2074 656d 5f61 7320 3d69         tem_as =i
+00016820: 6e66 6f73 2e73 7472 6970 2829 2e73 706c  nfos.strip().spl
+00016830: 6974 2829 0d0a 2020 2020 2020 2020 2020  it()..          
+00016840: 2020 2020 2020 7365 6c66 2e61 7374 6174        self.astat
+00016850: 6963 5f76 6572 7369 6f6e 3d74 656d 5f61  ic_version=tem_a
+00016860: 735b 325d 0d0a 2020 2020 2020 2020 2020  s[2]..          
+00016870: 2020 2020 2020 7365 6c66 2e75 7064 6174        self.updat
+00016880: 655f 6461 7461 203d 7465 6d5f 6173 205b  e_data =tem_as [
+00016890: 2d31 5d0d 0a20 2020 2020 2020 2020 2020  -1]..           
+000168a0: 2065 6c69 6620 2754 4d41 2720 696e 2069   elif 'TMA' in i
+000168b0: 6e66 6f73 203a 0d0a 2020 2020 2020 2020  nfos :..        
+000168c0: 2020 2020 2020 2020 7365 6c66 2e65 6e64          self.end
+000168d0: 5f61 7374 6174 6963 5f66 696c 6520 3d69  _astatic_file =i
+000168e0: 6e66 6f73 2e73 7472 6970 2829 2e73 7472  nfos.strip().str
+000168f0: 6970 2827 5c5c 2729 0d0a 2020 2020 2020  ip('\\')..      
+00016900: 2020 2020 2020 2020 2020 7465 6d5f 746d            tem_tm
+00016910: 613d 696e 666f 732e 7374 7269 7028 292e  a=infos.strip().
+00016920: 7370 6c69 7428 290d 0a20 2020 2020 2020  split()..       
+00016930: 2020 2020 2020 2020 2074 7279 203a 200d           try : .
+00016940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016950: 2020 2074 656d 5f74 6d61 3d20 5b66 6c6f     tem_tma= [flo
+00016960: 6174 2873 7329 2066 6f72 2073 7320 696e  at(ss) for ss in
+00016970: 2074 656d 5f74 6d61 205d 0d0a 2020 2020   tem_tma ]..    
+00016980: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00016990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169a0: 6578 6365 7074 203a 2070 6173 7320 0d0a  except : pass ..
 000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169d0: 2020 2020 776f 7264 5f74 6f5f 7265 6d6f      word_to_remo
-000169e0: 7665 3d27 4461 7465 6427 290d 0a20 2020  ve='Dated')..   
-000169f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016a00: 2020 7365 6c66 2e66 726f 6d5f 666c 645f    self.from_fld_
-00016a10: 6669 6c65 3d74 656d 5f68 5b30 5d2e 7370  file=tem_h[0].sp
-00016a20: 6c69 7428 273a 2729 5b2d 315d 0d0a 2020  lit(':')[-1]..  
-00016a30: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00016a40: 6c66 2e76 6572 7369 6f6e 203d 2074 656d  lf.version = tem
-00016a50: 5f68 5b30 5d2e 7370 6c69 7428 295b 325d  _h[0].split()[2]
-00016a60: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00016a70: 6966 2027 4153 5441 5449 4327 2069 6e20  if 'ASTATIC' in 
-00016a80: 696e 666f 7320 3a20 0d0a 2020 2020 2020  infos : ..      
-00016a90: 2020 2020 2020 2020 2020 7465 6d5f 6173            tem_as
-00016aa0: 203d 696e 666f 732e 7374 7269 7028 292e   =infos.strip().
-00016ab0: 7370 6c69 7428 290d 0a20 2020 2020 2020  split()..       
-00016ac0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00016ad0: 7461 7469 635f 7665 7273 696f 6e3d 7465  tatic_version=te
-00016ae0: 6d5f 6173 5b32 5d0d 0a20 2020 2020 2020  m_as[2]..       
-00016af0: 2020 2020 2020 2020 2073 656c 662e 7570           self.up
-00016b00: 6461 7465 5f64 6174 6120 3d74 656d 5f61  date_data =tem_a
-00016b10: 7320 5b2d 315d 0d0a 2020 2020 2020 2020  s [-1]..        
-00016b20: 2020 2020 656c 6966 2027 544d 4127 2069      elif 'TMA' i
-00016b30: 6e20 696e 666f 7320 3a0d 0a20 2020 2020  n infos :..     
-00016b40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00016b50: 656e 645f 6173 7461 7469 635f 6669 6c65  end_astatic_file
-00016b60: 203d 696e 666f 732e 7374 7269 7028 292e   =infos.strip().
-00016b70: 7374 7269 7028 275c 5c27 290d 0a20 2020  strip('\\')..   
-00016b80: 2020 2020 2020 2020 2020 2020 2074 656d               tem
-00016b90: 5f74 6d61 3d69 6e66 6f73 2e73 7472 6970  _tma=infos.strip
-00016ba0: 2829 2e73 706c 6974 2829 0d0a 2020 2020  ().split()..    
-00016bb0: 2020 2020 2020 2020 2020 2020 7472 7920              try 
-00016bc0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00016bd0: 2020 2020 2020 7465 6d5f 746d 613d 205b        tem_tma= [
-00016be0: 666c 6f61 7428 7373 2920 666f 7220 7373  float(ss) for ss
-00016bf0: 2069 6e20 7465 6d5f 746d 6120 5d0d 0a20   in tem_tma ].. 
-00016c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c10: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00016c20: 2020 2065 7863 6570 7420 3a20 7061 7373     except : pass
-00016c30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00016c40: 2020 2073 656c 662e 6e75 6d66 696c 7465     self.numfilte
-00016c50: 7266 7265 7120 3d20 2074 656d 5f74 6d61  rfreq =  tem_tma
-00016c60: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
-00016c70: 2020 2020 2073 656c 662e 6672 6571 5f66       self.freq_f
-00016c80: 696c 7465 7220 3d74 656d 5f74 6d61 5b2d  ilter =tem_tma[-
-00016c90: 325d 0d0a 2020 2020 2020 2020 2020 2020  2]..            
-00016ca0: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
-00016cb0: 6c66 2e73 636f 6e66 6967 5f64 6963 743d  lf.sconfig_dict=
-00016cc0: 7b27 414d 5441 5647 273a 205b 7365 6c66  {'AMTAVG': [self
-00016cd0: 2e76 6572 7369 6f6e 2c73 656c 662e 6672  .version,self.fr
-00016ce0: 6f6d 5f66 6c64 5f66 696c 655d 2c20 0d0a  om_fld_file], ..
-00016cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d00: 2020 2020 2020 2020 2020 2027 4461 7465             'Date
-00016d10: 6427 3a73 656c 662e 6461 7465 642c 0d0a  d':self.dated,..
-00016d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d30: 2020 2020 2020 2020 2020 2027 5072 6f63             'Proc
-00016d40: 6573 7365 6427 3a73 656c 662e 7072 6f63  essed':self.proc
-00016d50: 6573 7365 642c 200d 0a20 2020 2020 2020  essed, ..       
-00016d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d70: 2020 2020 2741 5354 4154 4943 273a 5b73      'ASTATIC':[s
-00016d80: 656c 662e 6173 7461 7469 635f 7665 7273  elf.astatic_vers
-00016d90: 696f 6e2c 2073 656c 662e 7570 6461 7465  ion, self.update
-00016da0: 5f64 6174 6120 5d2c 200d 0a20 2020 2020  _data ], ..     
-00016db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016dc0: 2020 2020 2020 2222 3a27 7b30 7d20 544d        "":'{0} TM
-00016dd0: 4120 4669 6c74 6572 2061 7420 7b31 7d20  A Filter at {1} 
-00016de0: 6865 7274 7a27 2e66 6f72 6d61 7428 7365  hertz'.format(se
-00016df0: 6c66 2e6e 756d 6669 6c74 6572 6672 6571  lf.numfilterfreq
-00016e00: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00016e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e40: 2020 2020 2020 7365 6c66 2e66 7265 715f        self.freq_
-00016e50: 6669 6c74 6572 2029 7d0d 0a0d 0a63 6c61  filter )}....cla
-00016e60: 7373 2044 6174 6120 286f 626a 6563 7429  ss Data (object)
-00016e70: 3a20 0d0a 2020 2020 2222 220d 0a20 2020  : ..    """..   
-00016e80: 2041 5647 2044 6174 6120 696e 666f 726d   AVG Data inform
-00016e90: 6174 696f 6e73 202c 2020 436f 6e74 6169  ations ,  Contai
-00016ea0: 6e65 7220 6f66 2061 6c6c 2064 6174 6120  ner of all data 
-00016eb0: 696e 666f 7320 2e0d 0a20 2020 2020 0d0a  infos ...     ..
-00016ec0: 2020 2020 4172 6775 6d65 6e74 730d 0a20      Arguments.. 
-00016ed0: 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020     ---------..  
-00016ee0: 2020 2020 2020 2a2a 6461 7461 5f61 7272        **data_arr
-00016ef0: 6179 2a2a 2020 3a20 6e70 2e6e 6461 7272  ay**  : np.ndarr
-00016f00: 6179 2020 0d0a 2020 2020 2020 2020 2020  ay  ..          
-00016f10: 2020 2020 2020 2020 2020 2020 2044 6174               Dat
-00016f20: 6120 636f 6c6c 6563 7465 6420 666f 726d  a collected form
-00016f30: 2074 6865 2073 6974 652c 2049 7420 636f   the site, It co
-00016f40: 6e74 6169 6e73 2061 6c6c 2074 6865 2069  ntains all the i
-00016f50: 6e66 6f72 6d61 7469 6f6e 7320 0d0a 2020  nformations ..  
-00016f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f70: 2020 2020 2064 7572 696e 6720 7375 7276       during surv
-00016f80: 6579 2e20 4974 2063 6f75 6c64 2072 6561  ey. It could rea
-00016f90: 6420 6120 2075 7365 7220 6f77 6e20 6461  d a  user own da
-00016fa0: 7461 2062 7569 6c64 200d 0a20 2020 2020  ta build ..     
-00016fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016fc0: 2020 6279 2063 6c61 7373 6966 7969 6e67    by classifying
-00016fd0: 2064 6174 6120 6163 636f 7264 696e 6720   data according 
-00016fe0: 7468 6520 6d61 696e 2041 5647 2066 696c  the main AVG fil
-00016ff0: 6520 0d0a 0d0a 2020 2020 3d3d 3d3d 3d3d  e ....    ======
-00017000: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
-00017010: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
-00017020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00017030: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00017040: 3d3d 3d3d 3d0d 0a20 2020 2041 7474 7269  =====..    Attri
-00017050: 6275 7465 7320 2020 2020 2020 2020 2054  butes          T
-00017060: 7970 6520 2020 2020 2020 2020 2020 2045  ype            E
-00017070: 7870 6c61 6e61 7469 6f6e 0d0a 2020 2020  xplanation..    
-00017080: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00017090: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-000170a0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-000170b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000170c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
-000170d0: 2053 7461 7469 6f6e 2020 2020 2020 2020   Station        
-000170e0: 2020 2020 2028 6e64 6172 7261 792c 2031       (ndarray, 1
-000170f0: 2920 2020 2073 7461 7469 6f6e 206c 656e  )    station len
-00017100: 6774 6820 696e 666f 7320 2e20 756e 6974  gth infos . unit
-00017110: 203a 206d 200d 0a20 2020 2046 7265 7175   : m ..    Frequ
-00017120: 656e 6379 2020 2020 2020 2020 2020 2028  ency           (
-00017130: 6e64 6172 7261 792c 2031 2920 2020 2066  ndarray, 1)    f
-00017140: 7265 7175 656e 6379 2075 7369 6e67 2064  requency using d
-00017150: 7572 696e 6720 7375 7276 6579 202c 756e  uring survey ,un
-00017160: 6974 203a 2048 7a20 200d 0a20 2020 2041  it : Hz  ..    A
-00017170: 6d70 7320 2020 2020 2020 2020 2020 2020  mps             
-00017180: 2020 2028 6e64 6172 7261 792c 2031 2920     (ndarray, 1) 
-00017190: 2020 2063 7572 7265 6e74 2069 6e64 7563     current induc
-000171a0: 7469 6f6e 2076 616c 7565 7320 7573 696e  tion values usin
-000171b0: 6720 6475 7269 6e67 200d 0a20 2020 2020  g during ..     
-000171c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000171d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000171e0: 2020 2073 7572 7665 7920 2c20 756e 6974     survey , unit
-000171f0: 203a 2041 6d70 2020 0d0a 2020 2020 456d   : Amp  ..    Em
-00017200: 6167 2020 2020 2020 2020 2020 2020 2020  ag              
-00017210: 2020 286e 6461 7272 6179 2c20 3129 2020    (ndarray, 1)  
-00017220: 2020 456c 6563 7472 6963 2066 6965 6c64    Electric field
-00017230: 206d 6167 6e69 7475 6465 2855 6e69 742e   magnitude(Unit.
-00017240: 6e56 2f6d 2c6e 562f 416d 2920 0d0a 2020  nV/m,nV/Am) ..  
-00017250: 2020 4570 687a 2020 2020 2020 2020 2020    Ephz          
-00017260: 2020 2020 2020 286e 6461 7272 6179 2c20        (ndarray, 
-00017270: 3129 2020 2020 456c 6563 7472 6963 2066  1)    Electric f
-00017280: 6965 6c64 2070 6861 7365 2020 2875 6e69  ield phase  (uni
-00017290: 742e 206d 7261 6429 0d0a 2020 2020 486d  t. mrad)..    Hm
-000172a0: 6167 2020 2020 2020 2020 2020 2020 2020  ag              
-000172b0: 2020 286e 6461 7272 6179 2c20 3129 2020    (ndarray, 1)  
-000172c0: 2020 4d61 676e 6574 6963 2066 6965 6c64    Magnetic field
-000172d0: 206d 6167 6e69 7475 6465 2028 556e 6974   magnitude (Unit
-000172e0: 2e70 542c 7054 2f41 290d 0a20 2020 2048  .pT,pT/A)..    H
-000172f0: 7068 7a20 2020 2020 2020 2020 2020 2020  phz             
-00017300: 2020 2028 6e64 6172 7261 792c 2031 2920     (ndarray, 1) 
-00017310: 2020 204d 6167 6e65 7469 6320 6669 656c     Magnetic fiel
-00017320: 6420 7068 6173 6520 2875 6e69 742e 206d  d phase (unit. m
-00017330: 7261 6429 0d0a 2020 2020 5265 7369 7374  rad)..    Resist
-00017340: 6976 6974 7920 2020 2020 2020 2020 286e  ivity         (n
-00017350: 6461 7272 6179 2c20 3129 2020 2020 4361  darray, 1)    Ca
-00017360: 676e 6172 6420 6170 7061 7265 6e74 2052  gnard apparent R
-00017370: 6573 6973 7469 7669 7479 0d0a 2020 2020  esistivity..    
-00017380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173a0: 2020 2020 6d61 676e 6974 7564 6520 2875      magnitude (u
-000173b0: 6e69 742e 6f68 6d2e 6d29 0d0a 2020 2020  nit.ohm.m)..    
-000173c0: 5068 6173 6520 2020 2020 2020 2020 2020  Phase           
-000173d0: 2020 2020 286e 6461 7272 6179 2c20 3129      (ndarray, 1)
-000173e0: 2020 2020 496d 7065 6461 6e63 6520 7068      Impedance ph
-000173f0: 6173 6520 2875 6e69 742e 206d 7261 6429  ase (unit. mrad)
-00017400: 0d0a 2020 2020 5a20 2020 2020 2020 2020  ..    Z         
-00017410: 2020 2020 2020 2020 2020 286e 6461 7272            (ndarr
-00017420: 6179 2c20 3129 2020 2020 496d 7065 6461  ay, 1)    Impeda
-00017430: 6e63 6520 6d61 676e 6974 7564 6520 2028  nce magnitude  (
-00017440: 756e 6974 2e20 6b6d 2f73 290d 0a20 2020  unit. km/s)..   
-00017450: 2070 6345 6d61 6720 2020 2020 2020 2020   pcEmag         
-00017460: 2020 2020 2028 6e64 6172 7261 792c 2031       (ndarray, 1
-00017470: 2920 2020 2072 656c 6174 6976 6520 7c45  )    relative |E
-00017480: 7c20 6572 726f 7220 2825 290d 0a20 2020  | error (%)..   
-00017490: 2070 6348 6d61 6720 2020 2020 2020 2020   pcHmag         
-000174a0: 2020 2020 2028 6e64 6172 7261 792c 2031       (ndarray, 1
-000174b0: 2920 2020 2072 656c 6174 6976 6520 7c48  )    relative |H
-000174c0: 7c20 6572 726f 7220 2825 290d 0a20 2020  | error (%)..   
-000174d0: 2073 4570 687a 2020 2020 2020 2020 2020   sEphz          
-000174e0: 2020 2020 2028 6e64 6172 7261 792c 2031       (ndarray, 1
-000174f0: 2920 2020 2070 6861 7365 2845 2920 6572  )    phase(E) er
-00017500: 726f 7220 2875 6e69 742e 6d72 6164 290d  ror (unit.mrad).
-00017510: 0a20 2020 2073 4870 687a 2020 2020 2020  .    sHphz      
-00017520: 2020 2020 2020 2020 2028 6e64 6172 7261           (ndarra
-00017530: 792c 2031 2920 2020 2070 6861 7365 2848  y, 1)    phase(H
-00017540: 2920 6572 726f 7220 2875 6e69 742e 6d72  ) error (unit.mr
-00017550: 6164 290d 0a20 2020 2073 5068 7a20 2020  ad)..    sPhz   
-00017560: 2020 2020 2020 2020 2020 2020 2028 6e64               (nd
-00017570: 6172 7261 792c 2031 2920 2020 2070 6861  array, 1)    pha
-00017580: 7365 285a 2920 6572 726f 7220 2875 6e69  se(Z) error (uni
-00017590: 742e 6d72 6164 290d 0a20 2020 2070 6352  t.mrad)..    pcR
-000175a0: 686f 2020 2020 2020 2020 2020 2020 2020  ho              
-000175b0: 2028 6e64 6172 7261 792c 2031 2920 2020   (ndarray, 1)   
-000175c0: 2072 656c 6174 6976 6520 6170 7061 7265   relative appare
-000175d0: 6e74 2072 6573 6973 7469 7669 7479 0d0a  nt resistivity..
-000175e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017600: 2020 2020 2020 2020 2872 686f 2920 6572          (rho) er
-00017610: 726f 7220 2825 290d 0a20 2020 2061 6464  ror (%)..    add
-00017620: 6564 5f61 7374 6174 6963 5f64 6174 6120  ed_astatic_data 
-00017630: 2028 6e64 6172 7261 792c 2031 2920 2020   (ndarray, 1)   
-00017640: 2073 7461 7469 635f 636f 7272 6563 7465   static_correcte
-00017650: 642d 6170 7061 7265 6e74 0d0a 2020 2020  d-apparent..    
-00017660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017680: 2020 2020 7265 7369 7374 6976 6974 7920      resistivity 
-00017690: 2875 6e69 742e 6f68 6d2e 6d29 0d0a 2020  (unit.ohm.m)..  
-000176a0: 2020 7365 745f 746f 5f64 6567 7265 6520    set_to_degree 
-000176b0: 2020 2020 2020 2020 2020 626f 6f6c 2020            bool  
-000176c0: 2020 2020 2020 7068 6173 6520 616e 676c        phase angl
-000176d0: 6520 7661 6c75 6520 3a69 6620 7365 7420  e value :if set 
-000176e0: 746f 2054 7275 6520 2c20 0d0a 2020 2020  to True , ..    
-000176f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017710: 2020 2020 7661 6c75 656f 6620 7068 6173      valueof phas
-00017720: 6520 7769 6c6c 2062 6520 6f6e 2064 6567  e will be on deg
-00017730: 7265 652e 206d 616b 6520 0d0a 2020 2020  ree. make ..    
-00017740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017760: 2020 2020 7375 7265 2074 6f20 636f 6e76      sure to conv
-00017770: 6572 7465 2074 6865 2064 6174 6120 6f6e  erte the data on
-00017780: 2072 6164 6961 6e20 0d0a 2020 2020 2020   radian ..      
-00017790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177b0: 2020 616e 676c 6562 6566 6f72 6520 6e6f    anglebefore no
-000177c0: 7420 696e 206d 7261 642e 0d0a 2020 2020  t in mrad...    
-000177d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000177e0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-000177f0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-00017800: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00017810: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
-00017820: 200d 0a20 2020 2020 2e2e 206e 6f74 6573   ..     .. notes
-00017830: 203a 3a20 7768 656e 2064 6174 6120 636f   :: when data co
-00017840: 6d65 2073 7472 6169 6768 7466 6f72 7761  me straightforwa
-00017850: 7264 6c79 2066 726f 6d20 4156 4720 6669  rdly from AVG fi
-00017860: 6c65 202c 0d0a 2020 2020 2020 2020 2020  le ,..          
-00017870: 2020 2064 6174 6120 7761 7320 7365 7420     data was set 
-00017880: 7265 7370 6563 7469 6e67 2074 6865 2075  respecting the u
-00017890: 6e69 7420 7072 6f76 6964 6564 2020 5573  nit provided  Us
-000178a0: 6572 206d 7573 7420 7461 6b65 7320 6163  er must takes ac
-000178b0: 636f 756e 7420 0d0a 2020 2020 2020 2020  count ..        
-000178c0: 2020 2020 2066 6f72 2064 6174 6120 7072       for data pr
-000178d0: 6f63 6573 7369 6e67 202e 4120 6c69 7474  ocessing .A litt
-000178e0: 6c65 2062 6974 2020 636f 6e76 6572 7369  le bit  conversi
-000178f0: 6f6e 2069 7320 6e65 6564 6564 2e0d 0a20  on is needed... 
-00017900: 2020 2020 2020 2020 2020 2020 5573 6572              User
-00017910: 2063 616e 2075 7365 2061 2073 7065 6369   can use a speci
-00017920: 616c 2066 756e 6374 696f 6e2e 204e 6f72  al function. Nor
-00017930: 6d61 6c69 7a65 645f 7374 6174 696f 6e5f  malized_station_
-00017940: 7661 6c75 6520 7061 7261 6d65 7465 7220  value parameter 
-00017950: 0d0a 2020 2020 2020 2020 2020 2020 206e  ..             n
-00017960: 6f72 6d61 6c69 7a65 2073 7461 7469 6f6e  ormalize station
-00017970: 2076 616c 7565 202e 2069 6620 7365 7420   value . if set 
-00017980: 746f 2074 7275 6520 7374 6174 696f 6e20  to true station 
-00017990: 7769 6c6c 2073 7461 7274 6564 206e 616d  will started nam
-000179a0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-000179b0: 6672 6f6d 2030 2074 6f20 6e0d 0a20 2020  from 0 to n..   
-000179c0: 2020 2020 2020 2020 2020 2020 202e 2e2e               ...
-000179d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000179e0: 2020 0d0a 2020 2020 4d6f 7265 2061 7474    ..    More att
-000179f0: 7269 6275 7465 7320 6361 6e20 6265 2061  ributes can be a
-00017a00: 6464 6564 2062 7920 696e 7075 7469 6e67  dded by inputing
-00017a10: 2061 206b 6579 2077 6f72 6420 6469 6374   a key word dict
-00017a20: 696f 6e61 7279 0d0a 0d0a 2020 2020 3a45  ionary....    :E
-00017a30: 7861 6d70 6c65 3a0d 0a20 2020 2020 2020  xample:..       
-00017a40: 200d 0a20 2020 2020 2020 203e 3e3e 2066   ..        >>> f
-00017a50: 726f 6d20 7079 6373 616d 742e 6666 2e63  rom pycsamt.ff.c
-00017a60: 6f72 6520 696d 706f 7274 2041 7667 0d0a  ore import Avg..
-00017a70: 2020 2020 2020 2020 3e3e 3e20 4441 5441          >>> DATA
-00017a80: 3d44 6174 6128 6461 7461 5f61 7272 6179  =Data(data_array
-00017a90: 3d61 7667 5f64 6174 6120 290d 0a20 2020  =avg_data )..   
-00017aa0: 2020 2020 203e 3e3e 2073 746e 3d44 4154       >>> stn=DAT
-00017ab0: 412e 5374 6174 696f 6e2e 6e61 6d65 200d  A.Station.name .
-00017ac0: 0a20 2020 2020 2020 203e 3e3e 2066 7265  .        >>> fre
-00017ad0: 713d 4441 5441 2e46 7265 7175 656e 6379  q=DATA.Frequency
-00017ae0: 2e76 616c 7565 0d0a 2020 2020 2222 220d  .value..    """.
-00017af0: 0a20 2020 200d 0a20 2020 2064 6566 205f  .    ..    def _
-00017b00: 5f69 6e69 745f 5f28 7365 6c66 2c20 6461  _init__(self, da
-00017b10: 7461 5f61 7272 6179 3d4e 6f6e 6520 2c20  ta_array=None , 
-00017b20: 2a2a 6b77 6172 6773 293a 0d0a 2020 2020  **kwargs):..    
-00017b30: 2020 2020 7365 6c66 2e5f 6c6f 6767 696e      self._loggin
-00017b40: 6720 3d63 7361 6d74 7079 6c6f 672e 6765  g =csamtpylog.ge
-00017b50: 745f 6373 616d 7470 795f 6c6f 6767 6572  t_csamtpy_logger
-00017b60: 2873 656c 662e 5f5f 636c 6173 735f 5f2e  (self.__class__.
-00017b70: 5f5f 6e61 6d65 5f5f 290d 0a20 2020 2020  __name__)..     
-00017b80: 2020 2073 656c 662e 5f64 6174 615f 6172     self._data_ar
-00017b90: 7261 7920 3d20 6461 7461 5f61 7272 6179  ray = data_array
-00017ba0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00017bb0: 2020 2020 2073 656c 662e 5374 6174 696f       self.Statio
-00017bc0: 6e20 3d53 7461 7469 6f6e 2829 0d0a 2020  n =Station()..  
-00017bd0: 2020 2020 2020 7365 6c66 2e46 7265 7175        self.Frequ
-00017be0: 656e 6379 3d46 7265 7175 656e 6379 2829  ency=Frequency()
-00017bf0: 0d0a 2020 2020 2020 2020 7365 6c66 2e41  ..        self.A
-00017c00: 6d70 7320 3d41 6d70 7328 290d 0a20 2020  mps =Amps()..   
-00017c10: 2020 2020 2073 656c 662e 456d 6167 3d45       self.Emag=E
-00017c20: 6d61 6728 290d 0a20 2020 2020 2020 2073  mag()..        s
-00017c30: 656c 662e 4570 687a 3d45 7068 7a28 290d  elf.Ephz=Ephz().
-00017c40: 0a20 2020 2020 2020 2073 656c 662e 486d  .        self.Hm
-00017c50: 6167 3d48 6d61 6728 290d 0a20 2020 2020  ag=Hmag()..     
-00017c60: 2020 2073 656c 662e 4870 687a 3d48 7068     self.Hphz=Hph
-00017c70: 7a28 290d 0a20 2020 2020 2020 2073 656c  z()..        sel
-00017c80: 662e 5265 7369 7374 6976 6974 793d 5265  f.Resistivity=Re
-00017c90: 7369 7374 6976 6974 7928 290d 0a20 2020  sistivity()..   
-00017ca0: 2020 2020 2073 656c 662e 5068 6173 6520       self.Phase 
-00017cb0: 3d50 6861 7365 2829 0d0a 2020 2020 2020  =Phase()..      
-00017cc0: 2020 7365 6c66 2e5a 203d 5a5f 5465 6e73    self.Z =Z_Tens
-00017cd0: 6f72 2829 0d0a 2020 2020 2020 2020 7365  or()..        se
-00017ce0: 6c66 2e70 6345 6d61 673d 7063 456d 6167  lf.pcEmag=pcEmag
-00017cf0: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
-00017d00: 2e73 4570 687a 3d73 4570 687a 2829 0d0a  .sEphz=sEphz()..
-00017d10: 2020 2020 2020 2020 7365 6c66 2e70 6348          self.pcH
-00017d20: 6d61 673d 7063 486d 6167 2829 0d0a 2020  mag=pcHmag()..  
-00017d30: 2020 2020 2020 7365 6c66 2e73 4870 687a        self.sHphz
-00017d40: 3d73 4870 687a 2829 2020 0d0a 2020 2020  =sHphz()  ..    
-00017d50: 2020 2020 7365 6c66 2e70 6352 686f 3d70      self.pcRho=p
-00017d60: 6352 686f 2829 0d0a 2020 2020 2020 2020  cRho()..        
-00017d70: 7365 6c66 2e73 5068 7a3d 7350 687a 2829  self.sPhz=sPhz()
-00017d80: 0d0a 2020 2020 2020 2020 0d0a 2020 200d  ..        ..   .
-00017d90: 0a20 2020 2020 2020 2073 656c 662e 6164  .        self.ad
-00017da0: 6465 645f 6173 7461 7469 635f 6461 7461  ded_astatic_data
-00017db0: 3d20 4e6f 6e65 200d 0a20 2020 2020 2020  = None ..       
-00017dc0: 2073 656c 662e 5f6e 756d 6265 725f 6f66   self._number_of
-00017dd0: 5f66 7265 7175 656e 6369 6573 3d4e 6f6e  _frequencies=Non
-00017de0: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
-00017df0: 2e5f 6e75 6d5f 6f66 5f73 7461 7469 6f6e  ._num_of_station
-00017e00: 733d 4e6f 6e65 200d 0a20 2020 2020 2020  s=None ..       
-00017e10: 2073 656c 662e 6e6f 726d 616c 697a 6564   self.normalized
-00017e20: 5f73 7461 7469 6f6e 5f76 616c 7565 3d6b  _station_value=k
-00017e30: 7761 7267 732e 706f 7028 276e 6f72 6d61  wargs.pop('norma
-00017e40: 6c69 7a65 645f 7374 6174 696f 6e5f 7661  lized_station_va
-00017e50: 6c75 6527 2c20 4661 6c73 6529 0d0a 2020  lue', False)..  
-00017e60: 2020 2020 2020 7365 6c66 2e73 6574 5f74        self.set_t
-00017e70: 6f5f 6465 6772 6565 203d 6b77 6172 6773  o_degree =kwargs
-00017e80: 2e70 6f70 2827 7365 745f 7068 6173 655f  .pop('set_phase_
-00017e90: 616e 676c 655f 746f 5f64 6567 272c 2046  angle_to_deg', F
-00017ea0: 616c 7365 290d 0a20 2020 2020 2020 200d  alse)..        .
-00017eb0: 0a20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-00017ec0: 2020 2020 2020 7365 6c66 2e5f 6620 3d20        self._f = 
-00017ed0: 4e6f 6e65 200d 0a20 2020 2020 2020 200d  None ..        .
-00017ee0: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
-00017ef0: 2069 6e20 6c69 7374 286b 7761 7267 732e   in list(kwargs.
-00017f00: 6b65 7973 2829 293a 0d0a 2020 2020 2020  keys()):..      
-00017f10: 2020 2020 2020 7365 7461 7474 7228 7365        setattr(se
-00017f20: 6c66 2c20 6b65 792c 206b 7761 7267 735b  lf, key, kwargs[
-00017f30: 6b65 795d 290d 0a20 2020 2020 2020 2020  key])..         
-00017f40: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-00017f50: 7365 6c66 2e5f 6461 7461 5f61 7272 6179  self._data_array
-00017f60: 2069 7320 6e6f 7420 4e6f 6e65 203a 0d0a   is not None :..
-00017f70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017f80: 2e5f 6176 675f 7365 745f 636f 6d70 6f6e  ._avg_set_compon
-00017f90: 656e 7473 5f66 726f 6d5f 6461 7461 2829  ents_from_data()
-00017fa0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00017fb0: 6465 6620 5f61 7667 5f73 6574 5f63 6f6d  def _avg_set_com
-00017fc0: 706f 6e65 6e74 735f 6672 6f6d 5f64 6174  ponents_from_dat
-00017fd0: 6120 2873 656c 662c 2064 6174 615f 6172  a (self, data_ar
-00017fe0: 7261 793d 4e6f 6e65 202c 6461 7461 5f74  ray=None ,data_t
-00017ff0: 7970 653d 4e6f 6e65 2c20 0d0a 2020 2020  ype=None, ..    
+000169c0: 7365 6c66 2e6e 756d 6669 6c74 6572 6672  self.numfilterfr
+000169d0: 6571 203d 2020 7465 6d5f 746d 615b 315d  eq =  tem_tma[1]
+000169e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000169f0: 2020 7365 6c66 2e66 7265 715f 6669 6c74    self.freq_filt
+00016a00: 6572 203d 7465 6d5f 746d 615b 2d32 5d0d  er =tem_tma[-2].
+00016a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016a20: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00016a30: 7363 6f6e 6669 675f 6469 6374 3d7b 2741  sconfig_dict={'A
+00016a40: 4d54 4156 4727 3a20 5b73 656c 662e 7665  MTAVG': [self.ve
+00016a50: 7273 696f 6e2c 7365 6c66 2e66 726f 6d5f  rsion,self.from_
+00016a60: 666c 645f 6669 6c65 5d2c 200d 0a20 2020  fld_file], ..   
+00016a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a80: 2020 2020 2020 2020 2744 6174 6564 273a          'Dated':
+00016a90: 7365 6c66 2e64 6174 6564 2c0d 0a20 2020  self.dated,..   
+00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ab0: 2020 2020 2020 2020 2750 726f 6365 7373          'Process
+00016ac0: 6564 273a 7365 6c66 2e70 726f 6365 7373  ed':self.process
+00016ad0: 6564 2c20 0d0a 2020 2020 2020 2020 2020  ed, ..          
+00016ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016af0: 2027 4153 5441 5449 4327 3a5b 7365 6c66   'ASTATIC':[self
+00016b00: 2e61 7374 6174 6963 5f76 6572 7369 6f6e  .astatic_version
+00016b10: 2c20 7365 6c66 2e75 7064 6174 655f 6461  , self.update_da
+00016b20: 7461 205d 2c20 0d0a 2020 2020 2020 2020  ta ], ..        
+00016b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b40: 2020 2022 223a 277b 307d 2054 4d41 2046     "":'{0} TMA F
+00016b50: 696c 7465 7220 6174 207b 317d 2068 6572  ilter at {1} her
+00016b60: 747a 272e 666f 726d 6174 2873 656c 662e  tz'.format(self.
+00016b70: 6e75 6d66 696c 7465 7266 7265 712c 0d0a  numfilterfreq,..
+00016b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016bc0: 2020 2073 656c 662e 6672 6571 5f66 696c     self.freq_fil
+00016bd0: 7465 7220 297d 0d0a 0d0a 636c 6173 7320  ter )}....class 
+00016be0: 4461 7461 2028 6f62 6a65 6374 293a 200d  Data (object): .
+00016bf0: 0a20 2020 2022 2222 0d0a 2020 2020 4156  .    """..    AV
+00016c00: 4720 4461 7461 2069 6e66 6f72 6d61 7469  G Data informati
+00016c10: 6f6e 7320 2c20 2043 6f6e 7461 696e 6572  ons ,  Container
+00016c20: 206f 6620 616c 6c20 6461 7461 2069 6e66   of all data inf
+00016c30: 6f73 202e 0d0a 2020 2020 200d 0a20 2020  os ...     ..   
+00016c40: 2041 7267 756d 656e 7473 0d0a 2020 2020   Arguments..    
+00016c50: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00016c60: 2020 202a 2a64 6174 615f 6172 7261 792a     **data_array*
+00016c70: 2a20 203a 206e 702e 6e64 6172 7261 7920  *  : np.ndarray 
+00016c80: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00016c90: 2020 2020 2020 2020 2020 4461 7461 2063            Data c
+00016ca0: 6f6c 6c65 6374 6564 2066 6f72 6d20 7468  ollected form th
+00016cb0: 6520 7369 7465 2c20 4974 2063 6f6e 7461  e site, It conta
+00016cc0: 696e 7320 616c 6c20 7468 6520 696e 666f  ins all the info
+00016cd0: 726d 6174 696f 6e73 200d 0a20 2020 2020  rmations ..     
+00016ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cf0: 2020 6475 7269 6e67 2073 7572 7665 792e    during survey.
+00016d00: 2049 7420 636f 756c 6420 7265 6164 2061   It could read a
+00016d10: 2020 7573 6572 206f 776e 2064 6174 6120    user own data 
+00016d20: 6275 696c 6420 0d0a 2020 2020 2020 2020  build ..        
+00016d30: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00016d40: 7920 636c 6173 7369 6679 696e 6720 6461  y classifying da
+00016d50: 7461 2061 6363 6f72 6469 6e67 2074 6865  ta according the
+00016d60: 206d 6169 6e20 4156 4720 6669 6c65 200d   main AVG file .
+00016d70: 0a0d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d  ...    =========
+00016d80: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+00016d90: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+00016da0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016db0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016dc0: 3d3d 0d0a 2020 2020 4174 7472 6962 7574  ==..    Attribut
+00016dd0: 6573 2020 2020 2020 2020 2020 5479 7065  es          Type
+00016de0: 2020 2020 2020 2020 2020 2020 4578 706c              Expl
+00016df0: 616e 6174 696f 6e0d 0a20 2020 203d 3d3d  anation..    ===
+00016e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+00016e10: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20   ============== 
+00016e20: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00016e30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00016e40: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 5374  ========..    St
+00016e50: 6174 696f 6e20 2020 2020 2020 2020 2020  ation           
+00016e60: 2020 286e 6461 7272 6179 2c20 3129 2020    (ndarray, 1)  
+00016e70: 2020 7374 6174 696f 6e20 6c65 6e67 7468    station length
+00016e80: 2069 6e66 6f73 202e 2075 6e69 7420 3a20   infos . unit : 
+00016e90: 6d20 0d0a 2020 2020 4672 6571 7565 6e63  m ..    Frequenc
+00016ea0: 7920 2020 2020 2020 2020 2020 286e 6461  y           (nda
+00016eb0: 7272 6179 2c20 3129 2020 2020 6672 6571  rray, 1)    freq
+00016ec0: 7565 6e63 7920 7573 696e 6720 6475 7269  uency using duri
+00016ed0: 6e67 2073 7572 7665 7920 2c75 6e69 7420  ng survey ,unit 
+00016ee0: 3a20 487a 2020 0d0a 2020 2020 416d 7073  : Hz  ..    Amps
+00016ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f00: 286e 6461 7272 6179 2c20 3129 2020 2020  (ndarray, 1)    
+00016f10: 6375 7272 656e 7420 696e 6475 6374 696f  current inductio
+00016f20: 6e20 7661 6c75 6573 2075 7369 6e67 2064  n values using d
+00016f30: 7572 696e 6720 0d0a 2020 2020 2020 2020  uring ..        
+00016f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f60: 7375 7276 6579 202c 2075 6e69 7420 3a20  survey , unit : 
+00016f70: 416d 7020 200d 0a20 2020 2045 6d61 6720  Amp  ..    Emag 
+00016f80: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00016f90: 6e64 6172 7261 792c 2031 2920 2020 2045  ndarray, 1)    E
+00016fa0: 6c65 6374 7269 6320 6669 656c 6420 6d61  lectric field ma
+00016fb0: 676e 6974 7564 6528 556e 6974 2e6e 562f  gnitude(Unit.nV/
+00016fc0: 6d2c 6e56 2f41 6d29 200d 0a20 2020 2045  m,nV/Am) ..    E
+00016fd0: 7068 7a20 2020 2020 2020 2020 2020 2020  phz             
+00016fe0: 2020 2028 6e64 6172 7261 792c 2031 2920     (ndarray, 1) 
+00016ff0: 2020 2045 6c65 6374 7269 6320 6669 656c     Electric fiel
+00017000: 6420 7068 6173 6520 2028 756e 6974 2e20  d phase  (unit. 
+00017010: 6d72 6164 290d 0a20 2020 2048 6d61 6720  mrad)..    Hmag 
+00017020: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00017030: 6e64 6172 7261 792c 2031 2920 2020 204d  ndarray, 1)    M
+00017040: 6167 6e65 7469 6320 6669 656c 6420 6d61  agnetic field ma
+00017050: 676e 6974 7564 6520 2855 6e69 742e 7054  gnitude (Unit.pT
+00017060: 2c70 542f 4129 0d0a 2020 2020 4870 687a  ,pT/A)..    Hphz
+00017070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017080: 286e 6461 7272 6179 2c20 3129 2020 2020  (ndarray, 1)    
+00017090: 4d61 676e 6574 6963 2066 6965 6c64 2070  Magnetic field p
+000170a0: 6861 7365 2028 756e 6974 2e20 6d72 6164  hase (unit. mrad
+000170b0: 290d 0a20 2020 2052 6573 6973 7469 7669  )..    Resistivi
+000170c0: 7479 2020 2020 2020 2020 2028 6e64 6172  ty         (ndar
+000170d0: 7261 792c 2031 2920 2020 2043 6167 6e61  ray, 1)    Cagna
+000170e0: 7264 2061 7070 6172 656e 7420 5265 7369  rd apparent Resi
+000170f0: 7374 6976 6974 790d 0a20 2020 2020 2020  stivity..       
+00017100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017120: 206d 6167 6e69 7475 6465 2028 756e 6974   magnitude (unit
+00017130: 2e6f 686d 2e6d 290d 0a20 2020 2050 6861  .ohm.m)..    Pha
+00017140: 7365 2020 2020 2020 2020 2020 2020 2020  se              
+00017150: 2028 6e64 6172 7261 792c 2031 2920 2020   (ndarray, 1)   
+00017160: 2049 6d70 6564 616e 6365 2070 6861 7365   Impedance phase
+00017170: 2028 756e 6974 2e20 6d72 6164 290d 0a20   (unit. mrad).. 
+00017180: 2020 205a 2020 2020 2020 2020 2020 2020     Z            
+00017190: 2020 2020 2020 2028 6e64 6172 7261 792c         (ndarray,
+000171a0: 2031 2920 2020 2049 6d70 6564 616e 6365   1)    Impedance
+000171b0: 206d 6167 6e69 7475 6465 2020 2875 6e69   magnitude  (uni
+000171c0: 742e 206b 6d2f 7329 0d0a 2020 2020 7063  t. km/s)..    pc
+000171d0: 456d 6167 2020 2020 2020 2020 2020 2020  Emag            
+000171e0: 2020 286e 6461 7272 6179 2c20 3129 2020    (ndarray, 1)  
+000171f0: 2020 7265 6c61 7469 7665 207c 457c 2065    relative |E| e
+00017200: 7272 6f72 2028 2529 0d0a 2020 2020 7063  rror (%)..    pc
+00017210: 486d 6167 2020 2020 2020 2020 2020 2020  Hmag            
+00017220: 2020 286e 6461 7272 6179 2c20 3129 2020    (ndarray, 1)  
+00017230: 2020 7265 6c61 7469 7665 207c 487c 2065    relative |H| e
+00017240: 7272 6f72 2028 2529 0d0a 2020 2020 7345  rror (%)..    sE
+00017250: 7068 7a20 2020 2020 2020 2020 2020 2020  phz             
+00017260: 2020 286e 6461 7272 6179 2c20 3129 2020    (ndarray, 1)  
+00017270: 2020 7068 6173 6528 4529 2065 7272 6f72    phase(E) error
+00017280: 2028 756e 6974 2e6d 7261 6429 0d0a 2020   (unit.mrad)..  
+00017290: 2020 7348 7068 7a20 2020 2020 2020 2020    sHphz         
+000172a0: 2020 2020 2020 286e 6461 7272 6179 2c20        (ndarray, 
+000172b0: 3129 2020 2020 7068 6173 6528 4829 2065  1)    phase(H) e
+000172c0: 7272 6f72 2028 756e 6974 2e6d 7261 6429  rror (unit.mrad)
+000172d0: 0d0a 2020 2020 7350 687a 2020 2020 2020  ..    sPhz      
+000172e0: 2020 2020 2020 2020 2020 286e 6461 7272            (ndarr
+000172f0: 6179 2c20 3129 2020 2020 7068 6173 6528  ay, 1)    phase(
+00017300: 5a29 2065 7272 6f72 2028 756e 6974 2e6d  Z) error (unit.m
+00017310: 7261 6429 0d0a 2020 2020 7063 5268 6f20  rad)..    pcRho 
+00017320: 2020 2020 2020 2020 2020 2020 2020 286e                (n
+00017330: 6461 7272 6179 2c20 3129 2020 2020 7265  darray, 1)    re
+00017340: 6c61 7469 7665 2061 7070 6172 656e 7420  lative apparent 
+00017350: 7265 7369 7374 6976 6974 790d 0a20 2020  resistivity..   
+00017360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017380: 2020 2020 2028 7268 6f29 2065 7272 6f72       (rho) error
+00017390: 2028 2529 0d0a 2020 2020 6164 6465 645f   (%)..    added_
+000173a0: 6173 7461 7469 635f 6461 7461 2020 286e  astatic_data  (n
+000173b0: 6461 7272 6179 2c20 3129 2020 2020 7374  darray, 1)    st
+000173c0: 6174 6963 5f63 6f72 7265 6374 6564 2d61  atic_corrected-a
+000173d0: 7070 6172 656e 740d 0a20 2020 2020 2020  pparent..       
+000173e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000173f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017400: 2072 6573 6973 7469 7669 7479 2028 756e   resistivity (un
+00017410: 6974 2e6f 686d 2e6d 290d 0a20 2020 2073  it.ohm.m)..    s
+00017420: 6574 5f74 6f5f 6465 6772 6565 2020 2020  et_to_degree    
+00017430: 2020 2020 2020 2062 6f6f 6c20 2020 2020         bool     
+00017440: 2020 2070 6861 7365 2061 6e67 6c65 2076     phase angle v
+00017450: 616c 7565 203a 6966 2073 6574 2074 6f20  alue :if set to 
+00017460: 5472 7565 202c 200d 0a20 2020 2020 2020  True , ..       
+00017470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017490: 2076 616c 7565 6f66 2070 6861 7365 2077   valueof phase w
+000174a0: 696c 6c20 6265 206f 6e20 6465 6772 6565  ill be on degree
+000174b0: 2e20 6d61 6b65 200d 0a20 2020 2020 2020  . make ..       
+000174c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174e0: 2073 7572 6520 746f 2063 6f6e 7665 7274   sure to convert
+000174f0: 6520 7468 6520 6461 7461 206f 6e20 7261  e the data on ra
+00017500: 6469 616e 200d 0a20 2020 2020 2020 2020  dian ..         
+00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017520: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00017530: 6e67 6c65 6265 666f 7265 206e 6f74 2069  nglebefore not i
+00017540: 6e20 6d72 6164 2e0d 0a20 2020 203d 3d3d  n mrad...    ===
+00017550: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+00017560: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20   ============== 
+00017570: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00017580: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00017590: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 0d0a  ========..    ..
+000175a0: 2020 2020 202e 2e20 6e6f 7465 7320 3a3a       .. notes ::
+000175b0: 2077 6865 6e20 6461 7461 2063 6f6d 6520   when data come 
+000175c0: 7374 7261 6967 6874 666f 7277 6172 646c  straightforwardl
+000175d0: 7920 6672 6f6d 2041 5647 2066 696c 6520  y from AVG file 
+000175e0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000175f0: 6461 7461 2077 6173 2073 6574 2072 6573  data was set res
+00017600: 7065 6374 696e 6720 7468 6520 756e 6974  pecting the unit
+00017610: 2070 726f 7669 6465 6420 2055 7365 7220   provided  User 
+00017620: 6d75 7374 2074 616b 6573 2061 6363 6f75  must takes accou
+00017630: 6e74 200d 0a20 2020 2020 2020 2020 2020  nt ..           
+00017640: 2020 666f 7220 6461 7461 2070 726f 6365    for data proce
+00017650: 7373 696e 6720 2e41 206c 6974 746c 6520  ssing .A little 
+00017660: 6269 7420 2063 6f6e 7665 7273 696f 6e20  bit  conversion 
+00017670: 6973 206e 6565 6465 642e 0d0a 2020 2020  is needed...    
+00017680: 2020 2020 2020 2020 2055 7365 7220 6361           User ca
+00017690: 6e20 7573 6520 6120 7370 6563 6961 6c20  n use a special 
+000176a0: 6675 6e63 7469 6f6e 2e20 4e6f 726d 616c  function. Normal
+000176b0: 697a 6564 5f73 7461 7469 6f6e 5f76 616c  ized_station_val
+000176c0: 7565 2070 6172 616d 6574 6572 200d 0a20  ue parameter .. 
+000176d0: 2020 2020 2020 2020 2020 2020 6e6f 726d              norm
+000176e0: 616c 697a 6520 7374 6174 696f 6e20 7661  alize station va
+000176f0: 6c75 6520 2e20 6966 2073 6574 2074 6f20  lue . if set to 
+00017700: 7472 7565 2073 7461 7469 6f6e 2077 696c  true station wil
+00017710: 6c20 7374 6172 7465 6420 6e61 6d65 0d0a  l started name..
+00017720: 2020 2020 2020 2020 2020 2020 2066 726f               fro
+00017730: 6d20 3020 746f 206e 0d0a 2020 2020 2020  m 0 to n..      
+00017740: 2020 2020 2020 2020 2020 2e2e 2e0d 0a20            ..... 
+00017750: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00017760: 0a20 2020 204d 6f72 6520 6174 7472 6962  .    More attrib
+00017770: 7574 6573 2063 616e 2062 6520 6164 6465  utes can be adde
+00017780: 6420 6279 2069 6e70 7574 696e 6720 6120  d by inputing a 
+00017790: 6b65 7920 776f 7264 2064 6963 7469 6f6e  key word diction
+000177a0: 6172 790d 0a0d 0a20 2020 203a 4578 616d  ary....    :Exam
+000177b0: 706c 653a 0d0a 2020 2020 2020 2020 0d0a  ple:..        ..
+000177c0: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
+000177d0: 2070 7963 7361 6d74 2e63 6f72 6520 696d   pycsamt.core im
+000177e0: 706f 7274 2041 7667 0d0a 2020 2020 2020  port Avg..      
+000177f0: 2020 3e3e 3e20 4441 5441 3d44 6174 6128    >>> DATA=Data(
+00017800: 6461 7461 5f61 7272 6179 3d61 7667 5f64  data_array=avg_d
+00017810: 6174 6120 290d 0a20 2020 2020 2020 203e  ata )..        >
+00017820: 3e3e 2073 746e 3d44 4154 412e 5374 6174  >> stn=DATA.Stat
+00017830: 696f 6e2e 6e61 6d65 200d 0a20 2020 2020  ion.name ..     
+00017840: 2020 203e 3e3e 2066 7265 713d 4441 5441     >>> freq=DATA
+00017850: 2e46 7265 7175 656e 6379 2e76 616c 7565  .Frequency.value
+00017860: 0d0a 2020 2020 2222 220d 0a20 2020 200d  ..    """..    .
+00017870: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00017880: 5f28 7365 6c66 2c20 6461 7461 5f61 7272  _(self, data_arr
+00017890: 6179 3d4e 6f6e 6520 2c20 2a2a 6b77 6172  ay=None , **kwar
+000178a0: 6773 293a 0d0a 2020 2020 2020 2020 7365  gs):..        se
+000178b0: 6c66 2e5f 6c6f 6767 696e 6720 3d63 7361  lf._logging =csa
+000178c0: 6d74 7079 6c6f 672e 6765 745f 6373 616d  mtpylog.get_csam
+000178d0: 7470 795f 6c6f 6767 6572 2873 656c 662e  tpy_logger(self.
+000178e0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+000178f0: 5f5f 290d 0a20 2020 2020 2020 2073 656c  __)..        sel
+00017900: 662e 5f64 6174 615f 6172 7261 7920 3d20  f._data_array = 
+00017910: 6461 7461 5f61 7272 6179 200d 0a20 2020  data_array ..   
+00017920: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+00017930: 656c 662e 5374 6174 696f 6e20 3d53 7461  elf.Station =Sta
+00017940: 7469 6f6e 2829 0d0a 2020 2020 2020 2020  tion()..        
+00017950: 7365 6c66 2e46 7265 7175 656e 6379 3d46  self.Frequency=F
+00017960: 7265 7175 656e 6379 2829 0d0a 2020 2020  requency()..    
+00017970: 2020 2020 7365 6c66 2e41 6d70 7320 3d41      self.Amps =A
+00017980: 6d70 7328 290d 0a20 2020 2020 2020 2073  mps()..        s
+00017990: 656c 662e 456d 6167 3d45 6d61 6728 290d  elf.Emag=Emag().
+000179a0: 0a20 2020 2020 2020 2073 656c 662e 4570  .        self.Ep
+000179b0: 687a 3d45 7068 7a28 290d 0a20 2020 2020  hz=Ephz()..     
+000179c0: 2020 2073 656c 662e 486d 6167 3d48 6d61     self.Hmag=Hma
+000179d0: 6728 290d 0a20 2020 2020 2020 2073 656c  g()..        sel
+000179e0: 662e 4870 687a 3d48 7068 7a28 290d 0a20  f.Hphz=Hphz().. 
+000179f0: 2020 2020 2020 2073 656c 662e 5265 7369         self.Resi
+00017a00: 7374 6976 6974 793d 5265 7369 7374 6976  stivity=Resistiv
+00017a10: 6974 7928 290d 0a20 2020 2020 2020 2073  ity()..        s
+00017a20: 656c 662e 5068 6173 6520 3d50 6861 7365  elf.Phase =Phase
+00017a30: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
+00017a40: 2e5a 203d 5a5f 5465 6e73 6f72 2829 0d0a  .Z =Z_Tensor()..
+00017a50: 2020 2020 2020 2020 7365 6c66 2e70 6345          self.pcE
+00017a60: 6d61 673d 7063 456d 6167 2829 0d0a 2020  mag=pcEmag()..  
+00017a70: 2020 2020 2020 7365 6c66 2e73 4570 687a        self.sEphz
+00017a80: 3d73 4570 687a 2829 0d0a 2020 2020 2020  =sEphz()..      
+00017a90: 2020 7365 6c66 2e70 6348 6d61 673d 7063    self.pcHmag=pc
+00017aa0: 486d 6167 2829 0d0a 2020 2020 2020 2020  Hmag()..        
+00017ab0: 7365 6c66 2e73 4870 687a 3d73 4870 687a  self.sHphz=sHphz
+00017ac0: 2829 2020 0d0a 2020 2020 2020 2020 7365  ()  ..        se
+00017ad0: 6c66 2e70 6352 686f 3d70 6352 686f 2829  lf.pcRho=pcRho()
+00017ae0: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
+00017af0: 5068 7a3d 7350 687a 2829 0d0a 2020 2020  Phz=sPhz()..    
+00017b00: 2020 2020 0d0a 2020 200d 0a20 2020 2020      ..   ..     
+00017b10: 2020 2073 656c 662e 6164 6465 645f 6173     self.added_as
+00017b20: 7461 7469 635f 6461 7461 3d20 4e6f 6e65  tatic_data= None
+00017b30: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00017b40: 5f6e 756d 6265 725f 6f66 5f66 7265 7175  _number_of_frequ
+00017b50: 656e 6369 6573 3d4e 6f6e 6520 0d0a 2020  encies=None ..  
+00017b60: 2020 2020 2020 7365 6c66 2e5f 6e75 6d5f        self._num_
+00017b70: 6f66 5f73 7461 7469 6f6e 733d 4e6f 6e65  of_stations=None
+00017b80: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00017b90: 6e6f 726d 616c 697a 6564 5f73 7461 7469  normalized_stati
+00017ba0: 6f6e 5f76 616c 7565 3d6b 7761 7267 732e  on_value=kwargs.
+00017bb0: 706f 7028 276e 6f72 6d61 6c69 7a65 645f  pop('normalized_
+00017bc0: 7374 6174 696f 6e5f 7661 6c75 6527 2c20  station_value', 
+00017bd0: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
+00017be0: 7365 6c66 2e73 6574 5f74 6f5f 6465 6772  self.set_to_degr
+00017bf0: 6565 203d 6b77 6172 6773 2e70 6f70 2827  ee =kwargs.pop('
+00017c00: 7365 745f 7068 6173 655f 616e 676c 655f  set_phase_angle_
+00017c10: 746f 5f64 6567 272c 2046 616c 7365 290d  to_deg', False).
+00017c20: 0a20 2020 2020 2020 200d 0a20 0d0a 2020  .        .. ..  
+00017c30: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00017c40: 7365 6c66 2e5f 6620 3d20 4e6f 6e65 200d  self._f = None .
+00017c50: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00017c60: 2020 2066 6f72 206b 6579 2069 6e20 6c69     for key in li
+00017c70: 7374 286b 7761 7267 732e 6b65 7973 2829  st(kwargs.keys()
+00017c80: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00017c90: 7365 7461 7474 7228 7365 6c66 2c20 6b65  setattr(self, ke
+00017ca0: 792c 206b 7761 7267 735b 6b65 795d 290d  y, kwargs[key]).
+00017cb0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00017cc0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00017cd0: 6461 7461 5f61 7272 6179 2069 7320 6e6f  data_array is no
+00017ce0: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
+00017cf0: 2020 2020 2020 7365 6c66 2e5f 6176 675f        self._avg_
+00017d00: 7365 745f 636f 6d70 6f6e 656e 7473 5f66  set_components_f
+00017d10: 726f 6d5f 6461 7461 2829 0d0a 2020 2020  rom_data()..    
+00017d20: 2020 2020 0d0a 2020 2020 6465 6620 5f61      ..    def _a
+00017d30: 7667 5f73 6574 5f63 6f6d 706f 6e65 6e74  vg_set_component
+00017d40: 735f 6672 6f6d 5f64 6174 6120 2873 656c  s_from_data (sel
+00017d50: 662c 2064 6174 615f 6172 7261 793d 4e6f  f, data_array=No
+00017d60: 6e65 202c 6461 7461 5f74 7970 653d 4e6f  ne ,data_type=No
+00017d70: 6e65 2c20 0d0a 2020 2020 2020 2020 2020  ne, ..          
+00017d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017d90: 2020 2020 2020 2020 2020 2020 2061 6464               add
+00017da0: 5f61 7374 6174 6963 5f64 6174 6120 3d4e  _astatic_data =N
+00017db0: 6f6e 6520 293a 0d0a 2020 2020 2020 2020  one ):..        
+00017dc0: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
+00017dd0: 686f 6420 746f 2073 6574 200d 0a20 2020  hod to set ..   
+00017de0: 2020 2020 2061 7667 5f64 6174 615f 636f       avg_data_co
+00017df0: 6d70 6f6e 656e 7473 2020 6672 6f6d 2041  mponents  from A
+00017e00: 7667 6669 6c65 200d 0a20 2020 2020 2020  vgfile ..       
+00017e10: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
+00017e20: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00017e30: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00017e40: 2020 2020 2020 202a 2064 6174 615f 6172         * data_ar
+00017e50: 7261 7920 3a20 6e70 2e6e 6461 7272 6179  ray : np.ndarray
+00017e60: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00017e70: 2020 2020 2020 2020 2020 2064 6174 6120             data 
+00017e80: 7265 636f 7665 7265 6420 6672 6f6d 2061  recovered from a
+00017e90: 7667 2066 696c 652e 200d 0a20 2020 2020  vg file. ..     
+00017ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017eb0: 2020 2049 7420 6d75 7374 2062 6520 6f6e     It must be on
+00017ec0: 206e 756d 7079 2061 7272 6179 2e20 5468   numpy array. Th
+00017ed0: 6520 6465 6661 756c 7420 6973 204e 6f6e  e default is Non
+00017ee0: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
+00017ef0: 2a20 6461 7461 5f74 7970 6520 3a20 696e  * data_type : in
+00017f00: 742c 206f 7074 696f 6e61 6c0d 0a20 2020  t, optional..   
+00017f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f20: 2020 2020 2073 686f 7720 7468 6520 7479       show the ty
+00017f30: 7065 206f 6620 4176 6720 6669 6c65 2c20  pe of Avg file, 
+00017f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017f50: 2020 2020 2020 2020 2020 6d75 7374 2062            must b
+00017f60: 6520 3120 666f 7220 706c 6169 6e74 7920  e 1 for plainty 
+00017f70: 6669 6c65 2032 2066 6f72 2041 7374 6174  file 2 for Astat
+00017f80: 6963 2066 696c 652e 200d 0a20 2020 2020  ic file. ..     
+00017f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017fa0: 2020 2020 2a44 6566 6175 6c74 2a20 6973      *Default* is
+00017fb0: 204e 6f6e 652e 0d0a 2020 2020 2020 2020   None...        
+00017fc0: 2020 2020 2a20 6164 645f 6173 7461 7469      * add_astati
+00017fd0: 635f 6461 7461 203a 2070 642e 636f 7265  c_data : pd.core
+00017fe0: 4461 7461 4672 616d 6520 2c20 6f70 7469  DataFrame , opti
+00017ff0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
 00018000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018020: 2020 2061 6464 5f61 7374 6174 6963 5f64     add_astatic_d
-00018030: 6174 6120 3d4e 6f6e 6520 293a 0d0a 2020  ata =None ):..  
-00018040: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00018050: 2020 204d 6574 686f 6420 746f 2073 6574     Method to set
-00018060: 200d 0a20 2020 2020 2020 2061 7667 5f64   ..        avg_d
-00018070: 6174 615f 636f 6d70 6f6e 656e 7473 2020  ata_components  
-00018080: 6672 6f6d 2041 7667 6669 6c65 200d 0a20  from Avgfile .. 
-00018090: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000180a0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-000180b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-000180c0: 0a20 2020 2020 2020 2020 2020 202a 2064  .            * d
-000180d0: 6174 615f 6172 7261 7920 3a20 6e70 2e6e  ata_array : np.n
-000180e0: 6461 7272 6179 200d 0a20 2020 2020 2020  darray ..       
-000180f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018100: 2064 6174 6120 7265 636f 7665 7265 6420   data recovered 
-00018110: 6672 6f6d 2061 7667 2066 696c 652e 200d  from avg file. .
-00018120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018130: 2020 2020 2020 2020 2049 7420 6d75 7374           It must
-00018140: 2062 6520 6f6e 206e 756d 7079 2061 7272   be on numpy arr
-00018150: 6179 2e20 5468 6520 6465 6661 756c 7420  ay. The default 
-00018160: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
-00018170: 2020 2020 2020 2a20 6461 7461 5f74 7970        * data_typ
-00018180: 6520 3a20 696e 742c 206f 7074 696f 6e61  e : int, optiona
-00018190: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-000181a0: 2020 2020 2020 2020 2020 2073 686f 7720             show 
-000181b0: 7468 6520 7479 7065 206f 6620 4176 6720  the type of Avg 
-000181c0: 6669 6c65 2c20 0d0a 2020 2020 2020 2020  file, ..        
-000181d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181e0: 6d75 7374 2062 6520 3120 666f 7220 706c  must be 1 for pl
-000181f0: 6169 6e74 7920 6669 6c65 2032 2066 6f72  ainty file 2 for
-00018200: 2041 7374 6174 6963 2066 696c 652e 200d   Astatic file. .
-00018210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018220: 2020 2020 2020 2020 2020 2a44 6566 6175            *Defau
-00018230: 6c74 2a20 6973 204e 6f6e 652e 0d0a 2020  lt* is None...  
-00018240: 2020 2020 2020 2020 2020 2a20 6164 645f            * add_
-00018250: 6173 7461 7469 635f 6461 7461 203a 2070  astatic_data : p
-00018260: 642e 636f 7265 4461 7461 4672 616d 6520  d.coreDataFrame 
-00018270: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00018280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018290: 2020 2020 2020 2020 2020 2020 6164 6465              adde
-000182a0: 6420 696e 666f 7320 6672 6f6d 2061 7374  d infos from ast
-000182b0: 6174 6963 2066 696c 652e 200d 0a20 2020  atic file. ..   
-000182c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182d0: 2020 2020 2020 2020 2020 2020 202a 4465               *De
-000182e0: 6661 756c 742a 2069 7320 4e6f 6e65 2e0d  fault* is None..
-000182f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00018300: 2020 2020 2020 6966 2064 6174 615f 6172        if data_ar
-00018310: 7261 7920 6973 206e 6f74 204e 6f6e 6520  ray is not None 
-00018320: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00018330: 7365 6c66 2e5f 6461 7461 5f61 7272 6179  self._data_array
-00018340: 203d 6461 7461 5f61 7272 6179 0d0a 2020   =data_array..  
-00018350: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00018360: 2020 2020 6966 2073 656c 662e 5f64 6174      if self._dat
-00018370: 615f 6172 7261 7920 6973 204e 6f6e 6520  a_array is None 
-00018380: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00018390: 7261 6973 6520 4353 6578 2e70 7943 5341  raise CSex.pyCSA
-000183a0: 4d54 4572 726f 725f 4176 6744 6174 6128  MTError_AvgData(
-000183b0: 274e 6f20 4461 7461 2066 726f 6d20 6176  'No Data from av
-000183c0: 6766 696c 6520 746f 2072 6561 642e 2729  gfile to read.')
-000183d0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-000183e0: 2020 2020 2020 2020 6966 2064 6174 615f          if data_
-000183f0: 7479 7065 2069 7320 6e6f 7420 4e6f 6e65  type is not None
-00018400: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00018410: 2073 656c 662e 5f66 203d 6461 7461 5f74   self._f =data_t
-00018420: 7970 650d 0a20 2020 2020 2020 2069 6620  ype..        if 
-00018430: 7365 6c66 2e5f 6620 6e6f 7420 696e 205b  self._f not in [
-00018440: 312c 325d 3a20 0d0a 2020 2020 2020 2020  1,2]: ..        
-00018450: 2020 2020 7261 6973 6520 4353 6578 2e70      raise CSex.p
-00018460: 7943 5341 4d54 4572 726f 725f 4176 6744  yCSAMTError_AvgD
-00018470: 6174 6128 2720 4d61 7920 6368 6563 6b20  ata(' May check 
-00018480: 796f 7572 2061 7667 2044 6174 6166 696c  your avg Datafil
-00018490: 652e 2729 0d0a 0d0a 2020 2020 2020 2020  e.')....        
-000184a0: 0d0a 2020 2020 2020 2020 6e75 6d62 6572  ..        number
-000184b0: 5f6f 665f 6672 6571 5f61 7272 6179 202c  _of_freq_array ,
-000184c0: 2072 6570 203d 205c 0d0a 2020 2020 2020   rep = \..      
-000184d0: 2020 2020 2020 6e70 2e75 6e69 7175 6528        np.unique(
-000184e0: 7365 6c66 2e5f 6461 7461 5f61 7272 6179  self._data_array
-000184f0: 5b3a 2c31 5d2c 2072 6574 7572 6e5f 636f  [:,1], return_co
-00018500: 756e 7473 3d54 7275 6529 0d0a 2020 2020  unts=True)..    
-00018510: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
-00018520: 6174 696f 6e5f 6172 7261 7920 2c20 7265  ation_array , re
-00018530: 7020 3d20 5c0d 0a20 2020 2020 2020 2020  p = \..         
-00018540: 2020 206e 702e 756e 6971 7565 2873 656c     np.unique(sel
-00018550: 662e 5f64 6174 615f 6172 7261 795b 3a2c  f._data_array[:,
-00018560: 305d 2c20 7265 7475 726e 5f63 6f75 6e74  0], return_count
-00018570: 733d 5472 7565 290d 0a0d 0a20 2020 2020  s=True)....     
-00018580: 2020 2073 656c 662e 5f6e 756d 6265 725f     self._number_
-00018590: 6f66 5f66 7265 7175 656e 6369 6573 3d20  of_frequencies= 
-000185a0: 6e75 6d62 6572 5f6f 665f 6672 6571 5f61  number_of_freq_a
-000185b0: 7272 6179 2e73 697a 650d 0a20 2020 2020  rray.size..     
-000185c0: 2020 2073 656c 662e 5f6e 756d 6265 725f     self._number_
-000185d0: 6f66 5f73 7461 7469 6f6e 7320 3d20 6e75  of_stations = nu
-000185e0: 6d62 6572 5f6f 665f 7374 6174 696f 6e5f  mber_of_station_
-000185f0: 6172 7261 792e 7369 7a65 0d0a 2020 2020  array.size..    
-00018600: 2020 2020 2320 7072 696e 7428 7365 6c66      # print(self
-00018610: 2e6e 756d 6672 6571 2c20 7365 6c66 2e6e  .numfreq, self.n
-00018620: 756d 7374 6174 696f 6e29 0d0a 0d0a 2020  umstation)....  
-00018630: 2020 2020 2020 6966 2061 6464 5f61 7374        if add_ast
-00018640: 6174 6963 5f64 6174 6120 6973 206e 6f74  atic_data is not
-00018650: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
-00018660: 2020 2020 2061 6464 6564 5f61 7374 6174       added_astat
-00018670: 6963 5f64 6174 613d 6164 645f 6173 7461  ic_data=add_asta
-00018680: 7469 635f 6461 7461 0d0a 2020 2020 2020  tic_data..      
-00018690: 2020 2020 2020 7064 665f 5a3d 2061 6464        pdf_Z= add
-000186a0: 6564 5f61 7374 6174 6963 5f64 6174 612e  ed_astatic_data.
-000186b0: 6472 6f70 2827 5352 6573 272c 2061 7869  drop('SRes', axi
-000186c0: 733d 3129 0d0a 2020 2020 2020 2020 2020  s=1)..          
-000186d0: 2020 7064 665f 5a2e 7265 7365 745f 696e    pdf_Z.reset_in
-000186e0: 6465 7828 6472 6f70 3d54 7275 652c 2069  dex(drop=True, i
-000186f0: 6e70 6c61 6365 203d 5472 7565 2029 0d0a  nplace =True )..
-00018700: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00018710: 2e5a 2e5f 7265 6164 5f7a 4153 5f64 6174  .Z._read_zAS_dat
-00018720: 6128 0d0a 2020 2020 2020 2020 2020 2020  a(..            
-00018730: 2020 2020 7a5f 6162 735f 6172 7261 7920      z_abs_array 
-00018740: 3d70 6466 5f5a 202c 0d0a 2020 2020 2020  =pdf_Z ,..      
-00018750: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-00018760: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
-00018770: 3d20 7365 6c66 2e5f 6e75 6d62 6572 5f6f  = self._number_o
-00018780: 665f 6672 6571 7565 6e63 6965 732c 200d  f_frequencies, .
-00018790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000187a0: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
-000187b0: 6f6e 733d 7365 6c66 2e5f 6e75 6d62 6572  ons=self._number
-000187c0: 5f6f 665f 7374 6174 696f 6e73 2029 0d0a  _of_stations )..
-000187d0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000187e0: 2020 2020 2020 2020 2020 232d 2d3e 2073            #--> s
-000187f0: 6574 2061 7374 6963 6174 6963 0d0a 2020  et asticatic..  
-00018800: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00018810: 6464 6564 5f61 7374 6174 6963 5f64 6174  dded_astatic_dat
-00018820: 613d 6164 6465 645f 6173 7461 7469 635f  a=added_astatic_
-00018830: 6461 7461 5b27 5352 6573 275d 2e74 6f5f  data['SRes'].to_
-00018840: 6e75 6d70 7928 290d 0a0d 0a20 2020 2020  numpy()....     
-00018850: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00018860: 2064 6566 207a 7374 6172 5f61 7272 6179   def zstar_array
-00018870: 5f74 6f5f 6e61 6e20 287a 7374 6172 5f61  _to_nan (zstar_a
-00018880: 7272 6179 2c20 6e61 6e5f 7661 6c75 653d  rray, nan_value=
-00018890: 6e70 2e6e 616e 2c20 6b65 6570 5f73 7472  np.nan, keep_str
-000188a0: 203d 4661 6c73 6529 3a20 0d0a 2020 2020   =False): ..    
-000188b0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-000188c0: 2020 2020 2020 2020 2050 6172 616d 6574           Paramet
-000188d0: 6572 730d 0a20 2020 2020 2020 2020 2020  ers..           
-000188e0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-000188f0: 2020 2020 2020 2020 2020 2020 202a 207a               * z
-00018900: 7374 6172 5f61 7272 6179 203a 206e 6461  star_array : nda
-00018910: 7272 6179 200d 0a20 2020 2020 2020 2020  rray ..         
-00018920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018930: 2020 2061 7272 6179 2063 6f6e 7461 696e     array contain
-00018940: 2075 6e66 6c6f 6174 2063 6f6e 7665 7274   unfloat convert
-00018950: 6572 2076 616c 7565 2e0d 0a20 2020 2020  er value...     
-00018960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018970: 2020 2020 2020 2074 6865 2075 6e63 6f6e         the uncon
-00018980: 7665 7274 6572 2076 616c 7565 2063 616e  verter value can
-00018990: 2062 6520 6120 272a 270d 0a20 2020 2020   be a '*'..     
-000189a0: 2020 2020 2020 2020 2020 202a 206e 616e             * nan
-000189b0: 5f76 616c 7565 203a 2066 6c6f 6174 206f  _value : float o
-000189c0: 7220 6e70 2e6e 616e 2074 7970 6520 200d  r np.nan type  .
-000189d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000189e0: 2020 2020 2020 2020 2020 2020 206e 616e               nan
-000189f0: 5f76 616c 7565 2063 6f75 6c64 2062 6520  _value could be 
-00018a00: 616e 7920 7661 6c75 6520 6569 7468 6572  any value either
-00018a10: 2069 6e74 2c20 666c 6f61 7420 6f72 2073   int, float or s
-00018a20: 7472 2e20 200d 0a20 2020 2020 2020 2020  tr.  ..         
-00018a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a40: 2020 2049 6620 5468 6520 6465 6661 756c     If The defaul
-00018a50: 7420 6973 206e 702e 6e61 6e2e 0d0a 2020  t is np.nan...  
-00018a60: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
-00018a70: 6b65 6570 5f73 7472 203a 2062 6f6f 6c2c  keep_str : bool,
-00018a80: 206f 7074 696f 6e61 6c20 200d 0a20 2020   optional  ..   
-00018a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018aa0: 2020 2020 2020 2020 206b 6565 7020 7468           keep th
-00018ab0: 6520 7374 7220 6974 656d 206f 6e20 796f  e str item on yo
-00018ac0: 7572 2061 7272 6179 2e0d 0a20 2020 2020  ur array...     
-00018ad0: 2020 2020 2020 2052 6574 7572 6e73 200d         Returns .
-00018ae0: 0a20 2020 2020 2020 2020 2020 202d 2d2d  .            ---
-00018af0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2020  ----..          
-00018b00: 2020 2020 2020 6172 7261 795f 6c69 6b65        array_like
-00018b10: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00018b20: 2020 2020 2020 207a 7374 7261 725f 6172         zstrar_ar
-00018b30: 7261 7920 636f 6e76 6572 7465 6420 0d0a  ray converted ..
-00018b40: 2020 2020 2020 2020 2020 2020 2222 220d              """.
-00018b50: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00018b60: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-00018b70: 6b20 2c20 7661 6c75 6520 696e 2065 6e75  k , value in enu
-00018b80: 6d65 7261 7465 287a 7374 6172 5f61 7272  merate(zstar_arr
-00018b90: 6179 293a 200d 0a20 2020 2020 2020 2020  ay): ..         
-00018ba0: 2020 2020 2020 2074 7279 203a 207a 7374         try : zst
-00018bb0: 6172 5f61 7272 6179 5b6b 6b5d 203d 666c  ar_array[kk] =fl
-00018bc0: 6f61 7428 7661 6c75 6529 0d0a 2020 2020  oat(value)..    
-00018bd0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00018be0: 7074 203a 7a73 7461 725f 6172 7261 795b  pt :zstar_array[
-00018bf0: 6b6b 5d3d 6e61 6e5f 7661 6c75 650d 0a20  kk]=nan_value.. 
-00018c00: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
-00018c10: 7065 286e 616e 5f76 616c 7565 2920 6973  pe(nan_value) is
-00018c20: 2073 7472 203a 206b 6565 705f 7374 723d   str : keep_str=
-00018c30: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
-00018c40: 2020 6966 206b 6565 705f 7374 7220 3a20    if keep_str : 
-00018c50: 7265 7475 726e 207a 7374 6172 5f61 7272  return zstar_arr
-00018c60: 6179 200d 0a20 2020 2020 2020 2020 2020  ay ..           
-00018c70: 2072 6574 7572 6e20 6e70 2e61 7272 6179   return np.array
-00018c80: 285b 666c 6f61 7428 6b6b 2920 666f 7220  ([float(kk) for 
-00018c90: 6b6b 2069 6e20 7a73 7461 725f 6172 7261  kk in zstar_arra
-00018ca0: 795d 2920 2020 0d0a 2020 2020 2020 2020  y])   ..        
-00018cb0: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
-00018cc0: 7472 7920 746f 2063 6861 6e67 6520 7468  try to change th
-00018cd0: 6520 6474 7970 6520 6f66 2064 6174 6120  e dtype of data 
-00018ce0: 6966 2064 7479 7065 206f 6620 7468 6520  if dtype of the 
-00018cf0: 6461 7461 7365 7420 6973 206e 6f74 2066  dataset is not f
-00018d00: 6c6f 6174 200d 0a0d 0a20 2020 2020 2020  loat ....       
-00018d10: 2069 6620 7365 6c66 2e5f 6461 7461 5f61   if self._data_a
-00018d20: 7272 6179 2e64 7479 7065 206e 6f74 2069  rray.dtype not i
-00018d30: 6e20 5b27 666c 6f61 7427 2c20 2769 6e74  n ['float', 'int
-00018d40: 275d 3a0d 0a20 2020 2020 2020 2020 2020  ']:..           
-00018d50: 2064 6174 615f 7472 616e 7369 746f 7279   data_transitory
-00018d60: 203d 5b7a 7374 6172 5f61 7272 6179 5f74   =[zstar_array_t
-00018d70: 6f5f 6e61 6e28 7a73 7461 725f 6172 7261  o_nan(zstar_arra
-00018d80: 793d 726f 776c 696e 6529 200d 0a20 2020  y=rowline) ..   
-00018d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018da0: 2020 2020 2020 2020 2020 2066 6f72 2064             for d
-00018db0: 642c 2072 6f77 6c69 6e65 2069 6e20 656e  d, rowline in en
-00018dc0: 756d 6572 6174 6528 7365 6c66 2e5f 6461  umerate(self._da
-00018dd0: 7461 5f61 7272 6179 295d 0d0a 2020 2020  ta_array)]..    
-00018de0: 2020 2020 2020 2020 7365 6c66 2e5f 6461          self._da
-00018df0: 7461 5f61 7272 6179 3d66 756e 632e 636f  ta_array=func.co
-00018e00: 6e63 6174 5f61 7272 6179 5f66 726f 6d5f  ncat_array_from_
-00018e10: 6c69 7374 280d 0a20 2020 2020 2020 2020  list(..         
-00018e20: 2020 2020 2020 206c 6973 745f 6f66 5f61         list_of_a
-00018e30: 7272 6179 3d64 6174 615f 7472 616e 7369  rray=data_transi
-00018e40: 746f 7279 290d 0a20 200d 0a20 2020 2020  tory)..  ..     
-00018e50: 2020 2023 2070 6f70 756c 6174 6520 636c     # populate cl
-00018e60: 6173 7365 7320 2e20 200d 0a20 2020 2020  asses .  ..     
-00018e70: 2020 2023 6375 7420 6f66 2073 7065 6369     #cut of speci
-00018e80: 616c 2066 7265 715f 6172 7261 7920 616e  al freq_array an
-00018e90: 6420 7374 6174 696f 6e73 0d0a 2020 2020  d stations..    
-00018ea0: 2020 2020 2320 666f 7220 6d6f 7265 2063      # for more c
-00018eb0: 6572 7461 696e 746c 7920 2c20 616e 7920  ertaintly , any 
-00018ec0: 7661 6c75 6520 7769 6c6c 2063 6f6d 6520  value will come 
-00018ed0: 6d75 7374 2062 6520 6368 6563 6b20 7768  must be check wh
-00018ee0: 6574 6865 7220 6974 730d 0a20 2020 2020  ether its..     
-00018ef0: 2020 2023 2070 6f73 7369 626c 6520 746f     # possible to
-00018f00: 2063 6f6e 7665 7274 202c 2069 6620 6e6f   convert , if no
-00018f10: 7420 7661 6c75 6520 0d0a 2020 2020 2020  t value ..      
-00018f20: 2020 2320 2020 2020 2020 7769 6c6c 2073    #       will s
-00018f30: 6574 2074 6f20 6e70 2e6e 616e 200d 0a0d  et to np.nan ...
-00018f40: 0a20 2020 2020 2020 2073 656c 662e 5374  .        self.St
-00018f50: 6174 696f 6e2e 5f73 6574 5f73 7461 7469  ation._set_stati
-00018f60: 6f6e 5f28 7374 6174 696f 6e5f 6461 7461  on_(station_data
-00018f70: 5f61 7272 6179 3d7a 7374 6172 5f61 7272  _array=zstar_arr
-00018f80: 6179 5f74 6f5f 6e61 6e20 280d 0a20 2020  ay_to_nan (..   
-00018f90: 2020 2020 2020 2020 207a 7374 6172 5f61           zstar_a
-00018fa0: 7272 6179 3d73 656c 662e 5f64 6174 615f  rray=self._data_
-00018fb0: 6172 7261 795b 3a2c 305d 292c 200d 0a20  array[:,0]), .. 
-00018fc0: 2020 2020 2020 2020 2020 206e 6f72 6d61             norma
-00018fd0: 6c69 7a65 645f 7374 6174 696f 6e5f 7661  lized_station_va
-00018fe0: 6c75 653d 7365 6c66 2e6e 6f72 6d61 6c69  lue=self.normali
-00018ff0: 7a65 645f 7374 6174 696f 6e5f 7661 6c75  zed_station_valu
-00019000: 6520 290d 0a20 2020 2020 2020 2073 656c  e )..        sel
-00019010: 662e 4672 6571 7565 6e63 792e 5f73 6574  f.Frequency._set
-00019020: 5f66 7265 7175 656e 6379 2866 7265 715f  _frequency(freq_
-00019030: 6172 7261 793d 7a73 7461 725f 6172 7261  array=zstar_arra
-00019040: 795f 746f 5f6e 616e 2028 0d0a 2020 2020  y_to_nan (..    
-00019050: 2020 2020 2020 2020 7a73 7461 725f 6172          zstar_ar
-00019060: 7261 793d 7365 6c66 2e5f 6461 7461 5f61  ray=self._data_a
-00019070: 7272 6179 5b3a 2c31 5d29 290d 0a20 2020  rray[:,1]))..   
-00019080: 2020 2020 2073 656c 662e 416d 7073 2e5f       self.Amps._
-00019090: 7265 6164 5f61 6d70 735f 6461 7461 2861  read_amps_data(a
-000190a0: 6d70 735f 6172 7261 793d 7a73 7461 725f  mps_array=zstar_
-000190b0: 6172 7261 795f 746f 5f6e 616e 2028 0d0a  array_to_nan (..
-000190c0: 2020 2020 2020 2020 2020 2020 7a73 7461              zsta
-000190d0: 725f 6172 7261 793d 7365 6c66 2e5f 6461  r_array=self._da
-000190e0: 7461 5f61 7272 6179 5b3a 2c32 5d29 2c20  ta_array[:,2]), 
-000190f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019100: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-00019110: 6672 6571 7565 6e63 6965 733d 7365 6c66  frequencies=self
-00019120: 2e5f 6e75 6d62 6572 5f6f 665f 6672 6571  ._number_of_freq
-00019130: 7565 6e63 6965 732c 200d 0a20 2020 2020  uencies, ..     
-00019140: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00019150: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-00019160: 733d 7365 6c66 2e5f 6e75 6d62 6572 5f6f  s=self._number_o
-00019170: 665f 7374 6174 696f 6e73 290d 0a20 2020  f_stations)..   
-00019180: 2020 2020 2023 2041 6d70 7328 616d 7073       # Amps(amps
-00019190: 5f61 7272 6179 3d73 656c 662e 5f64 6174  _array=self._dat
-000191a0: 615f 6172 7261 795b 3a2c 325d 290d 0a20  a_array[:,2]).. 
-000191b0: 2020 2020 2020 2073 656c 662e 456d 6167         self.Emag
-000191c0: 2e5f 7265 6164 5f65 6d61 675f 6461 7461  ._read_emag_data
-000191d0: 2865 5f6d 6167 5f61 7272 6179 3d7a 7374  (e_mag_array=zst
-000191e0: 6172 5f61 7272 6179 5f74 6f5f 6e61 6e20  ar_array_to_nan 
-000191f0: 280d 0a20 2020 2020 2020 2020 2020 207a  (..            z
-00019200: 7374 6172 5f61 7272 6179 3d73 656c 662e  star_array=self.
-00019210: 5f64 6174 615f 6172 7261 795b 3a2c 335d  _data_array[:,3]
-00019220: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00019230: 2020 2020 6e75 6d62 6572 5f6f 665f 6672      number_of_fr
-00019240: 6571 7565 6e63 6965 733d 7365 6c66 2e5f  equencies=self._
-00019250: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
-00019260: 6e63 6965 732c 200d 0a20 2020 2020 2020  ncies, ..       
-00019270: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-00019280: 6f66 5f73 7461 7469 6f6e 733d 7365 6c66  of_stations=self
-00019290: 2e5f 6e75 6d62 6572 5f6f 665f 7374 6174  ._number_of_stat
-000192a0: 696f 6e73 2029 0d0a 2020 2020 2020 2020  ions )..        
-000192b0: 2320 456d 6167 2865 5f6d 6167 5f61 7272  # Emag(e_mag_arr
-000192c0: 6179 203d 7365 6c66 2e5f 6461 7461 5f61  ay =self._data_a
-000192d0: 7272 6179 5b3a 2c33 5d29 0d0a 2020 2020  rray[:,3])..    
-000192e0: 2020 2020 7365 6c66 2e45 7068 7a2e 5f72      self.Ephz._r
-000192f0: 6561 645f 6570 687a 5f64 6174 6128 655f  ead_ephz_data(e_
-00019300: 7068 7a5f 6172 7261 793d 7a73 7461 725f  phz_array=zstar_
-00019310: 6172 7261 795f 746f 5f6e 616e 2028 0d0a  array_to_nan (..
-00019320: 2020 2020 2020 2020 2020 2020 7a73 7461              zsta
-00019330: 725f 6172 7261 793d 7365 6c66 2e5f 6461  r_array=self._da
-00019340: 7461 5f61 7272 6179 5b3a 2c20 345d 292c  ta_array[:, 4]),
-00019350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019360: 2020 6e75 6d62 6572 5f6f 665f 6672 6571    number_of_freq
-00019370: 7565 6e63 6965 733d 7365 6c66 2e5f 6e75  uencies=self._nu
-00019380: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-00019390: 6965 732c 200d 0a20 2020 2020 2020 2020  ies, ..         
-000193a0: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-000193b0: 5f73 7461 7469 6f6e 733d 7365 6c66 2e5f  _stations=self._
-000193c0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-000193d0: 6e73 2c0d 0a20 2020 2020 2020 2020 2020  ns,..           
-000193e0: 2020 2020 2074 6f5f 6465 6772 6565 203d       to_degree =
-000193f0: 7365 6c66 2e73 6574 5f74 6f5f 6465 6772  self.set_to_degr
-00019400: 6565 2020 290d 0a20 2020 2020 2020 2023  ee  )..        #
-00019410: 2045 7068 7a28 655f 7068 7a5f 6172 7261   Ephz(e_phz_arra
-00019420: 793d 7365 6c66 2e5f 6461 7461 5f61 7272  y=self._data_arr
-00019430: 6179 5b3a 2c20 345d 290d 0a20 2020 2020  ay[:, 4])..     
-00019440: 2020 2073 656c 662e 486d 6167 2e5f 7265     self.Hmag._re
-00019450: 6164 5f68 6d61 675f 6461 7461 2868 5f6d  ad_hmag_data(h_m
-00019460: 6167 5f61 7272 6179 3d7a 7374 6172 5f61  ag_array=zstar_a
-00019470: 7272 6179 5f74 6f5f 6e61 6e20 280d 0a20  rray_to_nan (.. 
-00019480: 2020 2020 2020 2020 2020 207a 7374 6172             zstar
-00019490: 5f61 7272 6179 3d73 656c 662e 5f64 6174  _array=self._dat
-000194a0: 615f 6172 7261 795b 3a2c 355d 292c 0d0a  a_array[:,5]),..
-000194b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000194c0: 2020 2020 6e75 6d62 6572 5f6f 665f 6672      number_of_fr
-000194d0: 6571 7565 6e63 6965 733d 7365 6c66 2e5f  equencies=self._
-000194e0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
-000194f0: 6e63 6965 732c 200d 0a20 2020 2020 2020  ncies, ..       
-00019500: 2020 2020 2020 2020 2020 2020 206e 756d               num
-00019510: 6265 725f 6f66 5f73 7461 7469 6f6e 733d  ber_of_stations=
-00019520: 7365 6c66 2e5f 6e75 6d62 6572 5f6f 665f  self._number_of_
-00019530: 7374 6174 696f 6e73 2029 0d0a 2020 2020  stations )..    
-00019540: 2020 2020 2320 486d 6167 2028 685f 6d61      # Hmag (h_ma
-00019550: 675f 6172 7261 7920 3d73 656c 662e 5f64  g_array =self._d
-00019560: 6174 615f 6172 7261 795b 3a2c 355d 290d  ata_array[:,5]).
-00019570: 0a20 2020 2020 2020 2073 656c 662e 4870  .        self.Hp
-00019580: 687a 2e5f 7265 6164 5f68 7068 7a5f 6461  hz._read_hphz_da
-00019590: 7461 2868 5f70 687a 5f61 7272 6179 3d7a  ta(h_phz_array=z
-000195a0: 7374 6172 5f61 7272 6179 5f74 6f5f 6e61  star_array_to_na
-000195b0: 6e20 280d 0a20 2020 2020 2020 2020 2020  n (..           
-000195c0: 207a 7374 6172 5f61 7272 6179 3d73 656c   zstar_array=sel
-000195d0: 662e 5f64 6174 615f 6172 7261 795b 3a2c  f._data_array[:,
-000195e0: 2036 5d29 2c0d 0a20 2020 2020 2020 2020   6]),..         
-000195f0: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-00019600: 5f66 7265 7175 656e 6369 6573 3d73 656c  _frequencies=sel
-00019610: 662e 5f6e 756d 6265 725f 6f66 5f66 7265  f._number_of_fre
-00019620: 7175 656e 6369 6573 2c20 0d0a 2020 2020  quencies, ..    
-00019630: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00019640: 6572 5f6f 665f 7374 6174 696f 6e73 3d73  er_of_stations=s
-00019650: 656c 662e 5f6e 756d 6265 725f 6f66 5f73  elf._number_of_s
-00019660: 7461 7469 6f6e 732c 0d0a 2020 2020 2020  tations,..      
-00019670: 2020 2020 2020 2020 2020 746f 5f64 6567            to_deg
-00019680: 7265 6520 3d73 656c 662e 7365 745f 746f  ree =self.set_to
-00019690: 5f64 6567 7265 6520 2029 0d0a 2020 2020  _degree  )..    
-000196a0: 2020 2020 2320 4870 687a 2868 5f70 687a      # Hphz(h_phz
-000196b0: 5f61 7272 6179 3d73 656c 662e 5f64 6174  _array=self._dat
-000196c0: 615f 6172 7261 795b 3a2c 365d 290d 0a20  a_array[:,6]).. 
-000196d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000196e0: 2069 6620 7365 6c66 2e5f 663d 3d31 203a   if self._f==1 :
-000196f0: 200d 0a20 2020 2020 2020 2023 2020 2020   ..        #    
-00019700: 2052 6573 6973 7469 7669 7479 2872 6573   Resistivity(res
-00019710: 5f61 7272 6179 3d73 656c 662e 5f64 6174  _array=self._dat
-00019720: 615b 3a2c 375d 290d 0a20 2020 2020 2020  a[:,7])..       
-00019730: 2020 2020 2073 656c 662e 5265 7369 7374       self.Resist
-00019740: 6976 6974 792e 5f72 6561 645f 7265 735f  ivity._read_res_
-00019750: 6461 7461 2872 6573 5f61 7272 6179 203d  data(res_array =
-00019760: 7a73 7461 725f 6172 7261 795f 746f 5f6e  zstar_array_to_n
-00019770: 616e 2028 0d0a 2020 2020 2020 2020 2020  an (..          
-00019780: 2020 2020 2020 7a73 7461 725f 6172 7261        zstar_arra
-00019790: 793d 7365 6c66 2e5f 6461 7461 5f61 7272  y=self._data_arr
-000197a0: 6179 5b3a 2c37 5d29 2c0d 0a20 2020 2020  ay[:,7]),..     
-000197b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000197c0: 2020 206e 756d 6265 725f 6f66 5f66 7265     number_of_fre
-000197d0: 7175 656e 6369 6573 3d73 656c 662e 5f6e  quencies=self._n
-000197e0: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
-000197f0: 6369 6573 2c20 0d0a 2020 2020 2020 2020  cies, ..        
-00019800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019810: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-00019820: 6e73 3d73 656c 662e 5f6e 756d 6265 725f  ns=self._number_
-00019830: 6f66 5f73 7461 7469 6f6e 7329 0d0a 2020  of_stations)..  
-00019840: 2020 2020 2020 2320 2020 2020 5068 6173        #     Phas
-00019850: 6520 2870 6861 7365 5f61 7272 6179 3d73  e (phase_array=s
-00019860: 656c 662e 5f64 6174 615b 3a38 5d29 0d0a  elf._data[:8])..
-00019870: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00019880: 2e50 6861 7365 2e5f 7265 6164 5f70 6861  .Phase._read_pha
-00019890: 7365 5f64 6174 6128 7068 6173 655f 6172  se_data(phase_ar
-000198a0: 7261 793d 7a73 7461 725f 6172 7261 795f  ray=zstar_array_
-000198b0: 746f 5f6e 616e 2028 0d0a 2020 2020 2020  to_nan (..      
-000198c0: 2020 2020 2020 2020 2020 7a73 7461 725f            zstar_
-000198d0: 6172 7261 793d 7365 6c66 2e5f 6461 7461  array=self._data
-000198e0: 5f61 7272 6179 5b3a 2c38 5d29 2c0d 0a20  _array[:,8]),.. 
-000198f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019900: 2020 2020 6e75 6d62 6572 5f6f 665f 6672      number_of_fr
-00019910: 6571 7565 6e63 6965 733d 7365 6c66 2e5f  equencies=self._
-00019920: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
-00019930: 6e63 6965 732c 200d 0a20 2020 2020 2020  ncies, ..       
-00019940: 2020 2020 2020 2020 2020 2020 206e 756d               num
-00019950: 6265 725f 6f66 5f73 7461 7469 6f6e 733d  ber_of_stations=
-00019960: 7365 6c66 2e5f 6e75 6d62 6572 5f6f 665f  self._number_of_
-00019970: 7374 6174 696f 6e73 2029 0d0a 2020 2020  stations )..    
-00019980: 2020 2020 2320 2020 2020 7350 687a 2873      #     sPhz(s
-00019990: 5f70 687a 5f64 6174 613d 7365 6c66 2e5f  _phz_data=self._
-000199a0: 6461 7461 5f61 7272 6179 5b3a 2d31 5d29  data_array[:-1])
-000199b0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-000199c0: 6c66 2e73 5068 7a2e 5f72 6561 645f 7350  lf.sPhz._read_sP
-000199d0: 687a 5f64 6174 6128 7350 6861 7365 5f61  hz_data(sPhase_a
-000199e0: 7272 6179 3d7a 7374 6172 5f61 7272 6179  rray=zstar_array
-000199f0: 5f74 6f5f 6e61 6e20 280d 0a20 2020 2020  _to_nan (..     
-00019a00: 2020 2020 2020 2020 2020 207a 7374 6172             zstar
-00019a10: 5f61 7272 6179 3d73 656c 662e 5f64 6174  _array=self._dat
-00019a20: 615f 6172 7261 795b 3a2c 2d31 5d29 2c20  a_array[:,-1]), 
-00019a30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019a40: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00019a50: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
-00019a60: 733d 7365 6c66 2e5f 6e75 6d62 6572 5f6f  s=self._number_o
-00019a70: 665f 6672 6571 7565 6e63 6965 732c 200d  f_frequencies, .
-00019a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019a90: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-00019aa0: 725f 6f66 5f73 7461 7469 6f6e 733d 7365  r_of_stations=se
-00019ab0: 6c66 2e5f 6e75 6d62 6572 5f6f 665f 7374  lf._number_of_st
-00019ac0: 6174 696f 6e73 290d 0a20 2020 2020 2020  ations)..       
-00019ad0: 2023 2020 2020 2070 6352 686f 2870 635f   #     pcRho(pc_
-00019ae0: 7268 6f5f 6461 7461 3d73 656c 662e 5f64  rho_data=self._d
-00019af0: 6174 615b 3a2c 2d32 5d29 0d0a 2020 2020  ata[:,-2])..    
-00019b00: 2020 2020 2020 2020 7365 6c66 2e70 6352          self.pcR
-00019b10: 686f 2e5f 7265 6164 5f70 6352 6573 5f64  ho._read_pcRes_d
-00019b20: 6174 6128 7063 5265 735f 6172 7261 7920  ata(pcRes_array 
-00019b30: 3d7a 7374 6172 5f61 7272 6179 5f74 6f5f  =zstar_array_to_
-00019b40: 6e61 6e20 280d 0a20 2020 2020 2020 2020  nan (..         
-00019b50: 2020 2020 2020 207a 7374 6172 5f61 7272         zstar_arr
-00019b60: 6179 3d73 656c 662e 5f64 6174 615f 6172  ay=self._data_ar
-00019b70: 7261 795b 3a2c 2d32 5d29 2c0d 0a20 2020  ray[:,-2]),..   
-00019b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b90: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-00019ba0: 6f66 5f66 7265 7175 656e 6369 6573 3d73  of_frequencies=s
-00019bb0: 656c 662e 5f6e 756d 6265 725f 6f66 5f66  elf._number_of_f
-00019bc0: 7265 7175 656e 6369 6573 2c20 0d0a 2020  requencies, ..  
-00019bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019be0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00019bf0: 5f6f 665f 7374 6174 696f 6e73 3d73 656c  _of_stations=sel
-00019c00: 662e 5f6e 756d 6265 725f 6f66 5f73 7461  f._number_of_sta
-00019c10: 7469 6f6e 7329 0d0a 2020 2020 2020 2020  tions)..        
-00019c20: 6966 2073 656c 662e 5f66 3d3d 3220 3a20  if self._f==2 : 
-00019c30: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
-00019c40: 5265 7369 7374 6976 6974 7928 7265 735f  Resistivity(res_
-00019c50: 6172 7261 793d 7365 6c66 2e5f 6461 7461  array=self._data
-00019c60: 5b3a 2c38 5d29 0d0a 2020 2020 2020 2020  [:,8])..        
-00019c70: 2020 2020 7365 6c66 2e52 6573 6973 7469      self.Resisti
-00019c80: 7669 7479 2e5f 7265 6164 5f72 6573 5f64  vity._read_res_d
-00019c90: 6174 6128 7265 735f 6172 7261 7920 3d7a  ata(res_array =z
-00019ca0: 7374 6172 5f61 7272 6179 5f74 6f5f 6e61  star_array_to_na
-00019cb0: 6e20 280d 0a20 2020 2020 2020 2020 2020  n (..           
-00019cc0: 2020 2020 207a 7374 6172 5f61 7272 6179       zstar_array
-00019cd0: 3d73 656c 662e 5f64 6174 615f 6172 7261  =self._data_arra
-00019ce0: 795b 3a2c 385d 292c 0d0a 2020 2020 2020  y[:,8]),..      
-00019cf0: 2020 2020 2020 2020 2020 2020 206e 756d               num
-00019d00: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-00019d10: 6573 3d73 656c 662e 5f6e 756d 6265 725f  es=self._number_
-00019d20: 6f66 5f66 7265 7175 656e 6369 6573 2c20  of_frequencies, 
-00019d30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019d40: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-00019d50: 5f73 7461 7469 6f6e 733d 7365 6c66 2e5f  _stations=self._
-00019d60: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-00019d70: 6e73 2c0d 0a20 2020 2020 2020 2020 2020  ns,..           
-00019d80: 2020 2020 2020 2020 2020 5372 6573 3d73            Sres=s
-00019d90: 656c 662e 6164 6465 645f 6173 7461 7469  elf.added_astati
-00019da0: 635f 6461 7461 290d 0a20 2020 2020 2020  c_data)..       
-00019db0: 2023 2020 2020 2050 6861 7365 2028 7068   #     Phase (ph
-00019dc0: 6173 655f 6172 7261 793d 7365 6c66 2e5f  ase_array=self._
-00019dd0: 6461 7461 5b3a 375d 290d 0a20 2020 2020  data[:7])..     
-00019de0: 2020 2020 2020 2073 656c 662e 5068 6173         self.Phas
-00019df0: 652e 5f72 6561 645f 7068 6173 655f 6461  e._read_phase_da
-00019e00: 7461 2870 6861 7365 5f61 7272 6179 3d7a  ta(phase_array=z
-00019e10: 7374 6172 5f61 7272 6179 5f74 6f5f 6e61  star_array_to_na
-00019e20: 6e20 280d 0a20 2020 2020 2020 2020 2020  n (..           
-00019e30: 2020 2020 207a 7374 6172 5f61 7272 6179       zstar_array
-00019e40: 3d73 656c 662e 5f64 6174 615f 6172 7261  =self._data_arra
-00019e50: 795b 3a2c 375d 292c 0d0a 2020 2020 2020  y[:,7]),..      
-00019e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e70: 2020 2020 206e 756d 6265 725f 6f66 5f66       number_of_f
-00019e80: 7265 7175 656e 6369 6573 3d73 656c 662e  requencies=self.
-00019e90: 5f6e 756d 6265 725f 6f66 5f66 7265 7175  _number_of_frequ
-00019ea0: 656e 6369 6573 2c20 0d0a 2020 2020 2020  encies, ..      
-00019eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ec0: 2020 2020 206e 756d 6265 725f 6f66 5f73       number_of_s
-00019ed0: 7461 7469 6f6e 733d 7365 6c66 2e5f 6e75  tations=self._nu
-00019ee0: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
-00019ef0: 2029 0d0a 2020 2020 2020 2020 2320 2020   )..        #   
-00019f00: 2020 7350 687a 2873 5f70 687a 5f64 6174    sPhz(s_phz_dat
-00019f10: 613d 7365 6c66 2e5f 6461 7461 5f61 7272  a=self._data_arr
-00019f20: 6179 5b3a 2d32 5d29 0d0a 2020 2020 2020  ay[:-2])..      
-00019f30: 2020 2020 2020 7365 6c66 2e73 5068 7a2e        self.sPhz.
-00019f40: 5f72 6561 645f 7350 687a 5f64 6174 6128  _read_sPhz_data(
-00019f50: 7350 6861 7365 5f61 7272 6179 3d7a 7374  sPhase_array=zst
-00019f60: 6172 5f61 7272 6179 5f74 6f5f 6e61 6e20  ar_array_to_nan 
-00019f70: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00019f80: 2020 207a 7374 6172 5f61 7272 6179 3d73     zstar_array=s
-00019f90: 656c 662e 5f64 6174 615f 6172 7261 795b  elf._data_array[
-00019fa0: 3a2c 2d32 5d29 2c0d 0a20 2020 2020 2020  :,-2]),..       
-00019fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019fc0: 2020 6e75 6d62 6572 5f6f 665f 6672 6571    number_of_freq
-00019fd0: 7565 6e63 6965 733d 7365 6c66 2e5f 6e75  uencies=self._nu
-00019fe0: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-00019ff0: 6965 732c 200d 0a20 2020 2020 2020 2020  ies, ..         
-0001a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a010: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
-0001a020: 6f6e 733d 7365 6c66 2e5f 6e75 6d62 6572  ons=self._number
-0001a030: 5f6f 665f 7374 6174 696f 6e73 290d 0a20  _of_stations).. 
-0001a040: 2020 2020 2020 2023 2020 2020 2070 6352         #     pcR
-0001a050: 686f 2870 635f 7268 6f5f 6461 7461 3d73  ho(pc_rho_data=s
-0001a060: 656c 662e 5f64 6174 615b 3a2c 2d31 5d29  elf._data[:,-1])
-0001a070: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0001a080: 6c66 2e70 6352 686f 2e5f 7265 6164 5f70  lf.pcRho._read_p
-0001a090: 6352 6573 5f64 6174 6128 7063 5265 735f  cRes_data(pcRes_
-0001a0a0: 6172 7261 7920 3d7a 7374 6172 5f61 7272  array =zstar_arr
-0001a0b0: 6179 5f74 6f5f 6e61 6e20 280d 0a20 2020  ay_to_nan (..   
-0001a0c0: 2020 2020 2020 2020 2020 2020 207a 7374               zst
-0001a0d0: 6172 5f61 7272 6179 3d73 656c 662e 5f64  ar_array=self._d
-0001a0e0: 6174 615f 6172 7261 795b 3a2c 2d31 5d29  ata_array[:,-1])
-0001a0f0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0001a100: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-0001a110: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
-0001a120: 3d73 656c 662e 5f6e 756d 6265 725f 6f66  =self._number_of
-0001a130: 5f66 7265 7175 656e 6369 6573 2c20 0d0a  _frequencies, ..
-0001a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a150: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-0001a160: 665f 7374 6174 696f 6e73 3d73 656c 662e  f_stations=self.
-0001a170: 5f6e 756d 6265 725f 6f66 5f73 7461 7469  _number_of_stati
-0001a180: 6f6e 7329 0d0a 2020 2020 2020 2020 2020  ons)..          
-0001a190: 2020 0d0a 2020 2020 2020 2020 2320 7063    ..        # pc
-0001a1a0: 456d 6167 2870 635f 656d 6167 5f64 6174  Emag(pc_emag_dat
-0001a1b0: 613d 7365 6c66 2e5f 6461 7461 5b3a 2c2d  a=self._data[:,-
-0001a1c0: 365d 290d 0a20 2020 2020 2020 2073 656c  6])..        sel
-0001a1d0: 662e 7063 456d 6167 2e5f 7265 6164 5f70  f.pcEmag._read_p
-0001a1e0: 6345 6d61 675f 6461 7461 2870 635f 655f  cEmag_data(pc_e_
-0001a1f0: 6d61 675f 6172 7261 793d 7a73 7461 725f  mag_array=zstar_
-0001a200: 6172 7261 795f 746f 5f6e 616e 2028 0d0a  array_to_nan (..
-0001a210: 2020 2020 2020 2020 2020 2020 7a73 7461              zsta
-0001a220: 725f 6172 7261 793d 7365 6c66 2e5f 6461  r_array=self._da
-0001a230: 7461 5f61 7272 6179 5b3a 2c2d 365d 292c  ta_array[:,-6]),
-0001a240: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001a250: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-0001a260: 665f 6672 6571 7565 6e63 6965 733d 7365  f_frequencies=se
-0001a270: 6c66 2e5f 6e75 6d62 6572 5f6f 665f 6672  lf._number_of_fr
-0001a280: 6571 7565 6e63 6965 732c 200d 0a20 2020  equencies, ..   
-0001a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a2a0: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
-0001a2b0: 7469 6f6e 733d 7365 6c66 2e5f 6e75 6d62  tions=self._numb
-0001a2c0: 6572 5f6f 665f 7374 6174 696f 6e73 290d  er_of_stations).
-0001a2d0: 0a20 2020 2020 2020 2023 2073 4570 687a  .        # sEphz
-0001a2e0: 2873 5f70 687a 5f64 6174 613d 7365 6c66  (s_phz_data=self
-0001a2f0: 2e5f 6461 7461 5b3a 2c2d 355d 290d 0a20  ._data[:,-5]).. 
-0001a300: 2020 2020 2020 2073 656c 662e 7345 7068         self.sEph
-0001a310: 7a2e 5f72 6561 645f 7345 7068 7a5f 6461  z._read_sEphz_da
-0001a320: 7461 2028 7345 7068 7a5f 6172 7261 793d  ta (sEphz_array=
-0001a330: 7a73 7461 725f 6172 7261 795f 746f 5f6e  zstar_array_to_n
-0001a340: 616e 2028 0d0a 2020 2020 2020 2020 2020  an (..          
-0001a350: 2020 7a73 7461 725f 6172 7261 793d 7365    zstar_array=se
-0001a360: 6c66 2e5f 6461 7461 5f61 7272 6179 5b3a  lf._data_array[:
-0001a370: 2c2d 355d 292c 0d0a 2020 2020 2020 2020  ,-5]),..        
-0001a380: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-0001a390: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-0001a3a0: 6965 733d 7365 6c66 2e5f 6e75 6d62 6572  ies=self._number
-0001a3b0: 5f6f 665f 6672 6571 7565 6e63 6965 732c  _of_frequencies,
-0001a3c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001a3d0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-0001a3e0: 6f66 5f73 7461 7469 6f6e 733d 7365 6c66  of_stations=self
-0001a3f0: 2e5f 6e75 6d62 6572 5f6f 665f 7374 6174  ._number_of_stat
-0001a400: 696f 6e73 2029 0d0a 2020 2020 2020 2020  ions )..        
-0001a410: 2320 7063 486d 6167 2870 635f 686d 6167  # pcHmag(pc_hmag
-0001a420: 5f64 6174 6120 3d73 656c 662e 5f64 6174  _data =self._dat
-0001a430: 615b 3a2c 202d 345d 290d 0a20 2020 2020  a[:, -4])..     
-0001a440: 2020 2073 656c 662e 7063 486d 6167 2e5f     self.pcHmag._
-0001a450: 7265 6164 5f70 6348 6d61 675f 6461 7461  read_pcHmag_data
-0001a460: 2870 635f 685f 6d61 675f 6172 7261 793d  (pc_h_mag_array=
-0001a470: 7a73 7461 725f 6172 7261 795f 746f 5f6e  zstar_array_to_n
-0001a480: 616e 2028 0d0a 2020 2020 2020 2020 2020  an (..          
-0001a490: 2020 7a73 7461 725f 6172 7261 793d 7365    zstar_array=se
-0001a4a0: 6c66 2e5f 6461 7461 5f61 7272 6179 5b3a  lf._data_array[:
-0001a4b0: 2c2d 345d 292c 0d0a 2020 2020 2020 2020  ,-4]),..        
-0001a4c0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-0001a4d0: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-0001a4e0: 6965 733d 7365 6c66 2e5f 6e75 6d62 6572  ies=self._number
-0001a4f0: 5f6f 665f 6672 6571 7565 6e63 6965 732c  _of_frequencies,
-0001a500: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001a510: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-0001a520: 6f66 5f73 7461 7469 6f6e 733d 7365 6c66  of_stations=self
-0001a530: 2e5f 6e75 6d62 6572 5f6f 665f 7374 6174  ._number_of_stat
-0001a540: 696f 6e73 290d 0a20 2020 2020 2020 2023  ions)..        #
-0001a550: 2073 4870 687a 2873 5f68 7068 7a5f 6461   sHphz(s_hphz_da
-0001a560: 7461 3d73 656c 662e 5f64 6174 615b 3a2c  ta=self._data[:,
-0001a570: 2d33 5d29 0d0a 2020 2020 2020 2020 7365  -3])..        se
-0001a580: 6c66 2e73 4870 687a 2e5f 7265 6164 5f73  lf.sHphz._read_s
-0001a590: 4870 687a 5f64 6174 6120 2873 4870 687a  Hphz_data (sHphz
-0001a5a0: 5f61 7272 6179 3d7a 7374 6172 5f61 7272  _array=zstar_arr
-0001a5b0: 6179 5f74 6f5f 6e61 6e20 280d 0a20 2020  ay_to_nan (..   
-0001a5c0: 2020 2020 2020 2020 207a 7374 6172 5f61           zstar_a
-0001a5d0: 7272 6179 3d73 656c 662e 5f64 6174 615f  rray=self._data_
-0001a5e0: 6172 7261 795b 3a2c 2d33 5d29 2c0d 0a20  array[:,-3]),.. 
-0001a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a600: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-0001a610: 665f 6672 6571 7565 6e63 6965 733d 7365  f_frequencies=se
-0001a620: 6c66 2e5f 6e75 6d62 6572 5f6f 665f 6672  lf._number_of_fr
-0001a630: 6571 7565 6e63 6965 732c 200d 0a20 2020  equencies, ..   
-0001a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a650: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-0001a660: 7374 6174 696f 6e73 3d73 656c 662e 5f6e  stations=self._n
-0001a670: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-0001a680: 7320 2920 2020 0d0a 2020 2020 0d0a 2020  s )   ..    ..  
-0001a690: 2020 2020 200d 0a0d 0a63 6c61 7373 2020       ....class  
-0001a6a0: 5374 6174 696f 6e28 6f62 6a65 6374 293a  Station(object):
-0001a6b0: 0d0a 2020 2020 2222 220d 0a20 2020 2053  ..    """..    S
-0001a6c0: 7461 7469 6f6e 7320 696e 666f 726d 6174  tations informat
-0001a6d0: 696f 6e73 200d 0a20 2020 200d 0a20 2020  ions ..    ..   
-0001a6e0: 2041 7267 756d 656e 7473 0d0a 2020 2020   Arguments..    
-0001a6f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-0001a700: 2020 2020 202a 2a6e 6f72 6d5f 7374 6174       **norm_stat
-0001a710: 696f 6e5f 7661 6c75 652a 2a3a 2062 6f6f  ion_value**: boo
-0001a720: 6c20 0d0a 2020 2020 2020 2020 2020 2020  l ..            
-0001a730: 2020 2049 6620 5472 7565 2c20 7374 6174     If True, stat
-0001a740: 696f 6e20 7769 6c6c 206e 756d 6265 7265  ion will numbere
-0001a750: 6420 7374 6172 7469 6e67 2062 7920 302e  d starting by 0.
-0001a760: 2a44 6566 6175 6c74 2a20 6973 2054 7275  *Default* is Tru
-0001a770: 650d 0a0d 0a20 2020 203d 3d3d 3d3d 3d3d  e....    =======
-0001a780: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-0001a790: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-0001a7a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001a7b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001a7c0: 3d3d 3d3d 0d0a 2020 2020 4174 7472 6962  ====..    Attrib
-0001a7d0: 7574 6573 2020 2020 2020 2020 5479 7065  utes        Type
-0001a7e0: 2020 2020 2020 2020 2020 4578 706c 616e            Explan
-0001a7f0: 6174 696f 6e0d 0a20 2020 203d 3d3d 3d3d  ation..    =====
-0001a800: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
-0001a810: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-0001a820: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001a830: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001a840: 3d3d 3d3d 3d3d 0d0a 2020 2020 7661 6c75  ======..    valu
-0001a850: 6520 2020 2020 2020 2020 2020 2020 6e64  e             nd
-0001a860: 2e61 7272 6179 2020 2020 2020 6461 7461  .array      data
-0001a870: 206f 6620 7374 6174 696f 6e20 2063 6f6c   of station  col
-0001a880: 756d 6e73 2063 6f6d 706f 6e65 6e74 7320  umns components 
-0001a890: 0d0a 2020 2020 6d61 7820 2020 2020 2020  ..    max       
-0001a8a0: 2020 2020 2020 2020 666c 6f61 7420 2020          float   
-0001a8b0: 2020 2020 2020 6d61 7869 6d75 6d20 6469        maximum di
-0001a8c0: 7374 616e 6365 206f 6620 7375 7276 6579  stance of survey
-0001a8d0: 206c 696e 6573 200d 0a20 2020 206d 696e   lines ..    min
-0001a8e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001a8f0: 6c6f 6174 2020 2020 2020 2020 206d 696e  loat         min
-0001a900: 696d 756d 2064 6973 7461 6e63 6520 7374  imum distance st
-0001a910: 7261 7465 6420 7265 636f 7264 6564 2064  rated recorded d
-0001a920: 6174 6120 200d 0a20 2020 206e 616d 6573  ata  ..    names
-0001a930: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0001a940: 7220 2020 2020 2020 2020 206e 616d 6573  r          names
-0001a950: 206f 6620 7374 6174 696f 6e73 206e 616d   of stations nam
-0001a960: 6520 6669 6c6c 6564 2061 7574 6f6d 6174  e filled automat
-0001a970: 6963 616c 790d 0a20 2020 2065 6e64 2020  icaly..    end  
-0001a980: 2020 2020 2020 2020 2020 2020 2073 7472               str
-0001a990: 2020 2020 2020 2020 2020 206c 6173 7420             last 
-0001a9a0: 7374 6174 696f 6e20 6e61 6d65 200d 0a20  station name .. 
-0001a9b0: 2020 206c 656e 6768 2020 2020 2020 2020     lengh        
-0001a9c0: 2020 2020 2066 6c6f 6174 2020 2020 2020       float      
-0001a9d0: 2020 206c 656e 6768 7420 6f66 2074 6865     lenght of the
-0001a9e0: 2073 7572 7665 7920 0d0a 2020 2020 756e   survey ..    un
-0001a9f0: 6974 2020 2020 2020 2020 2020 2020 2020  it              
-0001aa00: 7374 7220 2020 2020 2020 2020 2020 6c69  str           li
-0001aa10: 6e65 7320 6c65 6e67 6874 2075 6e69 7473  nes lenght units
-0001aa20: 2020 6d61 7920 6265 206f 6e20 5b6d 2c20    may be on [m, 
-0001aa30: 6b6d 202c 2066 745d 0d0a 2020 2020 616c  km , ft]..    al
-0001aa40: 6c64 6174 6120 2020 2020 2020 2020 2020  ldata           
-0001aa50: 6e64 2e61 7272 6179 2020 2020 2020 6e64  nd.array      nd
-0001aa60: 6172 7261 7920 6f66 2061 6c6c 2064 6174  array of all dat
-0001aa70: 6120 7661 6c75 6520 6672 6f6d 2072 6177  a value from raw
-0001aa80: 2066 696c 650d 0a20 2020 206c 6f63 2020   file..    loc  
-0001aa90: 2020 2020 2020 2020 2020 2020 2064 6963               dic
-0001aaa0: 7420 2020 2020 2020 2020 206d 6169 6e20  t          main 
-0001aab0: 6174 7472 6962 7574 6520 6c6f 6361 7469  attribute locati
-0001aac0: 6f6e 206f 6620 7374 6174 696f 6e3a 2065  on of station: e
-0001aad0: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
-0001aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aaf0: 2020 2020 2020 206c 6f63 205b 2753 3031         loc ['S01
-0001ab00: 275d 2073 686f 7720 7468 6520 6469 7374  '] show the dist
-0001ab10: 616e 6365 206f 6620 7374 6174 696f 6e20  ance of station 
-0001ab20: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
-0001ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ab40: 2020 2020 2020 2020 7468 6174 2070 6f69          that poi
-0001ab50: 6e74 2e20 0d0a 2020 2020 3d3d 3d3d 3d3d  nt. ..    ======
-0001ab60: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-0001ab70: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-0001ab80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001ab90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001aba0: 3d3d 3d3d 3d0d 0a0d 0a20 2020 204d 6f72  =====....    Mor
-0001abb0: 6520 6174 7472 6962 7574 6573 2063 616e  e attributes can
-0001abc0: 2062 6520 6164 6465 6420 6279 2069 6e70   be added by inp
-0001abd0: 7574 696e 6720 6120 6b65 7920 776f 7264  uting a key word
-0001abe0: 2064 6963 7469 6f6e 6172 790d 0a0d 0a20   dictionary.... 
-0001abf0: 2020 203a 4578 616d 706c 653a 200d 0a20     :Example: .. 
-0001ac00: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001ac10: 203e 3e3e 2066 726f 6d20 7079 6373 616d   >>> from pycsam
-0001ac20: 742e 6666 2e63 6f72 652e 6176 6720 696d  t.ff.core.avg im
-0001ac30: 706f 7274 2053 7461 7469 6f6e 0d0a 2020  port Station..  
-0001ac40: 2020 2020 2020 3e3e 3e20 7061 7468 3d6f        >>> path=o
-0001ac50: 732e 7061 7468 2e6a 6f69 6e28 6f73 2e65  s.path.join(os.e
-0001ac60: 6e76 6972 6f6e 5b22 7079 4353 414d 5422  nviron["pyCSAMT"
-0001ac70: 5d2c 200d 0a20 2020 2020 2020 202e 2e2e  ], ..        ...
-0001ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac90: 2020 2020 2020 2770 7963 7361 6d74 272c        'pycsamt',
-0001aca0: 2022 6461 7461 222c 2022 4b31 2e41 5647   "data", "K1.AVG
-0001acb0: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
-0001acc0: 7374 6174 696f 6e3d 5374 6174 696f 6e28  station=Station(
-0001acd0: 7061 7468 290d 0a20 2020 2020 2020 203e  path)..        >
-0001ace0: 3e3e 2070 7269 6e74 2873 7461 7469 6f6e  >> print(station
-0001acf0: 2e6c 6f63 5b27 5330 3727 5d29 0d0a 2020  .loc['S07'])..  
-0001ad00: 2020 2222 220d 0a20 2020 200d 0a20 2020    """..    ..   
-0001ad10: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0001ad20: 6c66 2c20 7374 6174 696f 6e5f 6461 7461  lf, station_data
-0001ad30: 5f61 7272 6179 203d 4e6f 6e65 2c20 202a  _array =None,  *
-0001ad40: 2a6b 7761 7267 7329 3a0d 0a0d 0a20 2020  *kwargs):....   
-0001ad50: 2020 2020 2073 656c 662e 5f6c 6f67 6769       self._loggi
-0001ad60: 6e67 3d63 7361 6d74 7079 6c6f 672e 6765  ng=csamtpylog.ge
-0001ad70: 745f 6373 616d 7470 795f 6c6f 6767 6572  t_csamtpy_logger
-0001ad80: 2873 656c 662e 5f5f 636c 6173 735f 5f2e  (self.__class__.
-0001ad90: 5f5f 6e61 6d65 5f5f 290d 0a20 2020 2020  __name__)..     
-0001ada0: 2020 200d 0a0d 0a20 2020 2020 2020 2073     ....        s
-0001adb0: 656c 662e 7374 6174 696f 6e5f 6461 7461  elf.station_data
-0001adc0: 5f61 7272 6179 203d 7374 6174 696f 6e5f  _array =station_
-0001add0: 6461 7461 5f61 7272 6179 0d0a 2020 2020  data_array..    
-0001ade0: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
-0001adf0: 7365 6c66 2e6e 6f72 6d61 6c69 7a65 645f  self.normalized_
-0001ae00: 7374 6174 696f 6e5f 7661 6c75 6520 3d20  station_value = 
-0001ae10: 6b77 6172 6773 2e70 6f70 2827 6e6f 726d  kwargs.pop('norm
-0001ae20: 616c 697a 6564 5f73 7461 7469 6f6e 5f76  alized_station_v
-0001ae30: 616c 7565 272c 2046 616c 7365 290d 0a20  alue', False).. 
-0001ae40: 2020 2020 2020 2073 656c 662e 7265 6e61         self.rena
-0001ae50: 6d65 5f73 7461 7469 6f6e 203d 6b77 6172  me_station =kwar
-0001ae60: 6773 2e70 6f70 2827 7265 6e61 6d65 5f73  gs.pop('rename_s
-0001ae70: 6174 696f 6e27 2c20 4e6f 6e65 290d 0a20  ation', None).. 
-0001ae80: 2020 2020 2020 2073 656c 662e 756e 6974         self.unit
-0001ae90: 3d6b 7761 7267 732e 706f 7028 2775 6e69  =kwargs.pop('uni
-0001aea0: 745f 6f66 5f64 6973 7461 6e63 655f 6d65  t_of_distance_me
-0001aeb0: 6173 7572 6564 272c 2027 6d27 290d 0a20  asured', 'm').. 
-0001aec0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001aed0: 2073 656c 662e 6e61 6d65 7320 3d4e 6f6e   self.names =Non
-0001aee0: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
-0001aef0: 2e76 616c 7565 203d 4e6f 6e65 200d 0a20  .value =None .. 
-0001af00: 2020 2020 2020 2073 656c 662e 6d61 783d         self.max=
-0001af10: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
-0001af20: 656c 662e 6d69 6e20 3d4e 6f6e 6520 0d0a  elf.min =None ..
-0001af30: 2020 2020 2020 2020 7365 6c66 2e6c 6173          self.las
-0001af40: 745f 7374 6174 696f 6e5f 6e61 6d65 203d  t_station_name =
-0001af50: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
-0001af60: 656c 662e 6c65 6e67 7468 203d 4e6f 6e65  elf.length =None
-0001af70: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-0001af80: 7661 6c75 6520 3d4e 6f6e 6520 0d0a 2020  value =None ..  
-0001af90: 2020 2020 2020 0d0a 0d0a 2020 2020 6465        ....    de
-0001afa0: 6620 5f73 6574 5f73 7461 7469 6f6e 5f28  f _set_station_(
-0001afb0: 7365 6c66 2c73 7461 7469 6f6e 5f64 6174  self,station_dat
-0001afc0: 615f 6172 7261 7920 3d4e 6f6e 652c 2072  a_array =None, r
-0001afd0: 656e 616d 655f 7374 6174 696f 6e20 3d4e  ename_station =N
-0001afe0: 6f6e 6520 2c20 0d0a 2020 2020 2020 2020  one , ..        
-0001aff0: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-0001b000: 726d 616c 697a 6564 5f73 7461 7469 6f6e  rmalized_station
-0001b010: 5f76 616c 7565 3d46 616c 7365 2029 2020  _value=False )  
-0001b020: 3a20 0d0a 2020 2020 2020 2020 2222 220d  : ..        """.
-0001b030: 0a20 2020 2020 2020 204d 6574 686f 6420  .        Method 
-0001b040: 746f 2073 6574 2073 7461 7469 6f6e 206f  to set station o
-0001b050: 6e20 6469 6374 696f 6e6e 6172 7920 6f66  n dictionnary of
-0001b060: 2065 6163 6820 6469 7374 616e 6365 2e20   each distance. 
-0001b070: 496e 2066 6163 740d 0a20 2020 2020 2020  In fact..       
-0001b080: 2020 746f 2065 6173 696c 7920 6578 706f    to easily expo
-0001b090: 7274 2066 6f72 2070 6c6f 7474 696e 6720  rt for plotting 
-0001b0a0: 6561 6368 2073 7461 7469 6f6e 202e 200d  each station . .
-0001b0b0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0001b0c0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0001b0d0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0001b0e0: 2020 2020 2020 202a 2073 7461 7469 6f6e         * station
-0001b0f0: 5f64 6174 615f 6172 7261 7920 3a20 6e70  _data_array : np
-0001b100: 2e6e 6461 7272 6179 2028 6e64 6172 7261  .ndarray (ndarra
-0001b110: 792c 3129 2c20 6f70 7469 6f6e 616c 0d0a  y,1), optional..
-0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b140: 7374 6174 696f 6e20 7661 6c75 6520 7265  station value re
-0001b150: 636f 7264 6564 2069 6e20 7468 6520 6669  corded in the fi
-0001b160: 656c 6420 6174 2065 6163 6820 706f 696e  eld at each poin
-0001b170: 742e 0d0a 2020 2020 2020 2020 2020 2020  t...            
-0001b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b190: 2020 2020 5468 6520 2a64 6566 6175 6c74      The *default
-0001b1a0: 2a20 6973 204e 6f6e 652e 0d0a 2020 2020  * is None...    
-0001b1b0: 2020 2020 2020 2020 2a20 7265 6e61 6d65          * rename
-0001b1c0: 5f73 7461 7469 6f6e 203a 206e 702e 6e64  _station : np.nd
-0001b1d0: 6172 7261 7928 6e64 6172 7261 792c 3129  array(ndarray,1)
-0001b1e0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00018010: 2020 2020 2020 6164 6465 6420 696e 666f        added info
+00018020: 7320 6672 6f6d 2061 7374 6174 6963 2066  s from astatic f
+00018030: 696c 652e 200d 0a20 2020 2020 2020 2020  ile. ..         
+00018040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018050: 2020 2020 2020 202a 4465 6661 756c 742a         *Default*
+00018060: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2020   is None...     
+00018070: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00018080: 6966 2064 6174 615f 6172 7261 7920 6973  if data_array is
+00018090: 206e 6f74 204e 6f6e 6520 3a20 0d0a 2020   not None : ..  
+000180a0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000180b0: 6461 7461 5f61 7272 6179 203d 6461 7461  data_array =data
+000180c0: 5f61 7272 6179 0d0a 2020 2020 2020 2020  _array..        
+000180d0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+000180e0: 2073 656c 662e 5f64 6174 615f 6172 7261   self._data_arra
+000180f0: 7920 6973 204e 6f6e 6520 3a20 0d0a 2020  y is None : ..  
+00018100: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00018110: 4156 4745 7272 6f72 2827 4e6f 2044 6174  AVGError('No Dat
+00018120: 6120 6672 6f6d 2061 7667 6669 6c65 2074  a from avgfile t
+00018130: 6f20 7265 6164 2e27 290d 0a20 2020 2020  o read.')..     
+00018140: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00018150: 2069 6620 6461 7461 5f74 7970 6520 6973   if data_type is
+00018160: 206e 6f74 204e 6f6e 6520 3a20 0d0a 2020   not None : ..  
+00018170: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00018180: 6620 3d64 6174 615f 7479 7065 0d0a 2020  f =data_type..  
+00018190: 2020 2020 2020 6966 2073 656c 662e 5f66        if self._f
+000181a0: 206e 6f74 2069 6e20 5b31 2c32 5d3a 200d   not in [1,2]: .
+000181b0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000181c0: 7365 2041 5647 4572 726f 7228 2720 4d61  se AVGError(' Ma
+000181d0: 7920 6368 6563 6b20 796f 7572 2061 7667  y check your avg
+000181e0: 2044 6174 6166 696c 652e 2729 0d0a 0d0a   Datafile.')....
+000181f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00018200: 2020 6e75 6d62 6572 5f6f 665f 6672 6571    number_of_freq
+00018210: 5f61 7272 6179 202c 2072 6570 203d 205c  _array , rep = \
+00018220: 0d0a 2020 2020 2020 2020 2020 2020 6e70  ..            np
+00018230: 2e75 6e69 7175 6528 7365 6c66 2e5f 6461  .unique(self._da
+00018240: 7461 5f61 7272 6179 5b3a 2c31 5d2c 2072  ta_array[:,1], r
+00018250: 6574 7572 6e5f 636f 756e 7473 3d54 7275  eturn_counts=Tru
+00018260: 6529 0d0a 2020 2020 2020 2020 6e75 6d62  e)..        numb
+00018270: 6572 5f6f 665f 7374 6174 696f 6e5f 6172  er_of_station_ar
+00018280: 7261 7920 2c20 7265 7020 3d20 5c0d 0a20  ray , rep = \.. 
+00018290: 2020 2020 2020 2020 2020 206e 702e 756e             np.un
+000182a0: 6971 7565 2873 656c 662e 5f64 6174 615f  ique(self._data_
+000182b0: 6172 7261 795b 3a2c 305d 2c20 7265 7475  array[:,0], retu
+000182c0: 726e 5f63 6f75 6e74 733d 5472 7565 290d  rn_counts=True).
+000182d0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+000182e0: 5f6e 756d 6265 725f 6f66 5f66 7265 7175  _number_of_frequ
+000182f0: 656e 6369 6573 3d20 6e75 6d62 6572 5f6f  encies= number_o
+00018300: 665f 6672 6571 5f61 7272 6179 2e73 697a  f_freq_array.siz
+00018310: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+00018320: 5f6e 756d 6265 725f 6f66 5f73 7461 7469  _number_of_stati
+00018330: 6f6e 7320 3d20 6e75 6d62 6572 5f6f 665f  ons = number_of_
+00018340: 7374 6174 696f 6e5f 6172 7261 792e 7369  station_array.si
+00018350: 7a65 0d0a 2020 2020 2020 2020 2320 7072  ze..        # pr
+00018360: 696e 7428 7365 6c66 2e6e 756d 6672 6571  int(self.numfreq
+00018370: 2c20 7365 6c66 2e6e 756d 7374 6174 696f  , self.numstatio
+00018380: 6e29 0d0a 0d0a 2020 2020 2020 2020 6966  n)....        if
+00018390: 2061 6464 5f61 7374 6174 6963 5f64 6174   add_astatic_dat
+000183a0: 6120 6973 206e 6f74 204e 6f6e 6520 3a0d  a is not None :.
+000183b0: 0a20 2020 2020 2020 2020 2020 2061 6464  .            add
+000183c0: 6564 5f61 7374 6174 6963 5f64 6174 613d  ed_astatic_data=
+000183d0: 6164 645f 6173 7461 7469 635f 6461 7461  add_astatic_data
+000183e0: 0d0a 2020 2020 2020 2020 2020 2020 7064  ..            pd
+000183f0: 665f 5a3d 2061 6464 6564 5f61 7374 6174  f_Z= added_astat
+00018400: 6963 5f64 6174 612e 6472 6f70 2827 5352  ic_data.drop('SR
+00018410: 6573 272c 2061 7869 733d 3129 0d0a 2020  es', axis=1)..  
+00018420: 2020 2020 2020 2020 2020 7064 665f 5a2e            pdf_Z.
+00018430: 7265 7365 745f 696e 6465 7828 6472 6f70  reset_index(drop
+00018440: 3d54 7275 652c 2069 6e70 6c61 6365 203d  =True, inplace =
+00018450: 5472 7565 2029 0d0a 2020 2020 2020 2020  True )..        
+00018460: 2020 2020 7365 6c66 2e5a 2e5f 7265 6164      self.Z._read
+00018470: 5f7a 4153 5f64 6174 6128 0d0a 2020 2020  _zAS_data(..    
+00018480: 2020 2020 2020 2020 2020 2020 7a5f 6162              z_ab
+00018490: 735f 6172 7261 7920 3d70 6466 5f5a 202c  s_array =pdf_Z ,
+000184a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000184b0: 2020 206e 756d 6265 725f 6f66 5f66 7265     number_of_fre
+000184c0: 7175 656e 6369 6573 3d20 7365 6c66 2e5f  quencies= self._
+000184d0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+000184e0: 6e63 6965 732c 200d 0a20 2020 2020 2020  ncies, ..       
+000184f0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+00018500: 6f66 5f73 7461 7469 6f6e 733d 7365 6c66  of_stations=self
+00018510: 2e5f 6e75 6d62 6572 5f6f 665f 7374 6174  ._number_of_stat
+00018520: 696f 6e73 2029 0d0a 2020 2020 2020 2020  ions )..        
+00018530: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00018540: 2020 232d 2d3e 2073 6574 2061 7374 6963    #--> set astic
+00018550: 6174 6963 0d0a 2020 2020 2020 2020 2020  atic..          
+00018560: 2020 7365 6c66 2e61 6464 6564 5f61 7374    self.added_ast
+00018570: 6174 6963 5f64 6174 613d 6164 6465 645f  atic_data=added_
+00018580: 6173 7461 7469 635f 6461 7461 5b27 5352  astatic_data['SR
+00018590: 6573 275d 2e74 6f5f 6e75 6d70 7928 290d  es'].to_numpy().
+000185a0: 0a0d 0a20 2020 2020 2020 2020 2020 200d  ...            .
+000185b0: 0a20 2020 2020 2020 2064 6566 207a 7374  .        def zst
+000185c0: 6172 5f61 7272 6179 5f74 6f5f 6e61 6e20  ar_array_to_nan 
+000185d0: 287a 7374 6172 5f61 7272 6179 2c20 6e61  (zstar_array, na
+000185e0: 6e5f 7661 6c75 653d 6e70 2e6e 616e 2c20  n_value=np.nan, 
+000185f0: 6b65 6570 5f73 7472 203d 4661 6c73 6529  keep_str =False)
+00018600: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00018610: 2222 220d 0a20 2020 2020 2020 2020 2020  """..           
+00018620: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00018630: 2020 2020 2020 2020 202d 2d2d 2d2d 2d2d           -------
+00018640: 2d2d 2d0d 0a20 2020 2020 2020 2020 2020  ---..           
+00018650: 2020 2020 202a 207a 7374 6172 5f61 7272       * zstar_arr
+00018660: 6179 203a 206e 6461 7272 6179 200d 0a20  ay : ndarray .. 
+00018670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018680: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00018690: 2063 6f6e 7461 696e 2075 6e66 6c6f 6174   contain unfloat
+000186a0: 2063 6f6e 7665 7274 6572 2076 616c 7565   converter value
+000186b0: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+000186c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000186d0: 6865 2075 6e63 6f6e 7665 7274 6572 2076  he unconverter v
+000186e0: 616c 7565 2063 616e 2062 6520 6120 272a  alue can be a '*
+000186f0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+00018700: 2020 202a 206e 616e 5f76 616c 7565 203a     * nan_value :
+00018710: 2066 6c6f 6174 206f 7220 6e70 2e6e 616e   float or np.nan
+00018720: 2074 7970 6520 200d 0a20 2020 2020 2020   type  ..       
+00018730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018740: 2020 2020 206e 616e 5f76 616c 7565 2063       nan_value c
+00018750: 6f75 6c64 2062 6520 616e 7920 7661 6c75  ould be any valu
+00018760: 6520 6569 7468 6572 2069 6e74 2c20 666c  e either int, fl
+00018770: 6f61 7420 6f72 2073 7472 2e20 200d 0a20  oat or str.  .. 
+00018780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018790: 2020 2020 2020 2020 2020 2049 6620 5468             If Th
+000187a0: 6520 6465 6661 756c 7420 6973 206e 702e  e default is np.
+000187b0: 6e61 6e2e 0d0a 2020 2020 2020 2020 2020  nan...          
+000187c0: 2020 2020 2020 2a20 6b65 6570 5f73 7472        * keep_str
+000187d0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+000187e0: 6c20 200d 0a20 2020 2020 2020 2020 2020  l  ..           
+000187f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018800: 206b 6565 7020 7468 6520 7374 7220 6974   keep the str it
+00018810: 656d 206f 6e20 796f 7572 2061 7272 6179  em on your array
+00018820: 2e0d 0a20 2020 2020 2020 2020 2020 2052  ...            R
+00018830: 6574 7572 6e73 200d 0a20 2020 2020 2020  eturns ..       
+00018840: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+00018850: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00018860: 7261 795f 6c69 6b65 200d 0a20 2020 2020  ray_like ..     
+00018870: 2020 2020 2020 2020 2020 2020 2020 207a                 z
+00018880: 7374 7261 725f 6172 7261 7920 636f 6e76  strar_array conv
+00018890: 6572 7465 6420 0d0a 2020 2020 2020 2020  erted ..        
+000188a0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+000188b0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+000188c0: 2020 2066 6f72 206b 6b20 2c20 7661 6c75     for kk , valu
+000188d0: 6520 696e 2065 6e75 6d65 7261 7465 287a  e in enumerate(z
+000188e0: 7374 6172 5f61 7272 6179 293a 200d 0a20  star_array): .. 
+000188f0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00018900: 7279 203a 207a 7374 6172 5f61 7272 6179  ry : zstar_array
+00018910: 5b6b 6b5d 203d 666c 6f61 7428 7661 6c75  [kk] =float(valu
+00018920: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00018930: 2020 2020 6578 6365 7074 203a 7a73 7461      except :zsta
+00018940: 725f 6172 7261 795b 6b6b 5d3d 6e61 6e5f  r_array[kk]=nan_
+00018950: 7661 6c75 650d 0a20 2020 2020 2020 2020  value..         
+00018960: 2020 2069 6620 7479 7065 286e 616e 5f76     if type(nan_v
+00018970: 616c 7565 2920 6973 2073 7472 203a 206b  alue) is str : k
+00018980: 6565 705f 7374 723d 5472 7565 0d0a 2020  eep_str=True..  
+00018990: 2020 2020 2020 2020 2020 6966 206b 6565            if kee
+000189a0: 705f 7374 7220 3a20 7265 7475 726e 207a  p_str : return z
+000189b0: 7374 6172 5f61 7272 6179 200d 0a20 2020  star_array ..   
+000189c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000189d0: 6e70 2e61 7272 6179 285b 666c 6f61 7428  np.array([float(
+000189e0: 6b6b 2920 666f 7220 6b6b 2069 6e20 7a73  kk) for kk in zs
+000189f0: 7461 725f 6172 7261 795d 2920 2020 0d0a  tar_array])   ..
+00018a00: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00018a10: 2020 2020 2020 2320 7472 7920 746f 2063        # try to c
+00018a20: 6861 6e67 6520 7468 6520 6474 7970 6520  hange the dtype 
+00018a30: 6f66 2064 6174 6120 6966 2064 7479 7065  of data if dtype
+00018a40: 206f 6620 7468 6520 6461 7461 7365 7420   of the dataset 
+00018a50: 6973 206e 6f74 2066 6c6f 6174 200d 0a0d  is not float ...
+00018a60: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00018a70: 2e5f 6461 7461 5f61 7272 6179 2e64 7479  ._data_array.dty
+00018a80: 7065 206e 6f74 2069 6e20 5b27 666c 6f61  pe not in ['floa
+00018a90: 7427 2c20 2769 6e74 275d 3a0d 0a20 2020  t', 'int']:..   
+00018aa0: 2020 2020 2020 2020 2064 6174 615f 7472           data_tr
+00018ab0: 616e 7369 746f 7279 203d 5b7a 7374 6172  ansitory =[zstar
+00018ac0: 5f61 7272 6179 5f74 6f5f 6e61 6e28 7a73  _array_to_nan(zs
+00018ad0: 7461 725f 6172 7261 793d 726f 776c 696e  tar_array=rowlin
+00018ae0: 6529 200d 0a20 2020 2020 2020 2020 2020  e) ..           
+00018af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018b00: 2020 2066 6f72 2064 642c 2072 6f77 6c69     for dd, rowli
+00018b10: 6e65 2069 6e20 656e 756d 6572 6174 6528  ne in enumerate(
+00018b20: 7365 6c66 2e5f 6461 7461 5f61 7272 6179  self._data_array
+00018b30: 295d 0d0a 2020 2020 2020 2020 2020 2020  )]..            
+00018b40: 7365 6c66 2e5f 6461 7461 5f61 7272 6179  self._data_array
+00018b50: 3d66 756e 632e 636f 6e63 6174 5f61 7272  =func.concat_arr
+00018b60: 6179 5f66 726f 6d5f 6c69 7374 280d 0a20  ay_from_list(.. 
+00018b70: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00018b80: 6973 745f 6f66 5f61 7272 6179 3d64 6174  ist_of_array=dat
+00018b90: 615f 7472 616e 7369 746f 7279 290d 0a20  a_transitory).. 
+00018ba0: 200d 0a20 2020 2020 2020 2023 2070 6f70   ..        # pop
+00018bb0: 756c 6174 6520 636c 6173 7365 7320 2e20  ulate classes . 
+00018bc0: 200d 0a20 2020 2020 2020 2023 6375 7420   ..        #cut 
+00018bd0: 6f66 2073 7065 6369 616c 2066 7265 715f  of special freq_
+00018be0: 6172 7261 7920 616e 6420 7374 6174 696f  array and statio
+00018bf0: 6e73 0d0a 2020 2020 2020 2020 2320 666f  ns..        # fo
+00018c00: 7220 6d6f 7265 2063 6572 7461 696e 746c  r more certaintl
+00018c10: 7920 2c20 616e 7920 7661 6c75 6520 7769  y , any value wi
+00018c20: 6c6c 2063 6f6d 6520 6d75 7374 2062 6520  ll come must be 
+00018c30: 6368 6563 6b20 7768 6574 6865 7220 6974  check whether it
+00018c40: 730d 0a20 2020 2020 2020 2023 2070 6f73  s..        # pos
+00018c50: 7369 626c 6520 746f 2063 6f6e 7665 7274  sible to convert
+00018c60: 202c 2069 6620 6e6f 7420 7661 6c75 6520   , if not value 
+00018c70: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
+00018c80: 2020 7769 6c6c 2073 6574 2074 6f20 6e70    will set to np
+00018c90: 2e6e 616e 200d 0a0d 0a20 2020 2020 2020  .nan ....       
+00018ca0: 2073 656c 662e 5374 6174 696f 6e2e 5f73   self.Station._s
+00018cb0: 6574 5f73 7461 7469 6f6e 5f28 7374 6174  et_station_(stat
+00018cc0: 696f 6e5f 6461 7461 5f61 7272 6179 3d7a  ion_data_array=z
+00018cd0: 7374 6172 5f61 7272 6179 5f74 6f5f 6e61  star_array_to_na
+00018ce0: 6e20 280d 0a20 2020 2020 2020 2020 2020  n (..           
+00018cf0: 207a 7374 6172 5f61 7272 6179 3d73 656c   zstar_array=sel
+00018d00: 662e 5f64 6174 615f 6172 7261 795b 3a2c  f._data_array[:,
+00018d10: 305d 292c 200d 0a20 2020 2020 2020 2020  0]), ..         
+00018d20: 2020 206e 6f72 6d61 6c69 7a65 645f 7374     normalized_st
+00018d30: 6174 696f 6e5f 7661 6c75 653d 7365 6c66  ation_value=self
+00018d40: 2e6e 6f72 6d61 6c69 7a65 645f 7374 6174  .normalized_stat
+00018d50: 696f 6e5f 7661 6c75 6520 290d 0a20 2020  ion_value )..   
+00018d60: 2020 2020 2073 656c 662e 4672 6571 7565       self.Freque
+00018d70: 6e63 792e 5f73 6574 5f66 7265 7175 656e  ncy._set_frequen
+00018d80: 6379 2866 7265 715f 6172 7261 793d 7a73  cy(freq_array=zs
+00018d90: 7461 725f 6172 7261 795f 746f 5f6e 616e  tar_array_to_nan
+00018da0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00018db0: 7a73 7461 725f 6172 7261 793d 7365 6c66  zstar_array=self
+00018dc0: 2e5f 6461 7461 5f61 7272 6179 5b3a 2c31  ._data_array[:,1
+00018dd0: 5d29 290d 0a20 2020 2020 2020 2073 656c  ]))..        sel
+00018de0: 662e 416d 7073 2e5f 7265 6164 5f61 6d70  f.Amps._read_amp
+00018df0: 735f 6461 7461 2861 6d70 735f 6172 7261  s_data(amps_arra
+00018e00: 793d 7a73 7461 725f 6172 7261 795f 746f  y=zstar_array_to
+00018e10: 5f6e 616e 2028 0d0a 2020 2020 2020 2020  _nan (..        
+00018e20: 2020 2020 7a73 7461 725f 6172 7261 793d      zstar_array=
+00018e30: 7365 6c66 2e5f 6461 7461 5f61 7272 6179  self._data_array
+00018e40: 5b3a 2c32 5d29 2c20 0d0a 2020 2020 2020  [:,2]), ..      
+00018e50: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00018e60: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
+00018e70: 6965 733d 7365 6c66 2e5f 6e75 6d62 6572  ies=self._number
+00018e80: 5f6f 665f 6672 6571 7565 6e63 6965 732c  _of_frequencies,
+00018e90: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00018ea0: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
+00018eb0: 5f73 7461 7469 6f6e 733d 7365 6c66 2e5f  _stations=self._
+00018ec0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+00018ed0: 6e73 290d 0a20 2020 2020 2020 2023 2041  ns)..        # A
+00018ee0: 6d70 7328 616d 7073 5f61 7272 6179 3d73  mps(amps_array=s
+00018ef0: 656c 662e 5f64 6174 615f 6172 7261 795b  elf._data_array[
+00018f00: 3a2c 325d 290d 0a20 2020 2020 2020 2073  :,2])..        s
+00018f10: 656c 662e 456d 6167 2e5f 7265 6164 5f65  elf.Emag._read_e
+00018f20: 6d61 675f 6461 7461 2865 5f6d 6167 5f61  mag_data(e_mag_a
+00018f30: 7272 6179 3d7a 7374 6172 5f61 7272 6179  rray=zstar_array
+00018f40: 5f74 6f5f 6e61 6e20 280d 0a20 2020 2020  _to_nan (..     
+00018f50: 2020 2020 2020 207a 7374 6172 5f61 7272         zstar_arr
+00018f60: 6179 3d73 656c 662e 5f64 6174 615f 6172  ay=self._data_ar
+00018f70: 7261 795b 3a2c 335d 292c 0d0a 2020 2020  ray[:,3]),..    
+00018f80: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+00018f90: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00018fa0: 733d 7365 6c66 2e5f 6e75 6d62 6572 5f6f  s=self._number_o
+00018fb0: 665f 6672 6571 7565 6e63 6965 732c 200d  f_frequencies, .
+00018fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018fd0: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
+00018fe0: 6f6e 733d 7365 6c66 2e5f 6e75 6d62 6572  ons=self._number
+00018ff0: 5f6f 665f 7374 6174 696f 6e73 2029 0d0a  _of_stations )..
+00019000: 2020 2020 2020 2020 2320 456d 6167 2865          # Emag(e
+00019010: 5f6d 6167 5f61 7272 6179 203d 7365 6c66  _mag_array =self
+00019020: 2e5f 6461 7461 5f61 7272 6179 5b3a 2c33  ._data_array[:,3
+00019030: 5d29 0d0a 2020 2020 2020 2020 7365 6c66  ])..        self
+00019040: 2e45 7068 7a2e 5f72 6561 645f 6570 687a  .Ephz._read_ephz
+00019050: 5f64 6174 6128 655f 7068 7a5f 6172 7261  _data(e_phz_arra
+00019060: 793d 7a73 7461 725f 6172 7261 795f 746f  y=zstar_array_to
+00019070: 5f6e 616e 2028 0d0a 2020 2020 2020 2020  _nan (..        
+00019080: 2020 2020 7a73 7461 725f 6172 7261 793d      zstar_array=
+00019090: 7365 6c66 2e5f 6461 7461 5f61 7272 6179  self._data_array
+000190a0: 5b3a 2c20 345d 292c 0d0a 2020 2020 2020  [:, 4]),..      
+000190b0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+000190c0: 5f6f 665f 6672 6571 7565 6e63 6965 733d  _of_frequencies=
+000190d0: 7365 6c66 2e5f 6e75 6d62 6572 5f6f 665f  self._number_of_
+000190e0: 6672 6571 7565 6e63 6965 732c 200d 0a20  frequencies, .. 
+000190f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019100: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+00019110: 733d 7365 6c66 2e5f 6e75 6d62 6572 5f6f  s=self._number_o
+00019120: 665f 7374 6174 696f 6e73 2c0d 0a20 2020  f_stations,..   
+00019130: 2020 2020 2020 2020 2020 2020 2074 6f5f               to_
+00019140: 6465 6772 6565 203d 7365 6c66 2e73 6574  degree =self.set
+00019150: 5f74 6f5f 6465 6772 6565 2020 290d 0a20  _to_degree  ).. 
+00019160: 2020 2020 2020 2023 2045 7068 7a28 655f         # Ephz(e_
+00019170: 7068 7a5f 6172 7261 793d 7365 6c66 2e5f  phz_array=self._
+00019180: 6461 7461 5f61 7272 6179 5b3a 2c20 345d  data_array[:, 4]
+00019190: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000191a0: 486d 6167 2e5f 7265 6164 5f68 6d61 675f  Hmag._read_hmag_
+000191b0: 6461 7461 2868 5f6d 6167 5f61 7272 6179  data(h_mag_array
+000191c0: 3d7a 7374 6172 5f61 7272 6179 5f74 6f5f  =zstar_array_to_
+000191d0: 6e61 6e20 280d 0a20 2020 2020 2020 2020  nan (..         
+000191e0: 2020 207a 7374 6172 5f61 7272 6179 3d73     zstar_array=s
+000191f0: 656c 662e 5f64 6174 615f 6172 7261 795b  elf._data_array[
+00019200: 3a2c 355d 292c 0d0a 2020 2020 2020 2020  :,5]),..        
+00019210: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+00019220: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00019230: 733d 7365 6c66 2e5f 6e75 6d62 6572 5f6f  s=self._number_o
+00019240: 665f 6672 6571 7565 6e63 6965 732c 200d  f_frequencies, .
+00019250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019260: 2020 2020 206e 756d 6265 725f 6f66 5f73       number_of_s
+00019270: 7461 7469 6f6e 733d 7365 6c66 2e5f 6e75  tations=self._nu
+00019280: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+00019290: 2029 0d0a 2020 2020 2020 2020 2320 486d   )..        # Hm
+000192a0: 6167 2028 685f 6d61 675f 6172 7261 7920  ag (h_mag_array 
+000192b0: 3d73 656c 662e 5f64 6174 615f 6172 7261  =self._data_arra
+000192c0: 795b 3a2c 355d 290d 0a20 2020 2020 2020  y[:,5])..       
+000192d0: 2073 656c 662e 4870 687a 2e5f 7265 6164   self.Hphz._read
+000192e0: 5f68 7068 7a5f 6461 7461 2868 5f70 687a  _hphz_data(h_phz
+000192f0: 5f61 7272 6179 3d7a 7374 6172 5f61 7272  _array=zstar_arr
+00019300: 6179 5f74 6f5f 6e61 6e20 280d 0a20 2020  ay_to_nan (..   
+00019310: 2020 2020 2020 2020 207a 7374 6172 5f61           zstar_a
+00019320: 7272 6179 3d73 656c 662e 5f64 6174 615f  rray=self._data_
+00019330: 6172 7261 795b 3a2c 2036 5d29 2c0d 0a20  array[:, 6]),.. 
+00019340: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019350: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
+00019360: 6369 6573 3d73 656c 662e 5f6e 756d 6265  cies=self._numbe
+00019370: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
+00019380: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00019390: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
+000193a0: 6174 696f 6e73 3d73 656c 662e 5f6e 756d  ations=self._num
+000193b0: 6265 725f 6f66 5f73 7461 7469 6f6e 732c  ber_of_stations,
+000193c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000193d0: 2020 746f 5f64 6567 7265 6520 3d73 656c    to_degree =sel
+000193e0: 662e 7365 745f 746f 5f64 6567 7265 6520  f.set_to_degree 
+000193f0: 2029 0d0a 2020 2020 2020 2020 2320 4870   )..        # Hp
+00019400: 687a 2868 5f70 687a 5f61 7272 6179 3d73  hz(h_phz_array=s
+00019410: 656c 662e 5f64 6174 615f 6172 7261 795b  elf._data_array[
+00019420: 3a2c 365d 290d 0a20 2020 2020 2020 200d  :,6])..        .
+00019430: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00019440: 2e5f 663d 3d31 203a 200d 0a20 2020 2020  ._f==1 : ..     
+00019450: 2020 2023 2020 2020 2052 6573 6973 7469     #     Resisti
+00019460: 7669 7479 2872 6573 5f61 7272 6179 3d73  vity(res_array=s
+00019470: 656c 662e 5f64 6174 615b 3a2c 375d 290d  elf._data[:,7]).
+00019480: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019490: 662e 5265 7369 7374 6976 6974 792e 5f72  f.Resistivity._r
+000194a0: 6561 645f 7265 735f 6461 7461 2872 6573  ead_res_data(res
+000194b0: 5f61 7272 6179 203d 7a73 7461 725f 6172  _array =zstar_ar
+000194c0: 7261 795f 746f 5f6e 616e 2028 0d0a 2020  ray_to_nan (..  
+000194d0: 2020 2020 2020 2020 2020 2020 2020 7a73                zs
+000194e0: 7461 725f 6172 7261 793d 7365 6c66 2e5f  tar_array=self._
+000194f0: 6461 7461 5f61 7272 6179 5b3a 2c37 5d29  data_array[:,7])
+00019500: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00019510: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+00019520: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
+00019530: 3d73 656c 662e 5f6e 756d 6265 725f 6f66  =self._number_of
+00019540: 5f66 7265 7175 656e 6369 6573 2c20 0d0a  _frequencies, ..
+00019550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019560: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+00019570: 665f 7374 6174 696f 6e73 3d73 656c 662e  f_stations=self.
+00019580: 5f6e 756d 6265 725f 6f66 5f73 7461 7469  _number_of_stati
+00019590: 6f6e 7329 0d0a 2020 2020 2020 2020 2320  ons)..        # 
+000195a0: 2020 2020 5068 6173 6520 2870 6861 7365      Phase (phase
+000195b0: 5f61 7272 6179 3d73 656c 662e 5f64 6174  _array=self._dat
+000195c0: 615b 3a38 5d29 0d0a 2020 2020 2020 2020  a[:8])..        
+000195d0: 2020 2020 7365 6c66 2e50 6861 7365 2e5f      self.Phase._
+000195e0: 7265 6164 5f70 6861 7365 5f64 6174 6128  read_phase_data(
+000195f0: 7068 6173 655f 6172 7261 793d 7a73 7461  phase_array=zsta
+00019600: 725f 6172 7261 795f 746f 5f6e 616e 2028  r_array_to_nan (
+00019610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019620: 2020 7a73 7461 725f 6172 7261 793d 7365    zstar_array=se
+00019630: 6c66 2e5f 6461 7461 5f61 7272 6179 5b3a  lf._data_array[:
+00019640: 2c38 5d29 2c0d 0a20 2020 2020 2020 2020  ,8]),..         
+00019650: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+00019660: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00019670: 733d 7365 6c66 2e5f 6e75 6d62 6572 5f6f  s=self._number_o
+00019680: 665f 6672 6571 7565 6e63 6965 732c 200d  f_frequencies, .
+00019690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000196a0: 2020 2020 206e 756d 6265 725f 6f66 5f73       number_of_s
+000196b0: 7461 7469 6f6e 733d 7365 6c66 2e5f 6e75  tations=self._nu
+000196c0: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+000196d0: 2029 0d0a 2020 2020 2020 2020 2320 2020   )..        #   
+000196e0: 2020 7350 687a 2873 5f70 687a 5f64 6174    sPhz(s_phz_dat
+000196f0: 613d 7365 6c66 2e5f 6461 7461 5f61 7272  a=self._data_arr
+00019700: 6179 5b3a 2d31 5d29 0d0a 2020 2020 2020  ay[:-1])..      
+00019710: 2020 2020 2020 7365 6c66 2e73 5068 7a2e        self.sPhz.
+00019720: 5f72 6561 645f 7350 687a 5f64 6174 6128  _read_sPhz_data(
+00019730: 7350 6861 7365 5f61 7272 6179 3d7a 7374  sPhase_array=zst
+00019740: 6172 5f61 7272 6179 5f74 6f5f 6e61 6e20  ar_array_to_nan 
+00019750: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00019760: 2020 207a 7374 6172 5f61 7272 6179 3d73     zstar_array=s
+00019770: 656c 662e 5f64 6174 615f 6172 7261 795b  elf._data_array[
+00019780: 3a2c 2d31 5d29 2c20 0d0a 2020 2020 2020  :,-1]), ..      
+00019790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000197a0: 2020 2020 6e75 6d62 6572 5f6f 665f 6672      number_of_fr
+000197b0: 6571 7565 6e63 6965 733d 7365 6c66 2e5f  equencies=self._
+000197c0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+000197d0: 6e63 6965 732c 200d 0a20 2020 2020 2020  ncies, ..       
+000197e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000197f0: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
+00019800: 7469 6f6e 733d 7365 6c66 2e5f 6e75 6d62  tions=self._numb
+00019810: 6572 5f6f 665f 7374 6174 696f 6e73 290d  er_of_stations).
+00019820: 0a20 2020 2020 2020 2023 2020 2020 2070  .        #     p
+00019830: 6352 686f 2870 635f 7268 6f5f 6461 7461  cRho(pc_rho_data
+00019840: 3d73 656c 662e 5f64 6174 615b 3a2c 2d32  =self._data[:,-2
+00019850: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00019860: 7365 6c66 2e70 6352 686f 2e5f 7265 6164  self.pcRho._read
+00019870: 5f70 6352 6573 5f64 6174 6128 7063 5265  _pcRes_data(pcRe
+00019880: 735f 6172 7261 7920 3d7a 7374 6172 5f61  s_array =zstar_a
+00019890: 7272 6179 5f74 6f5f 6e61 6e20 280d 0a20  rray_to_nan (.. 
+000198a0: 2020 2020 2020 2020 2020 2020 2020 207a                 z
+000198b0: 7374 6172 5f61 7272 6179 3d73 656c 662e  star_array=self.
+000198c0: 5f64 6174 615f 6172 7261 795b 3a2c 2d32  _data_array[:,-2
+000198d0: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
+000198e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198f0: 206e 756d 6265 725f 6f66 5f66 7265 7175   number_of_frequ
+00019900: 656e 6369 6573 3d73 656c 662e 5f6e 756d  encies=self._num
+00019910: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
+00019920: 6573 2c20 0d0a 2020 2020 2020 2020 2020  es, ..          
+00019930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019940: 2020 6e75 6d62 6572 5f6f 665f 7374 6174    number_of_stat
+00019950: 696f 6e73 3d73 656c 662e 5f6e 756d 6265  ions=self._numbe
+00019960: 725f 6f66 5f73 7461 7469 6f6e 7329 0d0a  r_of_stations)..
+00019970: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00019980: 5f66 3d3d 3220 3a20 0d0a 2020 2020 2020  _f==2 : ..      
+00019990: 2020 2320 2020 2020 5265 7369 7374 6976    #     Resistiv
+000199a0: 6974 7928 7265 735f 6172 7261 793d 7365  ity(res_array=se
+000199b0: 6c66 2e5f 6461 7461 5b3a 2c38 5d29 0d0a  lf._data[:,8])..
+000199c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000199d0: 2e52 6573 6973 7469 7669 7479 2e5f 7265  .Resistivity._re
+000199e0: 6164 5f72 6573 5f64 6174 6128 7265 735f  ad_res_data(res_
+000199f0: 6172 7261 7920 3d7a 7374 6172 5f61 7272  array =zstar_arr
+00019a00: 6179 5f74 6f5f 6e61 6e20 280d 0a20 2020  ay_to_nan (..   
+00019a10: 2020 2020 2020 2020 2020 2020 207a 7374               zst
+00019a20: 6172 5f61 7272 6179 3d73 656c 662e 5f64  ar_array=self._d
+00019a30: 6174 615f 6172 7261 795b 3a2c 385d 292c  ata_array[:,8]),
+00019a40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019a50: 2020 2020 206e 756d 6265 725f 6f66 5f66       number_of_f
+00019a60: 7265 7175 656e 6369 6573 3d73 656c 662e  requencies=self.
+00019a70: 5f6e 756d 6265 725f 6f66 5f66 7265 7175  _number_of_frequ
+00019a80: 656e 6369 6573 2c20 0d0a 2020 2020 2020  encies, ..      
+00019a90: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019aa0: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+00019ab0: 733d 7365 6c66 2e5f 6e75 6d62 6572 5f6f  s=self._number_o
+00019ac0: 665f 7374 6174 696f 6e73 2c0d 0a20 2020  f_stations,..   
+00019ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ae0: 2020 5372 6573 3d73 656c 662e 6164 6465    Sres=self.adde
+00019af0: 645f 6173 7461 7469 635f 6461 7461 290d  d_astatic_data).
+00019b00: 0a20 2020 2020 2020 2023 2020 2020 2050  .        #     P
+00019b10: 6861 7365 2028 7068 6173 655f 6172 7261  hase (phase_arra
+00019b20: 793d 7365 6c66 2e5f 6461 7461 5b3a 375d  y=self._data[:7]
+00019b30: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00019b40: 656c 662e 5068 6173 652e 5f72 6561 645f  elf.Phase._read_
+00019b50: 7068 6173 655f 6461 7461 2870 6861 7365  phase_data(phase
+00019b60: 5f61 7272 6179 3d7a 7374 6172 5f61 7272  _array=zstar_arr
+00019b70: 6179 5f74 6f5f 6e61 6e20 280d 0a20 2020  ay_to_nan (..   
+00019b80: 2020 2020 2020 2020 2020 2020 207a 7374               zst
+00019b90: 6172 5f61 7272 6179 3d73 656c 662e 5f64  ar_array=self._d
+00019ba0: 6174 615f 6172 7261 795b 3a2c 375d 292c  ata_array[:,7]),
+00019bb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019bc0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+00019bd0: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
+00019be0: 6573 3d73 656c 662e 5f6e 756d 6265 725f  es=self._number_
+00019bf0: 6f66 5f66 7265 7175 656e 6369 6573 2c20  of_frequencies, 
+00019c00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019c10: 2020 2020 2020 2020 2020 2020 206e 756d               num
+00019c20: 6265 725f 6f66 5f73 7461 7469 6f6e 733d  ber_of_stations=
+00019c30: 7365 6c66 2e5f 6e75 6d62 6572 5f6f 665f  self._number_of_
+00019c40: 7374 6174 696f 6e73 2029 0d0a 2020 2020  stations )..    
+00019c50: 2020 2020 2320 2020 2020 7350 687a 2873      #     sPhz(s
+00019c60: 5f70 687a 5f64 6174 613d 7365 6c66 2e5f  _phz_data=self._
+00019c70: 6461 7461 5f61 7272 6179 5b3a 2d32 5d29  data_array[:-2])
+00019c80: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00019c90: 6c66 2e73 5068 7a2e 5f72 6561 645f 7350  lf.sPhz._read_sP
+00019ca0: 687a 5f64 6174 6128 7350 6861 7365 5f61  hz_data(sPhase_a
+00019cb0: 7272 6179 3d7a 7374 6172 5f61 7272 6179  rray=zstar_array
+00019cc0: 5f74 6f5f 6e61 6e20 280d 0a20 2020 2020  _to_nan (..     
+00019cd0: 2020 2020 2020 2020 2020 207a 7374 6172             zstar
+00019ce0: 5f61 7272 6179 3d73 656c 662e 5f64 6174  _array=self._dat
+00019cf0: 615f 6172 7261 795b 3a2c 2d32 5d29 2c0d  a_array[:,-2]),.
+00019d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019d10: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+00019d20: 5f6f 665f 6672 6571 7565 6e63 6965 733d  _of_frequencies=
+00019d30: 7365 6c66 2e5f 6e75 6d62 6572 5f6f 665f  self._number_of_
+00019d40: 6672 6571 7565 6e63 6965 732c 200d 0a20  frequencies, .. 
+00019d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d60: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+00019d70: 6f66 5f73 7461 7469 6f6e 733d 7365 6c66  of_stations=self
+00019d80: 2e5f 6e75 6d62 6572 5f6f 665f 7374 6174  ._number_of_stat
+00019d90: 696f 6e73 290d 0a20 2020 2020 2020 2023  ions)..        #
+00019da0: 2020 2020 2070 6352 686f 2870 635f 7268       pcRho(pc_rh
+00019db0: 6f5f 6461 7461 3d73 656c 662e 5f64 6174  o_data=self._dat
+00019dc0: 615b 3a2c 2d31 5d29 0d0a 2020 2020 2020  a[:,-1])..      
+00019dd0: 2020 2020 2020 7365 6c66 2e70 6352 686f        self.pcRho
+00019de0: 2e5f 7265 6164 5f70 6352 6573 5f64 6174  ._read_pcRes_dat
+00019df0: 6128 7063 5265 735f 6172 7261 7920 3d7a  a(pcRes_array =z
+00019e00: 7374 6172 5f61 7272 6179 5f74 6f5f 6e61  star_array_to_na
+00019e10: 6e20 280d 0a20 2020 2020 2020 2020 2020  n (..           
+00019e20: 2020 2020 207a 7374 6172 5f61 7272 6179       zstar_array
+00019e30: 3d73 656c 662e 5f64 6174 615f 6172 7261  =self._data_arra
+00019e40: 795b 3a2c 2d31 5d29 2c20 0d0a 2020 2020  y[:,-1]), ..    
+00019e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019e60: 2020 206e 756d 6265 725f 6f66 5f66 7265     number_of_fre
+00019e70: 7175 656e 6369 6573 3d73 656c 662e 5f6e  quencies=self._n
+00019e80: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
+00019e90: 6369 6573 2c20 0d0a 2020 2020 2020 2020  cies, ..        
+00019ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019eb0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+00019ec0: 6e73 3d73 656c 662e 5f6e 756d 6265 725f  ns=self._number_
+00019ed0: 6f66 5f73 7461 7469 6f6e 7329 0d0a 2020  of_stations)..  
+00019ee0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00019ef0: 2020 2020 2320 7063 456d 6167 2870 635f      # pcEmag(pc_
+00019f00: 656d 6167 5f64 6174 613d 7365 6c66 2e5f  emag_data=self._
+00019f10: 6461 7461 5b3a 2c2d 365d 290d 0a20 2020  data[:,-6])..   
+00019f20: 2020 2020 2073 656c 662e 7063 456d 6167       self.pcEmag
+00019f30: 2e5f 7265 6164 5f70 6345 6d61 675f 6461  ._read_pcEmag_da
+00019f40: 7461 2870 635f 655f 6d61 675f 6172 7261  ta(pc_e_mag_arra
+00019f50: 793d 7a73 7461 725f 6172 7261 795f 746f  y=zstar_array_to
+00019f60: 5f6e 616e 2028 0d0a 2020 2020 2020 2020  _nan (..        
+00019f70: 2020 2020 7a73 7461 725f 6172 7261 793d      zstar_array=
+00019f80: 7365 6c66 2e5f 6461 7461 5f61 7272 6179  self._data_array
+00019f90: 5b3a 2c2d 365d 292c 200d 0a20 2020 2020  [:,-6]), ..     
+00019fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019fb0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+00019fc0: 6e63 6965 733d 7365 6c66 2e5f 6e75 6d62  ncies=self._numb
+00019fd0: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00019fe0: 732c 200d 0a20 2020 2020 2020 2020 2020  s, ..           
+00019ff0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+0001a000: 725f 6f66 5f73 7461 7469 6f6e 733d 7365  r_of_stations=se
+0001a010: 6c66 2e5f 6e75 6d62 6572 5f6f 665f 7374  lf._number_of_st
+0001a020: 6174 696f 6e73 290d 0a20 2020 2020 2020  ations)..       
+0001a030: 2023 2073 4570 687a 2873 5f70 687a 5f64   # sEphz(s_phz_d
+0001a040: 6174 613d 7365 6c66 2e5f 6461 7461 5b3a  ata=self._data[:
+0001a050: 2c2d 355d 290d 0a20 2020 2020 2020 2073  ,-5])..        s
+0001a060: 656c 662e 7345 7068 7a2e 5f72 6561 645f  elf.sEphz._read_
+0001a070: 7345 7068 7a5f 6461 7461 2028 7345 7068  sEphz_data (sEph
+0001a080: 7a5f 6172 7261 793d 7a73 7461 725f 6172  z_array=zstar_ar
+0001a090: 7261 795f 746f 5f6e 616e 2028 0d0a 2020  ray_to_nan (..  
+0001a0a0: 2020 2020 2020 2020 2020 7a73 7461 725f            zstar_
+0001a0b0: 6172 7261 793d 7365 6c66 2e5f 6461 7461  array=self._data
+0001a0c0: 5f61 7272 6179 5b3a 2c2d 355d 292c 0d0a  _array[:,-5]),..
+0001a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a0e0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
+0001a0f0: 6672 6571 7565 6e63 6965 733d 7365 6c66  frequencies=self
+0001a100: 2e5f 6e75 6d62 6572 5f6f 665f 6672 6571  ._number_of_freq
+0001a110: 7565 6e63 6965 732c 200d 0a20 2020 2020  uencies, ..     
+0001a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a130: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
+0001a140: 6f6e 733d 7365 6c66 2e5f 6e75 6d62 6572  ons=self._number
+0001a150: 5f6f 665f 7374 6174 696f 6e73 2029 0d0a  _of_stations )..
+0001a160: 2020 2020 2020 2020 2320 7063 486d 6167          # pcHmag
+0001a170: 2870 635f 686d 6167 5f64 6174 6120 3d73  (pc_hmag_data =s
+0001a180: 656c 662e 5f64 6174 615b 3a2c 202d 345d  elf._data[:, -4]
+0001a190: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0001a1a0: 7063 486d 6167 2e5f 7265 6164 5f70 6348  pcHmag._read_pcH
+0001a1b0: 6d61 675f 6461 7461 2870 635f 685f 6d61  mag_data(pc_h_ma
+0001a1c0: 675f 6172 7261 793d 7a73 7461 725f 6172  g_array=zstar_ar
+0001a1d0: 7261 795f 746f 5f6e 616e 2028 0d0a 2020  ray_to_nan (..  
+0001a1e0: 2020 2020 2020 2020 2020 7a73 7461 725f            zstar_
+0001a1f0: 6172 7261 793d 7365 6c66 2e5f 6461 7461  array=self._data
+0001a200: 5f61 7272 6179 5b3a 2c2d 345d 292c 0d0a  _array[:,-4]),..
+0001a210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a220: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
+0001a230: 6672 6571 7565 6e63 6965 733d 7365 6c66  frequencies=self
+0001a240: 2e5f 6e75 6d62 6572 5f6f 665f 6672 6571  ._number_of_freq
+0001a250: 7565 6e63 6965 732c 200d 0a20 2020 2020  uencies, ..     
+0001a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a270: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
+0001a280: 6f6e 733d 7365 6c66 2e5f 6e75 6d62 6572  ons=self._number
+0001a290: 5f6f 665f 7374 6174 696f 6e73 290d 0a20  _of_stations).. 
+0001a2a0: 2020 2020 2020 2023 2073 4870 687a 2873         # sHphz(s
+0001a2b0: 5f68 7068 7a5f 6461 7461 3d73 656c 662e  _hphz_data=self.
+0001a2c0: 5f64 6174 615b 3a2c 2d33 5d29 0d0a 2020  _data[:,-3])..  
+0001a2d0: 2020 2020 2020 7365 6c66 2e73 4870 687a        self.sHphz
+0001a2e0: 2e5f 7265 6164 5f73 4870 687a 5f64 6174  ._read_sHphz_dat
+0001a2f0: 6120 2873 4870 687a 5f61 7272 6179 3d7a  a (sHphz_array=z
+0001a300: 7374 6172 5f61 7272 6179 5f74 6f5f 6e61  star_array_to_na
+0001a310: 6e20 280d 0a20 2020 2020 2020 2020 2020  n (..           
+0001a320: 207a 7374 6172 5f61 7272 6179 3d73 656c   zstar_array=sel
+0001a330: 662e 5f64 6174 615f 6172 7261 795b 3a2c  f._data_array[:,
+0001a340: 2d33 5d29 2c0d 0a20 2020 2020 2020 2020  -3]),..         
+0001a350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a360: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+0001a370: 6e63 6965 733d 7365 6c66 2e5f 6e75 6d62  ncies=self._numb
+0001a380: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+0001a390: 732c 200d 0a20 2020 2020 2020 2020 2020  s, ..           
+0001a3a0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+0001a3b0: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0001a3c0: 3d73 656c 662e 5f6e 756d 6265 725f 6f66  =self._number_of
+0001a3d0: 5f73 7461 7469 6f6e 7320 2920 2020 0d0a  _stations )   ..
+0001a3e0: 2020 2020 0d0a 2020 2020 2020 200d 0a0d      ..       ...
+0001a3f0: 0a63 6c61 7373 2020 5374 6174 696f 6e28  .class  Station(
+0001a400: 6f62 6a65 6374 293a 0d0a 2020 2020 2222  object):..    ""
+0001a410: 220d 0a20 2020 2053 7461 7469 6f6e 7320  "..    Stations 
+0001a420: 696e 666f 726d 6174 696f 6e73 200d 0a20  informations .. 
+0001a430: 2020 200d 0a20 2020 2041 7267 756d 656e     ..    Argumen
+0001a440: 7473 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  ts..    --------
+0001a450: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a6e  ---..        **n
+0001a460: 6f72 6d5f 7374 6174 696f 6e5f 7661 6c75  orm_station_valu
+0001a470: 652a 2a3a 2062 6f6f 6c20 0d0a 2020 2020  e**: bool ..    
+0001a480: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+0001a490: 7565 2c20 7374 6174 696f 6e20 7769 6c6c  ue, station will
+0001a4a0: 206e 756d 6265 7265 6420 7374 6172 7469   numbered starti
+0001a4b0: 6e67 2062 7920 302e 2a44 6566 6175 6c74  ng by 0.*Default
+0001a4c0: 2a20 6973 2054 7275 650d 0a0d 0a20 2020  * is True....   
+0001a4d0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+0001a4e0: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  =  ===========  
+0001a4f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001a500: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001a510: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+0001a520: 2020 4174 7472 6962 7574 6573 2020 2020    Attributes    
+0001a530: 2020 2020 5479 7065 2020 2020 2020 2020      Type        
+0001a540: 2020 4578 706c 616e 6174 696f 6e0d 0a20    Explanation.. 
+0001a550: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
+0001a560: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
+0001a570: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+0001a580: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001a590: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+0001a5a0: 2020 2020 7661 6c75 6520 2020 2020 2020      value       
+0001a5b0: 2020 2020 2020 6e64 2e61 7272 6179 2020        nd.array  
+0001a5c0: 2020 2020 6461 7461 206f 6620 7374 6174      data of stat
+0001a5d0: 696f 6e20 2063 6f6c 756d 6e73 2063 6f6d  ion  columns com
+0001a5e0: 706f 6e65 6e74 7320 0d0a 2020 2020 6d61  ponents ..    ma
+0001a5f0: 7820 2020 2020 2020 2020 2020 2020 2020  x               
+0001a600: 666c 6f61 7420 2020 2020 2020 2020 6d61  float         ma
+0001a610: 7869 6d75 6d20 6469 7374 616e 6365 206f  ximum distance o
+0001a620: 6620 7375 7276 6579 206c 696e 6573 200d  f survey lines .
+0001a630: 0a20 2020 206d 696e 2020 2020 2020 2020  .    min        
+0001a640: 2020 2020 2020 2066 6c6f 6174 2020 2020         float    
+0001a650: 2020 2020 206d 696e 696d 756d 2064 6973       minimum dis
+0001a660: 7461 6e63 6520 7374 7261 7465 6420 7265  tance strated re
+0001a670: 636f 7264 6564 2064 6174 6120 200d 0a20  corded data  .. 
+0001a680: 2020 206e 616d 6573 2020 2020 2020 2020     names        
+0001a690: 2020 2020 2020 7374 7220 2020 2020 2020        str       
+0001a6a0: 2020 206e 616d 6573 206f 6620 7374 6174     names of stat
+0001a6b0: 696f 6e73 206e 616d 6520 6669 6c6c 6564  ions name filled
+0001a6c0: 2061 7574 6f6d 6174 6963 616c 790d 0a20   automaticaly.. 
+0001a6d0: 2020 2065 6e64 2020 2020 2020 2020 2020     end          
+0001a6e0: 2020 2020 2073 7472 2020 2020 2020 2020       str        
+0001a6f0: 2020 206c 6173 7420 7374 6174 696f 6e20     last station 
+0001a700: 6e61 6d65 200d 0a20 2020 206c 656e 6768  name ..    lengh
+0001a710: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
+0001a720: 6174 2020 2020 2020 2020 206c 656e 6768  at         lengh
+0001a730: 7420 6f66 2074 6865 2073 7572 7665 7920  t of the survey 
+0001a740: 0d0a 2020 2020 756e 6974 2020 2020 2020  ..    unit      
+0001a750: 2020 2020 2020 2020 7374 7220 2020 2020          str     
+0001a760: 2020 2020 2020 6c69 6e65 7320 6c65 6e67        lines leng
+0001a770: 6874 2075 6e69 7473 2020 6d61 7920 6265  ht units  may be
+0001a780: 206f 6e20 5b6d 2c20 6b6d 202c 2066 745d   on [m, km , ft]
+0001a790: 0d0a 2020 2020 616c 6c64 6174 6120 2020  ..    alldata   
+0001a7a0: 2020 2020 2020 2020 6e64 2e61 7272 6179          nd.array
+0001a7b0: 2020 2020 2020 6e64 6172 7261 7920 6f66        ndarray of
+0001a7c0: 2061 6c6c 2064 6174 6120 7661 6c75 6520   all data value 
+0001a7d0: 6672 6f6d 2072 6177 2066 696c 650d 0a20  from raw file.. 
+0001a7e0: 2020 206c 6f63 2020 2020 2020 2020 2020     loc          
+0001a7f0: 2020 2020 2064 6963 7420 2020 2020 2020       dict       
+0001a800: 2020 206d 6169 6e20 6174 7472 6962 7574     main attribut
+0001a810: 6520 6c6f 6361 7469 6f6e 206f 6620 7374  e location of st
+0001a820: 6174 696f 6e3a 2065 670d 0a20 2020 2020  ation: eg..     
+0001a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a840: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0001a850: 6f63 205b 2753 3031 275d 2073 686f 7720  oc ['S01'] show 
+0001a860: 7468 6520 6469 7374 616e 6365 206f 6620  the distance of 
+0001a870: 7374 6174 696f 6e20 6174 0d0a 2020 2020  station at..    
+0001a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a8a0: 7468 6174 2070 6f69 6e74 2e20 0d0a 2020  that point. ..  
+0001a8b0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+0001a8c0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  ==  =========== 
+0001a8d0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+0001a8e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001a8f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d  =============...
+0001a900: 0a20 2020 204d 6f72 6520 6174 7472 6962  .    More attrib
+0001a910: 7574 6573 2063 616e 2062 6520 6164 6465  utes can be adde
+0001a920: 6420 6279 2069 6e70 7574 696e 6720 6120  d by inputing a 
+0001a930: 6b65 7920 776f 7264 2064 6963 7469 6f6e  key word diction
+0001a940: 6172 790d 0a0d 0a20 2020 203a 4578 616d  ary....    :Exam
+0001a950: 706c 653a 200d 0a20 2020 2020 2020 200d  ple: ..        .
+0001a960: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0001a970: 6d20 7079 6373 616d 742e 636f 7265 2e61  m pycsamt.core.a
+0001a980: 7667 2069 6d70 6f72 7420 5374 6174 696f  vg import Statio
+0001a990: 6e0d 0a20 2020 2020 2020 203e 3e3e 2070  n..        >>> p
+0001a9a0: 6174 683d 6f73 2e70 6174 682e 6a6f 696e  ath=os.path.join
+0001a9b0: 286f 732e 656e 7669 726f 6e5b 2270 7943  (os.environ["pyC
+0001a9c0: 5341 4d54 225d 2c20 0d0a 2020 2020 2020  SAMT"], ..      
+0001a9d0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+0001a9e0: 2020 2020 2020 2020 2020 2027 7079 6373             'pycs
+0001a9f0: 616d 7427 2c20 2264 6174 6122 2c20 224b  amt', "data", "K
+0001aa00: 312e 4156 4722 290d 0a20 2020 2020 2020  1.AVG")..       
+0001aa10: 203e 3e3e 2073 7461 7469 6f6e 3d53 7461   >>> station=Sta
+0001aa20: 7469 6f6e 2870 6174 6829 0d0a 2020 2020  tion(path)..    
+0001aa30: 2020 2020 3e3e 3e20 7072 696e 7428 7374      >>> print(st
+0001aa40: 6174 696f 6e2e 6c6f 635b 2753 3037 275d  ation.loc['S07']
+0001aa50: 290d 0a20 2020 2022 2222 0d0a 2020 2020  )..    """..    
+0001aa60: 0d0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+0001aa70: 5f5f 2873 656c 662c 2073 7461 7469 6f6e  __(self, station
+0001aa80: 5f64 6174 615f 6172 7261 7920 3d4e 6f6e  _data_array =Non
+0001aa90: 652c 2020 2a2a 6b77 6172 6773 293a 0d0a  e,  **kwargs):..
+0001aaa0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+0001aab0: 6c6f 6767 696e 673d 6373 616d 7470 796c  logging=csamtpyl
+0001aac0: 6f67 2e67 6574 5f63 7361 6d74 7079 5f6c  og.get_csamtpy_l
+0001aad0: 6f67 6765 7228 7365 6c66 2e5f 5f63 6c61  ogger(self.__cla
+0001aae0: 7373 5f5f 2e5f 5f6e 616d 655f 5f29 0d0a  ss__.__name__)..
+0001aaf0: 2020 2020 2020 2020 0d0a 0d0a 2020 2020          ....    
+0001ab00: 2020 2020 7365 6c66 2e73 7461 7469 6f6e      self.station
+0001ab10: 5f64 6174 615f 6172 7261 7920 3d73 7461  _data_array =sta
+0001ab20: 7469 6f6e 5f64 6174 615f 6172 7261 790d  tion_data_array.
+0001ab30: 0a20 2020 2020 2020 200d 0a0d 0a20 2020  .        ....   
+0001ab40: 2020 2020 2073 656c 662e 6e6f 726d 616c       self.normal
+0001ab50: 697a 6564 5f73 7461 7469 6f6e 5f76 616c  ized_station_val
+0001ab60: 7565 203d 206b 7761 7267 732e 706f 7028  ue = kwargs.pop(
+0001ab70: 276e 6f72 6d61 6c69 7a65 645f 7374 6174  'normalized_stat
+0001ab80: 696f 6e5f 7661 6c75 6527 2c20 4661 6c73  ion_value', Fals
+0001ab90: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
+0001aba0: 2e72 656e 616d 655f 7374 6174 696f 6e20  .rename_station 
+0001abb0: 3d6b 7761 7267 732e 706f 7028 2772 656e  =kwargs.pop('ren
+0001abc0: 616d 655f 7361 7469 6f6e 272c 204e 6f6e  ame_sation', Non
+0001abd0: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
+0001abe0: 2e75 6e69 743d 6b77 6172 6773 2e70 6f70  .unit=kwargs.pop
+0001abf0: 2827 756e 6974 5f6f 665f 6469 7374 616e  ('unit_of_distan
+0001ac00: 6365 5f6d 6561 7375 7265 6427 2c20 276d  ce_measured', 'm
+0001ac10: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
+0001ac20: 2020 2020 2020 7365 6c66 2e6e 616d 6573        self.names
+0001ac30: 203d 4e6f 6e65 200d 0a20 2020 2020 2020   =None ..       
+0001ac40: 2073 656c 662e 7661 6c75 6520 3d4e 6f6e   self.value =Non
+0001ac50: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
+0001ac60: 2e6d 6178 3d4e 6f6e 6520 0d0a 2020 2020  .max=None ..    
+0001ac70: 2020 2020 7365 6c66 2e6d 696e 203d 4e6f      self.min =No
+0001ac80: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
+0001ac90: 662e 6c61 7374 5f73 7461 7469 6f6e 5f6e  f.last_station_n
+0001aca0: 616d 6520 3d4e 6f6e 6520 0d0a 2020 2020  ame =None ..    
+0001acb0: 2020 2020 7365 6c66 2e6c 656e 6774 6820      self.length 
+0001acc0: 3d4e 6f6e 6520 0d0a 2020 2020 2020 2020  =None ..        
+0001acd0: 7365 6c66 2e76 616c 7565 203d 4e6f 6e65  self.value =None
+0001ace0: 200d 0a20 2020 2020 2020 200d 0a0d 0a20   ..        .... 
+0001acf0: 2020 2064 6566 205f 7365 745f 7374 6174     def _set_stat
+0001ad00: 696f 6e5f 2873 656c 662c 7374 6174 696f  ion_(self,statio
+0001ad10: 6e5f 6461 7461 5f61 7272 6179 203d 4e6f  n_data_array =No
+0001ad20: 6e65 2c20 7265 6e61 6d65 5f73 7461 7469  ne, rename_stati
+0001ad30: 6f6e 203d 4e6f 6e65 202c 200d 0a20 2020  on =None , ..   
+0001ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad50: 2020 206e 6f72 6d61 6c69 7a65 645f 7374     normalized_st
+0001ad60: 6174 696f 6e5f 7661 6c75 653d 4661 6c73  ation_value=Fals
+0001ad70: 6520 2920 203a 200d 0a20 2020 2020 2020  e )  : ..       
+0001ad80: 2022 2222 0d0a 2020 2020 2020 2020 4d65   """..        Me
+0001ad90: 7468 6f64 2074 6f20 7365 7420 7374 6174  thod to set stat
+0001ada0: 696f 6e20 6f6e 2064 6963 7469 6f6e 6e61  ion on dictionna
+0001adb0: 7279 206f 6620 6561 6368 2064 6973 7461  ry of each dista
+0001adc0: 6e63 652e 2049 6e20 6661 6374 0d0a 2020  nce. In fact..  
+0001add0: 2020 2020 2020 2074 6f20 6561 7369 6c79         to easily
+0001ade0: 2065 7870 6f72 7420 666f 7220 706c 6f74   export for plot
+0001adf0: 7469 6e67 2065 6163 6820 7374 6174 696f  ting each statio
+0001ae00: 6e20 2e20 0d0a 0d0a 2020 2020 2020 2020  n . ....        
+0001ae10: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0001ae20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+0001ae30: 2020 2020 2020 2020 2020 2020 2a20 7374              * st
+0001ae40: 6174 696f 6e5f 6461 7461 5f61 7272 6179  ation_data_array
+0001ae50: 203a 206e 702e 6e64 6172 7261 7920 286e   : np.ndarray (n
+0001ae60: 6461 7272 6179 2c31 292c 206f 7074 696f  darray,1), optio
+0001ae70: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+0001ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae90: 2020 2020 2073 7461 7469 6f6e 2076 616c       station val
+0001aea0: 7565 2072 6563 6f72 6465 6420 696e 2074  ue recorded in t
+0001aeb0: 6865 2066 6965 6c64 2061 7420 6561 6368  he field at each
+0001aec0: 2070 6f69 6e74 2e0d 0a20 2020 2020 2020   point...       
+0001aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aee0: 2020 2020 2020 2020 2054 6865 202a 6465           The *de
+0001aef0: 6661 756c 742a 2069 7320 4e6f 6e65 2e0d  fault* is None..
+0001af00: 0a20 2020 2020 2020 2020 2020 202a 2072  .            * r
+0001af10: 656e 616d 655f 7374 6174 696f 6e20 3a20  ename_station : 
+0001af20: 6e70 2e6e 6461 7272 6179 286e 6461 7272  np.ndarray(ndarr
+0001af30: 6179 2c31 292c 206f 7074 696f 6e61 6c0d  ay,1), optional.
+0001af40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af60: 206c 6973 7420 6f66 2073 7461 7469 6f6e   list of station
+0001af70: 206e 616d 6520 7072 6f76 6964 6564 2e20   name provided. 
+0001af80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001af90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001afa0: 2020 2a44 6566 6175 6c74 2a20 6973 204e    *Default* is N
+0001afb0: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
+0001afc0: 2020 2a20 6e6f 726d 616c 697a 6564 5f73    * normalized_s
+0001afd0: 7461 7469 6f6e 5f76 616c 7565 203a 2062  tation_value : b
+0001afe0: 6f6f 6c2c 206f 7074 696f 6e61 6c0d 0a20  ool, optional.. 
+0001aff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b000: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001b010: 7461 7274 2074 6865 2076 616c 7565 206f  tart the value o
+0001b020: 6620 7374 6174 696f 6e20 6279 2030 2e0d  f station by 0..
+0001b030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b050: 202a 4465 6661 756c 742a 2069 7320 4661   *Default* is Fa
+0001b060: 6c73 652e 0d0a 2020 2020 2020 2020 2222  lse...        ""
+0001b070: 220d 0a20 2020 2020 2020 200d 0a20 2020  "..        ..   
+0001b080: 2020 2020 2069 6620 7374 6174 696f 6e5f       if station_
+0001b090: 6461 7461 5f61 7272 6179 2020 6973 206e  data_array  is n
+0001b0a0: 6f74 204e 6f6e 6520 3a20 0d0a 2020 2020  ot None : ..    
+0001b0b0: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
+0001b0c0: 7469 6f6e 5f64 6174 615f 6172 7261 793d  tion_data_array=
+0001b0d0: 6e70 2e61 7272 6179 280d 0a20 2020 2020  np.array(..     
+0001b0e0: 2020 2020 2020 2020 2020 205b 6e70 2e66             [np.f
+0001b0f0: 6c6f 6174 286b 6b29 2066 6f72 206b 6b20  loat(kk) for kk 
+0001b100: 696e 2073 7461 7469 6f6e 5f64 6174 615f  in station_data_
+0001b110: 6172 7261 7920 5d29 0d0a 2020 0d0a 2020  array ])..  ..  
+0001b120: 2020 2020 2020 6966 2073 656c 662e 7374        if self.st
+0001b130: 6174 696f 6e5f 6461 7461 5f61 7272 6179  ation_data_array
+0001b140: 2069 7320 4e6f 6e65 203a 200d 0a20 2020   is None : ..   
+0001b150: 2020 2020 2020 2020 2072 6169 7365 2053           raise S
+0001b160: 7461 7469 6f6e 4572 726f 7228 274e 6f20  tationError('No 
+0001b170: 7374 6174 696f 6e73 2064 6174 6120 746f  stations data to
+0001b180: 2072 6561 6420 2e27 290d 0a20 2020 200d   read .')..    .
+0001b190: 0a0d 0a20 2020 2020 2020 206e 756d 5f73  ...        num_s
+0001b1a0: 7461 7469 6f6e 5f63 6f75 6e74 7320 2c20  tation_counts , 
+0001b1b0: 7265 7073 7461 203d 206e 702e 756e 6971  repsta = np.uniq
+0001b1c0: 7565 2028 7365 6c66 2e73 7461 7469 6f6e  ue (self.station
+0001b1d0: 5f64 6174 615f 6172 7261 792c 0d0a 2020  _data_array,..  
+0001b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b200: 2020 2020 2020 2020 2020 2020 6c69 7374              list
-0001b210: 206f 6620 7374 6174 696f 6e20 6e61 6d65   of station name
-0001b220: 2070 726f 7669 6465 642e 200d 0a20 2020   provided. ..   
-0001b230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b240: 2020 2020 2020 2020 2020 2020 202a 4465               *De
-0001b250: 6661 756c 742a 2069 7320 4e6f 6e65 2e0d  fault* is None..
-0001b260: 0a20 2020 2020 2020 2020 2020 202a 206e  .            * n
-0001b270: 6f72 6d61 6c69 7a65 645f 7374 6174 696f  ormalized_statio
-0001b280: 6e5f 7661 6c75 6520 3a20 626f 6f6c 2c20  n_value : bool, 
-0001b290: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0001b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2b0: 2020 2020 2020 2020 2020 7374 6172 7420            start 
-0001b2c0: 7468 6520 7661 6c75 6520 6f66 2073 7461  the value of sta
-0001b2d0: 7469 6f6e 2062 7920 302e 0d0a 2020 2020  tion by 0...    
-0001b2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2f0: 2020 2020 2020 2020 2020 2020 2a44 6566              *Def
-0001b300: 6175 6c74 2a20 6973 2046 616c 7365 2e0d  ault* is False..
-0001b310: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0001b320: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001b330: 6966 2073 7461 7469 6f6e 5f64 6174 615f  if station_data_
-0001b340: 6172 7261 7920 2069 7320 6e6f 7420 4e6f  array  is not No
-0001b350: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
-0001b360: 2020 2073 656c 662e 7374 6174 696f 6e5f     self.station_
-0001b370: 6461 7461 5f61 7272 6179 3d6e 702e 6172  data_array=np.ar
-0001b380: 7261 7928 0d0a 2020 2020 2020 2020 2020  ray(..          
-0001b390: 2020 2020 2020 5b6e 702e 666c 6f61 7428        [np.float(
-0001b3a0: 6b6b 2920 666f 7220 6b6b 2069 6e20 7374  kk) for kk in st
-0001b3b0: 6174 696f 6e5f 6461 7461 5f61 7272 6179  ation_data_array
-0001b3c0: 205d 290d 0a20 200d 0a20 2020 2020 2020   ])..  ..       
-0001b3d0: 2069 6620 7365 6c66 2e73 7461 7469 6f6e   if self.station
-0001b3e0: 5f64 6174 615f 6172 7261 7920 6973 204e  _data_array is N
-0001b3f0: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
-0001b400: 2020 2020 7261 6973 6520 4353 6578 2e70      raise CSex.p
-0001b410: 7943 5341 4d54 4572 726f 725f 7374 6174  yCSAMTError_stat
-0001b420: 696f 6e28 274e 6f20 7374 6174 696f 6e73  ion('No stations
-0001b430: 2064 6174 6120 746f 2072 6561 6420 2e27   data to read .'
-0001b440: 290d 0a20 2020 200d 0a0d 0a20 2020 2020  )..    ....     
-0001b450: 2020 206e 756d 5f73 7461 7469 6f6e 5f63     num_station_c
-0001b460: 6f75 6e74 7320 2c20 7265 7073 7461 203d  ounts , repsta =
-0001b470: 206e 702e 756e 6971 7565 2028 7365 6c66   np.unique (self
-0001b480: 2e73 7461 7469 6f6e 5f64 6174 615f 6172  .station_data_ar
-0001b490: 7261 792c 0d0a 2020 2020 2020 2020 2020  ray,..          
-0001b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4c0: 2020 2020 2020 2072 6574 7572 6e5f 636f         return_co
-0001b4d0: 756e 7473 3d54 7275 6529 0d0a 200d 0a20  unts=True).. .. 
-0001b4e0: 2020 2020 2020 2023 2d2d 2d3e 2063 6865         #---> che
-0001b4f0: 636b 2069 6620 7374 6174 696f 6e73 5f64  ck if stations_d
-0001b500: 6174 6120 7072 6f76 6964 6564 2061 7265  ata provided are
-0001b510: 2065 6163 6820 7468 6520 7361 6d65 206c   each the same l
-0001b520: 656e 6774 682e 200d 0a20 2020 2020 2020  ength. ..       
-0001b530: 2069 6620 6e70 2e61 6c6c 2872 6570 7374   if np.all(repst
-0001b540: 612c 2061 7869 733d 3029 2021 3d20 5472  a, axis=0) != Tr
-0001b550: 7565 203a 200d 0a20 2020 2020 2020 2020  ue : ..         
-0001b560: 2020 2072 6169 7365 2043 5365 782e 7079     raise CSex.py
-0001b570: 4353 414d 5445 7272 6f72 5f73 7461 7469  CSAMTError_stati
-0001b580: 6f6e 280d 0a20 2020 2020 2020 2020 2020  on(..           
-0001b590: 2020 2020 2027 5374 6174 696f 6e73 2070       'Stations p
-0001b5a0: 726f 7669 6465 6420 6d75 7374 2062 6520  rovided must be 
-0001b5b0: 7468 6520 7361 6d65 206c 656e 6774 6820  the same length 
-0001b5c0: 6f66 2072 6563 6375 7265 6e63 792e 2729  of reccurency.')
-0001b5d0: 0d0a 2020 2020 2020 2020 6966 2072 6570  ..        if rep
-0001b5e0: 7374 615b 305d 203d 3d31 203a 200d 0a20  sta[0] ==1 : .. 
-0001b5f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001b600: 7661 6c75 6520 3d20 7365 6c66 2e73 7461  value = self.sta
-0001b610: 7469 6f6e 5f64 6174 615f 6172 7261 7920  tion_data_array 
-0001b620: 0d0a 2020 2020 2020 2020 656c 6966 2020  ..        elif  
-0001b630: 7265 7073 7461 5b30 5d20 213d 3120 203a  repsta[0] !=1  :
-0001b640: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-0001b650: 656c 662e 7661 6c75 6520 3d6e 756d 5f73  elf.value =num_s
-0001b660: 7461 7469 6f6e 5f63 6f75 6e74 730d 0a20  tation_counts.. 
-0001b670: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0001b680: 2020 2020 2073 656c 662e 7661 6c75 6520       self.value 
-0001b690: 3d6e 702e 6172 7261 7928 5b6e 702e 666c  =np.array([np.fl
-0001b6a0: 6f61 7428 7373 2920 666f 7220 7373 2069  oat(ss) for ss i
-0001b6b0: 6e20 7365 6c66 2e76 616c 7565 5d29 0d0a  n self.value])..
-0001b6c0: 2020 2020 2020 2020 232d 2d2d 2063 6f6e          #--- con
-0001b6d0: 7665 7274 2073 7461 7469 6f6e 2020 756e  vert station  un
-0001b6e0: 6974 202d 2d20 4465 6661 756c 7420 6973  it -- Default is
-0001b6f0: 2027 6d27 2d2d 2d0d 0a20 2020 2020 2020   'm'---..       
-0001b700: 2069 6620 7365 6c66 2e75 6e69 7420 3d3d   if self.unit ==
-0001b710: 276b 6d27 3a20 0d0a 2020 2020 2020 2020  'km': ..        
-0001b720: 2020 2020 7365 6c66 2e76 616c 7565 2c20      self.value, 
-0001b730: 7365 6c66 2e73 7461 7469 6f6e 5f64 6174  self.station_dat
-0001b740: 615f 6172 7261 7920 3d5c 0d0a 2020 2020  a_array =\..    
-0001b750: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001b760: 2e76 616c 7565 202f 3165 332c 2073 656c  .value /1e3, sel
-0001b770: 662e 7374 6174 696f 6e5f 6461 7461 5f61  f.station_data_a
-0001b780: 7272 6179 2f31 6533 0d0a 2020 2020 2020  rray/1e3..      
-0001b790: 2020 6966 2073 656c 662e 756e 6974 203d    if self.unit =
-0001b7a0: 3d20 2766 7427 3a20 0d0a 2020 2020 2020  = 'ft': ..      
-0001b7b0: 2020 2020 2020 7365 6c66 2e76 616c 7565        self.value
-0001b7c0: 2c20 7365 6c66 2e73 7461 7469 6f6e 5f64  , self.station_d
-0001b7d0: 6174 615f 6172 7261 793d 205c 0d0a 2020  ata_array= \..  
-0001b7e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001b7f0: 6c66 2e76 616c 7565 202f 332e 3238 3038  lf.value /3.2808
-0001b800: 3339 3839 352c 2073 656c 662e 7374 6174  39895, self.stat
-0001b810: 696f 6e5f 6461 7461 5f61 7272 6179 2f33  ion_data_array/3
-0001b820: 2e32 3830 3833 3938 3935 0d0a 2020 2020  .280839895..    
-0001b830: 2020 2020 6966 2073 656c 662e 756e 6974      if self.unit
-0001b840: 206e 6f74 2069 6e20 5b27 6b6d 272c 2027   not in ['km', '
-0001b850: 6674 272c 2027 6d27 5d3a 0d0a 2020 2020  ft', 'm']:..    
-0001b860: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001b870: 2020 2020 2020 7365 6c66 2e5f 6c6f 6767        self._logg
-0001b880: 696e 672e 7761 726e 280d 0a20 2020 2020  ing.warn(..     
-0001b890: 2020 2020 2020 2020 2020 2027 5374 6174             'Stat
-0001b8a0: 696f 6e20 756e 6974 7320 7072 6f76 6964  ion units provid
-0001b8b0: 6564 2069 7320 696e 636f 7265 6374 2e54  ed is incorect.T
-0001b8c0: 7279 2020 226b 6d22 206f 7220 2266 742e  ry  "km" or "ft.
-0001b8d0: 2220 4465 6661 756c 7420 6973 2022 6d2e  " Default is "m.
-0001b8e0: 2227 290d 0a20 2020 2020 2020 2020 2020  "')..           
-0001b8f0: 2072 6169 7365 2043 5365 782e 7079 4353   raise CSex.pyCS
-0001b900: 414d 5445 7272 6f72 5f73 7461 7469 6f6e  AMTError_station
-0001b910: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0001b920: 2020 2027 556e 6974 2070 726f 7669 6465     'Unit provide
-0001b930: 6420 3c7b 307d 3e20 646f 6573 6e74 206e  d <{0}> doesnt n
-0001b940: 6f74 206d 6174 6368 2063 6f72 7265 6374  ot match correct
-0001b950: 2075 6e69 7473 2e27 0d0a 2020 2020 2020   units.'..      
-0001b960: 2020 2020 2020 2020 2020 2027 6163 6365             'acce
-0001b970: 7074 6162 6c65 2075 6e69 7473 2061 7265  ptable units are
-0001b980: 203a 2022 6d22 2c20 226b 6d22 206f 7220   : "m", "km" or 
-0001b990: 2266 7422 272e 666f 726d 6174 2873 656c  "ft"'.format(sel
-0001b9a0: 662e 756e 6974 2929 0d0a 2020 2020 2020  f.unit))..      
-0001b9b0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0001b9c0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0001b9d0: 2020 2020 2020 7365 6c66 2e6d 696e 2c20        self.min, 
-0001b9e0: 7365 6c66 2e6d 6178 2c20 7365 6c66 2e6e  self.max, self.n
-0001b9f0: 756d 5f6f 665f 7374 6174 696f 6e20 3d20  um_of_station = 
-0001ba00: 5c0d 0a20 2020 2020 2020 2020 2020 2073  \..            s
-0001ba10: 656c 662e 7661 6c75 652e 6d69 6e28 292c  elf.value.min(),
-0001ba20: 2073 656c 662e 7661 6c75 652e 6d61 7828   self.value.max(
-0001ba30: 292c 2073 656c 662e 7661 6c75 652e 7369  ), self.value.si
-0001ba40: 7a65 0d0a 2020 2020 2020 2020 7365 6c66  ze..        self
-0001ba50: 2e6c 656e 6774 683d 6e70 2e61 6273 2873  .length=np.abs(s
-0001ba60: 656c 662e 6d61 782d 7365 6c66 2e6d 696e  elf.max-self.min
-0001ba70: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0001ba80: 2020 2020 2069 6620 6e6f 726d 616c 697a       if normaliz
-0001ba90: 6564 5f73 7461 7469 6f6e 5f76 616c 7565  ed_station_value
-0001baa0: 2069 7320 6e6f 7420 4e6f 6e65 203a 0d0a   is not None :..
-0001bab0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001bac0: 2e6e 6f72 6d61 6c69 7a65 645f 7374 6174  .normalized_stat
-0001bad0: 696f 6e5f 7661 6c75 653d 6e6f 726d 616c  ion_value=normal
-0001bae0: 697a 6564 5f73 7461 7469 6f6e 5f76 616c  ized_station_val
-0001baf0: 7565 200d 0a20 2020 2020 2020 200d 0a20  ue ..        .. 
-0001bb00: 2020 2020 2020 2069 6620 7365 6c66 2e6e         if self.n
-0001bb10: 6f72 6d61 6c69 7a65 645f 7374 6174 696f  ormalized_statio
-0001bb20: 6e5f 7661 6c75 6520 203a 200d 0a20 2020  n_value  : ..   
-0001bb30: 2020 2020 2020 2020 2073 656c 662e 7661           self.va
-0001bb40: 6c75 6520 3d6e 702e 6170 706c 795f 616c  lue =np.apply_al
-0001bb50: 6f6e 675f 6178 6973 280d 0a20 2020 2020  ong_axis(..     
-0001bb60: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
-0001bb70: 6120 7820 3a20 6e70 2e61 6273 2878 292d  a x : np.abs(x)-
-0001bb80: 7365 6c66 2e6d 696e 2c20 3020 2c73 656c  self.min, 0 ,sel
-0001bb90: 662e 7661 6c75 6529 0d0a 2020 2020 2020  f.value)..      
-0001bba0: 2020 2020 2020 7365 6c66 2e73 7461 7469        self.stati
-0001bbb0: 6f6e 5f64 6174 615f 6172 7261 793d 6e70  on_data_array=np
-0001bbc0: 2e61 7070 6c79 5f61 6c6f 6e67 5f61 7869  .apply_along_axi
-0001bbd0: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-0001bbe0: 2020 2020 6c61 6d62 6461 2078 203a 206e      lambda x : n
-0001bbf0: 702e 6162 7328 7829 2d73 656c 662e 6d69  p.abs(x)-self.mi
-0001bc00: 6e2c 2030 2c20 7365 6c66 2e73 7461 7469  n, 0, self.stati
-0001bc10: 6f6e 5f64 6174 615f 6172 7261 7929 0d0a  on_data_array)..
-0001bc20: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0001bc30: 2020 2020 2020 2320 7468 6520 6361 7365        # the case
-0001bc40: 2077 6865 7265 2074 6865 2075 7365 7220   where the user 
-0001bc50: 7072 6f76 6964 6520 6974 7320 6f77 6e20  provide its own 
-0001bc60: 6e61 6d65 0d0a 2020 2020 2020 2020 6966  name..        if
-0001bc70: 2072 656e 616d 655f 7374 6174 696f 6e20   rename_station 
-0001bc80: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
-0001bc90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001bca0: 7265 6e61 6d65 5f73 7461 7469 6f6e 203d  rename_station =
-0001bcb0: 2072 656e 616d 655f 7374 6174 696f 6e20   rename_station 
-0001bcc0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-0001bcd0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001bce0: 7265 6e61 6d65 5f73 7461 7469 6f6e 2069  rename_station i
-0001bcf0: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
-0001bd00: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
-0001bd10: 7065 2028 7365 6c66 2e72 656e 616d 655f  pe (self.rename_
-0001bd20: 7374 6174 696f 6e29 2069 7320 6c69 7374  station) is list
-0001bd30: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-0001bd40: 2020 2020 2073 656c 662e 7265 6e61 6d65       self.rename
-0001bd50: 5f73 7461 7469 6f6e 3d6e 702e 6172 7261  _station=np.arra
-0001bd60: 7928 7365 6c66 2e72 656e 616d 655f 7374  y(self.rename_st
-0001bd70: 6174 696f 6e29 0d0a 2020 2020 2020 2020  ation)..        
-0001bd80: 2020 2020 6966 2073 656c 662e 7661 6c75      if self.valu
-0001bd90: 652e 7369 7a65 2021 3d20 7365 6c66 2e72  e.size != self.r
-0001bda0: 656e 616d 655f 7374 6174 696f 6e2e 7369  ename_station.si
-0001bdb0: 7a65 203a 200d 0a20 2020 2020 2020 2020  ze : ..         
-0001bdc0: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-0001bdd0: 782e 7079 4353 414d 5445 7272 6f72 5f73  x.pyCSAMTError_s
-0001bde0: 7461 7469 6f6e 280d 0a20 2020 2020 2020  tation(..       
-0001bdf0: 2020 2020 2020 2020 2020 2020 2027 5374               'St
-0001be00: 6174 696f 6e73 2072 656e 616d 6520 6172  ations rename ar
-0001be10: 7261 7920 6d75 7374 2068 6176 6520 7468  ray must have th
-0001be20: 6520 7361 6d65 206c 656e 6774 6820 6173  e same length as
-0001be30: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-0001be40: 2020 2020 2020 2027 2074 6865 2061 7261         ' the ara
-0001be50: 795f 6461 7461 2070 726f 7669 6465 642e  y_data provided.
-0001be60: 206c 656e 6768 7420 6f72 2073 7461 7469   lenght or stati
-0001be70: 6f6e 735f 6461 7461 2069 7320 3a3c 7b30  ons_data is :<{0
-0001be80: 7d3e 270d 0a20 2020 2020 2020 2020 2020  }>'..           
-0001be90: 2020 2020 2020 2020 2027 2027 2e66 6f72           ' '.for
-0001bea0: 6d61 7428 7365 6c66 2e76 616c 7565 2e73  mat(self.value.s
-0001beb0: 697a 6529 290d 0a20 2020 2020 2020 2020  ize))..         
-0001bec0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001bed0: 2020 2020 2073 656c 662e 6e61 6d65 7320       self.names 
-0001bee0: 3d73 656c 662e 7265 6e61 6d65 5f73 7461  =self.rename_sta
-0001bef0: 7469 6f6e 0d0a 2020 2020 2020 2020 656c  tion..        el
-0001bf00: 6966 2072 656e 616d 655f 7374 6174 696f  if rename_statio
-0001bf10: 6e20 6973 204e 6f6e 6520 3a20 0d0a 2020  n is None : ..  
-0001bf20: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-0001bf30: 616d 6573 203d 5b27 537b 3a30 327d 272e  ames =['S{:02}'.
-0001bf40: 666f 726d 6174 2869 6929 2066 6f72 2069  format(ii) for i
-0001bf50: 6920 696e 2072 616e 6765 2028 7365 6c66  i in range (self
-0001bf60: 2e76 616c 7565 2e73 697a 6529 5d0d 0a20  .value.size)].. 
-0001bf70: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001bf80: 2023 2d2d 2d3e 2064 7570 6c69 6361 7465   #---> duplicate
-0001bf90: 2073 7461 7469 6f6e 7320 6e61 6d65 7320   stations names 
-0001bfa0: 616e 6420 7075 7420 6f6e 2064 6963 740d  and put on dict.
-0001bfb0: 0a20 2020 2020 2020 2069 6620 7265 7073  .        if reps
-0001bfc0: 7461 5b30 5d20 3d3d 3120 3a20 0d0a 2020  ta[0] ==1 : ..  
-0001bfd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001bfe0: 6c6f 6320 3d7b 6b65 7973 3a76 616c 7565  loc ={keys:value
-0001bff0: 7320 666f 7220 6b65 7973 2c20 7661 6c75  s for keys, valu
-0001c000: 6573 2069 6e20 7a69 7028 7365 6c66 2e6e  es in zip(self.n
-0001c010: 616d 6573 202c 2073 656c 662e 7661 6c75  ames , self.valu
-0001c020: 6529 7d0d 0a20 2020 2020 2020 2069 6620  e)}..        if 
-0001c030: 7265 7073 7461 205b 305d 2021 3d31 203a  repsta [0] !=1 :
-0001c040: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-0001c050: 2073 656c 662e 6e61 6d65 7320 3d73 656c   self.names =sel
-0001c060: 662e 6e61 6d65 7320 2a20 7265 7073 7461  f.names * repsta
-0001c070: 205b 305d 0d0a 2020 2020 2020 2020 2020   [0]..          
-0001c080: 2020 7365 6c66 2e6e 616d 6573 2e73 6f72    self.names.sor
-0001c090: 7428 290d 0a20 2020 2020 2020 2020 2020  t()..           
-0001c0a0: 2023 2070 7269 6e74 2873 656c 662e 7374   # print(self.st
-0001c0b0: 6174 696f 6e5f 6461 7461 5f61 7272 6179  ation_data_array
-0001c0c0: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
-0001c0d0: 2073 656c 662e 7374 6174 696f 6e5f 6461   self.station_da
-0001c0e0: 7461 5f61 7272 6179 3d73 656c 662e 7374  ta_array=self.st
-0001c0f0: 6174 696f 6e5f 6461 7461 5f61 7272 6179  ation_data_array
-0001c100: 2e72 6573 6861 7065 0d0a 2020 2020 2020  .reshape..      
-0001c110: 2020 2020 2020 2328 2873 656c 662e 7374        #((self.st
-0001c120: 6174 696f 6e5f 6461 7461 5f61 7272 6179  ation_data_array
-0001c130: 2e73 6861 7065 5b30 5d2c 3129 290d 0a20  .shape[0],1)).. 
-0001c140: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0001c150: 2020 2020 2020 2020 2023 2070 7269 6e74           # print
-0001c160: 2873 656c 662e 7374 6174 696f 6e5f 6461  (self.station_da
-0001c170: 7461 5f61 7272 6179 290d 0a20 2020 2020  ta_array)..     
-0001c180: 2020 2020 2020 2023 2d2d 2d20 6275 696c         #--- buil
-0001c190: 6420 6120 636f 6d6d 756e 2061 7272 6179  d a commun array
-0001c1a0: 2073 7461 7469 6f6e 2d76 616c 7565 2061   station-value a
-0001c1b0: 6e64 2074 7275 6e63 6174 6564 206f 6e20  nd truncated on 
-0001c1c0: 6469 6374 2e0d 0a20 2020 2020 2020 2020  dict...         
-0001c1d0: 2020 2023 2064 6174 615f 746f 5f74 7275     # data_to_tru
-0001c1e0: 6e63 6174 6520 3d6e 702e 636f 6e63 6174  ncate =np.concat
-0001c1f0: 656e 6174 6528 2874 656d 5f6e 616d 6573  enate((tem_names
-0001c200: 2c20 7365 6c66 2e73 7461 7469 6f6e 5f64  , self.station_d
-0001c210: 6174 615f 6172 7261 7929 2c20 6178 6973  ata_array), axis
-0001c220: 203d 3120 290d 0a20 2020 2020 2020 2020   =1 )..         
-0001c230: 2020 2073 7461 7469 6f6e 5f6c 6973 745f     station_list_
-0001c240: 7472 756e 6361 7465 6420 3d5a 6363 2e74  truncated =Zcc.t
-0001c250: 7275 6e63 6174 6564 5f64 6174 6128 0d0a  runcated_data(..
-0001c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c270: 6461 7461 3d73 656c 662e 7374 6174 696f  data=self.statio
-0001c280: 6e5f 6461 7461 5f61 7272 6179 2c20 6e75  n_data_array, nu
-0001c290: 6d62 6572 5f6f 665f 7265 6363 7572 656e  mber_of_reccuren
-0001c2a0: 6365 3d20 7265 7073 7461 205b 305d 290d  ce= repsta [0]).
-0001c2b0: 0a0d 0a20 2020 2020 2020 2020 2020 2073  ...            s
-0001c2c0: 656c 662e 6c6f 633d 207b 6b65 7973 3a76  elf.loc= {keys:v
-0001c2d0: 616c 7565 7320 666f 7220 6b65 7973 2c20  alues for keys, 
-0001c2e0: 7661 6c75 6573 2069 6e20 7a69 7028 0d0a  values in zip(..
-0001c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c300: 7365 6c66 2e6e 616d 6573 2c20 7374 6174  self.names, stat
-0001c310: 696f 6e5f 6c69 7374 5f74 7275 6e63 6174  ion_list_truncat
-0001c320: 6564 297d 0d0a 2020 2020 2020 2020 2020  ed)}..          
-0001c330: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0001c340: 0d0a 0d0a 636c 6173 7320 4672 6571 7565  ....class Freque
-0001c350: 6e63 7920 286f 626a 6563 7429 3a20 0d0a  ncy (object): ..
-0001c360: 2020 2020 2222 220d 0a20 2020 2046 7265      """..    Fre
-0001c370: 7175 656e 6379 2069 6e66 6f72 6d61 7469  quency informati
-0001c380: 6f6e 7320 2d20 4672 6571 7565 6e63 7920  ons - Frequency 
-0001c390: 6174 2077 6869 6368 2064 6174 6120 0d0a  at which data ..
-0001c3a0: 2020 2020 7761 7320 6d65 6173 7572 6564      was measured
-0001c3b0: 2028 4865 7274 7a29 2e20 4672 6571 7565   (Hertz). Freque
-0001c3c0: 6e63 7920 6f6e 2048 7a20 0d0a 2020 2020  ncy on Hz ..    
-0001c3d0: 2020 2020 0d0a 2020 2020 4172 6775 6d65      ..    Argume
-0001c3e0: 6e74 7320 200d 0a20 2020 202d 2d2d 2d2d  nts  ..    -----
-0001c3f0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2a2a  ----..        **
-0001c400: 6672 6571 5f61 7272 6179 2a2a 2020 3a20  freq_array**  : 
-0001c410: 6172 7279 615f 6c69 6b65 200d 0a20 2020  arrya_like ..   
-0001c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c430: 2020 2020 2066 7265 7175 656e 6365 2064       frequence d
-0001c440: 6174 6120 6172 7261 7920 0d0a 2020 2020  ata array ..    
-0001c450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c460: 2020 2020 0d0a 2020 2020 2020 2020 2a2a      ..        **
-0001c470: 6e6f 726d 616c 697a 655f 6672 6571 5f62  normalize_freq_b
-0001c480: 6574 772a 2a20 3a20 6c69 7374 2020 0d0a  etw** : list  ..
+0001b200: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001b210: 6574 7572 6e5f 636f 756e 7473 3d54 7275  eturn_counts=Tru
+0001b220: 6529 0d0a 200d 0a20 2020 2020 2020 2023  e).. ..        #
+0001b230: 2d2d 2d3e 2063 6865 636b 2069 6620 7374  ---> check if st
+0001b240: 6174 696f 6e73 5f64 6174 6120 7072 6f76  ations_data prov
+0001b250: 6964 6564 2061 7265 2065 6163 6820 7468  ided are each th
+0001b260: 6520 7361 6d65 206c 656e 6774 682e 200d  e same length. .
+0001b270: 0a20 2020 2020 2020 2069 6620 6e70 2e61  .        if np.a
+0001b280: 6c6c 2872 6570 7374 612c 2061 7869 733d  ll(repsta, axis=
+0001b290: 3029 2021 3d20 5472 7565 203a 200d 0a20  0) != True : .. 
+0001b2a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001b2b0: 2053 7461 7469 6f6e 4572 726f 7228 0d0a   StationError(..
+0001b2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b2d0: 2753 7461 7469 6f6e 7320 7072 6f76 6964  'Stations provid
+0001b2e0: 6564 206d 7573 7420 6265 2074 6865 2073  ed must be the s
+0001b2f0: 616d 6520 6c65 6e67 7468 206f 6620 7265  ame length of re
+0001b300: 6363 7572 656e 6379 2e27 290d 0a20 2020  ccurency.')..   
+0001b310: 2020 2020 2069 6620 7265 7073 7461 5b30       if repsta[0
+0001b320: 5d20 3d3d 3120 3a20 0d0a 2020 2020 2020  ] ==1 : ..      
+0001b330: 2020 2020 2020 7365 6c66 2e76 616c 7565        self.value
+0001b340: 203d 2073 656c 662e 7374 6174 696f 6e5f   = self.station_
+0001b350: 6461 7461 5f61 7272 6179 200d 0a20 2020  data_array ..   
+0001b360: 2020 2020 2065 6c69 6620 2072 6570 7374       elif  repst
+0001b370: 615b 305d 2021 3d31 2020 3a20 0d0a 2020  a[0] !=1  : ..  
+0001b380: 2020 2020 2020 2020 2020 7365 6c66 2e76            self.v
+0001b390: 616c 7565 203d 6e75 6d5f 7374 6174 696f  alue =num_statio
+0001b3a0: 6e5f 636f 756e 7473 0d0a 2020 2020 2020  n_counts..      
+0001b3b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0001b3c0: 7365 6c66 2e76 616c 7565 203d 6e70 2e61  self.value =np.a
+0001b3d0: 7272 6179 285b 6e70 2e66 6c6f 6174 2873  rray([np.float(s
+0001b3e0: 7329 2066 6f72 2073 7320 696e 2073 656c  s) for ss in sel
+0001b3f0: 662e 7661 6c75 655d 290d 0a20 2020 2020  f.value])..     
+0001b400: 2020 2023 2d2d 2d20 636f 6e76 6572 7420     #--- convert 
+0001b410: 7374 6174 696f 6e20 2075 6e69 7420 2d2d  station  unit --
+0001b420: 2044 6566 6175 6c74 2069 7320 276d 272d   Default is 'm'-
+0001b430: 2d2d 0d0a 2020 2020 2020 2020 6966 2073  --..        if s
+0001b440: 656c 662e 756e 6974 203d 3d27 6b6d 273a  elf.unit =='km':
+0001b450: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+0001b460: 656c 662e 7661 6c75 652c 2073 656c 662e  elf.value, self.
+0001b470: 7374 6174 696f 6e5f 6461 7461 5f61 7272  station_data_arr
+0001b480: 6179 203d 5c0d 0a20 2020 2020 2020 2020  ay =\..         
+0001b490: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
+0001b4a0: 6520 2f31 6533 2c20 7365 6c66 2e73 7461  e /1e3, self.sta
+0001b4b0: 7469 6f6e 5f64 6174 615f 6172 7261 792f  tion_data_array/
+0001b4c0: 3165 330d 0a20 2020 2020 2020 2069 6620  1e3..        if 
+0001b4d0: 7365 6c66 2e75 6e69 7420 3d3d 2027 6674  self.unit == 'ft
+0001b4e0: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
+0001b4f0: 2073 656c 662e 7661 6c75 652c 2073 656c   self.value, sel
+0001b500: 662e 7374 6174 696f 6e5f 6461 7461 5f61  f.station_data_a
+0001b510: 7272 6179 3d20 5c0d 0a20 2020 2020 2020  rray= \..       
+0001b520: 2020 2020 2020 2020 2073 656c 662e 7661           self.va
+0001b530: 6c75 6520 2f33 2e32 3830 3833 3938 3935  lue /3.280839895
+0001b540: 2c20 7365 6c66 2e73 7461 7469 6f6e 5f64  , self.station_d
+0001b550: 6174 615f 6172 7261 792f 332e 3238 3038  ata_array/3.2808
+0001b560: 3339 3839 350d 0a20 2020 2020 2020 2069  39895..        i
+0001b570: 6620 7365 6c66 2e75 6e69 7420 6e6f 7420  f self.unit not 
+0001b580: 696e 205b 276b 6d27 2c20 2766 7427 2c20  in ['km', 'ft', 
+0001b590: 276d 275d 3a0d 0a20 2020 2020 2020 2020  'm']:..         
+0001b5a0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0001b5b0: 2073 656c 662e 5f6c 6f67 6769 6e67 2e77   self._logging.w
+0001b5c0: 6172 6e28 0d0a 2020 2020 2020 2020 2020  arn(..          
+0001b5d0: 2020 2020 2020 2753 7461 7469 6f6e 2075        'Station u
+0001b5e0: 6e69 7473 2070 726f 7669 6465 6420 6973  nits provided is
+0001b5f0: 2069 6e63 6f72 6563 742e 5472 7920 2022   incorect.Try  "
+0001b600: 6b6d 2220 6f72 2022 6674 2e22 2044 6566  km" or "ft." Def
+0001b610: 6175 6c74 2069 7320 226d 2e22 2729 0d0a  ault is "m."')..
+0001b620: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001b630: 6520 5374 6174 696f 6e45 7272 6f72 280d  e StationError(.
+0001b640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b650: 2027 556e 6974 2070 726f 7669 6465 6420   'Unit provided 
+0001b660: 3c7b 307d 3e20 646f 6573 6e74 206e 6f74  <{0}> doesnt not
+0001b670: 206d 6174 6368 2063 6f72 7265 6374 2075   match correct u
+0001b680: 6e69 7473 2e27 0d0a 2020 2020 2020 2020  nits.'..        
+0001b690: 2020 2020 2020 2020 2027 6163 6365 7074           'accept
+0001b6a0: 6162 6c65 2075 6e69 7473 2061 7265 203a  able units are :
+0001b6b0: 2022 6d22 2c20 226b 6d22 206f 7220 2266   "m", "km" or "f
+0001b6c0: 7422 272e 666f 726d 6174 2873 656c 662e  t"'.format(self.
+0001b6d0: 756e 6974 2929 0d0a 2020 2020 2020 2020  unit))..        
+0001b6e0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0001b6f0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0001b700: 2020 2020 7365 6c66 2e6d 696e 2c20 7365      self.min, se
+0001b710: 6c66 2e6d 6178 2c20 7365 6c66 2e6e 756d  lf.max, self.num
+0001b720: 5f6f 665f 7374 6174 696f 6e20 3d20 5c0d  _of_station = \.
+0001b730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001b740: 662e 7661 6c75 652e 6d69 6e28 292c 2073  f.value.min(), s
+0001b750: 656c 662e 7661 6c75 652e 6d61 7828 292c  elf.value.max(),
+0001b760: 2073 656c 662e 7661 6c75 652e 7369 7a65   self.value.size
+0001b770: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+0001b780: 656e 6774 683d 6e70 2e61 6273 2873 656c  ength=np.abs(sel
+0001b790: 662e 6d61 782d 7365 6c66 2e6d 696e 290d  f.max-self.min).
+0001b7a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0001b7b0: 2020 2069 6620 6e6f 726d 616c 697a 6564     if normalized
+0001b7c0: 5f73 7461 7469 6f6e 5f76 616c 7565 2069  _station_value i
+0001b7d0: 7320 6e6f 7420 4e6f 6e65 203a 0d0a 2020  s not None :..  
+0001b7e0: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
+0001b7f0: 6f72 6d61 6c69 7a65 645f 7374 6174 696f  ormalized_statio
+0001b800: 6e5f 7661 6c75 653d 6e6f 726d 616c 697a  n_value=normaliz
+0001b810: 6564 5f73 7461 7469 6f6e 5f76 616c 7565  ed_station_value
+0001b820: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0001b830: 2020 2020 2069 6620 7365 6c66 2e6e 6f72       if self.nor
+0001b840: 6d61 6c69 7a65 645f 7374 6174 696f 6e5f  malized_station_
+0001b850: 7661 6c75 6520 203a 200d 0a20 2020 2020  value  : ..     
+0001b860: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
+0001b870: 6520 3d6e 702e 6170 706c 795f 616c 6f6e  e =np.apply_alon
+0001b880: 675f 6178 6973 280d 0a20 2020 2020 2020  g_axis(..       
+0001b890: 2020 2020 2020 2020 206c 616d 6264 6120           lambda 
+0001b8a0: 7820 3a20 6e70 2e61 6273 2878 292d 7365  x : np.abs(x)-se
+0001b8b0: 6c66 2e6d 696e 2c20 3020 2c73 656c 662e  lf.min, 0 ,self.
+0001b8c0: 7661 6c75 6529 0d0a 2020 2020 2020 2020  value)..        
+0001b8d0: 2020 2020 7365 6c66 2e73 7461 7469 6f6e      self.station
+0001b8e0: 5f64 6174 615f 6172 7261 793d 6e70 2e61  _data_array=np.a
+0001b8f0: 7070 6c79 5f61 6c6f 6e67 5f61 7869 7328  pply_along_axis(
+0001b900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b910: 2020 6c61 6d62 6461 2078 203a 206e 702e    lambda x : np.
+0001b920: 6162 7328 7829 2d73 656c 662e 6d69 6e2c  abs(x)-self.min,
+0001b930: 2030 2c20 7365 6c66 2e73 7461 7469 6f6e   0, self.station
+0001b940: 5f64 6174 615f 6172 7261 7929 0d0a 2020  _data_array)..  
+0001b950: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0001b960: 2020 2020 2320 7468 6520 6361 7365 2077      # the case w
+0001b970: 6865 7265 2074 6865 2075 7365 7220 7072  here the user pr
+0001b980: 6f76 6964 6520 6974 7320 6f77 6e20 6e61  ovide its own na
+0001b990: 6d65 0d0a 2020 2020 2020 2020 6966 2072  me..        if r
+0001b9a0: 656e 616d 655f 7374 6174 696f 6e20 6973  ename_station is
+0001b9b0: 206e 6f74 204e 6f6e 6520 3a0d 0a20 2020   not None :..   
+0001b9c0: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+0001b9d0: 6e61 6d65 5f73 7461 7469 6f6e 203d 2072  name_station = r
+0001b9e0: 656e 616d 655f 7374 6174 696f 6e20 0d0a  ename_station ..
+0001b9f0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0001ba00: 2020 2020 2020 6966 2073 656c 662e 7265        if self.re
+0001ba10: 6e61 6d65 5f73 7461 7469 6f6e 2069 7320  name_station is 
+0001ba20: 6e6f 7420 4e6f 6e65 203a 200d 0a20 2020  not None : ..   
+0001ba30: 2020 2020 2020 2020 2069 6620 7479 7065           if type
+0001ba40: 2028 7365 6c66 2e72 656e 616d 655f 7374   (self.rename_st
+0001ba50: 6174 696f 6e29 2069 7320 6c69 7374 203a  ation) is list :
+0001ba60: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001ba70: 2020 2073 656c 662e 7265 6e61 6d65 5f73     self.rename_s
+0001ba80: 7461 7469 6f6e 3d6e 702e 6172 7261 7928  tation=np.array(
+0001ba90: 7365 6c66 2e72 656e 616d 655f 7374 6174  self.rename_stat
+0001baa0: 696f 6e29 0d0a 2020 2020 2020 2020 2020  ion)..          
+0001bab0: 2020 6966 2073 656c 662e 7661 6c75 652e    if self.value.
+0001bac0: 7369 7a65 2021 3d20 7365 6c66 2e72 656e  size != self.ren
+0001bad0: 616d 655f 7374 6174 696f 6e2e 7369 7a65  ame_station.size
+0001bae0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+0001baf0: 2020 2020 2072 6169 7365 2053 7461 7469       raise Stati
+0001bb00: 6f6e 4572 726f 7228 0d0a 2020 2020 2020  onError(..      
+0001bb10: 2020 2020 2020 2020 2020 2020 2020 2753                'S
+0001bb20: 7461 7469 6f6e 7320 7265 6e61 6d65 2061  tations rename a
+0001bb30: 7272 6179 206d 7573 7420 6861 7665 2074  rray must have t
+0001bb40: 6865 2073 616d 6520 6c65 6e67 7468 2061  he same length a
+0001bb50: 7327 0d0a 2020 2020 2020 2020 2020 2020  s'..            
+0001bb60: 2020 2020 2020 2020 2720 7468 6520 6172          ' the ar
+0001bb70: 6179 5f64 6174 6120 7072 6f76 6964 6564  ay_data provided
+0001bb80: 2e20 6c65 6e67 6874 206f 7220 7374 6174  . lenght or stat
+0001bb90: 696f 6e73 5f64 6174 6120 6973 203a 3c7b  ions_data is :<{
+0001bba0: 307d 3e27 0d0a 2020 2020 2020 2020 2020  0}>'..          
+0001bbb0: 2020 2020 2020 2020 2020 2720 272e 666f            ' '.fo
+0001bbc0: 726d 6174 2873 656c 662e 7661 6c75 652e  rmat(self.value.
+0001bbd0: 7369 7a65 2929 0d0a 2020 2020 2020 2020  size))..        
+0001bbe0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001bbf0: 2020 2020 2020 7365 6c66 2e6e 616d 6573        self.names
+0001bc00: 203d 7365 6c66 2e72 656e 616d 655f 7374   =self.rename_st
+0001bc10: 6174 696f 6e0d 0a20 2020 2020 2020 2065  ation..        e
+0001bc20: 6c69 6620 7265 6e61 6d65 5f73 7461 7469  lif rename_stati
+0001bc30: 6f6e 2069 7320 4e6f 6e65 203a 200d 0a20  on is None : .. 
+0001bc40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001bc50: 6e61 6d65 7320 3d5b 2753 7b3a 3032 7d27  names =['S{:02}'
+0001bc60: 2e66 6f72 6d61 7428 6969 2920 666f 7220  .format(ii) for 
+0001bc70: 6969 2069 6e20 7261 6e67 6520 2873 656c  ii in range (sel
+0001bc80: 662e 7661 6c75 652e 7369 7a65 295d 0d0a  f.value.size)]..
+0001bc90: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001bca0: 2020 232d 2d2d 3e20 6475 706c 6963 6174    #---> duplicat
+0001bcb0: 6520 7374 6174 696f 6e73 206e 616d 6573  e stations names
+0001bcc0: 2061 6e64 2070 7574 206f 6e20 6469 6374   and put on dict
+0001bcd0: 0d0a 2020 2020 2020 2020 6966 2072 6570  ..        if rep
+0001bce0: 7374 615b 305d 203d 3d31 203a 200d 0a20  sta[0] ==1 : .. 
+0001bcf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001bd00: 2e6c 6f63 203d 7b6b 6579 733a 7661 6c75  .loc ={keys:valu
+0001bd10: 6573 2066 6f72 206b 6579 732c 2076 616c  es for keys, val
+0001bd20: 7565 7320 696e 207a 6970 2873 656c 662e  ues in zip(self.
+0001bd30: 6e61 6d65 7320 2c20 7365 6c66 2e76 616c  names , self.val
+0001bd40: 7565 297d 0d0a 2020 2020 2020 2020 6966  ue)}..        if
+0001bd50: 2072 6570 7374 6120 5b30 5d20 213d 3120   repsta [0] !=1 
+0001bd60: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001bd70: 2320 7365 6c66 2e6e 616d 6573 203d 7365  # self.names =se
+0001bd80: 6c66 2e6e 616d 6573 202a 2072 6570 7374  lf.names * repst
+0001bd90: 6120 5b30 5d0d 0a20 2020 2020 2020 2020  a [0]..         
+0001bda0: 2020 2073 656c 662e 6e61 6d65 732e 736f     self.names.so
+0001bdb0: 7274 2829 0d0a 2020 2020 2020 2020 2020  rt()..          
+0001bdc0: 2020 2320 7072 696e 7428 7365 6c66 2e73    # print(self.s
+0001bdd0: 7461 7469 6f6e 5f64 6174 615f 6172 7261  tation_data_arra
+0001bde0: 7929 0d0a 2020 2020 2020 2020 2020 2020  y)..            
+0001bdf0: 2320 7365 6c66 2e73 7461 7469 6f6e 5f64  # self.station_d
+0001be00: 6174 615f 6172 7261 793d 7365 6c66 2e73  ata_array=self.s
+0001be10: 7461 7469 6f6e 5f64 6174 615f 6172 7261  tation_data_arra
+0001be20: 792e 7265 7368 6170 650d 0a20 2020 2020  y.reshape..     
+0001be30: 2020 2020 2020 2023 2828 7365 6c66 2e73         #((self.s
+0001be40: 7461 7469 6f6e 5f64 6174 615f 6172 7261  tation_data_arra
+0001be50: 792e 7368 6170 655b 305d 2c31 2929 0d0a  y.shape[0],1))..
+0001be60: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0001be70: 2020 2020 2020 2020 2020 2320 7072 696e            # prin
+0001be80: 7428 7365 6c66 2e73 7461 7469 6f6e 5f64  t(self.station_d
+0001be90: 6174 615f 6172 7261 7929 0d0a 2020 2020  ata_array)..    
+0001bea0: 2020 2020 2020 2020 232d 2d2d 2062 7569          #--- bui
+0001beb0: 6c64 2061 2063 6f6d 6d75 6e20 6172 7261  ld a commun arra
+0001bec0: 7920 7374 6174 696f 6e2d 7661 6c75 6520  y station-value 
+0001bed0: 616e 6420 7472 756e 6361 7465 6420 6f6e  and truncated on
+0001bee0: 2064 6963 742e 0d0a 2020 2020 2020 2020   dict...        
+0001bef0: 2020 2020 2320 6461 7461 5f74 6f5f 7472      # data_to_tr
+0001bf00: 756e 6361 7465 203d 6e70 2e63 6f6e 6361  uncate =np.conca
+0001bf10: 7465 6e61 7465 2828 7465 6d5f 6e61 6d65  tenate((tem_name
+0001bf20: 732c 2073 656c 662e 7374 6174 696f 6e5f  s, self.station_
+0001bf30: 6461 7461 5f61 7272 6179 292c 2061 7869  data_array), axi
+0001bf40: 7320 3d31 2029 0d0a 2020 2020 2020 2020  s =1 )..        
+0001bf50: 2020 2020 7374 6174 696f 6e5f 6c69 7374      station_list
+0001bf60: 5f74 7275 6e63 6174 6564 203d 5a63 632e  _truncated =Zcc.
+0001bf70: 7472 756e 6361 7465 645f 6461 7461 280d  truncated_data(.
+0001bf80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bf90: 2064 6174 613d 7365 6c66 2e73 7461 7469   data=self.stati
+0001bfa0: 6f6e 5f64 6174 615f 6172 7261 792c 206e  on_data_array, n
+0001bfb0: 756d 6265 725f 6f66 5f72 6563 6375 7265  umber_of_reccure
+0001bfc0: 6e63 653d 2072 6570 7374 6120 5b30 5d29  nce= repsta [0])
+0001bfd0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0001bfe0: 7365 6c66 2e6c 6f63 3d20 7b6b 6579 733a  self.loc= {keys:
+0001bff0: 7661 6c75 6573 2066 6f72 206b 6579 732c  values for keys,
+0001c000: 2076 616c 7565 7320 696e 207a 6970 280d   values in zip(.
+0001c010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c020: 2073 656c 662e 6e61 6d65 732c 2073 7461   self.names, sta
+0001c030: 7469 6f6e 5f6c 6973 745f 7472 756e 6361  tion_list_trunca
+0001c040: 7465 6429 7d0d 0a20 2020 2020 2020 2020  ted)}..         
+0001c050: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0001c060: 200d 0a0d 0a63 6c61 7373 2046 7265 7175   ....class Frequ
+0001c070: 656e 6379 2028 6f62 6a65 6374 293a 200d  ency (object): .
+0001c080: 0a20 2020 2022 2222 0d0a 2020 2020 4672  .    """..    Fr
+0001c090: 6571 7565 6e63 7920 696e 666f 726d 6174  equency informat
+0001c0a0: 696f 6e73 202d 2046 7265 7175 656e 6379  ions - Frequency
+0001c0b0: 2061 7420 7768 6963 6820 6461 7461 200d   at which data .
+0001c0c0: 0a20 2020 2077 6173 206d 6561 7375 7265  .    was measure
+0001c0d0: 6420 2848 6572 747a 292e 2046 7265 7175  d (Hertz). Frequ
+0001c0e0: 656e 6379 206f 6e20 487a 200d 0a20 2020  ency on Hz ..   
+0001c0f0: 2020 2020 200d 0a20 2020 2041 7267 756d       ..    Argum
+0001c100: 656e 7473 2020 0d0a 2020 2020 2d2d 2d2d  ents  ..    ----
+0001c110: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
+0001c120: 2a66 7265 715f 6172 7261 792a 2a20 203a  *freq_array**  :
+0001c130: 2061 7272 7961 5f6c 696b 6520 0d0a 2020   arrya_like ..  
+0001c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c150: 2020 2020 2020 6672 6571 7565 6e63 6520        frequence 
+0001c160: 6461 7461 2061 7272 6179 200d 0a20 2020  data array ..   
+0001c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c180: 2020 2020 200d 0a20 2020 2020 2020 202a       ..        *
+0001c190: 2a6e 6f72 6d61 6c69 7a65 5f66 7265 715f  *normalize_freq_
+0001c1a0: 6265 7477 2a2a 203a 206c 6973 7420 200d  betw** : list  .
+0001c1b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c1d0: 206d 7573 7420 6265 206f 6e20 6c69 7374   must be on list
+0001c1e0: 206f 6620 696e 7465 6765 7220 7661 6c75   of integer valu
+0001c1f0: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
+0001c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c210: 2020 2020 4966 2066 6c6f 6174 2076 616c      If float val
+0001c220: 7565 2070 726f 7669 6465 6420 0d0a 2020  ue provided ..  
+0001c230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c240: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+0001c250: 6f75 6c64 2062 6520 636f 6e76 6572 7420  ould be convert 
+0001c260: 6f6e 206c 6973 742c 2073 616d 6520 6173  on list, same as
+0001c270: 2074 7570 6c65 200d 0a20 0d0a 2020 2020   tuple .. ..    
+0001c280: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001c290: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+0001c2a0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+0001c2b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001c2c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+0001c2d0: 2041 7474 7269 6275 7465 7320 2020 2020   Attributes     
+0001c2e0: 2020 2020 2020 2020 2054 7970 6520 2020           Type   
+0001c2f0: 2020 2020 2045 7870 6c61 6e61 7469 6f6e       Explanation
+0001c300: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
+0001c310: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
+0001c320: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
+0001c330: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001c340: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001c350: 3d0d 0a20 2020 2076 616c 7565 2020 2020  =..    value    
+0001c360: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001c370: 642e 6172 7261 7920 2020 2066 7265 7175  d.array    frequ
+0001c380: 656e 6379 2064 6174 6120 636f 6c75 6d6e  ency data column
+0001c390: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0001c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3b0: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
+0001c3c0: 6e65 6e74 7320 0d0a 2020 2020 6d61 7820  nents ..    max 
+0001c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3e0: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
+0001c3f0: 4869 6768 7420 6672 6571 7565 6e63 7920  Hight frequency 
+0001c400: 0d0a 2020 2020 6d69 6e20 2020 2020 2020  ..    min       
+0001c410: 2020 2020 2020 2020 2020 2020 2020 666c                fl
+0001c420: 6f61 7420 2020 2020 2020 6c6f 7765 7220  oat       lower 
+0001c430: 6672 6571 7565 6e63 7920 200d 0a20 2020  frequency  ..   
+0001c440: 206c 6f63 2020 2020 2020 2020 2020 2020   loc            
+0001c450: 2020 2020 2020 2020 2064 6963 7420 2020           dict   
+0001c460: 2020 2020 206d 6169 6e20 6174 7472 6962       main attrib
+0001c470: 7574 6520 3a20 6c6f 6361 7469 6f6e 200d  ute : location .
+0001c480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4b0: 6d75 7374 2062 6520 6f6e 206c 6973 7420  must be on list 
-0001c4c0: 6f66 2069 6e74 6567 6572 2076 616c 7565  of integer value
-0001c4d0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001c4a0: 2020 2020 2020 2020 206f 6620 7374 6174           of stat
+0001c4b0: 696f 6e20 6c6f 6320 5b27 5330 3127 5d20  ion loc ['S01'] 
+0001c4c0: 7368 6f77 2074 6865 2066 7265 7175 656e  show the frequen
+0001c4d0: 6379 200d 0a20 2020 2020 2020 2020 2020  cy ..           
 0001c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4f0: 2020 2049 6620 666c 6f61 7420 7661 6c75     If float valu
-0001c500: 6520 7072 6f76 6964 6564 200d 0a20 2020  e provided ..   
-0001c510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c520: 2020 2020 2020 2020 2020 2020 2073 686f               sho
-0001c530: 756c 6420 6265 2063 6f6e 7665 7274 206f  uld be convert o
-0001c540: 6e20 6c69 7374 2c20 7361 6d65 2061 7320  n list, same as 
-0001c550: 7475 706c 6520 0d0a 200d 0a20 2020 203d  tuple .. ..    =
-0001c560: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001c570: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
-0001c580: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
-0001c590: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001c5a0: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
-0001c5b0: 4174 7472 6962 7574 6573 2020 2020 2020  Attributes      
-0001c5c0: 2020 2020 2020 2020 5479 7065 2020 2020          Type    
-0001c5d0: 2020 2020 4578 706c 616e 6174 696f 6e0d      Explanation.
-0001c5e0: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
-0001c5f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
-0001c600: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-0001c610: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001c620: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001c630: 0d0a 2020 2020 7661 6c75 6520 2020 2020  ..    value     
-0001c640: 2020 2020 2020 2020 2020 2020 2020 6e64                nd
-0001c650: 2e61 7272 6179 2020 2020 6672 6571 7565  .array    freque
-0001c660: 6e63 7920 6461 7461 2063 6f6c 756d 6e73  ncy data columns
-0001c670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c690: 2020 2020 2020 2020 2020 636f 6d70 6f6e            compon
-0001c6a0: 656e 7473 200d 0a20 2020 206d 6178 2020  ents ..    max  
+0001c4f0: 2020 2020 2020 2020 2020 2020 206f 6620               of 
+0001c500: 7374 6174 696f 6e20 6174 2074 6861 7420  station at that 
+0001c510: 706f 696e 742e 200d 0a20 2020 206e 6f72  point. ..    nor
+0001c520: 6d61 6c69 7a65 5f66 7265 715f 6265 7477  malize_freq_betw
+0001c530: 2020 2020 206c 6973 7420 2020 2020 2020       list       
+0001c540: 206d 7573 7420 6265 2061 206c 6973 7420   must be a list 
+0001c550: 6f66 2069 6e74 6567 6572 2020 6265 2073  of integer  be s
+0001c560: 7572 6520 7468 6174 0d0a 2020 2020 2020  ure that..      
+0001c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c590: 2020 7468 6520 6e75 6d62 6572 7072 6f76    the numberprov
+0001c5a0: 6964 6564 2077 696c 6c20 6265 2070 6f77  ided will be pow
+0001c5b0: 6572 200d 0a20 2020 2020 2020 2020 2020  er ..           
+0001c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c5d0: 2020 2020 2020 2020 2020 2020 2074 6f20               to 
+0001c5e0: 3130 2e20 6567 202e 2873 7461 7274 2c20  10. eg .(start, 
+0001c5f0: 656e 642c 2020 6e66 7265 7129 2020 200d  end,  nfreq)   .
+0001c600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c620: 2020 2020 2020 2020 2073 7461 7274 202d           start -
+0001c630: 2066 6972 7374 206e 756d 6265 7220 7769   first number wi
+0001c640: 6c6c 2062 6520 706f 7765 7220 6279 2031  ll be power by 1
+0001c650: 3020 0d0a 2020 2020 2020 2020 2020 2020  0 ..            
+0001c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c670: 2020 2020 2020 2020 2020 2020 303d 313a              0=1:
+0001c680: 3130 6578 7028 3029 2065 6e64 2d20 6c61  10exp(0) end- la
+0001c690: 7374 2076 616c 7565 2074 6f20 6265 200d  st value to be .
+0001c6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6c0: 2020 2066 6c6f 6174 2020 2020 2020 2048     float       H
-0001c6d0: 6967 6874 2066 7265 7175 656e 6379 200d  ight frequency .
-0001c6e0: 0a20 2020 206d 696e 2020 2020 2020 2020  .    min        
-0001c6f0: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
-0001c700: 6174 2020 2020 2020 206c 6f77 6572 2066  at       lower f
-0001c710: 7265 7175 656e 6379 2020 0d0a 2020 2020  requency  ..    
-0001c720: 6c6f 6320 2020 2020 2020 2020 2020 2020  loc             
-0001c730: 2020 2020 2020 2020 6469 6374 2020 2020          dict    
-0001c740: 2020 2020 6d61 696e 2061 7474 7269 6275      main attribu
-0001c750: 7465 203a 206c 6f63 6174 696f 6e20 0d0a  te : location ..
-0001c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c780: 2020 2020 2020 2020 6f66 2073 7461 7469          of stati
-0001c790: 6f6e 206c 6f63 205b 2753 3031 275d 2073  on loc ['S01'] s
-0001c7a0: 686f 7720 7468 6520 6672 6571 7565 6e63  how the frequenc
-0001c7b0: 7920 0d0a 2020 2020 2020 2020 2020 2020  y ..            
-0001c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7d0: 2020 2020 2020 2020 2020 2020 6f66 2073              of s
-0001c7e0: 7461 7469 6f6e 2061 7420 7468 6174 2070  tation at that p
-0001c7f0: 6f69 6e74 2e20 0d0a 2020 2020 6e6f 726d  oint. ..    norm
-0001c800: 616c 697a 655f 6672 6571 5f62 6574 7720  alize_freq_betw 
-0001c810: 2020 2020 6c69 7374 2020 2020 2020 2020      list        
-0001c820: 6d75 7374 2062 6520 6120 6c69 7374 206f  must be a list o
-0001c830: 6620 696e 7465 6765 7220 2062 6520 7375  f integer  be su
-0001c840: 7265 2074 6861 740d 0a20 2020 2020 2020  re that..       
-0001c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c870: 2074 6865 206e 756d 6265 7270 726f 7669   the numberprovi
-0001c880: 6465 6420 7769 6c6c 2062 6520 706f 7765  ded will be powe
-0001c890: 7220 0d0a 2020 2020 2020 2020 2020 2020  r ..            
-0001c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8b0: 2020 2020 2020 2020 2020 2020 746f 2031              to 1
-0001c8c0: 302e 2065 6720 2e28 7374 6172 742c 2065  0. eg .(start, e
-0001c8d0: 6e64 2c20 206e 6672 6571 2920 2020 0d0a  nd,  nfreq)   ..
-0001c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c900: 2020 2020 2020 2020 7374 6172 7420 2d20          start - 
-0001c910: 6669 7273 7420 6e75 6d62 6572 2077 696c  first number wil
-0001c920: 6c20 6265 2070 6f77 6572 2062 7920 3130  l be power by 10
-0001c930: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001c940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c950: 2020 2020 2020 2020 2020 2030 3d31 3a31             0=1:1
-0001c960: 3065 7870 2830 2920 656e 642d 206c 6173  0exp(0) end- las
-0001c970: 7420 7661 6c75 6520 746f 2062 6520 0d0a  t value to be ..
-0001c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9a0: 2020 2020 2020 2020 696e 7465 7270 6f6c          interpol
-0001c9b0: 6174 6564 203a 2034 202d 2d3e 2031 3028  ated : 4 --> 10(
-0001c9c0: 6578 7029 340d 0a20 2020 2020 2020 2020  exp)4..         
-0001c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9e0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001c9f0: 6672 6571 2d20 6e75 6d62 6572 206f 6620  freq- number of 
-0001ca00: 6672 6571 7565 6e63 7920 203a 2065 6720  frequency  : eg 
-0001ca10: 3a20 3137 200d 0a20 2020 2020 2020 2020  : 17 ..         
-0001ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca30: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0001ca40: 4465 6661 756c 742a 2069 7320 4e6f 6e65  Default* is None
-0001ca50: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
-0001ca60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
-0001ca70: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-0001ca80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001ca90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001caa0: 3d3d 0d0a 0d0a 2020 2020 4d6f 7265 2061  ==....    More a
-0001cab0: 7474 7269 6275 7465 7320 6361 6e20 6265  ttributes can be
-0001cac0: 2061 6464 6564 2062 7920 696e 7075 7469   added by inputi
-0001cad0: 6e67 2061 206b 6579 2077 6f72 6420 6469  ng a key word di
-0001cae0: 6374 696f 6e61 7279 0d0a 0d0a 2020 2020  ctionary....    
-0001caf0: 3a45 7861 6d70 6c65 3a0d 0a20 2020 2020  :Example:..     
-0001cb00: 2020 200d 0a20 2020 2020 2020 203e 3e3e     ..        >>>
-0001cb10: 2066 726f 6d20 7079 6373 616d 742e 6666   from pycsamt.ff
-0001cb20: 2e63 6f72 652e 6176 6720 696d 706f 7274  .core.avg import
-0001cb30: 2041 7667 0d0a 2020 2020 2020 2020 3e3e   Avg..        >>
-0001cb40: 3e20 7061 7468 3d6f 732e 7061 7468 2e6a  > path=os.path.j
-0001cb50: 6f69 6e28 6f73 2e65 6e76 6972 6f6e 5b22  oin(os.environ["
-0001cb60: 7079 4353 414d 5422 5d2c 200d 0a20 2020  pyCSAMT"], ..   
-0001cb70: 2020 2020 2020 2020 2020 2022 6461 7461             "data
-0001cb80: 222c 2022 6176 6722 2c20 224b 312e 4156  ", "avg", "K1.AV
-0001cb90: 4722 290d 0a20 2020 2020 2020 203e 3e3e  G")..        >>>
-0001cba0: 2066 7265 715f 6f62 6a3d 4176 6728 7061   freq_obj=Avg(pa
-0001cbb0: 7468 290d 0a20 2020 2020 2020 203e 3e3e  th)..        >>>
-0001cbc0: 2066 7265 715f 6f62 6a20 3d61 7667 5f6f   freq_obj =avg_o
-0001cbd0: 626a 2e44 6174 615f 7365 6374 696f 6e2e  bj.Data_section.
-0001cbe0: 4672 6571 7565 6e63 792e 6c6f 635b 2753  Frequency.loc['S
-0001cbf0: 3037 275d 0d0a 2020 2020 2020 2020 2e2e  07']..        ..
-0001cc00: 2e20 7072 696e 7428 6672 6571 5f6f 626a  . print(freq_obj
-0001cc10: 290d 0a20 2020 2022 2222 0d0a 2020 2020  )..    """..    
-0001cc20: 0d0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-0001cc30: 5f5f 2873 656c 662c 2066 7265 715f 6172  __(self, freq_ar
-0001cc40: 7261 7920 3d4e 6f6e 652c 200d 0a20 2020  ray =None, ..   
-0001cc50: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-0001cc60: 726d 616c 697a 655f 6672 6571 5f62 6574  rmalize_freq_bet
-0001cc70: 7720 3d4e 6f6e 652c 2020 2a2a 6b77 6172  w =None,  **kwar
-0001cc80: 6773 293a 0d0a 0d0a 2020 2020 2020 2020  gs):....        
-0001cc90: 7365 6c66 2e5f 6672 6571 5f61 7272 6179  self._freq_array
-0001cca0: 203d 6672 6571 5f61 7272 6179 200d 0a20   =freq_array .. 
-0001ccb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001ccc0: 2073 656c 662e 6e6f 726d 616c 697a 655f   self.normalize_
-0001ccd0: 6672 6571 5f62 6574 773d 6b77 6172 6773  freq_betw=kwargs
-0001cce0: 2e70 6f70 2827 6e6f 726d 616c 697a 655f  .pop('normalize_
-0001ccf0: 6672 6571 5f62 6574 7727 2c20 4e6f 6e65  freq_betw', None
-0001cd00: 2029 0d0a 2020 2020 2020 2020 7365 6c66   )..        self
-0001cd10: 2e76 616c 7565 203d 4e6f 6e65 200d 0a20  .value =None .. 
-0001cd20: 2020 2020 2020 2073 656c 662e 6d69 6e3d         self.min=
-0001cd30: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
-0001cd40: 656c 662e 6d61 783d 4e6f 6e65 200d 0a20  elf.max=None .. 
-0001cd50: 2020 2020 2020 2073 656c 662e 6e75 6d66         self.numf
-0001cd60: 7265 713d 4e6f 6e65 200d 0a20 2020 2020  req=None ..     
-0001cd70: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-0001cd80: 2020 2020 2020 2066 6f72 206b 6579 7320         for keys 
-0001cd90: 696e 206c 6973 7420 286b 7761 7267 732e  in list (kwargs.
-0001cda0: 6b65 7973 2829 293a 200d 0a20 2020 2020  keys()): ..     
-0001cdb0: 2020 2020 2020 2073 6574 6174 7472 2873         setattr(s
-0001cdc0: 656c 662c 206b 6579 732c 206b 7761 7267  elf, keys, kwarg
-0001cdd0: 735b 6b65 7973 5d29 0d0a 2020 2020 2020  s[keys])..      
-0001cde0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001cdf0: 6966 2073 656c 662e 5f66 7265 715f 6172  if self._freq_ar
-0001ce00: 7261 7920 6973 206e 6f74 204e 6f6e 6520  ray is not None 
-0001ce10: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0001ce20: 7365 6c66 2e5f 7365 745f 6672 6571 7565  self._set_freque
-0001ce30: 6e63 7928 290d 0a20 2020 2020 2020 200d  ncy()..        .
-0001ce40: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0001ce50: 2020 2064 6566 205f 7365 745f 6672 6571     def _set_freq
-0001ce60: 7565 6e63 7920 2873 656c 662c 2066 7265  uency (self, fre
-0001ce70: 715f 6172 7261 7920 3d4e 6f6e 652c 206e  q_array =None, n
-0001ce80: 6f72 6d61 6c69 7a65 5f66 7265 715f 6265  ormalize_freq_be
-0001ce90: 7477 203d 204e 6f6e 6520 293a 0d0a 2020  tw = None ):..  
-0001cea0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0001ceb0: 2020 204d 6574 686f 6420 746f 2073 6574     Method to set
-0001cec0: 2066 7265 7175 656e 6379 2061 6363 6f72   frequency accor
-0001ced0: 6469 6e67 2074 6f20 6561 6368 2073 7461  ding to each sta
-0001cee0: 7469 6f6e 2e0d 0a0d 0a20 2020 2020 2020  tion.....       
-0001cef0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0001cf00: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0001cf10: 0a20 2020 2020 2020 2020 2020 202a 2066  .            * f
-0001cf20: 7265 715f 6172 7261 7920 3a20 6e70 2e6e  req_array : np.n
-0001cf30: 6461 7272 6179 286e 6461 7272 6179 2c20  darray(ndarray, 
-0001cf40: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-0001cf50: 2020 2020 2020 2020 2020 2020 6672 6571              freq
-0001cf60: 7565 6e63 7920 6461 7461 2070 726f 7669  uency data provi
-0001cf70: 6465 6420 2e20 5468 6520 6465 6661 756c  ded . The defaul
-0001cf80: 7420 6973 204e 6f6e 652e 0d0a 2020 2020  t is None...    
-0001cf90: 2020 2020 2020 2020 2a20 6e6f 726d 616c          * normal
-0001cfa0: 697a 655f 6672 6571 5f62 6574 7720 3a20  ize_freq_betw : 
-0001cfb0: 6c69 7374 200d 0a20 2020 2020 2020 2020  list ..         
-0001cfc0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001cfd0: 6973 7420 6f66 2066 7265 7175 656e 6379  ist of frequency
-0001cfe0: 2072 616e 6765 2074 6f20 6e6f 726d 616c   range to normal
-0001cff0: 697a 652c 206f 7074 696f 6e61 6c2e 200d  ize, optional. .
-0001d000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d010: 2020 2020 2020 2020 2054 6865 202a 6465           The *de
-0001d020: 6661 756c 742a 2069 7320 4e6f 6e65 2e0d  fault* is None..
-0001d030: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0001d040: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001d050: 0d0a 2020 2020 2020 2020 6966 2066 7265  ..        if fre
-0001d060: 715f 6172 7261 7920 6973 206e 6f74 204e  q_array is not N
-0001d070: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
-0001d080: 2020 2020 7365 6c66 2e5f 6672 6571 5f61      self._freq_a
-0001d090: 7272 6179 203d 6672 6571 5f61 7272 6179  rray =freq_array
-0001d0a0: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-0001d0b0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001d0c0: 2e5f 6672 6571 5f61 7272 6179 2069 7320  ._freq_array is 
-0001d0d0: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
-0001d0e0: 2020 2020 2072 6169 7365 2043 5365 782e       raise CSex.
-0001d0f0: 7079 4353 414d 5445 7272 6f72 5f66 7265  pyCSAMTError_fre
-0001d100: 7175 656e 6379 2827 4e6f 2046 7265 7175  quency('No Frequ
-0001d110: 656e 6379 2044 6174 6120 666f 756e 642e  ency Data found.
-0001d120: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0001d130: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-0001d140: 2020 2020 2020 2020 7365 6c66 2e5f 6672          self._fr
-0001d150: 6571 5f61 7272 6179 203d 6e70 2e61 7272  eq_array =np.arr
-0001d160: 6179 285b 6e70 2e66 6c6f 6174 286b 6b29  ay([np.float(kk)
-0001d170: 2066 6f72 206b 6b20 696e 2073 656c 662e   for kk in self.
-0001d180: 5f66 7265 715f 6172 7261 795d 2920 200d  _freq_array])  .
-0001d190: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0001d1a0: 2020 2023 2d2d 3e20 7265 6164 2066 7265     #--> read fre
-0001d1b0: 7175 656e 6379 2066 726f 6d20 4156 4720  quency from AVG 
-0001d1c0: 6461 7461 2066 696c 6520 3a20 0d0a 2020  data file : ..  
-0001d1d0: 2020 2020 2020 7661 636f 756e 745f 6672        vacount_fr
-0001d1e0: 6571 2c20 6672 6571 5f72 6570 6561 7420  eq, freq_repeat 
-0001d1f0: 3d6e 702e 756e 6971 7565 2873 656c 662e  =np.unique(self.
-0001d200: 5f66 7265 715f 6172 7261 792c 200d 0a20  _freq_array, .. 
-0001d210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d230: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001d240: 726e 5f63 6f75 6e74 733d 5472 7565 290d  rn_counts=True).
-0001d250: 0a0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-0001d260: 2020 2020 2073 656c 662e 6e75 6d66 7265       self.numfre
-0001d270: 7120 3d20 7661 636f 756e 745f 6672 6571  q = vacount_freq
-0001d280: 2e73 697a 650d 0a20 2020 2020 2020 2069  .size..        i
-0001d290: 6620 6e70 2e61 6c6c 2866 7265 715f 7265  f np.all(freq_re
-0001d2a0: 7065 6174 2c20 6178 6973 203d 3029 2021  peat, axis =0) !
-0001d2b0: 3d20 5472 7565 203a 200d 0a20 2020 2020  = True : ..     
-0001d2c0: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-0001d2d0: 782e 7079 4353 414d 5445 7272 6f72 5f66  x.pyCSAMTError_f
-0001d2e0: 7265 7175 656e 6379 280d 0a20 2020 2020  requency(..     
-0001d2f0: 2020 2020 2020 2020 2020 2027 5072 6f62             'Prob
-0001d300: 6c65 6d20 6f63 6375 7265 6420 7768 656e  lem occured when
-0001d310: 2072 6561 6469 6e67 2066 7265 7175 656e   reading frequen
-0001d320: 6379 2064 6174 612e 270d 0a20 2020 2020  cy data.'..     
-0001d330: 2020 2020 2020 2020 2020 2020 2741 6c6c              'All
-0001d340: 2066 7265 7175 656e 6379 206f 6e20 4176   frequency on Av
-0001d350: 6766 696c 6520 4d75 7374 2062 6520 7468  gfile Must be th
-0001d360: 6520 7361 6d65 206c 656e 6774 682e 2027  e same length. '
-0001d370: 290d 0a20 2020 2020 2020 2023 2073 656c  )..        # sel
-0001d380: 662e 7661 6c75 6520 3d76 6163 6f75 6e74  f.value =vacount
-0001d390: 5f66 7265 710d 0a20 2020 2020 2020 200d  _freq..        .
-0001d3a0: 0a20 2020 2020 2020 2023 2069 6620 6e6f  .        # if no
-0001d3b0: 726d 616c 697a 655f 6672 6571 5f62 6574  rmalize_freq_bet
-0001d3c0: 7720 6973 206e 6f74 204e 6f6e 6520 3a20  w is not None : 
-0001d3d0: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
-0001d3e0: 2073 656c 662e 7661 6c75 6520 3d73 656c   self.value =sel
-0001d3f0: 662e 6e6f 726d 616c 697a 655f 6672 6571  f.normalize_freq
-0001d400: 5f62 6574 7728 290d 0a20 2020 2020 2020  _betw()..       
-0001d410: 200d 0a20 2020 2020 2020 2023 2073 656c   ..        # sel
-0001d420: 662e 6d61 782c 2073 656c 662e 6d69 6e3d  f.max, self.min=
-0001d430: 7365 6c66 2e76 616c 7565 2e6d 6178 2829  self.value.max()
-0001d440: 2c20 7365 6c66 2e76 616c 7565 2e6d 696e  , self.value.min
-0001d450: 2829 0d0a 2020 0d0a 2020 2020 2020 2020  ()..  ..        
-0001d460: 7472 756e 6361 7465 645f 6672 6571 203d  truncated_freq =
-0001d470: 5a63 632e 7472 756e 6361 7465 645f 6461  Zcc.truncated_da
-0001d480: 7461 2820 6461 7461 203d 7365 6c66 2e5f  ta( data =self._
-0001d490: 6672 6571 5f61 7272 6179 202c 200d 0a20  freq_array , .. 
-0001d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4c0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-0001d4d0: 7265 6363 7572 656e 6365 3d73 656c 662e  reccurence=self.
-0001d4e0: 6e75 6d66 7265 7120 290d 0a20 2020 2020  numfreq )..     
-0001d4f0: 2020 200d 0a20 2020 2020 2020 206e 616d     ..        nam
-0001d500: 652c 2070 6f6c 796e 616d 6520 3d20 5a63  e, polyname = Zc
-0001d510: 632e 5f6e 756d 6265 7269 6e67 5f73 7461  c._numbering_sta
-0001d520: 7469 6f6e 280d 0a20 2020 2020 2020 2020  tion(..         
-0001d530: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
-0001d540: 7469 6f6e 3d66 7265 715f 7265 7065 6174  tion=freq_repeat
-0001d550: 5b30 5d2c 200d 0a20 2020 2020 2020 2020  [0], ..         
-0001d560: 2020 206e 756d 6265 725f 6f66 5f66 7265     number_of_fre
-0001d570: 7120 3d73 656c 662e 6e75 6d66 7265 7129  q =self.numfreq)
-0001d580: 0d0a 2020 2020 2020 2020 0d0a 200d 0a20  ..        .. .. 
-0001d590: 2020 2020 2020 2073 656c 662e 6c6f 6320         self.loc 
-0001d5a0: 3d7b 206b 6579 3a76 616c 7565 2066 6f72  ={ key:value for
-0001d5b0: 206b 6579 2c20 7661 6c75 6520 696e 207a   key, value in z
-0001d5c0: 6970 286e 616d 652c 2074 7275 6e63 6174  ip(name, truncat
-0001d5d0: 6564 5f66 7265 7120 297d 0d0a 2020 2020  ed_freq )}..    
-0001d5e0: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
-0001d5f0: 6c66 2e76 616c 7565 203d 2073 656c 662e  lf.value = self.
-0001d600: 6c6f 635b 6e61 6d65 5b30 5d5d 0d0a 2020  loc[name[0]]..  
-0001d610: 2020 2020 2020 6966 206e 6f72 6d61 6c69        if normali
-0001d620: 7a65 5f66 7265 715f 6265 7477 2069 7320  ze_freq_betw is 
-0001d630: 6e6f 7420 4e6f 6e65 203a 200d 0a20 2020  not None : ..   
-0001d640: 2020 2020 2020 2020 2020 7365 6c66 2e76            self.v
-0001d650: 616c 7565 203d 7365 6c66 2e6e 6f72 6d61  alue =self.norma
-0001d660: 6c69 7a65 5f66 7265 715f 6265 7477 2829  lize_freq_betw()
-0001d670: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001d680: 2020 2020 7365 6c66 2e6d 6178 2c20 7365      self.max, se
-0001d690: 6c66 2e6d 696e 3d73 656c 662e 7661 6c75  lf.min=self.valu
-0001d6a0: 652e 6d61 7828 292c 2073 656c 662e 7661  e.max(), self.va
-0001d6b0: 6c75 652e 6d69 6e28 290d 0a20 2020 2020  lue.min()..     
-0001d6c0: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-0001d6d0: 2020 2020 2020 200d 0a20 2020 200d 0a20         ..    .. 
-0001d6e0: 2020 2064 6566 206e 6f72 6d61 6c69 7a65     def normalize
-0001d6f0: 5f66 7265 7175 656e 6379 2028 7365 6c66  _frequency (self
-0001d700: 202c 206e 6f72 6d61 6c69 7a65 5f66 7265   , normalize_fre
-0001d710: 715f 6265 7477 3d4e 6f6e 6520 293a 0d0a  q_betw=None ):..
-0001d720: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0001d730: 2020 2020 206d 6574 686f 6420 746f 2069       method to i
-0001d740: 6e74 6572 706f 6c61 7465 2066 7265 7175  nterpolate frequ
-0001d750: 656e 6369 6573 2e0d 0a20 2020 2020 2020  encies...       
-0001d760: 200d 0a20 2020 2020 2020 202e 2e20 6465   ..        .. de
-0001d770: 7072 6563 6174 6564 3a3a 2077 6169 7374  precated:: waist
-0001d780: 5f6d 6574 686f 6420 7769 6c6c 2072 6570  _method will rep
-0001d790: 6c61 6365 6420 6f6e 2063 7320 6d6f 6475  laced on cs modu
-0001d7a0: 6c65 2e0d 0a20 0d0a 2020 2020 2020 2020  le... ..        
-0001d7b0: 5261 6973 6573 0d0a 2020 2020 2020 2020  Raises..        
-0001d7c0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0001d7d0: 2020 2020 4353 6578 0d0a 2020 2020 2020      CSex..      
-0001d7e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001d7f0: 4572 726f 7220 6966 2069 6e70 7574 2061  Error if input a
-0001d800: 7267 756d 656e 7473 2066 6f72 2066 7265  rguments for fre
-0001d810: 7175 656e 6379 200d 0a20 2020 2020 2020  quency ..       
-0001d820: 2020 2020 2020 2020 2069 6e74 6572 706f           interpo
-0001d830: 6c61 7469 6e67 2069 7320 7772 6f6e 672e  lating is wrong.
-0001d840: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-0001d850: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-0001d860: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2020  ----..          
-0001d870: 2020 6172 7261 795f 6c69 6b65 0d0a 2020    array_like..  
-0001d880: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-0001d890: 6571 7565 6e63 7920 6e6f 726d 616c 697a  equency normaliz
-0001d8a0: 6564 2e0d 0a20 2020 2020 2020 2022 2222  ed...        """
-0001d8b0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001d8c0: 2020 2020 6966 206e 6f72 6d61 6c69 7a65      if normalize
-0001d8d0: 5f66 7265 715f 6265 7477 2069 7320 6e6f  _freq_betw is no
-0001d8e0: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-0001d8f0: 2020 2020 2020 2073 656c 662e 6e6f 726d         self.norm
-0001d900: 616c 697a 655f 6672 6571 5f62 6574 7720  alize_freq_betw 
-0001d910: 3d20 6e6f 726d 616c 697a 655f 6672 6571  = normalize_freq
-0001d920: 5f62 6574 770d 0a20 2020 2020 2020 200d  _betw..        .
-0001d930: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001d940: 2e6e 6f72 6d61 6c69 7a65 5f66 7265 715f  .normalize_freq_
-0001d950: 6265 7477 2069 7320 6e6f 7420 4e6f 6e65  betw is not None
-0001d960: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-0001d970: 2069 6620 7479 7065 2873 656c 662e 6e6f   if type(self.no
-0001d980: 726d 616c 697a 655f 6672 6571 5f62 6574  rmalize_freq_bet
-0001d990: 7729 203d 3d74 7570 6c65 203a 0d0a 2020  w) ==tuple :..  
-0001d9a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001d9b0: 6c66 2e6e 6f72 6d61 6c69 7a65 5f66 7265  lf.normalize_fre
-0001d9c0: 715f 6265 7477 203d 6c69 7374 2873 656c  q_betw =list(sel
-0001d9d0: 662e 6e6f 726d 616c 697a 655f 6672 6571  f.normalize_freq
-0001d9e0: 5f62 6574 7729 0d0a 2020 2020 2020 2020  _betw)..        
-0001d9f0: 2020 2020 2020 2020 7472 7920 3a0d 0a20          try :.. 
-0001da00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da10: 2020 2073 656c 662e 6e6f 726d 616c 697a     self.normaliz
-0001da20: 655f 6672 6571 5f62 6574 7720 3d5b 696e  e_freq_betw =[in
-0001da30: 7428 7373 2920 0d0a 2020 2020 2020 2020  t(ss) ..        
-0001da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da60: 2020 2020 2020 2066 6f72 2073 7320 696e         for ss in
-0001da70: 2073 656c 662e 6e6f 726d 616c 697a 655f   self.normalize_
-0001da80: 6672 6571 5f62 6574 775d 0d0a 2020 2020  freq_betw]..    
-0001da90: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0001daa0: 7074 203a 0d0a 2020 2020 2020 2020 2020  pt :..          
-0001dab0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0001dac0: 6c6f 6767 696e 672e 7761 726e 2028 0d0a  logging.warn (..
-0001dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dae0: 2020 2020 2020 2020 2249 6e70 7574 2069          "Input i
-0001daf0: 6e74 6572 706f 6c61 7465 6420 6172 6775  nterpolated argu
-0001db00: 6d65 6e74 7320 6172 6520 7772 6f6e 6721  ments are wrong!
-0001db10: 2061 7267 756d 656e 7473 2022 0d0a 2020   arguments "..  
-0001db20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db30: 2020 2020 2020 2274 7970 6520 6d75 7374        "type must
-0001db40: 2061 206c 6973 7420 6f66 2069 6e74 6567   a list of integ
-0001db50: 6572 732e 2022 290d 0a20 2020 2020 2020  ers. ")..       
-0001db60: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001db70: 7365 2043 5365 782e 7079 4353 414d 5445  se CSex.pyCSAMTE
-0001db80: 7272 6f72 5f69 6e70 7574 6172 6775 6d65  rror_inputargume
-0001db90: 6e74 7328 0d0a 2020 2020 2020 2020 2020  nts(..          
-0001dba0: 2020 2020 2020 2020 2020 2020 2020 2249                "I
-0001dbb0: 6e70 7574 2076 616c 7565 206f 6620 6672  nput value of fr
-0001dbc0: 6571 7565 6e63 7920 6973 2077 726f 6e67  equency is wrong
-0001dbd0: 2e20 4d75 7374 2062 6522 0d0a 2020 2020  . Must be"..    
-0001dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dbf0: 2020 2020 2022 2061 206c 6973 7420 6f66       " a list of
-0001dc00: 2069 6e74 6567 6572 732e 2229 0d0a 2020   integers.")..  
-0001dc10: 2020 2020 2020 2020 2020 6c65 6e67 685f            lengh_
-0001dc20: 696e 7465 7270 203d 6e70 2e6c 696e 7370  interp =np.linsp
-0001dc30: 6163 6528 7365 6c66 2e6e 6f72 6d61 6c69  ace(self.normali
-0001dc40: 7a65 5f66 7265 715f 6265 7477 5b30 5d2c  ze_freq_betw[0],
-0001dc50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001dc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc70: 2020 2020 2020 2020 7365 6c66 2e6e 6f72          self.nor
-0001dc80: 6d61 6c69 7a65 5f66 7265 715f 6265 7477  malize_freq_betw
-0001dc90: 5b31 5d2c 0d0a 2020 2020 2020 2020 2020  [1],..          
-0001dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001dcc0: 2e6e 6f72 6d61 6c69 7a65 5f66 7265 715f  .normalize_freq_
-0001dcd0: 6265 7477 5b32 5d29 0d0a 2020 2020 2020  betw[2])..      
-0001dce0: 2020 6672 6571 5f6e 6577 3d6e 702e 706f    freq_new=np.po
-0001dcf0: 7765 7228 3130 2c20 6c65 6e67 685f 696e  wer(10, lengh_in
-0001dd00: 7465 7270 290d 0a20 2020 2020 2020 2023  terp)..        #
-0001dd10: 2072 616e 6765 2076 616c 7565 2070 726f   range value pro
-0001dd20: 7669 6465 2069 6620 7661 6c75 6520 6e6f  vide if value no
-0001dd30: 7420 696e 206f 7264 6572 202e 2020 0d0a  t in order .  ..
-0001dd40: 2020 2020 2020 2020 6672 6571 5f6e 6577          freq_new
-0001dd50: 2e73 6f72 7428 290d 0a20 2020 2020 2020  .sort()..       
-0001dd60: 2023 2066 7265 715f 6e65 773d 6675 6e63   # freq_new=func
-0001dd70: 2e69 6e74 6572 706f 6c5f 7363 6970 7928  .interpol_scipy(
-0001dd80: 785f 7661 6c75 653d 6e70 2e61 7272 6179  x_value=np.array
-0001dd90: 280d 0a20 2020 2020 2020 2023 2020 205b  (..        #   [
-0001dda0: 6969 2066 6f72 2069 6920 696e 2072 616e  ii for ii in ran
-0001ddb0: 6765 2028 7365 6c66 2e6e 756d 6672 6571  ge (self.numfreq
-0001ddc0: 295d 292c 0d0a 2020 2020 2020 2020 2320  )]),..        # 
-0001ddd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dde0: 2020 2020 2020 2079 5f76 616c 7565 203d         y_value =
-0001ddf0: 7365 6c66 2e76 6163 6f75 6e74 5f66 7265  self.vacount_fre
-0001de00: 712c 2078 5f6e 6577 3d29 0d0a 2020 2020  q, x_new=)..    
-0001de10: 2020 2020 7265 7475 726e 2066 7265 715f      return freq_
-0001de20: 6e65 770d 0a20 2020 2020 2020 200d 0a0d  new..        ...
-0001de30: 0a63 6c61 7373 2043 6f6d 7020 286f 626a  .class Comp (obj
-0001de40: 6563 7429 3a0d 0a20 2020 2022 2222 0d0a  ect):..    """..
-0001de50: 2020 2020 436f 6d70 6f6e 656e 7473 206d      Components m
-0001de60: 6561 7375 7265 640d 0a20 2020 200d 0a20  easured..    .. 
-0001de70: 2020 2048 6f6c 6473 2074 6865 2066 6f6c     Holds the fol
-0001de80: 6c6f 7769 6e67 2069 6e66 6f72 6d61 7469  lowing informati
-0001de90: 6f6e 3a0d 0a20 2020 2020 2020 2020 0d0a  on:..         ..
-0001dea0: 2020 2020 4172 6775 6d65 6e74 7320 0d0a      Arguments ..
-0001deb0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-0001dec0: 2020 2020 2020 2020 2a2a 636f 6d70 5f6e          **comp_n
-0001ded0: 616d 652a 2a20 3a20 7374 720d 0a20 2020  ame** : str..   
-0001dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001def0: 2020 2020 7061 7468 2074 6f20 6176 6720      path to avg 
-0001df00: 6669 6c65 6e61 6d65 200d 0a20 2020 2020  filename ..     
-0001df10: 2020 202a 2a6e 6577 5f63 6f6d 706f 6e65     **new_compone
-0001df20: 6e74 2a2a 203a 7374 7220 200d 0a20 2020  nt** :str  ..   
-0001df30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df40: 2020 2020 636f 6d70 6f6e 656e 7420 7479      component ty
-0001df50: 7065 2077 6869 6368 2064 6174 6120 7769  pe which data wi
-0001df60: 6c6c 2061 6371 7569 7265 6420 2e20 6d61  ll acquired . ma
-0001df70: 6b65 2073 7572 6520 0d0a 2020 2020 2020  ke sure ..      
-0001df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df90: 206f 6e63 6520 6368 616e 6765 2069 7420   once change it 
-0001dfa0: 2c20 7468 6520 6d65 7468 6f64 2074 6f20  , the method to 
-0001dfb0: 6361 6c63 756c 6174 6520 696d 7065 6461  calculate impeda
-0001dfc0: 6e64 6520 5a20 616e 6420 0d0a 2020 2020  nde Z and ..    
-0001dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dfe0: 2020 2072 6f74 6174 696e 6720 616e 676c     rotating angl
-0001dff0: 6520 7769 6c6c 2061 6c73 6f20 6368 616e  e will also chan
-0001e000: 6765 2074 6f0d 0a20 2020 2020 2020 2020  ge to..         
-0001e010: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0001e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e030: 2020 2020 2020 202d 2045 7848 7920 5a78         - ExHy Zx
-0001e040: 7920 2845 782f 4879 290d 0a20 2020 2020  y (Ex/Hy)..     
-0001e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e060: 2020 2d20 4579 487a 205a 7978 2028 4579    - EyHz Zyx (Ey
-0001e070: 2f48 7829 0d0a 2020 2020 2020 2020 2020  /Hx)..          
-0001e080: 2020 2020 2020 2020 2020 2020 202d 2045               - E
-0001e090: 7948 7920 5a79 7920 2845 792f 4879 290d  yHy Zyy (Ey/Hy).
-0001e0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e0b0: 2020 2020 2020 2020 2d20 4578 4878 205a          - ExHx Z
-0001e0c0: 7878 2028 4578 2f48 7829 0d0a 0d0a 2020  xx (Ex/Hx)....  
-0001e0d0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-0001e0e0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d20  ===  ========== 
-0001e0f0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-0001e100: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001e110: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
-0001e120: 2020 2041 7474 7269 6275 7465 7320 2020     Attributes   
-0001e130: 2020 2020 2020 5479 7065 2020 2020 2020        Type      
-0001e140: 2020 4578 706c 616e 6174 696f 6e0d 0a20    Explanation.. 
-0001e150: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
-0001e160: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-0001e170: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-0001e180: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001e190: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-0001e1a0: 2020 2020 6e61 6d65 2020 2020 2020 2020      name        
-0001e1b0: 2020 2020 2020 2073 7472 2020 2020 2020         str      
-0001e1c0: 2020 2020 6e61 6d65 206f 6620 636f 6d70      name of comp
-0001e1d0: 6f6e 656e 7473 2077 696c 6c20 6669 6c6c  onents will fill
-0001e1e0: 6564 2061 7574 6f6d 6174 6963 616c 6c79  ed automatically
-0001e1f0: 0d0a 2020 2020 6c65 6e67 7468 2020 2020  ..    length    
-0001e200: 2020 2020 2020 2020 2066 6c6f 6174 2020           float  
-0001e210: 2020 2020 2020 6c65 6e67 6874 206f 6620        lenght of 
-0001e220: 7468 6520 7375 7276 6579 206c 696e 6573  the survey lines
-0001e230: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
-0001e240: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-0001e250: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-0001e260: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001e270: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001e280: 3d3d 0d0a 0d0a 2020 2020 4d6f 7265 2061  ==....    More a
-0001e290: 7474 7269 6275 7465 7320 6361 6e20 6265  ttributes can be
-0001e2a0: 2061 6464 6564 2062 7920 696e 7075 7469   added by inputi
-0001e2b0: 6e67 2061 206b 6579 2077 6f72 6420 6469  ng a key word di
-0001e2c0: 6374 696f 6e61 7279 0d0a 2020 2020 0d0a  ctionary..    ..
-0001e2d0: 2020 2020 3a45 7861 6d70 6c65 3a0d 0a20      :Example:.. 
-0001e2e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001e2f0: 203e 3e3e 2066 726f 6d20 7079 6373 616d   >>> from pycsam
-0001e300: 742e 6666 2e63 6f72 652e 6176 6720 696d  t.ff.core.avg im
-0001e310: 706f 7274 2043 6f6d 700d 0a20 2020 2020  port Comp..     
-0001e320: 2020 203e 3e3e 2070 6174 683d 6f73 2e70     >>> path=os.p
-0001e330: 6174 682e 6a6f 696e 286f 732e 656e 7669  ath.join(os.envi
-0001e340: 726f 6e5b 2270 7943 5341 4d54 225d 2c20  ron["pyCSAMT"], 
-0001e350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001e360: 2020 2020 2020 2020 2020 2020 2770 7963              'pyc
-0001e370: 7361 6d74 272c 2022 6461 7461 222c 2022  samt', "data", "
-0001e380: 4b31 2e41 5647 2229 0d0a 2020 2020 2020  K1.AVG")..      
-0001e390: 2020 3e3e 3e20 636f 6d70 6f6e 656e 743d    >>> component=
-0001e3a0: 436f 6d70 2870 6174 682c 2063 6f6d 706f  Comp(path, compo
-0001e3b0: 6e65 6e74 5f6e 616d 653d 2745 7948 7827  nent_name='EyHx'
-0001e3c0: 290d 0a20 2020 2020 2020 203e 3e3e 2070  )..        >>> p
-0001e3d0: 7269 6e74 2863 6f6d 706f 6e65 6e74 2e6e  rint(component.n
-0001e3e0: 616d 6529 0d0a 2020 2020 2222 220d 0a20  ame)..    """.. 
-0001e3f0: 2020 2063 6f6d 706f 6e65 6e74 5f74 7970     component_typ
-0001e400: 6520 3d5b 2745 7848 7927 2c20 2245 7948  e =['ExHy', "EyH
-0001e410: 7822 2c20 2745 7948 7927 2c20 2745 7848  x", 'EyHy', 'ExH
-0001e420: 7827 5d0d 0a20 2020 200d 0a20 2020 2064  x']..    ..    d
-0001e430: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-0001e440: 2c20 636f 6d70 5f6e 616d 6520 3d4e 6f6e  , comp_name =Non
-0001e450: 6520 2c20 202a 2a6b 7761 7267 7329 3a20  e ,  **kwargs): 
-0001e460: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-0001e470: 2e6e 616d 6520 3d63 6f6d 705f 6e61 6d65  .name =comp_name
-0001e480: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001e490: 2020 2020 7365 6c66 2e6e 6577 5f63 6f6d      self.new_com
-0001e4a0: 703d 6b77 6172 6773 2e70 6f70 2827 636f  p=kwargs.pop('co
-0001e4b0: 6d70 6f6e 656e 745f 6e61 6d65 272c 204e  mponent_name', N
-0001e4c0: 6f6e 6529 0d0a 2020 2020 2020 2020 6966  one)..        if
-0001e4d0: 2073 656c 662e 6e65 775f 636f 6d70 2069   self.new_comp i
-0001e4e0: 7320 6e6f 7420 4e6f 6e65 203a 0d0a 2020  s not None :..  
-0001e4f0: 2020 2020 2020 2020 2020 6966 2074 7970            if typ
-0001e500: 6520 2873 656c 662e 6e65 775f 636f 6d70  e (self.new_comp
-0001e510: 2920 6973 2073 7472 203a 0d0a 2020 2020  ) is str :..    
-0001e520: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001e530: 656c 662e 6e65 775f 636f 6d70 2069 6e20  elf.new_comp in 
-0001e540: 7365 6c66 2e63 6f6d 706f 6e65 6e74 5f74  self.component_t
-0001e550: 7970 6520 3a0d 0a20 2020 2020 2020 2020  ype :..         
-0001e560: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001e570: 6e61 6d65 203d 7365 6c66 2e6e 6577 5f63  name =self.new_c
-0001e580: 6f6d 700d 0a20 2020 2020 2020 2020 2020  omp..           
-0001e590: 2020 2020 2065 6c73 6520 3a20 0d0a 2020       else : ..  
+0001c6c0: 2020 2020 2020 2020 2069 6e74 6572 706f           interpo
+0001c6d0: 6c61 7465 6420 3a20 3420 2d2d 3e20 3130  lated : 4 --> 10
+0001c6e0: 2865 7870 2934 0d0a 2020 2020 2020 2020  (exp)4..        
+0001c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c710: 6e66 7265 712d 206e 756d 6265 7220 6f66  nfreq- number of
+0001c720: 2066 7265 7175 656e 6379 2020 3a20 6567   frequency  : eg
+0001c730: 203a 2031 3720 0d0a 2020 2020 2020 2020   : 17 ..        
+0001c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c760: 2a44 6566 6175 6c74 2a20 6973 204e 6f6e  *Default* is Non
+0001c770: 6520 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d  e ..    ========
+0001c780: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==============  
+0001c790: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
+0001c7a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001c7b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001c7c0: 3d3d 3d0d 0a0d 0a20 2020 204d 6f72 6520  ===....    More 
+0001c7d0: 6174 7472 6962 7574 6573 2063 616e 2062  attributes can b
+0001c7e0: 6520 6164 6465 6420 6279 2069 6e70 7574  e added by input
+0001c7f0: 696e 6720 6120 6b65 7920 776f 7264 2064  ing a key word d
+0001c800: 6963 7469 6f6e 6172 790d 0a0d 0a20 2020  ictionary....   
+0001c810: 203a 4578 616d 706c 653a 0d0a 2020 2020   :Example:..    
+0001c820: 2020 2020 0d0a 2020 2020 2020 2020 3e3e      ..        >>
+0001c830: 3e20 6672 6f6d 2070 7963 7361 6d74 2e63  > from pycsamt.c
+0001c840: 6f72 652e 6176 6720 696d 706f 7274 2041  ore.avg import A
+0001c850: 7667 0d0a 2020 2020 2020 2020 3e3e 3e20  vg..        >>> 
+0001c860: 7061 7468 3d6f 732e 7061 7468 2e6a 6f69  path=os.path.joi
+0001c870: 6e28 6f73 2e65 6e76 6972 6f6e 5b22 7079  n(os.environ["py
+0001c880: 4353 414d 5422 5d2c 200d 0a20 2020 2020  CSAMT"], ..     
+0001c890: 2020 2020 2020 2020 2022 6461 7461 222c           "data",
+0001c8a0: 2022 6176 6722 2c20 224b 312e 4156 4722   "avg", "K1.AVG"
+0001c8b0: 290d 0a20 2020 2020 2020 203e 3e3e 2066  )..        >>> f
+0001c8c0: 7265 715f 6f62 6a3d 4176 6728 7061 7468  req_obj=Avg(path
+0001c8d0: 290d 0a20 2020 2020 2020 203e 3e3e 2066  )..        >>> f
+0001c8e0: 7265 715f 6f62 6a20 3d61 7667 5f6f 626a  req_obj =avg_obj
+0001c8f0: 2e44 6174 615f 7365 6374 696f 6e2e 4672  .Data_section.Fr
+0001c900: 6571 7565 6e63 792e 6c6f 635b 2753 3037  equency.loc['S07
+0001c910: 275d 0d0a 2020 2020 2020 2020 2e2e 2e20  ']..        ... 
+0001c920: 7072 696e 7428 6672 6571 5f6f 626a 290d  print(freq_obj).
+0001c930: 0a20 2020 2022 2222 0d0a 2020 2020 0d0a  .    """..    ..
+0001c940: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0001c950: 2873 656c 662c 2066 7265 715f 6172 7261  (self, freq_arra
+0001c960: 7920 3d4e 6f6e 652c 200d 0a20 2020 2020  y =None, ..     
+0001c970: 2020 2020 2020 2020 2020 2020 6e6f 726d              norm
+0001c980: 616c 697a 655f 6672 6571 5f62 6574 7720  alize_freq_betw 
+0001c990: 3d4e 6f6e 652c 2020 2a2a 6b77 6172 6773  =None,  **kwargs
+0001c9a0: 293a 0d0a 0d0a 2020 2020 2020 2020 7365  ):....        se
+0001c9b0: 6c66 2e5f 6672 6571 5f61 7272 6179 203d  lf._freq_array =
+0001c9c0: 6672 6571 5f61 7272 6179 200d 0a20 2020  freq_array ..   
+0001c9d0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+0001c9e0: 656c 662e 6e6f 726d 616c 697a 655f 6672  elf.normalize_fr
+0001c9f0: 6571 5f62 6574 773d 6b77 6172 6773 2e70  eq_betw=kwargs.p
+0001ca00: 6f70 2827 6e6f 726d 616c 697a 655f 6672  op('normalize_fr
+0001ca10: 6571 5f62 6574 7727 2c20 4e6f 6e65 2029  eq_betw', None )
+0001ca20: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
+0001ca30: 616c 7565 203d 4e6f 6e65 200d 0a20 2020  alue =None ..   
+0001ca40: 2020 2020 2073 656c 662e 6d69 6e3d 4e6f       self.min=No
+0001ca50: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
+0001ca60: 662e 6d61 783d 4e6f 6e65 200d 0a20 2020  f.max=None ..   
+0001ca70: 2020 2020 2073 656c 662e 6e75 6d66 7265       self.numfre
+0001ca80: 713d 4e6f 6e65 200d 0a20 2020 2020 2020  q=None ..       
+0001ca90: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0001caa0: 2020 2020 2066 6f72 206b 6579 7320 696e       for keys in
+0001cab0: 206c 6973 7420 286b 7761 7267 732e 6b65   list (kwargs.ke
+0001cac0: 7973 2829 293a 200d 0a20 2020 2020 2020  ys()): ..       
+0001cad0: 2020 2020 2073 6574 6174 7472 2873 656c       setattr(sel
+0001cae0: 662c 206b 6579 732c 206b 7761 7267 735b  f, keys, kwargs[
+0001caf0: 6b65 7973 5d29 0d0a 2020 2020 2020 2020  keys])..        
+0001cb00: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+0001cb10: 2073 656c 662e 5f66 7265 715f 6172 7261   self._freq_arra
+0001cb20: 7920 6973 206e 6f74 204e 6f6e 6520 3a20  y is not None : 
+0001cb30: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0001cb40: 6c66 2e5f 7365 745f 6672 6571 7565 6e63  lf._set_frequenc
+0001cb50: 7928 290d 0a20 2020 2020 2020 200d 0a20  y()..        .. 
+0001cb60: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0001cb70: 2064 6566 205f 7365 745f 6672 6571 7565   def _set_freque
+0001cb80: 6e63 7920 2873 656c 662c 2066 7265 715f  ncy (self, freq_
+0001cb90: 6172 7261 7920 3d4e 6f6e 652c 206e 6f72  array =None, nor
+0001cba0: 6d61 6c69 7a65 5f66 7265 715f 6265 7477  malize_freq_betw
+0001cbb0: 203d 204e 6f6e 6520 293a 0d0a 2020 2020   = None ):..    
+0001cbc0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0001cbd0: 204d 6574 686f 6420 746f 2073 6574 2066   Method to set f
+0001cbe0: 7265 7175 656e 6379 2061 6363 6f72 6469  requency accordi
+0001cbf0: 6e67 2074 6f20 6561 6368 2073 7461 7469  ng to each stati
+0001cc00: 6f6e 2e0d 0a0d 0a20 2020 2020 2020 2050  on.....        P
+0001cc10: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0001cc20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0001cc30: 2020 2020 2020 2020 2020 202a 2066 7265             * fre
+0001cc40: 715f 6172 7261 7920 3a20 6e70 2e6e 6461  q_array : np.nda
+0001cc50: 7272 6179 286e 6461 7272 6179 2c20 3129  rray(ndarray, 1)
+0001cc60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001cc70: 2020 2020 2020 2020 2020 6672 6571 7565            freque
+0001cc80: 6e63 7920 6461 7461 2070 726f 7669 6465  ncy data provide
+0001cc90: 6420 2e20 5468 6520 6465 6661 756c 7420  d . The default 
+0001cca0: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
+0001ccb0: 2020 2020 2020 2a20 6e6f 726d 616c 697a        * normaliz
+0001ccc0: 655f 6672 6571 5f62 6574 7720 3a20 6c69  e_freq_betw : li
+0001ccd0: 7374 200d 0a20 2020 2020 2020 2020 2020  st ..           
+0001cce0: 2020 2020 2020 2020 2020 2020 206c 6973               lis
+0001ccf0: 7420 6f66 2066 7265 7175 656e 6379 2072  t of frequency r
+0001cd00: 616e 6765 2074 6f20 6e6f 726d 616c 697a  ange to normaliz
+0001cd10: 652c 206f 7074 696f 6e61 6c2e 200d 0a20  e, optional. .. 
+0001cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd30: 2020 2020 2020 2054 6865 202a 6465 6661         The *defa
+0001cd40: 756c 742a 2069 7320 4e6f 6e65 2e0d 0a20  ult* is None... 
+0001cd50: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0001cd60: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
+0001cd70: 2020 2020 2020 2020 6966 2066 7265 715f          if freq_
+0001cd80: 6172 7261 7920 6973 206e 6f74 204e 6f6e  array is not Non
+0001cd90: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+0001cda0: 2020 7365 6c66 2e5f 6672 6571 5f61 7272    self._freq_arr
+0001cdb0: 6179 203d 6672 6571 5f61 7272 6179 200d  ay =freq_array .
+0001cdc0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0001cdd0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0001cde0: 6672 6571 5f61 7272 6179 2069 7320 4e6f  freq_array is No
+0001cdf0: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
+0001ce00: 2020 2072 6169 7365 2046 7265 7175 656e     raise Frequen
+0001ce10: 6379 4572 726f 7228 274e 6f20 4672 6571  cyError('No Freq
+0001ce20: 7565 6e63 7920 4461 7461 2066 6f75 6e64  uency Data found
+0001ce30: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+0001ce40: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
+0001ce50: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
+0001ce60: 7265 715f 6172 7261 7920 3d6e 702e 6172  req_array =np.ar
+0001ce70: 7261 7928 5b6e 702e 666c 6f61 7428 6b6b  ray([np.float(kk
+0001ce80: 2920 666f 7220 6b6b 2069 6e20 7365 6c66  ) for kk in self
+0001ce90: 2e5f 6672 6571 5f61 7272 6179 5d29 2020  ._freq_array])  
+0001cea0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001ceb0: 2020 2020 232d 2d3e 2072 6561 6420 6672      #--> read fr
+0001cec0: 6571 7565 6e63 7920 6672 6f6d 2041 5647  equency from AVG
+0001ced0: 2064 6174 6120 6669 6c65 203a 200d 0a20   data file : .. 
+0001cee0: 2020 2020 2020 2076 6163 6f75 6e74 5f66         vacount_f
+0001cef0: 7265 712c 2066 7265 715f 7265 7065 6174  req, freq_repeat
+0001cf00: 203d 6e70 2e75 6e69 7175 6528 7365 6c66   =np.unique(self
+0001cf10: 2e5f 6672 6571 5f61 7272 6179 2c20 0d0a  ._freq_array, ..
+0001cf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf40: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001cf50: 7572 6e5f 636f 756e 7473 3d54 7275 6529  urn_counts=True)
+0001cf60: 0d0a 0d0a 2020 2020 2020 2020 0d0a 2020  ....        ..  
+0001cf70: 2020 2020 2020 7365 6c66 2e6e 756d 6672        self.numfr
+0001cf80: 6571 203d 2076 6163 6f75 6e74 5f66 7265  eq = vacount_fre
+0001cf90: 712e 7369 7a65 0d0a 2020 2020 2020 2020  q.size..        
+0001cfa0: 6966 206e 702e 616c 6c28 6672 6571 5f72  if np.all(freq_r
+0001cfb0: 6570 6561 742c 2061 7869 7320 3d30 2920  epeat, axis =0) 
+0001cfc0: 213d 2054 7275 6520 3a20 0d0a 2020 2020  != True : ..    
+0001cfd0: 2020 2020 2020 2020 7261 6973 6520 4672          raise Fr
+0001cfe0: 6571 7565 6e63 7945 7272 6f72 280d 0a20  equencyError(.. 
+0001cff0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001d000: 5072 6f62 6c65 6d20 6f63 6375 7265 6420  Problem occured 
+0001d010: 7768 656e 2072 6561 6469 6e67 2066 7265  when reading fre
+0001d020: 7175 656e 6379 2064 6174 612e 270d 0a20  quency data.'.. 
+0001d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d040: 2741 6c6c 2066 7265 7175 656e 6379 206f  'All frequency o
+0001d050: 6e20 4176 6766 696c 6520 4d75 7374 2062  n Avgfile Must b
+0001d060: 6520 7468 6520 7361 6d65 206c 656e 6774  e the same lengt
+0001d070: 682e 2027 290d 0a20 2020 2020 2020 2023  h. ')..        #
+0001d080: 2073 656c 662e 7661 6c75 6520 3d76 6163   self.value =vac
+0001d090: 6f75 6e74 5f66 7265 710d 0a20 2020 2020  ount_freq..     
+0001d0a0: 2020 200d 0a20 2020 2020 2020 2023 2069     ..        # i
+0001d0b0: 6620 6e6f 726d 616c 697a 655f 6672 6571  f normalize_freq
+0001d0c0: 5f62 6574 7720 6973 206e 6f74 204e 6f6e  _betw is not Non
+0001d0d0: 6520 3a20 0d0a 2020 2020 2020 2020 2320  e : ..        # 
+0001d0e0: 2020 2020 2073 656c 662e 7661 6c75 6520       self.value 
+0001d0f0: 3d73 656c 662e 6e6f 726d 616c 697a 655f  =self.normalize_
+0001d100: 6672 6571 5f62 6574 7728 290d 0a20 2020  freq_betw()..   
+0001d110: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+0001d120: 2073 656c 662e 6d61 782c 2073 656c 662e   self.max, self.
+0001d130: 6d69 6e3d 7365 6c66 2e76 616c 7565 2e6d  min=self.value.m
+0001d140: 6178 2829 2c20 7365 6c66 2e76 616c 7565  ax(), self.value
+0001d150: 2e6d 696e 2829 0d0a 2020 0d0a 2020 2020  .min()..  ..    
+0001d160: 2020 2020 7472 756e 6361 7465 645f 6672      truncated_fr
+0001d170: 6571 203d 5a63 632e 7472 756e 6361 7465  eq =Zcc.truncate
+0001d180: 645f 6461 7461 2820 6461 7461 203d 7365  d_data( data =se
+0001d190: 6c66 2e5f 6672 6571 5f61 7272 6179 202c  lf._freq_array ,
+0001d1a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1c0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+0001d1d0: 5f6f 665f 7265 6363 7572 656e 6365 3d73  _of_reccurence=s
+0001d1e0: 656c 662e 6e75 6d66 7265 7120 290d 0a20  elf.numfreq ).. 
+0001d1f0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001d200: 206e 616d 652c 2070 6f6c 796e 616d 6520   name, polyname 
+0001d210: 3d20 5a63 632e 5f6e 756d 6265 7269 6e67  = Zcc._numbering
+0001d220: 5f73 7461 7469 6f6e 280d 0a20 2020 2020  _station(..     
+0001d230: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
+0001d240: 5f73 7461 7469 6f6e 3d66 7265 715f 7265  _station=freq_re
+0001d250: 7065 6174 5b30 5d2c 200d 0a20 2020 2020  peat[0], ..     
+0001d260: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
+0001d270: 5f66 7265 7120 3d73 656c 662e 6e75 6d66  _freq =self.numf
+0001d280: 7265 7129 0d0a 2020 2020 2020 2020 0d0a  req)..        ..
+0001d290: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+0001d2a0: 6c6f 6320 3d7b 206b 6579 3a76 616c 7565  loc ={ key:value
+0001d2b0: 2066 6f72 206b 6579 2c20 7661 6c75 6520   for key, value 
+0001d2c0: 696e 207a 6970 286e 616d 652c 2074 7275  in zip(name, tru
+0001d2d0: 6e63 6174 6564 5f66 7265 7120 297d 0d0a  ncated_freq )}..
+0001d2e0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001d2f0: 2020 7365 6c66 2e76 616c 7565 203d 2073    self.value = s
+0001d300: 656c 662e 6c6f 635b 6e61 6d65 5b30 5d5d  elf.loc[name[0]]
+0001d310: 0d0a 2020 2020 2020 2020 6966 206e 6f72  ..        if nor
+0001d320: 6d61 6c69 7a65 5f66 7265 715f 6265 7477  malize_freq_betw
+0001d330: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
+0001d340: 0a20 2020 2020 2020 2020 2020 2020 7365  .             se
+0001d350: 6c66 2e76 616c 7565 203d 7365 6c66 2e6e  lf.value =self.n
+0001d360: 6f72 6d61 6c69 7a65 5f66 7265 715f 6265  ormalize_freq_be
+0001d370: 7477 2829 0d0a 2020 2020 2020 2020 0d0a  tw()..        ..
+0001d380: 2020 2020 2020 2020 7365 6c66 2e6d 6178          self.max
+0001d390: 2c20 7365 6c66 2e6d 696e 3d73 656c 662e  , self.min=self.
+0001d3a0: 7661 6c75 652e 6d61 7828 292c 2073 656c  value.max(), sel
+0001d3b0: 662e 7661 6c75 652e 6d69 6e28 290d 0a20  f.value.min().. 
+0001d3c0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001d3d0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0001d3e0: 200d 0a20 2020 2064 6566 206e 6f72 6d61   ..    def norma
+0001d3f0: 6c69 7a65 5f66 7265 7175 656e 6379 2028  lize_frequency (
+0001d400: 7365 6c66 202c 206e 6f72 6d61 6c69 7a65  self , normalize
+0001d410: 5f66 7265 715f 6265 7477 3d4e 6f6e 6520  _freq_betw=None 
+0001d420: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
+0001d430: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
+0001d440: 746f 2069 6e74 6572 706f 6c61 7465 2066  to interpolate f
+0001d450: 7265 7175 656e 6369 6573 2e0d 0a20 2020  requencies...   
+0001d460: 2020 2020 200d 0a20 2020 2020 2020 202e       ..        .
+0001d470: 2e20 6465 7072 6563 6174 6564 3a3a 2077  . deprecated:: w
+0001d480: 6169 7374 5f6d 6574 686f 6420 7769 6c6c  aist_method will
+0001d490: 2072 6570 6c61 6365 6420 6f6e 2063 7320   replaced on cs 
+0001d4a0: 6d6f 6475 6c65 2e0d 0a20 0d0a 2020 2020  module... ..    
+0001d4b0: 2020 2020 5261 6973 6573 0d0a 2020 2020      Raises..    
+0001d4c0: 2020 2020 2d2d 2d2d 2d2d 0d0a 2020 2020      ------..    
+0001d4d0: 2020 2020 2020 2020 4353 6578 0d0a 2020          CSex..  
+0001d4e0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001d4f0: 6973 6520 4572 726f 7220 6966 2069 6e70  ise Error if inp
+0001d500: 7574 2061 7267 756d 656e 7473 2066 6f72  ut arguments for
+0001d510: 2066 7265 7175 656e 6379 200d 0a20 2020   frequency ..   
+0001d520: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+0001d530: 6572 706f 6c61 7469 6e67 2069 7320 7772  erpolating is wr
+0001d540: 6f6e 672e 0d0a 0d0a 2020 2020 2020 2020  ong.....        
+0001d550: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+0001d560: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+0001d570: 2020 2020 2020 6172 7261 795f 6c69 6b65        array_like
+0001d580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d590: 2020 6672 6571 7565 6e63 7920 6e6f 726d    frequency norm
+0001d5a0: 616c 697a 6564 2e0d 0a20 2020 2020 2020  alized...       
+0001d5b0: 2022 2222 0d0a 2020 2020 2020 2020 0d0a   """..        ..
+0001d5c0: 2020 2020 2020 2020 6966 206e 6f72 6d61          if norma
+0001d5d0: 6c69 7a65 5f66 7265 715f 6265 7477 2069  lize_freq_betw i
+0001d5e0: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
+0001d5f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001d600: 6e6f 726d 616c 697a 655f 6672 6571 5f62  normalize_freq_b
+0001d610: 6574 7720 3d20 6e6f 726d 616c 697a 655f  etw = normalize_
+0001d620: 6672 6571 5f62 6574 770d 0a20 2020 2020  freq_betw..     
+0001d630: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+0001d640: 7365 6c66 2e6e 6f72 6d61 6c69 7a65 5f66  self.normalize_f
+0001d650: 7265 715f 6265 7477 2069 7320 6e6f 7420  req_betw is not 
+0001d660: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+0001d670: 2020 2020 2069 6620 7479 7065 2873 656c       if type(sel
+0001d680: 662e 6e6f 726d 616c 697a 655f 6672 6571  f.normalize_freq
+0001d690: 5f62 6574 7729 203d 3d74 7570 6c65 203a  _betw) ==tuple :
+0001d6a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d6b0: 2020 7365 6c66 2e6e 6f72 6d61 6c69 7a65    self.normalize
+0001d6c0: 5f66 7265 715f 6265 7477 203d 6c69 7374  _freq_betw =list
+0001d6d0: 2873 656c 662e 6e6f 726d 616c 697a 655f  (self.normalize_
+0001d6e0: 6672 6571 5f62 6574 7729 0d0a 2020 2020  freq_betw)..    
+0001d6f0: 2020 2020 2020 2020 2020 2020 7472 7920              try 
+0001d700: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001d710: 2020 2020 2020 2073 656c 662e 6e6f 726d         self.norm
+0001d720: 616c 697a 655f 6672 6571 5f62 6574 7720  alize_freq_betw 
+0001d730: 3d5b 696e 7428 7373 2920 0d0a 2020 2020  =[int(ss) ..    
+0001d740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d760: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
+0001d770: 7320 696e 2073 656c 662e 6e6f 726d 616c  s in self.normal
+0001d780: 697a 655f 6672 6571 5f62 6574 775d 0d0a  ize_freq_betw]..
+0001d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7a0: 6578 6365 7074 203a 0d0a 2020 2020 2020  except :..      
+0001d7b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001d7c0: 6c66 2e5f 6c6f 6767 696e 672e 7761 726e  lf._logging.warn
+0001d7d0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+0001d7e0: 2020 2020 2020 2020 2020 2020 2249 6e70              "Inp
+0001d7f0: 7574 2069 6e74 6572 706f 6c61 7465 6420  ut interpolated 
+0001d800: 6172 6775 6d65 6e74 7320 6172 6520 7772  arguments are wr
+0001d810: 6f6e 6721 2061 7267 756d 656e 7473 2022  ong! arguments "
+0001d820: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d830: 2020 2020 2020 2020 2020 2274 7970 6520            "type 
+0001d840: 6d75 7374 2061 206c 6973 7420 6f66 2069  must a list of i
+0001d850: 6e74 6567 6572 732e 2022 290d 0a20 2020  ntegers. ")..   
+0001d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d870: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0001d880: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0001d890: 2020 2020 2020 2020 2020 2022 496e 7075             "Inpu
+0001d8a0: 7420 7661 6c75 6520 6f66 2066 7265 7175  t value of frequ
+0001d8b0: 656e 6379 2069 7320 7772 6f6e 672e 204d  ency is wrong. M
+0001d8c0: 7573 7420 6265 220d 0a20 2020 2020 2020  ust be"..       
+0001d8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d8e0: 2020 2220 6120 6c69 7374 206f 6620 696e    " a list of in
+0001d8f0: 7465 6765 7273 2e22 290d 0a20 2020 2020  tegers.")..     
+0001d900: 2020 2020 2020 206c 656e 6768 5f69 6e74         lengh_int
+0001d910: 6572 7020 3d6e 702e 6c69 6e73 7061 6365  erp =np.linspace
+0001d920: 2873 656c 662e 6e6f 726d 616c 697a 655f  (self.normalize_
+0001d930: 6672 6571 5f62 6574 775b 305d 2c0d 0a20  freq_betw[0],.. 
+0001d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d960: 2020 2020 2073 656c 662e 6e6f 726d 616c       self.normal
+0001d970: 697a 655f 6672 6571 5f62 6574 775b 315d  ize_freq_betw[1]
+0001d980: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0001d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d9a0: 2020 2020 2020 2020 2073 656c 662e 6e6f           self.no
+0001d9b0: 726d 616c 697a 655f 6672 6571 5f62 6574  rmalize_freq_bet
+0001d9c0: 775b 325d 290d 0a20 2020 2020 2020 2066  w[2])..        f
+0001d9d0: 7265 715f 6e65 773d 6e70 2e70 6f77 6572  req_new=np.power
+0001d9e0: 2831 302c 206c 656e 6768 5f69 6e74 6572  (10, lengh_inter
+0001d9f0: 7029 0d0a 2020 2020 2020 2020 2320 7261  p)..        # ra
+0001da00: 6e67 6520 7661 6c75 6520 7072 6f76 6964  nge value provid
+0001da10: 6520 6966 2076 616c 7565 206e 6f74 2069  e if value not i
+0001da20: 6e20 6f72 6465 7220 2e20 200d 0a20 2020  n order .  ..   
+0001da30: 2020 2020 2066 7265 715f 6e65 772e 736f       freq_new.so
+0001da40: 7274 2829 0d0a 2020 2020 2020 2020 2320  rt()..        # 
+0001da50: 6672 6571 5f6e 6577 3d66 756e 632e 696e  freq_new=func.in
+0001da60: 7465 7270 6f6c 5f73 6369 7079 2878 5f76  terpol_scipy(x_v
+0001da70: 616c 7565 3d6e 702e 6172 7261 7928 0d0a  alue=np.array(..
+0001da80: 2020 2020 2020 2020 2320 2020 5b69 6920          #   [ii 
+0001da90: 666f 7220 6969 2069 6e20 7261 6e67 6520  for ii in range 
+0001daa0: 2873 656c 662e 6e75 6d66 7265 7129 5d29  (self.numfreq)])
+0001dab0: 2c0d 0a20 2020 2020 2020 2023 2020 2020  ,..        #    
+0001dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dad0: 2020 2020 795f 7661 6c75 6520 3d73 656c      y_value =sel
+0001dae0: 662e 7661 636f 756e 745f 6672 6571 2c20  f.vacount_freq, 
+0001daf0: 785f 6e65 773d 290d 0a20 2020 2020 2020  x_new=)..       
+0001db00: 2072 6574 7572 6e20 6672 6571 5f6e 6577   return freq_new
+0001db10: 0d0a 2020 2020 2020 2020 0d0a 0d0a 636c  ..        ....cl
+0001db20: 6173 7320 436f 6d70 2028 6f62 6a65 6374  ass Comp (object
+0001db30: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+0001db40: 2043 6f6d 706f 6e65 6e74 7320 6d65 6173   Components meas
+0001db50: 7572 6564 0d0a 2020 2020 0d0a 2020 2020  ured..    ..    
+0001db60: 486f 6c64 7320 7468 6520 666f 6c6c 6f77  Holds the follow
+0001db70: 696e 6720 696e 666f 726d 6174 696f 6e3a  ing information:
+0001db80: 0d0a 2020 2020 2020 2020 200d 0a20 2020  ..         ..   
+0001db90: 2041 7267 756d 656e 7473 200d 0a20 2020   Arguments ..   
+0001dba0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0001dbb0: 2020 2020 202a 2a63 6f6d 705f 6e61 6d65       **comp_name
+0001dbc0: 2a2a 203a 2073 7472 0d0a 2020 2020 2020  ** : str..      
+0001dbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dbe0: 2070 6174 6820 746f 2061 7667 2066 696c   path to avg fil
+0001dbf0: 656e 616d 6520 0d0a 2020 2020 2020 2020  ename ..        
+0001dc00: 2a2a 6e65 775f 636f 6d70 6f6e 656e 742a  **new_component*
+0001dc10: 2a20 3a73 7472 2020 0d0a 2020 2020 2020  * :str  ..      
+0001dc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc30: 2063 6f6d 706f 6e65 6e74 2074 7970 6520   component type 
+0001dc40: 7768 6963 6820 6461 7461 2077 696c 6c20  which data will 
+0001dc50: 6163 7175 6972 6564 202e 206d 616b 6520  acquired . make 
+0001dc60: 7375 7265 200d 0a20 2020 2020 2020 2020  sure ..         
+0001dc70: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
+0001dc80: 6365 2063 6861 6e67 6520 6974 202c 2074  ce change it , t
+0001dc90: 6865 206d 6574 686f 6420 746f 2063 616c  he method to cal
+0001dca0: 6375 6c61 7465 2069 6d70 6564 616e 6465  culate impedande
+0001dcb0: 205a 2061 6e64 200d 0a20 2020 2020 2020   Z and ..       
+0001dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dcd0: 726f 7461 7469 6e67 2061 6e67 6c65 2077  rotating angle w
+0001dce0: 696c 6c20 616c 736f 2063 6861 6e67 6520  ill also change 
+0001dcf0: 746f 0d0a 2020 2020 2020 2020 2020 2020  to..            
+0001dd00: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0001dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd20: 2020 2020 2d20 4578 4879 205a 7879 2028      - ExHy Zxy (
+0001dd30: 4578 2f48 7929 0d0a 2020 2020 2020 2020  Ex/Hy)..        
+0001dd40: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+0001dd50: 2045 7948 7a20 5a79 7820 2845 792f 4878   EyHz Zyx (Ey/Hx
+0001dd60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0001dd70: 2020 2020 2020 2020 2020 2d20 4579 4879            - EyHy
+0001dd80: 205a 7979 2028 4579 2f48 7929 0d0a 2020   Zyy (Ey/Hy)..  
+0001dd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dda0: 2020 2020 202d 2045 7848 7820 5a78 7820       - ExHx Zxx 
+0001ddb0: 2845 782f 4878 290d 0a0d 0a20 2020 203d  (Ex/Hx)....    =
+0001ddc0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001ddd0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d    ==========  ==
+0001dde0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001ddf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001de00: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
+0001de10: 4174 7472 6962 7574 6573 2020 2020 2020  Attributes      
+0001de20: 2020 2054 7970 6520 2020 2020 2020 2045     Type        E
+0001de30: 7870 6c61 6e61 7469 6f6e 0d0a 2020 2020  xplanation..    
+0001de40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001de50: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =  ==========  =
+0001de60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001de70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001de80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+0001de90: 206e 616d 6520 2020 2020 2020 2020 2020   name           
+0001dea0: 2020 2020 7374 7220 2020 2020 2020 2020      str         
+0001deb0: 206e 616d 6520 6f66 2063 6f6d 706f 6e65   name of compone
+0001dec0: 6e74 7320 7769 6c6c 2066 696c 6c65 6420  nts will filled 
+0001ded0: 6175 746f 6d61 7469 6361 6c6c 790d 0a20  automatically.. 
+0001dee0: 2020 206c 656e 6774 6820 2020 2020 2020     length       
+0001def0: 2020 2020 2020 666c 6f61 7420 2020 2020        float     
+0001df00: 2020 206c 656e 6768 7420 6f66 2074 6865     lenght of the
+0001df10: 2073 7572 7665 7920 6c69 6e65 7320 0d0a   survey lines ..
+0001df20: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
+0001df30: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+0001df40: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
+0001df50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001df60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+0001df70: 0a0d 0a20 2020 204d 6f72 6520 6174 7472  ...    More attr
+0001df80: 6962 7574 6573 2063 616e 2062 6520 6164  ibutes can be ad
+0001df90: 6465 6420 6279 2069 6e70 7574 696e 6720  ded by inputing 
+0001dfa0: 6120 6b65 7920 776f 7264 2064 6963 7469  a key word dicti
+0001dfb0: 6f6e 6172 790d 0a20 2020 200d 0a20 2020  onary..    ..   
+0001dfc0: 203a 4578 616d 706c 653a 0d0a 2020 2020   :Example:..    
+0001dfd0: 2020 2020 0d0a 2020 2020 2020 2020 3e3e      ..        >>
+0001dfe0: 3e20 6672 6f6d 2070 7963 7361 6d74 2e63  > from pycsamt.c
+0001dff0: 6f72 652e 6176 6720 696d 706f 7274 2043  ore.avg import C
+0001e000: 6f6d 700d 0a20 2020 2020 2020 203e 3e3e  omp..        >>>
+0001e010: 2070 6174 683d 6f73 2e70 6174 682e 6a6f   path=os.path.jo
+0001e020: 696e 286f 732e 656e 7669 726f 6e5b 2270  in(os.environ["p
+0001e030: 7943 5341 4d54 225d 2c20 0d0a 2020 2020  yCSAMT"], ..    
+0001e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e050: 2020 2020 2020 2770 7963 7361 6d74 272c        'pycsamt',
+0001e060: 2022 6461 7461 222c 2022 4b31 2e41 5647   "data", "K1.AVG
+0001e070: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
+0001e080: 636f 6d70 6f6e 656e 743d 436f 6d70 2870  component=Comp(p
+0001e090: 6174 682c 2063 6f6d 706f 6e65 6e74 5f6e  ath, component_n
+0001e0a0: 616d 653d 2745 7948 7827 290d 0a20 2020  ame='EyHx')..   
+0001e0b0: 2020 2020 203e 3e3e 2070 7269 6e74 2863       >>> print(c
+0001e0c0: 6f6d 706f 6e65 6e74 2e6e 616d 6529 0d0a  omponent.name)..
+0001e0d0: 2020 2020 2222 220d 0a20 2020 2063 6f6d      """..    com
+0001e0e0: 706f 6e65 6e74 5f74 7970 6520 3d5b 2745  ponent_type =['E
+0001e0f0: 7848 7927 2c20 2245 7948 7822 2c20 2745  xHy', "EyHx", 'E
+0001e100: 7948 7927 2c20 2745 7848 7827 5d0d 0a20  yHy', 'ExHx'].. 
+0001e110: 2020 200d 0a20 2020 2064 6566 205f 5f69     ..    def __i
+0001e120: 6e69 745f 5f28 7365 6c66 2c20 636f 6d70  nit__(self, comp
+0001e130: 5f6e 616d 6520 3d4e 6f6e 6520 2c20 202a  _name =None ,  *
+0001e140: 2a6b 7761 7267 7329 3a20 0d0a 0d0a 2020  *kwargs): ....  
+0001e150: 2020 2020 2020 7365 6c66 2e6e 616d 6520        self.name 
+0001e160: 3d63 6f6d 705f 6e61 6d65 0d0a 2020 2020  =comp_name..    
+0001e170: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+0001e180: 6c66 2e6e 6577 5f63 6f6d 703d 6b77 6172  lf.new_comp=kwar
+0001e190: 6773 2e70 6f70 2827 636f 6d70 6f6e 656e  gs.pop('componen
+0001e1a0: 745f 6e61 6d65 272c 204e 6f6e 6529 0d0a  t_name', None)..
+0001e1b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001e1c0: 6e65 775f 636f 6d70 2069 7320 6e6f 7420  new_comp is not 
+0001e1d0: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+0001e1e0: 2020 2020 6966 2074 7970 6520 2873 656c      if type (sel
+0001e1f0: 662e 6e65 775f 636f 6d70 2920 6973 2073  f.new_comp) is s
+0001e200: 7472 203a 0d0a 2020 2020 2020 2020 2020  tr :..          
+0001e210: 2020 2020 2020 6966 2073 656c 662e 6e65        if self.ne
+0001e220: 775f 636f 6d70 2069 6e20 7365 6c66 2e63  w_comp in self.c
+0001e230: 6f6d 706f 6e65 6e74 5f74 7970 6520 3a0d  omponent_type :.
+0001e240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e250: 2020 2020 2073 656c 662e 6e61 6d65 203d       self.name =
+0001e260: 7365 6c66 2e6e 6577 5f63 6f6d 700d 0a20  self.new_comp.. 
+0001e270: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001e280: 6c73 6520 3a20 0d0a 2020 2020 2020 2020  lse : ..        
+0001e290: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001e2a0: 2e5f 6c6f 6767 696e 672e 7761 726e 2028  ._logging.warn (
+0001e2b0: 2743 6f6d 706f 6e65 6e74 2070 726f 7669  'Component provi
+0001e2c0: 6465 6420 6973 2077 726f 6e67 2021 2729  ded is wrong !')
+0001e2d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001e2e0: 2020 2020 2020 5479 7065 4572 726f 7228        TypeError(
+0001e2f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001e300: 2020 2020 2020 2020 2020 2243 6f6d 706f            "Compo
+0001e310: 6e65 6e74 2070 726f 7669 6465 2061 7320  nent provide as 
+0001e320: 6e65 7720 636f 6d70 6f6e 656e 7420 6973  new component is
+0001e330: 2077 726f 6e67 220d 0a20 2020 2020 2020   wrong"..       
+0001e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e350: 2022 6c69 7374 206f 6620 636f 6d70 6f6e   "list of compon
+0001e360: 656e 7473 3a7b 307d 222e 666f 726d 6174  ents:{0}".format
+0001e370: 2873 656c 662e 636f 6d70 6f6e 656e 745f  (self.component_
+0001e380: 7479 7065 2929 0d0a 2020 2020 2020 2020  type))..        
+0001e390: 2020 2020 656c 7365 203a 200d 0a20 2020      else : ..   
+0001e3a0: 2020 2020 2020 2020 2020 2020 2077 6172               war
+0001e3b0: 6e69 6e67 732e 7761 726e 280d 0a20 2020  nings.warn(..   
+0001e3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e3d0: 2022 436f 6d70 6f6e 656e 7473 206d 7573   "Components mus
+0001e3e0: 7420 6265 2061 2073 7472 696e 6720 3a20  t be a string : 
+0001e3f0: 6120 6c69 7374 206f 6620 6172 6775 6d65  a list of argume
+0001e400: 6e74 7320 6265 6c6f 773a 220d 0a20 2020  nts below:"..   
+0001e410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e420: 2020 227b 307d 222e 666f 726d 6174 2873    "{0}".format(s
+0001e430: 656c 662e 636f 6d70 6f6e 656e 745f 7479  elf.component_ty
+0001e440: 7065 2929 0d0a 2020 2020 2020 2020 2020  pe))..          
+0001e450: 2020 2020 2020 5479 7065 4572 726f 7228        TypeError(
+0001e460: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001e470: 2020 2020 2020 2243 6f6d 706f 6e65 6e74        "Component
+0001e480: 2074 7970 6520 6973 2077 726f 6e67 2e20   type is wrong. 
+0001e490: 6d75 7374 2061 2073 7472 696e 672e 220d  must a string.".
+0001e4a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e4b0: 2020 2020 2022 6c69 7374 206f 6620 636f       "list of co
+0001e4c0: 6d70 6f6e 656e 7473 3a7b 307d 222e 666f  mponents:{0}".fo
+0001e4d0: 726d 6174 2873 656c 662e 636f 6d70 6f6e  rmat(self.compon
+0001e4e0: 656e 745f 7479 7065 2929 0d0a 2020 2020  ent_type))..    
+0001e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e500: 0d0a 0d0a 636c 6173 7320 416d 7073 2028  ....class Amps (
+0001e510: 6f62 6a65 6374 293a 200d 0a20 2020 2022  object): ..    "
+0001e520: 2222 0d0a 2020 2020 5371 7561 7265 2d57  ""..    Square-W
+0001e530: 6176 6520 6375 7272 656e 7420 2861 6d70  ave current (amp
+0001e540: 7329 0d0a 2020 2020 0d0a 2020 2020 4172  s)..    ..    Ar
+0001e550: 6775 6d65 6e74 7320 3a0d 0a20 2020 202d  guments :..    -
+0001e560: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0001e570: 2020 202a 2a61 6d70 735f 6172 7261 792a     **amps_array*
+0001e580: 2a20 3a20 6e70 2e6e 6461 7272 6179 2028  * : np.ndarray (
+0001e590: 6e64 6172 7261 792c 2031 290d 0a20 2020  ndarray, 1)..   
 0001e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e5b0: 2020 7365 6c66 2e5f 6c6f 6767 696e 672e    self._logging.
-0001e5c0: 7761 726e 2028 2743 6f6d 706f 6e65 6e74  warn ('Component
-0001e5d0: 2070 726f 7669 6465 6420 6973 2077 726f   provided is wro
-0001e5e0: 6e67 2021 2729 0d0a 2020 2020 2020 2020  ng !')..        
-0001e5f0: 2020 2020 2020 2020 2020 2020 4353 6578              CSex
-0001e600: 2e70 7943 5341 4d54 4572 726f 725f 696e  .pyCSAMTError_in
-0001e610: 7075 7461 7267 756d 656e 7473 280d 0a20  putarguments(.. 
-0001e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e630: 2020 2020 2020 2022 436f 6d70 6f6e 656e         "Componen
-0001e640: 7420 7072 6f76 6964 6520 6173 206e 6577  t provide as new
-0001e650: 2063 6f6d 706f 6e65 6e74 2069 7320 7772   component is wr
-0001e660: 6f6e 6722 0d0a 2020 2020 2020 2020 2020  ong"..          
-0001e670: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-0001e680: 6973 7420 6f66 2063 6f6d 706f 6e65 6e74  ist of component
-0001e690: 733a 7b30 7d22 2e66 6f72 6d61 7428 7365  s:{0}".format(se
-0001e6a0: 6c66 2e63 6f6d 706f 6e65 6e74 5f74 7970  lf.component_typ
-0001e6b0: 6529 290d 0a20 2020 2020 2020 2020 2020  e))..           
-0001e6c0: 2065 6c73 6520 3a20 0d0a 2020 2020 2020   else : ..      
-0001e6d0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-0001e6e0: 6773 2e77 6172 6e28 0d0a 2020 2020 2020  gs.warn(..      
-0001e6f0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
-0001e700: 6f6d 706f 6e65 6e74 7320 6d75 7374 2062  omponents must b
-0001e710: 6520 6120 7374 7269 6e67 203a 2061 206c  e a string : a l
-0001e720: 6973 7420 6f66 2061 7267 756d 656e 7473  ist of arguments
-0001e730: 2062 656c 6f77 3a22 0d0a 2020 2020 2020   below:"..      
-0001e740: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001e750: 7b30 7d22 2e66 6f72 6d61 7428 7365 6c66  {0}".format(self
-0001e760: 2e63 6f6d 706f 6e65 6e74 5f74 7970 6529  .component_type)
-0001e770: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0001e780: 2020 2043 5365 782e 7079 4353 414d 5445     CSex.pyCSAMTE
-0001e790: 7272 6f72 5f69 6e70 7574 6172 6775 6d65  rror_inputargume
-0001e7a0: 6e74 7328 0d0a 2020 2020 2020 2020 2020  nts(..          
-0001e7b0: 2020 2020 2020 2020 2020 2243 6f6d 706f            "Compo
-0001e7c0: 6e65 6e74 2074 7970 6520 6973 2077 726f  nent type is wro
-0001e7d0: 6e67 2e20 6d75 7374 2061 2073 7472 696e  ng. must a strin
-0001e7e0: 672e 220d 0a20 2020 2020 2020 2020 2020  g."..           
-0001e7f0: 2020 2020 2020 2020 2022 6c69 7374 206f           "list o
-0001e800: 6620 636f 6d70 6f6e 656e 7473 3a7b 307d  f components:{0}
-0001e810: 222e 666f 726d 6174 2873 656c 662e 636f  ".format(self.co
-0001e820: 6d70 6f6e 656e 745f 7479 7065 2929 0d0a  mponent_type))..
-0001e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e840: 2020 2020 0d0a 0d0a 636c 6173 7320 416d      ....class Am
-0001e850: 7073 2028 6f62 6a65 6374 293a 200d 0a20  ps (object): .. 
-0001e860: 2020 2022 2222 0d0a 2020 2020 5371 7561     """..    Squa
-0001e870: 7265 2d57 6176 6520 6375 7272 656e 7420  re-Wave current 
-0001e880: 2861 6d70 7329 0d0a 2020 2020 0d0a 2020  (amps)..    ..  
-0001e890: 2020 4172 6775 6d65 6e74 7320 3a0d 0a20    Arguments :.. 
-0001e8a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0001e8b0: 2020 2020 2020 202a 2a61 6d70 735f 6172         **amps_ar
-0001e8c0: 7261 792a 2a20 3a20 6e70 2e6e 6461 7272  ray** : np.ndarr
-0001e8d0: 6179 2028 6e64 6172 7261 792c 2031 290d  ay (ndarray, 1).
-0001e8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e8f0: 2020 2020 2020 2020 2065 766f 6c75 7469           evoluti
-0001e900: 6f6e 206f 6620 6375 7272 656e 7420 6461  on of current da
-0001e910: 7461 206f 6e20 7468 6520 7369 7465 200d  ta on the site .
-0001e920: 0a20 2020 2020 2020 202a 2a6e 756d 6265  .        **numbe
-0001e930: 725f 6f66 5f73 7461 7469 6f6e 732a 2a20  r_of_stations** 
-0001e940: 3a20 696e 7420 200d 0a20 2020 2020 2020  : int  ..       
-0001e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e960: 2020 2020 206e 756d 6265 7220 6f66 2073       number of s
-0001e970: 7572 7665 795f 7374 6174 696f 6e73 202e  urvey_stations .
-0001e980: 200d 0a20 2020 2020 2020 202a 2a6e 756d   ..        **num
-0001e990: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-0001e9a0: 6573 2a2a 3a20 696e 7420 0d0a 2020 2020  es**: int ..    
-0001e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e9c0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-0001e9d0: 6f66 2066 7265 7175 656e 6369 6573 2064  of frequencies d
-0001e9e0: 7572 696e 670d 0a20 2020 2020 2020 2020  uring..         
-0001e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea00: 2020 2020 7468 6520 7375 7276 6579 2066      the survey f
-0001ea10: 6f72 2065 6163 6820 7374 6174 696f 6e20  or each station 
-0001ea20: 6c6f 6361 7469 6f6e 0d0a 2020 2020 2020  location..      
-0001ea30: 2020 2020 2020 0d0a 2020 2020 3d3d 3d3d        ..    ====
-0001ea40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
-0001ea50: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-0001ea60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001ea70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001ea80: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2041 7474  =======..    Att
-0001ea90: 7269 6275 7465 7320 2020 2020 2020 2020  ributes         
-0001eaa0: 5479 7065 2020 2020 2020 2020 4578 706c  Type        Expl
-0001eab0: 616e 6174 696f 6e0d 0a20 2020 203d 3d3d  anation..    ===
-0001eac0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
-0001ead0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-0001eae0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001eaf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001eb00: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 7661  ========..    va
-0001eb10: 6c75 6520 2020 2020 2020 2020 2020 2020  lue             
-0001eb20: 6e64 2e61 7272 6179 2020 2020 2020 6461  nd.array      da
-0001eb30: 7461 206f 6620 416d 7020 2063 6f6c 756d  ta of Amp  colum
-0001eb40: 6e20 206f 6e20 6176 6766 696c 6520 2020  n  on avgfile   
-0001eb50: 0d0a 2020 2020 6d61 7820 2020 2020 2020  ..    max       
-0001eb60: 2020 2020 2020 2020 666c 6f61 7420 2020          float   
-0001eb70: 2020 2020 2020 6d61 7869 6d75 6d20 6375        maximum cu
-0001eb80: 7272 656e 7420 656e 666f 7263 6520 2061  rrent enforce  a
-0001eb90: 2074 6861 7420 706f 696e 740d 0a20 2020   that point..   
-0001eba0: 206d 696e 2020 2020 2020 2020 2020 2020   min            
-0001ebb0: 2020 2066 6c6f 6174 2020 2020 2020 2020     float        
-0001ebc0: 206d 696e 696d 756e 2063 7572 7265 6e74   minimun current
-0001ebd0: 2075 6e69 7420 3a61 6d70 2028 4129 2020   unit :amp (A)  
-0001ebe0: 0d0a 2020 2020 6c6f 6320 2020 2020 2020  ..    loc       
-0001ebf0: 2020 2020 2020 2020 6469 6374 2020 2020          dict    
-0001ec00: 2020 2020 2020 6d61 696e 2061 7474 7269        main attri
-0001ec10: 6275 7465 206c 6f63 6174 696f 6e20 6f66  bute location of
-0001ec20: 2073 7461 7469 6f6e 2077 6974 6820 0d0a   station with ..
-0001ec30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec50: 2020 2020 7468 6520 6375 7272 656e 7420      the current 
-0001ec60: 656e 666f 7263 6520 6120 7468 6174 2070  enforce a that p
-0001ec70: 6f69 6e74 202e 6567 206c 6f63 200d 0a20  oint .eg loc .. 
-0001ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eca0: 2020 205b 2753 3037 275d 2073 686f 7720     ['S07'] show 
-0001ecb0: 7468 6520 6375 7272 656e 7420 416d 7073  the current Amps
-0001ecc0: 2d64 6174 610d 0a20 2020 2020 2020 2020  -data..         
-0001ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ece0: 2020 2020 2020 2020 2020 2061 7420 7468             at th
-0001ecf0: 6174 2070 6f69 6e74 0d0a 2020 2020 3d3d  at point..    ==
-0001ed00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==============  
-0001ed10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
-0001ed20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001ed30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001ed40: 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d 0a20 2020  =========....   
-0001ed50: 204d 6f72 6520 6174 7472 6962 7574 6573   More attributes
-0001ed60: 2063 616e 2062 6520 6164 6465 6420 6279   can be added by
-0001ed70: 2069 6e70 7574 696e 6720 6120 6b65 7920   inputing a key 
-0001ed80: 776f 7264 2064 6963 7469 6f6e 6172 790d  word dictionary.
-0001ed90: 0a20 2020 200d 0a20 2020 203a 4578 616d  .    ..    :Exam
-0001eda0: 706c 653a 0d0a 2020 2020 2020 2020 200d  ple:..         .
-0001edb0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0001edc0: 6d20 7079 6373 616d 742e 6666 2e63 6f72  m pycsamt.ff.cor
-0001edd0: 652e 6176 6720 696d 706f 7274 2041 7667  e.avg import Avg
-0001ede0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7061  ..        >>> pa
-0001edf0: 7468 3d6f 732e 7061 7468 2e6a 6f69 6e28  th=os.path.join(
-0001ee00: 6f73 2e65 6e76 6972 6f6e 5b22 7079 4353  os.environ["pyCS
-0001ee10: 414d 5422 5d2c 200d 0a20 2020 2020 2020  AMT"], ..       
-0001ee20: 202e 2e2e 2020 2020 2020 2770 7963 7361   ...      'pycsa
-0001ee30: 6d74 272c 2022 6461 7461 222c 2022 4b31  mt', "data", "K1
-0001ee40: 2e41 5647 2229 0d0a 2020 2020 2020 2020  .AVG")..        
-0001ee50: 3e3e 3e20 6176 675f 6f62 6a3d 4176 6728  >>> avg_obj=Avg(
-0001ee60: 7061 7468 290d 0a20 2020 2020 2020 203e  path)..        >
-0001ee70: 3e3e 2061 6d70 735f 6f62 6a20 3d61 7667  >> amps_obj =avg
-0001ee80: 5f6f 626a 2e44 6174 615f 7365 6374 696f  _obj.Data_sectio
-0001ee90: 6e2e 416d 7073 2e6c 6f63 5b27 5330 3027  n.Amps.loc['S00'
-0001eea0: 5d0d 0a20 2020 2020 2020 203e 3e3e 2070  ]..        >>> p
-0001eeb0: 7269 6e74 2861 6d70 5f6f 626a 290d 0a20  rint(amp_obj).. 
-0001eec0: 2020 2022 2222 0d0a 0d0a 2020 2020 6465     """....    de
-0001eed0: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-0001eee0: 2061 6d70 735f 6172 7261 793d 204e 6f6e   amps_array= Non
-0001eef0: 652c 206e 756d 6265 725f 6f66 5f66 7265  e, number_of_fre
-0001ef00: 7175 656e 6369 6573 3d4e 6f6e 6520 2c20  quencies=None , 
-0001ef10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ef20: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
-0001ef30: 7469 6f6e 733d 4e6f 6e65 202c 202a 2a6b  tions=None , **k
-0001ef40: 7761 7267 7329 3a0d 0a0d 0a20 2020 2020  wargs):....     
-0001ef50: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-0001ef60: 662e 5f61 6d70 735f 6172 7261 7920 3d61  f._amps_array =a
-0001ef70: 6d70 735f 6172 7261 790d 0a20 2020 2020  mps_array..     
-0001ef80: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-0001ef90: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
-0001efa0: 696f 6e73 203d 6b77 6172 6773 2e70 6f70  ions =kwargs.pop
-0001efb0: 2822 6e75 6d62 6572 5f6f 665f 7374 6174  ("number_of_stat
-0001efc0: 696f 6e73 222c 204e 6f6e 6529 0d0a 2020  ions", None)..  
-0001efd0: 2020 2020 2020 7365 6c66 2e6e 6672 6571        self.nfreq
-0001efe0: 203d 6b77 6172 6773 2e70 6f70 2827 6e75   =kwargs.pop('nu
-0001eff0: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-0001f000: 6965 7327 2c20 4e6f 6e65 290d 0a20 2020  ies', None)..   
-0001f010: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-0001f020: 656c 662e 7661 6c75 6520 3d4e 6f6e 6520  elf.value =None 
-0001f030: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
-0001f040: 696e 203d 204e 6f6e 6520 0d0a 2020 2020  in = None ..    
-0001f050: 2020 2020 7365 6c66 2e6d 6178 203d 204e      self.max = N
-0001f060: 6f6e 6520 0d0a 2020 2020 0d0a 2020 2020  one ..    ..    
-0001f070: 2020 2020 666f 7220 6b65 7920 696e 206c      for key in l
-0001f080: 6973 7428 6b77 6172 6773 2e6b 6579 7328  ist(kwargs.keys(
-0001f090: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-0001f0a0: 2073 6574 6174 7472 2873 656c 662c 206b   setattr(self, k
-0001f0b0: 6579 2c20 6b77 6172 6773 5b6b 6579 5d29  ey, kwargs[key])
-0001f0c0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-0001f0d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001f0e0: 5f61 6d70 735f 6172 7261 7920 6973 206e  _amps_array is n
-0001f0f0: 6f74 204e 6f6e 6520 3a20 0d0a 2020 2020  ot None : ..    
-0001f100: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
-0001f110: 6164 5f61 6d70 735f 6461 7461 2829 0d0a  ad_amps_data()..
-0001f120: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001f130: 2020 0d0a 2020 2020 6465 6620 5f72 6561    ..    def _rea
-0001f140: 645f 616d 7073 5f64 6174 6120 2873 656c  d_amps_data (sel
-0001f150: 662c 2061 6d70 735f 6172 7261 793d 204e  f, amps_array= N
-0001f160: 6f6e 652c 206e 756d 6265 725f 6f66 5f66  one, number_of_f
-0001f170: 7265 7175 656e 6369 6573 3d4e 6f6e 6520  requencies=None 
-0001f180: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0001f190: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-0001f1a0: 6572 5f6f 665f 7374 6174 696f 6e73 3d4e  er_of_stations=N
-0001f1b0: 6f6e 6520 293a 0d0a 2020 2020 2020 2020  one ):..        
-0001f1c0: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
-0001f1d0: 686f 6420 746f 2072 6561 6420 616e 6420  hod to read and 
-0001f1e0: 6172 616e 6765 2064 6174 6120 6163 636f  arange data acco
-0001f1f0: 7264 696e 6720 6561 6368 2073 7461 7469  rding each stati
-0001f200: 6f6e 202f 616d 7073 2076 616c 7565 7320  on /amps values 
-0001f210: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-0001f220: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0001f230: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001f240: 2d2d 2d0d 0a20 2020 2020 2020 2020 2020  ---..           
-0001f250: 202a 2061 6d70 735f 6172 7261 7920 3a20   * amps_array : 
-0001f260: 6e64 6172 7261 792c 206f 7074 696f 6e61  ndarray, optiona
-0001f270: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-0001f280: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0001f290: 6d70 7320 5f63 7572 7265 6e74 206f 6273  mps _current obs
-0001f2a0: 6572 7665 6420 7369 7465 732e 200d 0a20  erved sites. .. 
-0001f2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f2c0: 2020 2020 2020 2020 2020 2054 6865 202a             The *
-0001f2d0: 6465 6661 756c 742a 2069 7320 4e6f 6e65  default* is None
-0001f2e0: 2e0d 0a20 2020 2020 2020 2020 2020 202a  ...            *
-0001f2f0: 206e 756d 6265 725f 6f66 5f66 7265 7175   number_of_frequ
-0001f300: 656e 6369 6573 203a 2069 6e74 202c 206f  encies : int , o
-0001f310: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-0001f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f330: 2020 2020 206e 756d 6265 7220 6f66 2066       number of f
-0001f340: 7265 7175 656e 6369 6573 2066 6f72 2073  requencies for s
-0001f350: 7572 7665 792e 0d0a 2020 2020 2020 2020  urvey...        
-0001f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f370: 2020 2020 5468 6520 2a64 6566 6175 6c74      The *default
-0001f380: 2a20 6973 204e 6f6e 652e 0d0a 2020 2020  * is None...    
-0001f390: 2020 2020 2020 2020 2a20 6e75 6d62 6572          * number
-0001f3a0: 5f6f 665f 7374 6174 696f 6e73 203a 2069  _of_stations : i
-0001f3b0: 6e74 202c 206f 7074 696f 6e61 6c0d 0a20  nt , optional.. 
-0001f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f3d0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-0001f3e0: 725f 6f66 2073 7461 7469 6f6e 732e 200d  r_of stations. .
-0001f3f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f400: 2020 2020 2020 2020 2020 2020 2054 6865               The
-0001f410: 202a 6465 6661 756c 742a 2069 7320 4e6f   *default* is No
-0001f420: 6e65 2e0d 0a20 2020 2020 2020 2022 2222  ne...        """
-0001f430: 0d0a 2020 2020 2020 2020 6966 2061 6d70  ..        if amp
-0001f440: 735f 6172 7261 7920 6973 206e 6f74 204e  s_array is not N
-0001f450: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
-0001f460: 2020 2020 7365 6c66 2e5f 616d 7073 5f61      self._amps_a
-0001f470: 7272 6179 203d 616d 7073 5f61 7272 6179  rray =amps_array
-0001f480: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
-0001f490: 6c66 2e5f 616d 7073 5f61 7272 6179 2069  lf._amps_array i
-0001f4a0: 7320 4e6f 6e65 203a 200d 0a20 2020 2020  s None : ..     
-0001f4b0: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-0001f4c0: 782e 7079 4353 414d 5445 7272 6f72 5f69  x.pyCSAMTError_i
-0001f4d0: 6e70 7574 6172 6775 6d65 6e74 7328 274e  nputarguments('N
-0001f4e0: 6f20 416d 7065 7273 2064 6174 6120 2127  o Ampers data !'
-0001f4f0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-0001f500: 0a20 2020 2020 2020 2069 6620 6e75 6d62  .        if numb
-0001f510: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
-0001f520: 7320 6973 206e 6f74 204e 6f6e 6520 3a20  s is not None : 
-0001f530: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0001f540: 6c66 2e6e 6672 6571 203d 6e75 6d62 6572  lf.nfreq =number
-0001f550: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
-0001f560: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
-0001f570: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0001f580: 6973 6520 4353 6578 2e70 7943 5341 4d54  ise CSex.pyCSAMT
-0001f590: 4572 726f 725f 696e 7075 7461 7267 756d  Error_inputargum
-0001f5a0: 656e 7473 280d 0a20 2020 2020 2020 2020  ents(..         
-0001f5b0: 2020 2020 2020 2022 506c 6561 7365 2073         "Please s
-0001f5c0: 7065 6369 6679 2074 6865 206e 756d 6265  pecify the numbe
-0001f5d0: 7220 6f66 2066 7265 7175 656e 6379 2021  r of frequency !
-0001f5e0: 2229 0d0a 2020 2020 2020 2020 6966 206e  ")..        if n
-0001f5f0: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-0001f600: 7320 6973 206e 6f74 204e 6f6e 6520 3a20  s is not None : 
-0001f610: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0001f620: 6c66 2e6e 756d 6265 725f 6f66 5f73 7461  lf.number_of_sta
-0001f630: 7469 6f6e 7320 3d6e 756d 6265 725f 6f66  tions =number_of
-0001f640: 5f73 7461 7469 6f6e 7320 0d0a 2020 2020  _stations ..    
-0001f650: 2020 2020 656c 7365 203a 2072 6169 7365      else : raise
-0001f660: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-0001f670: 6f72 5f69 6e70 7574 6172 6775 6d65 6e74  or_inputargument
-0001f680: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-0001f690: 2750 6c65 6173 6520 7370 6563 6966 7920  'Please specify 
-0001f6a0: 7468 6520 6e75 6d62 6572 206f 6620 7374  the number of st
-0001f6b0: 6174 696f 6e73 2729 0d0a 2020 2020 2020  ations')..      
-0001f6c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001f6d0: 7472 7920 3a20 0d0a 2020 2020 2020 2020  try : ..        
-0001f6e0: 2020 2020 7365 6c66 2e6e 6672 6571 3d6e      self.nfreq=n
-0001f6f0: 702e 696e 7428 7365 6c66 2e6e 6672 6571  p.int(self.nfreq
-0001f700: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-0001f710: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-0001f720: 6174 696f 6e73 203d 6e70 2e69 6e74 2873  ations =np.int(s
-0001f730: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-0001f740: 6174 696f 6e73 290d 0a20 2020 2020 2020  ations)..       
-0001f750: 2020 2020 2073 656c 662e 5f61 6d70 735f       self._amps_
-0001f760: 6172 7261 793d 6e70 2e61 7272 6179 285b  array=np.array([
-0001f770: 6e70 2e66 6c6f 6174 2863 6329 2066 6f72  np.float(cc) for
-0001f780: 2063 6320 696e 2073 656c 662e 5f61 6d70   cc in self._amp
-0001f790: 735f 6172 7261 795d 290d 0a0d 0a20 2020  s_array])....   
-0001f7a0: 2020 2020 2065 7863 6570 7420 3a20 0d0a       except : ..
-0001f7b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001f7c0: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-0001f7d0: 726f 725f 7661 6c75 6528 0d0a 2020 2020  ror_value(..    
-0001f7e0: 2020 2020 2020 2020 2020 2020 2256 616c              "Val
-0001f7f0: 7565 7320 7072 6f76 6964 6564 2066 6f72  ues provided for
-0001f800: 2074 6865 2061 6d70 2061 7265 2077 726f   the amp are wro
-0001f810: 6e67 2e22 0d0a 2020 2020 2020 2020 2020  ng."..          
-0001f820: 2020 2020 2020 2220 6d75 7374 2062 6520        " must be 
-0001f830: 666c 6f61 7420 6f72 2069 6e74 6567 6572  float or integer
-0001f840: 202e 2229 0d0a 2020 2020 2020 2020 2020   .")..          
-0001f850: 2020 0d0a 2020 2020 2020 2020 7663 6f75    ..        vcou
-0001f860: 6e74 735f 616d 7073 2c20 7265 7065 6174  nts_amps, repeat
-0001f870: 5f61 6d70 203d 6e70 2e75 6e69 7175 6520  _amp =np.unique 
-0001f880: 280d 0a20 2020 2020 2020 2020 2020 2073  (..            s
-0001f890: 656c 662e 5f61 6d70 735f 6172 7261 792c  elf._amps_array,
-0001f8a0: 2072 6574 7572 6e5f 636f 756e 7473 3d54   return_counts=T
-0001f8b0: 7275 6529 0d0a 2020 2020 2020 2020 7365  rue)..        se
-0001f8c0: 6c66 2e76 616c 7565 203d 7663 6f75 6e74  lf.value =vcount
-0001f8d0: 735f 616d 7073 0d0a 2020 2020 2020 2020  s_amps..        
-0001f8e0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
-0001f8f0: 6178 2c20 7365 6c66 2e6d 696e 203d 7663  ax, self.min =vc
-0001f900: 6f75 6e74 735f 616d 7073 2e6d 6178 2829  ounts_amps.max()
-0001f910: 2c20 7663 6f75 6e74 735f 616d 7073 2e6d  , vcounts_amps.m
-0001f920: 696e 2829 0d0a 2020 2020 2020 2020 0d0a  in()..        ..
-0001f930: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001f940: 2020 7472 756e 6361 7465 645f 616d 7073    truncated_amps
-0001f950: 3d5a 6363 2e74 7275 6e63 6174 6564 5f64  =Zcc.truncated_d
-0001f960: 6174 6128 2064 6174 6120 3d73 656c 662e  ata( data =self.
-0001f970: 5f61 6d70 735f 6172 7261 792c 200d 0a20  _amps_array, .. 
-0001f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f9a0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-0001f9b0: 7265 6363 7572 656e 6365 3d73 656c 662e  reccurence=self.
-0001f9c0: 6e66 7265 7129 0d0a 2020 2020 2020 2020  nfreq)..        
-0001f9d0: 6e61 6d65 2c20 706f 6c79 6e61 6d65 203d  name, polyname =
-0001f9e0: 205a 6363 2e5f 6e75 6d62 6572 696e 675f   Zcc._numbering_
-0001f9f0: 7374 6174 696f 6e28 0d0a 2020 2020 2020  station(..      
-0001fa00: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-0001fa10: 7374 6174 696f 6e3d 7365 6c66 2e6e 756d  station=self.num
-0001fa20: 6265 725f 6f66 5f73 7461 7469 6f6e 732c  ber_of_stations,
-0001fa30: 200d 0a20 2020 2020 2020 2020 2020 206e   ..            n
-0001fa40: 756d 6265 725f 6f66 5f66 7265 7120 3d73  umber_of_freq =s
-0001fa50: 656c 662e 6e66 7265 7129 0d0a 2020 2020  elf.nfreq)..    
-0001fa60: 2020 2020 7365 6c66 2e6c 6f63 203d 7b20      self.loc ={ 
-0001fa70: 6b65 793a 7661 6c75 6520 666f 7220 6b65  key:value for ke
-0001fa80: 792c 2076 616c 7565 2069 6e20 7a69 7028  y, value in zip(
-0001fa90: 6e61 6d65 2c20 7472 756e 6361 7465 645f  name, truncated_
-0001faa0: 616d 7073 2029 7d0d 0a20 2020 2020 2020  amps )}..       
-0001fab0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0001fac0: 2020 2020 200d 0a63 6c61 7373 2045 6d61       ..class Ema
-0001fad0: 6720 286f 626a 6563 7429 3a0d 0a20 2020  g (object):..   
-0001fae0: 2022 2222 0d0a 2020 2020 452d 6669 656c   """..    E-fiel
-0001faf0: 6420 6d61 676e 6974 7564 6520 286d 6963  d magnitude (mic
-0001fb00: 726f 566f 6c74 732f 286b 696c 6f4d 6574  roVolts/(kiloMet
-0001fb10: 6572 2a41 6d70 2929 0d0a 2020 2020 0d0a  er*Amp))..    ..
-0001fb20: 2020 2020 4172 6775 6d65 6e74 7320 0d0a      Arguments ..
-0001fb30: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-0001fb40: 2020 2020 2020 2020 2a2a 655f 6d61 675f          **e_mag_
-0001fb50: 6172 7261 792a 2a3a 206e 6461 7272 6179  array**: ndarray
-0001fb60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001fb70: 2020 455f 6669 656c 6420 6d61 676e 6974    E_field magnit
-0001fb80: 7564 6520 436c 6173 7320 200d 0a20 2020  ude Class  ..   
-0001fb90: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-0001fba0: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
-0001fbb0: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
-0001fbc0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-0001fbd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001fbe0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001fbf0: 0d0a 2020 2020 4174 7472 6962 7574 6573  ..    Attributes
-0001fc00: 2020 2020 2020 2020 2054 7970 6520 2020           Type   
-0001fc10: 2020 2020 2045 7870 6c61 6e61 7469 6f6e       Explanation
-0001fc20: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
-0001fc30: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-0001fc40: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-0001fc50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001fc60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001fc70: 3d0d 0a20 2020 2076 616c 7565 2020 2020  =..    value    
-0001fc80: 2020 2020 2020 2020 206e 642e 6172 7261           nd.arra
-0001fc90: 7920 2020 2020 2064 6174 6120 6f66 2045  y      data of E
-0001fca0: 6d61 6720 2063 6f6c 756d 6e20 6f6e 2061  mag  column on a
-0001fcb0: 7667 6669 6c65 2020 200d 0a20 2020 206d  vgfile   ..    m
-0001fcc0: 6178 2020 2020 2020 2020 2020 2020 2020  ax              
-0001fcd0: 2066 6c6f 6174 2020 2020 2020 2020 206d   float         m
-0001fce0: 6178 696d 756d 2045 2d46 6965 6c64 206d  aximum E-Field m
-0001fcf0: 6167 6e69 7475 6465 2075 6e69 7420 3a6d  agnitude unit :m
-0001fd00: 562f 6b6d 2a41 6d70 200d 0a20 2020 206c  V/km*Amp ..    l
-0001fd10: 6f63 2020 2020 2020 2020 2020 2020 2020  oc              
-0001fd20: 2064 6963 7420 2020 2020 2020 2020 206c   dict          l
-0001fd30: 6f63 6174 696f 6e20 6f66 2045 2d46 6965  ocation of E-Fie
-0001fd40: 6c64 2020 6d61 676e 6974 7564 6520 7661  ld  magnitude va
-0001fd50: 6c75 6520 6174 200d 0a20 2020 2020 2020  lue at ..       
-0001fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd70: 2020 2020 2020 2020 2020 2020 2074 6865               the
-0001fd80: 2073 7461 7469 6f6e 206c 616d 6264 612e   station lambda.
-0001fd90: 653a 6720 3a20 6c6f 635b 2753 3030 275d  e:g : loc['S00']
-0001fda0: 2073 686f 7720 0d0a 2020 2020 2020 2020   show ..        
-0001fdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fdc0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0001fdd0: 6375 7272 656e 7420 2045 2d6d 6167 2064  current  E-mag d
-0001fde0: 6174 6120 6f66 2073 7461 7469 6f6e 200d  ata of station .
-0001fdf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe10: 2020 2020 2061 7420 7468 6174 2070 6f69       at that poi
-0001fe20: 6e74 2e0d 0a20 2020 203d 3d3d 3d3d 3d3d  nt...    =======
-0001fe30: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-0001fe40: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-0001fe50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001fe60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001fe70: 3d3d 3d3d 0d0a 0d0a 2020 2020 4d6f 7265  ====....    More
-0001fe80: 2061 7474 7269 6275 7465 7320 6361 6e20   attributes can 
-0001fe90: 6265 2061 6464 6564 2062 7920 696e 7075  be added by inpu
-0001fea0: 7469 6e67 2061 206b 6579 2077 6f72 6420  ting a key word 
-0001feb0: 6469 6374 696f 6e61 7279 0d0a 2020 2020  dictionary..    
-0001fec0: 0d0a 2020 2020 3a45 7861 6d70 6c65 3a20  ..    :Example: 
-0001fed0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001fee0: 2020 2020 3e3e 3e20 6672 6f6d 2070 7963      >>> from pyc
-0001fef0: 7361 6d74 2e66 662e 636f 7265 2e61 7667  samt.ff.core.avg
-0001ff00: 2069 6d70 6f72 7420 4176 670d 0a20 2020   import Avg..   
-0001ff10: 2020 2020 203e 3e3e 2070 6174 683d 6f73       >>> path=os
-0001ff20: 2e70 6174 682e 6a6f 696e 286f 732e 656e  .path.join(os.en
-0001ff30: 7669 726f 6e5b 2270 7943 5341 4d54 225d  viron["pyCSAMT"]
-0001ff40: 2c20 0d0a 2020 2020 2020 2020 2e2e 2e20  , ..        ... 
-0001ff50: 2020 2020 2027 7079 6373 616d 7427 2c20       'pycsamt', 
-0001ff60: 2264 6174 6122 2c20 224b 312e 4156 4722  "data", "K1.AVG"
-0001ff70: 290d 0a20 2020 2020 2020 203e 3e3e 2061  )..        >>> a
-0001ff80: 7667 5f6f 626a 3d41 7667 2870 6174 6829  vg_obj=Avg(path)
-0001ff90: 0d0a 2020 2020 2020 2020 3e3e 3e20 656d  ..        >>> em
-0001ffa0: 6167 5f6f 626a 203d 6176 675f 6f62 6a2e  ag_obj =avg_obj.
-0001ffb0: 4461 7461 5f73 6563 7469 6f6e 2e45 6d61  Data_section.Ema
-0001ffc0: 672e 6c6f 635b 2753 3032 275d 0d0a 2020  g.loc['S02']..  
-0001ffd0: 2020 2020 2020 2e2e 2e20 7072 696e 7428        ... print(
-0001ffe0: 656d 6167 5f6f 626a 290d 0a20 2020 2022  emag_obj)..    "
-0001fff0: 2222 0d0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-00020000: 6974 5f5f 2873 656c 662c 2065 5f6d 6167  it__(self, e_mag
-00020010: 5f61 7272 6179 3d4e 6f6e 652c 206e 756d  _array=None, num
-00020020: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-00020030: 6573 3d4e 6f6e 6520 2c0d 0a20 2020 2020  es=None ,..     
-00020040: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00020050: 6572 5f6f 665f 7374 6174 696f 6e73 3d4e  er_of_stations=N
-00020060: 6f6e 6520 2c20 2a2a 6b77 6172 6773 293a  one , **kwargs):
-00020070: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00020080: 2020 2020 7365 6c66 2e65 5f6d 6167 5f61      self.e_mag_a
-00020090: 7272 6179 203d 655f 6d61 675f 6172 7261  rray =e_mag_arra
-000200a0: 790d 0a20 2020 2020 2020 200d 0a20 2020  y..        ..   
-000200b0: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
-000200c0: 5f6f 665f 7374 6174 696f 6e73 203d 6b77  _of_stations =kw
-000200d0: 6172 6773 2e70 6f70 2822 6e75 6d62 6572  args.pop("number
-000200e0: 5f6f 665f 7374 6174 696f 6e73 222c 204e  _of_stations", N
-000200f0: 6f6e 6529 0d0a 2020 2020 2020 2020 7365  one)..        se
-00020100: 6c66 2e6e 6672 6571 203d 6b77 6172 6773  lf.nfreq =kwargs
-00020110: 2e70 6f70 2827 6e75 6d62 6572 5f6f 665f  .pop('number_of_
-00020120: 6672 6571 7565 6e63 6965 7327 2c20 4e6f  frequencies', No
-00020130: 6e65 290d 0a20 2020 2020 2020 200d 0a20  ne)..        .. 
-00020140: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
-00020150: 6520 3d4e 6f6e 6520 0d0a 2020 2020 2020  e =None ..      
-00020160: 2020 7365 6c66 2e6d 696e 203d 204e 6f6e    self.min = Non
-00020170: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
-00020180: 2e6d 6178 203d 204e 6f6e 6520 0d0a 2020  .max = None ..  
-00020190: 2020 0d0a 2020 2020 2020 2020 666f 7220    ..        for 
-000201a0: 6b65 7920 696e 206c 6973 7428 6b77 6172  key in list(kwar
-000201b0: 6773 2e6b 6579 7328 2929 3a0d 0a20 2020  gs.keys()):..   
-000201c0: 2020 2020 2020 2020 2073 6574 6174 7472           setattr
-000201d0: 2873 656c 662c 206b 6579 2c20 6b77 6172  (self, key, kwar
-000201e0: 6773 5b6b 6579 5d29 0d0a 2020 2020 2020  gs[key])..      
-000201f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00020200: 6966 2073 656c 662e 655f 6d61 675f 6172  if self.e_mag_ar
-00020210: 7261 7920 2069 7320 6e6f 7420 4e6f 6e65  ray  is not None
-00020220: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00020230: 2073 656c 662e 5f72 6561 645f 656d 6167   self._read_emag
-00020240: 5f64 6174 6120 2829 0d0a 2020 2020 2020  _data ()..      
-00020250: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
-00020260: 2020 6465 6620 5f72 6561 645f 656d 6167    def _read_emag
-00020270: 5f64 6174 6120 2873 656c 662c 655f 6d61  _data (self,e_ma
-00020280: 675f 6172 7261 793d 4e6f 6e65 2c20 6e75  g_array=None, nu
-00020290: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-000202a0: 6965 733d 4e6f 6e65 202c 200d 0a20 2020  ies=None , ..   
-000202b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202c0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-000202d0: 7374 6174 696f 6e73 3d4e 6f6e 6520 293a  stations=None ):
-000202e0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-000202f0: 2020 2020 2020 204d 6574 686f 6420 746f         Method to
-00020300: 2072 6561 6420 616e 6420 6172 616e 6765   read and arange
-00020310: 2064 6174 6120 6163 636f 7264 696e 6720   data according 
-00020320: 6561 6368 200d 0a20 2020 2020 2020 2073  each ..        s
-00020330: 7461 7469 6f6e 202f 655f 6669 656c 6420  tation /e_field 
-00020340: 6d61 676e 6974 7564 6520 7661 6c75 6573  magnitude values
-00020350: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
-00020360: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00020370: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00020380: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00020390: 2020 2020 2020 2a20 655f 6d61 675f 6172        * e_mag_ar
-000203a0: 7261 7920 3a20 6e64 6172 7261 792c 206f  ray : ndarray, o
-000203b0: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-000203c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203d0: 2020 2020 2042 2d46 6965 6c64 206d 6167       B-Field mag
-000203e0: 6e69 7475 6465 206f 6273 6572 7665 6420  nitude observed 
-000203f0: 6174 2065 6163 6820 7374 6174 696f 6e2e  at each station.
-00020400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020410: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00020420: 6520 2a64 6566 6175 6c74 2a20 6973 204e  e *default* is N
-00020430: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
-00020440: 2020 2a20 6e75 6d62 6572 5f6f 665f 6672    * number_of_fr
-00020450: 6571 7565 6e63 6965 7320 3a20 696e 7420  equencies : int 
-00020460: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00020470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020480: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00020490: 6572 206f 6620 6672 6571 7565 6e63 6965  er of frequencie
-000204a0: 7320 666f 7220 7375 7276 6579 2e20 0d0a  s for survey. ..
-000204b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000204c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000204d0: 5468 6520 6465 6661 756c 7420 6973 204e  The default is N
-000204e0: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
-000204f0: 2020 2a20 6e75 6d62 6572 5f6f 665f 7374    * number_of_st
-00020500: 6174 696f 6e73 203a 2069 6e74 202c 206f  ations : int , o
-00020510: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-00020520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020530: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-00020540: 6f66 2073 7461 7469 6f6e 732e 2054 6865  of stations. The
-00020550: 2064 6566 6175 6c74 2069 7320 4e6f 6e65   default is None
-00020560: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00020570: 2020 2020 2020 2020 6966 2065 5f6d 6167          if e_mag
-00020580: 5f61 7272 6179 2069 7320 6e6f 7420 4e6f  _array is not No
-00020590: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
-000205a0: 2020 2073 656c 662e 655f 6d61 675f 6172     self.e_mag_ar
-000205b0: 7261 7920 3d65 5f6d 6167 5f61 7272 6179  ray =e_mag_array
-000205c0: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
-000205d0: 6c66 2e65 5f6d 6167 5f61 7272 6179 2069  lf.e_mag_array i
-000205e0: 7320 4e6f 6e65 203a 200d 0a20 2020 2020  s None : ..     
-000205f0: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-00020600: 782e 7079 4353 414d 5445 7272 6f72 5f69  x.pyCSAMTError_i
-00020610: 6e70 7574 6172 6775 6d65 6e74 7328 274e  nputarguments('N
-00020620: 6f20 452d 4669 656c 6420 2064 6174 6120  o E-Field  data 
-00020630: 666f 756e 6420 2021 2729 0d0a 2020 2020  found  !')..    
-00020640: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00020650: 2020 6966 206e 756d 6265 725f 6f66 5f66    if number_of_f
-00020660: 7265 7175 656e 6369 6573 2069 7320 6e6f  requencies is no
-00020670: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-00020680: 2020 2020 2020 2073 656c 662e 6e66 7265         self.nfre
-00020690: 7120 3d6e 756d 6265 725f 6f66 5f66 7265  q =number_of_fre
-000206a0: 7175 656e 6369 6573 200d 0a20 2020 2020  quencies ..     
-000206b0: 2020 2065 6c73 6520 3a0d 0a20 2020 2020     else :..     
-000206c0: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-000206d0: 782e 7079 4353 414d 5445 7272 6f72 5f69  x.pyCSAMTError_i
-000206e0: 6e70 7574 6172 6775 6d65 6e74 7328 0d0a  nputarguments(..
-000206f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020700: 2250 6c65 6173 6520 7370 6563 6966 7920  "Please specify 
-00020710: 7468 6520 6e75 6d62 6572 206f 6620 6672  the number of fr
-00020720: 6571 7565 6e63 7920 2122 290d 0a20 2020  equency !")..   
-00020730: 2020 2020 2069 6620 6e75 6d62 6572 5f6f       if number_o
-00020740: 665f 7374 6174 696f 6e73 2069 7320 6e6f  f_stations is no
-00020750: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
-00020760: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
-00020770: 725f 6f66 5f73 7461 7469 6f6e 7320 3d6e  r_of_stations =n
-00020780: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-00020790: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
-000207a0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-000207b0: 7261 6973 6520 4353 6578 2e70 7943 5341  raise CSex.pyCSA
-000207c0: 4d54 4572 726f 725f 696e 7075 7461 7267  MTError_inputarg
-000207d0: 756d 656e 7473 280d 0a20 2020 2020 2020  uments(..       
-000207e0: 2020 2020 2020 2020 2027 506c 6561 7365           'Please
-000207f0: 2073 7065 6369 6679 2074 6865 206e 756d   specify the num
-00020800: 6265 7220 6f66 2073 7461 7469 6f6e 7327  ber of stations'
-00020810: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-00020820: 0a20 2020 2020 2020 2074 7279 203a 200d  .        try : .
-00020830: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00020840: 662e 6e66 7265 713d 6e70 2e69 6e74 2873  f.nfreq=np.int(s
-00020850: 656c 662e 6e66 7265 7129 0d0a 2020 2020  elf.nfreq)..    
-00020860: 2020 2020 2020 2020 7365 6c66 2e6e 756d          self.num
-00020870: 6265 725f 6f66 5f73 7461 7469 6f6e 7320  ber_of_stations 
-00020880: 3d6e 702e 696e 7428 7365 6c66 2e6e 756d  =np.int(self.num
-00020890: 6265 725f 6f66 5f73 7461 7469 6f6e 7329  ber_of_stations)
-000208a0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-000208b0: 6c66 2e65 5f6d 6167 5f61 7272 6179 3d6e  lf.e_mag_array=n
-000208c0: 702e 6172 7261 7928 5b6e 702e 666c 6f61  p.array([np.floa
-000208d0: 7428 6363 2920 666f 7220 6363 2069 6e20  t(cc) for cc in 
-000208e0: 7365 6c66 2e65 5f6d 6167 5f61 7272 6179  self.e_mag_array
-000208f0: 5d29 0d0a 0d0a 2020 2020 2020 2020 6578  ])....        ex
-00020900: 6365 7074 203a 200d 0a20 2020 2020 2020  cept : ..       
-00020910: 2020 2020 2072 6169 7365 2043 5365 782e       raise CSex.
-00020920: 7079 4353 414d 5445 7272 6f72 5f76 616c  pyCSAMTError_val
-00020930: 7565 280d 0a20 2020 2020 2020 2020 2020  ue(..           
-00020940: 2020 2020 2022 5661 6c75 6573 2070 726f       "Values pro
-00020950: 7669 6465 6420 666f 7220 7468 6520 616d  vided for the am
-00020960: 7020 6172 6520 7772 6f6e 672e 220d 0a20  p are wrong.".. 
-00020970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020980: 2220 6d75 7374 2062 6520 666c 6f61 7420  " must be float 
-00020990: 6f72 2069 6e74 6567 6572 202e 2229 0d0a  or integer .")..
-000209a0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000209b0: 2020 2020 2020 7663 6f75 6e74 735f 655f        vcounts_e_
-000209c0: 6d61 672c 2072 6570 6561 745f 616d 7020  mag, repeat_amp 
-000209d0: 3d6e 702e 756e 6971 7565 2028 7365 6c66  =np.unique (self
-000209e0: 2e65 5f6d 6167 5f61 7272 6179 2c20 0d0a  .e_mag_array, ..
-000209f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020a10: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00020a20: 7475 726e 5f63 6f75 6e74 733d 5472 7565  turn_counts=True
-00020a30: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00020a40: 7661 6c75 6520 3d76 636f 756e 7473 5f65  value =vcounts_e
-00020a50: 5f6d 6167 0d0a 2020 2020 2020 2020 0d0a  _mag..        ..
-00020a60: 2020 2020 2020 2020 7365 6c66 2e6d 6178          self.max
-00020a70: 2c20 7365 6c66 2e6d 696e 203d 7663 6f75  , self.min =vcou
-00020a80: 6e74 735f 655f 6d61 672e 6d61 7828 292c  nts_e_mag.max(),
-00020a90: 2076 636f 756e 7473 5f65 5f6d 6167 2e6d   vcounts_e_mag.m
-00020aa0: 696e 2829 0d0a 2020 2020 2020 2020 0d0a  in()..        ..
-00020ab0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00020ac0: 2020 7472 756e 6361 7465 645f 655f 6d61    truncated_e_ma
-00020ad0: 673d 5a63 632e 7472 756e 6361 7465 645f  g=Zcc.truncated_
-00020ae0: 6461 7461 2820 6461 7461 203d 7365 6c66  data( data =self
-00020af0: 2e65 5f6d 6167 5f61 7272 6179 2c20 0d0a  .e_mag_array, ..
-00020b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b20: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-00020b30: 5f72 6563 6375 7265 6e63 653d 7365 6c66  _reccurence=self
-00020b40: 2e6e 6672 6571 290d 0a20 2020 2020 2020  .nfreq)..       
-00020b50: 206e 616d 652c 2070 6f6c 796e 616d 6520   name, polyname 
-00020b60: 3d20 5a63 632e 5f6e 756d 6265 7269 6e67  = Zcc._numbering
-00020b70: 5f73 7461 7469 6f6e 280d 0a20 2020 2020  _station(..     
-00020b80: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-00020b90: 5f73 7461 7469 6f6e 3d73 656c 662e 6e75  _station=self.nu
-00020ba0: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
-00020bb0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00020bc0: 6e75 6d62 6572 5f6f 665f 6672 6571 203d  number_of_freq =
-00020bd0: 7365 6c66 2e6e 6672 6571 290d 0a20 2020  self.nfreq)..   
-00020be0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00020bf0: 656c 662e 6c6f 6320 3d7b 206b 6579 3a76  elf.loc ={ key:v
-00020c00: 616c 7565 2066 6f72 206b 6579 2c20 7661  alue for key, va
-00020c10: 6c75 6520 696e 207a 6970 286e 616d 652c  lue in zip(name,
-00020c20: 2074 7275 6e63 6174 6564 5f65 5f6d 6167   truncated_e_mag
-00020c30: 2029 7d0d 0a20 2020 2020 2020 200d 0a20   )}..        .. 
-00020c40: 2020 200d 0a63 6c61 7373 2045 7068 7a20     ..class Ephz 
-00020c50: 286f 626a 6563 7429 3a0d 0a20 2020 2022  (object):..    "
-00020c60: 2222 0d0a 2020 2020 452d 6669 656c 6420  ""..    E-field 
-00020c70: 7068 6173 6520 286d 696c 6c69 5261 6469  phase (milliRadi
-00020c80: 616e 7329 0d0a 2020 2020 0d0a 2020 2020  ans)..    ..    
-00020c90: 4172 6775 6d65 6e74 7320 0d0a 2020 2020  Arguments ..    
-00020ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00020cb0: 2020 2020 2a2a 655f 7068 7a5f 6172 7261      **e_phz_arra
-00020cc0: 792a 2a20 3a20 6e64 6172 7261 790d 0a20  y** : ndarray.. 
-00020cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ce0: 2020 455f 7068 6173 6520 6461 7461 2066    E_phase data f
-00020cf0: 6965 6c64 0d0a 2020 2020 2020 2020 2a2a  ield..        **
-00020d00: 746f 5f64 6567 2a2a 2020 3a20 626f 6f6c  to_deg**  : bool
-00020d10: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00020d20: 2020 2020 2020 7075 7420 7468 6520 4570        put the Ep
-00020d30: 687a 2076 616c 7565 206f 6e20 6465 6772  hz value on degr
-00020d40: 6565 202e 200d 0a20 2020 2020 2020 2020  ee . ..         
-00020d50: 2020 2020 2020 2020 200d 0a20 2020 203d           ..    =
-00020d60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
-00020d70: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d   ===========  ==
-00020d80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020d90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020da0: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
-00020db0: 4174 7472 6962 7574 6573 2020 2020 2020  Attributes      
-00020dc0: 2020 2054 7970 6520 2020 2020 2020 2045     Type        E
-00020dd0: 7870 6c61 6e61 7469 6f6e 0d0a 2020 2020  xplanation..    
-00020de0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020df0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d    ===========  =
-00020e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020e10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020e20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
-00020e30: 2076 616c 7565 2020 2020 2020 2020 2020   value          
-00020e40: 2020 206e 642e 6172 7261 7920 2020 2020     nd.array     
-00020e50: 2064 6174 6120 6f66 2045 6d61 6720 2063   data of Emag  c
-00020e60: 6f6c 756d 6e20 2075 6e69 7420 2d20 6d72  olumn  unit - mr
-00020e70: 6164 200d 0a20 2020 206d 6178 2020 2020  ad ..    max    
-00020e80: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
-00020e90: 2020 2020 2020 2020 206d 6178 696d 756d           maximum
-00020ea0: 2045 2d46 6965 6c64 206d 6167 6e69 7475   E-Field magnitu
-00020eb0: 6465 2020 756e 6974 202d 6d56 2f6b 6d2a  de  unit -mV/km*
-00020ec0: 416d 7020 0d0a 2020 2020 6c6f 6320 2020  Amp ..    loc   
-00020ed0: 2020 2020 2020 2020 2020 2020 6469 6374              dict
-00020ee0: 2020 2020 2020 2020 2020 6c6f 6361 7469            locati
-00020ef0: 6f6e 206f 6620 452d 7068 6173 6520 2020  on of E-phase   
-00020f00: 7661 6c75 6520 6174 2074 6865 0d0a 2020  value at the..  
-00020f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f30: 2020 7374 6174 696f 6e20 6c61 6d62 6461    station lambda
-00020f40: 202e 2065 2e67 202d 206c 6f63 5b27 5334   . e.g - loc['S4
-00020f50: 365d 2073 686f 7720 7468 6520 0d0a 2020  6] show the ..  
-00020f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f80: 2020 6375 7272 656e 7420 2045 2d70 6861    current  E-pha
-00020f90: 7365 2064 6174 6120 2061 7420 7468 6520  se data  at the 
-00020fa0: 7374 6174 696f 6e20 5334 360d 0a20 2020  station S46..   
-00020fb0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-00020fc0: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  =  ===========  
-00020fd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020fe0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00020ff0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a  ============....
-00021000: 2020 2020 4d6f 7265 2061 7474 7269 6275      More attribu
-00021010: 7465 7320 6361 6e20 6265 2061 6464 6564  tes can be added
-00021020: 2062 7920 696e 7075 7469 6e67 2061 206b   by inputing a k
-00021030: 6579 2077 6f72 6420 6469 6374 696f 6e61  ey word dictiona
-00021040: 7279 0d0a 2020 2020 0d0a 2020 2020 3a45  ry..    ..    :E
-00021050: 7861 6d70 6c65 3a0d 0a20 2020 2020 2020  xample:..       
-00021060: 200d 0a20 2020 2020 2020 203e 3e3e 2066   ..        >>> f
-00021070: 726f 6d20 7079 6373 616d 742e 6666 2e63  rom pycsamt.ff.c
-00021080: 6f72 652e 6176 6720 696d 706f 7274 2041  ore.avg import A
-00021090: 7667 200d 0a20 2020 2020 2020 203e 3e3e  vg ..        >>>
-000210a0: 2070 6174 683d 6f73 2e70 6174 682e 6a6f   path=os.path.jo
-000210b0: 696e 286f 732e 656e 7669 726f 6e5b 2270  in(os.environ["p
-000210c0: 7943 5341 4d54 225d 2c20 0d0a 2020 2020  yCSAMT"], ..    
-000210d0: 2020 2020 2e2e 2e20 2020 2020 2027 7079      ...      'py
-000210e0: 6373 616d 7427 2c20 2264 6174 6122 2c20  csamt', "data", 
-000210f0: 224b 312e 4156 4722 290d 0a20 2020 2020  "K1.AVG")..     
-00021100: 2020 203e 3e3e 2061 7667 5f6f 626a 3d41     >>> avg_obj=A
-00021110: 7667 2870 6174 6829 0d0a 2020 2020 2020  vg(path)..      
-00021120: 2020 3e3e 3e20 6570 687a 5f6f 626a 203d    >>> ephz_obj =
-00021130: 6176 675f 6f62 6a2e 4461 7461 5f73 6563  avg_obj.Data_sec
-00021140: 7469 6f6e 2e45 7068 7a2e 6c6f 635b 2734  tion.Ephz.loc['4
-00021150: 3627 5d0d 0a20 2020 2020 2020 203e 3e3e  6']..        >>>
-00021160: 2070 7269 6e74 2865 7068 7a5f 6f62 6a29   print(ephz_obj)
-00021170: 0d0a 2020 2020 2222 220d 0a20 2020 2064  ..    """..    d
-00021180: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00021190: 2c20 655f 7068 7a5f 6172 7261 793d 4e6f  , e_phz_array=No
-000211a0: 6e65 2c20 6e75 6d62 6572 5f6f 665f 6672  ne, number_of_fr
-000211b0: 6571 7565 6e63 6965 733d 4e6f 6e65 202c  equencies=None ,
-000211c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000211d0: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
-000211e0: 6174 696f 6e73 3d4e 6f6e 6520 2c20 2a2a  ations=None , **
-000211f0: 6b77 6172 6773 293a 0d0a 2020 2020 2020  kwargs):..      
-00021200: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00021210: 2e20 655f 7068 7a5f 6172 7261 793d 2065  . e_phz_array= e
-00021220: 5f70 687a 5f61 7272 6179 0d0a 2020 2020  _phz_array..    
-00021230: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
-00021240: 6c66 2e6e 756d 6265 725f 6f66 5f73 7461  lf.number_of_sta
-00021250: 7469 6f6e 7320 3d6b 7761 7267 732e 706f  tions =kwargs.po
-00021260: 7028 226e 756d 6265 725f 6f66 5f73 7461  p("number_of_sta
-00021270: 7469 6f6e 7322 2c20 4e6f 6e65 290d 0a20  tions", None).. 
-00021280: 2020 2020 2020 2073 656c 662e 6e66 7265         self.nfre
-00021290: 7120 3d6b 7761 7267 732e 706f 7028 276e  q =kwargs.pop('n
-000212a0: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
-000212b0: 6369 6573 272c 204e 6f6e 6529 0d0a 2020  cies', None)..  
-000212c0: 2020 2020 2020 7365 6c66 2e74 6f5f 6465        self.to_de
-000212d0: 6772 6565 203d 6b77 6172 6773 2e70 6f70  gree =kwargs.pop
-000212e0: 2827 746f 5f64 6567 7265 6527 2c20 4661  ('to_degree', Fa
-000212f0: 6c73 6529 0d0a 2020 2020 2020 2020 0d0a  lse)..        ..
-00021300: 2020 2020 2020 2020 7365 6c66 2e76 616c          self.val
-00021310: 7565 203d 4e6f 6e65 200d 0a20 2020 2020  ue =None ..     
-00021320: 2020 2073 656c 662e 6d69 6e20 3d20 4e6f     self.min = No
-00021330: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
-00021340: 662e 6d61 7820 3d20 4e6f 6e65 200d 0a20  f.max = None .. 
-00021350: 2020 200d 0a20 2020 2020 2020 2066 6f72     ..        for
-00021360: 206b 6579 2069 6e20 6c69 7374 286b 7761   key in list(kwa
-00021370: 7267 732e 6b65 7973 2829 293a 0d0a 2020  rgs.keys()):..  
-00021380: 2020 2020 2020 2020 2020 7365 7461 7474            setatt
-00021390: 7228 7365 6c66 2c20 6b65 792c 206b 7761  r(self, key, kwa
-000213a0: 7267 735b 6b65 795d 290d 0a20 2020 2020  rgs[key])..     
-000213b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000213c0: 2069 6620 7365 6c66 2e65 5f70 687a 5f61   if self.e_phz_a
-000213d0: 7272 6179 2020 6973 206e 6f74 204e 6f6e  rray  is not Non
-000213e0: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-000213f0: 2020 7365 6c66 2e5f 7265 6164 5f65 7068    self._read_eph
-00021400: 7a5f 6461 7461 2028 290d 0a20 2020 2020  z_data ()..     
-00021410: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00021420: 2020 2064 6566 205f 7265 6164 5f65 7068     def _read_eph
-00021430: 7a5f 6461 7461 2028 7365 6c66 2c65 5f70  z_data (self,e_p
-00021440: 687a 5f61 7272 6179 3d4e 6f6e 652c 206e  hz_array=None, n
-00021450: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
-00021460: 6369 6573 3d4e 6f6e 6520 2c20 0d0a 2020  cies=None , ..  
-00021470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021480: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-00021490: 5f73 7461 7469 6f6e 733d 4e6f 6e65 2c20  _stations=None, 
-000214a0: 2a2a 6b77 6172 6773 2020 293a 0d0a 2020  **kwargs  ):..  
-000214b0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000214c0: 2020 204d 6574 686f 6420 746f 2072 6561     Method to rea
-000214d0: 6420 616e 6420 6172 616e 6765 2064 6174  d and arange dat
-000214e0: 6120 6163 636f 7264 696e 6720 6561 6368  a according each
-000214f0: 0d0a 2020 2020 2020 2020 7374 6174 696f  ..        statio
-00021500: 6e20 2f45 2d70 6861 7365 2061 6e67 6c65  n /E-phase angle
-00021510: 7320 7661 6c75 6573 202e 0d0a 2020 2020  s values ...    
-00021520: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00021530: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00021540: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00021550: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-00021560: 655f 7068 7a5f 6172 7261 7920 3a20 6e64  e_phz_array : nd
-00021570: 6172 7261 792c 2065 6e20 7261 6420 0d0a  array, en rad ..
-00021580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021590: 2020 2020 2020 2020 2020 2020 452d 4669              E-Fi
-000215a0: 656c 6420 7068 6173 6520 6f62 7365 7276  eld phase observ
-000215b0: 6564 202e 0d0a 2020 2020 2020 2020 2020  ed ...          
-000215c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000215d0: 2020 5468 6520 2a64 6566 6175 6c74 2a20    The *default* 
-000215e0: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
-000215f0: 2020 2020 2020 2a20 6e75 6d62 6572 5f6f        * number_o
-00021600: 665f 6672 6571 7565 6e63 6965 7320 3a20  f_frequencies : 
-00021610: 696e 7420 2c20 6f70 7469 6f6e 616c 0d0a  int , optional..
-00021620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021640: 6e75 6d62 6572 206f 6620 6672 6571 7565  number of freque
-00021650: 6e63 6965 7320 666f 7220 7375 7276 6579  ncies for survey
-00021660: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00021670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021680: 2020 2054 6865 202a 6465 6661 756c 742a     The *default*
-00021690: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2020   is None...     
-000216a0: 2020 2020 2020 202a 206e 756d 6265 725f         * number_
-000216b0: 6f66 5f73 7461 7469 6f6e 7320 3a20 696e  of_stations : in
-000216c0: 7420 2c20 6f70 7469 6f6e 616c 0d0a 2020  t , optional..  
-000216d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000216e0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-000216f0: 6d62 6572 5f6f 6620 7374 6174 696f 6e73  mber_of stations
-00021700: 2e20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
-00021710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021720: 2020 2020 5468 6520 2a64 6566 6175 6c74      The *default
-00021730: 2a20 6973 204e 6f6e 652e 0d0a 2020 2020  * is None...    
-00021740: 2020 2020 2020 2020 2a20 746f 5f64 6567          * to_deg
-00021750: 7265 6520 3a20 626f 6f6c 2c0d 0a20 2020  ree : bool,..   
-00021760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021770: 2020 2020 2063 6f6d 7075 7465 2061 6e67       compute ang
-00021780: 6c65 2074 6f20 6465 6772 6565 202e 200d  le to degree . .
-00021790: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-000217a0: 2020 2020 2020 746f 5f64 6567 7265 6520        to_degree 
-000217b0: 3d6b 7761 7267 732e 706f 7028 2274 6f5f  =kwargs.pop("to_
-000217c0: 6465 6772 6565 222c 2046 616c 7365 290d  degree", False).
-000217d0: 0a20 2020 2020 2020 2069 6620 746f 5f64  .        if to_d
-000217e0: 6567 7265 6520 3a0d 0a20 2020 2020 2020  egree :..       
-000217f0: 2020 2020 2073 656c 662e 746f 5f64 6567       self.to_deg
-00021800: 7265 6520 3d20 746f 5f64 6567 7265 650d  ree = to_degree.
-00021810: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00021820: 2020 2069 6620 655f 7068 7a5f 6172 7261     if e_phz_arra
-00021830: 7920 6973 206e 6f74 204e 6f6e 6520 3a20  y is not None : 
-00021840: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00021850: 6c66 2e65 5f70 687a 5f61 7272 6179 203d  lf.e_phz_array =
-00021860: 655f 7068 7a5f 6172 7261 790d 0a20 2020  e_phz_array..   
-00021870: 2020 2020 2069 6620 7365 6c66 2e65 5f70       if self.e_p
-00021880: 687a 5f61 7272 6179 2069 7320 4e6f 6e65  hz_array is None
-00021890: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-000218a0: 2072 6169 7365 2043 5365 782e 7079 4353   raise CSex.pyCS
-000218b0: 414d 5445 7272 6f72 5f69 6e70 7574 6172  AMTError_inputar
-000218c0: 6775 6d65 6e74 7328 0d0a 2020 2020 2020  guments(..      
-000218d0: 2020 2020 2020 2020 2020 274e 6f20 452d            'No E-
-000218e0: 7068 6173 6520 6461 7461 2066 6f75 6e64  phase data found
-000218f0: 2020 2127 290d 0a0d 0a20 2020 2020 2020    !')....       
-00021900: 2069 6620 6e75 6d62 6572 5f6f 665f 6672   if number_of_fr
-00021910: 6571 7565 6e63 6965 7320 6973 206e 6f74  equencies is not
-00021920: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
-00021930: 2020 2020 2020 7365 6c66 2e6e 6672 6571        self.nfreq
-00021940: 203d 6e75 6d62 6572 5f6f 665f 6672 6571   =number_of_freq
-00021950: 7565 6e63 6965 7320 0d0a 2020 2020 2020  uencies ..      
-00021960: 2020 656c 7365 203a 7261 6973 6520 4353    else :raise CS
-00021970: 6578 2e70 7943 5341 4d54 4572 726f 725f  ex.pyCSAMTError_
-00021980: 696e 7075 7461 7267 756d 656e 7473 280d  inputarguments(.
-00021990: 0a20 2020 2020 2020 2020 2020 2022 506c  .            "Pl
-000219a0: 6561 7365 2073 7065 6369 6679 2074 6865  ease specify the
-000219b0: 206e 756d 6265 7220 6f66 2066 7265 7175   number of frequ
-000219c0: 656e 6379 2021 2229 0d0a 2020 2020 2020  ency !")..      
-000219d0: 2020 6966 206e 756d 6265 725f 6f66 5f73    if number_of_s
-000219e0: 7461 7469 6f6e 7320 6973 206e 6f74 204e  tations is not N
-000219f0: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
-00021a00: 2020 2020 7365 6c66 2e6e 756d 6265 725f      self.number_
-00021a10: 6f66 5f73 7461 7469 6f6e 7320 3d6e 756d  of_stations =num
-00021a20: 6265 725f 6f66 5f73 7461 7469 6f6e 7320  ber_of_stations 
-00021a30: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
-00021a40: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-00021a50: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-00021a60: 5445 7272 6f72 5f69 6e70 7574 6172 6775  TError_inputargu
-00021a70: 6d65 6e74 7328 0d0a 2020 2020 2020 2020  ments(..        
-00021a80: 2020 2020 2020 2020 2750 6c65 6173 6520          'Please 
-00021a90: 7370 6563 6966 7920 7468 6520 6e75 6d62  specify the numb
-00021aa0: 6572 206f 6620 7374 6174 696f 6e73 2729  er of stations')
-00021ab0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00021ac0: 2020 2020 2020 2020 7472 7920 3a20 0d0a          try : ..
-00021ad0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00021ae0: 2e6e 6672 6571 3d6e 702e 696e 7428 7365  .nfreq=np.int(se
-00021af0: 6c66 2e6e 6672 6571 290d 0a20 2020 2020  lf.nfreq)..     
-00021b00: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
-00021b10: 6572 5f6f 665f 7374 6174 696f 6e73 203d  er_of_stations =
-00021b20: 6e70 2e69 6e74 2873 656c 662e 6e75 6d62  np.int(self.numb
-00021b30: 6572 5f6f 665f 7374 6174 696f 6e73 290d  er_of_stations).
-00021b40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00021b50: 662e 655f 7068 7a5f 6172 7261 793d 6e70  f.e_phz_array=np
-00021b60: 2e61 7272 6179 285b 6e70 2e66 6c6f 6174  .array([np.float
-00021b70: 2863 6329 2066 6f72 2063 6320 696e 2073  (cc) for cc in s
-00021b80: 656c 662e 655f 7068 7a5f 6172 7261 795d  elf.e_phz_array]
-00021b90: 290d 0a0d 0a20 2020 2020 2020 2065 7863  )....        exc
-00021ba0: 6570 7420 3a20 0d0a 2020 2020 2020 2020  ept : ..        
-00021bb0: 2020 2020 7261 6973 6520 4353 6578 2e70      raise CSex.p
-00021bc0: 7943 5341 4d54 4572 726f 725f 7661 6c75  yCSAMTError_valu
-00021bd0: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
-00021be0: 2020 2020 2256 616c 7565 7320 7072 6f76      "Values prov
-00021bf0: 6964 6564 2066 6f72 2074 6865 2045 2d70  ided for the E-p
-00021c00: 6861 7365 2061 7265 2077 726f 6e67 2e22  hase are wrong."
-00021c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00021c20: 2020 2022 206d 7573 7420 6265 2066 6c6f     " must be flo
-00021c30: 6174 206f 7220 696e 7465 6765 7220 2e22  at or integer ."
-00021c40: 290d 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00021c50: 6c66 2e74 6f5f 6465 6772 6565 203a 2023  lf.to_degree : #
-00021c60: 2d2d 2d3e 2073 6574 2061 6e67 6c65 2074  ---> set angle t
-00021c70: 6f20 6465 6772 6565 202e 0d0a 2020 2020  o degree ...    
-00021c80: 2020 2020 2020 2020 7365 6c66 2e65 5f70          self.e_p
-00021c90: 687a 5f61 7272 6179 203d 6e70 2e61 7070  hz_array =np.app
-00021ca0: 6c79 5f61 6c6f 6e67 5f61 7869 7320 280d  ly_along_axis (.
-00021cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021cc0: 206c 616d 6264 6120 6570 687a 3a20 6570   lambda ephz: ep
-00021cd0: 687a 202a 2031 3830 2f6e 702e 7069 2c20  hz * 180/np.pi, 
-00021ce0: 302c 7365 6c66 2e65 5f70 687a 5f61 7272  0,self.e_phz_arr
-00021cf0: 6179 2920 2020 2020 2020 200d 0a20 2020  ay)        ..   
-00021d00: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00021d10: 2020 200d 0a20 2020 2020 2020 2076 636f     ..        vco
-00021d20: 756e 7473 5f65 5f70 687a 2c20 7265 7065  unts_e_phz, repe
-00021d30: 6174 5f65 7068 7a3d 6e70 2e75 6e69 7175  at_ephz=np.uniqu
-00021d40: 6520 2873 656c 662e 655f 7068 7a5f 6172  e (self.e_phz_ar
-00021d50: 7261 792c 200d 0a20 2020 2020 2020 2020  ray, ..         
-00021d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d80: 2020 2020 2072 6574 7572 6e5f 636f 756e       return_coun
-00021d90: 7473 3d54 7275 6529 0d0a 2020 2020 2020  ts=True)..      
-00021da0: 2020 7365 6c66 2e76 616c 7565 203d 7663    self.value =vc
-00021db0: 6f75 6e74 735f 655f 7068 7a0d 0a20 2020  ounts_e_phz..   
-00021dc0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00021dd0: 656c 662e 6d61 782c 2073 656c 662e 6d69  elf.max, self.mi
-00021de0: 6e20 3d76 636f 756e 7473 5f65 5f70 687a  n =vcounts_e_phz
-00021df0: 2e6d 6178 2829 2c20 7663 6f75 6e74 735f  .max(), vcounts_
-00021e00: 655f 7068 7a2e 6d69 6e28 290d 0a20 2020  e_phz.min()..   
-00021e10: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
-00021e20: 0a20 2020 2020 2020 2074 7275 6e63 6174  .        truncat
-00021e30: 6564 5f65 5f70 687a 3d5a 6363 2e74 7275  ed_e_phz=Zcc.tru
-00021e40: 6e63 6174 6564 5f64 6174 6128 2064 6174  ncated_data( dat
-00021e50: 6120 3d73 656c 662e 655f 7068 7a5f 6172  a =self.e_phz_ar
-00021e60: 7261 792c 200d 0a20 2020 2020 2020 2020  ray, ..         
+0001e5b0: 2020 2020 2065 766f 6c75 7469 6f6e 206f       evolution o
+0001e5c0: 6620 6375 7272 656e 7420 6461 7461 206f  f current data o
+0001e5d0: 6e20 7468 6520 7369 7465 200d 0a20 2020  n the site ..   
+0001e5e0: 2020 2020 202a 2a6e 756d 6265 725f 6f66       **number_of
+0001e5f0: 5f73 7461 7469 6f6e 732a 2a20 3a20 696e  _stations** : in
+0001e600: 7420 200d 0a20 2020 2020 2020 2020 2020  t  ..           
+0001e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e620: 206e 756d 6265 7220 6f66 2073 7572 7665   number of surve
+0001e630: 795f 7374 6174 696f 6e73 202e 200d 0a20  y_stations . .. 
+0001e640: 2020 2020 2020 202a 2a6e 756d 6265 725f         **number_
+0001e650: 6f66 5f66 7265 7175 656e 6369 6573 2a2a  of_frequencies**
+0001e660: 3a20 696e 7420 0d0a 2020 2020 2020 2020  : int ..        
+0001e670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e680: 2020 2020 206e 756d 6265 7220 6f66 2066       number of f
+0001e690: 7265 7175 656e 6369 6573 2064 7572 696e  requencies durin
+0001e6a0: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
+0001e6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e6c0: 7468 6520 7375 7276 6579 2066 6f72 2065  the survey for e
+0001e6d0: 6163 6820 7374 6174 696f 6e20 6c6f 6361  ach station loca
+0001e6e0: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
+0001e6f0: 2020 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d    ..    ========
+0001e700: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
+0001e710: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+0001e720: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001e730: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001e740: 3d3d 3d0d 0a20 2020 2041 7474 7269 6275  ===..    Attribu
+0001e750: 7465 7320 2020 2020 2020 2020 5479 7065  tes         Type
+0001e760: 2020 2020 2020 2020 4578 706c 616e 6174          Explanat
+0001e770: 696f 6e0d 0a20 2020 203d 3d3d 3d3d 3d3d  ion..    =======
+0001e780: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+0001e790: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+0001e7a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001e7b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001e7c0: 3d3d 3d3d 0d0a 2020 2020 7661 6c75 6520  ====..    value 
+0001e7d0: 2020 2020 2020 2020 2020 2020 6e64 2e61              nd.a
+0001e7e0: 7272 6179 2020 2020 2020 6461 7461 206f  rray      data o
+0001e7f0: 6620 416d 7020 2063 6f6c 756d 6e20 206f  f Amp  column  o
+0001e800: 6e20 6176 6766 696c 6520 2020 0d0a 2020  n avgfile   ..  
+0001e810: 2020 6d61 7820 2020 2020 2020 2020 2020    max           
+0001e820: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
+0001e830: 2020 6d61 7869 6d75 6d20 6375 7272 656e    maximum curren
+0001e840: 7420 656e 666f 7263 6520 2061 2074 6861  t enforce  a tha
+0001e850: 7420 706f 696e 740d 0a20 2020 206d 696e  t point..    min
+0001e860: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001e870: 6c6f 6174 2020 2020 2020 2020 206d 696e  loat         min
+0001e880: 696d 756e 2063 7572 7265 6e74 2075 6e69  imun current uni
+0001e890: 7420 3a61 6d70 2028 4129 2020 0d0a 2020  t :amp (A)  ..  
+0001e8a0: 2020 6c6f 6320 2020 2020 2020 2020 2020    loc           
+0001e8b0: 2020 2020 6469 6374 2020 2020 2020 2020      dict        
+0001e8c0: 2020 6d61 696e 2061 7474 7269 6275 7465    main attribute
+0001e8d0: 206c 6f63 6174 696f 6e20 6f66 2073 7461   location of sta
+0001e8e0: 7469 6f6e 2077 6974 6820 0d0a 2020 2020  tion with ..    
+0001e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e910: 7468 6520 6375 7272 656e 7420 656e 666f  the current enfo
+0001e920: 7263 6520 6120 7468 6174 2070 6f69 6e74  rce a that point
+0001e930: 202e 6567 206c 6f63 200d 0a20 2020 2020   .eg loc ..     
+0001e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e950: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0001e960: 2753 3037 275d 2073 686f 7720 7468 6520  'S07'] show the 
+0001e970: 6375 7272 656e 7420 416d 7073 2d64 6174  current Amps-dat
+0001e980: 610d 0a20 2020 2020 2020 2020 2020 2020  a..             
+0001e990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e9a0: 2020 2020 2020 2061 7420 7468 6174 2070         at that p
+0001e9b0: 6f69 6e74 0d0a 2020 2020 3d3d 3d3d 3d3d  oint..    ======
+0001e9c0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
+0001e9d0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
+0001e9e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001e9f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001ea00: 3d3d 3d3d 3d0d 0a0d 0a20 2020 204d 6f72  =====....    Mor
+0001ea10: 6520 6174 7472 6962 7574 6573 2063 616e  e attributes can
+0001ea20: 2062 6520 6164 6465 6420 6279 2069 6e70   be added by inp
+0001ea30: 7574 696e 6720 6120 6b65 7920 776f 7264  uting a key word
+0001ea40: 2064 6963 7469 6f6e 6172 790d 0a20 2020   dictionary..   
+0001ea50: 200d 0a20 2020 203a 4578 616d 706c 653a   ..    :Example:
+0001ea60: 0d0a 2020 2020 2020 2020 200d 0a20 2020  ..         ..   
+0001ea70: 2020 2020 203e 3e3e 2066 726f 6d20 7079       >>> from py
+0001ea80: 6373 616d 742e 636f 7265 2e61 7667 2069  csamt.core.avg i
+0001ea90: 6d70 6f72 7420 4176 670d 0a20 2020 2020  mport Avg..     
+0001eaa0: 2020 203e 3e3e 2070 6174 683d 6f73 2e70     >>> path=os.p
+0001eab0: 6174 682e 6a6f 696e 286f 732e 656e 7669  ath.join(os.envi
+0001eac0: 726f 6e5b 2270 7943 5341 4d54 225d 2c20  ron["pyCSAMT"], 
+0001ead0: 0d0a 2020 2020 2020 2020 2e2e 2e20 2020  ..        ...   
+0001eae0: 2020 2027 7079 6373 616d 7427 2c20 2264     'pycsamt', "d
+0001eaf0: 6174 6122 2c20 224b 312e 4156 4722 290d  ata", "K1.AVG").
+0001eb00: 0a20 2020 2020 2020 203e 3e3e 2061 7667  .        >>> avg
+0001eb10: 5f6f 626a 3d41 7667 2870 6174 6829 0d0a  _obj=Avg(path)..
+0001eb20: 2020 2020 2020 2020 3e3e 3e20 616d 7073          >>> amps
+0001eb30: 5f6f 626a 203d 6176 675f 6f62 6a2e 4461  _obj =avg_obj.Da
+0001eb40: 7461 5f73 6563 7469 6f6e 2e41 6d70 732e  ta_section.Amps.
+0001eb50: 6c6f 635b 2753 3030 275d 0d0a 2020 2020  loc['S00']..    
+0001eb60: 2020 2020 3e3e 3e20 7072 696e 7428 616d      >>> print(am
+0001eb70: 705f 6f62 6a29 0d0a 2020 2020 2222 220d  p_obj)..    """.
+0001eb80: 0a0d 0a20 2020 2064 6566 205f 5f69 6e69  ...    def __ini
+0001eb90: 745f 5f28 7365 6c66 2c20 616d 7073 5f61  t__(self, amps_a
+0001eba0: 7272 6179 3d20 4e6f 6e65 2c20 6e75 6d62  rray= None, numb
+0001ebb0: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+0001ebc0: 733d 4e6f 6e65 202c 200d 0a20 2020 2020  s=None , ..     
+0001ebd0: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+0001ebe0: 6572 5f6f 665f 7374 6174 696f 6e73 3d4e  er_of_stations=N
+0001ebf0: 6f6e 6520 2c20 2a2a 6b77 6172 6773 293a  one , **kwargs):
+0001ec00: 0d0a 0d0a 2020 2020 2020 2020 0d0a 2020  ....        ..  
+0001ec10: 2020 2020 2020 7365 6c66 2e5f 616d 7073        self._amps
+0001ec20: 5f61 7272 6179 203d 616d 7073 5f61 7272  _array =amps_arr
+0001ec30: 6179 0d0a 2020 2020 2020 2020 0d0a 2020  ay..        ..  
+0001ec40: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
+0001ec50: 725f 6f66 5f73 7461 7469 6f6e 7320 3d6b  r_of_stations =k
+0001ec60: 7761 7267 732e 706f 7028 226e 756d 6265  wargs.pop("numbe
+0001ec70: 725f 6f66 5f73 7461 7469 6f6e 7322 2c20  r_of_stations", 
+0001ec80: 4e6f 6e65 290d 0a20 2020 2020 2020 2073  None)..        s
+0001ec90: 656c 662e 6e66 7265 7120 3d6b 7761 7267  elf.nfreq =kwarg
+0001eca0: 732e 706f 7028 276e 756d 6265 725f 6f66  s.pop('number_of
+0001ecb0: 5f66 7265 7175 656e 6369 6573 272c 204e  _frequencies', N
+0001ecc0: 6f6e 6529 0d0a 2020 2020 2020 2020 0d0a  one)..        ..
+0001ecd0: 2020 2020 2020 2020 7365 6c66 2e76 616c          self.val
+0001ece0: 7565 203d 4e6f 6e65 200d 0a20 2020 2020  ue =None ..     
+0001ecf0: 2020 2073 656c 662e 6d69 6e20 3d20 4e6f     self.min = No
+0001ed00: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
+0001ed10: 662e 6d61 7820 3d20 4e6f 6e65 200d 0a20  f.max = None .. 
+0001ed20: 2020 200d 0a20 2020 2020 2020 2066 6f72     ..        for
+0001ed30: 206b 6579 2069 6e20 6c69 7374 286b 7761   key in list(kwa
+0001ed40: 7267 732e 6b65 7973 2829 293a 0d0a 2020  rgs.keys()):..  
+0001ed50: 2020 2020 2020 2020 2020 7365 7461 7474            setatt
+0001ed60: 7228 7365 6c66 2c20 6b65 792c 206b 7761  r(self, key, kwa
+0001ed70: 7267 735b 6b65 795d 290d 0a20 2020 2020  rgs[key])..     
+0001ed80: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001ed90: 2069 6620 7365 6c66 2e5f 616d 7073 5f61   if self._amps_a
+0001eda0: 7272 6179 2069 7320 6e6f 7420 4e6f 6e65  rray is not None
+0001edb0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+0001edc0: 2073 656c 662e 5f72 6561 645f 616d 7073   self._read_amps
+0001edd0: 5f64 6174 6128 290d 0a20 2020 2020 2020  _data()..       
+0001ede0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0001edf0: 2064 6566 205f 7265 6164 5f61 6d70 735f   def _read_amps_
+0001ee00: 6461 7461 2028 7365 6c66 2c20 616d 7073  data (self, amps
+0001ee10: 5f61 7272 6179 3d20 4e6f 6e65 2c20 6e75  _array= None, nu
+0001ee20: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
+0001ee30: 6965 733d 4e6f 6e65 202c 0d0a 2020 2020  ies=None ,..    
+0001ee40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee50: 2020 2020 206e 756d 6265 725f 6f66 5f73       number_of_s
+0001ee60: 7461 7469 6f6e 733d 4e6f 6e65 2029 3a0d  tations=None ):.
+0001ee70: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0001ee80: 2020 2020 2020 4d65 7468 6f64 2074 6f20        Method to 
+0001ee90: 7265 6164 2061 6e64 2061 7261 6e67 6520  read and arange 
+0001eea0: 6461 7461 2061 6363 6f72 6469 6e67 2065  data according e
+0001eeb0: 6163 6820 7374 6174 696f 6e20 2f61 6d70  ach station /amp
+0001eec0: 7320 7661 6c75 6573 202e 0d0a 2020 2020  s values ...    
+0001eed0: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+0001eee0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0001eef0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0001ef00: 2020 2020 2020 2020 2020 2a20 616d 7073            * amps
+0001ef10: 5f61 7272 6179 203a 206e 6461 7272 6179  _array : ndarray
+0001ef20: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+0001ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef40: 2020 2020 2020 2020 616d 7073 205f 6375          amps _cu
+0001ef50: 7272 656e 7420 6f62 7365 7276 6564 2073  rrent observed s
+0001ef60: 6974 6573 2e20 0d0a 2020 2020 2020 2020  ites. ..        
+0001ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef80: 2020 2020 5468 6520 2a64 6566 6175 6c74      The *default
+0001ef90: 2a20 6973 204e 6f6e 652e 0d0a 2020 2020  * is None...    
+0001efa0: 2020 2020 2020 2020 2a20 6e75 6d62 6572          * number
+0001efb0: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
+0001efc0: 3a20 696e 7420 2c20 6f70 7469 6f6e 616c  : int , optional
+0001efd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001efe0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+0001eff0: 6d62 6572 206f 6620 6672 6571 7565 6e63  mber of frequenc
+0001f000: 6965 7320 666f 7220 7375 7276 6579 2e0d  ies for survey..
+0001f010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f020: 2020 2020 2020 2020 2020 2020 2054 6865               The
+0001f030: 202a 6465 6661 756c 742a 2069 7320 4e6f   *default* is No
+0001f040: 6e65 2e0d 0a20 2020 2020 2020 2020 2020  ne...           
+0001f050: 202a 206e 756d 6265 725f 6f66 5f73 7461   * number_of_sta
+0001f060: 7469 6f6e 7320 3a20 696e 7420 2c20 6f70  tions : int , op
+0001f070: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+0001f080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f090: 2020 2020 6e75 6d62 6572 5f6f 6620 7374      number_of st
+0001f0a0: 6174 696f 6e73 2e20 0d0a 2020 2020 2020  ations. ..      
+0001f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f0c0: 2020 2020 2020 5468 6520 2a64 6566 6175        The *defau
+0001f0d0: 6c74 2a20 6973 204e 6f6e 652e 0d0a 2020  lt* is None...  
+0001f0e0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0001f0f0: 2020 2069 6620 616d 7073 5f61 7272 6179     if amps_array
+0001f100: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
+0001f110: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001f120: 662e 5f61 6d70 735f 6172 7261 7920 3d61  f._amps_array =a
+0001f130: 6d70 735f 6172 7261 7920 0d0a 2020 2020  mps_array ..    
+0001f140: 2020 2020 6966 2073 656c 662e 5f61 6d70      if self._amp
+0001f150: 735f 6172 7261 7920 6973 204e 6f6e 6520  s_array is None 
+0001f160: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001f170: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0001f180: 274e 6f20 416d 7065 7273 2064 6174 6120  'No Ampers data 
+0001f190: 2127 290d 0a20 2020 2020 2020 2020 2020  !')..           
+0001f1a0: 200d 0a20 2020 2020 2020 2069 6620 6e75   ..        if nu
+0001f1b0: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
+0001f1c0: 6965 7320 6973 206e 6f74 204e 6f6e 6520  ies is not None 
+0001f1d0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001f1e0: 7365 6c66 2e6e 6672 6571 203d 6e75 6d62  self.nfreq =numb
+0001f1f0: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+0001f200: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
+0001f210: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0001f220: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0001f230: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001f240: 2020 2250 6c65 6173 6520 7370 6563 6966    "Please specif
+0001f250: 7920 7468 6520 6e75 6d62 6572 206f 6620  y the number of 
+0001f260: 6672 6571 7565 6e63 7920 2122 290d 0a20  frequency !").. 
+0001f270: 2020 2020 2020 2069 6620 6e75 6d62 6572         if number
+0001f280: 5f6f 665f 7374 6174 696f 6e73 2069 7320  _of_stations is 
+0001f290: 6e6f 7420 4e6f 6e65 203a 200d 0a20 2020  not None : ..   
+0001f2a0: 2020 2020 2020 2020 2073 656c 662e 6e75           self.nu
+0001f2b0: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0001f2c0: 203d 6e75 6d62 6572 5f6f 665f 7374 6174   =number_of_stat
+0001f2d0: 696f 6e73 200d 0a20 2020 2020 2020 2065  ions ..        e
+0001f2e0: 6c73 6520 3a20 7261 6973 6520 5479 7065  lse : raise Type
+0001f2f0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+0001f300: 2020 2020 2750 6c65 6173 6520 7370 6563      'Please spec
+0001f310: 6966 7920 7468 6520 6e75 6d62 6572 206f  ify the number o
+0001f320: 6620 7374 6174 696f 6e73 2729 0d0a 2020  f stations')..  
+0001f330: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0001f340: 2020 2020 7472 7920 3a20 0d0a 2020 2020      try : ..    
+0001f350: 2020 2020 2020 2020 7365 6c66 2e6e 6672          self.nfr
+0001f360: 6571 3d6e 702e 696e 7428 7365 6c66 2e6e  eq=np.int(self.n
+0001f370: 6672 6571 290d 0a20 2020 2020 2020 2020  freq)..         
+0001f380: 2020 2073 656c 662e 6e75 6d62 6572 5f6f     self.number_o
+0001f390: 665f 7374 6174 696f 6e73 203d 6e70 2e69  f_stations =np.i
+0001f3a0: 6e74 2873 656c 662e 6e75 6d62 6572 5f6f  nt(self.number_o
+0001f3b0: 665f 7374 6174 696f 6e73 290d 0a20 2020  f_stations)..   
+0001f3c0: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
+0001f3d0: 6d70 735f 6172 7261 793d 6e70 2e61 7272  mps_array=np.arr
+0001f3e0: 6179 285b 6e70 2e66 6c6f 6174 2863 6329  ay([np.float(cc)
+0001f3f0: 2066 6f72 2063 6320 696e 2073 656c 662e   for cc in self.
+0001f400: 5f61 6d70 735f 6172 7261 795d 290d 0a0d  _amps_array])...
+0001f410: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0001f420: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001f430: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001f440: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0001f450: 2020 2022 5661 6c75 6573 2070 726f 7669     "Values provi
+0001f460: 6465 6420 666f 7220 7468 6520 616d 7020  ded for the amp 
+0001f470: 6172 6520 7772 6f6e 672e 220d 0a20 2020  are wrong."..   
+0001f480: 2020 2020 2020 2020 2020 2020 2022 206d               " m
+0001f490: 7573 7420 6265 2066 6c6f 6174 206f 7220  ust be float or 
+0001f4a0: 696e 7465 6765 7220 2e22 290d 0a20 2020  integer .")..   
+0001f4b0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0001f4c0: 2020 2076 636f 756e 7473 5f61 6d70 732c     vcounts_amps,
+0001f4d0: 2072 6570 6561 745f 616d 7020 3d6e 702e   repeat_amp =np.
+0001f4e0: 756e 6971 7565 2028 0d0a 2020 2020 2020  unique (..      
+0001f4f0: 2020 2020 2020 7365 6c66 2e5f 616d 7073        self._amps
+0001f500: 5f61 7272 6179 2c20 7265 7475 726e 5f63  _array, return_c
+0001f510: 6f75 6e74 733d 5472 7565 290d 0a20 2020  ounts=True)..   
+0001f520: 2020 2020 2073 656c 662e 7661 6c75 6520       self.value 
+0001f530: 3d76 636f 756e 7473 5f61 6d70 730d 0a20  =vcounts_amps.. 
+0001f540: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001f550: 2073 656c 662e 6d61 782c 2073 656c 662e   self.max, self.
+0001f560: 6d69 6e20 3d76 636f 756e 7473 5f61 6d70  min =vcounts_amp
+0001f570: 732e 6d61 7828 292c 2076 636f 756e 7473  s.max(), vcounts
+0001f580: 5f61 6d70 732e 6d69 6e28 290d 0a20 2020  _amps.min()..   
+0001f590: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
+0001f5a0: 0a20 2020 2020 2020 2074 7275 6e63 6174  .        truncat
+0001f5b0: 6564 5f61 6d70 733d 5a63 632e 7472 756e  ed_amps=Zcc.trun
+0001f5c0: 6361 7465 645f 6461 7461 2820 6461 7461  cated_data( data
+0001f5d0: 203d 7365 6c66 2e5f 616d 7073 5f61 7272   =self._amps_arr
+0001f5e0: 6179 2c20 0d0a 2020 2020 2020 2020 2020  ay, ..          
+0001f5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f600: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0001f610: 6265 725f 6f66 5f72 6563 6375 7265 6e63  ber_of_reccurenc
+0001f620: 653d 7365 6c66 2e6e 6672 6571 290d 0a20  e=self.nfreq).. 
+0001f630: 2020 2020 2020 206e 616d 652c 2070 6f6c         name, pol
+0001f640: 796e 616d 6520 3d20 5a63 632e 5f6e 756d  yname = Zcc._num
+0001f650: 6265 7269 6e67 5f73 7461 7469 6f6e 280d  bering_station(.
+0001f660: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0001f670: 6265 725f 6f66 5f73 7461 7469 6f6e 3d73  ber_of_station=s
+0001f680: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
+0001f690: 6174 696f 6e73 2c20 0d0a 2020 2020 2020  ations, ..      
+0001f6a0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
+0001f6b0: 6672 6571 203d 7365 6c66 2e6e 6672 6571  freq =self.nfreq
+0001f6c0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0001f6d0: 6c6f 6320 3d7b 206b 6579 3a76 616c 7565  loc ={ key:value
+0001f6e0: 2066 6f72 206b 6579 2c20 7661 6c75 6520   for key, value 
+0001f6f0: 696e 207a 6970 286e 616d 652c 2074 7275  in zip(name, tru
+0001f700: 6e63 6174 6564 5f61 6d70 7320 297d 0d0a  ncated_amps )}..
+0001f710: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001f720: 2020 0d0a 2020 2020 2020 2020 0d0a 636c    ..        ..cl
+0001f730: 6173 7320 456d 6167 2028 6f62 6a65 6374  ass Emag (object
+0001f740: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+0001f750: 2045 2d66 6965 6c64 206d 6167 6e69 7475   E-field magnitu
+0001f760: 6465 2028 6d69 6372 6f56 6f6c 7473 2f28  de (microVolts/(
+0001f770: 6b69 6c6f 4d65 7465 722a 416d 7029 290d  kiloMeter*Amp)).
+0001f780: 0a20 2020 200d 0a20 2020 2041 7267 756d  .    ..    Argum
+0001f790: 656e 7473 200d 0a20 2020 202d 2d2d 2d2d  ents ..    -----
+0001f7a0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
+0001f7b0: 2a65 5f6d 6167 5f61 7272 6179 2a2a 3a20  *e_mag_array**: 
+0001f7c0: 6e64 6172 7261 790d 0a20 2020 2020 2020  ndarray..       
+0001f7d0: 2020 2020 2020 2020 2045 5f66 6965 6c64           E_field
+0001f7e0: 206d 6167 6e69 7475 6465 2043 6c61 7373   magnitude Class
+0001f7f0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0001f800: 2020 2020 2020 0d0a 2020 2020 3d3d 3d3d        ..    ====
+0001f810: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
+0001f820: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+0001f830: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001f840: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001f850: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2041 7474  =======..    Att
+0001f860: 7269 6275 7465 7320 2020 2020 2020 2020  ributes         
+0001f870: 5479 7065 2020 2020 2020 2020 4578 706c  Type        Expl
+0001f880: 616e 6174 696f 6e0d 0a20 2020 203d 3d3d  anation..    ===
+0001f890: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
+0001f8a0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
+0001f8b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001f8c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001f8d0: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 7661  ========..    va
+0001f8e0: 6c75 6520 2020 2020 2020 2020 2020 2020  lue             
+0001f8f0: 6e64 2e61 7272 6179 2020 2020 2020 6461  nd.array      da
+0001f900: 7461 206f 6620 456d 6167 2020 636f 6c75  ta of Emag  colu
+0001f910: 6d6e 206f 6e20 6176 6766 696c 6520 2020  mn on avgfile   
+0001f920: 0d0a 2020 2020 6d61 7820 2020 2020 2020  ..    max       
+0001f930: 2020 2020 2020 2020 666c 6f61 7420 2020          float   
+0001f940: 2020 2020 2020 6d61 7869 6d75 6d20 452d        maximum E-
+0001f950: 4669 656c 6420 6d61 676e 6974 7564 6520  Field magnitude 
+0001f960: 756e 6974 203a 6d56 2f6b 6d2a 416d 7020  unit :mV/km*Amp 
+0001f970: 0d0a 2020 2020 6c6f 6320 2020 2020 2020  ..    loc       
+0001f980: 2020 2020 2020 2020 6469 6374 2020 2020          dict    
+0001f990: 2020 2020 2020 6c6f 6361 7469 6f6e 206f        location o
+0001f9a0: 6620 452d 4669 656c 6420 206d 6167 6e69  f E-Field  magni
+0001f9b0: 7475 6465 2076 616c 7565 2061 7420 0d0a  tude value at ..
+0001f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f9e0: 2020 2020 7468 6520 7374 6174 696f 6e20      the station 
+0001f9f0: 6c61 6d62 6461 2e65 3a67 203a 206c 6f63  lambda.e:g : loc
+0001fa00: 5b27 5330 3027 5d20 7368 6f77 200d 0a20  ['S00'] show .. 
+0001fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa30: 2020 2074 6865 2063 7572 7265 6e74 2020     the current  
+0001fa40: 452d 6d61 6720 6461 7461 206f 6620 7374  E-mag data of st
+0001fa50: 6174 696f 6e20 0d0a 2020 2020 2020 2020  ation ..        
+0001fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa70: 2020 2020 2020 2020 2020 2020 6174 2074              at t
+0001fa80: 6861 7420 706f 696e 742e 0d0a 2020 2020  hat point...    
+0001fa90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001faa0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d    ===========  =
+0001fab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001fac0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001fad0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d 0a20  ===========.... 
+0001fae0: 2020 204d 6f72 6520 6174 7472 6962 7574     More attribut
+0001faf0: 6573 2063 616e 2062 6520 6164 6465 6420  es can be added 
+0001fb00: 6279 2069 6e70 7574 696e 6720 6120 6b65  by inputing a ke
+0001fb10: 7920 776f 7264 2064 6963 7469 6f6e 6172  y word dictionar
+0001fb20: 790d 0a20 2020 200d 0a20 2020 203a 4578  y..    ..    :Ex
+0001fb30: 616d 706c 653a 200d 0a20 2020 2020 2020  ample: ..       
+0001fb40: 200d 0a20 2020 2020 2020 203e 3e3e 2066   ..        >>> f
+0001fb50: 726f 6d20 7079 6373 616d 742e 636f 7265  rom pycsamt.core
+0001fb60: 2e61 7667 2069 6d70 6f72 7420 4176 670d  .avg import Avg.
+0001fb70: 0a20 2020 2020 2020 203e 3e3e 2070 6174  .        >>> pat
+0001fb80: 683d 6f73 2e70 6174 682e 6a6f 696e 286f  h=os.path.join(o
+0001fb90: 732e 656e 7669 726f 6e5b 2270 7943 5341  s.environ["pyCSA
+0001fba0: 4d54 225d 2c20 0d0a 2020 2020 2020 2020  MT"], ..        
+0001fbb0: 2e2e 2e20 2020 2020 2027 7079 6373 616d  ...      'pycsam
+0001fbc0: 7427 2c20 2264 6174 6122 2c20 224b 312e  t', "data", "K1.
+0001fbd0: 4156 4722 290d 0a20 2020 2020 2020 203e  AVG")..        >
+0001fbe0: 3e3e 2061 7667 5f6f 626a 3d41 7667 2870  >> avg_obj=Avg(p
+0001fbf0: 6174 6829 0d0a 2020 2020 2020 2020 3e3e  ath)..        >>
+0001fc00: 3e20 656d 6167 5f6f 626a 203d 6176 675f  > emag_obj =avg_
+0001fc10: 6f62 6a2e 4461 7461 5f73 6563 7469 6f6e  obj.Data_section
+0001fc20: 2e45 6d61 672e 6c6f 635b 2753 3032 275d  .Emag.loc['S02']
+0001fc30: 0d0a 2020 2020 2020 2020 2e2e 2e20 7072  ..        ... pr
+0001fc40: 696e 7428 656d 6167 5f6f 626a 290d 0a20  int(emag_obj).. 
+0001fc50: 2020 2022 2222 0d0a 2020 2020 6465 6620     """..    def 
+0001fc60: 5f5f 696e 6974 5f5f 2873 656c 662c 2065  __init__(self, e
+0001fc70: 5f6d 6167 5f61 7272 6179 3d4e 6f6e 652c  _mag_array=None,
+0001fc80: 206e 756d 6265 725f 6f66 5f66 7265 7175   number_of_frequ
+0001fc90: 656e 6369 6573 3d4e 6f6e 6520 2c0d 0a20  encies=None ,.. 
+0001fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fcb0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+0001fcc0: 6e73 3d4e 6f6e 6520 2c20 2a2a 6b77 6172  ns=None , **kwar
+0001fcd0: 6773 293a 0d0a 2020 2020 2020 2020 0d0a  gs):..        ..
+0001fce0: 2020 2020 2020 2020 7365 6c66 2e65 5f6d          self.e_m
+0001fcf0: 6167 5f61 7272 6179 203d 655f 6d61 675f  ag_array =e_mag_
+0001fd00: 6172 7261 790d 0a20 2020 2020 2020 200d  array..        .
+0001fd10: 0a20 2020 2020 2020 2073 656c 662e 6e75  .        self.nu
+0001fd20: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0001fd30: 203d 6b77 6172 6773 2e70 6f70 2822 6e75   =kwargs.pop("nu
+0001fd40: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0001fd50: 222c 204e 6f6e 6529 0d0a 2020 2020 2020  ", None)..      
+0001fd60: 2020 7365 6c66 2e6e 6672 6571 203d 6b77    self.nfreq =kw
+0001fd70: 6172 6773 2e70 6f70 2827 6e75 6d62 6572  args.pop('number
+0001fd80: 5f6f 665f 6672 6571 7565 6e63 6965 7327  _of_frequencies'
+0001fd90: 2c20 4e6f 6e65 290d 0a20 2020 2020 2020  , None)..       
+0001fda0: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+0001fdb0: 7661 6c75 6520 3d4e 6f6e 6520 0d0a 2020  value =None ..  
+0001fdc0: 2020 2020 2020 7365 6c66 2e6d 696e 203d        self.min =
+0001fdd0: 204e 6f6e 6520 0d0a 2020 2020 2020 2020   None ..        
+0001fde0: 7365 6c66 2e6d 6178 203d 204e 6f6e 6520  self.max = None 
+0001fdf0: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
+0001fe00: 666f 7220 6b65 7920 696e 206c 6973 7428  for key in list(
+0001fe10: 6b77 6172 6773 2e6b 6579 7328 2929 3a0d  kwargs.keys()):.
+0001fe20: 0a20 2020 2020 2020 2020 2020 2073 6574  .            set
+0001fe30: 6174 7472 2873 656c 662c 206b 6579 2c20  attr(self, key, 
+0001fe40: 6b77 6172 6773 5b6b 6579 5d29 0d0a 2020  kwargs[key])..  
+0001fe50: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0001fe60: 2020 2020 6966 2073 656c 662e 655f 6d61      if self.e_ma
+0001fe70: 675f 6172 7261 7920 2069 7320 6e6f 7420  g_array  is not 
+0001fe80: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+0001fe90: 2020 2020 2073 656c 662e 5f72 6561 645f       self._read_
+0001fea0: 656d 6167 5f64 6174 6120 2829 0d0a 2020  emag_data ()..  
+0001feb0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0001fec0: 0d0a 2020 2020 6465 6620 5f72 6561 645f  ..    def _read_
+0001fed0: 656d 6167 5f64 6174 6120 2873 656c 662c  emag_data (self,
+0001fee0: 655f 6d61 675f 6172 7261 793d 4e6f 6e65  e_mag_array=None
+0001fef0: 2c20 6e75 6d62 6572 5f6f 665f 6672 6571  , number_of_freq
+0001ff00: 7565 6e63 6965 733d 4e6f 6e65 202c 200d  uencies=None , .
+0001ff10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ff20: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+0001ff30: 5f6f 665f 7374 6174 696f 6e73 3d4e 6f6e  _of_stations=Non
+0001ff40: 6520 293a 0d0a 2020 2020 2020 2020 2222  e ):..        ""
+0001ff50: 220d 0a20 2020 2020 2020 204d 6574 686f  "..        Metho
+0001ff60: 6420 746f 2072 6561 6420 616e 6420 6172  d to read and ar
+0001ff70: 616e 6765 2064 6174 6120 6163 636f 7264  ange data accord
+0001ff80: 696e 6720 6561 6368 200d 0a20 2020 2020  ing each ..     
+0001ff90: 2020 2073 7461 7469 6f6e 202f 655f 6669     station /e_fi
+0001ffa0: 656c 6420 6d61 676e 6974 7564 6520 7661  eld magnitude va
+0001ffb0: 6c75 6573 202e 0d0a 2020 2020 2020 2020  lues ...        
+0001ffc0: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+0001ffd0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0001ffe0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0001fff0: 2020 2020 2020 2020 2020 2a20 655f 6d61            * e_ma
+00020000: 675f 6172 7261 7920 3a20 6e64 6172 7261  g_array : ndarra
+00020010: 792c 206f 7074 696f 6e61 6c0d 0a20 2020  y, optional..   
+00020020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020030: 2020 2020 2020 2020 2042 2d46 6965 6c64           B-Field
+00020040: 206d 6167 6e69 7475 6465 206f 6273 6572   magnitude obser
+00020050: 7665 6420 6174 2065 6163 6820 7374 6174  ved at each stat
+00020060: 696f 6e2e 0d0a 2020 2020 2020 2020 2020  ion...          
+00020070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020080: 2020 5468 6520 2a64 6566 6175 6c74 2a20    The *default* 
+00020090: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
+000200a0: 2020 2020 2020 2a20 6e75 6d62 6572 5f6f        * number_o
+000200b0: 665f 6672 6571 7565 6e63 6965 7320 3a20  f_frequencies : 
+000200c0: 696e 7420 2c20 6f70 7469 6f6e 616c 0d0a  int , optional..
+000200d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000200e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000200f0: 6e75 6d62 6572 206f 6620 6672 6571 7565  number of freque
+00020100: 6e63 6965 7320 666f 7220 7375 7276 6579  ncies for survey
+00020110: 2e20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
+00020120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020130: 2020 2020 5468 6520 6465 6661 756c 7420      The default 
+00020140: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
+00020150: 2020 2020 2020 2a20 6e75 6d62 6572 5f6f        * number_o
+00020160: 665f 7374 6174 696f 6e73 203a 2069 6e74  f_stations : int
+00020170: 202c 206f 7074 696f 6e61 6c0d 0a20 2020   , optional..   
+00020180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020190: 2020 2020 2020 2020 2020 2020 206e 756d               num
+000201a0: 6265 725f 6f66 2073 7461 7469 6f6e 732e  ber_of stations.
+000201b0: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+000201c0: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2022  None...        "
+000201d0: 2222 0d0a 2020 2020 2020 2020 6966 2065  ""..        if e
+000201e0: 5f6d 6167 5f61 7272 6179 2069 7320 6e6f  _mag_array is no
+000201f0: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
+00020200: 2020 2020 2020 2073 656c 662e 655f 6d61         self.e_ma
+00020210: 675f 6172 7261 7920 3d65 5f6d 6167 5f61  g_array =e_mag_a
+00020220: 7272 6179 200d 0a20 2020 2020 2020 2069  rray ..        i
+00020230: 6620 7365 6c66 2e65 5f6d 6167 5f61 7272  f self.e_mag_arr
+00020240: 6179 2069 7320 4e6f 6e65 203a 200d 0a20  ay is None : .. 
+00020250: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00020260: 2054 7970 6545 7272 6f72 2827 4e6f 2045   TypeError('No E
+00020270: 2d46 6965 6c64 2020 6461 7461 2066 6f75  -Field  data fou
+00020280: 6e64 2020 2127 290d 0a20 2020 2020 2020  nd  !')..       
+00020290: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+000202a0: 6620 6e75 6d62 6572 5f6f 665f 6672 6571  f number_of_freq
+000202b0: 7565 6e63 6965 7320 6973 206e 6f74 204e  uencies is not N
+000202c0: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
+000202d0: 2020 2020 7365 6c66 2e6e 6672 6571 203d      self.nfreq =
+000202e0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+000202f0: 6e63 6965 7320 0d0a 2020 2020 2020 2020  ncies ..        
+00020300: 656c 7365 203a 0d0a 2020 2020 2020 2020  else :..        
+00020310: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00020320: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+00020330: 2020 2020 2020 2250 6c65 6173 6520 7370        "Please sp
+00020340: 6563 6966 7920 7468 6520 6e75 6d62 6572  ecify the number
+00020350: 206f 6620 6672 6571 7565 6e63 7920 2122   of frequency !"
+00020360: 290d 0a20 2020 2020 2020 2069 6620 6e75  )..        if nu
+00020370: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+00020380: 2069 7320 6e6f 7420 4e6f 6e65 203a 0d0a   is not None :..
+00020390: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000203a0: 2e6e 756d 6265 725f 6f66 5f73 7461 7469  .number_of_stati
+000203b0: 6f6e 7320 3d6e 756d 6265 725f 6f66 5f73  ons =number_of_s
+000203c0: 7461 7469 6f6e 7320 0d0a 2020 2020 2020  tations ..      
+000203d0: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
+000203e0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+000203f0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00020400: 2020 2020 2020 2020 2750 6c65 6173 6520          'Please 
+00020410: 7370 6563 6966 7920 7468 6520 6e75 6d62  specify the numb
+00020420: 6572 206f 6620 7374 6174 696f 6e73 2729  er of stations')
+00020430: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00020440: 2020 2020 2020 2020 7472 7920 3a20 0d0a          try : ..
+00020450: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00020460: 2e6e 6672 6571 3d6e 702e 696e 7428 7365  .nfreq=np.int(se
+00020470: 6c66 2e6e 6672 6571 290d 0a20 2020 2020  lf.nfreq)..     
+00020480: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+00020490: 6572 5f6f 665f 7374 6174 696f 6e73 203d  er_of_stations =
+000204a0: 6e70 2e69 6e74 2873 656c 662e 6e75 6d62  np.int(self.numb
+000204b0: 6572 5f6f 665f 7374 6174 696f 6e73 290d  er_of_stations).
+000204c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000204d0: 662e 655f 6d61 675f 6172 7261 793d 6e70  f.e_mag_array=np
+000204e0: 2e61 7272 6179 285b 6e70 2e66 6c6f 6174  .array([np.float
+000204f0: 2863 6329 2066 6f72 2063 6320 696e 2073  (cc) for cc in s
+00020500: 656c 662e 655f 6d61 675f 6172 7261 795d  elf.e_mag_array]
+00020510: 290d 0a0d 0a20 2020 2020 2020 2065 7863  )....        exc
+00020520: 6570 7420 3a20 0d0a 2020 2020 2020 2020  ept : ..        
+00020530: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00020540: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00020550: 2020 2020 2020 2022 5661 6c75 6573 2070         "Values p
+00020560: 726f 7669 6465 6420 666f 7220 7468 6520  rovided for the 
+00020570: 616d 7020 6172 6520 7772 6f6e 672e 220d  amp are wrong.".
+00020580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020590: 2020 2220 6d75 7374 2062 6520 666c 6f61    " must be floa
+000205a0: 7420 6f72 2069 6e74 6567 6572 202e 2229  t or integer .")
+000205b0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+000205c0: 2020 2020 2020 2020 7663 6f75 6e74 735f          vcounts_
+000205d0: 655f 6d61 672c 2072 6570 6561 745f 616d  e_mag, repeat_am
+000205e0: 7020 3d6e 702e 756e 6971 7565 2028 7365  p =np.unique (se
+000205f0: 6c66 2e65 5f6d 6167 5f61 7272 6179 2c20  lf.e_mag_array, 
+00020600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020630: 7265 7475 726e 5f63 6f75 6e74 733d 5472  return_counts=Tr
+00020640: 7565 290d 0a20 2020 2020 2020 2073 656c  ue)..        sel
+00020650: 662e 7661 6c75 6520 3d76 636f 756e 7473  f.value =vcounts
+00020660: 5f65 5f6d 6167 0d0a 2020 2020 2020 2020  _e_mag..        
+00020670: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+00020680: 6178 2c20 7365 6c66 2e6d 696e 203d 7663  ax, self.min =vc
+00020690: 6f75 6e74 735f 655f 6d61 672e 6d61 7828  ounts_e_mag.max(
+000206a0: 292c 2076 636f 756e 7473 5f65 5f6d 6167  ), vcounts_e_mag
+000206b0: 2e6d 696e 2829 0d0a 2020 2020 2020 2020  .min()..        
+000206c0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000206d0: 2020 2020 7472 756e 6361 7465 645f 655f      truncated_e_
+000206e0: 6d61 673d 5a63 632e 7472 756e 6361 7465  mag=Zcc.truncate
+000206f0: 645f 6461 7461 2820 6461 7461 203d 7365  d_data( data =se
+00020700: 6c66 2e65 5f6d 6167 5f61 7272 6179 2c20  lf.e_mag_array, 
+00020710: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020730: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+00020740: 6f66 5f72 6563 6375 7265 6e63 653d 7365  of_reccurence=se
+00020750: 6c66 2e6e 6672 6571 290d 0a20 2020 2020  lf.nfreq)..     
+00020760: 2020 206e 616d 652c 2070 6f6c 796e 616d     name, polynam
+00020770: 6520 3d20 5a63 632e 5f6e 756d 6265 7269  e = Zcc._numberi
+00020780: 6e67 5f73 7461 7469 6f6e 280d 0a20 2020  ng_station(..   
+00020790: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+000207a0: 6f66 5f73 7461 7469 6f6e 3d73 656c 662e  of_station=self.
+000207b0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+000207c0: 6e73 2c20 0d0a 2020 2020 2020 2020 2020  ns, ..          
+000207d0: 2020 6e75 6d62 6572 5f6f 665f 6672 6571    number_of_freq
+000207e0: 203d 7365 6c66 2e6e 6672 6571 290d 0a20   =self.nfreq).. 
+000207f0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00020800: 2073 656c 662e 6c6f 6320 3d7b 206b 6579   self.loc ={ key
+00020810: 3a76 616c 7565 2066 6f72 206b 6579 2c20  :value for key, 
+00020820: 7661 6c75 6520 696e 207a 6970 286e 616d  value in zip(nam
+00020830: 652c 2074 7275 6e63 6174 6564 5f65 5f6d  e, truncated_e_m
+00020840: 6167 2029 7d0d 0a20 2020 2020 2020 200d  ag )}..        .
+00020850: 0a20 2020 200d 0a63 6c61 7373 2045 7068  .    ..class Eph
+00020860: 7a20 286f 626a 6563 7429 3a0d 0a20 2020  z (object):..   
+00020870: 2022 2222 0d0a 2020 2020 452d 6669 656c   """..    E-fiel
+00020880: 6420 7068 6173 6520 286d 696c 6c69 5261  d phase (milliRa
+00020890: 6469 616e 7329 0d0a 2020 2020 0d0a 2020  dians)..    ..  
+000208a0: 2020 4172 6775 6d65 6e74 7320 0d0a 2020    Arguments ..  
+000208b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+000208c0: 2020 2020 2020 2a2a 655f 7068 7a5f 6172        **e_phz_ar
+000208d0: 7261 792a 2a20 3a20 6e64 6172 7261 790d  ray** : ndarray.
+000208e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000208f0: 2020 2020 455f 7068 6173 6520 6461 7461      E_phase data
+00020900: 2066 6965 6c64 0d0a 2020 2020 2020 2020   field..        
+00020910: 2a2a 746f 5f64 6567 2a2a 2020 3a20 626f  **to_deg**  : bo
+00020920: 6f6c 200d 0a20 2020 2020 2020 2020 2020  ol ..           
+00020930: 2020 2020 2020 2020 7075 7420 7468 6520          put the 
+00020940: 4570 687a 2076 616c 7565 206f 6e20 6465  Ephz value on de
+00020950: 6772 6565 202e 200d 0a20 2020 2020 2020  gree . ..       
+00020960: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00020970: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00020980: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  =  ===========  
+00020990: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000209a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000209b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+000209c0: 2020 4174 7472 6962 7574 6573 2020 2020    Attributes    
+000209d0: 2020 2020 2054 7970 6520 2020 2020 2020       Type       
+000209e0: 2045 7870 6c61 6e61 7469 6f6e 0d0a 2020   Explanation..  
+000209f0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+00020a00: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  ==  =========== 
+00020a10: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00020a20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00020a30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
+00020a40: 2020 2076 616c 7565 2020 2020 2020 2020     value        
+00020a50: 2020 2020 206e 642e 6172 7261 7920 2020       nd.array   
+00020a60: 2020 2064 6174 6120 6f66 2045 6d61 6720     data of Emag 
+00020a70: 2063 6f6c 756d 6e20 2075 6e69 7420 2d20   column  unit - 
+00020a80: 6d72 6164 200d 0a20 2020 206d 6178 2020  mrad ..    max  
+00020a90: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
+00020aa0: 6174 2020 2020 2020 2020 206d 6178 696d  at         maxim
+00020ab0: 756d 2045 2d46 6965 6c64 206d 6167 6e69  um E-Field magni
+00020ac0: 7475 6465 2020 756e 6974 202d 6d56 2f6b  tude  unit -mV/k
+00020ad0: 6d2a 416d 7020 0d0a 2020 2020 6c6f 6320  m*Amp ..    loc 
+00020ae0: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00020af0: 6374 2020 2020 2020 2020 2020 6c6f 6361  ct          loca
+00020b00: 7469 6f6e 206f 6620 452d 7068 6173 6520  tion of E-phase 
+00020b10: 2020 7661 6c75 6520 6174 2074 6865 0d0a    value at the..
+00020b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b40: 2020 2020 7374 6174 696f 6e20 6c61 6d62      station lamb
+00020b50: 6461 202e 2065 2e67 202d 206c 6f63 5b27  da . e.g - loc['
+00020b60: 5334 365d 2073 686f 7720 7468 6520 0d0a  S46] show the ..
+00020b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b90: 2020 2020 6375 7272 656e 7420 2045 2d70      current  E-p
+00020ba0: 6861 7365 2064 6174 6120 2061 7420 7468  hase data  at th
+00020bb0: 6520 7374 6174 696f 6e20 5334 360d 0a20  e station S46.. 
+00020bc0: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
+00020bd0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
+00020be0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+00020bf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00020c00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+00020c10: 0d0a 2020 2020 4d6f 7265 2061 7474 7269  ..    More attri
+00020c20: 6275 7465 7320 6361 6e20 6265 2061 6464  butes can be add
+00020c30: 6564 2062 7920 696e 7075 7469 6e67 2061  ed by inputing a
+00020c40: 206b 6579 2077 6f72 6420 6469 6374 696f   key word dictio
+00020c50: 6e61 7279 0d0a 2020 2020 0d0a 2020 2020  nary..    ..    
+00020c60: 3a45 7861 6d70 6c65 3a0d 0a20 2020 2020  :Example:..     
+00020c70: 2020 200d 0a20 2020 2020 2020 203e 3e3e     ..        >>>
+00020c80: 2066 726f 6d20 7079 6373 616d 742e 636f   from pycsamt.co
+00020c90: 7265 2e61 7667 2069 6d70 6f72 7420 4176  re.avg import Av
+00020ca0: 6720 0d0a 2020 2020 2020 2020 3e3e 3e20  g ..        >>> 
+00020cb0: 7061 7468 3d6f 732e 7061 7468 2e6a 6f69  path=os.path.joi
+00020cc0: 6e28 6f73 2e65 6e76 6972 6f6e 5b22 7079  n(os.environ["py
+00020cd0: 4353 414d 5422 5d2c 200d 0a20 2020 2020  CSAMT"], ..     
+00020ce0: 2020 202e 2e2e 2020 2020 2020 2770 7963     ...      'pyc
+00020cf0: 7361 6d74 272c 2022 6461 7461 222c 2022  samt', "data", "
+00020d00: 4b31 2e41 5647 2229 0d0a 2020 2020 2020  K1.AVG")..      
+00020d10: 2020 3e3e 3e20 6176 675f 6f62 6a3d 4176    >>> avg_obj=Av
+00020d20: 6728 7061 7468 290d 0a20 2020 2020 2020  g(path)..       
+00020d30: 203e 3e3e 2065 7068 7a5f 6f62 6a20 3d61   >>> ephz_obj =a
+00020d40: 7667 5f6f 626a 2e44 6174 615f 7365 6374  vg_obj.Data_sect
+00020d50: 696f 6e2e 4570 687a 2e6c 6f63 5b27 3436  ion.Ephz.loc['46
+00020d60: 275d 0d0a 2020 2020 2020 2020 3e3e 3e20  ']..        >>> 
+00020d70: 7072 696e 7428 6570 687a 5f6f 626a 290d  print(ephz_obj).
+00020d80: 0a20 2020 2022 2222 0d0a 2020 2020 6465  .    """..    de
+00020d90: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00020da0: 2065 5f70 687a 5f61 7272 6179 3d4e 6f6e   e_phz_array=Non
+00020db0: 652c 206e 756d 6265 725f 6f66 5f66 7265  e, number_of_fre
+00020dc0: 7175 656e 6369 6573 3d4e 6f6e 6520 2c20  quencies=None , 
+00020dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020de0: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
+00020df0: 7469 6f6e 733d 4e6f 6e65 202c 202a 2a6b  tions=None , **k
+00020e00: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
+00020e10: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00020e20: 2065 5f70 687a 5f61 7272 6179 3d20 655f   e_phz_array= e_
+00020e30: 7068 7a5f 6172 7261 790d 0a20 2020 2020  phz_array..     
+00020e40: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
+00020e50: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
+00020e60: 696f 6e73 203d 6b77 6172 6773 2e70 6f70  ions =kwargs.pop
+00020e70: 2822 6e75 6d62 6572 5f6f 665f 7374 6174  ("number_of_stat
+00020e80: 696f 6e73 222c 204e 6f6e 6529 0d0a 2020  ions", None)..  
+00020e90: 2020 2020 2020 7365 6c66 2e6e 6672 6571        self.nfreq
+00020ea0: 203d 6b77 6172 6773 2e70 6f70 2827 6e75   =kwargs.pop('nu
+00020eb0: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
+00020ec0: 6965 7327 2c20 4e6f 6e65 290d 0a20 2020  ies', None)..   
+00020ed0: 2020 2020 2073 656c 662e 746f 5f64 6567       self.to_deg
+00020ee0: 7265 6520 3d6b 7761 7267 732e 706f 7028  ree =kwargs.pop(
+00020ef0: 2774 6f5f 6465 6772 6565 272c 2046 616c  'to_degree', Fal
+00020f00: 7365 290d 0a20 2020 2020 2020 200d 0a20  se)..        .. 
+00020f10: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
+00020f20: 6520 3d4e 6f6e 6520 0d0a 2020 2020 2020  e =None ..      
+00020f30: 2020 7365 6c66 2e6d 696e 203d 204e 6f6e    self.min = Non
+00020f40: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
+00020f50: 2e6d 6178 203d 204e 6f6e 6520 0d0a 2020  .max = None ..  
+00020f60: 2020 0d0a 2020 2020 2020 2020 666f 7220    ..        for 
+00020f70: 6b65 7920 696e 206c 6973 7428 6b77 6172  key in list(kwar
+00020f80: 6773 2e6b 6579 7328 2929 3a0d 0a20 2020  gs.keys()):..   
+00020f90: 2020 2020 2020 2020 2073 6574 6174 7472           setattr
+00020fa0: 2873 656c 662c 206b 6579 2c20 6b77 6172  (self, key, kwar
+00020fb0: 6773 5b6b 6579 5d29 0d0a 2020 2020 2020  gs[key])..      
+00020fc0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00020fd0: 6966 2073 656c 662e 655f 7068 7a5f 6172  if self.e_phz_ar
+00020fe0: 7261 7920 2069 7320 6e6f 7420 4e6f 6e65  ray  is not None
+00020ff0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00021000: 2073 656c 662e 5f72 6561 645f 6570 687a   self._read_ephz
+00021010: 5f64 6174 6120 2829 0d0a 2020 2020 2020  _data ()..      
+00021020: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+00021030: 2020 6465 6620 5f72 6561 645f 6570 687a    def _read_ephz
+00021040: 5f64 6174 6120 2873 656c 662c 655f 7068  _data (self,e_ph
+00021050: 7a5f 6172 7261 793d 4e6f 6e65 2c20 6e75  z_array=None, nu
+00021060: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
+00021070: 6965 733d 4e6f 6e65 202c 200d 0a20 2020  ies=None , ..   
+00021080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021090: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
+000210a0: 7374 6174 696f 6e73 3d4e 6f6e 652c 202a  stations=None, *
+000210b0: 2a6b 7761 7267 7320 2029 3a0d 0a20 2020  *kwargs  ):..   
+000210c0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+000210d0: 2020 4d65 7468 6f64 2074 6f20 7265 6164    Method to read
+000210e0: 2061 6e64 2061 7261 6e67 6520 6461 7461   and arange data
+000210f0: 2061 6363 6f72 6469 6e67 2065 6163 680d   according each.
+00021100: 0a20 2020 2020 2020 2073 7461 7469 6f6e  .        station
+00021110: 202f 452d 7068 6173 6520 616e 676c 6573   /E-phase angles
+00021120: 2076 616c 7565 7320 2e0d 0a20 2020 2020   values ...     
+00021130: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00021140: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00021150: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00021160: 0a20 2020 2020 2020 2020 2020 202a 2065  .            * e
+00021170: 5f70 687a 5f61 7272 6179 203a 206e 6461  _phz_array : nda
+00021180: 7272 6179 2c20 656e 2072 6164 200d 0a20  rray, en rad .. 
+00021190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000211a0: 2020 2020 2020 2020 2020 2045 2d46 6965             E-Fie
+000211b0: 6c64 2070 6861 7365 206f 6273 6572 7665  ld phase observe
+000211c0: 6420 2e0d 0a20 2020 2020 2020 2020 2020  d ...           
+000211d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000211e0: 2054 6865 202a 6465 6661 756c 742a 2069   The *default* i
+000211f0: 7320 4e6f 6e65 2e0d 0a20 2020 2020 2020  s None...       
+00021200: 2020 2020 202a 206e 756d 6265 725f 6f66       * number_of
+00021210: 5f66 7265 7175 656e 6369 6573 203a 2069  _frequencies : i
+00021220: 6e74 202c 206f 7074 696f 6e61 6c0d 0a20  nt , optional.. 
+00021230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021240: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00021250: 756d 6265 7220 6f66 2066 7265 7175 656e  umber of frequen
+00021260: 6369 6573 2066 6f72 2073 7572 7665 792e  cies for survey.
+00021270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021290: 2020 5468 6520 2a64 6566 6175 6c74 2a20    The *default* 
+000212a0: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
+000212b0: 2020 2020 2020 2a20 6e75 6d62 6572 5f6f        * number_o
+000212c0: 665f 7374 6174 696f 6e73 203a 2069 6e74  f_stations : int
+000212d0: 202c 206f 7074 696f 6e61 6c0d 0a20 2020   , optional..   
+000212e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000212f0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+00021300: 6265 725f 6f66 2073 7461 7469 6f6e 732e  ber_of stations.
+00021310: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00021320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021330: 2020 2054 6865 202a 6465 6661 756c 742a     The *default*
+00021340: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2020   is None...     
+00021350: 2020 2020 2020 202a 2074 6f5f 6465 6772         * to_degr
+00021360: 6565 203a 2062 6f6f 6c2c 0d0a 2020 2020  ee : bool,..    
+00021370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021380: 2020 2020 636f 6d70 7574 6520 616e 676c      compute angl
+00021390: 6520 746f 2064 6567 7265 6520 2e20 0d0a  e to degree . ..
+000213a0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+000213b0: 2020 2020 2074 6f5f 6465 6772 6565 203d       to_degree =
+000213c0: 6b77 6172 6773 2e70 6f70 2822 746f 5f64  kwargs.pop("to_d
+000213d0: 6567 7265 6522 2c20 4661 6c73 6529 0d0a  egree", False)..
+000213e0: 2020 2020 2020 2020 6966 2074 6f5f 6465          if to_de
+000213f0: 6772 6565 203a 0d0a 2020 2020 2020 2020  gree :..        
+00021400: 2020 2020 7365 6c66 2e74 6f5f 6465 6772      self.to_degr
+00021410: 6565 203d 2074 6f5f 6465 6772 6565 0d0a  ee = to_degree..
+00021420: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00021430: 2020 6966 2065 5f70 687a 5f61 7272 6179    if e_phz_array
+00021440: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
+00021450: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00021460: 662e 655f 7068 7a5f 6172 7261 7920 3d65  f.e_phz_array =e
+00021470: 5f70 687a 5f61 7272 6179 0d0a 2020 2020  _phz_array..    
+00021480: 2020 2020 6966 2073 656c 662e 655f 7068      if self.e_ph
+00021490: 7a5f 6172 7261 7920 6973 204e 6f6e 6520  z_array is None 
+000214a0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000214b0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+000214c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000214d0: 2020 274e 6f20 452d 7068 6173 6520 6461    'No E-phase da
+000214e0: 7461 2066 6f75 6e64 2020 2127 290d 0a0d  ta found  !')...
+000214f0: 0a20 2020 2020 2020 2069 6620 6e75 6d62  .        if numb
+00021500: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00021510: 7320 6973 206e 6f74 204e 6f6e 6520 3a20  s is not None : 
+00021520: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00021530: 6c66 2e6e 6672 6571 203d 6e75 6d62 6572  lf.nfreq =number
+00021540: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
+00021550: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+00021560: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00021570: 0d0a 2020 2020 2020 2020 2020 2020 2250  ..            "P
+00021580: 6c65 6173 6520 7370 6563 6966 7920 7468  lease specify th
+00021590: 6520 6e75 6d62 6572 206f 6620 6672 6571  e number of freq
+000215a0: 7565 6e63 7920 2122 290d 0a20 2020 2020  uency !")..     
+000215b0: 2020 2069 6620 6e75 6d62 6572 5f6f 665f     if number_of_
+000215c0: 7374 6174 696f 6e73 2069 7320 6e6f 7420  stations is not 
+000215d0: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+000215e0: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
+000215f0: 5f6f 665f 7374 6174 696f 6e73 203d 6e75  _of_stations =nu
+00021600: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+00021610: 200d 0a20 2020 2020 2020 2065 6c73 6520   ..        else 
+00021620: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00021630: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00021640: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021650: 2020 2750 6c65 6173 6520 7370 6563 6966    'Please specif
+00021660: 7920 7468 6520 6e75 6d62 6572 206f 6620  y the number of 
+00021670: 7374 6174 696f 6e73 2729 0d0a 2020 2020  stations')..    
+00021680: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00021690: 2020 7472 7920 3a20 0d0a 2020 2020 2020    try : ..      
+000216a0: 2020 2020 2020 7365 6c66 2e6e 6672 6571        self.nfreq
+000216b0: 3d6e 702e 696e 7428 7365 6c66 2e6e 6672  =np.int(self.nfr
+000216c0: 6571 290d 0a20 2020 2020 2020 2020 2020  eq)..           
+000216d0: 2073 656c 662e 6e75 6d62 6572 5f6f 665f   self.number_of_
+000216e0: 7374 6174 696f 6e73 203d 6e70 2e69 6e74  stations =np.int
+000216f0: 2873 656c 662e 6e75 6d62 6572 5f6f 665f  (self.number_of_
+00021700: 7374 6174 696f 6e73 290d 0a20 2020 2020  stations)..     
+00021710: 2020 2020 2020 2073 656c 662e 655f 7068         self.e_ph
+00021720: 7a5f 6172 7261 793d 6e70 2e61 7272 6179  z_array=np.array
+00021730: 285b 6e70 2e66 6c6f 6174 2863 6329 2066  ([np.float(cc) f
+00021740: 6f72 2063 6320 696e 2073 656c 662e 655f  or cc in self.e_
+00021750: 7068 7a5f 6172 7261 795d 290d 0a0d 0a20  phz_array]).... 
+00021760: 2020 2020 2020 2065 7863 6570 7420 3a20         except : 
+00021770: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00021780: 6973 6520 5661 6c75 6545 7272 6f72 280d  ise ValueError(.
+00021790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000217a0: 2022 5661 6c75 6573 2070 726f 7669 6465   "Values provide
+000217b0: 6420 666f 7220 7468 6520 452d 7068 6173  d for the E-phas
+000217c0: 6520 6172 6520 7772 6f6e 672e 220d 0a20  e are wrong.".. 
+000217d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000217e0: 2220 6d75 7374 2062 6520 666c 6f61 7420  " must be float 
+000217f0: 6f72 2069 6e74 6567 6572 202e 2229 0d0a  or integer .")..
+00021800: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00021810: 746f 5f64 6567 7265 6520 3a20 232d 2d2d  to_degree : #---
+00021820: 3e20 7365 7420 616e 676c 6520 746f 2064  > set angle to d
+00021830: 6567 7265 6520 2e0d 0a20 2020 2020 2020  egree ...       
+00021840: 2020 2020 2073 656c 662e 655f 7068 7a5f       self.e_phz_
+00021850: 6172 7261 7920 3d6e 702e 6170 706c 795f  array =np.apply_
+00021860: 616c 6f6e 675f 6178 6973 2028 0d0a 2020  along_axis (..  
+00021870: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00021880: 6d62 6461 2065 7068 7a3a 2065 7068 7a20  mbda ephz: ephz 
+00021890: 2a20 3138 302f 6e70 2e70 692c 2030 2c73  * 180/np.pi, 0,s
+000218a0: 656c 662e 655f 7068 7a5f 6172 7261 7929  elf.e_phz_array)
+000218b0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000218c0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000218d0: 0d0a 2020 2020 2020 2020 7663 6f75 6e74  ..        vcount
+000218e0: 735f 655f 7068 7a2c 2072 6570 6561 745f  s_e_phz, repeat_
+000218f0: 6570 687a 3d6e 702e 756e 6971 7565 2028  ephz=np.unique (
+00021900: 7365 6c66 2e65 5f70 687a 5f61 7272 6179  self.e_phz_array
+00021910: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00021920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021940: 2020 7265 7475 726e 5f63 6f75 6e74 733d    return_counts=
+00021950: 5472 7565 290d 0a20 2020 2020 2020 2073  True)..        s
+00021960: 656c 662e 7661 6c75 6520 3d76 636f 756e  elf.value =vcoun
+00021970: 7473 5f65 5f70 687a 0d0a 2020 2020 2020  ts_e_phz..      
+00021980: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+00021990: 2e6d 6178 2c20 7365 6c66 2e6d 696e 203d  .max, self.min =
+000219a0: 7663 6f75 6e74 735f 655f 7068 7a2e 6d61  vcounts_e_phz.ma
+000219b0: 7828 292c 2076 636f 756e 7473 5f65 5f70  x(), vcounts_e_p
+000219c0: 687a 2e6d 696e 2829 0d0a 2020 2020 2020  hz.min()..      
+000219d0: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+000219e0: 2020 2020 2020 7472 756e 6361 7465 645f        truncated_
+000219f0: 655f 7068 7a3d 5a63 632e 7472 756e 6361  e_phz=Zcc.trunca
+00021a00: 7465 645f 6461 7461 2820 6461 7461 203d  ted_data( data =
+00021a10: 7365 6c66 2e65 5f70 687a 5f61 7272 6179  self.e_phz_array
+00021a20: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00021a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a40: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+00021a50: 725f 6f66 5f72 6563 6375 7265 6e63 653d  r_of_reccurence=
+00021a60: 7365 6c66 2e6e 6672 6571 290d 0a20 2020  self.nfreq)..   
+00021a70: 2020 2020 206e 616d 652c 2070 6f6c 796e       name, polyn
+00021a80: 616d 6520 3d20 5a63 632e 5f6e 756d 6265  ame = Zcc._numbe
+00021a90: 7269 6e67 5f73 7461 7469 6f6e 280d 0a20  ring_station(.. 
+00021aa0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+00021ab0: 725f 6f66 5f73 7461 7469 6f6e 3d73 656c  r_of_station=sel
+00021ac0: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
+00021ad0: 696f 6e73 2c20 0d0a 2020 2020 2020 2020  ions, ..        
+00021ae0: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
+00021af0: 5f66 7265 7120 3d73 656c 662e 6e66 7265  _freq =self.nfre
+00021b00: 7129 0d0a 2020 2020 2020 2020 0d0a 2020  q)..        ..  
+00021b10: 2020 2020 2020 7365 6c66 2e6c 6f63 203d        self.loc =
+00021b20: 7b20 6b65 793a 7661 6c75 6520 666f 7220  { key:value for 
+00021b30: 6b65 792c 2076 616c 7565 2069 6e20 7a69  key, value in zi
+00021b40: 7028 6e61 6d65 2c20 7472 756e 6361 7465  p(name, truncate
+00021b50: 645f 655f 7068 7a20 297d 0d0a 2020 2020  d_e_phz )}..    
+00021b60: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
+00021b70: 636c 6173 7320 486d 6167 2028 6f62 6a65  class Hmag (obje
+00021b80: 6374 293a 0d0a 2020 2020 2222 220d 0a20  ct):..    """.. 
+00021b90: 2020 2048 2d66 6965 6c64 206d 6167 6e69     H-field magni
+00021ba0: 7475 6465 2028 7069 636f 5465 736c 612f  tude (picoTesla/
+00021bb0: 416d 7029 0d0a 2020 2020 286d 696c 6c69  Amp)..    (milli
+00021bc0: 4761 6d6d 6173 2f41 6d70 2920 200d 0a20  Gammas/Amp)  .. 
+00021bd0: 2020 200d 0a20 2020 2041 7267 756d 656e     ..    Argumen
+00021be0: 7473 200d 0a20 2020 202d 2d2d 2d2d 2d2d  ts ..    -------
+00021bf0: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a68  ---..        **h
+00021c00: 5f6d 6167 5f61 7272 6179 2a2a 203a 206e  _mag_array** : n
+00021c10: 6461 7272 6179 0d0a 2020 2020 2020 2020  darray..        
+00021c20: 2020 2020 2020 2020 2020 2020 2020 2048                 H
+00021c30: 2f42 5f66 6965 6c64 206d 6167 6e69 7475  /B_field magnitu
+00021c40: 6465 2043 6c61 7373 202e 200d 0a20 2020  de Class . ..   
+00021c50: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00021c60: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+00021c70: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00021c80: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+00021c90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00021ca0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00021cb0: 0d0a 2020 2020 4174 7472 6962 7574 6573  ..    Attributes
+00021cc0: 2020 2020 2020 2020 2054 7970 6520 2020           Type   
+00021cd0: 2020 2020 2045 7870 6c61 6e61 7469 6f6e       Explanation
+00021ce0: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
+00021cf0: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+00021d00: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
+00021d10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00021d20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00021d30: 3d0d 0a20 2020 2076 616c 7565 2020 2020  =..    value    
+00021d40: 2020 2020 2020 2020 206e 642e 6172 7261           nd.arra
+00021d50: 7920 2020 2020 2064 6174 6120 6f66 2048  y      data of H
+00021d60: 6d61 6720 2063 6f6c 756d 6e20 206f 6e20  mag  column  on 
+00021d70: 6176 6766 696c 6520 206d 6178 696d 756d  avgfile  maximum
+00021d80: 0d0a 2020 2020 6d61 7820 2020 2020 2020  ..    max       
+00021d90: 2020 2020 2020 2020 666c 6f61 7420 2020          float   
+00021da0: 2020 2020 2020 482d 6d61 6720 6d61 676e        H-mag magn
+00021db0: 6974 7564 6520 756e 6974 202d 2020 6d56  itude unit -  mV
+00021dc0: 2f6b 6d2a 416d 7020 0d0a 2020 2020 6c6f  /km*Amp ..    lo
+00021dd0: 6320 2020 2020 2020 2020 2020 2020 2020  c               
+00021de0: 6469 6374 2020 2020 2020 2020 2020 6c6f  dict          lo
+00021df0: 6361 7469 6f6e 206f 6620 482d 6d61 6720  cation of H-mag 
+00021e00: 6d61 676e 6974 7564 6520 7661 6c75 6520  magnitude value 
+00021e10: 6174 2020 7468 6520 0d0a 2020 2020 2020  at  the ..      
+00021e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021e30: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00021e40: 6174 696f 6e20 6c61 6d62 6461 202e 2065  ation lambda . e
+00021e50: 3a67 203a 206c 6f63 5b27 5330 3527 5d0d  :g : loc['S05'].
+00021e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00021e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e80: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00021e90: 6d62 6572 5f6f 665f 7265 6363 7572 656e  mber_of_reccuren
-00021ea0: 6365 3d73 656c 662e 6e66 7265 7129 0d0a  ce=self.nfreq)..
-00021eb0: 2020 2020 2020 2020 6e61 6d65 2c20 706f          name, po
-00021ec0: 6c79 6e61 6d65 203d 205a 6363 2e5f 6e75  lyname = Zcc._nu
-00021ed0: 6d62 6572 696e 675f 7374 6174 696f 6e28  mbering_station(
-00021ee0: 0d0a 2020 2020 2020 2020 2020 2020 6e75  ..            nu
-00021ef0: 6d62 6572 5f6f 665f 7374 6174 696f 6e3d  mber_of_station=
-00021f00: 7365 6c66 2e6e 756d 6265 725f 6f66 5f73  self.number_of_s
-00021f10: 7461 7469 6f6e 732c 200d 0a20 2020 2020  tations, ..     
-00021f20: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00021f30: 5f6f 665f 6672 6571 203d 7365 6c66 2e6e  _of_freq =self.n
-00021f40: 6672 6571 290d 0a20 2020 2020 2020 200d  freq)..        .
-00021f50: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00021f60: 6320 3d7b 206b 6579 3a76 616c 7565 2066  c ={ key:value f
-00021f70: 6f72 206b 6579 2c20 7661 6c75 6520 696e  or key, value in
-00021f80: 207a 6970 286e 616d 652c 2074 7275 6e63   zip(name, trunc
-00021f90: 6174 6564 5f65 5f70 687a 2029 7d0d 0a20  ated_e_phz )}.. 
-00021fa0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00021fb0: 200d 0a63 6c61 7373 2048 6d61 6720 286f   ..class Hmag (o
-00021fc0: 626a 6563 7429 3a0d 0a20 2020 2022 2222  bject):..    """
-00021fd0: 0d0a 2020 2020 482d 6669 656c 6420 6d61  ..    H-field ma
-00021fe0: 676e 6974 7564 6520 2870 6963 6f54 6573  gnitude (picoTes
-00021ff0: 6c61 2f41 6d70 290d 0a20 2020 2028 6d69  la/Amp)..    (mi
-00022000: 6c6c 6947 616d 6d61 732f 416d 7029 2020  lliGammas/Amp)  
-00022010: 0d0a 2020 2020 0d0a 2020 2020 4172 6775  ..    ..    Argu
-00022020: 6d65 6e74 7320 0d0a 2020 2020 2d2d 2d2d  ments ..    ----
-00022030: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00022040: 2a2a 685f 6d61 675f 6172 7261 792a 2a20  **h_mag_array** 
-00022050: 3a20 6e64 6172 7261 790d 0a20 2020 2020  : ndarray..     
-00022060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022070: 2020 482f 425f 6669 656c 6420 6d61 676e    H/B_field magn
-00022080: 6974 7564 6520 436c 6173 7320 2e20 0d0a  itude Class . ..
-00022090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000220a0: 2020 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d    ..    ========
-000220b0: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-000220c0: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
-000220d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000220e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000220f0: 3d3d 3d0d 0a20 2020 2041 7474 7269 6275  ===..    Attribu
-00022100: 7465 7320 2020 2020 2020 2020 5479 7065  tes         Type
-00022110: 2020 2020 2020 2020 4578 706c 616e 6174          Explanat
-00022120: 696f 6e0d 0a20 2020 203d 3d3d 3d3d 3d3d  ion..    =======
-00022130: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-00022140: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-00022150: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00022160: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00022170: 3d3d 3d3d 0d0a 2020 2020 7661 6c75 6520  ====..    value 
-00022180: 2020 2020 2020 2020 2020 2020 6e64 2e61              nd.a
-00022190: 7272 6179 2020 2020 2020 6461 7461 206f  rray      data o
-000221a0: 6620 486d 6167 2020 636f 6c75 6d6e 2020  f Hmag  column  
-000221b0: 6f6e 2061 7667 6669 6c65 2020 6d61 7869  on avgfile  maxi
-000221c0: 6d75 6d0d 0a20 2020 206d 6178 2020 2020  mum..    max    
-000221d0: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
-000221e0: 2020 2020 2020 2020 2048 2d6d 6167 206d           H-mag m
-000221f0: 6167 6e69 7475 6465 2075 6e69 7420 2d20  agnitude unit - 
-00022200: 206d 562f 6b6d 2a41 6d70 200d 0a20 2020   mV/km*Amp ..   
-00022210: 206c 6f63 2020 2020 2020 2020 2020 2020   loc            
-00022220: 2020 2064 6963 7420 2020 2020 2020 2020     dict         
-00022230: 206c 6f63 6174 696f 6e20 6f66 2048 2d6d   location of H-m
-00022240: 6167 206d 6167 6e69 7475 6465 2076 616c  ag magnitude val
-00022250: 7565 2061 7420 2074 6865 200d 0a20 2020  ue at  the ..   
-00022260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022280: 2073 7461 7469 6f6e 206c 616d 6264 6120   station lambda 
-00022290: 2e20 653a 6720 3a20 6c6f 635b 2753 3035  . e:g : loc['S05
-000222a0: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
-000222b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222c0: 2020 2020 2020 2020 7368 6f77 2074 6865          show the
-000222d0: 2063 7572 7265 6e74 2020 482d 6d61 6720   current  H-mag 
-000222e0: 6461 7461 0d0a 2020 2020 2020 2020 2020  data..          
-000222f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022300: 2020 2020 2020 2020 2020 6f66 2073 7461            of sta
-00022310: 7469 6f6e 2061 7420 5330 352e 0d0a 2020  tion at S05...  
-00022320: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-00022330: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  ==  =========== 
-00022340: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-00022350: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00022360: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d  =============...
-00022370: 0a20 2020 204d 6f72 6520 6174 7472 6962  .    More attrib
-00022380: 7574 6573 2063 616e 2062 6520 6164 6465  utes can be adde
-00022390: 6420 6279 2069 6e70 7574 696e 6720 6120  d by inputing a 
-000223a0: 6b65 7920 776f 7264 2064 6963 7469 6f6e  key word diction
-000223b0: 6172 790d 0a20 2020 200d 0a20 2020 203a  ary..    ..    :
-000223c0: 4578 616d 706c 653a 200d 0a20 2020 2020  Example: ..     
-000223d0: 2020 2020 0d0a 2020 2020 2020 2020 3e3e      ..        >>
-000223e0: 3e20 6672 6f6d 2070 7963 7361 6d74 2e66  > from pycsamt.f
-000223f0: 662e 636f 7265 2069 6d70 6f72 7420 4176  f.core import Av
-00022400: 6720 0d0a 2020 2020 2020 2020 3e3e 3e20  g ..        >>> 
-00022410: 7061 7468 3d6f 732e 7061 7468 2e6a 6f69  path=os.path.joi
-00022420: 6e28 6f73 2e65 6e76 6972 6f6e 5b22 7079  n(os.environ["py
-00022430: 4353 414d 5422 5d2c 200d 0a20 2020 2020  CSAMT"], ..     
-00022440: 2020 202e 2e2e 2020 2020 2020 2770 7963     ...      'pyc
-00022450: 7361 6d74 272c 2022 6461 7461 222c 2022  samt', "data", "
-00022460: 4b31 2e41 5647 2229 0d0a 2020 2020 2020  K1.AVG")..      
-00022470: 2020 3e3e 3e20 6176 675f 6f62 6a3d 4176    >>> avg_obj=Av
-00022480: 6728 7061 7468 290d 0a20 2020 2020 2020  g(path)..       
-00022490: 203e 3e3e 2068 6d61 675f 6f62 6a20 3d61   >>> hmag_obj =a
-000224a0: 7667 5f6f 626a 2e44 6174 615f 7365 6374  vg_obj.Data_sect
-000224b0: 696f 6e2e 486d 6167 2e6c 6f63 5b27 5330  ion.Hmag.loc['S0
-000224c0: 3527 5d0d 0a20 2020 2020 2020 202e 2e2e  5']..        ...
-000224d0: 2070 7269 6e74 2868 6d61 675f 6f62 6a29   print(hmag_obj)
-000224e0: 0d0a 2020 2020 2222 220d 0a20 2020 200d  ..    """..    .
-000224f0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00022500: 5f28 7365 6c66 2c20 685f 6d61 675f 6172  _(self, h_mag_ar
-00022510: 7261 793d 4e6f 6e65 2c20 6e75 6d62 6572  ray=None, number
-00022520: 5f6f 665f 6672 6571 7565 6e63 6965 733d  _of_frequencies=
-00022530: 4e6f 6e65 202c 0d0a 2020 2020 2020 2020  None ,..        
-00022540: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-00022550: 6f66 5f73 7461 7469 6f6e 733d 4e6f 6e65  of_stations=None
-00022560: 202c 202a 2a6b 7761 7267 7329 3a0d 0a20   , **kwargs):.. 
-00022570: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00022580: 2073 656c 662e 685f 6d61 675f 6172 7261   self.h_mag_arra
-00022590: 7920 3d68 5f6d 6167 5f61 7272 6179 0d0a  y =h_mag_array..
-000225a0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000225b0: 2020 7365 6c66 2e6e 756d 6265 725f 6f66    self.number_of
-000225c0: 5f73 7461 7469 6f6e 7320 3d6b 7761 7267  _stations =kwarg
-000225d0: 732e 706f 7028 226e 756d 6265 725f 6f66  s.pop("number_of
-000225e0: 5f73 7461 7469 6f6e 7322 2c20 4e6f 6e65  _stations", None
-000225f0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00022600: 6e66 7265 7120 3d6b 7761 7267 732e 706f  nfreq =kwargs.po
-00022610: 7028 276e 756d 6265 725f 6f66 5f66 7265  p('number_of_fre
-00022620: 7175 656e 6369 6573 272c 204e 6f6e 6529  quencies', None)
-00022630: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00022640: 2020 2020 7365 6c66 2e76 616c 7565 203d      self.value =
-00022650: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
-00022660: 656c 662e 6d69 6e20 3d20 4e6f 6e65 200d  elf.min = None .
-00022670: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-00022680: 7820 3d20 4e6f 6e65 200d 0a20 2020 200d  x = None ..    .
-00022690: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
-000226a0: 2069 6e20 6c69 7374 286b 7761 7267 732e   in list(kwargs.
-000226b0: 6b65 7973 2829 293a 0d0a 2020 2020 2020  keys()):..      
-000226c0: 2020 2020 2020 7365 7461 7474 7228 7365        setattr(se
-000226d0: 6c66 2c20 6b65 792c 206b 7761 7267 735b  lf, key, kwargs[
-000226e0: 6b65 795d 290d 0a20 2020 2020 2020 2020  key])..         
-000226f0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-00022700: 7365 6c66 2e68 5f6d 6167 5f61 7272 6179  self.h_mag_array
-00022710: 2020 6973 206e 6f74 204e 6f6e 6520 3a20    is not None : 
-00022720: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00022730: 6c66 2e5f 7265 6164 5f68 6d61 675f 6461  lf._read_hmag_da
-00022740: 7461 2028 290d 0a20 2020 2020 2020 200d  ta ()..        .
-00022750: 0a20 2020 2020 2020 200d 0a20 2020 2064  .        ..    d
-00022760: 6566 205f 7265 6164 5f68 6d61 675f 6461  ef _read_hmag_da
-00022770: 7461 2028 7365 6c66 2c20 685f 6d61 675f  ta (self, h_mag_
-00022780: 6172 7261 793d 4e6f 6e65 2c20 6e75 6d62  array=None, numb
-00022790: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
-000227a0: 733d 4e6f 6e65 202c 200d 0a20 2020 2020  s=None , ..     
-000227b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000227c0: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
-000227d0: 6174 696f 6e73 3d4e 6f6e 6520 293a 0d0a  ations=None ):..
-000227e0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-000227f0: 2020 2020 204d 6574 686f 6420 746f 2072       Method to r
-00022800: 6561 6420 616e 6420 6172 616e 6765 2064  ead and arange d
-00022810: 6174 6120 6163 636f 7264 696e 6720 0d0a  ata according ..
-00022820: 2020 2020 2020 2020 6561 6368 2073 7461          each sta
-00022830: 7469 6f6e 202f 425f 6669 656c 6420 6d61  tion /B_field ma
-00022840: 676e 6974 7564 6520 2076 616c 7565 7320  gnitude  values 
-00022850: 2e0d 0a20 2020 2020 2020 2020 2020 0d0a  ...           ..
-00022860: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00022870: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00022880: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00022890: 2020 2020 2a20 685f 6d61 675f 6172 7261      * h_mag_arra
-000228a0: 7920 3a20 6e64 6172 7261 792c 206f 7074  y : ndarray, opt
-000228b0: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
-000228c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000228d0: 2020 2042 2046 6965 6c64 206d 6561 7375     B Field measu
-000228e0: 7265 6420 6461 7461 206f 6e20 7468 6520  red data on the 
-000228f0: 7369 7465 732e 0d0a 2020 2020 2020 2020  sites...        
-00022900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022910: 2020 2020 5468 6520 6465 6661 756c 7420      The default 
-00022920: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
-00022930: 2020 2020 2020 2a20 6e75 6d62 6572 5f6f        * number_o
-00022940: 665f 6672 6571 7565 6e63 6965 7320 3a20  f_frequencies : 
-00022950: 696e 7420 2c20 6f70 7469 6f6e 616c 0d0a  int , optional..
-00022960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022980: 2020 2020 6e75 6d62 6572 206f 6620 6672      number of fr
-00022990: 6571 7565 6e63 6965 7320 666f 7220 7375  equencies for su
-000229a0: 7276 6579 2e20 0d0a 2020 2020 2020 2020  rvey. ..        
-000229b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000229c0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-000229d0: 6465 6661 756c 7420 6973 204e 6f6e 652e  default is None.
-000229e0: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-000229f0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-00022a00: 6e73 203a 2069 6e74 202c 206f 7074 696f  ns : int , optio
-00022a10: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-00022a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022a30: 2020 2020 206e 756d 6265 725f 6f66 2073       number_of s
-00022a40: 7461 7469 6f6e 732e 2054 6865 2064 6566  tations. The def
-00022a50: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
-00022a60: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00022a70: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-00022a80: 2068 5f6d 6167 5f61 7272 6179 2069 7320   h_mag_array is 
-00022a90: 6e6f 7420 4e6f 6e65 203a 200d 0a20 2020  not None : ..   
-00022aa0: 2020 2020 2020 2020 2073 656c 662e 685f           self.h_
-00022ab0: 6d61 675f 6172 7261 7920 3d68 5f6d 6167  mag_array =h_mag
-00022ac0: 5f61 7272 6179 200d 0a20 2020 2020 2020  _array ..       
-00022ad0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-00022ae0: 6620 7365 6c66 2e68 5f6d 6167 5f61 7272  f self.h_mag_arr
-00022af0: 6179 2069 7320 4e6f 6e65 203a 200d 0a20  ay is None : .. 
-00022b00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00022b10: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-00022b20: 6f72 5f69 6e70 7574 6172 6775 6d65 6e74  or_inputargument
-00022b30: 7328 274e 6f20 422d 4669 656c 6420 2064  s('No B-Field  d
-00022b40: 6174 6120 666f 756e 6420 2021 2729 0d0a  ata found  !')..
-00022b50: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00022b60: 2020 2020 2020 6966 206e 756d 6265 725f        if number_
-00022b70: 6f66 5f66 7265 7175 656e 6369 6573 2069  of_frequencies i
-00022b80: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
-00022b90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00022ba0: 6e66 7265 7120 3d6e 756d 6265 725f 6f66  nfreq =number_of
-00022bb0: 5f66 7265 7175 656e 6369 6573 200d 0a20  _frequencies .. 
-00022bc0: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
-00022bd0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00022be0: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-00022bf0: 6f72 5f69 6e70 7574 6172 6775 6d65 6e74  or_inputargument
-00022c00: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-00022c10: 2020 2020 2250 6c65 6173 6520 7370 6563      "Please spec
-00022c20: 6966 7920 7468 6520 6e75 6d62 6572 206f  ify the number o
-00022c30: 6620 6672 6571 7565 6e63 7920 2122 290d  f frequency !").
-00022c40: 0a20 2020 2020 2020 2069 6620 6e75 6d62  .        if numb
-00022c50: 6572 5f6f 665f 7374 6174 696f 6e73 2069  er_of_stations i
-00022c60: 7320 6e6f 7420 4e6f 6e65 203a 0d0a 2020  s not None :..  
-00022c70: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-00022c80: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-00022c90: 7320 3d6e 756d 6265 725f 6f66 5f73 7461  s =number_of_sta
-00022ca0: 7469 6f6e 7320 0d0a 2020 2020 2020 2020  tions ..        
-00022cb0: 656c 7365 203a 200d 0a20 2020 2020 2020  else : ..       
-00022cc0: 2020 2020 2072 6169 7365 2043 5365 782e       raise CSex.
-00022cd0: 7079 4353 414d 5445 7272 6f72 5f69 6e70  pyCSAMTError_inp
-00022ce0: 7574 6172 6775 6d65 6e74 7328 0d0a 2020  utarguments(..  
-00022cf0: 2020 2020 2020 2020 2020 2020 2020 2750                'P
-00022d00: 6c65 6173 6520 7370 6563 6966 7920 7468  lease specify th
-00022d10: 6520 6e75 6d62 6572 206f 6620 7374 6174  e number of stat
-00022d20: 696f 6e73 2729 0d0a 2020 2020 2020 2020  ions')..        
-00022d30: 2020 2020 0d0a 2020 2020 2020 2020 7472      ..        tr
-00022d40: 7920 3a20 0d0a 2020 2020 2020 2020 2020  y : ..          
-00022d50: 2020 7365 6c66 2e6e 6672 6571 3d6e 702e    self.nfreq=np.
-00022d60: 696e 7428 7365 6c66 2e6e 6672 6571 290d  int(self.nfreq).
-00022d70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00022d80: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
-00022d90: 696f 6e73 203d 6e70 2e69 6e74 2873 656c  ions =np.int(sel
-00022da0: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
-00022db0: 696f 6e73 290d 0a20 2020 2020 2020 2020  ions)..         
-00022dc0: 2020 2073 656c 662e 685f 6d61 675f 6172     self.h_mag_ar
-00022dd0: 7261 793d 6e70 2e61 7272 6179 285b 6e70  ray=np.array([np
-00022de0: 2e66 6c6f 6174 2863 6329 2066 6f72 2063  .float(cc) for c
-00022df0: 6320 696e 2073 656c 662e 685f 6d61 675f  c in self.h_mag_
-00022e00: 6172 7261 795d 290d 0a0d 0a20 2020 2020  array])....     
-00022e10: 2020 2065 7863 6570 7420 3a20 0d0a 2020     except : ..  
-00022e20: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00022e30: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00022e40: 725f 7661 6c75 6528 0d0a 2020 2020 2020  r_value(..      
-00022e50: 2020 2020 2020 2020 2020 2256 616c 7565            "Value
-00022e60: 7320 7072 6f76 6964 6564 2066 6f72 2074  s provided for t
-00022e70: 6865 2042 2d46 6965 6c64 2061 7265 2077  he B-Field are w
-00022e80: 726f 6e67 2e22 0d0a 2020 2020 2020 2020  rong."..        
-00022e90: 2020 2020 2020 2020 2220 6d75 7374 2062          " must b
-00022ea0: 6520 666c 6f61 7420 6f72 2069 6e74 6567  e float or integ
-00022eb0: 6572 202e 2229 0d0a 2020 2020 2020 2020  er .")..        
-00022ec0: 2020 2020 0d0a 2020 2020 2020 2020 7663      ..        vc
-00022ed0: 6f75 6e74 735f 685f 6d61 672c 2072 6570  ounts_h_mag, rep
-00022ee0: 6561 745f 616d 7020 3d6e 702e 756e 6971  eat_amp =np.uniq
-00022ef0: 7565 2028 7365 6c66 2e68 5f6d 6167 5f61  ue (self.h_mag_a
-00022f00: 7272 6179 2c0d 0a20 2020 2020 2020 2020  rray,..         
-00022f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f30: 2020 2020 2072 6574 7572 6e5f 636f 756e       return_coun
-00022f40: 7473 3d54 7275 6529 0d0a 2020 2020 2020  ts=True)..      
-00022f50: 2020 7365 6c66 2e76 616c 7565 203d 7663    self.value =vc
-00022f60: 6f75 6e74 735f 685f 6d61 670d 0a20 2020  ounts_h_mag..   
-00022f70: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00022f80: 656c 662e 6d61 782c 2073 656c 662e 6d69  elf.max, self.mi
-00022f90: 6e20 3d76 636f 756e 7473 5f68 5f6d 6167  n =vcounts_h_mag
-00022fa0: 2e6d 6178 2829 2c20 7663 6f75 6e74 735f  .max(), vcounts_
-00022fb0: 685f 6d61 672e 6d69 6e28 290d 0a20 2020  h_mag.min()..   
-00022fc0: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
-00022fd0: 0a20 2020 2020 2020 2074 7275 6e63 6174  .        truncat
-00022fe0: 6564 5f68 5f6d 6167 3d5a 6363 2e74 7275  ed_h_mag=Zcc.tru
-00022ff0: 6e63 6174 6564 5f64 6174 6128 2064 6174  ncated_data( dat
-00023000: 6120 3d73 656c 662e 685f 6d61 675f 6172  a =self.h_mag_ar
-00023010: 7261 792c 200d 0a20 2020 2020 2020 2020  ray, ..         
-00023020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023030: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00023040: 6d62 6572 5f6f 665f 7265 6363 7572 656e  mber_of_reccuren
-00023050: 6365 3d73 656c 662e 6e66 7265 7129 0d0a  ce=self.nfreq)..
-00023060: 2020 2020 2020 2020 6e61 6d65 2c20 706f          name, po
-00023070: 6c79 6e61 6d65 203d 205a 6363 2e5f 6e75  lyname = Zcc._nu
-00023080: 6d62 6572 696e 675f 7374 6174 696f 6e28  mbering_station(
-00023090: 0d0a 2020 2020 2020 2020 2020 2020 6e75  ..            nu
-000230a0: 6d62 6572 5f6f 665f 7374 6174 696f 6e3d  mber_of_station=
-000230b0: 7365 6c66 2e6e 756d 6265 725f 6f66 5f73  self.number_of_s
-000230c0: 7461 7469 6f6e 732c 200d 0a20 2020 2020  tations, ..     
-000230d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230e0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-000230f0: 5f6f 665f 6672 6571 203d 7365 6c66 2e6e  _of_freq =self.n
-00023100: 6672 6571 290d 0a20 2020 2020 2020 200d  freq)..        .
-00023110: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00023120: 6320 3d7b 206b 6579 3a76 616c 7565 2066  c ={ key:value f
-00023130: 6f72 206b 6579 2c20 7661 6c75 6520 696e  or key, value in
-00023140: 207a 6970 286e 616d 652c 2074 7275 6e63   zip(name, trunc
-00023150: 6174 6564 5f68 5f6d 6167 2029 7d0d 0a20  ated_h_mag )}.. 
-00023160: 2020 2020 2020 2020 2020 200d 0a63 6c61             ..cla
-00023170: 7373 2048 7068 7a20 286f 626a 6563 7429  ss Hphz (object)
-00023180: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-00023190: 482d 6669 656c 6420 7068 6173 6520 286d  H-field phase (m
-000231a0: 696c 6c69 5261 6469 616e 7329 0d0a 2020  illiRadians)..  
-000231b0: 2020 0d0a 2020 2020 4172 6775 6d65 6e74    ..    Argument
-000231c0: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
-000231d0: 2d0d 0a20 2020 2020 2020 202a 2a68 5f70  -..        **h_p
-000231e0: 687a 5f61 7272 6179 2a2a 203a 206e 6461  hz_array** : nda
-000231f0: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
-00023200: 2020 2020 2020 2020 2020 2020 2020 455f                E_
-00023210: 7068 6173 6520 6461 7461 2066 6965 6c64  phase data field
-00023220: 0d0a 2020 2020 2020 2020 202a 2a74 6f5f  ..         **to_
-00023230: 6465 6772 6565 2a2a 2020 3a20 626f 6f6c  degree**  : bool
-00023240: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00023250: 2020 2020 2020 2070 7574 2074 6865 2048         put the H
-00023260: 7068 7a20 7661 6c75 6520 6f6e 2064 6567  phz value on deg
-00023270: 7265 6520 2e20 0d0a 2020 2020 2020 2020  ree . ..        
-00023280: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00023290: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000232a0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d    ===========  =
-000232b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000232c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000232d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
-000232e0: 2041 7474 7269 6275 7465 7320 2020 2020   Attributes     
-000232f0: 2020 2020 5479 7065 2020 2020 2020 2020      Type        
-00023300: 4578 706c 616e 6174 696f 6e0d 0a20 2020  Explanation..   
-00023310: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-00023320: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  =  ===========  
-00023330: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00023340: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00023350: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
-00023360: 2020 7661 6c75 6520 2020 2020 2020 2020    value         
-00023370: 2020 2020 6e64 2e61 7272 6179 2020 2020      nd.array    
-00023380: 2020 6461 7461 206f 6620 456d 6167 2020    data of Emag  
-00023390: 636f 6c75 6d6e 2020 756e 6974 203a 206d  column  unit : m
-000233a0: 7261 6420 2020 0d0a 2020 2020 6d61 7820  rad   ..    max 
-000233b0: 2020 2020 2020 2020 2020 2020 2020 666c                fl
-000233c0: 6f61 7420 2020 2020 2020 2020 6d61 7869  oat         maxi
-000233d0: 6d75 6d20 452d 4669 656c 6420 6d61 676e  mum E-Field magn
-000233e0: 6974 7564 6520 756e 6974 203a 6d56 2f6b  itude unit :mV/k
-000233f0: 6d2a 416d 7020 0d0a 2020 2020 6c6f 6320  m*Amp ..    loc 
-00023400: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00023410: 6374 2020 2020 2020 2020 2020 6c6f 6361  ct          loca
-00023420: 7469 6f6e 206f 6620 452d 7068 6173 6520  tion of E-phase 
-00023430: 2076 616c 7565 2061 7420 7468 6520 7374   value at the st
-00023440: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
-00023450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023460: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
-00023470: 6120 2c20 652e 6720 6c6f 635b 2753 3433  a , e.g loc['S43
-00023480: 5d20 7368 6f77 2074 6865 0d0a 2020 2020  ] show the..    
-00023490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234b0: 6375 7272 656e 7420 2045 2d70 6861 7365  current  E-phase
-000234c0: 2064 6174 6120 6174 2074 6865 2073 7461   data at the sta
-000234d0: 7469 6f6e 5334 330d 0a20 2020 203d 3d3d  tionS43..    ===
-000234e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
-000234f0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-00023500: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00023510: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00023520: 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a 2020 2020  ========....    
-00023530: 4d6f 7265 2061 7474 7269 6275 7465 7320  More attributes 
-00023540: 6361 6e20 6265 2061 6464 6564 2062 7920  can be added by 
-00023550: 696e 7075 7469 6e67 2061 206b 6579 2077  inputing a key w
-00023560: 6f72 6420 6469 6374 696f 6e61 7279 0d0a  ord dictionary..
-00023570: 2020 2020 0d0a 2020 2020 3a45 7861 6d70      ..    :Examp
-00023580: 6c65 3a20 0d0a 2020 2020 2020 2020 0d0a  le: ..        ..
-00023590: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-000235a0: 2070 7963 7361 6d74 2e66 662e 636f 7265   pycsamt.ff.core
-000235b0: 2e61 7667 2069 6d70 6f72 7420 4461 7461  .avg import Data
-000235c0: 5f73 6563 7469 6f6e 200d 0a20 2020 2020  _section ..     
-000235d0: 2020 203e 3e3e 2070 6174 683d 6f73 2e70     >>> path=os.p
-000235e0: 6174 682e 6a6f 696e 286f 732e 656e 7669  ath.join(os.envi
-000235f0: 726f 6e5b 2270 7943 5341 4d54 225d 2c20  ron["pyCSAMT"], 
-00023600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00023610: 2770 7963 7361 6d74 272c 2022 6461 7461  'pycsamt', "data
-00023620: 222c 2022 4b31 2e41 5647 2229 0d0a 2020  ", "K1.AVG")..  
-00023630: 2020 2020 2020 3e3e 3e20 6176 675f 6f62        >>> avg_ob
-00023640: 6a3d 4176 6728 7061 7468 290d 0a20 2020  j=Avg(path)..   
-00023650: 2020 2020 203e 3e3e 2068 7068 7a5f 6f62       >>> hphz_ob
-00023660: 6a20 3d61 7667 5f6f 626a 2e44 6174 615f  j =avg_obj.Data_
-00023670: 7365 6374 696f 6e2e 4570 687a 2e6c 6f63  section.Ephz.loc
-00023680: 5b27 3433 275d 0d0a 2020 2020 2020 2020  ['43']..        
-00023690: 2e2e 2e20 7072 696e 7428 6870 687a 5f6f  ... print(hphz_o
-000236a0: 626a 290d 0a20 2020 2022 2222 0d0a 2020  bj)..    """..  
-000236b0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-000236c0: 656c 662c 2068 5f70 687a 5f61 7272 6179  elf, h_phz_array
-000236d0: 3d4e 6f6e 652c 206e 756d 6265 725f 6f66  =None, number_of
-000236e0: 5f66 7265 7175 656e 6369 6573 3d4e 6f6e  _frequencies=Non
-000236f0: 6520 2c20 0d0a 2020 2020 2020 2020 2020  e , ..          
-00023700: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-00023710: 5f73 7461 7469 6f6e 733d 4e6f 6e65 202c  _stations=None ,
-00023720: 202a 2a6b 7761 7267 7329 3a0d 0a20 2020   **kwargs):..   
-00023730: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00023740: 656c 662e 685f 7068 7a5f 6172 7261 793d  elf.h_phz_array=
-00023750: 2068 5f70 687a 5f61 7272 6179 0d0a 2020   h_phz_array..  
-00023760: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00023770: 7365 6c66 2e6e 756d 6265 725f 6f66 5f73  self.number_of_s
-00023780: 7461 7469 6f6e 7320 3d6b 7761 7267 732e  tations =kwargs.
-00023790: 706f 7028 226e 756d 6265 725f 6f66 5f73  pop("number_of_s
-000237a0: 7461 7469 6f6e 7322 2c20 4e6f 6e65 290d  tations", None).
-000237b0: 0a20 2020 2020 2020 2073 656c 662e 6e66  .        self.nf
-000237c0: 7265 7120 3d6b 7761 7267 732e 706f 7028  req =kwargs.pop(
-000237d0: 276e 756d 6265 725f 6f66 5f66 7265 7175  'number_of_frequ
-000237e0: 656e 6369 6573 272c 204e 6f6e 6529 0d0a  encies', None)..
-000237f0: 2020 2020 2020 2020 7365 6c66 2e74 6f5f          self.to_
-00023800: 6465 6772 6565 203d 6b77 6172 6773 2e70  degree =kwargs.p
-00023810: 6f70 2827 746f 5f64 6567 7265 6527 2c20  op('to_degree', 
-00023820: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
-00023830: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
-00023840: 616c 7565 203d 4e6f 6e65 200d 0a20 2020  alue =None ..   
-00023850: 2020 2020 2073 656c 662e 6d69 6e20 3d20       self.min = 
-00023860: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
-00023870: 656c 662e 6d61 7820 3d20 4e6f 6e65 200d  elf.max = None .
-00023880: 0a20 2020 200d 0a20 2020 2020 2020 2066  .    ..        f
-00023890: 6f72 206b 6579 2069 6e20 6c69 7374 286b  or key in list(k
-000238a0: 7761 7267 732e 6b65 7973 2829 293a 0d0a  wargs.keys()):..
-000238b0: 2020 2020 2020 2020 2020 2020 7365 7461              seta
-000238c0: 7474 7228 7365 6c66 2c20 6b65 792c 206b  ttr(self, key, k
-000238d0: 7761 7267 735b 6b65 795d 290d 0a20 2020  wargs[key])..   
-000238e0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-000238f0: 2020 2069 6620 7365 6c66 2e20 685f 7068     if self. h_ph
-00023900: 7a5f 6172 7261 7920 6973 206e 6f74 204e  z_array is not N
-00023910: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
-00023920: 2020 2020 7365 6c66 2e5f 7265 6164 5f68      self._read_h
-00023930: 7068 7a5f 6461 7461 2028 290d 0a20 2020  phz_data ()..   
-00023940: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
-00023950: 0a20 2020 2064 6566 205f 7265 6164 5f68  .    def _read_h
-00023960: 7068 7a5f 6461 7461 2028 7365 6c66 2c68  phz_data (self,h
-00023970: 5f70 687a 5f61 7272 6179 3d4e 6f6e 652c  _phz_array=None,
-00023980: 206e 756d 6265 725f 6f66 5f66 7265 7175   number_of_frequ
-00023990: 656e 6369 6573 3d4e 6f6e 6520 2c20 0d0a  encies=None , ..
-000239a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000239b0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-000239c0: 6f66 5f73 7461 7469 6f6e 733d 4e6f 6e65  of_stations=None
-000239d0: 2c20 2a2a 6b77 6172 6773 2020 293a 0d0a  , **kwargs  ):..
-000239e0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-000239f0: 2020 2020 204d 6574 686f 6420 746f 2072       Method to r
-00023a00: 6561 6420 616e 6420 6172 616e 6765 2064  ead and arange d
-00023a10: 6174 6120 6163 636f 7264 696e 6720 6561  ata according ea
-00023a20: 6368 0d0a 2020 2020 2020 2020 7374 6174  ch..        stat
-00023a30: 696f 6e20 2f45 2d70 6861 7365 2061 6e67  ion /E-phase ang
-00023a40: 6c65 7320 0d0a 2020 2020 2020 2020 2020  les ..          
-00023a50: 2020 7661 6c75 6573 202e 0d0a 2020 2020    values ...    
-00023a60: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
-00023a70: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00023a80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00023a90: 2020 2020 2020 2020 2020 2a20 655f 7068            * e_ph
-00023aa0: 7a5f 6172 7261 7920 3a20 6e64 6172 7261  z_array : ndarra
-00023ab0: 792c 2065 6e20 7261 6420 0d0a 2020 2020  y, en rad ..    
-00023ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ad0: 2020 2020 2020 2020 452d 4669 656c 6420          E-Field 
-00023ae0: 7068 6173 6520 6f62 7365 7276 6564 202e  phase observed .
-00023af0: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
-00023b00: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2020  None...         
-00023b10: 2020 202a 206e 756d 6265 725f 6f66 5f66     * number_of_f
-00023b20: 7265 7175 656e 6369 6573 203a 2069 6e74  requencies : int
-00023b30: 202c 206f 7074 696f 6e61 6c0d 0a20 2020   , optional..   
-00023b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b50: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-00023b60: 6f66 2066 7265 7175 656e 6369 6573 2066  of frequencies f
-00023b70: 6f72 2073 7572 7665 792e 2054 6865 2064  or survey. The d
-00023b80: 6566 6175 6c74 2069 7320 4e6f 6e65 2e0d  efault is None..
-00023b90: 0a20 2020 2020 2020 2020 2020 202a 206e  .            * n
-00023ba0: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-00023bb0: 7320 3a20 696e 7420 2c20 6f70 7469 6f6e  s : int , option
-00023bc0: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-00023bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023be0: 6e75 6d62 6572 5f6f 6620 7374 6174 696f  number_of statio
-00023bf0: 6e73 2e0d 0a20 2020 2020 2020 2020 2020  ns...           
-00023c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c10: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
-00023c20: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2020  None...         
-00023c30: 2020 202a 2074 6f5f 6465 6772 6565 203a     * to_degree :
-00023c40: 2062 6f6f 6c2c 0d0a 2020 2020 2020 2020   bool,..        
-00023c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c60: 2020 2020 636f 6d70 7574 6520 616e 676c      compute angl
-00023c70: 6520 746f 6465 6772 6565 202e 200d 0a20  e todegree . .. 
-00023c80: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00023c90: 2020 2020 746f 5f64 6567 7265 6520 3d6b      to_degree =k
-00023ca0: 7761 7267 732e 706f 7028 2274 6f5f 6465  wargs.pop("to_de
-00023cb0: 6772 6565 222c 2046 616c 7365 290d 0a20  gree", False).. 
-00023cc0: 2020 2020 2020 2069 6620 746f 5f64 6567         if to_deg
-00023cd0: 7265 6520 3a0d 0a20 2020 2020 2020 2020  ree :..         
-00023ce0: 2020 2073 656c 662e 746f 5f64 6567 7265     self.to_degre
-00023cf0: 6520 3d20 746f 5f64 6567 7265 650d 0a20  e = to_degree.. 
-00023d00: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00023d10: 2069 6620 685f 7068 7a5f 6172 7261 7920   if h_phz_array 
-00023d20: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
-00023d30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00023d40: 2e68 5f70 687a 5f61 7272 6179 3d68 5f70  .h_phz_array=h_p
-00023d50: 687a 5f61 7272 6179 0d0a 2020 2020 2020  hz_array..      
-00023d60: 2020 6966 2073 656c 662e 685f 7068 7a5f    if self.h_phz_
-00023d70: 6172 7261 7920 6973 204e 6f6e 6520 3a20  array is None : 
-00023d80: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00023d90: 6973 6520 4353 6578 2e70 7943 5341 4d54  ise CSex.pyCSAMT
-00023da0: 4572 726f 725f 696e 7075 7461 7267 756d  Error_inputargum
-00023db0: 656e 7473 2827 4e6f 2045 2d70 6861 7365  ents('No E-phase
-00023dc0: 2064 6174 6120 666f 756e 6420 2021 2729   data found  !')
-00023dd0: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
-00023de0: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
-00023df0: 6369 6573 2069 7320 6e6f 7420 4e6f 6e65  cies is not None
-00023e00: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00023e10: 7365 6c66 2e6e 6672 6571 203d 6e75 6d62  self.nfreq =numb
-00023e20: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
-00023e30: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
-00023e40: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00023e50: 7261 6973 6520 4353 6578 2e70 7943 5341  raise CSex.pyCSA
-00023e60: 4d54 4572 726f 725f 696e 7075 7461 7267  MTError_inputarg
-00023e70: 756d 656e 7473 280d 0a20 2020 2020 2020  uments(..       
-00023e80: 2020 2020 2020 2020 2022 506c 6561 7365           "Please
-00023e90: 2073 7065 6369 6679 2074 6865 206e 756d   specify the num
-00023ea0: 6265 7220 6f66 2066 7265 7175 656e 6379  ber of frequency
-00023eb0: 2021 2229 0d0a 2020 2020 2020 2020 6966   !")..        if
-00023ec0: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
-00023ed0: 6f6e 7320 6973 206e 6f74 204e 6f6e 6520  ons is not None 
-00023ee0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00023ef0: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-00023f00: 6174 696f 6e73 203d 6e75 6d62 6572 5f6f  ations =number_o
-00023f10: 665f 7374 6174 696f 6e73 200d 0a20 2020  f_stations ..   
-00023f20: 2020 2020 2065 6c73 6520 3a20 0d0a 2020       else : ..  
-00023f30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00023f40: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00023f50: 725f 696e 7075 7461 7267 756d 656e 7473  r_inputarguments
-00023f60: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00023f70: 2020 2027 506c 6561 7365 2073 7065 6369     'Please speci
-00023f80: 6679 2074 6865 206e 756d 6265 7220 6f66  fy the number of
-00023f90: 2073 7461 7469 6f6e 7327 290d 0a20 2020   stations')..   
-00023fa0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00023fb0: 2020 2074 7279 203a 200d 0a20 2020 2020     try : ..     
-00023fc0: 2020 2020 2020 2073 656c 662e 6e66 7265         self.nfre
-00023fd0: 713d 6e70 2e69 6e74 2873 656c 662e 6e66  q=np.int(self.nf
-00023fe0: 7265 7129 0d0a 2020 2020 2020 2020 2020  req)..          
-00023ff0: 2020 7365 6c66 2e6e 756d 6265 725f 6f66    self.number_of
-00024000: 5f73 7461 7469 6f6e 7320 3d6e 702e 696e  _stations =np.in
-00024010: 7428 7365 6c66 2e6e 756d 6265 725f 6f66  t(self.number_of
-00024020: 5f73 7461 7469 6f6e 7329 0d0a 2020 2020  _stations)..    
-00024030: 2020 2020 2020 2020 7365 6c66 2e68 5f70          self.h_p
-00024040: 687a 5f61 7272 6179 3d6e 702e 6172 7261  hz_array=np.arra
-00024050: 7928 5b6e 702e 666c 6f61 7428 6363 2920  y([np.float(cc) 
-00024060: 666f 7220 6363 2069 6e20 7365 6c66 2e68  for cc in self.h
-00024070: 5f70 687a 5f61 7272 6179 5d29 0d0a 0d0a  _phz_array])....
-00024080: 2020 2020 2020 2020 6578 6365 7074 203a          except :
-00024090: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-000240a0: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-000240b0: 5445 7272 6f72 5f76 616c 7565 280d 0a20  TError_value(.. 
-000240c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000240d0: 5661 6c75 6573 2070 726f 7669 6465 6420  Values provided 
-000240e0: 666f 7220 7468 6520 452d 7068 6173 6520  for the E-phase 
-000240f0: 6172 6520 7772 6f6e 672e 220d 0a20 2020  are wrong."..   
-00024100: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-00024110: 6d75 7374 2062 6520 666c 6f61 7420 6f72  must be float or
-00024120: 2069 6e74 6567 6572 202e 2229 0d0a 2020   integer .")..  
-00024130: 2020 2020 2020 6966 2073 656c 662e 746f        if self.to
-00024140: 5f64 6567 7265 6520 3a20 232d 2d2d 3e20  _degree : #---> 
-00024150: 7365 7420 616e 676c 6520 746f 2064 6567  set angle to deg
-00024160: 7265 6520 2e0d 0a20 2020 2020 2020 2020  ree ...         
-00024170: 2020 2073 656c 662e 685f 7068 7a5f 6172     self.h_phz_ar
-00024180: 7261 7920 3d6e 702e 6170 706c 795f 616c  ray =np.apply_al
-00024190: 6f6e 675f 6178 6973 2028 0d0a 2020 2020  ong_axis (..    
-000241a0: 2020 2020 2020 2020 2020 2020 6c61 6d62              lamb
-000241b0: 6461 2068 7068 7a3a 2068 7068 7a20 2a20  da hphz: hphz * 
-000241c0: 3138 302f 6e70 2e70 692c 2030 2c73 656c  180/np.pi, 0,sel
-000241d0: 662e 685f 7068 7a5f 6172 7261 7929 2020  f.h_phz_array)  
-000241e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000241f0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00024200: 2020 2020 2020 2020 7663 6f75 6e74 735f          vcounts_
-00024210: 685f 7068 7a2c 2072 6570 6561 745f 6870  h_phz, repeat_hp
-00024220: 687a 3d6e 702e 756e 6971 7565 2028 0d0a  hz=np.unique (..
-00024230: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00024240: 2e68 5f70 687a 5f61 7272 6179 2c20 7265  .h_phz_array, re
-00024250: 7475 726e 5f63 6f75 6e74 733d 5472 7565  turn_counts=True
-00024260: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-00024270: 2020 2020 2069 6620 6e6f 7420 6e70 2e61       if not np.a
-00024280: 6c6c 2872 6570 6561 745f 6870 687a 293a  ll(repeat_hphz):
-00024290: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-000242a0: 6973 6520 4353 6578 2e70 7943 5341 4d54  ise CSex.pyCSAMT
-000242b0: 4572 726f 725f 7661 6c75 6528 0d0a 2020  Error_value(..  
-000242c0: 2020 2020 2020 2020 2020 2020 2020 2756                'V
-000242d0: 616c 7565 7320 6f66 2042 2d70 6861 7365  alues of B-phase
-000242e0: 7320 7072 6f76 6964 6564 206d 7573 7420  s provided must 
-000242f0: 6861 7665 2074 6865 2073 616d 6520 6c65  have the same le
-00024300: 6e67 7468 270d 0a20 2020 2020 2020 2020  ngth'..         
-00024310: 2020 2020 2020 2020 2720 666f 7220 6561          ' for ea
-00024320: 6368 2073 7461 7469 6f6e 732e 2027 290d  ch stations. ').
-00024330: 0a20 2020 2020 2020 2073 656c 662e 7661  .        self.va
-00024340: 6c75 6520 3d76 636f 756e 7473 5f68 5f70  lue =vcounts_h_p
-00024350: 687a 0d0a 2020 2020 2020 2020 0d0a 2020  hz..        ..  
-00024360: 2020 2020 2020 7365 6c66 2e6d 6178 2c20        self.max, 
-00024370: 7365 6c66 2e6d 696e 203d 7663 6f75 6e74  self.min =vcount
-00024380: 735f 685f 7068 7a2e 6d61 7828 292c 2076  s_h_phz.max(), v
-00024390: 636f 756e 7473 5f68 5f70 687a 2e6d 696e  counts_h_phz.min
-000243a0: 2829 0d0a 2020 2020 2020 2020 0d0a 2020  ()..        ..  
-000243b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000243c0: 7472 756e 6361 7465 645f 685f 7068 7a3d  truncated_h_phz=
-000243d0: 5a63 632e 7472 756e 6361 7465 645f 6461  Zcc.truncated_da
-000243e0: 7461 2820 6461 7461 203d 7365 6c66 2e68  ta( data =self.h
-000243f0: 5f70 687a 5f61 7272 6179 2c20 0d0a 2020  _phz_array, ..  
-00024400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024420: 2020 2020 206e 756d 6265 725f 6f66 5f72       number_of_r
-00024430: 6563 6375 7265 6e63 653d 7365 6c66 2e6e  eccurence=self.n
-00024440: 6672 6571 290d 0a20 2020 2020 2020 206e  freq)..        n
-00024450: 616d 652c 2070 6f6c 796e 616d 6520 3d20  ame, polyname = 
-00024460: 5a63 632e 5f6e 756d 6265 7269 6e67 5f73  Zcc._numbering_s
-00024470: 7461 7469 6f6e 280d 0a20 2020 2020 2020  tation(..       
-00024480: 2020 2020 206e 756d 6265 725f 6f66 5f73       number_of_s
-00024490: 7461 7469 6f6e 3d73 656c 662e 6e75 6d62  tation=self.numb
-000244a0: 6572 5f6f 665f 7374 6174 696f 6e73 2c20  er_of_stations, 
-000244b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000244c0: 206e 756d 6265 725f 6f66 5f66 7265 7120   number_of_freq 
-000244d0: 3d73 656c 662e 6e66 7265 7129 0d0a 2020  =self.nfreq)..  
-000244e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000244f0: 7365 6c66 2e6c 6f63 203d 7b20 6b65 793a  self.loc ={ key:
-00024500: 7661 6c75 6520 666f 7220 6b65 792c 2076  value for key, v
-00024510: 616c 7565 2069 6e20 7a69 7028 6e61 6d65  alue in zip(name
-00024520: 2c20 7472 756e 6361 7465 645f 685f 7068  , truncated_h_ph
-00024530: 7a20 297d 0d0a 2020 2020 2020 2020 0d0a  z )}..        ..
-00024540: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00024550: 2020 0d0a 636c 6173 7320 5265 7369 7374    ..class Resist
-00024560: 6976 6974 7920 286f 626a 6563 7429 3a0d  ivity (object):.
-00024570: 0a20 2020 2022 2222 0d0a 2020 2020 6261  .    """..    ba
-00024580: 7365 6420 6f6e 2043 6167 6e69 6172 6420  sed on Cagniard 
-00024590: 5265 7369 7374 6976 6974 7920 284f 686d  Resistivity (Ohm
-000245a0: 2d4d 6574 6572 7329 2063 616c 6375 6c61  -Meters) calcula
-000245b0: 7469 6f6e 200d 0a20 2020 200d 0a20 2020  tion ..    ..   
-000245c0: 2020 2e2e 2073 6565 2061 6c73 6f3a 3a43    .. see also::C
-000245d0: 6167 6e69 6172 642c 204c 2e2c 2031 3935  agniard, L., 195
-000245e0: 332c 2042 6173 6963 2074 6865 6f72 7920  3, Basic theory 
-000245f0: 6f66 2074 6865 206d 6167 6e65 746f 7465  of the magnetote
-00024600: 6c6c 7572 6963 0d0a 2020 2020 2020 2020  lluric..        
-00024610: 2020 6d65 7468 6f64 206f 6620 2067 656f    method of  geo
-00024620: 7068 7973 6963 616c 2070 726f 7370 6563  physical prospec
-00024630: 7469 6e67 3a20 4765 6f70 6879 7369 6373  ting: Geophysics
-00024640: 2c20 3138 2c20 3630 35e2 8093 3633 352c  , 18, 605...635,
-00024650: 0d0a 2020 2020 2020 2020 2020 2a64 6f69  ..          *doi
-00024660: 2a3a 2031 302e 3131 3930 2f31 2e31 3433  *: 10.1190/1.143
-00024670: 3739 3135 2e20 0d0a 2020 2020 0d0a 2020  7915. ..    ..  
-00024680: 2020 4172 6775 6d65 6e74 7320 0d0a 2020    Arguments ..  
-00024690: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000246a0: 2020 2020 2020 2a2a 7265 735f 6172 7261        **res_arra
-000246b0: 792a 2a20 203a 2073 7472 0d0a 2020 2020  y**  : str..    
-000246c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000246d0: 2020 6461 7461 2061 7272 6179 206f 6620    data array of 
-000246e0: 6170 7061 7265 6e74 7320 7265 7369 7374  apparents resist
-000246f0: 6976 7920 6361 6c63 756c 6174 696f 6e2e  ivy calculation.
-00024700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00024710: 2020 2020 0d0a 2020 2020 3d3d 3d3d 3d3d      ..    ======
-00024720: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-00024730: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-00024740: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00024750: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00024760: 3d3d 3d3d 3d0d 0a20 2020 2041 7474 7269  =====..    Attri
-00024770: 6275 7465 7320 2020 2020 2020 2020 5479  butes         Ty
-00024780: 7065 2020 2020 2020 2020 4578 706c 616e  pe        Explan
-00024790: 6174 696f 6e0d 0a20 2020 203d 3d3d 3d3d  ation..    =====
-000247a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
-000247b0: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-000247c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000247d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000247e0: 3d3d 3d3d 3d3d 0d0a 2020 2020 7661 6c75  ======..    valu
-000247f0: 6520 2020 2020 2020 2020 2020 2020 6e64  e             nd
-00024800: 2e61 7272 6179 2020 2020 2020 6461 7461  .array      data
-00024810: 206f 6620 7265 7369 7374 6976 6974 7920   of resistivity 
-00024820: 636f 6c75 6d6e 202d 206f 686d 2e6d 200d  column - ohm.m .
-00024830: 0a20 2020 206d 6178 2020 2020 2020 2020  .    max        
-00024840: 2020 2020 2020 2066 6c6f 6174 2020 2020         float    
-00024850: 2020 2020 2068 6967 6865 7220 7661 6c75       higher valu
-00024860: 6520 6f66 2052 6573 6973 7469 7669 7479  e of Resistivity
-00024870: 200d 0a20 2020 206d 696e 2020 2020 2020   ..    min      
-00024880: 2020 2020 2020 2020 2066 6c6f 6174 2020           float  
-00024890: 2020 2020 2020 206d 696e 696d 756d 2076         minimum v
-000248a0: 616c 7565 206f 6620 7265 7369 7469 7669  alue of resitivi
-000248b0: 7479 206f 6e20 7468 6520 6172 6561 0d0a  ty on the area..
-000248c0: 2020 2020 6d65 616e 2020 2020 2020 2020      mean        
-000248d0: 2020 2020 2020 666c 6f61 7420 2020 2020        float     
-000248e0: 2020 2020 6576 6572 6167 6520 7661 6c75      everage valu
-000248f0: 6520 6f66 2074 6865 2072 686f 200d 0a20  e of the rho .. 
-00024900: 2020 206c 6f63 2020 2020 2020 2020 2020     loc          
-00024910: 2020 2020 2064 6963 7420 2020 2020 2020       dict       
-00024920: 2020 206c 6f63 6174 696f 6e20 6f66 2072     location of r
-00024930: 686f 2020 7661 6c75 6520 6174 2074 6865  ho  value at the
-00024940: 2073 7461 7469 6f6e 206c 616d 6264 6120   station lambda 
-00024950: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00024960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024970: 2020 2020 2020 652e 6720 2d20 6c6f 635b        e.g - loc[
-00024980: 2753 3133 5d20 7368 6f77 2074 6865 2063  'S13] show the c
-00024990: 7572 7265 6e74 2020 7268 6f20 6461 7461  urrent  rho data
-000249a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000249b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000249c0: 2020 2020 2020 2061 7420 7468 6520 7374         at the st
-000249d0: 6174 696f 6e20 5331 330d 0a20 2020 2053  ation S13..    S
-000249e0: 7265 7320 2020 2020 2020 2020 2020 2020  res             
-000249f0: 206e 6461 7272 6179 2020 2020 2020 2041   ndarray       A
-00024a00: 7374 6174 6963 2076 616c 7565 2063 6f72  static value cor
-00024a10: 7265 6374 6564 0d0a 2020 2020 3d3d 3d3d  rected..    ====
-00024a20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
-00024a30: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-00024a40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00024a50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00024a60: 3d3d 3d3d 3d3d 3d0d 0a0d 0a20 2020 204d  =======....    M
-00024a70: 6f72 6520 6174 7472 6962 7574 6573 2063  ore attributes c
-00024a80: 616e 2062 6520 6164 6465 6420 6279 2069  an be added by i
-00024a90: 6e70 7574 696e 6720 6120 6b65 7920 776f  nputing a key wo
-00024aa0: 7264 2064 6963 7469 6f6e 6172 790d 0a20  rd dictionary.. 
-00024ab0: 2020 200d 0a20 2020 203a 4578 616d 706c     ..    :Exampl
-00024ac0: 653a 2020 0d0a 2020 2020 2020 2020 200d  e:  ..         .
-00024ad0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-00024ae0: 6d20 6373 616d 6d74 7079 2e66 662e 636f  m csammtpy.ff.co
-00024af0: 7265 2e61 7667 2069 6d70 6f72 7420 4176  re.avg import Av
-00024b00: 6720 0d0a 2020 2020 2020 2020 3e3e 3e20  g ..        >>> 
-00024b10: 7061 7468 3d6f 732e 7061 7468 2e6a 6f69  path=os.path.joi
-00024b20: 6e28 6f73 2e65 6e76 6972 6f6e 5b22 7079  n(os.environ["py
-00024b30: 4353 414d 5422 5d2c 200d 0a20 2020 2020  CSAMT"], ..     
-00024b40: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00024b50: 2020 2020 2020 2020 2770 7963 7361 6d74          'pycsamt
-00024b60: 272c 2022 6461 7461 222c 2022 4b31 2e41  ', "data", "K1.A
-00024b70: 5647 2229 0d0a 2020 2020 2020 2020 3e3e  VG")..        >>
-00024b80: 3e20 6176 675f 6f62 6a3d 4176 6728 7061  > avg_obj=Avg(pa
-00024b90: 7468 290d 0a20 2020 2020 2020 203e 3e3e  th)..        >>>
-00024ba0: 2072 686f 5f6f 626a 203d 6176 675f 6f62   rho_obj =avg_ob
-00024bb0: 6a2e 4461 7461 5f73 6563 7469 6f6e 2e52  j.Data_section.R
-00024bc0: 6573 6973 7469 7669 7479 2e6c 6f63 5b27  esistivity.loc['
-00024bd0: 5330 3027 5d0d 0a20 2020 2020 2020 203e  S00']..        >
-00024be0: 3e3e 2070 7269 6e74 2872 686f 2e6c 6f63  >> print(rho.loc
-00024bf0: 5b27 5330 3027 5d29 0d0a 2020 2020 2222  ['S00'])..    ""
-00024c00: 220d 0a20 2020 200d 0a20 2020 2064 6566  "..    ..    def
-00024c10: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00024c20: 7265 735f 6172 7261 7920 3d4e 6f6e 6520  res_array =None 
-00024c30: 2c20 6e75 6d62 6572 5f6f 665f 6672 6571  , number_of_freq
-00024c40: 7565 6e63 6965 733d 4e6f 6e65 202c 200d  uencies=None , .
-00024c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024c60: 2020 6e75 6d62 6572 5f6f 665f 7374 6174    number_of_stat
-00024c70: 696f 6e73 3d4e 6f6e 6520 2c20 2a2a 6b77  ions=None , **kw
-00024c80: 6172 6773 293a 0d0a 0d0a 2020 2020 2020  args):....      
-00024c90: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00024ca0: 2e72 6573 5f61 7272 6179 3d72 6573 5f61  .res_array=res_a
-00024cb0: 7272 6179 200d 0a20 2020 2020 2020 200d  rray ..        .
-00024cc0: 0a20 2020 2020 2020 2073 656c 662e 5372  .        self.Sr
-00024cd0: 6573 3d4e 6f6e 6520 0d0a 2020 2020 2020  es=None ..      
-00024ce0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00024cf0: 2e6e 756d 6265 725f 6f66 5f73 7461 7469  .number_of_stati
-00024d00: 6f6e 7320 3d6b 7761 7267 732e 706f 7028  ons =kwargs.pop(
-00024d10: 226e 756d 6265 725f 6f66 5f73 7461 7469  "number_of_stati
-00024d20: 6f6e 7322 2c20 4e6f 6e65 290d 0a20 2020  ons", None)..   
-00024d30: 2020 2020 2073 656c 662e 6e66 7265 7120       self.nfreq 
-00024d40: 3d6b 7761 7267 732e 706f 7028 276e 756d  =kwargs.pop('num
-00024d50: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-00024d60: 6573 272c 204e 6f6e 6529 0d0a 2020 2020  es', None)..    
-00024d70: 2020 2020 7365 6c66 2e53 7265 7320 3d6b      self.Sres =k
-00024d80: 7761 7267 732e 706f 7028 2761 6464 6564  wargs.pop('added
-00024d90: 5f61 7374 6174 6963 5f72 686f 5f61 7272  _astatic_rho_arr
-00024da0: 6179 272c 204e 6f6e 6529 0d0a 2020 2020  ay', None)..    
-00024db0: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
-00024dc0: 6c66 2e76 616c 7565 203d 4e6f 6e65 200d  lf.value =None .
-00024dd0: 0a20 2020 2020 2020 2073 656c 662e 6d69  .        self.mi
-00024de0: 6e20 3d20 4e6f 6e65 200d 0a20 2020 2020  n = None ..     
-00024df0: 2020 2073 656c 662e 6d61 7820 3d20 4e6f     self.max = No
-00024e00: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
-00024e10: 662e 6c6f 6320 3d20 4e6f 6e65 200d 0a20  f.loc = None .. 
-00024e20: 2020 2020 2020 2066 6f72 206b 6579 2069         for key i
-00024e30: 6e20 6c69 7374 286b 7761 7267 732e 6b65  n list(kwargs.ke
-00024e40: 7973 2829 293a 0d0a 2020 2020 2020 2020  ys()):..        
-00024e50: 2020 2020 7365 7461 7474 7228 7365 6c66      setattr(self
-00024e60: 2c20 6b65 792c 206b 7761 7267 735b 6b65  , key, kwargs[ke
-00024e70: 795d 290d 0a20 2020 2020 2020 2020 2020  y])..           
-00024e80: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
-00024e90: 6c66 2e72 6573 5f61 7272 6179 2069 7320  lf.res_array is 
-00024ea0: 6e6f 7420 4e6f 6e65 203a 200d 0a20 2020  not None : ..   
-00024eb0: 2020 2020 2020 2020 2073 656c 662e 5f72           self._r
-00024ec0: 6561 645f 7265 735f 6461 7461 2028 290d  ead_res_data ().
-00024ed0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00024ee0: 2020 200d 0a20 2020 2064 6566 205f 7265     ..    def _re
-00024ef0: 6164 5f72 6573 5f64 6174 6120 2873 656c  ad_res_data (sel
-00024f00: 662c 7265 735f 6172 7261 7920 3d4e 6f6e  f,res_array =Non
-00024f10: 652c 206e 756d 6265 725f 6f66 5f66 7265  e, number_of_fre
-00024f20: 7175 656e 6369 6573 3d4e 6f6e 6520 2c20  quencies=None , 
-00024f30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00024f40: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-00024f50: 725f 6f66 5f73 7461 7469 6f6e 733d 4e6f  r_of_stations=No
-00024f60: 6e65 2c20 5372 6573 3d4e 6f6e 652c 2020  ne, Sres=None,  
-00024f70: 2a2a 6b77 6172 6773 2020 293a 0d0a 2020  **kwargs  ):..  
-00024f80: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00024f90: 2020 204d 6574 686f 6420 746f 2072 6561     Method to rea
-00024fa0: 6420 7265 7369 7469 7669 7479 2020 6163  d resitivity  ac
-00024fb0: 636f 7264 696e 6720 6561 6368 2073 7461  cording each sta
-00024fc0: 7469 6f6e 202f 5265 7369 7374 6976 6974  tion /Resistivit
-00024fd0: 7920 616e 676c 6573 200d 0a20 2020 2020  y angles ..     
-00024fe0: 2020 2020 2020 2076 616c 7565 7320 2e0d         values ..
-00024ff0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00025000: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00025010: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00025020: 2d0d 0a20 2020 2020 2020 2020 2020 202a  -..            *
-00025030: 2072 6573 5f61 7272 6179 203a 2061 7272   res_array : arr
-00025040: 6179 5f6c 696b 6520 0d0a 2020 2020 2020  ay_like ..      
-00025050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025060: 2020 2052 6573 6973 7469 7669 7479 2063     Resistivity c
-00025070: 616c 6375 6c61 7465 6420 206f 6e20 7468  alculated  on th
-00025080: 6520 6669 656c 642e 200d 0a20 2020 2020  e field. ..     
-00025090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000250a0: 2020 2020 5468 6520 2a64 6566 6175 6c74      The *default
-000250b0: 2a20 6973 204e 6f6e 652e 0d0a 2020 2020  * is None...    
-000250c0: 2020 2020 2020 2020 2a20 6e75 6d62 6572          * number
-000250d0: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
-000250e0: 3a20 696e 7420 2c20 6f70 7469 6f6e 616c  : int , optional
-000250f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00025100: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00025110: 6d62 6572 206f 6620 6672 6571 7565 6e63  mber of frequenc
-00025120: 6965 7320 666f 7220 7375 7276 6579 2e20  ies for survey. 
-00025130: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00025140: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00025150: 6520 2a64 6566 6175 6c74 2a20 6973 204e  e *default* is N
-00025160: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
-00025170: 2020 2a20 6e75 6d62 6572 5f6f 665f 7374    * number_of_st
-00025180: 6174 696f 6e73 203a 2069 6e74 202c 206f  ations : int , o
-00025190: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-000251a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000251b0: 2020 2020 206e 756d 6265 725f 6f66 2073       number_of s
-000251c0: 7461 7469 6f6e 732e 200d 0a20 2020 2020  tations. ..     
-000251d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000251e0: 2020 2020 2020 2054 6865 202a 6465 6661         The *defa
-000251f0: 756c 742a 2069 7320 4e6f 6e65 2e0d 0a20  ult* is None... 
-00025200: 2020 2020 2020 2020 2020 202a 2053 7265             * Sre
-00025210: 7320 3a20 6e64 6172 7261 792c 200d 0a20  s : ndarray, .. 
-00025220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025230: 2020 2020 2020 205a 6f6e 6765 2041 7374         Zonge Ast
-00025240: 6174 6963 2072 686f 2063 616c 6375 6c61  atic rho calcula
-00025250: 7465 642e 0d0a 2020 2020 2020 2020 2222  ted...        ""
-00025260: 220d 0a20 2020 2020 2020 200d 0a20 2020  "..        ..   
-00025270: 2020 2020 2069 6620 7265 735f 6172 7261       if res_arra
-00025280: 7920 2069 7320 6e6f 7420 4e6f 6e65 203a  y  is not None :
-00025290: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-000252a0: 656c 662e 7265 735f 6172 7261 793d 2072  elf.res_array= r
-000252b0: 6573 5f61 7272 6179 0d0a 2020 2020 2020  es_array..      
-000252c0: 2020 6966 2073 656c 662e 7265 735f 6172    if self.res_ar
-000252d0: 7261 7920 6973 204e 6f6e 6520 3a20 0d0a  ray is None : ..
-000252e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000252f0: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-00025300: 726f 725f 696e 7075 7461 7267 756d 656e  ror_inputargumen
-00025310: 7473 2827 4e6f 2052 6573 6973 7469 7669  ts('No Resistivi
-00025320: 7479 2064 6174 6120 666f 756e 6420 2127  ty data found !'
-00025330: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00025340: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
-00025350: 6e63 6965 7320 6973 206e 6f74 204e 6f6e  ncies is not Non
-00025360: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-00025370: 2020 7365 6c66 2e6e 6672 6571 203d 6e75    self.nfreq =nu
-00025380: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-00025390: 6965 7320 0d0a 2020 2020 2020 2020 656c  ies ..        el
-000253a0: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
-000253b0: 2020 7261 6973 6520 4353 6578 2e70 7943    raise CSex.pyC
-000253c0: 5341 4d54 4572 726f 725f 696e 7075 7461  SAMTError_inputa
-000253d0: 7267 756d 656e 7473 280d 0a20 2020 2020  rguments(..     
-000253e0: 2020 2020 2020 2020 2020 2022 506c 6561             "Plea
-000253f0: 7365 2073 7065 6369 6679 2074 6865 206e  se specify the n
-00025400: 756d 6265 7220 6f66 2066 7265 7175 656e  umber of frequen
-00025410: 6379 2021 2229 0d0a 2020 2020 2020 2020  cy !")..        
-00025420: 6966 206e 756d 6265 725f 6f66 5f73 7461  if number_of_sta
-00025430: 7469 6f6e 7320 6973 206e 6f74 204e 6f6e  tions is not Non
-00025440: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-00025450: 2020 7365 6c66 2e6e 756d 6265 725f 6f66    self.number_of
-00025460: 5f73 7461 7469 6f6e 7320 3d6e 756d 6265  _stations =numbe
-00025470: 725f 6f66 5f73 7461 7469 6f6e 7320 0d0a  r_of_stations ..
-00025480: 2020 2020 2020 2020 656c 7365 203a 200d          else : .
-00025490: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000254a0: 7365 2043 5365 782e 7079 4353 414d 5445  se CSex.pyCSAMTE
-000254b0: 7272 6f72 5f69 6e70 7574 6172 6775 6d65  rror_inputargume
-000254c0: 6e74 7328 0d0a 2020 2020 2020 2020 2020  nts(..          
-000254d0: 2020 2020 2020 2750 6c65 6173 6520 7370        'Please sp
-000254e0: 6563 6966 7920 7468 6520 6e75 6d62 6572  ecify the number
-000254f0: 206f 6620 7374 6174 696f 6e73 2729 0d0a   of stations')..
-00025500: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00025510: 2020 6966 2053 7265 7320 6973 206e 6f74    if Sres is not
-00025520: 204e 6f6e 6520 3a0d 0a0d 0a20 2020 2020   None :....     
-00025530: 2020 2020 2020 2073 656c 662e 5372 6573         self.Sres
-00025540: 203d 206e 702e 6172 7261 7928 5b6e 702e   = np.array([np.
-00025550: 666c 6f61 7428 7265 7329 2066 6f72 2072  float(res) for r
-00025560: 6573 2069 6e20 5372 6573 5d29 0d0a 2020  es in Sres])..  
-00025570: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00025580: 662e 7265 735f 6172 7261 792e 7368 6170  f.res_array.shap
-00025590: 655b 305d 2021 3d20 7365 6c66 2e53 7265  e[0] != self.Sre
-000255a0: 732e 7369 7a65 203a 200d 0a20 2020 2020  s.size : ..     
-000255b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000255c0: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-000255d0: 6f72 5f72 686f 280d 0a20 2020 2020 2020  or_rho(..       
-000255e0: 2020 2020 2020 2020 2020 2020 2027 5265               'Re
-000255f0: 7369 7374 6976 6974 7920 6361 6c63 756c  sistivity calcul
-00025600: 6174 6564 2026 2027 0d0a 2020 2020 2020  ated & '..      
-00025610: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00025620: 4173 7461 7469 635f 6172 7261 7920 6d75  Astatic_array mu
-00025630: 7374 2067 6574 2074 6865 2073 616d 6520  st get the same 
-00025640: 6c65 6e67 7468 212e 2729 0d0a 2020 2020  length!.')..    
-00025650: 2020 2020 7472 7920 3a20 0d0a 2020 2020      try : ..    
-00025660: 2020 2020 2020 2020 7365 6c66 2e6e 6672          self.nfr
-00025670: 6571 3d6e 702e 696e 7428 7365 6c66 2e6e  eq=np.int(self.n
-00025680: 6672 6571 290d 0a20 2020 2020 2020 2020  freq)..         
-00025690: 2020 2073 656c 662e 6e75 6d62 6572 5f6f     self.number_o
-000256a0: 665f 7374 6174 696f 6e73 203d 6e70 2e69  f_stations =np.i
-000256b0: 6e74 2873 656c 662e 6e75 6d62 6572 5f6f  nt(self.number_o
-000256c0: 665f 7374 6174 696f 6e73 290d 0a20 2020  f_stations)..   
-000256d0: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
-000256e0: 735f 6172 7261 7920 3d6e 702e 6172 7261  s_array =np.arra
-000256f0: 7928 5b6e 702e 666c 6f61 7428 6363 2920  y([np.float(cc) 
-00025700: 666f 7220 6363 2069 6e20 7365 6c66 2e72  for cc in self.r
-00025710: 6573 5f61 7272 6179 5d29 0d0a 0d0a 2020  es_array])....  
-00025720: 2020 2020 2020 6578 6365 7074 203a 0d0a        except :..
-00025730: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00025740: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-00025750: 726f 725f 7661 6c75 6528 0d0a 2020 2020  ror_value(..    
-00025760: 2020 2020 2020 2020 2020 2020 2256 616c              "Val
-00025770: 7565 7320 7072 6f76 6964 6564 2066 6f72  ues provided for
-00025780: 2074 6865 2052 6573 6973 7469 7669 7469   the Resistiviti
-00025790: 6573 2061 7265 2077 726f 6e67 2e22 0d0a  es are wrong."..
-000257a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000257b0: 2022 206d 7573 7420 6265 2066 6c6f 6174   " must be float
-000257c0: 206f 7220 696e 7465 6765 7220 2e22 290d   or integer .").
-000257d0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000257e0: 2020 2076 636f 756e 7473 5f72 6573 2c20     vcounts_res, 
-000257f0: 7265 7065 6174 5f68 7068 7a3d 6e70 2e75  repeat_hphz=np.u
-00025800: 6e69 7175 6520 2873 656c 662e 7265 735f  nique (self.res_
-00025810: 6172 7261 792c 0d0a 2020 2020 2020 2020  array,..        
+00021e80: 2020 2020 2073 686f 7720 7468 6520 6375       show the cu
+00021e90: 7272 656e 7420 2048 2d6d 6167 2064 6174  rrent  H-mag dat
+00021ea0: 610d 0a20 2020 2020 2020 2020 2020 2020  a..             
+00021eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ec0: 2020 2020 2020 206f 6620 7374 6174 696f         of statio
+00021ed0: 6e20 6174 2053 3035 2e0d 0a20 2020 203d  n at S05...    =
+00021ee0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+00021ef0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d   ===========  ==
+00021f00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00021f10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00021f20: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a 2020  ==========....  
+00021f30: 2020 4d6f 7265 2061 7474 7269 6275 7465    More attribute
+00021f40: 7320 6361 6e20 6265 2061 6464 6564 2062  s can be added b
+00021f50: 7920 696e 7075 7469 6e67 2061 206b 6579  y inputing a key
+00021f60: 2077 6f72 6420 6469 6374 696f 6e61 7279   word dictionary
+00021f70: 0d0a 2020 2020 0d0a 2020 2020 3a45 7861  ..    ..    :Exa
+00021f80: 6d70 6c65 3a20 0d0a 2020 2020 2020 2020  mple: ..        
+00021f90: 200d 0a20 2020 2020 2020 203e 3e3e 2066   ..        >>> f
+00021fa0: 726f 6d20 7079 6373 616d 742e 636f 7265  rom pycsamt.core
+00021fb0: 2069 6d70 6f72 7420 4176 6720 0d0a 2020   import Avg ..  
+00021fc0: 2020 2020 2020 3e3e 3e20 7061 7468 3d6f        >>> path=o
+00021fd0: 732e 7061 7468 2e6a 6f69 6e28 6f73 2e65  s.path.join(os.e
+00021fe0: 6e76 6972 6f6e 5b22 7079 4353 414d 5422  nviron["pyCSAMT"
+00021ff0: 5d2c 200d 0a20 2020 2020 2020 202e 2e2e  ], ..        ...
+00022000: 2020 2020 2020 2770 7963 7361 6d74 272c        'pycsamt',
+00022010: 2022 6461 7461 222c 2022 4b31 2e41 5647   "data", "K1.AVG
+00022020: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
+00022030: 6176 675f 6f62 6a3d 4176 6728 7061 7468  avg_obj=Avg(path
+00022040: 290d 0a20 2020 2020 2020 203e 3e3e 2068  )..        >>> h
+00022050: 6d61 675f 6f62 6a20 3d61 7667 5f6f 626a  mag_obj =avg_obj
+00022060: 2e44 6174 615f 7365 6374 696f 6e2e 486d  .Data_section.Hm
+00022070: 6167 2e6c 6f63 5b27 5330 3527 5d0d 0a20  ag.loc['S05'].. 
+00022080: 2020 2020 2020 202e 2e2e 2070 7269 6e74         ... print
+00022090: 2868 6d61 675f 6f62 6a29 0d0a 2020 2020  (hmag_obj)..    
+000220a0: 2222 220d 0a20 2020 200d 0a20 2020 2064  """..    ..    d
+000220b0: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+000220c0: 2c20 685f 6d61 675f 6172 7261 793d 4e6f  , h_mag_array=No
+000220d0: 6e65 2c20 6e75 6d62 6572 5f6f 665f 6672  ne, number_of_fr
+000220e0: 6571 7565 6e63 6965 733d 4e6f 6e65 202c  equencies=None ,
+000220f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00022100: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
+00022110: 7469 6f6e 733d 4e6f 6e65 202c 202a 2a6b  tions=None , **k
+00022120: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
+00022130: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00022140: 685f 6d61 675f 6172 7261 7920 3d68 5f6d  h_mag_array =h_m
+00022150: 6167 5f61 7272 6179 0d0a 2020 2020 2020  ag_array..      
+00022160: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+00022170: 2e6e 756d 6265 725f 6f66 5f73 7461 7469  .number_of_stati
+00022180: 6f6e 7320 3d6b 7761 7267 732e 706f 7028  ons =kwargs.pop(
+00022190: 226e 756d 6265 725f 6f66 5f73 7461 7469  "number_of_stati
+000221a0: 6f6e 7322 2c20 4e6f 6e65 290d 0a20 2020  ons", None)..   
+000221b0: 2020 2020 2073 656c 662e 6e66 7265 7120       self.nfreq 
+000221c0: 3d6b 7761 7267 732e 706f 7028 276e 756d  =kwargs.pop('num
+000221d0: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
+000221e0: 6573 272c 204e 6f6e 6529 0d0a 2020 2020  es', None)..    
+000221f0: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+00022200: 6c66 2e76 616c 7565 203d 4e6f 6e65 200d  lf.value =None .
+00022210: 0a20 2020 2020 2020 2073 656c 662e 6d69  .        self.mi
+00022220: 6e20 3d20 4e6f 6e65 200d 0a20 2020 2020  n = None ..     
+00022230: 2020 2073 656c 662e 6d61 7820 3d20 4e6f     self.max = No
+00022240: 6e65 200d 0a20 2020 200d 0a20 2020 2020  ne ..    ..     
+00022250: 2020 2066 6f72 206b 6579 2069 6e20 6c69     for key in li
+00022260: 7374 286b 7761 7267 732e 6b65 7973 2829  st(kwargs.keys()
+00022270: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00022280: 7365 7461 7474 7228 7365 6c66 2c20 6b65  setattr(self, ke
+00022290: 792c 206b 7761 7267 735b 6b65 795d 290d  y, kwargs[key]).
+000222a0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+000222b0: 2020 2020 2020 2069 6620 7365 6c66 2e68         if self.h
+000222c0: 5f6d 6167 5f61 7272 6179 2020 6973 206e  _mag_array  is n
+000222d0: 6f74 204e 6f6e 6520 3a20 0d0a 2020 2020  ot None : ..    
+000222e0: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
+000222f0: 6164 5f68 6d61 675f 6461 7461 2028 290d  ad_hmag_data ().
+00022300: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00022310: 2020 200d 0a20 2020 2064 6566 205f 7265     ..    def _re
+00022320: 6164 5f68 6d61 675f 6461 7461 2028 7365  ad_hmag_data (se
+00022330: 6c66 2c20 685f 6d61 675f 6172 7261 793d  lf, h_mag_array=
+00022340: 4e6f 6e65 2c20 6e75 6d62 6572 5f6f 665f  None, number_of_
+00022350: 6672 6571 7565 6e63 6965 733d 4e6f 6e65  frequencies=None
+00022360: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
+00022370: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00022380: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+00022390: 3d4e 6f6e 6520 293a 0d0a 2020 2020 2020  =None ):..      
+000223a0: 2020 2222 220d 0a20 2020 2020 2020 204d    """..        M
+000223b0: 6574 686f 6420 746f 2072 6561 6420 616e  ethod to read an
+000223c0: 6420 6172 616e 6765 2064 6174 6120 6163  d arange data ac
+000223d0: 636f 7264 696e 6720 0d0a 2020 2020 2020  cording ..      
+000223e0: 2020 6561 6368 2073 7461 7469 6f6e 202f    each station /
+000223f0: 425f 6669 656c 6420 6d61 676e 6974 7564  B_field magnitud
+00022400: 6520 2076 616c 7565 7320 2e0d 0a20 2020  e  values ...   
+00022410: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00022420: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00022430: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00022440: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+00022450: 685f 6d61 675f 6172 7261 7920 3a20 6e64  h_mag_array : nd
+00022460: 6172 7261 792c 206f 7074 696f 6e61 6c0d  array, optional.
+00022470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022480: 2020 2020 2020 2020 2020 2020 2042 2046               B F
+00022490: 6965 6c64 206d 6561 7375 7265 6420 6461  ield measured da
+000224a0: 7461 206f 6e20 7468 6520 7369 7465 732e  ta on the sites.
+000224b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000224c0: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+000224d0: 6520 6465 6661 756c 7420 6973 204e 6f6e  e default is Non
+000224e0: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
+000224f0: 2a20 6e75 6d62 6572 5f6f 665f 6672 6571  * number_of_freq
+00022500: 7565 6e63 6965 7320 3a20 696e 7420 2c20  uencies : int , 
+00022510: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00022520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022530: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00022540: 6d62 6572 206f 6620 6672 6571 7565 6e63  mber of frequenc
+00022550: 6965 7320 666f 7220 7375 7276 6579 2e20  ies for survey. 
+00022560: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00022570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022580: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
+00022590: 7420 6973 204e 6f6e 652e 0d0a 2020 2020  t is None...    
+000225a0: 2020 2020 2020 2020 2a20 6e75 6d62 6572          * number
+000225b0: 5f6f 665f 7374 6174 696f 6e73 203a 2069  _of_stations : i
+000225c0: 6e74 202c 206f 7074 696f 6e61 6c0d 0a20  nt , optional.. 
+000225d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000225e0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000225f0: 756d 6265 725f 6f66 2073 7461 7469 6f6e  umber_of station
+00022600: 732e 2054 6865 2064 6566 6175 6c74 2069  s. The default i
+00022610: 7320 4e6f 6e65 2e0d 0a20 2020 2020 2020  s None...       
+00022620: 2022 2222 0d0a 2020 2020 2020 2020 0d0a   """..        ..
+00022630: 2020 2020 2020 2020 6966 2068 5f6d 6167          if h_mag
+00022640: 5f61 7272 6179 2069 7320 6e6f 7420 4e6f  _array is not No
+00022650: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
+00022660: 2020 2073 656c 662e 685f 6d61 675f 6172     self.h_mag_ar
+00022670: 7261 7920 3d68 5f6d 6167 5f61 7272 6179  ray =h_mag_array
+00022680: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
+00022690: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+000226a0: 2e68 5f6d 6167 5f61 7272 6179 2069 7320  .h_mag_array is 
+000226b0: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+000226c0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+000226d0: 7272 6f72 2827 4e6f 2042 2d46 6965 6c64  rror('No B-Field
+000226e0: 2020 6461 7461 2066 6f75 6e64 2020 2127    data found  !'
+000226f0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+00022700: 0a20 2020 2020 2020 2069 6620 6e75 6d62  .        if numb
+00022710: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00022720: 7320 6973 206e 6f74 204e 6f6e 6520 3a20  s is not None : 
+00022730: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00022740: 6c66 2e6e 6672 6571 203d 6e75 6d62 6572  lf.nfreq =number
+00022750: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
+00022760: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+00022770: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00022780: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
+00022790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000227a0: 2250 6c65 6173 6520 7370 6563 6966 7920  "Please specify 
+000227b0: 7468 6520 6e75 6d62 6572 206f 6620 6672  the number of fr
+000227c0: 6571 7565 6e63 7920 2122 290d 0a20 2020  equency !")..   
+000227d0: 2020 2020 2069 6620 6e75 6d62 6572 5f6f       if number_o
+000227e0: 665f 7374 6174 696f 6e73 2069 7320 6e6f  f_stations is no
+000227f0: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
+00022800: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
+00022810: 725f 6f66 5f73 7461 7469 6f6e 7320 3d6e  r_of_stations =n
+00022820: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+00022830: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
+00022840: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00022850: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00022860: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00022870: 2020 2027 506c 6561 7365 2073 7065 6369     'Please speci
+00022880: 6679 2074 6865 206e 756d 6265 7220 6f66  fy the number of
+00022890: 2073 7461 7469 6f6e 7327 290d 0a20 2020   stations')..   
+000228a0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+000228b0: 2020 2074 7279 203a 200d 0a20 2020 2020     try : ..     
+000228c0: 2020 2020 2020 2073 656c 662e 6e66 7265         self.nfre
+000228d0: 713d 6e70 2e69 6e74 2873 656c 662e 6e66  q=np.int(self.nf
+000228e0: 7265 7129 0d0a 2020 2020 2020 2020 2020  req)..          
+000228f0: 2020 7365 6c66 2e6e 756d 6265 725f 6f66    self.number_of
+00022900: 5f73 7461 7469 6f6e 7320 3d6e 702e 696e  _stations =np.in
+00022910: 7428 7365 6c66 2e6e 756d 6265 725f 6f66  t(self.number_of
+00022920: 5f73 7461 7469 6f6e 7329 0d0a 2020 2020  _stations)..    
+00022930: 2020 2020 2020 2020 7365 6c66 2e68 5f6d          self.h_m
+00022940: 6167 5f61 7272 6179 3d6e 702e 6172 7261  ag_array=np.arra
+00022950: 7928 5b6e 702e 666c 6f61 7428 6363 2920  y([np.float(cc) 
+00022960: 666f 7220 6363 2069 6e20 7365 6c66 2e68  for cc in self.h
+00022970: 5f6d 6167 5f61 7272 6179 5d29 0d0a 0d0a  _mag_array])....
+00022980: 2020 2020 2020 2020 6578 6365 7074 203a          except :
+00022990: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+000229a0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000229b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000229c0: 2020 2256 616c 7565 7320 7072 6f76 6964    "Values provid
+000229d0: 6564 2066 6f72 2074 6865 2042 2d46 6965  ed for the B-Fie
+000229e0: 6c64 2061 7265 2077 726f 6e67 2e22 0d0a  ld are wrong."..
+000229f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a00: 2220 6d75 7374 2062 6520 666c 6f61 7420  " must be float 
+00022a10: 6f72 2069 6e74 6567 6572 202e 2229 0d0a  or integer .")..
+00022a20: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00022a30: 2020 2020 2020 7663 6f75 6e74 735f 685f        vcounts_h_
+00022a40: 6d61 672c 2072 6570 6561 745f 616d 7020  mag, repeat_amp 
+00022a50: 3d6e 702e 756e 6971 7565 2028 7365 6c66  =np.unique (self
+00022a60: 2e68 5f6d 6167 5f61 7272 6179 2c0d 0a20  .h_mag_array,.. 
+00022a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a90: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00022aa0: 7572 6e5f 636f 756e 7473 3d54 7275 6529  urn_counts=True)
+00022ab0: 0d0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
+00022ac0: 616c 7565 203d 7663 6f75 6e74 735f 685f  alue =vcounts_h_
+00022ad0: 6d61 670d 0a20 2020 2020 2020 200d 0a20  mag..        .. 
+00022ae0: 2020 2020 2020 2073 656c 662e 6d61 782c         self.max,
+00022af0: 2073 656c 662e 6d69 6e20 3d76 636f 756e   self.min =vcoun
+00022b00: 7473 5f68 5f6d 6167 2e6d 6178 2829 2c20  ts_h_mag.max(), 
+00022b10: 7663 6f75 6e74 735f 685f 6d61 672e 6d69  vcounts_h_mag.mi
+00022b20: 6e28 290d 0a20 2020 2020 2020 200d 0a20  n()..        .. 
+00022b30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00022b40: 2074 7275 6e63 6174 6564 5f68 5f6d 6167   truncated_h_mag
+00022b50: 3d5a 6363 2e74 7275 6e63 6174 6564 5f64  =Zcc.truncated_d
+00022b60: 6174 6128 2064 6174 6120 3d73 656c 662e  ata( data =self.
+00022b70: 685f 6d61 675f 6172 7261 792c 200d 0a20  h_mag_array, .. 
+00022b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ba0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
+00022bb0: 7265 6363 7572 656e 6365 3d73 656c 662e  reccurence=self.
+00022bc0: 6e66 7265 7129 0d0a 2020 2020 2020 2020  nfreq)..        
+00022bd0: 6e61 6d65 2c20 706f 6c79 6e61 6d65 203d  name, polyname =
+00022be0: 205a 6363 2e5f 6e75 6d62 6572 696e 675f   Zcc._numbering_
+00022bf0: 7374 6174 696f 6e28 0d0a 2020 2020 2020  station(..      
+00022c00: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
+00022c10: 7374 6174 696f 6e3d 7365 6c66 2e6e 756d  station=self.num
+00022c20: 6265 725f 6f66 5f73 7461 7469 6f6e 732c  ber_of_stations,
+00022c30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00022c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c50: 2020 6e75 6d62 6572 5f6f 665f 6672 6571    number_of_freq
+00022c60: 203d 7365 6c66 2e6e 6672 6571 290d 0a20   =self.nfreq).. 
+00022c70: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00022c80: 2073 656c 662e 6c6f 6320 3d7b 206b 6579   self.loc ={ key
+00022c90: 3a76 616c 7565 2066 6f72 206b 6579 2c20  :value for key, 
+00022ca0: 7661 6c75 6520 696e 207a 6970 286e 616d  value in zip(nam
+00022cb0: 652c 2074 7275 6e63 6174 6564 5f68 5f6d  e, truncated_h_m
+00022cc0: 6167 2029 7d0d 0a20 2020 2020 2020 2020  ag )}..         
+00022cd0: 2020 200d 0a63 6c61 7373 2048 7068 7a20     ..class Hphz 
+00022ce0: 286f 626a 6563 7429 3a0d 0a20 2020 2022  (object):..    "
+00022cf0: 2222 0d0a 2020 2020 482d 6669 656c 6420  ""..    H-field 
+00022d00: 7068 6173 6520 286d 696c 6c69 5261 6469  phase (milliRadi
+00022d10: 616e 7329 0d0a 2020 2020 0d0a 2020 2020  ans)..    ..    
+00022d20: 4172 6775 6d65 6e74 7320 0d0a 2020 2020  Arguments ..    
+00022d30: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00022d40: 2020 202a 2a68 5f70 687a 5f61 7272 6179     **h_phz_array
+00022d50: 2a2a 203a 206e 6461 7272 6179 0d0a 2020  ** : ndarray..  
+00022d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d70: 2020 2020 2020 455f 7068 6173 6520 6461        E_phase da
+00022d80: 7461 2066 6965 6c64 0d0a 2020 2020 2020  ta field..      
+00022d90: 2020 202a 2a74 6f5f 6465 6772 6565 2a2a     **to_degree**
+00022da0: 2020 3a20 626f 6f6c 200d 0a20 2020 2020    : bool ..     
+00022db0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00022dc0: 7574 2074 6865 2048 7068 7a20 7661 6c75  ut the Hphz valu
+00022dd0: 6520 6f6e 2064 6567 7265 6520 2e20 0d0a  e on degree . ..
+00022de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022df0: 2020 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d    ..    ========
+00022e00: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
+00022e10: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00022e20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00022e30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00022e40: 3d3d 3d0d 0a20 2020 2041 7474 7269 6275  ===..    Attribu
+00022e50: 7465 7320 2020 2020 2020 2020 5479 7065  tes         Type
+00022e60: 2020 2020 2020 2020 4578 706c 616e 6174          Explanat
+00022e70: 696f 6e0d 0a20 2020 203d 3d3d 3d3d 3d3d  ion..    =======
+00022e80: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+00022e90: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+00022ea0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00022eb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00022ec0: 3d3d 3d3d 0d0a 2020 2020 7661 6c75 6520  ====..    value 
+00022ed0: 2020 2020 2020 2020 2020 2020 6e64 2e61              nd.a
+00022ee0: 7272 6179 2020 2020 2020 6461 7461 206f  rray      data o
+00022ef0: 6620 456d 6167 2020 636f 6c75 6d6e 2020  f Emag  column  
+00022f00: 756e 6974 203a 206d 7261 6420 2020 0d0a  unit : mrad   ..
+00022f10: 2020 2020 6d61 7820 2020 2020 2020 2020      max         
+00022f20: 2020 2020 2020 666c 6f61 7420 2020 2020        float     
+00022f30: 2020 2020 6d61 7869 6d75 6d20 452d 4669      maximum E-Fi
+00022f40: 656c 6420 6d61 676e 6974 7564 6520 756e  eld magnitude un
+00022f50: 6974 203a 6d56 2f6b 6d2a 416d 7020 0d0a  it :mV/km*Amp ..
+00022f60: 2020 2020 6c6f 6320 2020 2020 2020 2020      loc         
+00022f70: 2020 2020 2020 6469 6374 2020 2020 2020        dict      
+00022f80: 2020 2020 6c6f 6361 7469 6f6e 206f 6620      location of 
+00022f90: 452d 7068 6173 6520 2076 616c 7565 2061  E-phase  value a
+00022fa0: 7420 7468 6520 7374 6174 696f 6e0d 0a20  t the station.. 
+00022fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022fd0: 2020 206c 616d 6264 6120 2c20 652e 6720     lambda , e.g 
+00022fe0: 6c6f 635b 2753 3433 5d20 7368 6f77 2074  loc['S43] show t
+00022ff0: 6865 0d0a 2020 2020 2020 2020 2020 2020  he..            
+00023000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023010: 2020 2020 2020 2020 6375 7272 656e 7420          current 
+00023020: 2045 2d70 6861 7365 2064 6174 6120 6174   E-phase data at
+00023030: 2074 6865 2073 7461 7469 6f6e 5334 330d   the stationS43.
+00023040: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+00023050: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00023060: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+00023070: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00023080: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00023090: 0d0a 0d0a 2020 2020 4d6f 7265 2061 7474  ....    More att
+000230a0: 7269 6275 7465 7320 6361 6e20 6265 2061  ributes can be a
+000230b0: 6464 6564 2062 7920 696e 7075 7469 6e67  dded by inputing
+000230c0: 2061 206b 6579 2077 6f72 6420 6469 6374   a key word dict
+000230d0: 696f 6e61 7279 0d0a 2020 2020 0d0a 2020  ionary..    ..  
+000230e0: 2020 3a45 7861 6d70 6c65 3a20 0d0a 2020    :Example: ..  
+000230f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00023100: 3e3e 3e20 6672 6f6d 2070 7963 7361 6d74  >>> from pycsamt
+00023110: 2e63 6f72 652e 6176 6720 696d 706f 7274  .core.avg import
+00023120: 2044 6174 615f 7365 6374 696f 6e20 0d0a   Data_section ..
+00023130: 2020 2020 2020 2020 3e3e 3e20 7061 7468          >>> path
+00023140: 3d6f 732e 7061 7468 2e6a 6f69 6e28 6f73  =os.path.join(os
+00023150: 2e65 6e76 6972 6f6e 5b22 7079 4353 414d  .environ["pyCSAM
+00023160: 5422 5d2c 200d 0a20 2020 2020 2020 2020  T"], ..         
+00023170: 2020 2020 2027 7079 6373 616d 7427 2c20       'pycsamt', 
+00023180: 2264 6174 6122 2c20 224b 312e 4156 4722  "data", "K1.AVG"
+00023190: 290d 0a20 2020 2020 2020 203e 3e3e 2061  )..        >>> a
+000231a0: 7667 5f6f 626a 3d41 7667 2870 6174 6829  vg_obj=Avg(path)
+000231b0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6870  ..        >>> hp
+000231c0: 687a 5f6f 626a 203d 6176 675f 6f62 6a2e  hz_obj =avg_obj.
+000231d0: 4461 7461 5f73 6563 7469 6f6e 2e45 7068  Data_section.Eph
+000231e0: 7a2e 6c6f 635b 2734 3327 5d0d 0a20 2020  z.loc['43']..   
+000231f0: 2020 2020 202e 2e2e 2070 7269 6e74 2868       ... print(h
+00023200: 7068 7a5f 6f62 6a29 0d0a 2020 2020 2222  phz_obj)..    ""
+00023210: 220d 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+00023220: 745f 5f28 7365 6c66 2c20 685f 7068 7a5f  t__(self, h_phz_
+00023230: 6172 7261 793d 4e6f 6e65 2c20 6e75 6d62  array=None, numb
+00023240: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00023250: 733d 4e6f 6e65 202c 200d 0a20 2020 2020  s=None , ..     
+00023260: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+00023270: 6572 5f6f 665f 7374 6174 696f 6e73 3d4e  er_of_stations=N
+00023280: 6f6e 6520 2c20 2a2a 6b77 6172 6773 293a  one , **kwargs):
+00023290: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000232a0: 2020 2020 7365 6c66 2e68 5f70 687a 5f61      self.h_phz_a
+000232b0: 7272 6179 3d20 685f 7068 7a5f 6172 7261  rray= h_phz_arra
+000232c0: 790d 0a20 2020 2020 2020 200d 0a20 2020  y..        ..   
+000232d0: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
+000232e0: 5f6f 665f 7374 6174 696f 6e73 203d 6b77  _of_stations =kw
+000232f0: 6172 6773 2e70 6f70 2822 6e75 6d62 6572  args.pop("number
+00023300: 5f6f 665f 7374 6174 696f 6e73 222c 204e  _of_stations", N
+00023310: 6f6e 6529 0d0a 2020 2020 2020 2020 7365  one)..        se
+00023320: 6c66 2e6e 6672 6571 203d 6b77 6172 6773  lf.nfreq =kwargs
+00023330: 2e70 6f70 2827 6e75 6d62 6572 5f6f 665f  .pop('number_of_
+00023340: 6672 6571 7565 6e63 6965 7327 2c20 4e6f  frequencies', No
+00023350: 6e65 290d 0a20 2020 2020 2020 2073 656c  ne)..        sel
+00023360: 662e 746f 5f64 6567 7265 6520 3d6b 7761  f.to_degree =kwa
+00023370: 7267 732e 706f 7028 2774 6f5f 6465 6772  rgs.pop('to_degr
+00023380: 6565 272c 2046 616c 7365 290d 0a20 2020  ee', False)..   
+00023390: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+000233a0: 656c 662e 7661 6c75 6520 3d4e 6f6e 6520  elf.value =None 
+000233b0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+000233c0: 696e 203d 204e 6f6e 6520 0d0a 2020 2020  in = None ..    
+000233d0: 2020 2020 7365 6c66 2e6d 6178 203d 204e      self.max = N
+000233e0: 6f6e 6520 0d0a 2020 2020 0d0a 2020 2020  one ..    ..    
+000233f0: 2020 2020 666f 7220 6b65 7920 696e 206c      for key in l
+00023400: 6973 7428 6b77 6172 6773 2e6b 6579 7328  ist(kwargs.keys(
+00023410: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+00023420: 2073 6574 6174 7472 2873 656c 662c 206b   setattr(self, k
+00023430: 6579 2c20 6b77 6172 6773 5b6b 6579 5d29  ey, kwargs[key])
+00023440: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00023450: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00023460: 2068 5f70 687a 5f61 7272 6179 2069 7320   h_phz_array is 
+00023470: 6e6f 7420 4e6f 6e65 203a 200d 0a20 2020  not None : ..   
+00023480: 2020 2020 2020 2020 2073 656c 662e 5f72           self._r
+00023490: 6561 645f 6870 687a 5f64 6174 6120 2829  ead_hphz_data ()
+000234a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000234b0: 2020 2020 0d0a 2020 2020 6465 6620 5f72      ..    def _r
+000234c0: 6561 645f 6870 687a 5f64 6174 6120 2873  ead_hphz_data (s
+000234d0: 656c 662c 685f 7068 7a5f 6172 7261 793d  elf,h_phz_array=
+000234e0: 4e6f 6e65 2c20 6e75 6d62 6572 5f6f 665f  None, number_of_
+000234f0: 6672 6571 7565 6e63 6965 733d 4e6f 6e65  frequencies=None
+00023500: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
+00023510: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00023520: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+00023530: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7320  =None, **kwargs 
+00023540: 2029 3a0d 0a20 2020 2020 2020 2022 2222   ):..        """
+00023550: 0d0a 2020 2020 2020 2020 4d65 7468 6f64  ..        Method
+00023560: 2074 6f20 7265 6164 2061 6e64 2061 7261   to read and ara
+00023570: 6e67 6520 6461 7461 2061 6363 6f72 6469  nge data accordi
+00023580: 6e67 2065 6163 680d 0a20 2020 2020 2020  ng each..       
+00023590: 2073 7461 7469 6f6e 202f 452d 7068 6173   station /E-phas
+000235a0: 6520 616e 676c 6573 200d 0a20 2020 2020  e angles ..     
+000235b0: 2020 2020 2020 2076 616c 7565 7320 2e0d         values ..
+000235c0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+000235d0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+000235e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000235f0: 2d0d 0a20 2020 2020 2020 2020 2020 202a  -..            *
+00023600: 2065 5f70 687a 5f61 7272 6179 203a 206e   e_phz_array : n
+00023610: 6461 7272 6179 2c20 656e 2072 6164 200d  darray, en rad .
+00023620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023630: 2020 2020 2020 2020 2020 2020 2045 2d46               E-F
+00023640: 6965 6c64 2070 6861 7365 206f 6273 6572  ield phase obser
+00023650: 7665 6420 2e20 5468 6520 6465 6661 756c  ved . The defaul
+00023660: 7420 6973 204e 6f6e 652e 0d0a 2020 2020  t is None...    
+00023670: 2020 2020 2020 2020 2a20 6e75 6d62 6572          * number
+00023680: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
+00023690: 3a20 696e 7420 2c20 6f70 7469 6f6e 616c  : int , optional
+000236a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000236b0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+000236c0: 6d62 6572 206f 6620 6672 6571 7565 6e63  mber of frequenc
+000236d0: 6965 7320 666f 7220 7375 7276 6579 2e20  ies for survey. 
+000236e0: 5468 6520 6465 6661 756c 7420 6973 204e  The default is N
+000236f0: 6f6e 652e 0d0a 2020 2020 2020 2020 2020  one...          
+00023700: 2020 2a20 6e75 6d62 6572 5f6f 665f 7374    * number_of_st
+00023710: 6174 696f 6e73 203a 2069 6e74 202c 206f  ations : int , o
+00023720: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+00023730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023740: 2020 2020 206e 756d 6265 725f 6f66 2073       number_of s
+00023750: 7461 7469 6f6e 732e 0d0a 2020 2020 2020  tations...      
+00023760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023770: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
+00023780: 7420 6973 204e 6f6e 652e 0d0a 2020 2020  t is None...    
+00023790: 2020 2020 2020 2020 2a20 746f 5f64 6567          * to_deg
+000237a0: 7265 6520 3a20 626f 6f6c 2c0d 0a20 2020  ree : bool,..   
+000237b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000237c0: 2020 2020 2020 2020 2063 6f6d 7075 7465           compute
+000237d0: 2061 6e67 6c65 2074 6f64 6567 7265 6520   angle todegree 
+000237e0: 2e20 0d0a 2020 2020 2020 2020 2222 220d  . ..        """.
+000237f0: 0a20 2020 2020 2020 2074 6f5f 6465 6772  .        to_degr
+00023800: 6565 203d 6b77 6172 6773 2e70 6f70 2822  ee =kwargs.pop("
+00023810: 746f 5f64 6567 7265 6522 2c20 4661 6c73  to_degree", Fals
+00023820: 6529 0d0a 2020 2020 2020 2020 6966 2074  e)..        if t
+00023830: 6f5f 6465 6772 6565 203a 0d0a 2020 2020  o_degree :..    
+00023840: 2020 2020 2020 2020 7365 6c66 2e74 6f5f          self.to_
+00023850: 6465 6772 6565 203d 2074 6f5f 6465 6772  degree = to_degr
+00023860: 6565 0d0a 2020 2020 2020 2020 0d0a 2020  ee..        ..  
+00023870: 2020 2020 2020 6966 2068 5f70 687a 5f61        if h_phz_a
+00023880: 7272 6179 2069 7320 6e6f 7420 4e6f 6e65  rray is not None
+00023890: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+000238a0: 2073 656c 662e 685f 7068 7a5f 6172 7261   self.h_phz_arra
+000238b0: 793d 685f 7068 7a5f 6172 7261 790d 0a20  y=h_phz_array.. 
+000238c0: 2020 2020 2020 2069 6620 7365 6c66 2e68         if self.h
+000238d0: 5f70 687a 5f61 7272 6179 2069 7320 4e6f  _phz_array is No
+000238e0: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
+000238f0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00023900: 6f72 2827 4e6f 2045 2d70 6861 7365 2064  or('No E-phase d
+00023910: 6174 6120 666f 756e 6420 2021 2729 0d0a  ata found  !')..
+00023920: 0d0a 2020 2020 2020 2020 6966 206e 756d  ..        if num
+00023930: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
+00023940: 6573 2069 7320 6e6f 7420 4e6f 6e65 203a  es is not None :
+00023950: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00023960: 6c66 2e6e 6672 6571 203d 6e75 6d62 6572  lf.nfreq =number
+00023970: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
+00023980: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+00023990: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+000239a0: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
+000239b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000239c0: 2250 6c65 6173 6520 7370 6563 6966 7920  "Please specify 
+000239d0: 7468 6520 6e75 6d62 6572 206f 6620 6672  the number of fr
+000239e0: 6571 7565 6e63 7920 2122 290d 0a20 2020  equency !")..   
+000239f0: 2020 2020 2069 6620 6e75 6d62 6572 5f6f       if number_o
+00023a00: 665f 7374 6174 696f 6e73 2069 7320 6e6f  f_stations is no
+00023a10: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
+00023a20: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
+00023a30: 725f 6f66 5f73 7461 7469 6f6e 7320 3d6e  r_of_stations =n
+00023a40: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+00023a50: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
+00023a60: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00023a70: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00023a80: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00023a90: 2020 2027 506c 6561 7365 2073 7065 6369     'Please speci
+00023aa0: 6679 2074 6865 206e 756d 6265 7220 6f66  fy the number of
+00023ab0: 2073 7461 7469 6f6e 7327 290d 0a20 2020   stations')..   
+00023ac0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00023ad0: 2020 2074 7279 203a 200d 0a20 2020 2020     try : ..     
+00023ae0: 2020 2020 2020 2073 656c 662e 6e66 7265         self.nfre
+00023af0: 713d 6e70 2e69 6e74 2873 656c 662e 6e66  q=np.int(self.nf
+00023b00: 7265 7129 0d0a 2020 2020 2020 2020 2020  req)..          
+00023b10: 2020 7365 6c66 2e6e 756d 6265 725f 6f66    self.number_of
+00023b20: 5f73 7461 7469 6f6e 7320 3d6e 702e 696e  _stations =np.in
+00023b30: 7428 7365 6c66 2e6e 756d 6265 725f 6f66  t(self.number_of
+00023b40: 5f73 7461 7469 6f6e 7329 0d0a 2020 2020  _stations)..    
+00023b50: 2020 2020 2020 2020 7365 6c66 2e68 5f70          self.h_p
+00023b60: 687a 5f61 7272 6179 3d6e 702e 6172 7261  hz_array=np.arra
+00023b70: 7928 5b6e 702e 666c 6f61 7428 6363 2920  y([np.float(cc) 
+00023b80: 666f 7220 6363 2069 6e20 7365 6c66 2e68  for cc in self.h
+00023b90: 5f70 687a 5f61 7272 6179 5d29 0d0a 0d0a  _phz_array])....
+00023ba0: 2020 2020 2020 2020 6578 6365 7074 203a          except :
+00023bb0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+00023bc0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00023bd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00023be0: 2020 2256 616c 7565 7320 7072 6f76 6964    "Values provid
+00023bf0: 6564 2066 6f72 2074 6865 2045 2d70 6861  ed for the E-pha
+00023c00: 7365 2061 7265 2077 726f 6e67 2e22 0d0a  se are wrong."..
+00023c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c20: 2022 206d 7573 7420 6265 2066 6c6f 6174   " must be float
+00023c30: 206f 7220 696e 7465 6765 7220 2e22 290d   or integer .").
+00023c40: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00023c50: 2e74 6f5f 6465 6772 6565 203a 2023 2d2d  .to_degree : #--
+00023c60: 2d3e 2073 6574 2061 6e67 6c65 2074 6f20  -> set angle to 
+00023c70: 6465 6772 6565 202e 0d0a 2020 2020 2020  degree ...      
+00023c80: 2020 2020 2020 7365 6c66 2e68 5f70 687a        self.h_phz
+00023c90: 5f61 7272 6179 203d 6e70 2e61 7070 6c79  _array =np.apply
+00023ca0: 5f61 6c6f 6e67 5f61 7869 7320 280d 0a20  _along_axis (.. 
+00023cb0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00023cc0: 616d 6264 6120 6870 687a 3a20 6870 687a  ambda hphz: hphz
+00023cd0: 202a 2031 3830 2f6e 702e 7069 2c20 302c   * 180/np.pi, 0,
+00023ce0: 7365 6c66 2e68 5f70 687a 5f61 7272 6179  self.h_phz_array
+00023cf0: 2920 2020 2020 2020 200d 0a20 2020 2020  )        ..     
+00023d00: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00023d10: 200d 0a20 2020 2020 2020 2076 636f 756e   ..        vcoun
+00023d20: 7473 5f68 5f70 687a 2c20 7265 7065 6174  ts_h_phz, repeat
+00023d30: 5f68 7068 7a3d 6e70 2e75 6e69 7175 6520  _hphz=np.unique 
+00023d40: 280d 0a20 2020 2020 2020 2020 2020 2073  (..            s
+00023d50: 656c 662e 685f 7068 7a5f 6172 7261 792c  elf.h_phz_array,
+00023d60: 2072 6574 7572 6e5f 636f 756e 7473 3d54   return_counts=T
+00023d70: 7275 6529 0d0a 2020 2020 2020 2020 0d0a  rue)..        ..
+00023d80: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
+00023d90: 702e 616c 6c28 7265 7065 6174 5f68 7068  p.all(repeat_hph
+00023da0: 7a29 3a0d 0a20 2020 2020 2020 2020 2020  z):..           
+00023db0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00023dc0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00023dd0: 2020 2020 2756 616c 7565 7320 6f66 2042      'Values of B
+00023de0: 2d70 6861 7365 7320 7072 6f76 6964 6564  -phases provided
+00023df0: 206d 7573 7420 6861 7665 2074 6865 2073   must have the s
+00023e00: 616d 6520 6c65 6e67 7468 270d 0a20 2020  ame length'..   
+00023e10: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
+00023e20: 666f 7220 6561 6368 2073 7461 7469 6f6e  for each station
+00023e30: 732e 2027 290d 0a20 2020 2020 2020 2073  s. ')..        s
+00023e40: 656c 662e 7661 6c75 6520 3d76 636f 756e  elf.value =vcoun
+00023e50: 7473 5f68 5f70 687a 0d0a 2020 2020 2020  ts_h_phz..      
+00023e60: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+00023e70: 2e6d 6178 2c20 7365 6c66 2e6d 696e 203d  .max, self.min =
+00023e80: 7663 6f75 6e74 735f 685f 7068 7a2e 6d61  vcounts_h_phz.ma
+00023e90: 7828 292c 2076 636f 756e 7473 5f68 5f70  x(), vcounts_h_p
+00023ea0: 687a 2e6d 696e 2829 0d0a 2020 2020 2020  hz.min()..      
+00023eb0: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+00023ec0: 2020 2020 2020 7472 756e 6361 7465 645f        truncated_
+00023ed0: 685f 7068 7a3d 5a63 632e 7472 756e 6361  h_phz=Zcc.trunca
+00023ee0: 7465 645f 6461 7461 2820 6461 7461 203d  ted_data( data =
+00023ef0: 7365 6c66 2e68 5f70 687a 5f61 7272 6179  self.h_phz_array
+00023f00: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00023f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f20: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+00023f30: 725f 6f66 5f72 6563 6375 7265 6e63 653d  r_of_reccurence=
+00023f40: 7365 6c66 2e6e 6672 6571 290d 0a20 2020  self.nfreq)..   
+00023f50: 2020 2020 206e 616d 652c 2070 6f6c 796e       name, polyn
+00023f60: 616d 6520 3d20 5a63 632e 5f6e 756d 6265  ame = Zcc._numbe
+00023f70: 7269 6e67 5f73 7461 7469 6f6e 280d 0a20  ring_station(.. 
+00023f80: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+00023f90: 725f 6f66 5f73 7461 7469 6f6e 3d73 656c  r_of_station=sel
+00023fa0: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
+00023fb0: 696f 6e73 2c20 0d0a 2020 2020 2020 2020  ions, ..        
+00023fc0: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
+00023fd0: 5f66 7265 7120 3d73 656c 662e 6e66 7265  _freq =self.nfre
+00023fe0: 7129 0d0a 2020 2020 2020 2020 0d0a 2020  q)..        ..  
+00023ff0: 2020 2020 2020 7365 6c66 2e6c 6f63 203d        self.loc =
+00024000: 7b20 6b65 793a 7661 6c75 6520 666f 7220  { key:value for 
+00024010: 6b65 792c 2076 616c 7565 2069 6e20 7a69  key, value in zi
+00024020: 7028 6e61 6d65 2c20 7472 756e 6361 7465  p(name, truncate
+00024030: 645f 685f 7068 7a20 297d 0d0a 2020 2020  d_h_phz )}..    
+00024040: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
+00024050: 2020 2020 2020 2020 0d0a 636c 6173 7320          ..class 
+00024060: 5265 7369 7374 6976 6974 7920 286f 626a  Resistivity (obj
+00024070: 6563 7429 3a0d 0a20 2020 2022 2222 0d0a  ect):..    """..
+00024080: 2020 2020 6261 7365 6420 6f6e 2043 6167      based on Cag
+00024090: 6e69 6172 6420 5265 7369 7374 6976 6974  niard Resistivit
+000240a0: 7920 284f 686d 2d4d 6574 6572 7329 2063  y (Ohm-Meters) c
+000240b0: 616c 6375 6c61 7469 6f6e 200d 0a20 2020  alculation ..   
+000240c0: 200d 0a20 2020 2020 2e2e 2073 6565 2061   ..     .. see a
+000240d0: 6c73 6f3a 3a43 6167 6e69 6172 642c 204c  lso::Cagniard, L
+000240e0: 2e2c 2031 3935 332c 2042 6173 6963 2074  ., 1953, Basic t
+000240f0: 6865 6f72 7920 6f66 2074 6865 206d 6167  heory of the mag
+00024100: 6e65 746f 7465 6c6c 7572 6963 0d0a 2020  netotelluric..  
+00024110: 2020 2020 2020 2020 6d65 7468 6f64 206f          method o
+00024120: 6620 2067 656f 7068 7973 6963 616c 2070  f  geophysical p
+00024130: 726f 7370 6563 7469 6e67 3a20 4765 6f70  rospecting: Geop
+00024140: 6879 7369 6373 2c20 3138 2c20 3630 35e2  hysics, 18, 605.
+00024150: 8093 3633 352c 0d0a 2020 2020 2020 2020  ..635,..        
+00024160: 2020 2a64 6f69 2a3a 2031 302e 3131 3930    *doi*: 10.1190
+00024170: 2f31 2e31 3433 3739 3135 2e20 0d0a 2020  /1.1437915. ..  
+00024180: 2020 0d0a 2020 2020 4172 6775 6d65 6e74    ..    Argument
+00024190: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
+000241a0: 2d2d 0d0a 2020 2020 2020 2020 2a2a 7265  --..        **re
+000241b0: 735f 6172 7261 792a 2a20 203a 2073 7472  s_array**  : str
+000241c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000241d0: 2020 2020 2020 2020 6461 7461 2061 7272          data arr
+000241e0: 6179 206f 6620 6170 7061 7265 6e74 7320  ay of apparents 
+000241f0: 7265 7369 7374 6976 7920 6361 6c63 756c  resistivy calcul
+00024200: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
+00024210: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00024220: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00024230: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d    ===========  =
+00024240: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00024250: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00024260: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+00024270: 2041 7474 7269 6275 7465 7320 2020 2020   Attributes     
+00024280: 2020 2020 5479 7065 2020 2020 2020 2020      Type        
+00024290: 4578 706c 616e 6174 696f 6e0d 0a20 2020  Explanation..   
+000242a0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+000242b0: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  =  ===========  
+000242c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000242d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000242e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+000242f0: 2020 7661 6c75 6520 2020 2020 2020 2020    value         
+00024300: 2020 2020 6e64 2e61 7272 6179 2020 2020      nd.array    
+00024310: 2020 6461 7461 206f 6620 7265 7369 7374    data of resist
+00024320: 6976 6974 7920 636f 6c75 6d6e 202d 206f  ivity column - o
+00024330: 686d 2e6d 200d 0a20 2020 206d 6178 2020  hm.m ..    max  
+00024340: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
+00024350: 6174 2020 2020 2020 2020 2068 6967 6865  at         highe
+00024360: 7220 7661 6c75 6520 6f66 2052 6573 6973  r value of Resis
+00024370: 7469 7669 7479 200d 0a20 2020 206d 696e  tivity ..    min
+00024380: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00024390: 6c6f 6174 2020 2020 2020 2020 206d 696e  loat         min
+000243a0: 696d 756d 2076 616c 7565 206f 6620 7265  imum value of re
+000243b0: 7369 7469 7669 7479 206f 6e20 7468 6520  sitivity on the 
+000243c0: 6172 6561 0d0a 2020 2020 6d65 616e 2020  area..    mean  
+000243d0: 2020 2020 2020 2020 2020 2020 666c 6f61              floa
+000243e0: 7420 2020 2020 2020 2020 6576 6572 6167  t         everag
+000243f0: 6520 7661 6c75 6520 6f66 2074 6865 2072  e value of the r
+00024400: 686f 200d 0a20 2020 206c 6f63 2020 2020  ho ..    loc    
+00024410: 2020 2020 2020 2020 2020 2064 6963 7420             dict 
+00024420: 2020 2020 2020 2020 206c 6f63 6174 696f           locatio
+00024430: 6e20 6f66 2072 686f 2020 7661 6c75 6520  n of rho  value 
+00024440: 6174 2074 6865 2073 7461 7469 6f6e 206c  at the station l
+00024450: 616d 6264 6120 0d0a 2020 2020 2020 2020  ambda ..        
+00024460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024470: 2020 2020 2020 2020 2020 2020 652e 6720              e.g 
+00024480: 2d20 6c6f 635b 2753 3133 5d20 7368 6f77  - loc['S13] show
+00024490: 2074 6865 2063 7572 7265 6e74 2020 7268   the current  rh
+000244a0: 6f20 6461 7461 200d 0a20 2020 2020 2020  o data ..       
+000244b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000244c0: 2020 2020 2020 2020 2020 2020 2061 7420               at 
+000244d0: 7468 6520 7374 6174 696f 6e20 5331 330d  the station S13.
+000244e0: 0a20 2020 2053 7265 7320 2020 2020 2020  .    Sres       
+000244f0: 2020 2020 2020 206e 6461 7272 6179 2020         ndarray  
+00024500: 2020 2020 2041 7374 6174 6963 2076 616c       Astatic val
+00024510: 7565 2063 6f72 7265 6374 6564 0d0a 2020  ue corrected..  
+00024520: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+00024530: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  ==  =========== 
+00024540: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00024550: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00024560: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d  =============...
+00024570: 0a20 2020 204d 6f72 6520 6174 7472 6962  .    More attrib
+00024580: 7574 6573 2063 616e 2062 6520 6164 6465  utes can be adde
+00024590: 6420 6279 2069 6e70 7574 696e 6720 6120  d by inputing a 
+000245a0: 6b65 7920 776f 7264 2064 6963 7469 6f6e  key word diction
+000245b0: 6172 790d 0a20 2020 200d 0a20 2020 203a  ary..    ..    :
+000245c0: 4578 616d 706c 653a 2020 0d0a 2020 2020  Example:  ..    
+000245d0: 2020 2020 200d 0a20 2020 2020 2020 203e       ..        >
+000245e0: 3e3e 2066 726f 6d20 6373 616d 6d74 7079  >> from csammtpy
+000245f0: 2e63 6f72 652e 6176 6720 696d 706f 7274  .core.avg import
+00024600: 2041 7667 200d 0a20 2020 2020 2020 203e   Avg ..        >
+00024610: 3e3e 2070 6174 683d 6f73 2e70 6174 682e  >> path=os.path.
+00024620: 6a6f 696e 286f 732e 656e 7669 726f 6e5b  join(os.environ[
+00024630: 2270 7943 5341 4d54 225d 2c20 0d0a 2020  "pyCSAMT"], ..  
+00024640: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00024650: 2020 2020 2020 2020 2020 2027 7079 6373             'pycs
+00024660: 616d 7427 2c20 2264 6174 6122 2c20 224b  amt', "data", "K
+00024670: 312e 4156 4722 290d 0a20 2020 2020 2020  1.AVG")..       
+00024680: 203e 3e3e 2061 7667 5f6f 626a 3d41 7667   >>> avg_obj=Avg
+00024690: 2870 6174 6829 0d0a 2020 2020 2020 2020  (path)..        
+000246a0: 3e3e 3e20 7268 6f5f 6f62 6a20 3d61 7667  >>> rho_obj =avg
+000246b0: 5f6f 626a 2e44 6174 615f 7365 6374 696f  _obj.Data_sectio
+000246c0: 6e2e 5265 7369 7374 6976 6974 792e 6c6f  n.Resistivity.lo
+000246d0: 635b 2753 3030 275d 0d0a 2020 2020 2020  c['S00']..      
+000246e0: 2020 3e3e 3e20 7072 696e 7428 7268 6f2e    >>> print(rho.
+000246f0: 6c6f 635b 2753 3030 275d 290d 0a20 2020  loc['S00'])..   
+00024700: 2022 2222 0d0a 2020 2020 0d0a 2020 2020   """..    ..    
+00024710: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00024720: 662c 2072 6573 5f61 7272 6179 203d 4e6f  f, res_array =No
+00024730: 6e65 202c 206e 756d 6265 725f 6f66 5f66  ne , number_of_f
+00024740: 7265 7175 656e 6369 6573 3d4e 6f6e 6520  requencies=None 
+00024750: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00024760: 2020 2020 206e 756d 6265 725f 6f66 5f73       number_of_s
+00024770: 7461 7469 6f6e 733d 4e6f 6e65 202c 202a  tations=None , *
+00024780: 2a6b 7761 7267 7329 3a0d 0a0d 0a20 2020  *kwargs):....   
+00024790: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+000247a0: 656c 662e 7265 735f 6172 7261 793d 7265  elf.res_array=re
+000247b0: 735f 6172 7261 7920 0d0a 2020 2020 2020  s_array ..      
+000247c0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+000247d0: 2e53 7265 733d 4e6f 6e65 200d 0a20 2020  .Sres=None ..   
+000247e0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+000247f0: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
+00024800: 6174 696f 6e73 203d 6b77 6172 6773 2e70  ations =kwargs.p
+00024810: 6f70 2822 6e75 6d62 6572 5f6f 665f 7374  op("number_of_st
+00024820: 6174 696f 6e73 222c 204e 6f6e 6529 0d0a  ations", None)..
+00024830: 2020 2020 2020 2020 7365 6c66 2e6e 6672          self.nfr
+00024840: 6571 203d 6b77 6172 6773 2e70 6f70 2827  eq =kwargs.pop('
+00024850: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+00024860: 6e63 6965 7327 2c20 4e6f 6e65 290d 0a20  ncies', None).. 
+00024870: 2020 2020 2020 2073 656c 662e 5372 6573         self.Sres
+00024880: 203d 6b77 6172 6773 2e70 6f70 2827 6164   =kwargs.pop('ad
+00024890: 6465 645f 6173 7461 7469 635f 7268 6f5f  ded_astatic_rho_
+000248a0: 6172 7261 7927 2c20 4e6f 6e65 290d 0a20  array', None).. 
+000248b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000248c0: 2073 656c 662e 7661 6c75 6520 3d4e 6f6e   self.value =Non
+000248d0: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
+000248e0: 2e6d 696e 203d 204e 6f6e 6520 0d0a 2020  .min = None ..  
+000248f0: 2020 2020 2020 7365 6c66 2e6d 6178 203d        self.max =
+00024900: 204e 6f6e 6520 0d0a 2020 2020 2020 2020   None ..        
+00024910: 7365 6c66 2e6c 6f63 203d 204e 6f6e 6520  self.loc = None 
+00024920: 0d0a 2020 2020 2020 2020 666f 7220 6b65  ..        for ke
+00024930: 7920 696e 206c 6973 7428 6b77 6172 6773  y in list(kwargs
+00024940: 2e6b 6579 7328 2929 3a0d 0a20 2020 2020  .keys()):..     
+00024950: 2020 2020 2020 2073 6574 6174 7472 2873         setattr(s
+00024960: 656c 662c 206b 6579 2c20 6b77 6172 6773  elf, key, kwargs
+00024970: 5b6b 6579 5d29 0d0a 2020 2020 2020 2020  [key])..        
+00024980: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+00024990: 2073 656c 662e 7265 735f 6172 7261 7920   self.res_array 
+000249a0: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
+000249b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000249c0: 2e5f 7265 6164 5f72 6573 5f64 6174 6120  ._read_res_data 
+000249d0: 2829 0d0a 2020 2020 2020 2020 0d0a 2020  ()..        ..  
+000249e0: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
+000249f0: 5f72 6561 645f 7265 735f 6461 7461 2028  _read_res_data (
+00024a00: 7365 6c66 2c72 6573 5f61 7272 6179 203d  self,res_array =
+00024a10: 4e6f 6e65 2c20 6e75 6d62 6572 5f6f 665f  None, number_of_
+00024a20: 6672 6571 7565 6e63 6965 733d 4e6f 6e65  frequencies=None
+00024a30: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
+00024a40: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00024a50: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+00024a60: 3d4e 6f6e 652c 2053 7265 733d 4e6f 6e65  =None, Sres=None
+00024a70: 2c20 202a 2a6b 7761 7267 7320 2029 3a0d  ,  **kwargs  ):.
+00024a80: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00024a90: 2020 2020 2020 4d65 7468 6f64 2074 6f20        Method to 
+00024aa0: 7265 6164 2072 6573 6974 6976 6974 7920  read resitivity 
+00024ab0: 2061 6363 6f72 6469 6e67 2065 6163 6820   according each 
+00024ac0: 7374 6174 696f 6e20 2f52 6573 6973 7469  station /Resisti
+00024ad0: 7669 7479 2061 6e67 6c65 7320 0d0a 2020  vity angles ..  
+00024ae0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+00024af0: 202e 0d0a 2020 2020 2020 2020 0d0a 2020   ...        ..  
+00024b00: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00024b10: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00024b20: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2020  ----..          
+00024b30: 2020 2a20 7265 735f 6172 7261 7920 3a20    * res_array : 
+00024b40: 6172 7261 795f 6c69 6b65 200d 0a20 2020  array_like ..   
+00024b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b60: 2020 2020 2020 5265 7369 7374 6976 6974        Resistivit
+00024b70: 7920 6361 6c63 756c 6174 6564 2020 6f6e  y calculated  on
+00024b80: 2074 6865 2066 6965 6c64 2e20 0d0a 2020   the field. ..  
+00024b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ba0: 2020 2020 2020 2054 6865 202a 6465 6661         The *defa
+00024bb0: 756c 742a 2069 7320 4e6f 6e65 2e0d 0a20  ult* is None... 
+00024bc0: 2020 2020 2020 2020 2020 202a 206e 756d             * num
+00024bd0: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
+00024be0: 6573 203a 2069 6e74 202c 206f 7074 696f  es : int , optio
+00024bf0: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+00024c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c10: 206e 756d 6265 7220 6f66 2066 7265 7175   number of frequ
+00024c20: 656e 6369 6573 2066 6f72 2073 7572 7665  encies for surve
+00024c30: 792e 200d 0a20 2020 2020 2020 2020 2020  y. ..           
+00024c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c50: 2054 6865 202a 6465 6661 756c 742a 2069   The *default* i
+00024c60: 7320 4e6f 6e65 2e0d 0a20 2020 2020 2020  s None...       
+00024c70: 2020 2020 202a 206e 756d 6265 725f 6f66       * number_of
+00024c80: 5f73 7461 7469 6f6e 7320 3a20 696e 7420  _stations : int 
+00024c90: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00024ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024cb0: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+00024cc0: 6620 7374 6174 696f 6e73 2e20 0d0a 2020  f stations. ..  
+00024cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ce0: 2020 2020 2020 2020 2020 5468 6520 2a64            The *d
+00024cf0: 6566 6175 6c74 2a20 6973 204e 6f6e 652e  efault* is None.
+00024d00: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+00024d10: 5372 6573 203a 206e 6461 7272 6179 2c20  Sres : ndarray, 
+00024d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00024d30: 2020 2020 2020 2020 2020 5a6f 6e67 6520            Zonge 
+00024d40: 4173 7461 7469 6320 7268 6f20 6361 6c63  Astatic rho calc
+00024d50: 756c 6174 6564 2e0d 0a20 2020 2020 2020  ulated...       
+00024d60: 2022 2222 0d0a 2020 2020 2020 2020 0d0a   """..        ..
+00024d70: 2020 2020 2020 2020 6966 2072 6573 5f61          if res_a
+00024d80: 7272 6179 2020 6973 206e 6f74 204e 6f6e  rray  is not Non
+00024d90: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+00024da0: 2020 7365 6c66 2e72 6573 5f61 7272 6179    self.res_array
+00024db0: 3d20 7265 735f 6172 7261 790d 0a20 2020  = res_array..   
+00024dc0: 2020 2020 2069 6620 7365 6c66 2e72 6573       if self.res
+00024dd0: 5f61 7272 6179 2069 7320 4e6f 6e65 203a  _array is None :
+00024de0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+00024df0: 6169 7365 2054 7970 6545 7272 6f72 2827  aise TypeError('
+00024e00: 4e6f 2052 6573 6973 7469 7669 7479 2064  No Resistivity d
+00024e10: 6174 6120 666f 756e 6420 2127 290d 0a0d  ata found !')...
+00024e20: 0a20 2020 2020 2020 2069 6620 6e75 6d62  .        if numb
+00024e30: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00024e40: 7320 6973 206e 6f74 204e 6f6e 6520 3a20  s is not None : 
+00024e50: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00024e60: 6c66 2e6e 6672 6571 203d 6e75 6d62 6572  lf.nfreq =number
+00024e70: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
+00024e80: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+00024e90: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00024ea0: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
+00024eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ec0: 2250 6c65 6173 6520 7370 6563 6966 7920  "Please specify 
+00024ed0: 7468 6520 6e75 6d62 6572 206f 6620 6672  the number of fr
+00024ee0: 6571 7565 6e63 7920 2122 290d 0a20 2020  equency !")..   
+00024ef0: 2020 2020 2069 6620 6e75 6d62 6572 5f6f       if number_o
+00024f00: 665f 7374 6174 696f 6e73 2069 7320 6e6f  f_stations is no
+00024f10: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
+00024f20: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+00024f30: 6572 5f6f 665f 7374 6174 696f 6e73 203d  er_of_stations =
+00024f40: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+00024f50: 6e73 200d 0a20 2020 2020 2020 2065 6c73  ns ..        els
+00024f60: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+00024f70: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00024f80: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00024f90: 2020 2020 2750 6c65 6173 6520 7370 6563      'Please spec
+00024fa0: 6966 7920 7468 6520 6e75 6d62 6572 206f  ify the number o
+00024fb0: 6620 7374 6174 696f 6e73 2729 0d0a 2020  f stations')..  
+00024fc0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00024fd0: 6966 2053 7265 7320 6973 206e 6f74 204e  if Sres is not N
+00024fe0: 6f6e 6520 3a0d 0a0d 0a20 2020 2020 2020  one :....       
+00024ff0: 2020 2020 2073 656c 662e 5372 6573 203d       self.Sres =
+00025000: 206e 702e 6172 7261 7928 5b6e 702e 666c   np.array([np.fl
+00025010: 6f61 7428 7265 7329 2066 6f72 2072 6573  oat(res) for res
+00025020: 2069 6e20 5372 6573 5d29 0d0a 2020 2020   in Sres])..    
+00025030: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00025040: 7265 735f 6172 7261 792e 7368 6170 655b  res_array.shape[
+00025050: 305d 2021 3d20 7365 6c66 2e53 7265 732e  0] != self.Sres.
+00025060: 7369 7a65 203a 200d 0a20 2020 2020 2020  size : ..       
+00025070: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
+00025080: 6573 6973 7469 7669 7479 4572 726f 7228  esistivityError(
+00025090: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000250a0: 2020 2020 2020 2752 6573 6973 7469 7669        'Resistivi
+000250b0: 7479 2063 616c 6375 6c61 7465 6420 2620  ty calculated & 
+000250c0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+000250d0: 2020 2020 2020 2020 2741 7374 6174 6963          'Astatic
+000250e0: 5f61 7272 6179 206d 7573 7420 6765 7420  _array must get 
+000250f0: 7468 6520 7361 6d65 206c 656e 6774 6821  the same length!
+00025100: 2e27 290d 0a20 2020 2020 2020 2074 7279  .')..        try
+00025110: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00025120: 2073 656c 662e 6e66 7265 713d 6e70 2e69   self.nfreq=np.i
+00025130: 6e74 2873 656c 662e 6e66 7265 7129 0d0a  nt(self.nfreq)..
+00025140: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00025150: 2e6e 756d 6265 725f 6f66 5f73 7461 7469  .number_of_stati
+00025160: 6f6e 7320 3d6e 702e 696e 7428 7365 6c66  ons =np.int(self
+00025170: 2e6e 756d 6265 725f 6f66 5f73 7461 7469  .number_of_stati
+00025180: 6f6e 7329 0d0a 2020 2020 2020 2020 2020  ons)..          
+00025190: 2020 7365 6c66 2e72 6573 5f61 7272 6179    self.res_array
+000251a0: 203d 6e70 2e61 7272 6179 285b 6e70 2e66   =np.array([np.f
+000251b0: 6c6f 6174 2863 6329 2066 6f72 2063 6320  loat(cc) for cc 
+000251c0: 696e 2073 656c 662e 7265 735f 6172 7261  in self.res_arra
+000251d0: 795d 290d 0a0d 0a20 2020 2020 2020 2065  y])....        e
+000251e0: 7863 6570 7420 3a0d 0a20 2020 2020 2020  xcept :..       
+000251f0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00025200: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00025210: 2020 2020 2020 2020 2256 616c 7565 7320          "Values 
+00025220: 7072 6f76 6964 6564 2066 6f72 2074 6865  provided for the
+00025230: 2052 6573 6973 7469 7669 7469 6573 2061   Resistivities a
+00025240: 7265 2077 726f 6e67 2e22 0d0a 2020 2020  re wrong."..    
+00025250: 2020 2020 2020 2020 2020 2020 2022 206d               " m
+00025260: 7573 7420 6265 2066 6c6f 6174 206f 7220  ust be float or 
+00025270: 696e 7465 6765 7220 2e22 290d 0a20 2020  integer .")..   
+00025280: 2020 2020 200d 0a20 2020 2020 2020 2076       ..        v
+00025290: 636f 756e 7473 5f72 6573 2c20 7265 7065  counts_res, repe
+000252a0: 6174 5f68 7068 7a3d 6e70 2e75 6e69 7175  at_hphz=np.uniqu
+000252b0: 6520 2873 656c 662e 7265 735f 6172 7261  e (self.res_arra
+000252c0: 792c 0d0a 2020 2020 2020 2020 2020 2020  y,..            
+000252d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252f0: 7265 7475 726e 5f63 6f75 6e74 733d 5472  return_counts=Tr
+00025300: 7565 290d 0a20 2020 2020 2020 2069 6620  ue)..        if 
+00025310: 6e6f 7420 6e70 2e61 6c6c 2872 6570 6561  not np.all(repea
+00025320: 745f 6870 687a 293a 200d 0a20 2020 2020  t_hphz): ..     
+00025330: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00025340: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
+00025350: 2020 2020 2020 2020 2020 2756 616c 7565            'Value
+00025360: 7320 6f66 2052 686f 2070 726f 7669 6465  s of Rho provide
+00025370: 6420 6d75 7374 2068 6176 6520 7468 6520  d must have the 
+00025380: 7361 6d65 206c 656e 6774 6827 5c0d 0a20  same length'\.. 
+00025390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000253a0: 2720 666f 7220 6561 6368 2073 7461 7469  ' for each stati
+000253b0: 6f6e 732e 2729 0d0a 2020 2020 2020 2020  ons.')..        
+000253c0: 7365 6c66 2e76 616c 7565 203d 7663 6f75  self.value =vcou
+000253d0: 6e74 735f 7265 730d 0a20 2020 2020 2020  nts_res..       
+000253e0: 2073 656c 662e 6d61 782c 2073 656c 662e   self.max, self.
+000253f0: 6d69 6e20 3d76 636f 756e 7473 5f72 6573  min =vcounts_res
+00025400: 2e6d 6178 2829 2c20 7663 6f75 6e74 735f  .max(), vcounts_
+00025410: 7265 732e 6d69 6e28 290d 0a20 2020 2020  res.min()..     
+00025420: 2020 2073 656c 662e 6d65 616e 3d73 656c     self.mean=sel
+00025430: 662e 7265 735f 6172 7261 792e 6d65 616e  f.res_array.mean
+00025440: 2829 0d0a 2020 2020 2020 2020 7472 756e  ()..        trun
+00025450: 6361 7465 645f 7265 733d 5a63 632e 7472  cated_res=Zcc.tr
+00025460: 756e 6361 7465 645f 6461 7461 2820 6461  uncated_data( da
+00025470: 7461 203d 7365 6c66 2e72 6573 5f61 7272  ta =self.res_arr
+00025480: 6179 2c20 0d0a 2020 2020 2020 2020 2020  ay, ..          
+00025490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000254a0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+000254b0: 6265 725f 6f66 5f72 6563 6375 7265 6e63  ber_of_reccurenc
+000254c0: 653d 7365 6c66 2e6e 6672 6571 290d 0a20  e=self.nfreq).. 
+000254d0: 2020 2020 2020 206e 616d 652c 2070 6f6c         name, pol
+000254e0: 796e 616d 6520 3d20 5a63 632e 5f6e 756d  yname = Zcc._num
+000254f0: 6265 7269 6e67 5f73 7461 7469 6f6e 280d  bering_station(.
+00025500: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+00025510: 6265 725f 6f66 5f73 7461 7469 6f6e 3d73  ber_of_station=s
+00025520: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
+00025530: 6174 696f 6e73 2c20 0d0a 2020 2020 2020  ations, ..      
+00025540: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+00025550: 665f 6672 6571 203d 7365 6c66 2e6e 6672  f_freq =self.nfr
+00025560: 6571 290d 0a20 2020 2020 2020 200d 0a20  eq)..        .. 
+00025570: 2020 2020 2020 2073 656c 662e 6c6f 6320         self.loc 
+00025580: 3d7b 206b 6579 3a76 616c 7565 2066 6f72  ={ key:value for
+00025590: 206b 6579 2c20 7661 6c75 6520 696e 207a   key, value in z
+000255a0: 6970 286e 616d 652c 2074 7275 6e63 6174  ip(name, truncat
+000255b0: 6564 5f72 6573 2029 7d0d 0a20 2020 2020  ed_res )}..     
+000255c0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+000255d0: 7365 6c66 2e53 7265 7320 6973 206e 6f74  self.Sres is not
+000255e0: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
+000255f0: 2020 2020 2020 7663 6f75 6e74 735f 7372        vcounts_sr
+00025600: 6573 2c20 7265 7065 6174 5f68 7068 7a3d  es, repeat_hphz=
+00025610: 6e70 2e75 6e69 7175 6520 2873 656c 662e  np.unique (self.
+00025620: 5372 6573 2c20 7265 7475 726e 5f63 6f75  Sres, return_cou
+00025630: 6e74 733d 5472 7565 290d 0a20 2020 2020  nts=True)..     
+00025640: 2020 2020 2020 2073 656c 662e 7653 7265         self.vSre
+00025650: 7320 2c20 7365 6c66 2e6d 6561 6e5f 5372  s , self.mean_Sr
+00025660: 6573 203d 2076 636f 756e 7473 5f73 7265  es = vcounts_sre
+00025670: 732c 2073 656c 662e 5372 6573 2e6d 6561  s, self.Sres.mea
+00025680: 6e28 290d 0a20 2020 2020 2020 2020 2020  n()..           
+00025690: 2073 656c 662e 6d61 783d 2876 636f 756e   self.max=(vcoun
+000256a0: 7473 5f72 6573 2e6d 6178 2829 2c76 636f  ts_res.max(),vco
+000256b0: 756e 7473 5f73 7265 732e 6d61 7828 2929  unts_sres.max())
+000256c0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000256d0: 6c66 2e6d 696e 203d 2028 7663 6f75 6e74  lf.min = (vcount
+000256e0: 735f 7265 732e 6d69 6e28 292c 7663 6f75  s_res.min(),vcou
+000256f0: 6e74 735f 7372 6573 2e6d 696e 2829 290d  nts_sres.min()).
+00025700: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00025710: 662e 6d65 616e 203d 2873 656c 662e 6d65  f.mean =(self.me
+00025720: 616e 2c20 7365 6c66 2e6d 6561 6e5f 5372  an, self.mean_Sr
+00025730: 6573 290d 0a20 2020 2020 2020 2020 2020  es)..           
+00025740: 2074 7275 6e63 6174 6564 5f73 7265 733d   truncated_sres=
+00025750: 5a63 632e 7472 756e 6361 7465 645f 6461  Zcc.truncated_da
+00025760: 7461 2820 6461 7461 203d 7365 6c66 2e53  ta( data =self.S
+00025770: 7265 732c 200d 0a20 2020 2020 2020 2020  res, ..         
+00025780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025790: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+000257a0: 6d62 6572 5f6f 665f 7265 6363 7572 656e  mber_of_reccuren
+000257b0: 6365 3d73 656c 662e 6e66 7265 7129 0d0a  ce=self.nfreq)..
+000257c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000257d0: 2e6c 6f63 5f53 7265 7320 3d7b 206b 6579  .loc_Sres ={ key
+000257e0: 3a76 616c 7565 2066 6f72 206b 6579 2c20  :value for key, 
+000257f0: 7661 6c75 6520 696e 207a 6970 286e 616d  value in zip(nam
+00025800: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
+00025810: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00025820: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00025830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025840: 2020 2020 7265 7475 726e 5f63 6f75 6e74      return_count
-00025850: 733d 5472 7565 290d 0a20 2020 2020 2020  s=True)..       
-00025860: 2069 6620 6e6f 7420 6e70 2e61 6c6c 2872   if not np.all(r
-00025870: 6570 6561 745f 6870 687a 293a 200d 0a20  epeat_hphz): .. 
-00025880: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00025890: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-000258a0: 6f72 5f76 616c 7565 280d 0a20 2020 2020  or_value(..     
-000258b0: 2020 2020 2020 2020 2020 2027 5661 6c75             'Valu
-000258c0: 6573 206f 6620 5268 6f20 7072 6f76 6964  es of Rho provid
-000258d0: 6564 206d 7573 7420 6861 7665 2074 6865  ed must have the
-000258e0: 2073 616d 6520 6c65 6e67 7468 275c 0d0a   same length'\..
-000258f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025900: 2027 2066 6f72 2065 6163 6820 7374 6174   ' for each stat
-00025910: 696f 6e73 2e27 290d 0a20 2020 2020 2020  ions.')..       
-00025920: 2073 656c 662e 7661 6c75 6520 3d76 636f   self.value =vco
-00025930: 756e 7473 5f72 6573 0d0a 2020 2020 2020  unts_res..      
-00025940: 2020 7365 6c66 2e6d 6178 2c20 7365 6c66    self.max, self
-00025950: 2e6d 696e 203d 7663 6f75 6e74 735f 7265  .min =vcounts_re
-00025960: 732e 6d61 7828 292c 2076 636f 756e 7473  s.max(), vcounts
-00025970: 5f72 6573 2e6d 696e 2829 0d0a 2020 2020  _res.min()..    
-00025980: 2020 2020 7365 6c66 2e6d 6561 6e3d 7365      self.mean=se
-00025990: 6c66 2e72 6573 5f61 7272 6179 2e6d 6561  lf.res_array.mea
-000259a0: 6e28 290d 0a20 2020 2020 2020 2074 7275  n()..        tru
-000259b0: 6e63 6174 6564 5f72 6573 3d5a 6363 2e74  ncated_res=Zcc.t
-000259c0: 7275 6e63 6174 6564 5f64 6174 6128 2064  runcated_data( d
-000259d0: 6174 6120 3d73 656c 662e 7265 735f 6172  ata =self.res_ar
-000259e0: 7261 792c 200d 0a20 2020 2020 2020 2020  ray, ..         
-000259f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025a00: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00025a10: 6d62 6572 5f6f 665f 7265 6363 7572 656e  mber_of_reccuren
-00025a20: 6365 3d73 656c 662e 6e66 7265 7129 0d0a  ce=self.nfreq)..
-00025a30: 2020 2020 2020 2020 6e61 6d65 2c20 706f          name, po
-00025a40: 6c79 6e61 6d65 203d 205a 6363 2e5f 6e75  lyname = Zcc._nu
-00025a50: 6d62 6572 696e 675f 7374 6174 696f 6e28  mbering_station(
-00025a60: 0d0a 2020 2020 2020 2020 2020 2020 6e75  ..            nu
-00025a70: 6d62 6572 5f6f 665f 7374 6174 696f 6e3d  mber_of_station=
-00025a80: 7365 6c66 2e6e 756d 6265 725f 6f66 5f73  self.number_of_s
-00025a90: 7461 7469 6f6e 732c 200d 0a20 2020 2020  tations, ..     
-00025aa0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-00025ab0: 6f66 5f66 7265 7120 3d73 656c 662e 6e66  of_freq =self.nf
-00025ac0: 7265 7129 0d0a 2020 2020 2020 2020 0d0a  req)..        ..
-00025ad0: 2020 2020 2020 2020 7365 6c66 2e6c 6f63          self.loc
-00025ae0: 203d 7b20 6b65 793a 7661 6c75 6520 666f   ={ key:value fo
-00025af0: 7220 6b65 792c 2076 616c 7565 2069 6e20  r key, value in 
-00025b00: 7a69 7028 6e61 6d65 2c20 7472 756e 6361  zip(name, trunca
-00025b10: 7465 645f 7265 7320 297d 0d0a 2020 2020  ted_res )}..    
-00025b20: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-00025b30: 2073 656c 662e 5372 6573 2069 7320 6e6f   self.Sres is no
-00025b40: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-00025b50: 2020 2020 2020 2076 636f 756e 7473 5f73         vcounts_s
-00025b60: 7265 732c 2072 6570 6561 745f 6870 687a  res, repeat_hphz
-00025b70: 3d6e 702e 756e 6971 7565 2028 7365 6c66  =np.unique (self
-00025b80: 2e53 7265 732c 2072 6574 7572 6e5f 636f  .Sres, return_co
-00025b90: 756e 7473 3d54 7275 6529 0d0a 2020 2020  unts=True)..    
-00025ba0: 2020 2020 2020 2020 7365 6c66 2e76 5372          self.vSr
-00025bb0: 6573 202c 2073 656c 662e 6d65 616e 5f53  es , self.mean_S
-00025bc0: 7265 7320 3d20 7663 6f75 6e74 735f 7372  res = vcounts_sr
-00025bd0: 6573 2c20 7365 6c66 2e53 7265 732e 6d65  es, self.Sres.me
-00025be0: 616e 2829 0d0a 2020 2020 2020 2020 2020  an()..          
-00025bf0: 2020 7365 6c66 2e6d 6178 3d28 7663 6f75    self.max=(vcou
-00025c00: 6e74 735f 7265 732e 6d61 7828 292c 7663  nts_res.max(),vc
-00025c10: 6f75 6e74 735f 7372 6573 2e6d 6178 2829  ounts_sres.max()
-00025c20: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00025c30: 656c 662e 6d69 6e20 3d20 2876 636f 756e  elf.min = (vcoun
-00025c40: 7473 5f72 6573 2e6d 696e 2829 2c76 636f  ts_res.min(),vco
-00025c50: 756e 7473 5f73 7265 732e 6d69 6e28 2929  unts_sres.min())
-00025c60: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00025c70: 6c66 2e6d 6561 6e20 3d28 7365 6c66 2e6d  lf.mean =(self.m
-00025c80: 6561 6e2c 2073 656c 662e 6d65 616e 5f53  ean, self.mean_S
-00025c90: 7265 7329 0d0a 2020 2020 2020 2020 2020  res)..          
-00025ca0: 2020 7472 756e 6361 7465 645f 7372 6573    truncated_sres
-00025cb0: 3d5a 6363 2e74 7275 6e63 6174 6564 5f64  =Zcc.truncated_d
-00025cc0: 6174 6128 2064 6174 6120 3d73 656c 662e  ata( data =self.
-00025cd0: 5372 6573 2c20 0d0a 2020 2020 2020 2020  Sres, ..        
-00025ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025cf0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00025d00: 756d 6265 725f 6f66 5f72 6563 6375 7265  umber_of_reccure
-00025d10: 6e63 653d 7365 6c66 2e6e 6672 6571 290d  nce=self.nfreq).
-00025d20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00025d30: 662e 6c6f 635f 5372 6573 203d 7b20 6b65  f.loc_Sres ={ ke
-00025d40: 793a 7661 6c75 6520 666f 7220 6b65 792c  y:value for key,
-00025d50: 2076 616c 7565 2069 6e20 7a69 7028 6e61   value in zip(na
-00025d60: 6d65 2c20 0d0a 2020 2020 2020 2020 2020  me, ..          
-00025d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025da0: 2020 2074 7275 6e63 6174 6564 5f73 7265     truncated_sre
-00025db0: 7320 297d 0d0a 0d0a 2020 2020 2020 200d  s )}....       .
-00025dc0: 0a63 6c61 7373 2050 6861 7365 2028 6f62  .class Phase (ob
-00025dd0: 6a65 6374 293a 200d 0a20 2020 2022 2222  ject): ..    """
-00025de0: 0d0a 2020 2020 496d 7065 6461 6e63 6520  ..    Impedance 
-00025df0: 7068 6173 6520 206f 6e20 6d69 6c6c 6952  phase  on milliR
-00025e00: 6164 6961 6e73 2063 616e 2062 6520 6361  adians can be ca
-00025e10: 6c63 756c 6174 6520 7573 696e 6720 4570  lculate using Ep
-00025e20: 687a 0d0a 2020 2020 206f 626a 6563 7420  hz..     object 
-00025e30: 616e 6420 4870 687a 206f 626a 6563 7420  and Hphz object 
-00025e40: 0d0a 2020 2020 200d 0a20 2020 2020 2020  ..     ..       
-00025e50: 2020 2a20 2a2a 5068 6173 652a 2a20 3d20    * **Phase** = 
-00025e60: 452d 7068 6173 6520 2d20 482d 7068 6173  E-phase - H-phas
-00025e70: 650d 0a20 2020 2020 2020 200d 0a20 2020  e..        ..   
-00025e80: 2041 7267 756d 656e 7473 200d 0a20 2020   Arguments ..   
-00025e90: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00025ea0: 2020 2020 202a 2a70 6861 7365 5f61 7272       **phase_arr
-00025eb0: 6179 2a2a 2020 3a20 6e64 6172 7261 790d  ay**  : ndarray.
-00025ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025ed0: 2020 2020 2020 2020 2061 7272 6179 206f           array o
-00025ee0: 6620 7068 6173 6520 7661 6c75 6573 2067  f phase values g
-00025ef0: 6f74 206f 6e20 7468 6520 6669 656c 640d  ot on the field.
-00025f00: 0a20 2020 2020 2020 2020 2a2a 746f 5f64  .         **to_d
-00025f10: 6567 7265 652a 2a20 3a20 626f 6f6c 200d  egree** : bool .
-00025f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025f30: 2020 2020 2020 2020 2070 7574 2074 6865           put the
-00025f40: 2050 6861 7365 2076 616c 7565 206f 6e20   Phase value on 
-00025f50: 6465 6772 6565 202e 200d 0a20 2020 2020  degree . ..     
-00025f60: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00025f70: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
-00025f80: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-00025f90: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-00025fa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00025fb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-00025fc0: 2020 2020 4174 7472 6962 7574 6573 2020      Attributes  
-00025fd0: 2020 2020 2020 2054 7970 6520 2020 2020         Type     
-00025fe0: 2020 2045 7870 6c61 6e61 7469 6f6e 0d0a     Explanation..
-00025ff0: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
-00026000: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-00026010: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
-00026020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00026030: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-00026040: 0a20 2020 2076 616c 7565 2020 2020 2020  .    value      
-00026050: 2020 2020 2020 206e 642e 6172 7261 7920         nd.array 
-00026060: 2020 2020 2064 6174 6120 6f66 2070 6861       data of pha
-00026070: 7365 2020 636f 6c75 6d6e 2020 0d0a 2020  se  column  ..  
-00026080: 2020 6d61 7820 2020 2020 2020 2020 2020    max           
-00026090: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
-000260a0: 2020 6d61 7869 6d75 6d20 7068 6173 6520    maximum phase 
-000260b0: 7661 6c75 6520 286d 7261 6429 0d0a 2020  value (mrad)..  
-000260c0: 2020 6d69 6e20 2020 2020 2020 2020 2020    min           
-000260d0: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
-000260e0: 2020 6d69 6e69 6d75 6d20 2050 6861 7365    minimum  Phase
-000260f0: 2020 286d 7261 6429 0d0a 2020 2020 6c6f    (mrad)..    lo
-00026100: 6320 2020 2020 2020 2020 2020 2020 2020  c               
-00026110: 6469 6374 2020 2020 2020 2020 2020 6c6f  dict          lo
-00026120: 6361 7469 6f6e 206f 6620 482d 7068 6173  cation of H-phas
-00026130: 6520 2076 616c 7565 2020 6174 2074 6865  e  value  at the
-00026140: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00026150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026160: 2020 2020 2020 2073 7461 7469 6f6e 206c         station l
-00026170: 616d 6264 6120 2e20 653a 6720 3a20 6c6f  ambda . e:g : lo
-00026180: 635b 2753 3030 275d 2073 686f 7720 7468  c['S00'] show th
-00026190: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-000261a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000261b0: 2020 2020 2020 2020 6375 7272 656e 7420          current 
-000261c0: 7068 6173 6520 6461 7461 2061 7420 7468  phase data at th
-000261d0: 6520 7374 6174 696f 6e20 5330 300d 0a20  e station S00.. 
-000261e0: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
-000261f0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-00026200: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-00026210: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00026220: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-00026230: 0d0a 2020 2020 4d6f 7265 2061 7474 7269  ..    More attri
-00026240: 6275 7465 7320 6361 6e20 6265 2061 6464  butes can be add
-00026250: 6564 2062 7920 696e 7075 7469 6e67 2061  ed by inputing a
-00026260: 206b 6579 2077 6f72 6420 6469 6374 696f   key word dictio
-00026270: 6e61 7279 0d0a 0d0a 2020 2020 3a45 7861  nary....    :Exa
-00026280: 6d70 6c65 3a0d 0a20 2020 2020 2020 2020  mple:..         
-00026290: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-000262a0: 6f6d 2070 7963 7361 6d74 2e66 662e 636f  om pycsamt.ff.co
-000262b0: 7265 2e61 7667 2069 6d70 6f72 7420 4176  re.avg import Av
-000262c0: 6720 0d0a 2020 2020 2020 2020 3e3e 3e20  g ..        >>> 
-000262d0: 7061 7468 3d6f 732e 7061 7468 2e6a 6f69  path=os.path.joi
-000262e0: 6e28 6f73 2e65 6e76 6972 6f6e 5b22 7079  n(os.environ["py
-000262f0: 4353 414d 5422 5d2c 200d 0a20 2020 2020  CSAMT"], ..     
-00026300: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00026310: 2020 2020 2020 2020 2770 7963 7361 6d74          'pycsamt
-00026320: 272c 2022 6461 7461 222c 2022 4b31 2e41  ', "data", "K1.A
-00026330: 5647 2229 0d0a 2020 2020 2020 2020 3e3e  VG")..        >>
-00026340: 3e20 6176 675f 6f62 6a3d 4176 6728 7061  > avg_obj=Avg(pa
-00026350: 7468 290d 0a20 2020 2020 2020 203e 3e3e  th)..        >>>
-00026360: 2070 6873 5f6f 626a 203d 6176 675f 6f62   phs_obj =avg_ob
-00026370: 6a2e 4461 7461 5f73 6563 7469 6f6e 2e50  j.Data_section.P
-00026380: 6861 7365 2e6c 6f63 5b27 5330 3027 5d0d  hase.loc['S00'].
-00026390: 0a20 2020 2020 2020 202e 2e2e 2070 7269  .        ... pri
-000263a0: 6e74 2870 6873 2e6c 6f63 5b27 5330 3027  nt(phs.loc['S00'
-000263b0: 5d29 0d0a 2020 2020 2222 220d 0a20 2020  ])..    """..   
-000263c0: 200d 0a20 2020 200d 0a20 2020 2064 6566   ..    ..    def
-000263d0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-000263e0: 7068 6173 655f 6172 7261 7920 3d4e 6f6e  phase_array =Non
-000263f0: 652c 6e75 6d62 6572 5f6f 665f 6672 6571  e,number_of_freq
-00026400: 7565 6e63 6965 733d 4e6f 6e65 202c 200d  uencies=None , .
-00026410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026420: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00026430: 5f6f 665f 7374 6174 696f 6e73 3d4e 6f6e  _of_stations=Non
-00026440: 652c 2020 202a 2a6b 7761 7267 7329 3a0d  e,   **kwargs):.
-00026450: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-00026460: 5f70 6861 7365 5f61 7272 6179 3d70 6861  _phase_array=pha
-00026470: 7365 5f61 7272 6179 200d 0a0d 0a20 2020  se_array ....   
-00026480: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00026490: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-000264a0: 6174 696f 6e73 203d 6b77 6172 6773 2e70  ations =kwargs.p
-000264b0: 6f70 2822 6e75 6d62 6572 5f6f 665f 7374  op("number_of_st
-000264c0: 6174 696f 6e73 222c 204e 6f6e 6529 0d0a  ations", None)..
-000264d0: 2020 2020 2020 2020 7365 6c66 2e6e 6672          self.nfr
-000264e0: 6571 203d 6b77 6172 6773 2e70 6f70 2827  eq =kwargs.pop('
-000264f0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
-00026500: 6e63 6965 7327 2c20 4e6f 6e65 290d 0a20  ncies', None).. 
-00026510: 2020 2020 2020 2073 656c 662e 746f 5f64         self.to_d
-00026520: 6567 7265 6520 3d6b 7761 7267 732e 706f  egree =kwargs.po
-00026530: 7028 2774 6f5f 6465 6772 6565 272c 2046  p('to_degree', F
-00026540: 616c 7365 290d 0a20 2020 2020 2020 200d  alse)..        .
-00026550: 0a20 2020 2020 2020 2073 656c 662e 7661  .        self.va
-00026560: 6c75 6520 3d4e 6f6e 6520 0d0a 2020 2020  lue =None ..    
-00026570: 2020 2020 7365 6c66 2e6d 696e 203d 204e      self.min = N
-00026580: 6f6e 6520 0d0a 2020 2020 2020 2020 7365  one ..        se
-00026590: 6c66 2e6d 6178 203d 204e 6f6e 6520 0d0a  lf.max = None ..
-000265a0: 2020 2020 0d0a 2020 2020 2020 2020 666f      ..        fo
-000265b0: 7220 6b65 7920 696e 206c 6973 7428 6b77  r key in list(kw
-000265c0: 6172 6773 2e6b 6579 7328 2929 3a0d 0a20  args.keys()):.. 
-000265d0: 2020 2020 2020 2020 2020 2073 6574 6174             setat
-000265e0: 7472 2873 656c 662c 206b 6579 2c20 6b77  tr(self, key, kw
-000265f0: 6172 6773 5b6b 6579 5d29 0d0a 2020 2020  args[key])..    
-00026600: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00026610: 2020 6966 2073 656c 662e 5f70 6861 7365    if self._phase
-00026620: 5f61 7272 6179 2069 7320 6e6f 7420 4e6f  _array is not No
-00026630: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
-00026640: 2020 2073 656c 662e 5f72 6561 645f 7265     self._read_re
-00026650: 735f 6461 7461 2028 290d 0a20 2020 2020  s_data ()..     
-00026660: 2020 2020 2020 200d 0a20 2020 0d0a 2020         ..   ..  
-00026670: 2020 6465 6620 5f72 6561 645f 7068 6173    def _read_phas
-00026680: 655f 6461 7461 2028 7365 6c66 2c70 6861  e_data (self,pha
-00026690: 7365 5f61 7272 6179 203d 4e6f 6e65 2c6e  se_array =None,n
-000266a0: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
-000266b0: 6369 6573 3d4e 6f6e 6520 2c20 0d0a 2020  cies=None , ..  
-000266c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000266d0: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
-000266e0: 7469 6f6e 733d 4e6f 6e65 2c20 2a2a 6b77  tions=None, **kw
-000266f0: 6172 6773 293a 0d0a 2020 2020 2020 2020  args):..        
-00026700: 2222 220d 0a20 2020 2020 2020 206d 6574  """..        met
-00026710: 686f 6420 746f 2072 6561 6420 7068 6173  hod to read phas
-00026720: 6520 7661 6c75 6573 206f 6274 6169 6e65  e values obtaine
-00026730: 6420 6f6e 2074 6865 2073 6974 6573 2e75  d on the sites.u
-00026740: 6e69 7473 206f 6e20 6d72 6164 732e 2020  nits on mrads.  
-00026750: 0d0a 2020 2020 2020 2020 5a6f 6e67 6520  ..        Zonge 
-00026760: 6b65 6570 2074 6865 2070 6861 7365 2076  keep the phase v
-00026770: 616c 7565 7320 6f6e 206d 7261 642e 0d0a  alues on mrad...
-00026780: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00026790: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-000267a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000267b0: 2d2d 0d0a 2020 2020 2020 2020 2020 2020  --..            
-000267c0: 2a20 7068 6173 655f 6172 7261 7920 3a20  * phase_array : 
-000267d0: 6e64 6172 7261 792c 206f 7074 696f 6e61  ndarray, optiona
-000267e0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-000267f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00026800: 6861 7365 2064 6174 6120 6172 6179 206f  hase data aray o
-00026810: 6e20 7468 6520 6669 656c 642e 0d0a 2020  n the field...  
-00026820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026830: 2020 2020 2020 2020 2020 5468 6520 2a64            The *d
-00026840: 6566 6175 6c74 2a20 6973 204e 6f6e 652e  efault* is None.
-00026850: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-00026860: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
-00026870: 6e63 6965 7320 3a20 5459 5045 2c20 6f70  ncies : TYPE, op
-00026880: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-00026890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000268a0: 2020 2020 6e75 6d62 6572 206f 6620 6665      number of fe
-000268b0: 7175 656e 6379 2075 7365 6420 2e0d 0a20  quency used ... 
-000268c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000268d0: 2020 2020 2020 2020 2020 2054 6865 202a             The *
-000268e0: 6465 6661 756c 742a 2069 7320 4e6f 6e65  default* is None
-000268f0: 2e0d 0a20 2020 2020 2020 2020 2020 202a  ...            *
-00026900: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
-00026910: 6f6e 7320 3a20 696e 742c 206f 7074 696f  ons : int, optio
-00026920: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-00026930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026940: 206e 756d 6265 7220 6f66 2074 6865 2073   number of the s
-00026950: 7461 7469 6f6e 7320 6f6e 2074 6865 2073  tations on the s
-00026960: 6974 652e 0d0a 2020 2020 2020 2020 2020  ite...          
-00026970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026980: 2020 5468 6520 2a64 6566 6175 6c74 2a20    The *default* 
-00026990: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
-000269a0: 2020 2222 220d 0a20 2020 200d 0a20 0d0a    """..    .. ..
-000269b0: 2020 2020 2020 2020 746f 5f64 6567 7265          to_degre
-000269c0: 6520 3d6b 7761 7267 732e 706f 7028 2274  e =kwargs.pop("t
-000269d0: 6f5f 6465 6772 6565 222c 2046 616c 7365  o_degree", False
-000269e0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-000269f0: 2020 2020 2069 6620 746f 5f64 6567 7265       if to_degre
-00026a00: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-00026a10: 2073 656c 662e 746f 5f64 6567 7265 6520   self.to_degree 
-00026a20: 3d20 746f 5f64 6567 7265 650d 0a20 2020  = to_degree..   
-00026a30: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-00026a40: 6620 7068 6173 655f 6172 7261 7920 6973  f phase_array is
-00026a50: 206e 6f74 204e 6f6e 6520 3a20 0d0a 2020   not None : ..  
-00026a60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00026a70: 7068 6173 655f 6172 7261 7920 3d70 6861  phase_array =pha
-00026a80: 7365 5f61 7272 6179 0d0a 2020 2020 2020  se_array..      
-00026a90: 2020 6966 2073 656c 662e 5f70 6861 7365    if self._phase
-00026aa0: 5f61 7272 6179 2069 7320 4e6f 6e65 203a  _array is None :
-00026ab0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-00026ac0: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-00026ad0: 5445 7272 6f72 5f69 6e70 7574 6172 6775  TError_inputargu
-00026ae0: 6d65 6e74 7328 274e 6f20 5068 6173 6520  ments('No Phase 
-00026af0: 6461 7461 2066 6f75 6e64 2020 2127 290d  data found  !').
-00026b00: 0a0d 0a20 2020 2020 2020 2069 6620 6e75  ...        if nu
-00026b10: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-00026b20: 6965 7320 6973 206e 6f74 204e 6f6e 6520  ies is not None 
-00026b30: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00026b40: 7365 6c66 2e6e 6672 6571 203d 6e75 6d62  self.nfreq =numb
-00026b50: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
-00026b60: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
-00026b70: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00026b80: 7261 6973 6520 4353 6578 2e70 7943 5341  raise CSex.pyCSA
-00026b90: 4d54 4572 726f 725f 696e 7075 7461 7267  MTError_inputarg
-00026ba0: 756d 656e 7473 280d 0a20 2020 2020 2020  uments(..       
-00026bb0: 2020 2020 2020 2020 2022 506c 6561 7365           "Please
-00026bc0: 2073 7065 6369 6679 2074 6865 206e 756d   specify the num
-00026bd0: 6265 7220 6f66 2066 7265 7175 656e 6379  ber of frequency
-00026be0: 2021 2229 0d0a 2020 2020 2020 2020 6966   !")..        if
-00026bf0: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
-00026c00: 6f6e 7320 6973 206e 6f74 204e 6f6e 6520  ons is not None 
-00026c10: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00026c20: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-00026c30: 6174 696f 6e73 203d 6e75 6d62 6572 5f6f  ations =number_o
-00026c40: 665f 7374 6174 696f 6e73 200d 0a20 2020  f_stations ..   
-00026c50: 2020 2020 2065 6c73 6520 3a20 0d0a 2020       else : ..  
-00026c60: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00026c70: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00026c80: 725f 696e 7075 7461 7267 756d 656e 7473  r_inputarguments
-00026c90: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00026ca0: 2020 2027 506c 6561 7365 2073 7065 6369     'Please speci
-00026cb0: 6679 2074 6865 206e 756d 6265 7220 6f66  fy the number of
-00026cc0: 2073 7461 7469 6f6e 7327 290d 0a0d 0a20   stations').... 
-00026cd0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00026ce0: 2020 2020 2074 7279 203a 200d 0a20 2020       try : ..   
-00026cf0: 2020 2020 2020 2020 2073 656c 662e 6e66           self.nf
-00026d00: 7265 713d 6e70 2e69 6e74 2873 656c 662e  req=np.int(self.
-00026d10: 6e66 7265 7129 0d0a 2020 2020 2020 2020  nfreq)..        
-00026d20: 2020 2020 7365 6c66 2e6e 756d 6265 725f      self.number_
-00026d30: 6f66 5f73 7461 7469 6f6e 7320 3d6e 702e  of_stations =np.
-00026d40: 696e 7428 7365 6c66 2e6e 756d 6265 725f  int(self.number_
-00026d50: 6f66 5f73 7461 7469 6f6e 7329 0d0a 2020  of_stations)..  
-00026d60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00026d70: 7068 6173 655f 6172 7261 793d 6e70 2e61  phase_array=np.a
-00026d80: 7272 6179 285b 6e70 2e66 6c6f 6174 2863  rray([np.float(c
-00026d90: 6329 200d 0a20 2020 2020 2020 2020 2020  c) ..           
-00026da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026db0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00026dc0: 2063 6320 696e 2073 656c 662e 5f70 6861   cc in self._pha
-00026dd0: 7365 5f61 7272 6179 5d29 0d0a 0d0a 2020  se_array])....  
-00026de0: 2020 2020 2020 6578 6365 7074 203a 200d        except : .
-00026df0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00026e00: 7365 2043 5365 782e 7079 4353 414d 5445  se CSex.pyCSAMTE
-00026e10: 7272 6f72 5f76 616c 7565 280d 0a20 2020  rror_value(..   
-00026e20: 2020 2020 2020 2020 2020 2020 2022 5661               "Va
-00026e30: 6c75 6573 2070 726f 7669 6465 6420 666f  lues provided fo
-00026e40: 7220 7468 6520 5068 6173 6520 6172 6520  r the Phase are 
-00026e50: 7772 6f6e 672e 225c 0d0a 2020 2020 2020  wrong."\..      
-00026e60: 2020 2020 2020 2020 2020 2022 206d 7573             " mus
-00026e70: 7420 6265 2066 6c6f 6174 206f 7220 696e  t be float or in
-00026e80: 7465 6765 7220 2e22 290d 0a20 2020 2020  teger .")..     
-00026e90: 2020 2069 6620 7365 6c66 2e74 6f5f 6465     if self.to_de
-00026ea0: 6772 6565 203a 2023 2d2d 2d3e 2073 6574  gree : #---> set
-00026eb0: 2061 6e67 6c65 2074 6f20 6465 6772 6565   angle to degree
-00026ec0: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
-00026ed0: 7365 6c66 2e5f 7068 6173 655f 6172 7261  self._phase_arra
-00026ee0: 7920 3d6e 702e 6170 706c 795f 616c 6f6e  y =np.apply_alon
-00026ef0: 675f 6178 6973 2028 0d0a 2020 2020 2020  g_axis (..      
-00026f00: 2020 2020 2020 2020 2020 6c61 6d62 6461            lambda
-00026f10: 2070 687a 3a20 7068 7a20 2a20 3138 302f   phz: phz * 180/
-00026f20: 6e70 2e70 692c 2030 2c73 656c 662e 5f70  np.pi, 0,self._p
-00026f30: 6861 7365 5f61 7272 6179 2920 2020 2020  hase_array)     
-00026f40: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00026f50: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00026f60: 2020 2020 2076 636f 756e 7473 5f70 687a       vcounts_phz
-00026f70: 2c20 7265 7065 6174 5f70 687a 3d6e 702e  , repeat_phz=np.
-00026f80: 756e 6971 7565 2028 0d0a 2020 2020 2020  unique (..      
-00026f90: 2020 2020 2020 7365 6c66 2e5f 7068 6173        self._phas
-00026fa0: 655f 6172 7261 792c 2072 6574 7572 6e5f  e_array, return_
-00026fb0: 636f 756e 7473 3d54 7275 6529 0d0a 2020  counts=True)..  
-00026fc0: 2020 2020 2020 7365 6c66 2e76 616c 7565        self.value
-00026fd0: 203d 7663 6f75 6e74 735f 7068 7a0d 0a20   =vcounts_phz.. 
-00026fe0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00026ff0: 2073 656c 662e 6d61 782c 2073 656c 662e   self.max, self.
-00027000: 6d69 6e20 3d76 636f 756e 7473 5f70 687a  min =vcounts_phz
-00027010: 2e6d 6178 2829 2c20 7663 6f75 6e74 735f  .max(), vcounts_
-00027020: 7068 7a2e 6d69 6e28 290d 0a20 2020 2020  phz.min()..     
-00027030: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00027040: 2020 2020 2020 2074 7275 6e63 6174 6564         truncated
-00027050: 5f70 687a 3d5a 6363 2e74 7275 6e63 6174  _phz=Zcc.truncat
-00027060: 6564 5f64 6174 6128 2064 6174 6120 3d73  ed_data( data =s
-00027070: 656c 662e 5f70 6861 7365 5f61 7272 6179  elf._phase_array
-00027080: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00027090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270a0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-000270b0: 725f 6f66 5f72 6563 6375 7265 6e63 653d  r_of_reccurence=
-000270c0: 7365 6c66 2e6e 6672 6571 290d 0a20 2020  self.nfreq)..   
-000270d0: 2020 2020 206e 616d 652c 2070 6f6c 796e       name, polyn
-000270e0: 616d 6520 3d20 5a63 632e 5f6e 756d 6265  ame = Zcc._numbe
-000270f0: 7269 6e67 5f73 7461 7469 6f6e 280d 0a20  ring_station(.. 
-00027100: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-00027110: 725f 6f66 5f73 7461 7469 6f6e 3d73 656c  r_of_station=sel
-00027120: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
-00027130: 696f 6e73 2c20 0d0a 2020 2020 2020 2020  ions, ..        
-00027140: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-00027150: 665f 6672 6571 203d 7365 6c66 2e6e 6672  f_freq =self.nfr
-00027160: 6571 290d 0a20 2020 2020 2020 200d 0a20  eq)..        .. 
-00027170: 2020 2020 2020 2073 656c 662e 6c6f 6320         self.loc 
-00027180: 3d7b 206b 6579 3a76 616c 7565 2066 6f72  ={ key:value for
-00027190: 206b 6579 2c20 7661 6c75 6520 696e 207a   key, value in z
-000271a0: 6970 286e 616d 652c 2074 7275 6e63 6174  ip(name, truncat
-000271b0: 6564 5f70 687a 2029 7d0d 0a20 2020 2020  ed_phz )}..     
-000271c0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000271d0: 200d 0a63 6c61 7373 205a 5f54 656e 736f   ..class Z_Tenso
-000271e0: 7228 6f62 6a65 6374 293a 0d0a 2020 2020  r(object):..    
-000271f0: 2222 220d 0a20 2020 2049 6d70 6564 616e  """..    Impedan
-00027200: 6365 2054 656e 736f 7220 5a20 4361 6c63  ce Tensor Z Calc
-00027210: 756c 6174 696f 6e20 3a20 200d 0a20 2020  ulation :  ..   
-00027220: 2020 2020 636c 6173 7320 6361 6e20 7265      class can re
-00027230: 636f 6d70 7574 6520 7468 6520 6170 7061  compute the appa
-00027240: 7265 6e74 2072 6573 6973 7469 7479 2072  rent resistity r
-00027250: 686f 2062 6173 6520 6f6e 2069 6d70 6564  ho base on imped
-00027260: 616e 6365 2054 656e 736f 7220 5a2e 0d0a  ance Tensor Z...
-00027270: 2020 2020 2020 200d 0a20 2020 202e 2e20         ..    .. 
-00027280: 7365 6561 6c73 6f3a 3a20 0d0a 2020 2020  seealso:: ..    
-00027290: 2020 2020 5a6f 6e67 652c 204b 2e4c 2e20      Zonge, K.L. 
-000272a0: 616e 6420 4875 6768 6573 2c20 4c2e 4a2e  and Hughes, L.J.
-000272b0: 2c20 3139 3931 2c20 436f 6e74 726f 6c6c  , 1991, Controll
-000272c0: 6564 2073 6f75 7263 6520 6175 6469 6f2d  ed source audio-
-000272d0: 6672 6571 7565 6e63 7920 0d0a 2020 2020  frequency ..    
-000272e0: 2020 2020 6d61 676e 6574 6f74 656c 6c75      magnetotellu
-000272f0: 7269 6373 2c69 6e20 456c 6563 7472 6f6d  rics,in Electrom
-00027300: 6167 6e65 7469 6320 4d65 7468 6f64 7320  agnetic Methods 
-00027310: 696e 2041 7070 6c69 6564 2047 656f 7068  in Applied Geoph
-00027320: 7973 6963 732c 2065 642e 0d0a 2020 2020  ysics, ed...    
-00027330: 2020 2020 4e61 6269 6768 6961 6e2c 204d      Nabighian, M
-00027340: 2e4e 2e2c 2056 6f6c 2e20 322c 536f 6369  .N., Vol. 2,Soci
-00027350: 6574 7920 6f66 2045 7870 6c6f 7261 7469  ety of Explorati
-00027360: 6f6e 2047 656f 7068 7973 6963 6973 7473  on Geophysicists
-00027370: 2c20 7070 2e20 3731 332d 3830 392e 0d0a  , pp. 713-809...
-00027380: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00027390: 2020 4172 6775 6d65 6e74 7320 0d0a 2020    Arguments ..  
-000273a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-000273b0: 2020 2020 2020 2a2a 6461 7461 5f66 6e2a        **data_fn*
-000273c0: 2a20 3a20 7374 720d 0a20 2020 2020 2020  * : str..       
-000273d0: 2020 2020 2020 2020 2070 6174 6820 746f           path to
-000273e0: 2061 7667 2066 696c 656e 616d 652e 200d   avg filename. .
-000273f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027400: 2020 200d 0a20 2020 203d 3d3d 3d3d 3d3d     ..    =======
-00027410: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-00027420: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-00027430: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-00027440: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00027450: 3d3d 3d3d 0d0a 2020 2020 4174 7472 6962  ====..    Attrib
-00027460: 7574 6573 2020 2020 2020 2020 2054 7970  utes         Typ
-00027470: 6520 2020 2020 2020 2020 2075 6e69 7473  e          units
-00027480: 2020 2020 2020 4578 706c 616e 6174 696f        Explanatio
-00027490: 6e0d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d  n..    =========
-000274a0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-000274b0: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-000274c0: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
-000274d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000274e0: 3d3d 0d0a 2020 2020 5a20 2020 2020 2020  ==..    Z       
-000274f0: 2020 2020 2020 2020 2020 6e70 2e6e 6461            np.nda
-00027500: 7272 6179 2020 2020 562f 6d20 2020 2020  rray    V/m     
-00027510: 2020 2020 496d 7065 6461 6e63 6520 7465      Impedance te
-00027520: 6e73 6f72 200d 0a20 2020 2072 6561 6c20  nsor ..    real 
-00027530: 2020 2020 2020 2020 2020 2020 2064 6963               dic
-00027540: 7420 2020 2020 2020 2020 2056 2f6d 2020  t          V/m  
-00027550: 2020 2020 2020 2072 6561 6c20 7061 7274         real part
-00027560: 206f 6620 5a20 0d0a 2020 2020 696d 6167   of Z ..    imag
-00027570: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00027580: 6374 2020 2020 2020 2020 2020 2020 2020  ct              
-00027590: 2020 2020 2020 2020 696d 6167 696e 6172          imaginar
-000275a0: 7920 7061 7274 206f 6620 5a20 200d 0a20  y part of Z  .. 
-000275b0: 2020 2063 6f6d 706c 6578 2020 2020 2020     complex      
-000275c0: 2020 2020 2064 6963 7420 2020 2020 2020       dict       
-000275d0: 2020 2063 6f6d 706c 6578 2020 2020 205a     complex     Z
-000275e0: 206f 6e20 636f 6d70 6c65 7820 7479 7065   on complex type
-000275f0: 0d0a 2020 2020 7268 6f20 2020 2020 2020  ..    rho       
-00027600: 2020 2020 2020 2020 6469 6374 2020 2020          dict    
-00027610: 2020 2020 2020 6f68 6d2e 6d20 2020 2020        ohm.m     
-00027620: 2020 5265 7369 7374 6976 6974 7920 0d0a    Resistivity ..
-00027630: 2020 2020 6c6f 6320 2020 2020 2020 2020      loc         
-00027640: 2020 2020 2020 6469 6374 2020 2020 2020        dict      
-00027650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027660: 6c6f 6361 7469 6f6e 206f 6620 5a20 7661  location of Z va
-00027670: 6c75 6520 6174 200d 0a20 2020 2020 2020  lue at ..       
-00027680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000276a0: 2020 2020 2020 2020 2074 6865 2073 7461           the sta
-000276b0: 7469 6f6e 206c 616d 6264 6120 2e0d 0a20  tion lambda ... 
-000276c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000276d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000276e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000276f0: 3a67 206c 6f63 5b27 5330 305d 2073 686f  :g loc['S00] sho
-00027700: 7720 7468 650d 0a20 2020 2020 2020 2020  w the..         
-00027710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027730: 2020 2020 2020 2063 7572 7265 6e74 205a         current Z
-00027740: 2064 6174 6120 6174 2073 7461 7469 6f6e   data at station
-00027750: 2053 3030 0d0a 2020 2020 3d3d 3d3d 3d3d   S00..    ======
-00027760: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-00027770: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-00027780: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-00027790: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000277a0: 3d3d 3d3d 3d0d 0a20 2020 200d 0a20 2020  =====..    ..   
-000277b0: 202e 2e20 6e6f 7465 3a3a 2061 6c6c 2064   .. note:: all d
-000277c0: 6963 742d 6174 7472 6962 7574 6573 2020  ict-attributes  
-000277d0: 6361 6e20 6265 206c 6f63 2077 6974 6820  can be loc with 
-000277e0: 7468 6520 7374 6174 696f 6e20 6e61 6d65  the station name
-000277f0: 202e 0d0a 2020 2020 2020 2020 0d0a 2020   ...        ..  
-00027800: 2020 4d6f 7265 2061 7474 7269 6275 7465    More attribute
-00027810: 7320 6361 6e20 6265 2061 6464 6564 2062  s can be added b
-00027820: 7920 696e 7075 7469 6e67 2061 206b 6579  y inputing a key
-00027830: 2077 6f72 6420 6469 6374 696f 6e61 7279   word dictionary
-00027840: 0d0a 2020 2020 0d0a 2020 2020 3a45 7861  ..    ..    :Exa
-00027850: 6d70 6c65 3a0d 0a20 2020 2020 2020 2020  mple:..         
-00027860: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-00027870: 6f6d 2070 7963 7361 6d74 2e66 662e 636f  om pycsamt.ff.co
-00027880: 7265 2e61 7667 2069 6d70 6f72 205a 5f74  re.avg impor Z_t
-00027890: 656e 736f 720d 0a20 2020 2020 2020 203e  ensor..        >
-000278a0: 3e3e 2070 6174 683d 6f73 2e70 6174 682e  >> path=os.path.
-000278b0: 6a6f 696e 286f 732e 656e 7669 726f 6e5b  join(os.environ[
-000278c0: 2270 7943 5341 4d54 225d 2c20 0d0a 2020  "pyCSAMT"], ..  
-000278d0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-000278e0: 2020 2020 2020 2020 2020 2027 7079 6373             'pycs
-000278f0: 616d 7427 2c20 2264 6174 6122 2c20 224b  amt', "data", "K
-00027900: 312e 4156 4722 290d 0a20 2020 2020 2020  1.AVG")..       
-00027910: 203e 3e3e 207a 5f6f 626a 3d5a 5f54 656e   >>> z_obj=Z_Ten
-00027920: 736f 7228 7061 7468 290d 0a20 2020 2020  sor(path)..     
-00027930: 2020 203e 3e3e 207a 5f7a 3d5a 7879 2e5a     >>> z_z=Zxy.Z
-00027940: 0d0a 2020 2020 2020 2020 3e3e 3e20 7072  ..        >>> pr
-00027950: 696e 7428 7a5f 6f62 6a2e 7265 616c 5b22  int(z_obj.real["
-00027960: 5330 3022 5d29 0d0a 2020 2020 2020 2020  S00"])..        
-00027970: 3e3e 3e20 7072 696e 7428 7a5f 6f62 6a2e  >>> print(z_obj.
-00027980: 696d 6167 5b22 5330 3022 5d29 0d0a 2020  imag["S00"])..  
-00027990: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
-000279a0: 7a5f 6f62 6a2e 636f 6d70 6c65 785b 2253  z_obj.complex["S
-000279b0: 3030 225d 290d 0a20 2020 2020 2020 203e  00"])..        >
-000279c0: 3e3e 2070 7269 6e74 287a 5f6f 626a 2e6c  >> print(z_obj.l
-000279d0: 6f63 5b22 5330 3022 5d29 0d0a 2020 2020  oc["S00"])..    
-000279e0: 2020 2020 3e3e 3e20 7072 696e 7428 7a5f      >>> print(z_
-000279f0: 6f62 6a2e 7268 6f5b 2253 3030 225d 290d  obj.rho["S00"]).
-00027a00: 0a20 2020 2022 2222 0d0a 2020 2020 6465  .    """..    de
-00027a10: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-00027a20: 207a 5f61 7272 6179 203d 4e6f 6e65 202c   z_array =None ,
-00027a30: 2070 6861 7365 5f61 7272 6179 203d 4e6f   phase_array =No
-00027a40: 6e65 2c20 6672 6571 3d4e 6f6e 652c 207a  ne, freq=None, z
-00027a50: 5f65 7272 6f72 3d4e 6f6e 652c 200d 0a20  _error=None, .. 
-00027a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027a70: 2a2a 6b77 6172 6773 293a 200d 0a0d 0a20  **kwargs): .... 
-00027a80: 2020 2020 2020 2073 656c 662e 5f6c 6f67         self._log
-00027a90: 6769 6e67 203d 6373 616d 7470 796c 6f67  ging =csamtpylog
-00027aa0: 2e67 6574 5f63 7361 6d74 7079 5f6c 6f67  .get_csamtpy_log
-00027ab0: 6765 7228 7365 6c66 2e5f 5f63 6c61 7373  ger(self.__class
-00027ac0: 5f5f 2e5f 5f6e 616d 655f 5f29 0d0a 2020  __.__name__)..  
-00027ad0: 2020 2020 2020 7365 6c66 2e5f 7a20 203d        self._z  =
-00027ae0: 7a5f 6172 7261 790d 0a20 2020 2020 2020  z_array..       
-00027af0: 2073 656c 662e 5f70 6861 7365 203d 7068   self._phase =ph
-00027b00: 6173 655f 6172 7261 7920 0d0a 2020 2020  ase_array ..    
-00027b10: 2020 2020 7365 6c66 2e5f 7a5f 6572 7220      self._z_err 
-00027b20: 3d7a 5f65 7272 6f72 200d 0a20 2020 2020  =z_error ..     
-00027b30: 2020 2073 656c 662e 5f66 7265 7120 3d20     self._freq = 
-00027b40: 4e6f 6e65 0d0a 2020 2020 2020 2020 0d0a  None..        ..
-00027b50: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-00027b60: 5f72 686f 203d 4e6f 6e65 0d0a 2020 2020  _rho =None..    
-00027b70: 2020 2020 7365 6c66 2e6c 6f63 3d4e 6f6e      self.loc=Non
-00027b80: 6520 0d0a 0d0a 2020 2020 2020 2020 7365  e ....        se
-00027b90: 6c66 2e7a 4153 203d 4e6f 6e65 200d 0a20  lf.zAS =None .. 
-00027ba0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00027bb0: 200d 0a20 2020 2020 2020 2066 6f72 206b   ..        for k
-00027bc0: 6579 2069 6e20 6c69 7374 2028 6b77 6172  ey in list (kwar
-00027bd0: 6773 2e6b 6579 7328 2929 3a0d 0a20 2020  gs.keys()):..   
-00027be0: 2020 2020 2020 2020 2073 6574 6174 7472           setattr
-00027bf0: 2873 656c 662c 206b 6579 202c 206b 7761  (self, key , kwa
-00027c00: 7267 735b 6b65 795d 290d 0a20 2020 2020  rgs[key])..     
-00027c10: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-00027c20: 662e 7a5f 7077 6774 203d 4e6f 6e65 200d  f.z_pwgt =None .
-00027c30: 0a20 2020 2020 2020 2073 656c 662e 7a5f  .        self.z_
-00027c40: 6d65 6774 203d 4e6f 6e65 200d 0a20 2020  megt =None ..   
-00027c50: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00027c60: 2020 2073 656c 662e 7a5f 6173 5f6c 6162     self.z_as_lab
-00027c70: 656c 733d 5b27 5a2e 6d61 6727 2c20 275a  els=['Z.mag', 'Z
-00027c80: 2e6d 7767 7427 2c27 5a2e 7077 6774 272c  .mwgt','Z.pwgt',
-00027c90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027cb0: 2020 2020 2745 2e77 6774 272c 2027 422e      'E.wgt', 'B.
-00027cc0: 7767 7427 2c27 5a2e 2565 7272 2720 5d0d  wgt','Z.%err' ].
-00027cd0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00027ce0: 2020 2020 2020 2020 0d0a 2020 2020 4070          ..    @p
-00027cf0: 726f 7065 7274 7920 0d0a 2020 2020 6465  roperty ..    de
-00027d00: 6620 6672 6571 2028 7365 6c66 293a 200d  f freq (self): .
-00027d10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00027d20: 7365 6c66 2e5f 6672 6571 200d 0a20 2020  self._freq ..   
-00027d30: 200d 0a20 2020 2040 6672 6571 2e73 6574   ..    @freq.set
-00027d40: 7465 7220 0d0a 2020 2020 6465 6620 6672  ter ..    def fr
-00027d50: 6571 2028 7365 6c66 2c20 6672 6571 5f61  eq (self, freq_a
-00027d60: 7272 6179 293a 0d0a 2020 2020 2020 2020  rray):..        
-00027d70: 6966 2066 7265 715f 6172 7261 792e 6474  if freq_array.dt
-00027d80: 7970 6520 6e6f 7420 696e 205b 2766 6c6f  ype not in ['flo
-00027d90: 6174 272c 2027 696e 7427 5d3a 0d0a 2020  at', 'int']:..  
-00027da0: 2020 2020 2020 2020 2020 7472 7920 3a20            try : 
-00027db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027dc0: 2020 7365 6c66 2e5f 6672 6571 203d 6e70    self._freq =np
-00027dd0: 2e61 7272 6179 285b 6e70 2e66 6c6f 6174  .array([np.float
-00027de0: 2866 6629 2066 6f72 2066 6620 696e 2066  (ff) for ff in f
-00027df0: 7265 715f 6172 7261 795d 290d 0a20 2020  req_array])..   
-00027e00: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-00027e10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00027e20: 2020 2072 6169 7365 2043 5365 782e 7079     raise CSex.py
-00027e30: 4353 414d 5445 7272 6f72 5f66 7265 7175  CSAMTError_frequ
-00027e40: 656e 6379 280d 0a20 2020 2020 2020 2020  ency(..         
-00027e50: 2020 2020 2020 2020 2020 2027 7772 6f6e             'wron
-00027e60: 6720 496e 7075 7420 6672 6571 7565 6e63  g Input frequenc
-00027e70: 6965 7320 7661 6c75 6573 2e6d 7573 7420  ies values.must 
-00027e80: 6265 2061 2066 6c6f 6174 206e 756d 6265  be a float numbe
-00027e90: 722e 2027 290d 0a20 2020 2020 2020 2020  r. ')..         
-00027ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ec0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00027ed0: 200d 0a20 2020 2040 7072 6f70 6572 7479   ..    @property
-00027ee0: 200d 0a20 2020 2064 6566 2070 6861 7365   ..    def phase
-00027ef0: 2028 7365 6c66 293a 0d0a 2020 2020 2020   (self):..      
-00027f00: 2020 7265 7475 726e 2073 656c 662e 5f70    return self._p
-00027f10: 6861 7365 200d 0a20 2020 2040 7068 6173  hase ..    @phas
-00027f20: 652e 7365 7474 6572 200d 0a20 2020 2064  e.setter ..    d
-00027f30: 6566 2070 6861 7365 2873 656c 662c 2070  ef phase(self, p
-00027f40: 687a 5f61 7272 6179 293a 0d0a 2020 2020  hz_array):..    
-00027f50: 2020 2020 6966 2070 687a 5f61 7272 6179      if phz_array
-00027f60: 2e64 7479 7065 206e 6f74 2069 6e20 5b27  .dtype not in ['
-00027f70: 666c 6f61 7427 2c20 2769 6e74 275d 3a0d  float', 'int']:.
-00027f80: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00027f90: 203a 7365 6c66 2e5f 7068 6173 6520 3d6e   :self._phase =n
-00027fa0: 702e 6172 7261 7928 5b66 6c6f 6174 2870  p.array([float(p
-00027fb0: 687a 2920 666f 7220 7068 7a20 696e 2070  hz) for phz in p
-00027fc0: 687a 5f61 7272 6179 5d29 0d0a 2020 2020  hz_array])..    
-00027fd0: 2020 2020 2020 2020 6578 6365 7074 203a          except :
-00027fe0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027ff0: 2020 7261 6973 6520 4353 6578 2e70 7943    raise CSex.pyC
-00028000: 5341 4d54 4572 726f 725f 5068 6173 6528  SAMTError_Phase(
-00028010: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00028020: 2020 2020 2020 2741 7267 756d 656e 7473        'Arguments
-00028030: 2070 6861 7365 2076 616c 7565 7320 6d75   phase values mu
-00028040: 7374 2062 6520 696e 742c 206f 7220 666c  st be int, or fl
-00028050: 6f61 7420 2e27 290d 0a20 2020 2020 2020  oat .')..       
-00028060: 2020 2020 200d 0a20 2020 2040 7072 6f70       ..    @prop
-00028070: 6572 7479 200d 0a20 2020 2064 6566 207a  erty ..    def z
-00028080: 5f65 7272 6f72 2028 7365 6c66 293a 0d0a  _error (self):..
-00028090: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000280a0: 656c 662e 5f7a 5f65 7272 200d 0a20 2020  elf._z_err ..   
-000280b0: 2040 7a5f 6572 726f 722e 7365 7474 6572   @z_error.setter
-000280c0: 200d 0a20 2020 2064 6566 207a 5f65 7272   ..    def z_err
-000280d0: 6f72 2873 656c 662c 207a 5f65 7272 6f72  or(self, z_error
-000280e0: 5f29 3a0d 0a20 2020 2020 2020 2069 6620  _):..        if 
-000280f0: 7a5f 6572 726f 725f 2e64 7479 7065 206e  z_error_.dtype n
-00028100: 6f74 2069 6e20 5b27 666c 6f61 7427 2c20  ot in ['float', 
-00028110: 2769 6e74 275d 3a0d 0a20 2020 2020 2020  'int']:..       
-00028120: 2020 2020 2074 7279 203a 200d 0a20 2020       try : ..   
-00028130: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00028140: 662e 5f7a 5f65 7272 203d 6e70 2e61 7272  f._z_err =np.arr
-00028150: 6179 285b 666c 6f61 7428 7a7a 2920 666f  ay([float(zz) fo
-00028160: 7220 7a7a 2069 6e20 7a5f 6572 726f 725f  r zz in z_error_
-00028170: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00028180: 6578 6365 7074 203a 0d0a 2020 2020 2020  except :..      
-00028190: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000281a0: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-000281b0: 725f 5a28 0d0a 2020 2020 2020 2020 2020  r_Z(..          
-000281c0: 2020 2020 2020 2020 2020 2245 7272 6f72            "Error
-000281d0: 207a 2069 6e70 7574 2076 616c 7565 7320   z input values 
-000281e0: 6172 6520 696e 636f 7272 6563 7473 2e22  are incorrects."
-000281f0: 290d 0a20 2020 200d 0a20 2020 2040 7072  )..    ..    @pr
-00028200: 6f70 6572 7479 200d 0a20 2020 2064 6566  operty ..    def
-00028210: 207a 2020 2873 656c 6629 3a20 0d0a 2020   z  (self): ..  
-00028220: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00028230: 662e 5f7a 0d0a 2020 2020 0d0a 2020 2020  f._z..    ..    
-00028240: 407a 2e73 6574 7465 7220 0d0a 2020 2020  @z.setter ..    
-00028250: 6465 6620 7a20 2873 656c 662c 207a 7a5f  def z (self, zz_
-00028260: 6172 7261 7929 3a0d 0a20 2020 2020 2020  array):..       
-00028270: 2069 6620 7a7a 5f61 7272 6179 2e64 7479   if zz_array.dty
-00028280: 7065 203d 3d20 2773 7472 273a 0d0a 2020  pe == 'str':..  
-00028290: 2020 2020 2020 2020 2020 7472 7920 3a20            try : 
-000282a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000282b0: 2020 7a7a 5f61 7272 6179 3d20 6e70 2e61    zz_array= np.a
-000282c0: 7272 6179 285b 6e70 2e66 6c6f 6174 287a  rray([np.float(z
-000282d0: 7a29 2066 6f72 207a 7a20 696e 207a 7a5f  z) for zz in zz_
-000282e0: 6172 7261 795d 290d 0a20 2020 2020 2020  array])..       
-000282f0: 2020 2020 2065 7863 6570 7420 3a20 0d0a       except : ..
-00028300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028310: 7261 6973 6520 4353 6578 2e70 7943 5341  raise CSex.pyCSA
-00028320: 4d54 4572 726f 725f 5a28 0d0a 2020 2020  MTError_Z(..    
-00028330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028340: 277a 5f69 6d70 6564 616e 6365 2076 616c  'z_impedance val
-00028350: 7565 206d 7573 7420 6265 2061 2063 6f6d  ue must be a com
-00028360: 706c 6578 5f6e 756d 6265 722e 2729 0d0a  plex_number.')..
-00028370: 2020 2020 2020 2020 232d 2d2d 3e20 7072          #---> pr
-00028380: 6f76 6964 6520 6672 6571 2076 616c 7565  ovide freq value
-00028390: 2061 6e64 2070 6861 7365 202e 2020 2020   and phase .    
-000283a0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-000283b0: 6620 7a7a 5f61 7272 6179 2e64 7479 7065  f zz_array.dtype
-000283c0: 2069 6e20 5b27 666c 6f61 7427 2c20 2769   in ['float', 'i
-000283d0: 6e74 275d 3a20 0d0a 2020 2020 2020 2020  nt']: ..        
-000283e0: 2020 2020 7365 6c66 2e5f 7a20 3d20 5a63      self._z = Zc
-000283f0: 632e 7268 6f70 6869 327a 2870 6861 7365  c.rhophi2z(phase
-00028400: 203d 7365 6c66 2e5f 7068 6173 6520 2c20   =self._phase , 
-00028410: 6672 6571 203d 7365 6c66 2e5f 6672 6571  freq =self._freq
-00028420: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
-00028430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028440: 2020 2020 2020 2020 7a5f 6172 7261 793d          z_array=
-00028450: 7a7a 5f61 7272 6179 295b 2d31 5d0d 0a20  zz_array)[-1].. 
-00028460: 2020 2020 2020 2065 6c73 6520 3a20 7365         else : se
-00028470: 6c66 2e5f 7a3d 207a 7a5f 6172 7261 790d  lf._z= zz_array.
-00028480: 0a20 2020 200d 0a20 2020 2020 2020 2020  .    ..         
-00028490: 2020 2020 2020 200d 0a20 2020 200d 0a20         ..    .. 
-000284a0: 2020 2064 6566 207a 5f61 6e64 5f7a 6572     def z_and_zer
-000284b0: 725f 3272 686f 7068 6928 7365 6c66 2c20  r_2rhophi(self, 
-000284c0: 7a5f 6172 7261 793d 4e6f 6e65 202c 2066  z_array=None , f
-000284d0: 7265 713d 4e6f 6e65 293a 0d0a 2020 2020  req=None):..    
-000284e0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000284f0: 204d 6574 686f 6420 746f 2063 6f6d 7075   Method to compu
-00028500: 7465 2072 6573 6973 7469 7669 7479 2061  te resistivity a
-00028510: 6e64 2070 6861 7365 2070 6861 7365 200d  nd phase phase .
-00028520: 0a20 2020 2020 2020 2075 7369 6e67 205a  .        using Z
-00028530: 5f76 616c 7565 7320 616e 6420 5a65 7272  _values and Zerr
-00028540: 6f72 205f 7661 6c75 6573 200d 0a20 2020  or _values ..   
-00028550: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
-00028560: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00028570: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00028580: 2020 2020 2020 2020 2020 202a 207a 5f61             * z_a
-00028590: 7272 6179 203a 2063 6f6d 706c 6578 0d0a  rray : complex..
-000285a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000285b0: 2020 2020 496d 7065 6461 6e63 6520 7465      Impedance te
-000285c0: 6e73 6f72 2063 6f6d 706c 6578 5f6e 756d  nsor complex_num
-000285d0: 6265 7220 0d0a 2020 2020 2020 2020 2020  ber ..          
-000285e0: 2020 2020 2020 2020 2020 5468 6520 2a64            The *d
-000285f0: 6566 6175 6c74 2a20 6973 204e 6f6e 652e  efault* is None.
-00028600: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-00028610: 6672 6571 203a 206e 6461 7272 6179 2c20  freq : ndarray, 
-00028620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00028630: 2020 2020 2020 6672 6571 7565 6e63 7920        frequency 
-00028640: 7661 6c75 652e 0d0a 2020 2020 2020 2020  value...        
-00028650: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00028660: 2a64 6566 6175 6c74 2a20 6973 204e 6f6e  *default* is Non
-00028670: 652e 0d0a 0d0a 2020 2020 2020 2020 5265  e.....        Re
-00028680: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00028690: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-000286a0: 2020 2020 6e64 6172 7261 7928 6e64 6172      ndarray(ndar
-000286b0: 7261 792c 3129 2020 0d0a 2020 2020 2020  ray,1)  ..      
-000286c0: 2020 2020 2020 2020 2020 7265 7369 7374            resist
-000286d0: 6976 6974 7920 7661 6c75 6520 636f 6d70  ivity value comp
-000286e0: 7574 6564 2069 6e20 6f68 6d2e 6d0d 0a20  uted in ohm.m.. 
-000286f0: 2020 2020 2020 2020 2020 206e 6461 7272             ndarr
-00028700: 6179 2028 6e64 6172 7261 792c 2031 292c  ay (ndarray, 1),
-00028710: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00028720: 2020 2070 6861 7365 2061 6e67 6c65 2076     phase angle v
-00028730: 616c 7565 2020 696e 2064 6567 7265 652e  alue  in degree.
-00028740: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00028750: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00028760: 200d 0a20 2020 2020 2020 2069 6620 7a5f   ..        if z_
-00028770: 6172 7261 7920 6973 206e 6f74 204e 6f6e  array is not Non
-00028780: 6520 3a20 7365 6c66 2e7a 3d20 7a5f 6172  e : self.z= z_ar
-00028790: 7261 7920 0d0a 2020 2020 2020 2020 0d0a  ray ..        ..
-000287a0: 2020 2020 2020 2020 6966 2066 7265 7120          if freq 
-000287b0: 6973 206e 6f74 204e 6f6e 6520 3a20 7365  is not None : se
-000287c0: 6c66 2e66 7265 713d 6672 6571 0d0a 2020  lf.freq=freq..  
-000287d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000287e0: 6966 2073 656c 662e 7a20 6973 204e 6f6e  if self.z is Non
-000287f0: 6520 6f72 2073 656c 662e 6672 6571 2069  e or self.freq i
-00028800: 7320 4e6f 6e65 203a 200d 0a20 2020 2020  s None : ..     
-00028810: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-00028820: 782e 7079 4353 414d 5445 7272 6f72 5f5a  x.pyCSAMTError_Z
-00028830: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00028840: 2020 2027 4e6f 6e65 2076 616c 7565 7320     'None values 
-00028850: 6361 6e20 6e6f 7420 6265 2063 6f6d 7075  can not be compu
-00028860: 7465 642e 2043 6865 636b 2076 616c 7565  ted. Check value
-00028870: 7320 2127 290d 0a20 2020 2020 2020 2020  s !')..         
-00028880: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-00028890: 662e 7268 6f20 3d6e 702e 6170 706c 795f  f.rho =np.apply_
-000288a0: 616c 6f6e 675f 6178 6973 280d 0a20 2020  along_axis(..   
-000288b0: 2020 2020 2020 2020 206c 616d 6264 6120           lambda 
-000288c0: 7661 6c7a 203a 206e 702e 6162 7328 7661  valz : np.abs(va
-000288d0: 6c7a 292a 2a32 202a 2028 302e 3220 2f20  lz)**2 * (0.2 / 
-000288e0: 7365 6c66 2e66 7265 7129 2c20 302c 2073  self.freq), 0, s
-000288f0: 656c 662e 7a29 0d0a 2020 2020 2020 2020  elf.z)..        
-00028900: 0d0a 2020 2020 2020 2020 232d 2d20 7a20  ..        #-- z 
-00028910: 6973 2063 6f6d 706c 6578 206e 756d 6265  is complex numbe
-00028920: 7220 2c20 6361 6e20 6265 2063 6f6d 7075  r , can be compu
-00028930: 7465 2075 7369 6e67 206e 702e 616e 676c  te using np.angl
-00028940: 650d 0a0d 0a20 2020 2020 2020 2073 656c  e....        sel
-00028950: 662e 7068 6173 653d 206e 702e 7261 6432  f.phase= np.rad2
-00028960: 6465 6728 6e70 2e61 6e67 6c65 2873 656c  deg(np.angle(sel
-00028970: 662e 7a29 290d 0a20 2020 2020 2020 2020  f.z))..         
-00028980: 2020 200d 0a20 2020 2020 2020 2072 6574     ..        ret
-00028990: 7572 6e20 7365 6c66 2e72 686f 202c 2073  urn self.rho , s
-000289a0: 656c 662e 7068 6173 650d 0a20 2020 200d  elf.phase..    .
-000289b0: 0a20 2020 200d 0a20 2020 2040 7072 6f70  .    ..    @prop
-000289c0: 6572 7479 0d0a 2020 2020 6465 6620 7268  erty..    def rh
-000289d0: 6f20 2873 656c 6629 3a20 0d0a 2020 2020  o (self): ..    
-000289e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000289f0: 5f72 686f 200d 0a20 2020 2020 2020 200d  _rho ..        .
-00028a00: 0a20 2020 2040 7268 6f2e 7365 7474 6572  .    @rho.setter
-00028a10: 200d 0a20 2020 2064 6566 2072 686f 2873   ..    def rho(s
-00028a20: 656c 662c 2072 6573 5f61 7272 6179 293a  elf, res_array):
-00028a30: 0d0a 2020 2020 2020 2020 6966 2072 6573  ..        if res
-00028a40: 5f61 7272 6179 2e64 7479 7065 206e 6f74  _array.dtype not
-00028a50: 2069 6e20 5b27 666c 6f61 7427 2c20 2769   in ['float', 'i
-00028a60: 6e74 275d 3a0d 0a20 2020 2020 2020 2020  nt']:..         
-00028a70: 2020 2074 7279 203a 2073 656c 662e 5f72     try : self._r
-00028a80: 686f 203d 206e 702e 6172 7261 7928 5b66  ho = np.array([f
-00028a90: 6c6f 6174 2872 6573 2920 666f 7220 7265  loat(res) for re
-00028aa0: 7320 696e 2072 6573 5f61 7272 6179 5d29  s in res_array])
-00028ab0: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
-00028ac0: 7863 6570 7420 3a20 0d0a 2020 2020 2020  xcept : ..      
-00028ad0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00028ae0: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00028af0: 725f 7268 6f28 0d0a 2020 2020 2020 2020  r_rho(..        
-00028b00: 2020 2020 2020 2020 2020 2020 2752 6573              'Res
-00028b10: 6973 7469 7669 7469 6573 2076 616c 7565  istivities value
-00028b20: 7320 6d75 7374 2062 6520 666c 6f61 7420  s must be float 
-00028b30: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00028b40: 2020 2020 2020 2020 276f 7220 696e 7465          'or inte
-00028b50: 6765 7220 2c20 6e6f 7420 6120 4e6f 6e65  ger , not a None
-00028b60: 2074 7970 6520 2127 290d 0a20 2020 2020   type !')..     
-00028b70: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00028b80: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00028b90: 2064 6566 2072 686f 7068 6932 7268 6f70   def rhophi2rhop
-00028ba0: 685f 6572 726f 7273 2028 7365 6c66 2c20  h_errors (self, 
-00028bb0: 7265 735f 6172 7261 793d 4e6f 6e65 202c  res_array=None ,
-00028bc0: 2070 6861 7365 5f61 7272 6179 203d 204e   phase_array = N
-00028bd0: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00028be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028bf0: 2020 207a 5f65 7272 6f72 203d 4e6f 6e65     z_error =None
-00028c00: 202c 2066 7265 713d 4e6f 6e65 2029 3a20   , freq=None ): 
-00028c10: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00028c20: 2020 2020 2020 2043 6f6d 7075 7465 2074         Compute t
-00028c30: 6865 2070 6861 7365 2061 6e64 2072 6573  he phase and res
-00028c40: 6973 7469 7669 7469 6573 2065 7272 6f72  istivities error
-00028c50: 2076 6961 2072 6573 5f61 7272 6179 202c   via res_array ,
-00028c60: 200d 0a20 2020 2020 2020 2070 6861 7365   ..        phase
-00028c70: 5f61 7272 6179 2061 6e64 205f 7a20 6572  _array and _z er
-00028c80: 726f 722e 0d0a 2020 2020 2020 2020 0d0a  ror...        ..
-00028c90: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00028ca0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00028cb0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00028cc0: 2020 2020 2a20 7265 735f 6172 7261 7920      * res_array 
-00028cd0: 3a20 6e64 6172 7261 7920 2c20 0d0a 2020  : ndarray , ..  
-00028ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028cf0: 2020 2020 2020 7265 7369 7374 6976 6974        resistivit
-00028d00: 7920 7661 6c75 6520 696e 206f 686d 2e6d  y value in ohm.m
-00028d10: 200d 0a20 2020 2020 2020 2020 2020 202a   ..            *
-00028d20: 2070 6861 7365 5f61 7272 6179 203a 206e   phase_array : n
-00028d30: 6461 7272 6179 202c 200d 0a20 2020 2020  darray , ..     
-00028d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d50: 2020 2070 6861 7365 2061 6e67 6c65 2076     phase angle v
-00028d60: 616c 7565 2069 6e20 6d72 6164 6961 6e73  alue in mradians
-00028d70: 200d 0a20 2020 2020 2020 2020 2020 202a   ..            *
-00028d80: 207a 5f65 7272 6f72 203a 206e 6461 7272   z_error : ndarr
-00028d90: 6179 202c 200d 0a20 2020 2020 2020 2020  ay , ..         
-00028da0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00028db0: 6d70 6564 616e 6365 2054 656e 736f 7220  mpedance Tensor 
-00028dc0: 6572 726f 7220 0d0a 2020 2020 2020 2020  error ..        
-00028dd0: 2020 2020 2a20 6672 6571 203a 206e 6461      * freq : nda
-00028de0: 7272 6179 202c 200d 0a20 2020 2020 2020  rray , ..       
-00028df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e00: 2066 7265 7175 656e 6379 206e 756d 6265   frequency numbe
-00028e10: 7273 2069 6e20 487a 200d 0a20 2020 2020  rs in Hz ..     
-00028e20: 2020 2052 6574 7572 6e73 200d 0a20 2020     Returns ..   
-00028e30: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
-00028e40: 2020 2020 2020 2020 2020 6e64 6172 7261            ndarra
-00028e50: 7973 200d 0a20 2020 2020 2020 2020 2020  ys ..           
-00028e60: 2020 2072 6573 6973 7469 7669 7469 6573     resistivities
-00028e70: 2065 7272 6f72 2061 6e64 2070 6861 7365   error and phase
-00028e80: 2065 7272 6f72 7320 7661 6c75 6573 2020   errors values  
-00028e90: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00028ea0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00028eb0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00028ec0: 2e5f 6c6f 6767 696e 672e 696e 666f 2827  ._logging.info('
-00028ed0: 636f 6d70 7574 6520 7268 6f5f 7068 6920  compute rho_phi 
-00028ee0: 746f 2072 6573 6973 7469 7669 7469 6573  to resistivities
-00028ef0: 2061 6e64 2070 6861 7365 735f 6572 726f   and phases_erro
-00028f00: 7273 2729 0d0a 2020 2020 2020 2020 0d0a  rs')..        ..
-00028f10: 2020 2020 2020 2020 6966 2072 6573 5f61          if res_a
-00028f20: 7272 6179 2069 7320 6e6f 7420 4e6f 6e65  rray is not None
-00028f30: 203a 2073 656c 662e 7268 6f20 3d72 6573   : self.rho =res
-00028f40: 5f61 7272 6179 0d0a 2020 2020 2020 2020  _array..        
-00028f50: 6966 207a 5f65 7272 6f72 2069 7320 6e6f  if z_error is no
-00028f60: 7420 4e6f 6e65 203a 2073 656c 662e 7a5f  t None : self.z_
-00028f70: 6572 726f 7220 3d7a 5f65 7272 6f72 200d  error =z_error .
-00028f80: 0a20 2020 2020 2020 2069 6620 7068 6173  .        if phas
-00028f90: 655f 6172 7261 7920 6973 206e 6f74 204e  e_array is not N
-00028fa0: 6f6e 6520 3a20 7365 6c66 2e70 6861 7365  one : self.phase
-00028fb0: 203d 7068 6173 655f 6172 7261 7920 0d0a   =phase_array ..
-00028fc0: 2020 2020 2020 2020 6966 2066 7265 7120          if freq 
-00028fd0: 6973 206e 6f74 204e 6f6e 6520 3a20 7365  is not None : se
-00028fe0: 6c66 2e66 7265 7120 3d20 6672 6571 200d  lf.freq = freq .
-00028ff0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00029000: 2e72 686f 2069 7320 4e6f 6e65 2020 6f72  .rho is None  or
-00029010: 2073 656c 662e 7068 6173 6520 6973 204e   self.phase is N
-00029020: 6f6e 6520 6f72 2073 656c 662e 6672 6571  one or self.freq
-00029030: 2069 7320 4e6f 6e65 203a 200d 0a20 2020   is None : ..   
-00029040: 2020 2020 2020 2020 2073 656c 662e 5f6c           self._l
-00029050: 6f67 6769 6e67 2e77 6172 6e28 0d0a 2020  ogging.warn(..  
-00029060: 2020 2020 2020 2020 2020 2020 2020 274e                'N
-00029070: 6f6e 6554 7970 6520 6361 6e20 6e6f 7420  oneType can not 
-00029080: 6265 2063 6f6d 7075 7465 642e 2070 6c65  be computed. ple
-00029090: 6173 6520 6368 6563 6b20 796f 7572 2064  ase check your d
-000290a0: 6174 6120 6172 7261 7973 2e27 290d 0a20  ata arrays.').. 
-000290b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000290c0: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-000290d0: 6f72 5f5a 280d 0a20 2020 2020 2020 2020  or_Z(..         
-000290e0: 2020 2020 2020 2027 636f 756c 6420 6e6f         'could no
-000290f0: 7465 2063 6f6d 7075 7465 2061 204e 6f6e  te compute a Non
-00029100: 6574 7970 6520 6e75 6d62 6572 2e20 706c  etype number. pl
-00029110: 6561 7365 2063 6865 636b 206e 756d 6265  ease check numbe
-00029120: 7273 2e27 290d 0a20 2020 2020 2020 200d  rs.')..        .
-00029130: 0a20 2020 2020 2020 2023 2063 6f6d 7075  .        # compu
-00029140: 7465 2069 6d61 6720 7061 7274 2061 6e64  te imag part and
-00029150: 2072 6561 6c20 7061 7274 206f 6620 5a20   real part of Z 
-00029160: 0d0a 2020 2020 2020 2020 2020 2020 200d  ..             .
-00029170: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00029180: 2e72 686f 2e73 697a 6520 213d 2073 656c  .rho.size != sel
-00029190: 662e 6672 6571 2e73 697a 6520 3a20 0d0a  f.freq.size : ..
-000291a0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000291b0: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-000291c0: 726f 725f 5a28 0d0a 2020 2020 2020 2020  ror_Z(..        
-000291d0: 2020 2020 2020 2020 2752 6573 6973 7469          'Resisti
-000291e0: 7669 7479 202c 2066 7265 7120 616e 6420  vity , freq and 
-000291f0: 7068 6173 655f 6172 7261 7920 6d75 7374  phase_array must
-00029200: 2062 6520 7468 6520 7361 6d65 2073 697a   be the same siz
-00029210: 652e 2027 290d 0a20 2020 2020 2020 200d  e. ')..        .
-00029220: 0a20 2020 2020 2020 2023 207a 7a5f 3d20  .        # zz_= 
-00029230: 6e70 2e61 7272 6179 285b 6e70 2e73 7172  np.array([np.sqr
-00029240: 7428 302e 3220 2a20 7365 6c66 2e5f 6672  t(0.2 * self._fr
-00029250: 6571 5b69 695d 202a 200d 0a20 2020 2020  eq[ii] * ..     
-00029260: 2020 2023 7365 6c66 2e5f 7268 6f5b 6969     #self._rho[ii
-00029270: 5d29 2066 6f72 2069 6920 696e 2072 616e  ]) for ii in ran
-00029280: 6765 2028 7365 6c66 2e5f 6672 6571 2e73  ge (self._freq.s
-00029290: 697a 6529 5d29 0d0a 2020 2020 2020 2020  ize)])..        
-000292a0: 7a7a 5f63 6f6d 7020 3d20 5a63 632e 7268  zz_comp = Zcc.rh
-000292b0: 6f70 6869 327a 2870 6861 7365 3d73 656c  ophi2z(phase=sel
-000292c0: 662e 7068 6173 652f 3165 332c 2066 7265  f.phase/1e3, fre
-000292d0: 713d 7365 6c66 2e66 7265 712c 200d 0a20  q=self.freq, .. 
-000292e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000292f0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00029300: 7369 7374 6976 6974 793d 7365 6c66 2e72  sistivity=self.r
-00029310: 686f 290d 0a20 2020 2020 2020 2073 656c  ho)..        sel
-00029320: 662e 7a20 3d7a 7a5f 636f 6d70 5b2d 315d  f.z =zz_comp[-1]
-00029330: 0d0a 0d0a 2020 2020 2020 2020 0d0a 2020  ....        ..  
-00029340: 2020 2020 2020 2320 7a7a 5f20 3d6e 702e        # zz_ =np.
-00029350: 7371 7274 2028 302e 3220 2a20 7365 6c66  sqrt (0.2 * self
-00029360: 2e5f 6672 6571 202a 2073 656c 662e 5f72  ._freq * self._r
-00029370: 686f 290d 0a20 2020 2020 2020 2023 207a  ho)..        # z
-00029380: 5f72 6561 6c3d 286e 702e 6170 706c 795f  _real=(np.apply_
-00029390: 616c 6f6e 675f 6178 6973 286c 616d 6264  along_axis(lambd
-000293a0: 6120 7878 7220 3a20 6e70 2e63 6f73 2878  a xxr : np.cos(x
-000293b0: 7872 292c 2030 2c20 7365 6c66 2e5f 7068  xr), 0, self._ph
-000293c0: 6173 6529 2920 2a20 7a7a 5f20 0d0a 2020  ase)) * zz_ ..  
-000293d0: 2020 2020 2020 2320 7a5f 696d 6167 203d        # z_imag =
-000293e0: 286e 702e 6170 706c 795f 616c 6f6e 675f  (np.apply_along_
-000293f0: 6178 6973 286c 616d 6264 6120 7878 693a  axis(lambda xxi:
-00029400: 206e 702e 636f 7328 7878 6929 2c20 302c   np.cos(xxi), 0,
-00029410: 2073 656c 662e 5f70 6861 7365 2929 2a20   self._phase))* 
-00029420: 7a7a 5f0d 0a0d 0a20 2020 2020 2020 2072  zz_....        r
-00029430: 6573 5f65 7272 2c20 7068 6173 655f 6572  es_err, phase_er
-00029440: 7220 3d20 5a63 632e 7a5f 6572 726f 7232  r = Zcc.z_error2
-00029450: 725f 7068 695f 6572 726f 7228 7a5f 7265  r_phi_error(z_re
-00029460: 616c 3d7a 7a5f 636f 6d70 5b31 5d2c 0d0a  al=zz_comp[1],..
-00029470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000294a0: 2020 2020 207a 5f69 6d61 673d 7a7a 5f63       z_imag=zz_c
-000294b0: 6f6d 705b 325d 2c20 0d0a 2020 2020 2020  omp[2], ..      
-000294c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000294d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000294e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000294f0: 7272 6f72 3d73 656c 662e 7a5f 6572 726f  rror=self.z_erro
-00029500: 7229 0d0a 2020 2020 2020 2020 0d0a 2020  r)..        ..  
-00029510: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00029520: 5f65 7272 202c 2070 6861 7365 5f65 7272  _err , phase_err
-00029530: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-00029540: 0a20 2020 2064 6566 205f 7265 6164 5f7a  .    def _read_z
-00029550: 4153 5f64 6174 6120 2873 656c 662c 207a  AS_data (self, z
-00029560: 5f61 6273 5f61 7272 6179 203d 4e6f 6e65  _abs_array =None
-00029570: 202c 206e 756d 6265 725f 6f66 5f66 7265   , number_of_fre
-00029580: 7175 656e 6369 6573 3d4e 6f6e 6520 2c0d  quencies=None ,.
-00029590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000295a0: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-000295b0: 5f73 7461 7469 6f6e 7320 3d4e 6f6e 6520  _stations =None 
-000295c0: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
-000295d0: 0a20 2020 2020 2020 204d 6574 686f 6420  .        Method 
-000295e0: 746f 2073 6574 205a 5f76 616c 7565 7320  to set Z_values 
-000295f0: 7374 7261 6967 6874 666f 7277 6172 646c  straightforwardl
-00029600: 7920 6672 6f6d 205a 6f6e 6765 2041 7374  y from Zonge Ast
-00029610: 6174 6963 2066 696c 6520 2e20 0d0a 2020  atic file . ..  
-00029620: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
-00029630: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00029640: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a     -----------..
-00029650: 2020 2020 2020 2020 2020 2020 2a20 7a5f              * z_
-00029660: 6172 7261 7920 3a20 7064 2e44 6174 6146  array : pd.DataF
-00029670: 7261 6d65 202c 0d0a 2020 2020 2020 2020  rame ,..        
-00029680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029690: 6164 6465 6420 7661 6c75 6573 2066 726f  added values fro
-000296a0: 6d20 6173 7461 7469 6320 6669 6c65 732e  m astatic files.
-000296b0: 200d 0a20 2020 2020 2020 2020 2020 202a   ..            *
-000296c0: 206e 756d 6265 725f 6f66 5f66 7265 7175   number_of_frequ
-000296d0: 656e 6379 203a 2020 696e 7420 202c 200d  ency :  int  , .
-000296e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000296f0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-00029700: 6f66 2066 7265 7175 656e 6379 2075 7365  of frequency use
-00029710: 6420 6475 7269 6e67 2073 7572 7665 7973  d during surveys
-00029720: 2e0d 0a20 2020 2020 2020 2020 2020 202a  ...            *
-00029730: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
-00029740: 6f6e 7320 3a69 6e74 202c 200d 0a20 2020  ons :int , ..   
-00029750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029760: 2020 2020 2064 6966 6665 7265 6e74 7320       differents 
-00029770: 7375 7276 6579 2066 7265 7175 656e 6369  survey frequenci
-00029780: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
-00029790: 202a 2046 7265 7175 656e 6379 203a 2061   * Frequency : a
-000297a0: 7272 6179 5f6c 696b 650d 0a20 2020 2020  rray_like..     
-000297b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000297c0: 2020 2066 7265 7175 656e 6379 2061 7272     frequency arr
-000297d0: 6179 2075 6e69 7473 2069 6e20 487a 2020  ay units in Hz  
-000297e0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-000297f0: 2020 2020 2020 2020 2e2e 204e 6f74 6573          .. Notes
-00029800: 203a 3a20 0d0a 2020 2020 2020 2020 2020   :: ..          
-00029810: 2020 2061 7070 726f 7072 6961 7465 2063     appropriate c
-00029820: 6f6e 7665 7274 6572 2020 7368 6f75 6c64  onverter  should
-00029830: 2062 6520 0d0a 2020 2020 2020 2020 2020   be ..          
-00029840: 2020 202d 2031 487a 202d 2d3e 2020 362e     - 1Hz -->  6.
-00029850: 3238 3134 3037 3034 2c20 0d0a 2020 2020  28140704, ..    
-00029860: 2020 2020 2020 2020 202d 2064 6567 2d72           - deg-r
-00029870: 6164 202d 2d3e 2074 6865 7461 2864 6567  ad --> theta(deg
-00029880: 2920 2a6e 702e 7069 2f31 3830 200d 0a20  ) *np.pi/180 .. 
-00029890: 2020 2020 2020 2020 2020 2020 2d20 6d75              - mu
-000298a0: 2020 7661 6363 756d 2070 6572 6d69 7469    vaccum permiti
-000298b0: 7669 7479 2077 6974 6820 2073 6369 7079  vity with  scipy
-000298c0: 2e63 6f6e 7374 616e 7473 2e65 7073 696c  .constants.epsil
-000298d0: 6f6e 5f30 0d0a 2020 2020 2020 2020 2222  on_0..        ""
-000298e0: 220d 0a20 2020 2020 2020 200d 0a20 2020  "..        ..   
-000298f0: 2020 2020 2073 656c 662e 5f6c 6f67 6769       self._loggi
-00029900: 6e67 2e69 6e66 6f28 2754 7261 6e73 6665  ng.info('Transfe
-00029910: 7269 6e67 2041 7374 6174 6963 205a 2064  ring Astatic Z d
-00029920: 6174 6120 2e27 290d 0a20 2020 2020 2020  ata .')..       
-00029930: 200d 0a20 2020 2020 2020 2069 6620 7a5f   ..        if z_
-00029940: 6162 735f 6172 7261 7920 6973 206e 6f74  abs_array is not
-00029950: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
-00029960: 2020 2020 2020 7365 6c66 2e7a 4153 203d        self.zAS =
-00029970: 207a 5f61 6273 5f61 7272 6179 200d 0a20   z_abs_array .. 
-00029980: 2020 2020 2020 2069 6620 7365 6c66 2e7a         if self.z
-00029990: 4153 2069 7320 4e6f 6e65 203a 200d 0a20  AS is None : .. 
-000299a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000299b0: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-000299c0: 6f72 5f69 6e70 7574 6172 6775 6d65 6e74  or_inputargument
-000299d0: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-000299e0: 2020 2020 274e 6f20 7a6f 6e67 6520 4173      'No zonge As
-000299f0: 7461 7469 6320 2064 6174 6120 666f 756e  tatic  data foun
-00029a00: 6420 2021 2729 2020 2020 2020 2020 2020  d  !')          
-00029a10: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00029a20: 0d0a 2020 2020 2020 2020 6966 206e 756d  ..        if num
-00029a30: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-00029a40: 6573 2069 7320 6e6f 7420 4e6f 6e65 203a  es is not None :
-00029a50: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00029a60: 6c66 2e6e 6672 6571 203d 206e 756d 6265  lf.nfreq = numbe
-00029a70: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
-00029a80: 200d 0a20 2020 2020 2020 2065 6c73 6520   ..        else 
-00029a90: 3a72 6169 7365 2043 5365 782e 7079 4353  :raise CSex.pyCS
-00029aa0: 414d 5445 7272 6f72 5f69 6e70 7574 6172  AMTError_inputar
-00029ab0: 6775 6d65 6e74 7328 0d0a 2020 2020 2020  guments(..      
-00029ac0: 2020 2020 2020 2250 6c65 6173 6520 7370        "Please sp
-00029ad0: 6563 6966 7920 7468 6520 6e75 6d62 6572  ecify the number
-00029ae0: 206f 6620 6672 6571 7565 6e63 7920 2122   of frequency !"
-00029af0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-00029b00: 2020 2020 2069 6620 6e75 6d62 6572 5f6f       if number_o
-00029b10: 665f 7374 6174 696f 6e73 2069 7320 6e6f  f_stations is no
-00029b20: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-00029b30: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
-00029b40: 6572 5f6f 665f 7374 6174 696f 6e73 3d20  er_of_stations= 
-00029b50: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-00029b60: 6e73 0d0a 2020 2020 2020 2020 656c 7365  ns..        else
-00029b70: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00029b80: 2072 6169 7365 2043 5365 782e 7079 4353   raise CSex.pyCS
-00029b90: 414d 5445 7272 6f72 5f69 6e70 7574 6172  AMTError_inputar
-00029ba0: 6775 6d65 6e74 7328 0d0a 2020 2020 2020  guments(..      
-00029bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bc0: 2020 2020 2020 2020 2020 2020 2020 2750                'P
-00029bd0: 6c65 6173 6520 7370 6563 6966 7920 7468  lease specify th
-00029be0: 6520 6e75 6d62 6572 206f 6620 7374 6174  e number of stat
-00029bf0: 696f 6e73 2729 0d0a 0d0a 2020 2020 2020  ions')....      
-00029c00: 2020 0d0a 2020 2020 2020 2020 6966 2074    ..        if t
-00029c10: 7970 6528 7365 6c66 2e7a 4153 2920 3d3d  ype(self.zAS) ==
-00029c20: 2070 642e 636f 7265 2e66 7261 6d65 2e44   pd.core.frame.D
-00029c30: 6174 6146 7261 6d65 203a 200d 0a20 2020  ataFrame : ..   
-00029c40: 2020 2020 2020 2020 2066 6f72 2077 6774           for wgt
-00029c50: 2069 6e20 6c69 7374 2873 656c 662e 7a41   in list(self.zA
-00029c60: 532e 636f 6c75 6d6e 7329 3a20 0d0a 2020  S.columns): ..  
-00029c70: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00029c80: 2077 6774 203d 3d20 275a 2e6d 7767 7427   wgt == 'Z.mwgt'
-00029c90: 206f 7220 7767 7420 3d3d 2027 452e 7767   or wgt == 'E.wg
-00029ca0: 7427 3a20 0d0a 2020 2020 2020 2020 2020  t': ..          
-00029cb0: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
-00029cc0: 5f6d 7767 7420 3d73 656c 662e 7a41 535b  _mwgt =self.zAS[
-00029cd0: 7767 745d 2e74 6f5f 6e75 6d70 7928 290d  wgt].to_numpy().
-00029ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029cf0: 2069 6620 7767 7420 3d3d 2027 5a2e 7077   if wgt == 'Z.pw
-00029d00: 6774 2720 6f72 2077 6774 203d 3d27 422e  gt' or wgt =='B.
-00029d10: 7767 7427 3a0d 0a20 2020 2020 2020 2020  wgt':..         
-00029d20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00029d30: 7a5f 7077 6774 203d 7365 6c66 2e7a 4153  z_pwgt =self.zAS
-00029d40: 5b27 5a2e 7077 6774 275d 2e74 6f5f 6e75  ['Z.pwgt'].to_nu
-00029d50: 6d70 7928 290d 0a20 2020 2020 2020 2020  mpy()..         
-00029d60: 2020 2020 2020 2069 6620 7767 7420 3d3d         if wgt ==
-00029d70: 2027 5a2e 2565 7272 273a 200d 0a20 2020   'Z.%err': ..   
-00029d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d90: 2073 656c 662e 5f7a 5f65 7272 203d 7365   self._z_err =se
-00029da0: 6c66 2e7a 4153 5b77 6774 5d2e 746f 5f6e  lf.zAS[wgt].to_n
-00029db0: 756d 7079 2829 0d0a 2020 2020 2020 2020  umpy()..        
-00029dc0: 2020 2020 2020 2020 6966 2077 6774 203d          if wgt =
-00029dd0: 3d20 275a 2e6d 6167 2720 3a20 7a61 6273  = 'Z.mag' : zabs
-00029de0: 5f61 7272 6179 203d 7365 6c66 2e7a 4153  _array =self.zAS
-00029df0: 5b77 6774 5d2e 746f 5f6e 756d 7079 2829  [wgt].to_numpy()
-00029e00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029e10: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00029e20: 2020 2020 0d0a 2020 2020 2020 2020 7472      ..        tr
-00029e30: 7920 3a20 0d0a 2020 2020 2020 2020 2020  y : ..          
-00029e40: 2020 7365 6c66 2e6e 6672 6571 202c 2073    self.nfreq , s
-00029e50: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-00029e60: 6174 696f 6e73 203d 6e70 2e69 6e74 2873  ations =np.int(s
-00029e70: 656c 662e 6e66 7265 7129 2c5c 0d0a 2020  elf.nfreq),\..  
-00029e80: 2020 2020 2020 2020 2020 2020 2020 6e70                np
-00029e90: 2e69 6e74 2873 656c 662e 6e75 6d62 6572  .int(self.number
-00029ea0: 5f6f 665f 7374 6174 696f 6e73 290d 0a20  _of_stations).. 
-00029eb0: 2020 2020 2020 2020 2020 207a 6162 735f             zabs_
-00029ec0: 6172 7261 793d 6e70 2e61 7272 6179 285b  array=np.array([
-00029ed0: 6e70 2e66 6c6f 6174 2863 6329 2066 6f72  np.float(cc) for
-00029ee0: 2063 6320 696e 207a 6162 735f 6172 7261   cc in zabs_arra
-00029ef0: 795d 290d 0a20 2020 2020 2020 2065 7863  y])..        exc
-00029f00: 6570 7420 3a0d 0a20 2020 2020 2020 2020  ept :..         
-00029f10: 2020 2072 6169 7365 2043 5365 782e 7079     raise CSex.py
-00029f20: 4353 414d 5445 7272 6f72 5f76 616c 7565  CSAMTError_value
-00029f30: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00029f40: 2020 2022 5661 6c75 6573 2070 726f 7669     "Values provi
-00029f50: 6465 6420 666f 7220 5a2d 6173 7461 7469  ded for Z-astati
-00029f60: 6320 6172 6520 7772 6f6e 672e 220d 0a20  c are wrong.".. 
-00029f70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00029f80: 2063 6865 636b 2079 6f75 7220 5a6f 6e67   check your Zong
-00029f90: 6520 4156 4720 6669 6c65 202e 2229 2020  e AVG file .")  
-00029fa0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00029fb0: 0d0a 2020 0d0a 2020 2020 2020 2020 7365  ..  ..        se
-00029fc0: 6c66 2e6d 6178 2c20 7365 6c66 2e6d 696e  lf.max, self.min
-00029fd0: 203d 7a61 6273 5f61 7272 6179 2e6d 6178   =zabs_array.max
-00029fe0: 2829 2c20 7a61 6273 5f61 7272 6179 2e6d  (), zabs_array.m
-00029ff0: 696e 2829 0d0a 2020 2020 2020 2020 0d0a  in()..        ..
-0002a000: 2020 2020 2020 2020 7472 756e 6361 7465          truncate
-0002a010: 645f 7a7a 3d5a 6363 2e74 7275 6e63 6174  d_zz=Zcc.truncat
-0002a020: 6564 5f64 6174 6128 2064 6174 6120 3d7a  ed_data( data =z
-0002a030: 6162 735f 6172 7261 792c 200d 0a20 2020  abs_array, ..   
-0002a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a060: 2020 2020 6e75 6d62 6572 5f6f 665f 7265      number_of_re
-0002a070: 6363 7572 656e 6365 3d73 656c 662e 6e66  ccurence=self.nf
-0002a080: 7265 7129 0d0a 2020 2020 2020 2020 6e61  req)..        na
-0002a090: 6d65 2c20 706f 6c79 6e61 6d65 203d 205a  me, polyname = Z
-0002a0a0: 6363 2e5f 6e75 6d62 6572 696e 675f 7374  cc._numbering_st
-0002a0b0: 6174 696f 6e28 0d0a 2020 2020 2020 2020  ation(..        
-0002a0c0: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
-0002a0d0: 6174 696f 6e3d 7365 6c66 2e6e 756d 6265  ation=self.numbe
-0002a0e0: 725f 6f66 5f73 7461 7469 6f6e 732c 200d  r_of_stations, .
-0002a0f0: 0a20 2020 2020 2020 2020 2020 2020 6e75  .             nu
-0002a100: 6d62 6572 5f6f 665f 6672 6571 203d 7365  mber_of_freq =se
-0002a110: 6c66 2e6e 6672 6571 290d 0a20 2020 2020  lf.nfreq)..     
-0002a120: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-0002a130: 662e 6c6f 6320 3d7b 206b 6579 3a76 616c  f.loc ={ key:val
-0002a140: 7565 2066 6f72 206b 6579 2c20 7661 6c75  ue for key, valu
-0002a150: 6520 696e 207a 6970 286e 616d 652c 2074  e in zip(name, t
-0002a160: 7275 6e63 6174 6564 5f7a 7a20 297d 0d0a  runcated_zz )}..
-0002a170: 2020 2020 2020 2020 0d0a 0d0a 636c 6173          ....clas
-0002a180: 7320 7063 456d 6167 2028 6f62 6a65 6374  s pcEmag (object
-0002a190: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-0002a1a0: 2053 7461 7469 7374 6963 616c 2076 6172   Statistical var
-0002a1b0: 6961 7469 6f6e 206f 6620 6d61 676e 6974  iation of magnit
-0002a1c0: 7564 6520 7661 6c75 6573 2066 726f 6d20  ude values from 
-0002a1d0: 0d0a 2020 2020 6176 6572 6167 6564 2064  ..    averaged d
-0002a1e0: 6174 6120 626c 6f63 6b73 2e0d 0a20 2020  ata blocks...   
-0002a1f0: 200d 0a20 2020 2053 7461 6e64 6172 6420   ..    Standard 
-0002a200: 4465 7669 6174 696f 6e2f 4176 6572 6167  Deviation/Averag
-0002a210: 6520 456d 6167 2028 7065 7263 656e 7429  e Emag (percent)
-0002a220: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0002a230: 4172 6775 6d65 6e74 7320 0d0a 2020 2020  Arguments ..    
-0002a240: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-0002a250: 2020 2020 2a2a 7063 456d 6167 2a2a 203a      **pcEmag** :
-0002a260: 206e 6461 7272 6179 0d0a 2020 2020 2020   ndarray..      
-0002a270: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0002a280: 7461 2061 7272 6179 206f 6620 7374 6174  ta array of stat
-0002a290: 6973 7469 6361 6c20 7661 7269 6174 6169  istical variatai
-0002a2a0: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
-0002a2b0: 2020 2020 2020 2020 6f66 2045 6d61 6720          of Emag 
-0002a2c0: 7661 6c75 6520 6f6e 2074 6865 2066 6965  value on the fie
-0002a2d0: 6c64 2e0d 0a20 2020 2020 2020 2020 2020  ld...           
-0002a2e0: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
-0002a2f0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-0002a300: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-0002a310: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002a320: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002a330: 3d3d 0d0a 2020 2020 4174 7472 6962 7574  ==..    Attribut
-0002a340: 6573 2020 2020 2020 2020 2054 7970 6520  es         Type 
-0002a350: 2020 2020 2020 2045 7870 6c61 6e61 7469         Explanati
-0002a360: 6f6e 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d  on..    ========
-0002a370: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-0002a380: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
-0002a390: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002a3a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002a3b0: 3d3d 3d0d 0a20 2020 2076 616c 7565 2020  ===..    value  
-0002a3c0: 2020 2020 2020 2020 2020 206e 642e 6172             nd.ar
-0002a3d0: 7261 7920 2020 2020 2064 6174 6120 6f66  ray      data of
-0002a3e0: 2070 6345 6d61 6720 2063 6f6c 756d 6e20   pcEmag  column 
-0002a3f0: 2020 6f6e 2061 7667 6669 6c65 0d0a 2020    on avgfile..  
-0002a400: 2020 6d61 7820 2020 2020 2020 2020 2020    max           
-0002a410: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
-0002a420: 2020 6d61 7869 6d75 6d20 2520 7661 6c75    maximum % valu
-0002a430: 6520 6f66 2070 6320 456d 6167 0d0a 2020  e of pc Emag..  
-0002a440: 2020 6d69 6e20 2020 2020 2020 2020 2020    min           
-0002a450: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
-0002a460: 2020 6d69 6e69 6d75 6d20 2520 7661 6c75    minimum % valu
-0002a470: 6520 6f66 2070 6345 6d61 6720 0d0a 2020  e of pcEmag ..  
-0002a480: 2020 6c6f 6320 2020 2020 2020 2020 2020    loc           
-0002a490: 2020 2020 6469 6374 2020 2020 2020 2020      dict        
-0002a4a0: 2020 6c6f 6361 7469 6f6e 206f 6620 2545    location of %E
-0002a4b0: 7068 7a20 6d61 676e 6974 7564 650d 0a20  phz magnitude.. 
-0002a4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a4e0: 2020 2076 616c 7565 2061 7420 7468 6520     value at the 
-0002a4f0: 7374 6174 696f 6e20 6c61 6d62 6461 2065  station lambda e
-0002a500: 3a67 202e 6c6f 635b 2753 3035 275d 0d0a  :g .loc['S05']..
-0002a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a530: 2020 2020 7368 6f77 2074 6865 2063 7572      show the cur
-0002a540: 7265 6e74 2020 482d 6d61 6720 6461 7461  rent  H-mag data
-0002a550: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0002a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a570: 2020 2020 2020 206f 6620 7374 6174 696f         of statio
-0002a580: 6e20 6174 2053 3035 2e0d 0a20 2020 203d  n at S05...    =
-0002a590: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
-0002a5a0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d   ===========  ==
-0002a5b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002a5c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002a5d0: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a 2020  ==========....  
-0002a5e0: 2020 4d6f 7265 2061 7474 7269 6275 7465    More attribute
-0002a5f0: 7320 6361 6e20 6265 2061 6464 6564 2062  s can be added b
-0002a600: 7920 696e 7075 7469 6e67 2061 206b 6579  y inputing a key
-0002a610: 2077 6f72 6420 6469 6374 696f 6e61 7279   word dictionary
-0002a620: 0d0a 2020 2020 0d0a 2020 2020 3a45 7861  ..    ..    :Exa
-0002a630: 6d70 6c65 3a0d 0a20 2020 2020 2020 200d  mple:..        .
-0002a640: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
-0002a650: 6d20 7079 6373 616d 742e 6666 2e63 6f72  m pycsamt.ff.cor
-0002a660: 652e 6176 6720 696d 706f 7274 2041 7667  e.avg import Avg
-0002a670: 200d 0a20 2020 2020 2020 203e 3e3e 2070   ..        >>> p
-0002a680: 6174 683d 6f73 2e70 6174 682e 6a6f 696e  ath=os.path.join
-0002a690: 286f 732e 656e 7669 726f 6e5b 2270 7943  (os.environ["pyC
-0002a6a0: 5341 4d54 225d 2c20 0d0a 2020 2020 2020  SAMT"], ..      
-0002a6b0: 2020 2e2e 2e20 2020 2020 2027 7079 6373    ...      'pycs
-0002a6c0: 616d 7427 2c20 2264 6174 6122 2c20 224b  amt', "data", "K
-0002a6d0: 312e 4156 4722 290d 0a20 2020 2020 2020  1.AVG")..       
-0002a6e0: 203e 3e3e 2061 7667 5f6f 626a 3d41 7667   >>> avg_obj=Avg
-0002a6f0: 2870 6174 6829 0d0a 2020 2020 2020 2020  (path)..        
-0002a700: 3e3e 3e20 7063 656d 6167 5f6f 626a 203d  >>> pcemag_obj =
-0002a710: 6176 675f 6f62 6a2e 4461 7461 5f73 6563  avg_obj.Data_sec
-0002a720: 7469 6f6e 2e70 6345 6d61 672e 6c6f 635b  tion.pcEmag.loc[
-0002a730: 2753 3035 275d 0d0a 2020 2020 2020 2020  'S05']..        
-0002a740: 3e3e 3e20 7072 696e 7428 7063 656d 6167  >>> print(pcemag
-0002a750: 5f6f 626a 290d 0a20 2020 2022 2222 0d0a  _obj)..    """..
-0002a760: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0002a770: 2873 656c 662c 2070 635f 655f 6d61 675f  (self, pc_e_mag_
-0002a780: 6172 7261 793d 4e6f 6e65 2c20 0d0a 2020  array=None, ..  
-0002a790: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0002a7a0: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
-0002a7b0: 6369 6573 3d4e 6f6e 6520 2c20 6e75 6d62  cies=None , numb
-0002a7c0: 6572 5f6f 665f 7374 6174 696f 6e73 3d4e  er_of_stations=N
-0002a7d0: 6f6e 6520 2c20 0d0a 2020 2020 2020 2020  one , ..        
-0002a7e0: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-0002a7f0: 7329 3a0d 0a20 2020 2020 2020 200d 0a20  s):..        .. 
-0002a800: 2020 2020 2020 2073 656c 662e 5f70 6345         self._pcE
-0002a810: 6d61 6720 3d70 635f 655f 6d61 675f 6172  mag =pc_e_mag_ar
-0002a820: 7261 790d 0a20 2020 2020 2020 200d 0a20  ray..        .. 
-0002a830: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
-0002a840: 6572 5f6f 665f 7374 6174 696f 6e73 203d  er_of_stations =
-0002a850: 6b77 6172 6773 2e70 6f70 2822 6e75 6d62  kwargs.pop("numb
-0002a860: 6572 5f6f 665f 7374 6174 696f 6e73 222c  er_of_stations",
-0002a870: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
-0002a880: 7365 6c66 2e6e 6672 6571 203d 6b77 6172  self.nfreq =kwar
-0002a890: 6773 2e70 6f70 2827 6e75 6d62 6572 5f6f  gs.pop('number_o
-0002a8a0: 665f 6672 6571 7565 6e63 6965 7327 2c20  f_frequencies', 
-0002a8b0: 4e6f 6e65 290d 0a20 2020 2020 2020 200d  None)..        .
-0002a8c0: 0a20 2020 2020 2020 2073 656c 662e 7661  .        self.va
-0002a8d0: 6c75 6520 3d4e 6f6e 6520 0d0a 2020 2020  lue =None ..    
-0002a8e0: 2020 2020 7365 6c66 2e6d 696e 203d 204e      self.min = N
-0002a8f0: 6f6e 6520 0d0a 2020 2020 2020 2020 7365  one ..        se
-0002a900: 6c66 2e6d 6178 203d 204e 6f6e 6520 0d0a  lf.max = None ..
-0002a910: 2020 2020 0d0a 2020 2020 2020 2020 666f      ..        fo
-0002a920: 7220 6b65 7920 696e 206c 6973 7428 6b77  r key in list(kw
-0002a930: 6172 6773 2e6b 6579 7328 2929 3a0d 0a20  args.keys()):.. 
-0002a940: 2020 2020 2020 2020 2020 2073 6574 6174             setat
-0002a950: 7472 2873 656c 662c 206b 6579 2c20 6b77  tr(self, key, kw
-0002a960: 6172 6773 5b6b 6579 5d29 0d0a 2020 2020  args[key])..    
-0002a970: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0002a980: 2020 6966 2073 656c 662e 5f70 6345 6d61    if self._pcEma
-0002a990: 6720 2069 7320 6e6f 7420 4e6f 6e65 203a  g  is not None :
-0002a9a0: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-0002a9b0: 656c 662e 5f72 6561 645f 7063 456d 6167  elf._read_pcEmag
-0002a9c0: 5f64 6174 6120 2829 0d0a 2020 2020 2020  _data ()..      
-0002a9d0: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
-0002a9e0: 2020 6465 6620 5f72 6561 645f 7063 456d    def _read_pcEm
-0002a9f0: 6167 5f64 6174 6120 2873 656c 662c 7063  ag_data (self,pc
-0002aa00: 5f65 5f6d 6167 5f61 7272 6179 3d4e 6f6e  _e_mag_array=Non
-0002aa10: 652c 206e 756d 6265 725f 6f66 5f66 7265  e, number_of_fre
-0002aa20: 7175 656e 6369 6573 3d4e 6f6e 6520 2c20  quencies=None , 
-0002aa30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002aa40: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-0002aa50: 725f 6f66 5f73 7461 7469 6f6e 733d 4e6f  r_of_stations=No
-0002aa60: 6e65 2029 3a0d 0a20 2020 2020 2020 2022  ne ):..        "
-0002aa70: 2222 0d0a 2020 2020 2020 2020 4d65 7468  ""..        Meth
-0002aa80: 6f64 2074 6f20 7265 6164 2061 6e64 2061  od to read and a
-0002aa90: 7261 6e67 6520 6461 7461 2061 6363 6f72  range data accor
-0002aaa0: 6469 6e67 2065 6163 6820 7374 6174 696f  ding each statio
-0002aab0: 6e20 2f53 7461 7469 7374 6963 616c 200d  n /Statistical .
-0002aac0: 0a20 2020 2020 2020 2020 2020 7661 7269  .           vari
-0002aad0: 6174 696f 6e20 6f66 2020 452d 4669 656c  ation of  E-Fiel
-0002aae0: 6420 6d61 676e 6974 7564 6520 7661 6c75  d magnitude valu
-0002aaf0: 6573 202e 0d0a 2020 2020 2020 2020 0d0a  es ...        ..
-0002ab00: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0002ab10: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-0002ab20: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0002ab30: 2020 2020 2a20 7063 5f65 5f6d 6167 5f61      * pc_e_mag_a
-0002ab40: 7272 6179 203a 206e 6461 7272 6179 2c20  rray : ndarray, 
-0002ab50: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0002ab60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab70: 2020 2020 2020 2020 2020 452d 4669 656c            E-Fiel
-0002ab80: 6420 7374 6420 7661 7269 6174 696f 6e20  d std variation 
-0002ab90: 206f 6273 6572 7665 6420 6174 2065 6163   observed at eac
-0002aba0: 6820 7374 6174 696f 6e2e 0d0a 2020 2020  h station...    
-0002abb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002abc0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0002abd0: 6465 6661 756c 7420 6973 204e 6f6e 652e  default is None.
-0002abe0: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-0002abf0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
-0002ac00: 6e63 6965 7320 3a20 696e 7420 2c20 6f70  ncies : int , op
-0002ac10: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0002ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ac30: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-0002ac40: 6572 206f 6620 6672 6571 7565 6e63 6965  er of frequencie
-0002ac50: 7320 666f 7220 7375 7276 6579 2e20 0d0a  s for survey. ..
-0002ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ac70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ac80: 2020 2020 5468 6520 6465 6661 756c 7420      The default 
-0002ac90: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
-0002aca0: 2020 2020 2020 2a20 6e75 6d62 6572 5f6f        * number_o
-0002acb0: 665f 7374 6174 696f 6e73 203a 2069 6e74  f_stations : int
-0002acc0: 202c 206f 7074 696f 6e61 6c0d 0a20 2020   , optional..   
-0002acd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ace0: 2020 2020 2020 2020 2020 2020 206e 756d               num
-0002acf0: 6265 725f 6f66 2073 7461 7469 6f6e 732e  ber_of stations.
-0002ad00: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
-0002ad10: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2022  None...        "
-0002ad20: 2222 0d0a 2020 2020 2020 2020 6966 2070  ""..        if p
-0002ad30: 635f 655f 6d61 675f 6172 7261 7920 6973  c_e_mag_array is
-0002ad40: 206e 6f74 204e 6f6e 6520 3a20 0d0a 2020   not None : ..  
-0002ad50: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0002ad60: 7063 456d 6167 203d 7063 5f65 5f6d 6167  pcEmag =pc_e_mag
-0002ad70: 5f61 7272 6179 200d 0a20 2020 2020 2020  _array ..       
-0002ad80: 2069 6620 7365 6c66 2e5f 7063 456d 6167   if self._pcEmag
-0002ad90: 2069 7320 4e6f 6e65 203a 200d 0a20 2020   is None : ..   
-0002ada0: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
-0002adb0: 5365 782e 7079 4353 414d 5445 7272 6f72  Sex.pyCSAMTError
-0002adc0: 5f69 6e70 7574 6172 6775 6d65 6e74 7328  _inputarguments(
-0002add0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002ade0: 2020 274e 6f20 452d 6d61 6720 7374 6174    'No E-mag stat
-0002adf0: 6973 7469 6361 6c20 7661 7269 6174 696f  istical variatio
-0002ae00: 6e20 2064 6174 6120 666f 756e 6420 2021  n  data found  !
-0002ae10: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0002ae20: 0d0a 2020 2020 2020 2020 6966 206e 756d  ..        if num
-0002ae30: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-0002ae40: 6573 2069 7320 6e6f 7420 4e6f 6e65 203a  es is not None :
-0002ae50: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-0002ae60: 656c 662e 6e66 7265 7120 3d6e 756d 6265  elf.nfreq =numbe
-0002ae70: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
-0002ae80: 200d 0a20 2020 2020 2020 2065 6c73 6520   ..        else 
-0002ae90: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0002aea0: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-0002aeb0: 5445 7272 6f72 5f69 6e70 7574 6172 6775  TError_inputargu
-0002aec0: 6d65 6e74 7328 0d0a 2020 2020 2020 2020  ments(..        
-0002aed0: 2020 2020 2020 2020 2250 6c65 6173 6520          "Please 
-0002aee0: 7370 6563 6966 7920 7468 6520 6e75 6d62  specify the numb
-0002aef0: 6572 206f 6620 6672 6571 7565 6e63 7920  er of frequency 
-0002af00: 2122 290d 0a20 2020 2020 2020 2069 6620  !")..        if 
-0002af10: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-0002af20: 6e73 2069 7320 6e6f 7420 4e6f 6e65 203a  ns is not None :
-0002af30: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-0002af40: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-0002af50: 6174 696f 6e73 203d 6e75 6d62 6572 5f6f  ations =number_o
-0002af60: 665f 7374 6174 696f 6e73 200d 0a20 2020  f_stations ..   
-0002af70: 2020 2020 2065 6c73 6520 3a20 7261 6973       else : rais
-0002af80: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-0002af90: 726f 725f 696e 7075 7461 7267 756d 656e  ror_inputargumen
-0002afa0: 7473 280d 0a20 2020 2020 2020 2020 2020  ts(..           
-0002afb0: 2027 506c 6561 7365 2073 7065 6369 6679   'Please specify
-0002afc0: 2074 6865 206e 756d 6265 7220 6f66 2073   the number of s
-0002afd0: 7461 7469 6f6e 7327 290d 0a20 2020 2020  tations')..     
-0002afe0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0002aff0: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
-0002b000: 2020 2020 2073 656c 662e 6e66 7265 7120       self.nfreq 
-0002b010: 2c20 7365 6c66 2e6e 756d 6265 725f 6f66  , self.number_of
-0002b020: 5f73 7461 7469 6f6e 7320 3d6e 702e 696e  _stations =np.in
-0002b030: 7428 7365 6c66 2e6e 6672 6571 292c 5c0d  t(self.nfreq),\.
-0002b040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b050: 206e 702e 696e 7428 7365 6c66 2e6e 756d   np.int(self.num
-0002b060: 6265 725f 6f66 5f73 7461 7469 6f6e 7329  ber_of_stations)
-0002b070: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0002b080: 6c66 2e5f 7063 456d 6167 3d6e 702e 6172  lf._pcEmag=np.ar
-0002b090: 7261 7928 5b6e 702e 666c 6f61 7428 6363  ray([np.float(cc
-0002b0a0: 2920 666f 7220 6363 2069 6e20 7365 6c66  ) for cc in self
-0002b0b0: 2e5f 7063 456d 6167 5d29 0d0a 0d0a 2020  ._pcEmag])....  
-0002b0c0: 2020 2020 2020 6578 6365 7074 203a 2072        except : r
-0002b0d0: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-0002b0e0: 5445 7272 6f72 5f76 616c 7565 280d 0a20  TError_value(.. 
-0002b0f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002b100: 5661 6c75 6573 2070 726f 7669 6465 6420  Values provided 
-0002b110: 666f 7220 7468 6520 452d 6d61 6720 7374  for the E-mag st
-0002b120: 6174 2e76 6172 6961 7469 6f6e 2020 6172  at.variation  ar
-0002b130: 6520 7772 6f6e 672e 220d 0a20 2020 2020  e wrong."..     
-0002b140: 2020 2020 2020 2020 2020 2022 206d 7573             " mus
-0002b150: 7420 6265 2066 6c6f 6174 206f 7220 696e  t be float or in
-0002b160: 7465 6765 7220 2e22 290d 0a20 2020 2020  teger .")..     
-0002b170: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0002b180: 2076 636f 756e 7473 5f45 6d61 672c 2072   vcounts_Emag, r
-0002b190: 6570 6561 745f 456d 6167 203d 6e70 2e75  epeat_Emag =np.u
-0002b1a0: 6e69 7175 6520 2873 656c 662e 5f70 6345  nique (self._pcE
-0002b1b0: 6d61 672c 2072 6574 7572 6e5f 636f 756e  mag, return_coun
-0002b1c0: 7473 3d54 7275 6529 0d0a 2020 2020 2020  ts=True)..      
-0002b1d0: 2020 7365 6c66 2e76 616c 7565 203d 7663    self.value =vc
-0002b1e0: 6f75 6e74 735f 456d 6167 0d0a 2020 2020  ounts_Emag..    
-0002b1f0: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
-0002b200: 6c66 2e6d 6178 2c20 7365 6c66 2e6d 696e  lf.max, self.min
-0002b210: 203d 7663 6f75 6e74 735f 456d 6167 2e6d   =vcounts_Emag.m
-0002b220: 6178 2829 2c20 7663 6f75 6e74 735f 456d  ax(), vcounts_Em
-0002b230: 6167 2e6d 696e 2829 0d0a 2020 2020 2020  ag.min()..      
-0002b240: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
-0002b250: 2020 2020 2020 7472 756e 6361 7465 645f        truncated_
-0002b260: 7063 456d 6167 3d5a 6363 2e74 7275 6e63  pcEmag=Zcc.trunc
-0002b270: 6174 6564 5f64 6174 6128 2064 6174 6120  ated_data( data 
-0002b280: 3d73 656c 662e 5f70 6345 6d61 672c 200d  =self._pcEmag, .
-0002b290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b2b0: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-0002b2c0: 665f 7265 6363 7572 656e 6365 3d73 656c  f_reccurence=sel
-0002b2d0: 662e 6e66 7265 7129 0d0a 2020 2020 2020  f.nfreq)..      
-0002b2e0: 2020 6e61 6d65 2c20 706f 6c79 6e61 6d65    name, polyname
-0002b2f0: 203d 205a 6363 2e5f 6e75 6d62 6572 696e   = Zcc._numberin
-0002b300: 675f 7374 6174 696f 6e28 0d0a 2020 2020  g_station(..    
-0002b310: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-0002b320: 665f 7374 6174 696f 6e3d 7365 6c66 2e6e  f_station=self.n
-0002b330: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-0002b340: 732c 200d 0a20 2020 2020 2020 2020 2020  s, ..           
-0002b350: 206e 756d 6265 725f 6f66 5f66 7265 7120   number_of_freq 
-0002b360: 3d73 656c 662e 6e66 7265 7129 0d0a 2020  =self.nfreq)..  
-0002b370: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002b380: 7365 6c66 2e6c 6f63 203d 7b20 6b65 793a  self.loc ={ key:
-0002b390: 7661 6c75 6520 666f 7220 6b65 792c 2076  value for key, v
-0002b3a0: 616c 7565 2069 6e20 7a69 7028 6e61 6d65  alue in zip(name
-0002b3b0: 2c20 7472 756e 6361 7465 645f 7063 456d  , truncated_pcEm
-0002b3c0: 6167 297d 0d0a 2020 2020 2020 2020 0d0a  ag)}..        ..
-0002b3d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0002b3e0: 2020 0d0a 636c 6173 7320 7345 7068 7a28    ..class sEphz(
-0002b3f0: 6f62 6a65 6374 2920 3a20 0d0a 2020 2020  object) : ..    
-0002b400: 2222 220d 0a20 2020 2053 7461 7469 7374  """..    Statist
-0002b410: 6963 616c 2076 6172 6961 7469 6f6e 206f  ical variation o
-0002b420: 6620 7468 6520 6461 7461 2062 6c6f 636b  f the data block
-0002b430: 7320 6176 6572 6167 6564 2066 6f72 2074  s averaged for t
-0002b440: 6869 7320 6461 7461 2070 6f69 6e74 2e0d  his data point..
-0002b450: 0a20 2020 2031 3030 202a 2053 7461 6e64  .    100 * Stand
-0002b460: 6172 6420 4465 7669 6174 696f 6e20 6f66  ard Deviation of
-0002b470: 2045 7068 7a20 7661 6c75 6573 2028 6d69   Ephz values (mi
-0002b480: 6c6c 6972 6164 6961 6e73 290d 0a20 2020  lliradians)..   
-0002b490: 2020 2020 200d 0a20 2020 2041 7267 756d       ..    Argum
-0002b4a0: 656e 7473 200d 0a20 2020 202d 2d2d 2d2d  ents ..    -----
-0002b4b0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
-0002b4c0: 2a73 4570 687a 2a2a 2020 3a20 6e64 6172  *sEphz**  : ndar
-0002b4d0: 7261 792c 0d0a 2020 2020 2020 2020 2020  ray,..          
-0002b4e0: 2020 2020 2020 2020 2064 6174 6120 6172           data ar
-0002b4f0: 7261 7920 6f66 2073 7461 7469 7374 6963  ray of statistic
-0002b500: 616c 2076 6172 6961 7469 6f6e 206f 6620  al variation of 
-0002b510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002b520: 2020 2020 2045 7068 6173 6520 7661 6c75       Ephase valu
-0002b530: 6520 6f6e 2074 6865 2066 6965 6c64 2e0d  e on the field..
-0002b540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b550: 2020 200d 0a20 2020 203d 3d3d 3d3d 3d3d     ..    =======
-0002b560: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-0002b570: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-0002b580: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002b590: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002b5a0: 3d3d 3d3d 0d0a 2020 2020 4174 7472 6962  ====..    Attrib
-0002b5b0: 7574 6573 2020 2020 2020 2020 2054 7970  utes         Typ
-0002b5c0: 6520 2020 2020 2020 2045 7870 6c61 6e61  e        Explana
-0002b5d0: 7469 6f6e 0d0a 2020 2020 3d3d 3d3d 3d3d  tion..    ======
-0002b5e0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-0002b5f0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-0002b600: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002b610: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002b620: 3d3d 3d3d 3d0d 0a20 2020 2076 616c 7565  =====..    value
-0002b630: 2020 2020 2020 2020 2020 2020 206e 642e               nd.
-0002b640: 6172 7261 7920 2020 2020 2064 6174 6120  array      data 
-0002b650: 6f66 2073 4870 687a 2020 636f 6c75 6d6e  of sHphz  column
-0002b660: 2020 6f6e 2061 7667 6669 6c65 2020 200d    on avgfile   .
-0002b670: 0a20 2020 206d 6178 2020 2020 2020 2020  .    max        
-0002b680: 2020 2020 2020 2066 6c6f 6174 2020 2020         float    
-0002b690: 2020 2020 206d 6178 696d 756d 2025 2076       maximum % v
-0002b6a0: 616c 7565 206f 6620 7348 7068 7a0d 0a20  alue of sHphz.. 
-0002b6b0: 2020 206d 696e 2020 2020 2020 2020 2020     min          
-0002b6c0: 2020 2020 2066 6c6f 6174 2020 2020 2020       float      
-0002b6d0: 2020 206d 696e 696d 756d 2020 7661 6c75     minimum  valu
-0002b6e0: 6520 6f66 2073 4870 687a 0d0a 2020 2020  e of sHphz..    
-0002b6f0: 6c6f 6320 2020 2020 2020 2020 2020 2020  loc             
-0002b700: 2020 6469 6374 2020 2020 2020 2020 2020    dict          
-0002b710: 6c6f 6361 7469 6f6e 206f 6620 7348 7068  location of sHph
-0002b720: 7a20 6d61 676e 6974 7564 650d 0a20 2020  z magnitude..   
-0002b730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b750: 2076 616c 7565 2061 7420 7468 6520 7374   value at the st
-0002b760: 6174 696f 6e20 6c61 6d62 6461 0d0a 2020  ation lambda..  
-0002b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b790: 2020 652e 6720 3a20 6c6f 635b 2753 3434    e.g : loc['S44
-0002b7a0: 275d 2073 686f 7720 7468 6520 0d0a 2020  '] show the ..  
-0002b7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025840: 2020 7472 756e 6361 7465 645f 7372 6573    truncated_sres
+00025850: 2029 7d0d 0a0d 0a20 2020 2020 2020 0d0a   )}....       ..
+00025860: 636c 6173 7320 5068 6173 6520 286f 626a  class Phase (obj
+00025870: 6563 7429 3a20 0d0a 2020 2020 2222 220d  ect): ..    """.
+00025880: 0a20 2020 2049 6d70 6564 616e 6365 2070  .    Impedance p
+00025890: 6861 7365 2020 6f6e 206d 696c 6c69 5261  hase  on milliRa
+000258a0: 6469 616e 7320 6361 6e20 6265 2063 616c  dians can be cal
+000258b0: 6375 6c61 7465 2075 7369 6e67 2045 7068  culate using Eph
+000258c0: 7a0d 0a20 2020 2020 6f62 6a65 6374 2061  z..     object a
+000258d0: 6e64 2048 7068 7a20 6f62 6a65 6374 200d  nd Hphz object .
+000258e0: 0a20 2020 2020 0d0a 2020 2020 2020 2020  .     ..        
+000258f0: 202a 202a 2a50 6861 7365 2a2a 203d 2045   * **Phase** = E
+00025900: 2d70 6861 7365 202d 2048 2d70 6861 7365  -phase - H-phase
+00025910: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00025920: 4172 6775 6d65 6e74 7320 0d0a 2020 2020  Arguments ..    
+00025930: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00025940: 2020 2020 2a2a 7068 6173 655f 6172 7261      **phase_arra
+00025950: 792a 2a20 203a 206e 6461 7272 6179 0d0a  y**  : ndarray..
+00025960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025970: 2020 2020 2020 2020 6172 7261 7920 6f66          array of
+00025980: 2070 6861 7365 2076 616c 7565 7320 676f   phase values go
+00025990: 7420 6f6e 2074 6865 2066 6965 6c64 0d0a  t on the field..
+000259a0: 2020 2020 2020 2020 202a 2a74 6f5f 6465           **to_de
+000259b0: 6772 6565 2a2a 203a 2062 6f6f 6c20 0d0a  gree** : bool ..
+000259c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000259d0: 2020 2020 2020 2020 7075 7420 7468 6520          put the 
+000259e0: 5068 6173 6520 7661 6c75 6520 6f6e 2064  Phase value on d
+000259f0: 6567 7265 6520 2e20 0d0a 2020 2020 2020  egree . ..      
+00025a00: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00025a10: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+00025a20: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  ==  =========== 
+00025a30: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00025a40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00025a50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
+00025a60: 2020 2041 7474 7269 6275 7465 7320 2020     Attributes   
+00025a70: 2020 2020 2020 5479 7065 2020 2020 2020        Type      
+00025a80: 2020 4578 706c 616e 6174 696f 6e0d 0a20    Explanation.. 
+00025a90: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
+00025aa0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
+00025ab0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+00025ac0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00025ad0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+00025ae0: 2020 2020 7661 6c75 6520 2020 2020 2020      value       
+00025af0: 2020 2020 2020 6e64 2e61 7272 6179 2020        nd.array  
+00025b00: 2020 2020 6461 7461 206f 6620 7068 6173      data of phas
+00025b10: 6520 2063 6f6c 756d 6e20 200d 0a20 2020  e  column  ..   
+00025b20: 206d 6178 2020 2020 2020 2020 2020 2020   max            
+00025b30: 2020 2066 6c6f 6174 2020 2020 2020 2020     float        
+00025b40: 206d 6178 696d 756d 2070 6861 7365 2076   maximum phase v
+00025b50: 616c 7565 2028 6d72 6164 290d 0a20 2020  alue (mrad)..   
+00025b60: 206d 696e 2020 2020 2020 2020 2020 2020   min            
+00025b70: 2020 2066 6c6f 6174 2020 2020 2020 2020     float        
+00025b80: 206d 696e 696d 756d 2020 5068 6173 6520   minimum  Phase 
+00025b90: 2028 6d72 6164 290d 0a20 2020 206c 6f63   (mrad)..    loc
+00025ba0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00025bb0: 6963 7420 2020 2020 2020 2020 206c 6f63  ict          loc
+00025bc0: 6174 696f 6e20 6f66 2048 2d70 6861 7365  ation of H-phase
+00025bd0: 2020 7661 6c75 6520 2061 7420 7468 6520    value  at the 
+00025be0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00025bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c00: 2020 2020 2020 7374 6174 696f 6e20 6c61        station la
+00025c10: 6d62 6461 202e 2065 3a67 203a 206c 6f63  mbda . e:g : loc
+00025c20: 5b27 5330 3027 5d20 7368 6f77 2074 6865  ['S00'] show the
+00025c30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00025c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c50: 2020 2020 2020 2063 7572 7265 6e74 2070         current p
+00025c60: 6861 7365 2064 6174 6120 6174 2074 6865  hase data at the
+00025c70: 2073 7461 7469 6f6e 2053 3030 0d0a 2020   station S00..  
+00025c80: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+00025c90: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  ==  =========== 
+00025ca0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00025cb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00025cc0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d  =============...
+00025cd0: 0a20 2020 204d 6f72 6520 6174 7472 6962  .    More attrib
+00025ce0: 7574 6573 2063 616e 2062 6520 6164 6465  utes can be adde
+00025cf0: 6420 6279 2069 6e70 7574 696e 6720 6120  d by inputing a 
+00025d00: 6b65 7920 776f 7264 2064 6963 7469 6f6e  key word diction
+00025d10: 6172 790d 0a0d 0a20 2020 203a 4578 616d  ary....    :Exam
+00025d20: 706c 653a 0d0a 2020 2020 2020 2020 200d  ple:..         .
+00025d30: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00025d40: 6d20 7079 6373 616d 742e 636f 7265 2e61  m pycsamt.core.a
+00025d50: 7667 2069 6d70 6f72 7420 4176 6720 0d0a  vg import Avg ..
+00025d60: 2020 2020 2020 2020 3e3e 3e20 7061 7468          >>> path
+00025d70: 3d6f 732e 7061 7468 2e6a 6f69 6e28 6f73  =os.path.join(os
+00025d80: 2e65 6e76 6972 6f6e 5b22 7079 4353 414d  .environ["pyCSAM
+00025d90: 5422 5d2c 200d 0a20 2020 2020 2020 202e  T"], ..        .
+00025da0: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00025db0: 2020 2020 2770 7963 7361 6d74 272c 2022      'pycsamt', "
+00025dc0: 6461 7461 222c 2022 4b31 2e41 5647 2229  data", "K1.AVG")
+00025dd0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6176  ..        >>> av
+00025de0: 675f 6f62 6a3d 4176 6728 7061 7468 290d  g_obj=Avg(path).
+00025df0: 0a20 2020 2020 2020 203e 3e3e 2070 6873  .        >>> phs
+00025e00: 5f6f 626a 203d 6176 675f 6f62 6a2e 4461  _obj =avg_obj.Da
+00025e10: 7461 5f73 6563 7469 6f6e 2e50 6861 7365  ta_section.Phase
+00025e20: 2e6c 6f63 5b27 5330 3027 5d0d 0a20 2020  .loc['S00']..   
+00025e30: 2020 2020 202e 2e2e 2070 7269 6e74 2870       ... print(p
+00025e40: 6873 2e6c 6f63 5b27 5330 3027 5d29 0d0a  hs.loc['S00'])..
+00025e50: 2020 2020 2222 220d 0a20 2020 200d 0a20      """..    .. 
+00025e60: 2020 200d 0a20 2020 2064 6566 205f 5f69     ..    def __i
+00025e70: 6e69 745f 5f28 7365 6c66 2c20 7068 6173  nit__(self, phas
+00025e80: 655f 6172 7261 7920 3d4e 6f6e 652c 6e75  e_array =None,nu
+00025e90: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
+00025ea0: 6965 733d 4e6f 6e65 202c 200d 0a20 2020  ies=None , ..   
+00025eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ec0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
+00025ed0: 7374 6174 696f 6e73 3d4e 6f6e 652c 2020  stations=None,  
+00025ee0: 202a 2a6b 7761 7267 7329 3a0d 0a0d 0a20   **kwargs):.... 
+00025ef0: 2020 2020 2020 2073 656c 662e 5f70 6861         self._pha
+00025f00: 7365 5f61 7272 6179 3d70 6861 7365 5f61  se_array=phase_a
+00025f10: 7272 6179 200d 0a0d 0a20 2020 2020 2020  rray ....       
+00025f20: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00025f30: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+00025f40: 6e73 203d 6b77 6172 6773 2e70 6f70 2822  ns =kwargs.pop("
+00025f50: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+00025f60: 6e73 222c 204e 6f6e 6529 0d0a 2020 2020  ns", None)..    
+00025f70: 2020 2020 7365 6c66 2e6e 6672 6571 203d      self.nfreq =
+00025f80: 6b77 6172 6773 2e70 6f70 2827 6e75 6d62  kwargs.pop('numb
+00025f90: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00025fa0: 7327 2c20 4e6f 6e65 290d 0a20 2020 2020  s', None)..     
+00025fb0: 2020 2073 656c 662e 746f 5f64 6567 7265     self.to_degre
+00025fc0: 6520 3d6b 7761 7267 732e 706f 7028 2774  e =kwargs.pop('t
+00025fd0: 6f5f 6465 6772 6565 272c 2046 616c 7365  o_degree', False
+00025fe0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00025ff0: 2020 2020 2073 656c 662e 7661 6c75 6520       self.value 
+00026000: 3d4e 6f6e 6520 0d0a 2020 2020 2020 2020  =None ..        
+00026010: 7365 6c66 2e6d 696e 203d 204e 6f6e 6520  self.min = None 
+00026020: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+00026030: 6178 203d 204e 6f6e 6520 0d0a 2020 2020  ax = None ..    
+00026040: 0d0a 2020 2020 2020 2020 666f 7220 6b65  ..        for ke
+00026050: 7920 696e 206c 6973 7428 6b77 6172 6773  y in list(kwargs
+00026060: 2e6b 6579 7328 2929 3a0d 0a20 2020 2020  .keys()):..     
+00026070: 2020 2020 2020 2073 6574 6174 7472 2873         setattr(s
+00026080: 656c 662c 206b 6579 2c20 6b77 6172 6773  elf, key, kwargs
+00026090: 5b6b 6579 5d29 0d0a 2020 2020 2020 2020  [key])..        
+000260a0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+000260b0: 2073 656c 662e 5f70 6861 7365 5f61 7272   self._phase_arr
+000260c0: 6179 2069 7320 6e6f 7420 4e6f 6e65 203a  ay is not None :
+000260d0: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+000260e0: 656c 662e 5f72 6561 645f 7265 735f 6461  elf._read_res_da
+000260f0: 7461 2028 290d 0a20 2020 2020 2020 2020  ta ()..         
+00026100: 2020 200d 0a20 2020 0d0a 2020 2020 6465     ..   ..    de
+00026110: 6620 5f72 6561 645f 7068 6173 655f 6461  f _read_phase_da
+00026120: 7461 2028 7365 6c66 2c70 6861 7365 5f61  ta (self,phase_a
+00026130: 7272 6179 203d 4e6f 6e65 2c6e 756d 6265  rray =None,numbe
+00026140: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
+00026150: 3d4e 6f6e 6520 2c20 0d0a 2020 2020 2020  =None , ..      
+00026160: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00026170: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+00026180: 733d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  s=None, **kwargs
+00026190: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
+000261a0: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
+000261b0: 746f 2072 6561 6420 7068 6173 6520 7661  to read phase va
+000261c0: 6c75 6573 206f 6274 6169 6e65 6420 6f6e  lues obtained on
+000261d0: 2074 6865 2073 6974 6573 2e75 6e69 7473   the sites.units
+000261e0: 206f 6e20 6d72 6164 732e 2020 0d0a 2020   on mrads.  ..  
+000261f0: 2020 2020 2020 5a6f 6e67 6520 6b65 6570        Zonge keep
+00026200: 2074 6865 2070 6861 7365 2076 616c 7565   the phase value
+00026210: 7320 6f6e 206d 7261 642e 0d0a 2020 2020  s on mrad...    
+00026220: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+00026230: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00026240: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a    ------------..
+00026250: 2020 2020 2020 2020 2020 2020 2a20 7068              * ph
+00026260: 6173 655f 6172 7261 7920 3a20 6e64 6172  ase_array : ndar
+00026270: 7261 792c 206f 7074 696f 6e61 6c0d 0a20  ray, optional.. 
+00026280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026290: 2020 2020 2020 2020 2020 2070 6861 7365             phase
+000262a0: 2064 6174 6120 6172 6179 206f 6e20 7468   data aray on th
+000262b0: 6520 6669 656c 642e 0d0a 2020 2020 2020  e field...      
+000262c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000262d0: 2020 2020 2020 5468 6520 2a64 6566 6175        The *defau
+000262e0: 6c74 2a20 6973 204e 6f6e 652e 0d0a 2020  lt* is None...  
+000262f0: 2020 2020 2020 2020 2020 2a20 6e75 6d62            * numb
+00026300: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+00026310: 7320 3a20 5459 5045 2c20 6f70 7469 6f6e  s : TYPE, option
+00026320: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
+00026330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026340: 6e75 6d62 6572 206f 6620 6665 7175 656e  number of fequen
+00026350: 6379 2075 7365 6420 2e0d 0a20 2020 2020  cy used ...     
+00026360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026370: 2020 2020 2020 2054 6865 202a 6465 6661         The *defa
+00026380: 756c 742a 2069 7320 4e6f 6e65 2e0d 0a20  ult* is None... 
+00026390: 2020 2020 2020 2020 2020 202a 206e 756d             * num
+000263a0: 6265 725f 6f66 5f73 7461 7469 6f6e 7320  ber_of_stations 
+000263b0: 3a20 696e 742c 206f 7074 696f 6e61 6c0d  : int, optional.
+000263c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000263d0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+000263e0: 6265 7220 6f66 2074 6865 2073 7461 7469  ber of the stati
+000263f0: 6f6e 7320 6f6e 2074 6865 2073 6974 652e  ons on the site.
+00026400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00026410: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+00026420: 6520 2a64 6566 6175 6c74 2a20 6973 204e  e *default* is N
+00026430: 6f6e 652e 0d0a 2020 2020 2020 2020 2222  one...        ""
+00026440: 220d 0a20 2020 200d 0a20 0d0a 2020 2020  "..    .. ..    
+00026450: 2020 2020 746f 5f64 6567 7265 6520 3d6b      to_degree =k
+00026460: 7761 7267 732e 706f 7028 2274 6f5f 6465  wargs.pop("to_de
+00026470: 6772 6565 222c 2046 616c 7365 290d 0a20  gree", False).. 
+00026480: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00026490: 2069 6620 746f 5f64 6567 7265 6520 3a0d   if to_degree :.
+000264a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000264b0: 662e 746f 5f64 6567 7265 6520 3d20 746f  f.to_degree = to
+000264c0: 5f64 6567 7265 650d 0a20 2020 2020 2020  _degree..       
+000264d0: 200d 0a20 2020 2020 2020 2069 6620 7068   ..        if ph
+000264e0: 6173 655f 6172 7261 7920 6973 206e 6f74  ase_array is not
+000264f0: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
+00026500: 2020 2020 2020 7365 6c66 2e5f 7068 6173        self._phas
+00026510: 655f 6172 7261 7920 3d70 6861 7365 5f61  e_array =phase_a
+00026520: 7272 6179 0d0a 2020 2020 2020 2020 6966  rray..        if
+00026530: 2073 656c 662e 5f70 6861 7365 5f61 7272   self._phase_arr
+00026540: 6179 2069 7320 4e6f 6e65 203a 200d 0a20  ay is None : .. 
+00026550: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00026560: 2054 7970 6545 7272 6f72 2827 4e6f 2050   TypeError('No P
+00026570: 6861 7365 2064 6174 6120 666f 756e 6420  hase data found 
+00026580: 2021 2729 0d0a 0d0a 2020 2020 2020 2020   !')....        
+00026590: 6966 206e 756d 6265 725f 6f66 5f66 7265  if number_of_fre
+000265a0: 7175 656e 6369 6573 2069 7320 6e6f 7420  quencies is not 
+000265b0: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+000265c0: 2020 2020 2073 656c 662e 6e66 7265 7120       self.nfreq 
+000265d0: 3d6e 756d 6265 725f 6f66 5f66 7265 7175  =number_of_frequ
+000265e0: 656e 6369 6573 200d 0a20 2020 2020 2020  encies ..       
+000265f0: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
+00026600: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00026610: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00026620: 2020 2020 2020 2022 506c 6561 7365 2073         "Please s
+00026630: 7065 6369 6679 2074 6865 206e 756d 6265  pecify the numbe
+00026640: 7220 6f66 2066 7265 7175 656e 6379 2021  r of frequency !
+00026650: 2229 0d0a 2020 2020 2020 2020 6966 206e  ")..        if n
+00026660: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+00026670: 7320 6973 206e 6f74 204e 6f6e 6520 3a0d  s is not None :.
+00026680: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00026690: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
+000266a0: 696f 6e73 203d 6e75 6d62 6572 5f6f 665f  ions =number_of_
+000266b0: 7374 6174 696f 6e73 200d 0a20 2020 2020  stations ..     
+000266c0: 2020 2065 6c73 6520 3a20 0d0a 2020 2020     else : ..    
+000266d0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+000266e0: 7065 4572 726f 7228 0d0a 2020 2020 2020  peError(..      
+000266f0: 2020 2020 2020 2020 2020 2750 6c65 6173            'Pleas
+00026700: 6520 7370 6563 6966 7920 7468 6520 6e75  e specify the nu
+00026710: 6d62 6572 206f 6620 7374 6174 696f 6e73  mber of stations
+00026720: 2729 0d0a 0d0a 2020 2020 2020 2020 2020  ')....          
+00026730: 2020 0d0a 2020 2020 2020 2020 7472 7920    ..        try 
+00026740: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00026750: 7365 6c66 2e6e 6672 6571 3d6e 702e 696e  self.nfreq=np.in
+00026760: 7428 7365 6c66 2e6e 6672 6571 290d 0a20  t(self.nfreq).. 
+00026770: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00026780: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+00026790: 6e73 203d 6e70 2e69 6e74 2873 656c 662e  ns =np.int(self.
+000267a0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+000267b0: 6e73 290d 0a20 2020 2020 2020 2020 2020  ns)..           
+000267c0: 2073 656c 662e 5f70 6861 7365 5f61 7272   self._phase_arr
+000267d0: 6179 3d6e 702e 6172 7261 7928 5b6e 702e  ay=np.array([np.
+000267e0: 666c 6f61 7428 6363 2920 0d0a 2020 2020  float(cc) ..    
+000267f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026810: 2020 2020 666f 7220 6363 2069 6e20 7365      for cc in se
+00026820: 6c66 2e5f 7068 6173 655f 6172 7261 795d  lf._phase_array]
+00026830: 290d 0a0d 0a20 2020 2020 2020 2065 7863  )....        exc
+00026840: 6570 7420 3a20 0d0a 2020 2020 2020 2020  ept : ..        
+00026850: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00026860: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00026870: 2020 2020 2020 2022 5661 6c75 6573 2070         "Values p
+00026880: 726f 7669 6465 6420 666f 7220 7468 6520  rovided for the 
+00026890: 5068 6173 6520 6172 6520 7772 6f6e 672e  Phase are wrong.
+000268a0: 225c 0d0a 2020 2020 2020 2020 2020 2020  "\..            
+000268b0: 2020 2020 2022 206d 7573 7420 6265 2066       " must be f
+000268c0: 6c6f 6174 206f 7220 696e 7465 6765 7220  loat or integer 
+000268d0: 2e22 290d 0a20 2020 2020 2020 2069 6620  .")..        if 
+000268e0: 7365 6c66 2e74 6f5f 6465 6772 6565 203a  self.to_degree :
+000268f0: 2023 2d2d 2d3e 2073 6574 2061 6e67 6c65   #---> set angle
+00026900: 2074 6f20 6465 6772 6565 202e 0d0a 2020   to degree ...  
+00026910: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00026920: 7068 6173 655f 6172 7261 7920 3d6e 702e  phase_array =np.
+00026930: 6170 706c 795f 616c 6f6e 675f 6178 6973  apply_along_axis
+00026940: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00026950: 2020 2020 6c61 6d62 6461 2070 687a 3a20      lambda phz: 
+00026960: 7068 7a20 2a20 3138 302f 6e70 2e70 692c  phz * 180/np.pi,
+00026970: 2030 2c73 656c 662e 5f70 6861 7365 5f61   0,self._phase_a
+00026980: 7272 6179 2920 2020 2020 2020 200d 0a20  rray)        .. 
+00026990: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000269a0: 2020 2020 200d 0a20 2020 2020 2020 2076       ..        v
+000269b0: 636f 756e 7473 5f70 687a 2c20 7265 7065  counts_phz, repe
+000269c0: 6174 5f70 687a 3d6e 702e 756e 6971 7565  at_phz=np.unique
+000269d0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+000269e0: 7365 6c66 2e5f 7068 6173 655f 6172 7261  self._phase_arra
+000269f0: 792c 2072 6574 7572 6e5f 636f 756e 7473  y, return_counts
+00026a00: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+00026a10: 7365 6c66 2e76 616c 7565 203d 7663 6f75  self.value =vcou
+00026a20: 6e74 735f 7068 7a0d 0a20 2020 2020 2020  nts_phz..       
+00026a30: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00026a40: 6d61 782c 2073 656c 662e 6d69 6e20 3d76  max, self.min =v
+00026a50: 636f 756e 7473 5f70 687a 2e6d 6178 2829  counts_phz.max()
+00026a60: 2c20 7663 6f75 6e74 735f 7068 7a2e 6d69  , vcounts_phz.mi
+00026a70: 6e28 290d 0a20 2020 2020 2020 200d 0a20  n()..        .. 
+00026a80: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00026a90: 2074 7275 6e63 6174 6564 5f70 687a 3d5a   truncated_phz=Z
+00026aa0: 6363 2e74 7275 6e63 6174 6564 5f64 6174  cc.truncated_dat
+00026ab0: 6128 2064 6174 6120 3d73 656c 662e 5f70  a( data =self._p
+00026ac0: 6861 7365 5f61 7272 6179 2c20 0d0a 2020  hase_array, ..  
+00026ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026af0: 2020 2020 206e 756d 6265 725f 6f66 5f72       number_of_r
+00026b00: 6563 6375 7265 6e63 653d 7365 6c66 2e6e  eccurence=self.n
+00026b10: 6672 6571 290d 0a20 2020 2020 2020 206e  freq)..        n
+00026b20: 616d 652c 2070 6f6c 796e 616d 6520 3d20  ame, polyname = 
+00026b30: 5a63 632e 5f6e 756d 6265 7269 6e67 5f73  Zcc._numbering_s
+00026b40: 7461 7469 6f6e 280d 0a20 2020 2020 2020  tation(..       
+00026b50: 2020 2020 206e 756d 6265 725f 6f66 5f73       number_of_s
+00026b60: 7461 7469 6f6e 3d73 656c 662e 6e75 6d62  tation=self.numb
+00026b70: 6572 5f6f 665f 7374 6174 696f 6e73 2c20  er_of_stations, 
+00026b80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00026b90: 2020 6e75 6d62 6572 5f6f 665f 6672 6571    number_of_freq
+00026ba0: 203d 7365 6c66 2e6e 6672 6571 290d 0a20   =self.nfreq).. 
+00026bb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00026bc0: 2073 656c 662e 6c6f 6320 3d7b 206b 6579   self.loc ={ key
+00026bd0: 3a76 616c 7565 2066 6f72 206b 6579 2c20  :value for key, 
+00026be0: 7661 6c75 6520 696e 207a 6970 286e 616d  value in zip(nam
+00026bf0: 652c 2074 7275 6e63 6174 6564 5f70 687a  e, truncated_phz
+00026c00: 2029 7d0d 0a20 2020 2020 2020 2020 2020   )}..           
+00026c10: 200d 0a20 2020 2020 2020 200d 0a63 6c61   ..        ..cla
+00026c20: 7373 205a 5f54 656e 736f 7228 6f62 6a65  ss Z_Tensor(obje
+00026c30: 6374 293a 0d0a 2020 2020 2222 220d 0a20  ct):..    """.. 
+00026c40: 2020 2049 6d70 6564 616e 6365 2054 656e     Impedance Ten
+00026c50: 736f 7220 5a20 4361 6c63 756c 6174 696f  sor Z Calculatio
+00026c60: 6e20 3a20 200d 0a20 2020 2020 2020 636c  n :  ..       cl
+00026c70: 6173 7320 6361 6e20 7265 636f 6d70 7574  ass can recomput
+00026c80: 6520 7468 6520 6170 7061 7265 6e74 2072  e the apparent r
+00026c90: 6573 6973 7469 7479 2072 686f 2062 6173  esistity rho bas
+00026ca0: 6520 6f6e 2069 6d70 6564 616e 6365 2054  e on impedance T
+00026cb0: 656e 736f 7220 5a2e 0d0a 2020 2020 2020  ensor Z...      
+00026cc0: 200d 0a20 2020 202e 2e20 7365 6561 6c73   ..    .. seeals
+00026cd0: 6f3a 3a20 0d0a 2020 2020 2020 2020 5a6f  o:: ..        Zo
+00026ce0: 6e67 652c 204b 2e4c 2e20 616e 6420 4875  nge, K.L. and Hu
+00026cf0: 6768 6573 2c20 4c2e 4a2e 2c20 3139 3931  ghes, L.J., 1991
+00026d00: 2c20 436f 6e74 726f 6c6c 6564 2073 6f75  , Controlled sou
+00026d10: 7263 6520 6175 6469 6f2d 6672 6571 7565  rce audio-freque
+00026d20: 6e63 7920 0d0a 2020 2020 2020 2020 6d61  ncy ..        ma
+00026d30: 676e 6574 6f74 656c 6c75 7269 6373 2c69  gnetotellurics,i
+00026d40: 6e20 456c 6563 7472 6f6d 6167 6e65 7469  n Electromagneti
+00026d50: 6320 4d65 7468 6f64 7320 696e 2041 7070  c Methods in App
+00026d60: 6c69 6564 2047 656f 7068 7973 6963 732c  lied Geophysics,
+00026d70: 2065 642e 0d0a 2020 2020 2020 2020 4e61   ed...        Na
+00026d80: 6269 6768 6961 6e2c 204d 2e4e 2e2c 2056  bighian, M.N., V
+00026d90: 6f6c 2e20 322c 536f 6369 6574 7920 6f66  ol. 2,Society of
+00026da0: 2045 7870 6c6f 7261 7469 6f6e 2047 656f   Exploration Geo
+00026db0: 7068 7973 6963 6973 7473 2c20 7070 2e20  physicists, pp. 
+00026dc0: 3731 332d 3830 392e 0d0a 2020 2020 2020  713-809...      
+00026dd0: 2020 2020 2020 0d0a 2020 2020 4172 6775        ..    Argu
+00026de0: 6d65 6e74 7320 0d0a 2020 2020 2d2d 2d2d  ments ..    ----
+00026df0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00026e00: 2a2a 6461 7461 5f66 6e2a 2a20 3a20 7374  **data_fn** : st
+00026e10: 720d 0a20 2020 2020 2020 2020 2020 2020  r..             
+00026e20: 2020 2070 6174 6820 746f 2061 7667 2066     path to avg f
+00026e30: 696c 656e 616d 652e 200d 0a20 2020 2020  ilename. ..     
+00026e40: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00026e50: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
+00026e60: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
+00026e70: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d    ===========  =
+00026e80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00026e90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+00026ea0: 2020 2020 4174 7472 6962 7574 6573 2020      Attributes  
+00026eb0: 2020 2020 2020 2054 7970 6520 2020 2020         Type     
+00026ec0: 2020 2020 2075 6e69 7473 2020 2020 2020       units      
+00026ed0: 4578 706c 616e 6174 696f 6e0d 0a20 2020  Explanation..   
+00026ee0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00026ef0: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  =  ===========  
+00026f00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
+00026f10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00026f20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+00026f30: 2020 5a20 2020 2020 2020 2020 2020 2020    Z             
+00026f40: 2020 2020 6e70 2e6e 6461 7272 6179 2020      np.ndarray  
+00026f50: 2020 562f 6d20 2020 2020 2020 2020 496d    V/m         Im
+00026f60: 7065 6461 6e63 6520 7465 6e73 6f72 200d  pedance tensor .
+00026f70: 0a20 2020 2072 6561 6c20 2020 2020 2020  .    real       
+00026f80: 2020 2020 2020 2064 6963 7420 2020 2020         dict     
+00026f90: 2020 2020 2056 2f6d 2020 2020 2020 2020       V/m        
+00026fa0: 2072 6561 6c20 7061 7274 206f 6620 5a20   real part of Z 
+00026fb0: 0d0a 2020 2020 696d 6167 2020 2020 2020  ..    imag      
+00026fc0: 2020 2020 2020 2020 6469 6374 2020 2020          dict    
+00026fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026fe0: 2020 696d 6167 696e 6172 7920 7061 7274    imaginary part
+00026ff0: 206f 6620 5a20 200d 0a20 2020 2063 6f6d   of Z  ..    com
+00027000: 706c 6578 2020 2020 2020 2020 2020 2064  plex           d
+00027010: 6963 7420 2020 2020 2020 2020 2063 6f6d  ict          com
+00027020: 706c 6578 2020 2020 205a 206f 6e20 636f  plex     Z on co
+00027030: 6d70 6c65 7820 7479 7065 0d0a 2020 2020  mplex type..    
+00027040: 7268 6f20 2020 2020 2020 2020 2020 2020  rho             
+00027050: 2020 6469 6374 2020 2020 2020 2020 2020    dict          
+00027060: 6f68 6d2e 6d20 2020 2020 2020 5265 7369  ohm.m       Resi
+00027070: 7374 6976 6974 7920 0d0a 2020 2020 6c6f  stivity ..    lo
+00027080: 6320 2020 2020 2020 2020 2020 2020 2020  c               
+00027090: 6469 6374 2020 2020 2020 2020 2020 2020  dict            
+000270a0: 2020 2020 2020 2020 2020 6c6f 6361 7469            locati
+000270b0: 6f6e 206f 6620 5a20 7661 6c75 6520 6174  on of Z value at
+000270c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000270d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000270e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000270f0: 2020 2074 6865 2073 7461 7469 6f6e 206c     the station l
+00027100: 616d 6264 6120 2e0d 0a20 2020 2020 2020  ambda ...       
+00027110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027130: 2020 2020 2020 2020 2065 3a67 206c 6f63           e:g loc
+00027140: 5b27 5330 305d 2073 686f 7720 7468 650d  ['S00] show the.
+00027150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027180: 2063 7572 7265 6e74 205a 2064 6174 6120   current Z data 
+00027190: 6174 2073 7461 7469 6f6e 2053 3030 0d0a  at station S00..
+000271a0: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
+000271b0: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
+000271c0: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  =  ===========  
+000271d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000271e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+000271f0: 0a20 2020 200d 0a20 2020 202e 2e20 6e6f  .    ..    .. no
+00027200: 7465 3a3a 2061 6c6c 2064 6963 742d 6174  te:: all dict-at
+00027210: 7472 6962 7574 6573 2020 6361 6e20 6265  tributes  can be
+00027220: 206c 6f63 2077 6974 6820 7468 6520 7374   loc with the st
+00027230: 6174 696f 6e20 6e61 6d65 202e 0d0a 2020  ation name ...  
+00027240: 2020 2020 2020 0d0a 2020 2020 4d6f 7265        ..    More
+00027250: 2061 7474 7269 6275 7465 7320 6361 6e20   attributes can 
+00027260: 6265 2061 6464 6564 2062 7920 696e 7075  be added by inpu
+00027270: 7469 6e67 2061 206b 6579 2077 6f72 6420  ting a key word 
+00027280: 6469 6374 696f 6e61 7279 0d0a 2020 2020  dictionary..    
+00027290: 0d0a 2020 2020 3a45 7861 6d70 6c65 3a0d  ..    :Example:.
+000272a0: 0a20 2020 2020 2020 2020 0d0a 2020 2020  .         ..    
+000272b0: 2020 2020 3e3e 3e20 6672 6f6d 2070 7963      >>> from pyc
+000272c0: 7361 6d74 2e63 6f72 652e 6176 6720 696d  samt.core.avg im
+000272d0: 706f 7220 5a5f 7465 6e73 6f72 0d0a 2020  por Z_tensor..  
+000272e0: 2020 2020 2020 3e3e 3e20 7061 7468 3d6f        >>> path=o
+000272f0: 732e 7061 7468 2e6a 6f69 6e28 6f73 2e65  s.path.join(os.e
+00027300: 6e76 6972 6f6e 5b22 7079 4353 414d 5422  nviron["pyCSAMT"
+00027310: 5d2c 200d 0a20 2020 2020 2020 202e 2e2e  ], ..        ...
+00027320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027330: 2020 2770 7963 7361 6d74 272c 2022 6461    'pycsamt', "da
+00027340: 7461 222c 2022 4b31 2e41 5647 2229 0d0a  ta", "K1.AVG")..
+00027350: 2020 2020 2020 2020 3e3e 3e20 7a5f 6f62          >>> z_ob
+00027360: 6a3d 5a5f 5465 6e73 6f72 2870 6174 6829  j=Z_Tensor(path)
+00027370: 0d0a 2020 2020 2020 2020 3e3e 3e20 7a5f  ..        >>> z_
+00027380: 7a3d 5a78 792e 5a0d 0a20 2020 2020 2020  z=Zxy.Z..       
+00027390: 203e 3e3e 2070 7269 6e74 287a 5f6f 626a   >>> print(z_obj
+000273a0: 2e72 6561 6c5b 2253 3030 225d 290d 0a20  .real["S00"]).. 
+000273b0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+000273c0: 287a 5f6f 626a 2e69 6d61 675b 2253 3030  (z_obj.imag["S00
+000273d0: 225d 290d 0a20 2020 2020 2020 203e 3e3e  "])..        >>>
+000273e0: 2070 7269 6e74 287a 5f6f 626a 2e63 6f6d   print(z_obj.com
+000273f0: 706c 6578 5b22 5330 3022 5d29 0d0a 2020  plex["S00"])..  
+00027400: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+00027410: 7a5f 6f62 6a2e 6c6f 635b 2253 3030 225d  z_obj.loc["S00"]
+00027420: 290d 0a20 2020 2020 2020 203e 3e3e 2070  )..        >>> p
+00027430: 7269 6e74 287a 5f6f 626a 2e72 686f 5b22  rint(z_obj.rho["
+00027440: 5330 3022 5d29 0d0a 2020 2020 2222 220d  S00"])..    """.
+00027450: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00027460: 5f28 7365 6c66 2c20 7a5f 6172 7261 7920  _(self, z_array 
+00027470: 3d4e 6f6e 6520 2c20 7068 6173 655f 6172  =None , phase_ar
+00027480: 7261 7920 3d4e 6f6e 652c 2066 7265 713d  ray =None, freq=
+00027490: 4e6f 6e65 2c20 7a5f 6572 726f 723d 4e6f  None, z_error=No
+000274a0: 6e65 2c20 0d0a 2020 2020 2020 2020 2020  ne, ..          
+000274b0: 2020 2020 2020 202a 2a6b 7761 7267 7329         **kwargs)
+000274c0: 3a20 0d0a 0d0a 2020 2020 2020 2020 7365  : ....        se
+000274d0: 6c66 2e5f 6c6f 6767 696e 6720 3d63 7361  lf._logging =csa
+000274e0: 6d74 7079 6c6f 672e 6765 745f 6373 616d  mtpylog.get_csam
+000274f0: 7470 795f 6c6f 6767 6572 2873 656c 662e  tpy_logger(self.
+00027500: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+00027510: 5f5f 290d 0a20 2020 2020 2020 2073 656c  __)..        sel
+00027520: 662e 5f7a 2020 3d7a 5f61 7272 6179 0d0a  f._z  =z_array..
+00027530: 2020 2020 2020 2020 7365 6c66 2e5f 7068          self._ph
+00027540: 6173 6520 3d70 6861 7365 5f61 7272 6179  ase =phase_array
+00027550: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+00027560: 5f7a 5f65 7272 203d 7a5f 6572 726f 7220  _z_err =z_error 
+00027570: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00027580: 6672 6571 203d 204e 6f6e 650d 0a20 2020  freq = None..   
+00027590: 2020 2020 200d 0a20 0d0a 2020 2020 2020       .. ..      
+000275a0: 2020 7365 6c66 2e5f 7268 6f20 3d4e 6f6e    self._rho =Non
+000275b0: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+000275c0: 6c6f 633d 4e6f 6e65 200d 0a0d 0a20 2020  loc=None ....   
+000275d0: 2020 2020 2073 656c 662e 7a41 5320 3d4e       self.zAS =N
+000275e0: 6f6e 6520 0d0a 2020 2020 2020 2020 0d0a  one ..        ..
+000275f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00027600: 2020 666f 7220 6b65 7920 696e 206c 6973    for key in lis
+00027610: 7420 286b 7761 7267 732e 6b65 7973 2829  t (kwargs.keys()
+00027620: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00027630: 7365 7461 7474 7228 7365 6c66 2c20 6b65  setattr(self, ke
+00027640: 7920 2c20 6b77 6172 6773 5b6b 6579 5d29  y , kwargs[key])
+00027650: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00027660: 2020 2020 7365 6c66 2e7a 5f70 7767 7420      self.z_pwgt 
+00027670: 3d4e 6f6e 6520 0d0a 2020 2020 2020 2020  =None ..        
+00027680: 7365 6c66 2e7a 5f6d 6567 7420 3d4e 6f6e  self.z_megt =Non
+00027690: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
+000276a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e7a  ..        self.z
+000276b0: 5f61 735f 6c61 6265 6c73 3d5b 275a 2e6d  _as_labels=['Z.m
+000276c0: 6167 272c 2027 5a2e 6d77 6774 272c 275a  ag', 'Z.mwgt','Z
+000276d0: 2e70 7767 7427 2c0d 0a20 2020 2020 2020  .pwgt',..       
+000276e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000276f0: 2020 2020 2020 2020 2020 2027 452e 7767             'E.wg
+00027700: 7427 2c20 2742 2e77 6774 272c 275a 2e25  t', 'B.wgt','Z.%
+00027710: 6572 7227 205d 0d0a 2020 2020 2020 2020  err' ]..        
+00027720: 0d0a 2020 2020 2020 2020 2020 2020 200d  ..             .
+00027730: 0a20 2020 2040 7072 6f70 6572 7479 200d  .    @property .
+00027740: 0a20 2020 2064 6566 2066 7265 7120 2873  .    def freq (s
+00027750: 656c 6629 3a20 0d0a 2020 2020 2020 2020  elf): ..        
+00027760: 7265 7475 726e 2073 656c 662e 5f66 7265  return self._fre
+00027770: 7120 0d0a 2020 2020 0d0a 2020 2020 4066  q ..    ..    @f
+00027780: 7265 712e 7365 7474 6572 200d 0a20 2020  req.setter ..   
+00027790: 2064 6566 2066 7265 7120 2873 656c 662c   def freq (self,
+000277a0: 2066 7265 715f 6172 7261 7929 3a0d 0a20   freq_array):.. 
+000277b0: 2020 2020 2020 2069 6620 6672 6571 5f61         if freq_a
+000277c0: 7272 6179 2e64 7479 7065 206e 6f74 2069  rray.dtype not i
+000277d0: 6e20 5b27 666c 6f61 7427 2c20 2769 6e74  n ['float', 'int
+000277e0: 275d 3a0d 0a20 2020 2020 2020 2020 2020  ']:..           
+000277f0: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
+00027800: 2020 2020 2020 2020 2073 656c 662e 5f66           self._f
+00027810: 7265 7120 3d6e 702e 6172 7261 7928 5b6e  req =np.array([n
+00027820: 702e 666c 6f61 7428 6666 2920 666f 7220  p.float(ff) for 
+00027830: 6666 2069 6e20 6672 6571 5f61 7272 6179  ff in freq_array
+00027840: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00027850: 6578 6365 7074 203a 0d0a 2020 2020 2020  except :..      
+00027860: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00027870: 4672 6571 7565 6e63 7945 7272 6f72 280d  FrequencyError(.
+00027880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027890: 2020 2020 2027 7772 6f6e 6720 496e 7075       'wrong Inpu
+000278a0: 7420 6672 6571 7565 6e63 6965 7320 7661  t frequencies va
+000278b0: 6c75 6573 2e6d 7573 7420 6265 2061 2066  lues.must be a f
+000278c0: 6c6f 6174 206e 756d 6265 722e 2027 290d  loat number. ').
+000278d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000278e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000278f0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00027900: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00027910: 2040 7072 6f70 6572 7479 200d 0a20 2020   @property ..   
+00027920: 2064 6566 2070 6861 7365 2028 7365 6c66   def phase (self
+00027930: 293a 0d0a 2020 2020 2020 2020 7265 7475  ):..        retu
+00027940: 726e 2073 656c 662e 5f70 6861 7365 200d  rn self._phase .
+00027950: 0a20 2020 2040 7068 6173 652e 7365 7474  .    @phase.sett
+00027960: 6572 200d 0a20 2020 2064 6566 2070 6861  er ..    def pha
+00027970: 7365 2873 656c 662c 2070 687a 5f61 7272  se(self, phz_arr
+00027980: 6179 293a 0d0a 2020 2020 2020 2020 6966  ay):..        if
+00027990: 2070 687a 5f61 7272 6179 2e64 7479 7065   phz_array.dtype
+000279a0: 206e 6f74 2069 6e20 5b27 666c 6f61 7427   not in ['float'
+000279b0: 2c20 2769 6e74 275d 3a0d 0a20 2020 2020  , 'int']:..     
+000279c0: 2020 2020 2020 2074 7279 203a 7365 6c66         try :self
+000279d0: 2e5f 7068 6173 6520 3d6e 702e 6172 7261  ._phase =np.arra
+000279e0: 7928 5b66 6c6f 6174 2870 687a 2920 666f  y([float(phz) fo
+000279f0: 7220 7068 7a20 696e 2070 687a 5f61 7272  r phz in phz_arr
+00027a00: 6179 5d29 0d0a 2020 2020 2020 2020 2020  ay])..          
+00027a10: 2020 6578 6365 7074 203a 0d0a 2020 2020    except :..    
+00027a20: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00027a30: 6520 5068 6173 6545 7272 6f72 280d 0a20  e PhaseError(.. 
+00027a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a50: 2020 2027 4172 6775 6d65 6e74 7320 7068     'Arguments ph
+00027a60: 6173 6520 7661 6c75 6573 206d 7573 7420  ase values must 
+00027a70: 6265 2069 6e74 2c20 6f72 2066 6c6f 6174  be int, or float
+00027a80: 202e 2729 0d0a 2020 2020 2020 2020 2020   .')..          
+00027a90: 2020 0d0a 2020 2020 4070 726f 7065 7274    ..    @propert
+00027aa0: 7920 0d0a 2020 2020 6465 6620 7a5f 6572  y ..    def z_er
+00027ab0: 726f 7220 2873 656c 6629 3a0d 0a20 2020  ror (self):..   
+00027ac0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00027ad0: 2e5f 7a5f 6572 7220 0d0a 2020 2020 407a  ._z_err ..    @z
+00027ae0: 5f65 7272 6f72 2e73 6574 7465 7220 0d0a  _error.setter ..
+00027af0: 2020 2020 6465 6620 7a5f 6572 726f 7228      def z_error(
+00027b00: 7365 6c66 2c20 7a5f 6572 726f 725f 293a  self, z_error_):
+00027b10: 0d0a 2020 2020 2020 2020 6966 207a 5f65  ..        if z_e
+00027b20: 7272 6f72 5f2e 6474 7970 6520 6e6f 7420  rror_.dtype not 
+00027b30: 696e 205b 2766 6c6f 6174 272c 2027 696e  in ['float', 'in
+00027b40: 7427 5d3a 0d0a 2020 2020 2020 2020 2020  t']:..          
+00027b50: 2020 7472 7920 3a20 0d0a 2020 2020 2020    try : ..      
+00027b60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00027b70: 7a5f 6572 7220 3d6e 702e 6172 7261 7928  z_err =np.array(
+00027b80: 5b66 6c6f 6174 287a 7a29 2066 6f72 207a  [float(zz) for z
+00027b90: 7a20 696e 207a 5f65 7272 6f72 5f5d 290d  z in z_error_]).
+00027ba0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00027bb0: 6570 7420 3a0d 0a20 2020 2020 2020 2020  ept :..         
+00027bc0: 2020 2020 2020 2072 6169 7365 205a 4572         raise ZEr
+00027bd0: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+00027be0: 2020 2020 2020 2020 2020 2245 7272 6f72            "Error
+00027bf0: 207a 2069 6e70 7574 2076 616c 7565 7320   z input values 
+00027c00: 6172 6520 696e 636f 7272 6563 7473 2e22  are incorrects."
+00027c10: 290d 0a20 2020 200d 0a20 2020 2040 7072  )..    ..    @pr
+00027c20: 6f70 6572 7479 200d 0a20 2020 2064 6566  operty ..    def
+00027c30: 207a 2020 2873 656c 6629 3a20 0d0a 2020   z  (self): ..  
+00027c40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00027c50: 662e 5f7a 0d0a 2020 2020 0d0a 2020 2020  f._z..    ..    
+00027c60: 407a 2e73 6574 7465 7220 0d0a 2020 2020  @z.setter ..    
+00027c70: 6465 6620 7a20 2873 656c 662c 207a 7a5f  def z (self, zz_
+00027c80: 6172 7261 7929 3a0d 0a20 2020 2020 2020  array):..       
+00027c90: 2069 6620 7a7a 5f61 7272 6179 2e64 7479   if zz_array.dty
+00027ca0: 7065 203d 3d20 2773 7472 273a 0d0a 2020  pe == 'str':..  
+00027cb0: 2020 2020 2020 2020 2020 7472 7920 3a20            try : 
+00027cc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00027cd0: 2020 7a7a 5f61 7272 6179 3d20 6e70 2e61    zz_array= np.a
+00027ce0: 7272 6179 285b 6e70 2e66 6c6f 6174 287a  rray([np.float(z
+00027cf0: 7a29 2066 6f72 207a 7a20 696e 207a 7a5f  z) for zz in zz_
+00027d00: 6172 7261 795d 290d 0a20 2020 2020 2020  array])..       
+00027d10: 2020 2020 2065 7863 6570 7420 3a20 0d0a       except : ..
+00027d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d30: 7261 6973 6520 5a45 7272 6f72 280d 0a20  raise ZError(.. 
+00027d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d50: 2020 2027 7a5f 696d 7065 6461 6e63 6520     'z_impedance 
+00027d60: 7661 6c75 6520 6d75 7374 2062 6520 6120  value must be a 
+00027d70: 636f 6d70 6c65 785f 6e75 6d62 6572 2e27  complex_number.'
+00027d80: 290d 0a20 2020 2020 2020 2023 2d2d 2d3e  )..        #--->
+00027d90: 2070 726f 7669 6465 2066 7265 7120 7661   provide freq va
+00027da0: 6c75 6520 616e 6420 7068 6173 6520 2e20  lue and phase . 
+00027db0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00027dc0: 2020 6966 207a 7a5f 6172 7261 792e 6474    if zz_array.dt
+00027dd0: 7970 6520 696e 205b 2766 6c6f 6174 272c  ype in ['float',
+00027de0: 2027 696e 7427 5d3a 200d 0a20 2020 2020   'int']: ..     
+00027df0: 2020 2020 2020 2073 656c 662e 5f7a 203d         self._z =
+00027e00: 205a 6363 2e72 686f 7068 6932 7a28 7068   Zcc.rhophi2z(ph
+00027e10: 6173 6520 3d73 656c 662e 5f70 6861 7365  ase =self._phase
+00027e20: 202c 2066 7265 7120 3d73 656c 662e 5f66   , freq =self._f
+00027e30: 7265 7120 2c20 0d0a 2020 2020 2020 2020  req , ..        
+00027e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e50: 2020 2020 2020 2020 2020 207a 5f61 7272             z_arr
+00027e60: 6179 3d7a 7a5f 6172 7261 7929 5b2d 315d  ay=zz_array)[-1]
+00027e70: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+00027e80: 2073 656c 662e 5f7a 3d20 7a7a 5f61 7272   self._z= zz_arr
+00027e90: 6179 0d0a 2020 2020 0d0a 2020 2020 2020  ay..    ..      
+00027ea0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00027eb0: 0d0a 2020 2020 6465 6620 7a5f 616e 645f  ..    def z_and_
+00027ec0: 7a65 7272 5f32 7268 6f70 6869 2873 656c  zerr_2rhophi(sel
+00027ed0: 662c 207a 5f61 7272 6179 3d4e 6f6e 6520  f, z_array=None 
+00027ee0: 2c20 6672 6571 3d4e 6f6e 6529 3a0d 0a20  , freq=None):.. 
+00027ef0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00027f00: 2020 2020 4d65 7468 6f64 2074 6f20 636f      Method to co
+00027f10: 6d70 7574 6520 7265 7369 7374 6976 6974  mpute resistivit
+00027f20: 7920 616e 6420 7068 6173 6520 7068 6173  y and phase phas
+00027f30: 6520 0d0a 2020 2020 2020 2020 7573 696e  e ..        usin
+00027f40: 6720 5a5f 7661 6c75 6573 2061 6e64 205a  g Z_values and Z
+00027f50: 6572 726f 7220 5f76 616c 7565 7320 0d0a  error _values ..
+00027f60: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00027f70: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00027f80: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00027f90: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+00027fa0: 7a5f 6172 7261 7920 3a20 636f 6d70 6c65  z_array : comple
+00027fb0: 780d 0a20 2020 2020 2020 2020 2020 2020  x..             
+00027fc0: 2020 2020 2020 2049 6d70 6564 616e 6365         Impedance
+00027fd0: 2074 656e 736f 7220 636f 6d70 6c65 785f   tensor complex_
+00027fe0: 6e75 6d62 6572 200d 0a20 2020 2020 2020  number ..       
+00027ff0: 2020 2020 2020 2020 2020 2020 2054 6865               The
+00028000: 202a 6465 6661 756c 742a 2069 7320 4e6f   *default* is No
+00028010: 6e65 2e0d 0a20 2020 2020 2020 2020 2020  ne...           
+00028020: 202a 2066 7265 7120 3a20 6e64 6172 7261   * freq : ndarra
+00028030: 792c 200d 0a20 2020 2020 2020 2020 2020  y, ..           
+00028040: 2020 2020 2020 2020 2066 7265 7175 656e           frequen
+00028050: 6379 2076 616c 7565 2e0d 0a20 2020 2020  cy value...     
+00028060: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00028070: 6865 202a 6465 6661 756c 742a 2069 7320  he *default* is 
+00028080: 4e6f 6e65 2e0d 0a0d 0a20 2020 2020 2020  None.....       
+00028090: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+000280a0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+000280b0: 2020 2020 2020 206e 6461 7272 6179 286e         ndarray(n
+000280c0: 6461 7272 6179 2c31 2920 200d 0a20 2020  darray,1)  ..   
+000280d0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+000280e0: 6973 7469 7669 7479 2076 616c 7565 2063  istivity value c
+000280f0: 6f6d 7075 7465 6420 696e 206f 686d 2e6d  omputed in ohm.m
+00028100: 0d0a 2020 2020 2020 2020 2020 2020 6e64  ..            nd
+00028110: 6172 7261 7920 286e 6461 7272 6179 2c20  array (ndarray, 
+00028120: 3129 2c20 0d0a 2020 2020 2020 2020 2020  1), ..          
+00028130: 2020 2020 2020 7068 6173 6520 616e 676c        phase angl
+00028140: 6520 7661 6c75 6520 2069 6e20 6465 6772  e value  in degr
+00028150: 6565 2e0d 0a20 2020 2020 2020 2022 2222  ee...        """
+00028160: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00028170: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+00028180: 207a 5f61 7272 6179 2069 7320 6e6f 7420   z_array is not 
+00028190: 4e6f 6e65 203a 2073 656c 662e 7a3d 207a  None : self.z= z
+000281a0: 5f61 7272 6179 200d 0a20 2020 2020 2020  _array ..       
+000281b0: 200d 0a20 2020 2020 2020 2069 6620 6672   ..        if fr
+000281c0: 6571 2069 7320 6e6f 7420 4e6f 6e65 203a  eq is not None :
+000281d0: 2073 656c 662e 6672 6571 3d66 7265 710d   self.freq=freq.
+000281e0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+000281f0: 2020 2069 6620 7365 6c66 2e7a 2069 7320     if self.z is 
+00028200: 4e6f 6e65 206f 7220 7365 6c66 2e66 7265  None or self.fre
+00028210: 7120 6973 204e 6f6e 6520 3a20 0d0a 2020  q is None : ..  
+00028220: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00028230: 5a45 7272 6f72 280d 0a20 2020 2020 2020  ZError(..       
+00028240: 2020 2020 2020 2020 2027 4e6f 6e65 2076           'None v
+00028250: 616c 7565 7320 6361 6e20 6e6f 7420 6265  alues can not be
+00028260: 2063 6f6d 7075 7465 642e 2043 6865 636b   computed. Check
+00028270: 2076 616c 7565 7320 2127 290d 0a20 2020   values !')..   
+00028280: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00028290: 2020 2073 656c 662e 7268 6f20 3d6e 702e     self.rho =np.
+000282a0: 6170 706c 795f 616c 6f6e 675f 6178 6973  apply_along_axis
+000282b0: 280d 0a20 2020 2020 2020 2020 2020 206c  (..            l
+000282c0: 616d 6264 6120 7661 6c7a 203a 206e 702e  ambda valz : np.
+000282d0: 6162 7328 7661 6c7a 292a 2a32 202a 2028  abs(valz)**2 * (
+000282e0: 302e 3220 2f20 7365 6c66 2e66 7265 7129  0.2 / self.freq)
+000282f0: 2c20 302c 2073 656c 662e 7a29 0d0a 2020  , 0, self.z)..  
+00028300: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00028310: 232d 2d20 7a20 6973 2063 6f6d 706c 6578  #-- z is complex
+00028320: 206e 756d 6265 7220 2c20 6361 6e20 6265   number , can be
+00028330: 2063 6f6d 7075 7465 2075 7369 6e67 206e   compute using n
+00028340: 702e 616e 676c 650d 0a0d 0a20 2020 2020  p.angle....     
+00028350: 2020 2073 656c 662e 7068 6173 653d 206e     self.phase= n
+00028360: 702e 7261 6432 6465 6728 6e70 2e61 6e67  p.rad2deg(np.ang
+00028370: 6c65 2873 656c 662e 7a29 290d 0a20 2020  le(self.z))..   
+00028380: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00028390: 2020 2072 6574 7572 6e20 7365 6c66 2e72     return self.r
+000283a0: 686f 202c 2073 656c 662e 7068 6173 650d  ho , self.phase.
+000283b0: 0a20 2020 200d 0a20 2020 200d 0a20 2020  .    ..    ..   
+000283c0: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
+000283d0: 6465 6620 7268 6f20 2873 656c 6629 3a20  def rho (self): 
+000283e0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000283f0: 2073 656c 662e 5f72 686f 200d 0a20 2020   self._rho ..   
+00028400: 2020 2020 200d 0a20 2020 2040 7268 6f2e       ..    @rho.
+00028410: 7365 7474 6572 200d 0a20 2020 2064 6566  setter ..    def
+00028420: 2072 686f 2873 656c 662c 2072 6573 5f61   rho(self, res_a
+00028430: 7272 6179 293a 0d0a 2020 2020 2020 2020  rray):..        
+00028440: 6966 2072 6573 5f61 7272 6179 2e64 7479  if res_array.dty
+00028450: 7065 206e 6f74 2069 6e20 5b27 666c 6f61  pe not in ['floa
+00028460: 7427 2c20 2769 6e74 275d 3a0d 0a20 2020  t', 'int']:..   
+00028470: 2020 2020 2020 2020 2074 7279 203a 2073           try : s
+00028480: 656c 662e 5f72 686f 203d 206e 702e 6172  elf._rho = np.ar
+00028490: 7261 7928 5b66 6c6f 6174 2872 6573 2920  ray([float(res) 
+000284a0: 666f 7220 7265 7320 696e 2072 6573 5f61  for res in res_a
+000284b0: 7272 6179 5d29 200d 0a20 2020 2020 2020  rray]) ..       
+000284c0: 2020 2020 2065 7863 6570 7420 3a20 0d0a       except : ..
+000284d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284e0: 7261 6973 6520 5265 7369 7374 6976 6974  raise Resistivit
+000284f0: 7945 7272 6f72 280d 0a20 2020 2020 2020  yError(..       
+00028500: 2020 2020 2020 2020 2020 2020 2027 5265               'Re
+00028510: 7369 7374 6976 6974 6965 7320 7661 6c75  sistivities valu
+00028520: 6573 206d 7573 7420 6265 2066 6c6f 6174  es must be float
+00028530: 2027 0d0a 2020 2020 2020 2020 2020 2020   '..            
+00028540: 2020 2020 2020 2020 2027 6f72 2069 6e74           'or int
+00028550: 6567 6572 202c 206e 6f74 2061 204e 6f6e  eger , not a Non
+00028560: 6520 7479 7065 2021 2729 0d0a 2020 2020  e type !')..    
+00028570: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00028580: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+00028590: 2020 6465 6620 7268 6f70 6869 3272 686f    def rhophi2rho
+000285a0: 7068 5f65 7272 6f72 7320 2873 656c 662c  ph_errors (self,
+000285b0: 2072 6573 5f61 7272 6179 3d4e 6f6e 6520   res_array=None 
+000285c0: 2c20 7068 6173 655f 6172 7261 7920 3d20  , phase_array = 
+000285d0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
+000285e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000285f0: 2020 2020 7a5f 6572 726f 7220 3d4e 6f6e      z_error =Non
+00028600: 6520 2c20 6672 6571 3d4e 6f6e 6520 293a  e , freq=None ):
+00028610: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+00028620: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+00028630: 7468 6520 7068 6173 6520 616e 6420 7265  the phase and re
+00028640: 7369 7374 6976 6974 6965 7320 6572 726f  sistivities erro
+00028650: 7220 7669 6120 7265 735f 6172 7261 7920  r via res_array 
+00028660: 2c20 0d0a 2020 2020 2020 2020 7068 6173  , ..        phas
+00028670: 655f 6172 7261 7920 616e 6420 5f7a 2065  e_array and _z e
+00028680: 7272 6f72 2e0d 0a20 2020 2020 2020 200d  rror...        .
+00028690: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000286a0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+000286b0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+000286c0: 2020 2020 202a 2072 6573 5f61 7272 6179       * res_array
+000286d0: 203a 206e 6461 7272 6179 202c 200d 0a20   : ndarray , .. 
+000286e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000286f0: 2020 2020 2020 2072 6573 6973 7469 7669         resistivi
+00028700: 7479 2076 616c 7565 2069 6e20 6f68 6d2e  ty value in ohm.
+00028710: 6d20 0d0a 2020 2020 2020 2020 2020 2020  m ..            
+00028720: 2a20 7068 6173 655f 6172 7261 7920 3a20  * phase_array : 
+00028730: 6e64 6172 7261 7920 2c20 0d0a 2020 2020  ndarray , ..    
+00028740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028750: 2020 2020 7068 6173 6520 616e 676c 6520      phase angle 
+00028760: 7661 6c75 6520 696e 206d 7261 6469 616e  value in mradian
+00028770: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
+00028780: 2a20 7a5f 6572 726f 7220 3a20 6e64 6172  * z_error : ndar
+00028790: 7261 7920 2c20 0d0a 2020 2020 2020 2020  ray , ..        
+000287a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000287b0: 696d 7065 6461 6e63 6520 5465 6e73 6f72  impedance Tensor
+000287c0: 2065 7272 6f72 200d 0a20 2020 2020 2020   error ..       
+000287d0: 2020 2020 202a 2066 7265 7120 3a20 6e64       * freq : nd
+000287e0: 6172 7261 7920 2c20 0d0a 2020 2020 2020  array , ..      
+000287f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028800: 2020 6672 6571 7565 6e63 7920 6e75 6d62    frequency numb
+00028810: 6572 7320 696e 2048 7a20 0d0a 2020 2020  ers in Hz ..    
+00028820: 2020 2020 5265 7475 726e 7320 0d0a 2020      Returns ..  
+00028830: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a        --------..
+00028840: 2020 2020 2020 2020 2020 206e 6461 7272             ndarr
+00028850: 6179 7320 0d0a 2020 2020 2020 2020 2020  ays ..          
+00028860: 2020 2020 7265 7369 7374 6976 6974 6965      resistivitie
+00028870: 7320 6572 726f 7220 616e 6420 7068 6173  s error and phas
+00028880: 6520 6572 726f 7273 2076 616c 7565 7320  e errors values 
+00028890: 202e 0d0a 2020 2020 2020 2020 2222 220d   ...        """.
+000288a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+000288b0: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
+000288c0: 662e 5f6c 6f67 6769 6e67 2e69 6e66 6f28  f._logging.info(
+000288d0: 2763 6f6d 7075 7465 2072 686f 5f70 6869  'compute rho_phi
+000288e0: 2074 6f20 7265 7369 7374 6976 6974 6965   to resistivitie
+000288f0: 7320 616e 6420 7068 6173 6573 5f65 7272  s and phases_err
+00028900: 6f72 7327 290d 0a20 2020 2020 2020 200d  ors')..        .
+00028910: 0a20 2020 2020 2020 2069 6620 7265 735f  .        if res_
+00028920: 6172 7261 7920 6973 206e 6f74 204e 6f6e  array is not Non
+00028930: 6520 3a20 7365 6c66 2e72 686f 203d 7265  e : self.rho =re
+00028940: 735f 6172 7261 790d 0a20 2020 2020 2020  s_array..       
+00028950: 2069 6620 7a5f 6572 726f 7220 6973 206e   if z_error is n
+00028960: 6f74 204e 6f6e 6520 3a20 7365 6c66 2e7a  ot None : self.z
+00028970: 5f65 7272 6f72 203d 7a5f 6572 726f 7220  _error =z_error 
+00028980: 0d0a 2020 2020 2020 2020 6966 2070 6861  ..        if pha
+00028990: 7365 5f61 7272 6179 2069 7320 6e6f 7420  se_array is not 
+000289a0: 4e6f 6e65 203a 2073 656c 662e 7068 6173  None : self.phas
+000289b0: 6520 3d70 6861 7365 5f61 7272 6179 200d  e =phase_array .
+000289c0: 0a20 2020 2020 2020 2069 6620 6672 6571  .        if freq
+000289d0: 2069 7320 6e6f 7420 4e6f 6e65 203a 2073   is not None : s
+000289e0: 656c 662e 6672 6571 203d 2066 7265 7120  elf.freq = freq 
+000289f0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00028a00: 662e 7268 6f20 6973 204e 6f6e 6520 206f  f.rho is None  o
+00028a10: 7220 7365 6c66 2e70 6861 7365 2069 7320  r self.phase is 
+00028a20: 4e6f 6e65 206f 7220 7365 6c66 2e66 7265  None or self.fre
+00028a30: 7120 6973 204e 6f6e 6520 3a20 0d0a 2020  q is None : ..  
+00028a40: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00028a50: 6c6f 6767 696e 672e 7761 726e 280d 0a20  logging.warn(.. 
+00028a60: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00028a70: 4e6f 6e65 5479 7065 2063 616e 206e 6f74  NoneType can not
+00028a80: 2062 6520 636f 6d70 7574 6564 2e20 706c   be computed. pl
+00028a90: 6561 7365 2063 6865 636b 2079 6f75 7220  ease check your 
+00028aa0: 6461 7461 2061 7272 6179 732e 2729 0d0a  data arrays.')..
+00028ab0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00028ac0: 6520 5a45 7272 6f72 280d 0a20 2020 2020  e ZError(..     
+00028ad0: 2020 2020 2020 2020 2020 2027 636f 756c             'coul
+00028ae0: 6420 6e6f 7465 2063 6f6d 7075 7465 2061  d note compute a
+00028af0: 204e 6f6e 6574 7970 6520 6e75 6d62 6572   Nonetype number
+00028b00: 2e20 706c 6561 7365 2063 6865 636b 206e  . please check n
+00028b10: 756d 6265 7273 2e27 290d 0a20 2020 2020  umbers.')..     
+00028b20: 2020 200d 0a20 2020 2020 2020 2023 2063     ..        # c
+00028b30: 6f6d 7075 7465 2069 6d61 6720 7061 7274  ompute imag part
+00028b40: 2061 6e64 2072 6561 6c20 7061 7274 206f   and real part o
+00028b50: 6620 5a20 0d0a 2020 2020 2020 2020 2020  f Z ..          
+00028b60: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+00028b70: 7365 6c66 2e72 686f 2e73 697a 6520 213d  self.rho.size !=
+00028b80: 2073 656c 662e 6672 6571 2e73 697a 6520   self.freq.size 
+00028b90: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00028ba0: 7261 6973 6520 5a45 7272 6f72 280d 0a20  raise ZError(.. 
+00028bb0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00028bc0: 5265 7369 7374 6976 6974 7920 2c20 6672  Resistivity , fr
+00028bd0: 6571 2061 6e64 2070 6861 7365 5f61 7272  eq and phase_arr
+00028be0: 6179 206d 7573 7420 6265 2074 6865 2073  ay must be the s
+00028bf0: 616d 6520 7369 7a65 2e20 2729 0d0a 2020  ame size. ')..  
+00028c00: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00028c10: 2320 7a7a 5f3d 206e 702e 6172 7261 7928  # zz_= np.array(
+00028c20: 5b6e 702e 7371 7274 2830 2e32 202a 2073  [np.sqrt(0.2 * s
+00028c30: 656c 662e 5f66 7265 715b 6969 5d20 2a20  elf._freq[ii] * 
+00028c40: 0d0a 2020 2020 2020 2020 2373 656c 662e  ..        #self.
+00028c50: 5f72 686f 5b69 695d 2920 666f 7220 6969  _rho[ii]) for ii
+00028c60: 2069 6e20 7261 6e67 6520 2873 656c 662e   in range (self.
+00028c70: 5f66 7265 712e 7369 7a65 295d 290d 0a20  _freq.size)]).. 
+00028c80: 2020 2020 2020 207a 7a5f 636f 6d70 203d         zz_comp =
+00028c90: 205a 6363 2e72 686f 7068 6932 7a28 7068   Zcc.rhophi2z(ph
+00028ca0: 6173 653d 7365 6c66 2e70 6861 7365 2f31  ase=self.phase/1
+00028cb0: 6533 2c20 6672 6571 3d73 656c 662e 6672  e3, freq=self.fr
+00028cc0: 6571 2c20 0d0a 2020 2020 2020 2020 2020  eq, ..          
+00028cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ce0: 2020 2020 2072 6573 6973 7469 7669 7479       resistivity
+00028cf0: 3d73 656c 662e 7268 6f29 0d0a 2020 2020  =self.rho)..    
+00028d00: 2020 2020 7365 6c66 2e7a 203d 7a7a 5f63      self.z =zz_c
+00028d10: 6f6d 705b 2d31 5d0d 0a0d 0a20 2020 2020  omp[-1]....     
+00028d20: 2020 200d 0a20 2020 2020 2020 2023 207a     ..        # z
+00028d30: 7a5f 203d 6e70 2e73 7172 7420 2830 2e32  z_ =np.sqrt (0.2
+00028d40: 202a 2073 656c 662e 5f66 7265 7120 2a20   * self._freq * 
+00028d50: 7365 6c66 2e5f 7268 6f29 0d0a 2020 2020  self._rho)..    
+00028d60: 2020 2020 2320 7a5f 7265 616c 3d28 6e70      # z_real=(np
+00028d70: 2e61 7070 6c79 5f61 6c6f 6e67 5f61 7869  .apply_along_axi
+00028d80: 7328 6c61 6d62 6461 2078 7872 203a 206e  s(lambda xxr : n
+00028d90: 702e 636f 7328 7878 7229 2c20 302c 2073  p.cos(xxr), 0, s
+00028da0: 656c 662e 5f70 6861 7365 2929 202a 207a  elf._phase)) * z
+00028db0: 7a5f 200d 0a20 2020 2020 2020 2023 207a  z_ ..        # z
+00028dc0: 5f69 6d61 6720 3d28 6e70 2e61 7070 6c79  _imag =(np.apply
+00028dd0: 5f61 6c6f 6e67 5f61 7869 7328 6c61 6d62  _along_axis(lamb
+00028de0: 6461 2078 7869 3a20 6e70 2e63 6f73 2878  da xxi: np.cos(x
+00028df0: 7869 292c 2030 2c20 7365 6c66 2e5f 7068  xi), 0, self._ph
+00028e00: 6173 6529 292a 207a 7a5f 0d0a 0d0a 2020  ase))* zz_....  
+00028e10: 2020 2020 2020 7265 735f 6572 722c 2070        res_err, p
+00028e20: 6861 7365 5f65 7272 203d 205a 6363 2e7a  hase_err = Zcc.z
+00028e30: 5f65 7272 6f72 3272 5f70 6869 5f65 7272  _error2r_phi_err
+00028e40: 6f72 287a 5f72 6561 6c3d 7a7a 5f63 6f6d  or(z_real=zz_com
+00028e50: 705b 315d 2c0d 0a20 2020 2020 2020 2020  p[1],..         
+00028e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e80: 2020 2020 2020 2020 2020 2020 7a5f 696d              z_im
+00028e90: 6167 3d7a 7a5f 636f 6d70 5b32 5d2c 200d  ag=zz_comp[2], .
+00028ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ed0: 2020 2020 2020 6572 726f 723d 7365 6c66        error=self
+00028ee0: 2e7a 5f65 7272 6f72 290d 0a20 2020 2020  .z_error)..     
+00028ef0: 2020 200d 0a20 2020 2020 2020 2072 6574     ..        ret
+00028f00: 7572 6e20 7265 735f 6572 7220 2c20 7068  urn res_err , ph
+00028f10: 6173 655f 6572 7220 0d0a 2020 2020 2020  ase_err ..      
+00028f20: 2020 2020 2020 0d0a 2020 2020 6465 6620        ..    def 
+00028f30: 5f72 6561 645f 7a41 535f 6461 7461 2028  _read_zAS_data (
+00028f40: 7365 6c66 2c20 7a5f 6162 735f 6172 7261  self, z_abs_arra
+00028f50: 7920 3d4e 6f6e 6520 2c20 6e75 6d62 6572  y =None , number
+00028f60: 5f6f 665f 6672 6571 7565 6e63 6965 733d  _of_frequencies=
+00028f70: 4e6f 6e65 202c 0d0a 2020 2020 2020 2020  None ,..        
+00028f80: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+00028f90: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+00028fa0: 203d 4e6f 6e65 2029 3a0d 0a20 2020 2020   =None ):..     
+00028fb0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00028fc0: 4d65 7468 6f64 2074 6f20 7365 7420 5a5f  Method to set Z_
+00028fd0: 7661 6c75 6573 2073 7472 6169 6768 7466  values straightf
+00028fe0: 6f72 7761 7264 6c79 2066 726f 6d20 5a6f  orwardly from Zo
+00028ff0: 6e67 6520 4173 7461 7469 6320 6669 6c65  nge Astatic file
+00029000: 202e 200d 0a20 2020 2020 2020 0d0a 2020   . ..       ..  
+00029010: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00029020: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00029030: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2020  -----..         
+00029040: 2020 202a 207a 5f61 7272 6179 203a 2070     * z_array : p
+00029050: 642e 4461 7461 4672 616d 6520 2c0d 0a20  d.DataFrame ,.. 
+00029060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029070: 2020 2020 2020 2061 6464 6564 2076 616c         added val
+00029080: 7565 7320 6672 6f6d 2061 7374 6174 6963  ues from astatic
+00029090: 2066 696c 6573 2e20 0d0a 2020 2020 2020   files. ..      
+000290a0: 2020 2020 2020 2a20 6e75 6d62 6572 5f6f        * number_o
+000290b0: 665f 6672 6571 7565 6e63 7920 3a20 2069  f_frequency :  i
+000290c0: 6e74 2020 2c20 0d0a 2020 2020 2020 2020  nt  , ..        
+000290d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000290e0: 6e75 6d62 6572 206f 6620 6672 6571 7565  number of freque
+000290f0: 6e63 7920 7573 6564 2064 7572 696e 6720  ncy used during 
+00029100: 7375 7276 6579 732e 0d0a 2020 2020 2020  surveys...      
+00029110: 2020 2020 2020 2a20 6e75 6d62 6572 5f6f        * number_o
+00029120: 665f 7374 6174 696f 6e73 203a 696e 7420  f_stations :int 
+00029130: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00029140: 2020 2020 2020 2020 2020 2020 6469 6666              diff
+00029150: 6572 656e 7473 2073 7572 7665 7920 6672  erents survey fr
+00029160: 6571 7565 6e63 6965 732e 0d0a 2020 2020  equencies...    
+00029170: 2020 2020 2020 2020 2a20 4672 6571 7565          * Freque
+00029180: 6e63 7920 3a20 6172 7261 795f 6c69 6b65  ncy : array_like
+00029190: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000291a0: 2020 2020 2020 2020 2020 6672 6571 7565            freque
+000291b0: 6e63 7920 6172 7261 7920 756e 6974 7320  ncy array units 
+000291c0: 696e 2048 7a20 200d 0a20 2020 2020 2020  in Hz  ..       
+000291d0: 2020 2020 200d 0a20 2020 2020 2020 202e       ..        .
+000291e0: 2e20 4e6f 7465 7320 3a3a 200d 0a20 2020  . Notes :: ..   
+000291f0: 2020 2020 2020 2020 2020 6170 7072 6f70            approp
+00029200: 7269 6174 6520 636f 6e76 6572 7465 7220  riate converter 
+00029210: 2073 686f 756c 6420 6265 200d 0a20 2020   should be ..   
+00029220: 2020 2020 2020 2020 2020 2d20 3148 7a20            - 1Hz 
+00029230: 2d2d 3e20 2036 2e32 3831 3430 3730 342c  -->  6.28140704,
+00029240: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00029250: 2d20 6465 672d 7261 6420 2d2d 3e20 7468  - deg-rad --> th
+00029260: 6574 6128 6465 6729 202a 6e70 2e70 692f  eta(deg) *np.pi/
+00029270: 3138 3020 0d0a 2020 2020 2020 2020 2020  180 ..          
+00029280: 2020 202d 206d 7520 2076 6163 6375 6d20     - mu  vaccum 
+00029290: 7065 726d 6974 6976 6974 7920 7769 7468  permitivity with
+000292a0: 2020 7363 6970 792e 636f 6e73 7461 6e74    scipy.constant
+000292b0: 732e 6570 7369 6c6f 6e5f 300d 0a20 2020  s.epsilon_0..   
+000292c0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+000292d0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+000292e0: 2e5f 6c6f 6767 696e 672e 696e 666f 2827  ._logging.info('
+000292f0: 5472 616e 7366 6572 696e 6720 4173 7461  Transfering Asta
+00029300: 7469 6320 5a20 6461 7461 202e 2729 0d0a  tic Z data .')..
+00029310: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00029320: 2020 6966 207a 5f61 6273 5f61 7272 6179    if z_abs_array
+00029330: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
+00029340: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00029350: 662e 7a41 5320 3d20 7a5f 6162 735f 6172  f.zAS = z_abs_ar
+00029360: 7261 7920 0d0a 2020 2020 2020 2020 6966  ray ..        if
+00029370: 2073 656c 662e 7a41 5320 6973 204e 6f6e   self.zAS is Non
+00029380: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+00029390: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+000293a0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+000293b0: 2020 2020 274e 6f20 7a6f 6e67 6520 4173      'No zonge As
+000293c0: 7461 7469 6320 2064 6174 6120 666f 756e  tatic  data foun
+000293d0: 6420 2021 2729 2020 2020 2020 2020 2020  d  !')          
+000293e0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000293f0: 0d0a 2020 2020 2020 2020 6966 206e 756d  ..        if num
+00029400: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
+00029410: 6573 2069 7320 6e6f 7420 4e6f 6e65 203a  es is not None :
+00029420: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00029430: 6c66 2e6e 6672 6571 203d 206e 756d 6265  lf.nfreq = numbe
+00029440: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
+00029450: 200d 0a20 2020 2020 2020 2065 6c73 6520   ..        else 
+00029460: 3a72 6169 7365 2054 7970 6545 7272 6f72  :raise TypeError
+00029470: 280d 0a20 2020 2020 2020 2020 2020 2022  (..            "
+00029480: 506c 6561 7365 2073 7065 6369 6679 2074  Please specify t
+00029490: 6865 206e 756d 6265 7220 6f66 2066 7265  he number of fre
+000294a0: 7175 656e 6379 2021 2229 0d0a 2020 2020  quency !")..    
+000294b0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+000294c0: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
+000294d0: 6f6e 7320 6973 206e 6f74 204e 6f6e 6520  ons is not None 
+000294e0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000294f0: 7365 6c66 2e6e 756d 6265 725f 6f66 5f73  self.number_of_s
+00029500: 7461 7469 6f6e 733d 206e 756d 6265 725f  tations= number_
+00029510: 6f66 5f73 7461 7469 6f6e 730d 0a20 2020  of_stations..   
+00029520: 2020 2020 2065 6c73 6520 3a20 0d0a 2020       else : ..  
+00029530: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00029540: 5479 7065 4572 726f 7228 0d0a 2020 2020  TypeError(..    
+00029550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029570: 2750 6c65 6173 6520 7370 6563 6966 7920  'Please specify 
+00029580: 7468 6520 6e75 6d62 6572 206f 6620 7374  the number of st
+00029590: 6174 696f 6e73 2729 0d0a 0d0a 2020 2020  ations')....    
+000295a0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+000295b0: 2074 7970 6528 7365 6c66 2e7a 4153 2920   type(self.zAS) 
+000295c0: 3d3d 2070 642e 636f 7265 2e66 7261 6d65  == pd.core.frame
+000295d0: 2e44 6174 6146 7261 6d65 203a 200d 0a20  .DataFrame : .. 
+000295e0: 2020 2020 2020 2020 2020 2066 6f72 2077             for w
+000295f0: 6774 2069 6e20 6c69 7374 2873 656c 662e  gt in list(self.
+00029600: 7a41 532e 636f 6c75 6d6e 7329 3a20 0d0a  zAS.columns): ..
+00029610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029620: 6966 2077 6774 203d 3d20 275a 2e6d 7767  if wgt == 'Z.mwg
+00029630: 7427 206f 7220 7767 7420 3d3d 2027 452e  t' or wgt == 'E.
+00029640: 7767 7427 3a20 0d0a 2020 2020 2020 2020  wgt': ..        
+00029650: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00029660: 2e7a 5f6d 7767 7420 3d73 656c 662e 7a41  .z_mwgt =self.zA
+00029670: 535b 7767 745d 2e74 6f5f 6e75 6d70 7928  S[wgt].to_numpy(
+00029680: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00029690: 2020 2069 6620 7767 7420 3d3d 2027 5a2e     if wgt == 'Z.
+000296a0: 7077 6774 2720 6f72 2077 6774 203d 3d27  pwgt' or wgt =='
+000296b0: 422e 7767 7427 3a0d 0a20 2020 2020 2020  B.wgt':..       
+000296c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000296d0: 662e 7a5f 7077 6774 203d 7365 6c66 2e7a  f.z_pwgt =self.z
+000296e0: 4153 5b27 5a2e 7077 6774 275d 2e74 6f5f  AS['Z.pwgt'].to_
+000296f0: 6e75 6d70 7928 290d 0a20 2020 2020 2020  numpy()..       
+00029700: 2020 2020 2020 2020 2069 6620 7767 7420           if wgt 
+00029710: 3d3d 2027 5a2e 2565 7272 273a 200d 0a20  == 'Z.%err': .. 
+00029720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029730: 2020 2073 656c 662e 5f7a 5f65 7272 203d     self._z_err =
+00029740: 7365 6c66 2e7a 4153 5b77 6774 5d2e 746f  self.zAS[wgt].to
+00029750: 5f6e 756d 7079 2829 0d0a 2020 2020 2020  _numpy()..      
+00029760: 2020 2020 2020 2020 2020 6966 2077 6774            if wgt
+00029770: 203d 3d20 275a 2e6d 6167 2720 3a20 7a61   == 'Z.mag' : za
+00029780: 6273 5f61 7272 6179 203d 7365 6c66 2e7a  bs_array =self.z
+00029790: 4153 5b77 6774 5d2e 746f 5f6e 756d 7079  AS[wgt].to_numpy
+000297a0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+000297b0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+000297c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000297d0: 7472 7920 3a20 0d0a 2020 2020 2020 2020  try : ..        
+000297e0: 2020 2020 7365 6c66 2e6e 6672 6571 202c      self.nfreq ,
+000297f0: 2073 656c 662e 6e75 6d62 6572 5f6f 665f   self.number_of_
+00029800: 7374 6174 696f 6e73 203d 6e70 2e69 6e74  stations =np.int
+00029810: 2873 656c 662e 6e66 7265 7129 2c5c 0d0a  (self.nfreq),\..
+00029820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029830: 6e70 2e69 6e74 2873 656c 662e 6e75 6d62  np.int(self.numb
+00029840: 6572 5f6f 665f 7374 6174 696f 6e73 290d  er_of_stations).
+00029850: 0a20 2020 2020 2020 2020 2020 207a 6162  .            zab
+00029860: 735f 6172 7261 793d 6e70 2e61 7272 6179  s_array=np.array
+00029870: 285b 6e70 2e66 6c6f 6174 2863 6329 2066  ([np.float(cc) f
+00029880: 6f72 2063 6320 696e 207a 6162 735f 6172  or cc in zabs_ar
+00029890: 7261 795d 290d 0a20 2020 2020 2020 2065  ray])..        e
+000298a0: 7863 6570 7420 3a0d 0a20 2020 2020 2020  xcept :..       
+000298b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000298c0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+000298d0: 2020 2020 2020 2020 2256 616c 7565 7320          "Values 
+000298e0: 7072 6f76 6964 6564 2066 6f72 205a 2d61  provided for Z-a
+000298f0: 7374 6174 6963 2061 7265 2077 726f 6e67  static are wrong
+00029900: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
+00029910: 2020 2020 2220 6368 6563 6b20 796f 7572      " check your
+00029920: 205a 6f6e 6765 2041 5647 2066 696c 6520   Zonge AVG file 
+00029930: 2e22 2920 2020 2020 2020 200d 0a20 2020  .")        ..   
+00029940: 2020 2020 200d 0a20 200d 0a20 2020 2020       ..  ..     
+00029950: 2020 2073 656c 662e 6d61 782c 2073 656c     self.max, sel
+00029960: 662e 6d69 6e20 3d7a 6162 735f 6172 7261  f.min =zabs_arra
+00029970: 792e 6d61 7828 292c 207a 6162 735f 6172  y.max(), zabs_ar
+00029980: 7261 792e 6d69 6e28 290d 0a20 2020 2020  ray.min()..     
+00029990: 2020 200d 0a20 2020 2020 2020 2074 7275     ..        tru
+000299a0: 6e63 6174 6564 5f7a 7a3d 5a63 632e 7472  ncated_zz=Zcc.tr
+000299b0: 756e 6361 7465 645f 6461 7461 2820 6461  uncated_data( da
+000299c0: 7461 203d 7a61 6273 5f61 7272 6179 2c20  ta =zabs_array, 
+000299d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000299e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000299f0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+00029a00: 6f66 5f72 6563 6375 7265 6e63 653d 7365  of_reccurence=se
+00029a10: 6c66 2e6e 6672 6571 290d 0a20 2020 2020  lf.nfreq)..     
+00029a20: 2020 206e 616d 652c 2070 6f6c 796e 616d     name, polynam
+00029a30: 6520 3d20 5a63 632e 5f6e 756d 6265 7269  e = Zcc._numberi
+00029a40: 6e67 5f73 7461 7469 6f6e 280d 0a20 2020  ng_station(..   
+00029a50: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+00029a60: 6f66 5f73 7461 7469 6f6e 3d73 656c 662e  of_station=self.
+00029a70: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+00029a80: 6e73 2c20 0d0a 2020 2020 2020 2020 2020  ns, ..          
+00029a90: 2020 206e 756d 6265 725f 6f66 5f66 7265     number_of_fre
+00029aa0: 7120 3d73 656c 662e 6e66 7265 7129 0d0a  q =self.nfreq)..
+00029ab0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00029ac0: 2020 7365 6c66 2e6c 6f63 203d 7b20 6b65    self.loc ={ ke
+00029ad0: 793a 7661 6c75 6520 666f 7220 6b65 792c  y:value for key,
+00029ae0: 2076 616c 7565 2069 6e20 7a69 7028 6e61   value in zip(na
+00029af0: 6d65 2c20 7472 756e 6361 7465 645f 7a7a  me, truncated_zz
+00029b00: 2029 7d0d 0a20 2020 2020 2020 200d 0a0d   )}..        ...
+00029b10: 0a63 6c61 7373 2070 6345 6d61 6720 286f  .class pcEmag (o
+00029b20: 626a 6563 7429 3a0d 0a20 2020 2022 2222  bject):..    """
+00029b30: 0d0a 2020 2020 5374 6174 6973 7469 6361  ..    Statistica
+00029b40: 6c20 7661 7269 6174 696f 6e20 6f66 206d  l variation of m
+00029b50: 6167 6e69 7475 6465 2076 616c 7565 7320  agnitude values 
+00029b60: 6672 6f6d 200d 0a20 2020 2061 7665 7261  from ..    avera
+00029b70: 6765 6420 6461 7461 2062 6c6f 636b 732e  ged data blocks.
+00029b80: 0d0a 2020 2020 0d0a 2020 2020 5374 616e  ..    ..    Stan
+00029b90: 6461 7264 2044 6576 6961 7469 6f6e 2f41  dard Deviation/A
+00029ba0: 7665 7261 6765 2045 6d61 6720 2870 6572  verage Emag (per
+00029bb0: 6365 6e74 290d 0a20 2020 2020 2020 200d  cent)..        .
+00029bc0: 0a20 2020 2041 7267 756d 656e 7473 200d  .    Arguments .
+00029bd0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
+00029be0: 0a20 2020 2020 2020 202a 2a70 6345 6d61  .        **pcEma
+00029bf0: 672a 2a20 3a20 6e64 6172 7261 790d 0a20  g** : ndarray.. 
+00029c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c10: 2020 2064 6174 6120 6172 7261 7920 6f66     data array of
+00029c20: 2073 7461 7469 7374 6963 616c 2076 6172   statistical var
+00029c30: 6961 7461 696f 6e0d 0a20 2020 2020 2020  iataion..       
+00029c40: 2020 2020 2020 2020 2020 2020 206f 6620               of 
+00029c50: 456d 6167 2076 616c 7565 206f 6e20 7468  Emag value on th
+00029c60: 6520 6669 656c 642e 0d0a 2020 2020 2020  e field...      
+00029c70: 2020 2020 2020 0d0a 2020 2020 3d3d 3d3d        ..    ====
+00029c80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
+00029c90: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+00029ca0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00029cb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00029cc0: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2041 7474  =======..    Att
+00029cd0: 7269 6275 7465 7320 2020 2020 2020 2020  ributes         
+00029ce0: 5479 7065 2020 2020 2020 2020 4578 706c  Type        Expl
+00029cf0: 616e 6174 696f 6e0d 0a20 2020 203d 3d3d  anation..    ===
+00029d00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
+00029d10: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
+00029d20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00029d30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00029d40: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 7661  ========..    va
+00029d50: 6c75 6520 2020 2020 2020 2020 2020 2020  lue             
+00029d60: 6e64 2e61 7272 6179 2020 2020 2020 6461  nd.array      da
+00029d70: 7461 206f 6620 7063 456d 6167 2020 636f  ta of pcEmag  co
+00029d80: 6c75 6d6e 2020 206f 6e20 6176 6766 696c  lumn   on avgfil
+00029d90: 650d 0a20 2020 206d 6178 2020 2020 2020  e..    max      
+00029da0: 2020 2020 2020 2020 2066 6c6f 6174 2020           float  
+00029db0: 2020 2020 2020 206d 6178 696d 756d 2025         maximum %
+00029dc0: 2076 616c 7565 206f 6620 7063 2045 6d61   value of pc Ema
+00029dd0: 670d 0a20 2020 206d 696e 2020 2020 2020  g..    min      
+00029de0: 2020 2020 2020 2020 2066 6c6f 6174 2020           float  
+00029df0: 2020 2020 2020 206d 696e 696d 756d 2025         minimum %
+00029e00: 2076 616c 7565 206f 6620 7063 456d 6167   value of pcEmag
+00029e10: 200d 0a20 2020 206c 6f63 2020 2020 2020   ..    loc      
+00029e20: 2020 2020 2020 2020 2064 6963 7420 2020           dict   
+00029e30: 2020 2020 2020 206c 6f63 6174 696f 6e20         location 
+00029e40: 6f66 2025 4570 687a 206d 6167 6e69 7475  of %Ephz magnitu
+00029e50: 6465 0d0a 2020 2020 2020 2020 2020 2020  de..            
+00029e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e70: 2020 2020 2020 2020 7661 6c75 6520 6174          value at
+00029e80: 2074 6865 2073 7461 7469 6f6e 206c 616d   the station lam
+00029e90: 6264 6120 653a 6720 2e6c 6f63 5b27 5330  bda e:g .loc['S0
+00029ea0: 3527 5d0d 0a20 2020 2020 2020 2020 2020  5']..           
+00029eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ec0: 2020 2020 2020 2020 2073 686f 7720 7468           show th
+00029ed0: 6520 6375 7272 656e 7420 2048 2d6d 6167  e current  H-mag
+00029ee0: 2064 6174 6120 0d0a 2020 2020 2020 2020   data ..        
+00029ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f00: 2020 2020 2020 2020 2020 2020 6f66 2073              of s
+00029f10: 7461 7469 6f6e 2061 7420 5330 352e 0d0a  tation at S05...
+00029f20: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
+00029f30: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
+00029f40: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
+00029f50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00029f60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+00029f70: 0a0d 0a20 2020 204d 6f72 6520 6174 7472  ...    More attr
+00029f80: 6962 7574 6573 2063 616e 2062 6520 6164  ibutes can be ad
+00029f90: 6465 6420 6279 2069 6e70 7574 696e 6720  ded by inputing 
+00029fa0: 6120 6b65 7920 776f 7264 2064 6963 7469  a key word dicti
+00029fb0: 6f6e 6172 790d 0a20 2020 200d 0a20 2020  onary..    ..   
+00029fc0: 203a 4578 616d 706c 653a 0d0a 2020 2020   :Example:..    
+00029fd0: 2020 2020 0d0a 2020 2020 2020 2020 3e3e      ..        >>
+00029fe0: 3e20 6672 6f6d 2070 7963 7361 6d74 2e63  > from pycsamt.c
+00029ff0: 6f72 652e 6176 6720 696d 706f 7274 2041  ore.avg import A
+0002a000: 7667 200d 0a20 2020 2020 2020 203e 3e3e  vg ..        >>>
+0002a010: 2070 6174 683d 6f73 2e70 6174 682e 6a6f   path=os.path.jo
+0002a020: 696e 286f 732e 656e 7669 726f 6e5b 2270  in(os.environ["p
+0002a030: 7943 5341 4d54 225d 2c20 0d0a 2020 2020  yCSAMT"], ..    
+0002a040: 2020 2020 2e2e 2e20 2020 2020 2027 7079      ...      'py
+0002a050: 6373 616d 7427 2c20 2264 6174 6122 2c20  csamt', "data", 
+0002a060: 224b 312e 4156 4722 290d 0a20 2020 2020  "K1.AVG")..     
+0002a070: 2020 203e 3e3e 2061 7667 5f6f 626a 3d41     >>> avg_obj=A
+0002a080: 7667 2870 6174 6829 0d0a 2020 2020 2020  vg(path)..      
+0002a090: 2020 3e3e 3e20 7063 656d 6167 5f6f 626a    >>> pcemag_obj
+0002a0a0: 203d 6176 675f 6f62 6a2e 4461 7461 5f73   =avg_obj.Data_s
+0002a0b0: 6563 7469 6f6e 2e70 6345 6d61 672e 6c6f  ection.pcEmag.lo
+0002a0c0: 635b 2753 3035 275d 0d0a 2020 2020 2020  c['S05']..      
+0002a0d0: 2020 3e3e 3e20 7072 696e 7428 7063 656d    >>> print(pcem
+0002a0e0: 6167 5f6f 626a 290d 0a20 2020 2022 2222  ag_obj)..    """
+0002a0f0: 0d0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+0002a100: 5f5f 2873 656c 662c 2070 635f 655f 6d61  __(self, pc_e_ma
+0002a110: 675f 6172 7261 793d 4e6f 6e65 2c20 0d0a  g_array=None, ..
+0002a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a130: 206e 756d 6265 725f 6f66 5f66 7265 7175   number_of_frequ
+0002a140: 656e 6369 6573 3d4e 6f6e 6520 2c20 6e75  encies=None , nu
+0002a150: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0002a160: 3d4e 6f6e 6520 2c20 0d0a 2020 2020 2020  =None , ..      
+0002a170: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
+0002a180: 7267 7329 3a0d 0a20 2020 2020 2020 200d  rgs):..        .
+0002a190: 0a20 2020 2020 2020 2073 656c 662e 5f70  .        self._p
+0002a1a0: 6345 6d61 6720 3d70 635f 655f 6d61 675f  cEmag =pc_e_mag_
+0002a1b0: 6172 7261 790d 0a20 2020 2020 2020 200d  array..        .
+0002a1c0: 0a20 2020 2020 2020 2073 656c 662e 6e75  .        self.nu
+0002a1d0: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0002a1e0: 203d 6b77 6172 6773 2e70 6f70 2822 6e75   =kwargs.pop("nu
+0002a1f0: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0002a200: 222c 204e 6f6e 6529 0d0a 2020 2020 2020  ", None)..      
+0002a210: 2020 7365 6c66 2e6e 6672 6571 203d 6b77    self.nfreq =kw
+0002a220: 6172 6773 2e70 6f70 2827 6e75 6d62 6572  args.pop('number
+0002a230: 5f6f 665f 6672 6571 7565 6e63 6965 7327  _of_frequencies'
+0002a240: 2c20 4e6f 6e65 290d 0a20 2020 2020 2020  , None)..       
+0002a250: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+0002a260: 7661 6c75 6520 3d4e 6f6e 6520 0d0a 2020  value =None ..  
+0002a270: 2020 2020 2020 7365 6c66 2e6d 696e 203d        self.min =
+0002a280: 204e 6f6e 6520 0d0a 2020 2020 2020 2020   None ..        
+0002a290: 7365 6c66 2e6d 6178 203d 204e 6f6e 6520  self.max = None 
+0002a2a0: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
+0002a2b0: 666f 7220 6b65 7920 696e 206c 6973 7428  for key in list(
+0002a2c0: 6b77 6172 6773 2e6b 6579 7328 2929 3a0d  kwargs.keys()):.
+0002a2d0: 0a20 2020 2020 2020 2020 2020 2073 6574  .            set
+0002a2e0: 6174 7472 2873 656c 662c 206b 6579 2c20  attr(self, key, 
+0002a2f0: 6b77 6172 6773 5b6b 6579 5d29 0d0a 2020  kwargs[key])..  
+0002a300: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0002a310: 2020 2020 6966 2073 656c 662e 5f70 6345      if self._pcE
+0002a320: 6d61 6720 2069 7320 6e6f 7420 4e6f 6e65  mag  is not None
+0002a330: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+0002a340: 2073 656c 662e 5f72 6561 645f 7063 456d   self._read_pcEm
+0002a350: 6167 5f64 6174 6120 2829 0d0a 2020 2020  ag_data ()..    
+0002a360: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
+0002a370: 2020 2020 6465 6620 5f72 6561 645f 7063      def _read_pc
+0002a380: 456d 6167 5f64 6174 6120 2873 656c 662c  Emag_data (self,
+0002a390: 7063 5f65 5f6d 6167 5f61 7272 6179 3d4e  pc_e_mag_array=N
+0002a3a0: 6f6e 652c 206e 756d 6265 725f 6f66 5f66  one, number_of_f
+0002a3b0: 7265 7175 656e 6369 6573 3d4e 6f6e 6520  requencies=None 
+0002a3c0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0002a3d0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0002a3e0: 6265 725f 6f66 5f73 7461 7469 6f6e 733d  ber_of_stations=
+0002a3f0: 4e6f 6e65 2029 3a0d 0a20 2020 2020 2020  None ):..       
+0002a400: 2022 2222 0d0a 2020 2020 2020 2020 4d65   """..        Me
+0002a410: 7468 6f64 2074 6f20 7265 6164 2061 6e64  thod to read and
+0002a420: 2061 7261 6e67 6520 6461 7461 2061 6363   arange data acc
+0002a430: 6f72 6469 6e67 2065 6163 6820 7374 6174  ording each stat
+0002a440: 696f 6e20 2f53 7461 7469 7374 6963 616c  ion /Statistical
+0002a450: 200d 0a20 2020 2020 2020 2020 2020 7661   ..           va
+0002a460: 7269 6174 696f 6e20 6f66 2020 452d 4669  riation of  E-Fi
+0002a470: 656c 6420 6d61 676e 6974 7564 6520 7661  eld magnitude va
+0002a480: 6c75 6573 202e 0d0a 2020 2020 2020 2020  lues ...        
+0002a490: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0002a4a0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0002a4b0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0002a4c0: 2020 2020 2020 2a20 7063 5f65 5f6d 6167        * pc_e_mag
+0002a4d0: 5f61 7272 6179 203a 206e 6461 7272 6179  _array : ndarray
+0002a4e0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+0002a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a500: 2020 2020 2020 2020 2020 2020 452d 4669              E-Fi
+0002a510: 656c 6420 7374 6420 7661 7269 6174 696f  eld std variatio
+0002a520: 6e20 206f 6273 6572 7665 6420 6174 2065  n  observed at e
+0002a530: 6163 6820 7374 6174 696f 6e2e 0d0a 2020  ach station...  
+0002a540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a550: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+0002a560: 6520 6465 6661 756c 7420 6973 204e 6f6e  e default is Non
+0002a570: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
+0002a580: 2a20 6e75 6d62 6572 5f6f 665f 6672 6571  * number_of_freq
+0002a590: 7565 6e63 6965 7320 3a20 696e 7420 2c20  uencies : int , 
+0002a5a0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+0002a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a5c0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+0002a5d0: 6d62 6572 206f 6620 6672 6571 7565 6e63  mber of frequenc
+0002a5e0: 6965 7320 666f 7220 7375 7276 6579 2e20  ies for survey. 
+0002a5f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002a600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a610: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
+0002a620: 7420 6973 204e 6f6e 652e 0d0a 2020 2020  t is None...    
+0002a630: 2020 2020 2020 2020 2a20 6e75 6d62 6572          * number
+0002a640: 5f6f 665f 7374 6174 696f 6e73 203a 2069  _of_stations : i
+0002a650: 6e74 202c 206f 7074 696f 6e61 6c0d 0a20  nt , optional.. 
+0002a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a670: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0002a680: 756d 6265 725f 6f66 2073 7461 7469 6f6e  umber_of station
+0002a690: 732e 2054 6865 2064 6566 6175 6c74 2069  s. The default i
+0002a6a0: 7320 4e6f 6e65 2e0d 0a20 2020 2020 2020  s None...       
+0002a6b0: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+0002a6c0: 2070 635f 655f 6d61 675f 6172 7261 7920   pc_e_mag_array 
+0002a6d0: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
+0002a6e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002a6f0: 2e5f 7063 456d 6167 203d 7063 5f65 5f6d  ._pcEmag =pc_e_m
+0002a700: 6167 5f61 7272 6179 200d 0a20 2020 2020  ag_array ..     
+0002a710: 2020 2069 6620 7365 6c66 2e5f 7063 456d     if self._pcEm
+0002a720: 6167 2069 7320 4e6f 6e65 203a 200d 0a20  ag is None : .. 
+0002a730: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002a740: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
+0002a750: 2020 2020 2020 2020 2020 2020 2027 4e6f               'No
+0002a760: 2045 2d6d 6167 2073 7461 7469 7374 6963   E-mag statistic
+0002a770: 616c 2076 6172 6961 7469 6f6e 2020 6461  al variation  da
+0002a780: 7461 2066 6f75 6e64 2020 2127 290d 0a20  ta found  !').. 
+0002a790: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0002a7a0: 2020 2020 2069 6620 6e75 6d62 6572 5f6f       if number_o
+0002a7b0: 665f 6672 6571 7565 6e63 6965 7320 6973  f_frequencies is
+0002a7c0: 206e 6f74 204e 6f6e 6520 3a20 0d0a 2020   not None : ..  
+0002a7d0: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
+0002a7e0: 6672 6571 203d 6e75 6d62 6572 5f6f 665f  freq =number_of_
+0002a7f0: 6672 6571 7565 6e63 6965 7320 0d0a 2020  frequencies ..  
+0002a800: 2020 2020 2020 656c 7365 203a 0d0a 2020        else :..  
+0002a810: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002a820: 5479 7065 4572 726f 7228 0d0a 2020 2020  TypeError(..    
+0002a830: 2020 2020 2020 2020 2020 2020 2250 6c65              "Ple
+0002a840: 6173 6520 7370 6563 6966 7920 7468 6520  ase specify the 
+0002a850: 6e75 6d62 6572 206f 6620 6672 6571 7565  number of freque
+0002a860: 6e63 7920 2122 290d 0a20 2020 2020 2020  ncy !")..       
+0002a870: 2069 6620 6e75 6d62 6572 5f6f 665f 7374   if number_of_st
+0002a880: 6174 696f 6e73 2069 7320 6e6f 7420 4e6f  ations is not No
+0002a890: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
+0002a8a0: 2020 2073 656c 662e 6e75 6d62 6572 5f6f     self.number_o
+0002a8b0: 665f 7374 6174 696f 6e73 203d 6e75 6d62  f_stations =numb
+0002a8c0: 6572 5f6f 665f 7374 6174 696f 6e73 200d  er_of_stations .
+0002a8d0: 0a20 2020 2020 2020 2065 6c73 6520 3a20  .        else : 
+0002a8e0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0002a8f0: 0d0a 2020 2020 2020 2020 2020 2020 2750  ..            'P
+0002a900: 6c65 6173 6520 7370 6563 6966 7920 7468  lease specify th
+0002a910: 6520 6e75 6d62 6572 206f 6620 7374 6174  e number of stat
+0002a920: 696f 6e73 2729 0d0a 2020 2020 2020 2020  ions')..        
+0002a930: 2020 2020 0d0a 2020 2020 2020 2020 7472      ..        tr
+0002a940: 7920 3a20 0d0a 2020 2020 2020 2020 2020  y : ..          
+0002a950: 2020 7365 6c66 2e6e 6672 6571 202c 2073    self.nfreq , s
+0002a960: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
+0002a970: 6174 696f 6e73 203d 6e70 2e69 6e74 2873  ations =np.int(s
+0002a980: 656c 662e 6e66 7265 7129 2c5c 0d0a 2020  elf.nfreq),\..  
+0002a990: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+0002a9a0: 2e69 6e74 2873 656c 662e 6e75 6d62 6572  .int(self.number
+0002a9b0: 5f6f 665f 7374 6174 696f 6e73 290d 0a20  _of_stations).. 
+0002a9c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002a9d0: 5f70 6345 6d61 673d 6e70 2e61 7272 6179  _pcEmag=np.array
+0002a9e0: 285b 6e70 2e66 6c6f 6174 2863 6329 2066  ([np.float(cc) f
+0002a9f0: 6f72 2063 6320 696e 2073 656c 662e 5f70  or cc in self._p
+0002aa00: 6345 6d61 675d 290d 0a0d 0a20 2020 2020  cEmag])....     
+0002aa10: 2020 2065 7863 6570 7420 3a20 7261 6973     except : rais
+0002aa20: 6520 5661 6c75 6545 7272 6f72 280d 0a20  e ValueError(.. 
+0002aa30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002aa40: 5661 6c75 6573 2070 726f 7669 6465 6420  Values provided 
+0002aa50: 666f 7220 7468 6520 452d 6d61 6720 7374  for the E-mag st
+0002aa60: 6174 2e76 6172 6961 7469 6f6e 2020 6172  at.variation  ar
+0002aa70: 6520 7772 6f6e 672e 220d 0a20 2020 2020  e wrong."..     
+0002aa80: 2020 2020 2020 2020 2020 2022 206d 7573             " mus
+0002aa90: 7420 6265 2066 6c6f 6174 206f 7220 696e  t be float or in
+0002aaa0: 7465 6765 7220 2e22 290d 0a20 2020 2020  teger .")..     
+0002aab0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002aac0: 2076 636f 756e 7473 5f45 6d61 672c 2072   vcounts_Emag, r
+0002aad0: 6570 6561 745f 456d 6167 203d 6e70 2e75  epeat_Emag =np.u
+0002aae0: 6e69 7175 6520 2873 656c 662e 5f70 6345  nique (self._pcE
+0002aaf0: 6d61 672c 2072 6574 7572 6e5f 636f 756e  mag, return_coun
+0002ab00: 7473 3d54 7275 6529 0d0a 2020 2020 2020  ts=True)..      
+0002ab10: 2020 7365 6c66 2e76 616c 7565 203d 7663    self.value =vc
+0002ab20: 6f75 6e74 735f 456d 6167 0d0a 2020 2020  ounts_Emag..    
+0002ab30: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+0002ab40: 6c66 2e6d 6178 2c20 7365 6c66 2e6d 696e  lf.max, self.min
+0002ab50: 203d 7663 6f75 6e74 735f 456d 6167 2e6d   =vcounts_Emag.m
+0002ab60: 6178 2829 2c20 7663 6f75 6e74 735f 456d  ax(), vcounts_Em
+0002ab70: 6167 2e6d 696e 2829 0d0a 2020 2020 2020  ag.min()..      
+0002ab80: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+0002ab90: 2020 2020 2020 7472 756e 6361 7465 645f        truncated_
+0002aba0: 7063 456d 6167 3d5a 6363 2e74 7275 6e63  pcEmag=Zcc.trunc
+0002abb0: 6174 6564 5f64 6174 6128 2064 6174 6120  ated_data( data 
+0002abc0: 3d73 656c 662e 5f70 6345 6d61 672c 200d  =self._pcEmag, .
+0002abd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002abe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002abf0: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+0002ac00: 665f 7265 6363 7572 656e 6365 3d73 656c  f_reccurence=sel
+0002ac10: 662e 6e66 7265 7129 0d0a 2020 2020 2020  f.nfreq)..      
+0002ac20: 2020 6e61 6d65 2c20 706f 6c79 6e61 6d65    name, polyname
+0002ac30: 203d 205a 6363 2e5f 6e75 6d62 6572 696e   = Zcc._numberin
+0002ac40: 675f 7374 6174 696f 6e28 0d0a 2020 2020  g_station(..    
+0002ac50: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+0002ac60: 665f 7374 6174 696f 6e3d 7365 6c66 2e6e  f_station=self.n
+0002ac70: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+0002ac80: 732c 200d 0a20 2020 2020 2020 2020 2020  s, ..           
+0002ac90: 206e 756d 6265 725f 6f66 5f66 7265 7120   number_of_freq 
+0002aca0: 3d73 656c 662e 6e66 7265 7129 0d0a 2020  =self.nfreq)..  
+0002acb0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0002acc0: 7365 6c66 2e6c 6f63 203d 7b20 6b65 793a  self.loc ={ key:
+0002acd0: 7661 6c75 6520 666f 7220 6b65 792c 2076  value for key, v
+0002ace0: 616c 7565 2069 6e20 7a69 7028 6e61 6d65  alue in zip(name
+0002acf0: 2c20 7472 756e 6361 7465 645f 7063 456d  , truncated_pcEm
+0002ad00: 6167 297d 0d0a 2020 2020 2020 2020 0d0a  ag)}..        ..
+0002ad10: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0002ad20: 2020 0d0a 636c 6173 7320 7345 7068 7a28    ..class sEphz(
+0002ad30: 6f62 6a65 6374 2920 3a20 0d0a 2020 2020  object) : ..    
+0002ad40: 2222 220d 0a20 2020 2053 7461 7469 7374  """..    Statist
+0002ad50: 6963 616c 2076 6172 6961 7469 6f6e 206f  ical variation o
+0002ad60: 6620 7468 6520 6461 7461 2062 6c6f 636b  f the data block
+0002ad70: 7320 6176 6572 6167 6564 2066 6f72 2074  s averaged for t
+0002ad80: 6869 7320 6461 7461 2070 6f69 6e74 2e0d  his data point..
+0002ad90: 0a20 2020 2031 3030 202a 2053 7461 6e64  .    100 * Stand
+0002ada0: 6172 6420 4465 7669 6174 696f 6e20 6f66  ard Deviation of
+0002adb0: 2045 7068 7a20 7661 6c75 6573 2028 6d69   Ephz values (mi
+0002adc0: 6c6c 6972 6164 6961 6e73 290d 0a20 2020  lliradians)..   
+0002add0: 2020 2020 200d 0a20 2020 2041 7267 756d       ..    Argum
+0002ade0: 656e 7473 200d 0a20 2020 202d 2d2d 2d2d  ents ..    -----
+0002adf0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 202a  -----..        *
+0002ae00: 2a73 4570 687a 2a2a 2020 3a20 6e64 6172  *sEphz**  : ndar
+0002ae10: 7261 792c 0d0a 2020 2020 2020 2020 2020  ray,..          
+0002ae20: 2020 2020 2020 2020 2064 6174 6120 6172           data ar
+0002ae30: 7261 7920 6f66 2073 7461 7469 7374 6963  ray of statistic
+0002ae40: 616c 2076 6172 6961 7469 6f6e 206f 6620  al variation of 
+0002ae50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002ae60: 2020 2020 2045 7068 6173 6520 7661 6c75       Ephase valu
+0002ae70: 6520 6f6e 2074 6865 2066 6965 6c64 2e0d  e on the field..
+0002ae80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ae90: 2020 200d 0a20 2020 203d 3d3d 3d3d 3d3d     ..    =======
+0002aea0: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+0002aeb0: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
+0002aec0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002aed0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002aee0: 3d3d 3d3d 0d0a 2020 2020 4174 7472 6962  ====..    Attrib
+0002aef0: 7574 6573 2020 2020 2020 2020 2054 7970  utes         Typ
+0002af00: 6520 2020 2020 2020 2045 7870 6c61 6e61  e        Explana
+0002af10: 7469 6f6e 0d0a 2020 2020 3d3d 3d3d 3d3d  tion..    ======
+0002af20: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
+0002af30: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
+0002af40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002af50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002af60: 3d3d 3d3d 3d0d 0a20 2020 2076 616c 7565  =====..    value
+0002af70: 2020 2020 2020 2020 2020 2020 206e 642e               nd.
+0002af80: 6172 7261 7920 2020 2020 2064 6174 6120  array      data 
+0002af90: 6f66 2073 4870 687a 2020 636f 6c75 6d6e  of sHphz  column
+0002afa0: 2020 6f6e 2061 7667 6669 6c65 2020 200d    on avgfile   .
+0002afb0: 0a20 2020 206d 6178 2020 2020 2020 2020  .    max        
+0002afc0: 2020 2020 2020 2066 6c6f 6174 2020 2020         float    
+0002afd0: 2020 2020 206d 6178 696d 756d 2025 2076       maximum % v
+0002afe0: 616c 7565 206f 6620 7348 7068 7a0d 0a20  alue of sHphz.. 
+0002aff0: 2020 206d 696e 2020 2020 2020 2020 2020     min          
+0002b000: 2020 2020 2066 6c6f 6174 2020 2020 2020       float      
+0002b010: 2020 206d 696e 696d 756d 2020 7661 6c75     minimum  valu
+0002b020: 6520 6f66 2073 4870 687a 0d0a 2020 2020  e of sHphz..    
+0002b030: 6c6f 6320 2020 2020 2020 2020 2020 2020  loc             
+0002b040: 2020 6469 6374 2020 2020 2020 2020 2020    dict          
+0002b050: 6c6f 6361 7469 6f6e 206f 6620 7348 7068  location of sHph
+0002b060: 7a20 6d61 676e 6974 7564 650d 0a20 2020  z magnitude..   
+0002b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b090: 2076 616c 7565 2061 7420 7468 6520 7374   value at the st
+0002b0a0: 6174 696f 6e20 6c61 6d62 6461 0d0a 2020  ation lambda..  
+0002b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b0d0: 2020 652e 6720 3a20 6c6f 635b 2753 3434    e.g : loc['S44
+0002b0e0: 275d 2073 686f 7720 7468 6520 0d0a 2020  '] show the ..  
+0002b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b110: 2020 6375 7272 656e 7420 2073 4870 687a    current  sHphz
+0002b120: 2064 6174 6120 6f66 2073 7461 7469 6f6e   data of station
+0002b130: 2061 7420 5334 340d 0a20 2020 203d 3d3d   at S44..    ===
+0002b140: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
+0002b150: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
+0002b160: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002b170: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002b180: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 0d0a  ========..    ..
+0002b190: 2020 2020 4d6f 7265 2061 7474 7269 6275      More attribu
+0002b1a0: 7465 7320 6361 6e20 6265 2061 6464 6564  tes can be added
+0002b1b0: 2062 7920 696e 7075 7469 6e67 2061 206b   by inputing a k
+0002b1c0: 6579 2077 6f72 6420 6469 6374 696f 6e61  ey word dictiona
+0002b1d0: 7279 0d0a 2020 2020 0d0a 2020 2020 3a45  ry..    ..    :E
+0002b1e0: 7861 6d70 6c65 3a0d 0a20 2020 2020 2020  xample:..       
+0002b1f0: 2020 0d0a 2020 2020 2020 2020 3e3e 3e20    ..        >>> 
+0002b200: 6672 6f6d 2070 7963 7361 6d74 2e63 6f72  from pycsamt.cor
+0002b210: 652e 6176 6720 696d 706f 7274 2041 7667  e.avg import Avg
+0002b220: 200d 0a20 2020 2020 2020 203e 3e3e 2070   ..        >>> p
+0002b230: 6174 683d 6f73 2e70 6174 682e 6a6f 696e  ath=os.path.join
+0002b240: 286f 732e 656e 7669 726f 6e5b 2270 7943  (os.environ["pyC
+0002b250: 5341 4d54 225d 2c20 0d0a 2020 2020 2020  SAMT"], ..      
+0002b260: 2020 2020 2020 2020 2770 7963 7361 6d74          'pycsamt
+0002b270: 272c 2022 6461 7461 222c 2022 4b31 2e41  ', "data", "K1.A
+0002b280: 5647 2229 0d0a 2020 2020 2020 2020 3e3e  VG")..        >>
+0002b290: 3e20 6176 675f 6f62 6a3d 4176 6728 7061  > avg_obj=Avg(pa
+0002b2a0: 7468 290d 0a20 2020 2020 2020 203e 3e3e  th)..        >>>
+0002b2b0: 2073 6870 687a 5f6f 626a 203d 6176 675f   shphz_obj =avg_
+0002b2c0: 6f62 6a2e 4461 7461 5f73 6563 7469 6f6e  obj.Data_section
+0002b2d0: 2e73 4870 687a 2e6c 6f63 5b27 5334 3427  .sHphz.loc['S44'
+0002b2e0: 5d0d 0a20 2020 2020 2020 202e 2e2e 2070  ]..        ... p
+0002b2f0: 7269 6e74 2873 6870 687a 5f6f 626a 290d  rint(shphz_obj).
+0002b300: 0a20 2020 2022 2222 0d0a 2020 2020 6465  .    """..    de
+0002b310: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+0002b320: 2073 4570 687a 5f61 7272 6179 3d4e 6f6e   sEphz_array=Non
+0002b330: 652c 206e 756d 6265 725f 6f66 5f66 7265  e, number_of_fre
+0002b340: 7175 656e 6369 6573 3d4e 6f6e 6520 2c20  quencies=None , 
+0002b350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002b360: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
+0002b370: 7469 6f6e 733d 4e6f 6e65 202c 202a 2a6b  tions=None , **k
+0002b380: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
+0002b390: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+0002b3a0: 5f73 4570 687a 3d20 7345 7068 7a5f 6172  _sEphz= sEphz_ar
+0002b3b0: 7261 790d 0a20 2020 2020 2020 200d 0a20  ray..        .. 
+0002b3c0: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+0002b3d0: 6572 5f6f 665f 7374 6174 696f 6e73 203d  er_of_stations =
+0002b3e0: 6b77 6172 6773 2e70 6f70 2822 6e75 6d62  kwargs.pop("numb
+0002b3f0: 6572 5f6f 665f 7374 6174 696f 6e73 222c  er_of_stations",
+0002b400: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
+0002b410: 7365 6c66 2e6e 6672 6571 203d 6b77 6172  self.nfreq =kwar
+0002b420: 6773 2e70 6f70 2827 6e75 6d62 6572 5f6f  gs.pop('number_o
+0002b430: 665f 6672 6571 7565 6e63 6965 7327 2c20  f_frequencies', 
+0002b440: 4e6f 6e65 290d 0a20 2020 2020 2020 2073  None)..        s
+0002b450: 656c 662e 746f 5f64 6567 7265 6520 3d6b  elf.to_degree =k
+0002b460: 7761 7267 732e 706f 7028 2774 6f5f 6465  wargs.pop('to_de
+0002b470: 6772 6565 272c 2046 616c 7365 290d 0a20  gree', False).. 
+0002b480: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002b490: 2073 656c 662e 7661 6c75 6520 3d4e 6f6e   self.value =Non
+0002b4a0: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
+0002b4b0: 2e6d 696e 203d 204e 6f6e 6520 0d0a 2020  .min = None ..  
+0002b4c0: 2020 2020 2020 7365 6c66 2e6d 6178 203d        self.max =
+0002b4d0: 204e 6f6e 6520 0d0a 2020 2020 0d0a 2020   None ..    ..  
+0002b4e0: 2020 2020 2020 666f 7220 6b65 7920 696e        for key in
+0002b4f0: 206c 6973 7428 6b77 6172 6773 2e6b 6579   list(kwargs.key
+0002b500: 7328 2929 3a0d 0a20 2020 2020 2020 2020  s()):..         
+0002b510: 2020 2073 6574 6174 7472 2873 656c 662c     setattr(self,
+0002b520: 206b 6579 2c20 6b77 6172 6773 5b6b 6579   key, kwargs[key
+0002b530: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0002b540: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0002b550: 662e 5f73 4570 687a 2069 7320 6e6f 7420  f._sEphz is not 
+0002b560: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+0002b570: 2020 2020 2073 656c 662e 5f72 6561 645f       self._read_
+0002b580: 7345 7068 7a5f 6461 7461 2028 290d 0a20  sEphz_data ().. 
+0002b590: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002b5a0: 200d 0a20 2020 2064 6566 205f 7265 6164   ..    def _read
+0002b5b0: 5f73 4570 687a 5f64 6174 6120 2873 656c  _sEphz_data (sel
+0002b5c0: 662c 2073 4570 687a 5f61 7272 6179 3d4e  f, sEphz_array=N
+0002b5d0: 6f6e 652c 206e 756d 6265 725f 6f66 5f66  one, number_of_f
+0002b5e0: 7265 7175 656e 6369 6573 3d4e 6f6e 6520  requencies=None 
+0002b5f0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0002b600: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0002b610: 6265 725f 6f66 5f73 7461 7469 6f6e 733d  ber_of_stations=
+0002b620: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 2020  None, **kwargs  
+0002b630: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
+0002b640: 0a20 2020 2020 2020 204d 6574 686f 6420  .        Method 
+0002b650: 746f 2072 6561 6420 616e 6420 6172 616e  to read and aran
+0002b660: 6765 2064 6174 6120 6163 636f 7264 696e  ge data accordin
+0002b670: 6720 6561 6368 2073 7461 7469 6f6e 202f  g each station /
+0002b680: 5374 6174 6973 7469 6361 6c20 0d0a 2020  Statistical ..  
+0002b690: 2020 2020 2020 7661 7269 6174 696f 6e20        variation 
+0002b6a0: 6f66 2045 2d46 6965 6c64 2061 6e67 6c65  of E-Field angle
+0002b6b0: 7320 7661 6c75 6573 200d 0a20 0d0a 2020  s values .. ..  
+0002b6c0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0002b6d0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0002b6e0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2020  ----..          
+0002b6f0: 2020 2a20 7368 7068 7a5f 6172 7261 7920    * shphz_array 
+0002b700: 3a20 6e64 6172 7261 792c 200d 0a20 2020  : ndarray, ..   
+0002b710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b720: 2020 2020 2020 2020 2065 6e20 7261 6420           en rad 
+0002b730: 452d 4669 656c 6420 7068 6173 6520 6f62  E-Field phase ob
+0002b740: 7365 7276 6564 200d 0a20 2020 2020 2020  served ..       
+0002b750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b760: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
+0002b770: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2020   is None...     
+0002b780: 2020 2020 2020 202a 206e 756d 6265 725f         * number_
+0002b790: 6f66 5f66 7265 7175 656e 6369 6573 203a  of_frequencies :
+0002b7a0: 2069 6e74 202c 206f 7074 696f 6e61 6c0d   int , optional.
+0002b7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0002b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b7d0: 2020 6375 7272 656e 7420 2073 4870 687a    current  sHphz
-0002b7e0: 2064 6174 6120 6f66 2073 7461 7469 6f6e   data of station
-0002b7f0: 2061 7420 5334 340d 0a20 2020 203d 3d3d   at S44..    ===
-0002b800: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
-0002b810: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-0002b820: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002b830: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002b840: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 0d0a  ========..    ..
-0002b850: 2020 2020 4d6f 7265 2061 7474 7269 6275      More attribu
-0002b860: 7465 7320 6361 6e20 6265 2061 6464 6564  tes can be added
-0002b870: 2062 7920 696e 7075 7469 6e67 2061 206b   by inputing a k
-0002b880: 6579 2077 6f72 6420 6469 6374 696f 6e61  ey word dictiona
-0002b890: 7279 0d0a 2020 2020 0d0a 2020 2020 3a45  ry..    ..    :E
-0002b8a0: 7861 6d70 6c65 3a0d 0a20 2020 2020 2020  xample:..       
-0002b8b0: 2020 0d0a 2020 2020 2020 2020 3e3e 3e20    ..        >>> 
-0002b8c0: 6672 6f6d 2070 7963 7361 6d74 2e66 662e  from pycsamt.ff.
-0002b8d0: 636f 7265 2e61 7667 2069 6d70 6f72 7420  core.avg import 
-0002b8e0: 4176 6720 0d0a 2020 2020 2020 2020 3e3e  Avg ..        >>
-0002b8f0: 3e20 7061 7468 3d6f 732e 7061 7468 2e6a  > path=os.path.j
-0002b900: 6f69 6e28 6f73 2e65 6e76 6972 6f6e 5b22  oin(os.environ["
-0002b910: 7079 4353 414d 5422 5d2c 200d 0a20 2020  pyCSAMT"], ..   
-0002b920: 2020 2020 2020 2020 2020 2027 7079 6373             'pycs
-0002b930: 616d 7427 2c20 2264 6174 6122 2c20 224b  amt', "data", "K
-0002b940: 312e 4156 4722 290d 0a20 2020 2020 2020  1.AVG")..       
-0002b950: 203e 3e3e 2061 7667 5f6f 626a 3d41 7667   >>> avg_obj=Avg
-0002b960: 2870 6174 6829 0d0a 2020 2020 2020 2020  (path)..        
-0002b970: 3e3e 3e20 7368 7068 7a5f 6f62 6a20 3d61  >>> shphz_obj =a
-0002b980: 7667 5f6f 626a 2e44 6174 615f 7365 6374  vg_obj.Data_sect
-0002b990: 696f 6e2e 7348 7068 7a2e 6c6f 635b 2753  ion.sHphz.loc['S
-0002b9a0: 3434 275d 0d0a 2020 2020 2020 2020 2e2e  44']..        ..
-0002b9b0: 2e20 7072 696e 7428 7368 7068 7a5f 6f62  . print(shphz_ob
-0002b9c0: 6a29 0d0a 2020 2020 2222 220d 0a20 2020  j)..    """..   
-0002b9d0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0002b9e0: 6c66 2c20 7345 7068 7a5f 6172 7261 793d  lf, sEphz_array=
-0002b9f0: 4e6f 6e65 2c20 6e75 6d62 6572 5f6f 665f  None, number_of_
-0002ba00: 6672 6571 7565 6e63 6965 733d 4e6f 6e65  frequencies=None
-0002ba10: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
-0002ba20: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-0002ba30: 7374 6174 696f 6e73 3d4e 6f6e 6520 2c20  stations=None , 
-0002ba40: 2a2a 6b77 6172 6773 293a 0d0a 2020 2020  **kwargs):..    
-0002ba50: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
-0002ba60: 6c66 2e5f 7345 7068 7a3d 2073 4570 687a  lf._sEphz= sEphz
-0002ba70: 5f61 7272 6179 0d0a 2020 2020 2020 2020  _array..        
-0002ba80: 0d0a 2020 2020 2020 2020 7365 6c66 2e6e  ..        self.n
-0002ba90: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-0002baa0: 7320 3d6b 7761 7267 732e 706f 7028 226e  s =kwargs.pop("n
-0002bab0: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-0002bac0: 7322 2c20 4e6f 6e65 290d 0a20 2020 2020  s", None)..     
-0002bad0: 2020 2073 656c 662e 6e66 7265 7120 3d6b     self.nfreq =k
-0002bae0: 7761 7267 732e 706f 7028 276e 756d 6265  wargs.pop('numbe
-0002baf0: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
-0002bb00: 272c 204e 6f6e 6529 0d0a 2020 2020 2020  ', None)..      
-0002bb10: 2020 7365 6c66 2e74 6f5f 6465 6772 6565    self.to_degree
-0002bb20: 203d 6b77 6172 6773 2e70 6f70 2827 746f   =kwargs.pop('to
-0002bb30: 5f64 6567 7265 6527 2c20 4661 6c73 6529  _degree', False)
-0002bb40: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0002bb50: 2020 2020 7365 6c66 2e76 616c 7565 203d      self.value =
-0002bb60: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
-0002bb70: 656c 662e 6d69 6e20 3d20 4e6f 6e65 200d  elf.min = None .
-0002bb80: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-0002bb90: 7820 3d20 4e6f 6e65 200d 0a20 2020 200d  x = None ..    .
-0002bba0: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
-0002bbb0: 2069 6e20 6c69 7374 286b 7761 7267 732e   in list(kwargs.
-0002bbc0: 6b65 7973 2829 293a 0d0a 2020 2020 2020  keys()):..      
-0002bbd0: 2020 2020 2020 7365 7461 7474 7228 7365        setattr(se
-0002bbe0: 6c66 2c20 6b65 792c 206b 7761 7267 735b  lf, key, kwargs[
-0002bbf0: 6b65 795d 290d 0a20 2020 2020 2020 2020  key])..         
-0002bc00: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-0002bc10: 7365 6c66 2e5f 7345 7068 7a20 6973 206e  self._sEphz is n
-0002bc20: 6f74 204e 6f6e 6520 3a20 0d0a 2020 2020  ot None : ..    
-0002bc30: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
-0002bc40: 6164 5f73 4570 687a 5f64 6174 6120 2829  ad_sEphz_data ()
-0002bc50: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0002bc60: 2020 2020 0d0a 2020 2020 6465 6620 5f72      ..    def _r
-0002bc70: 6561 645f 7345 7068 7a5f 6461 7461 2028  ead_sEphz_data (
-0002bc80: 7365 6c66 2c20 7345 7068 7a5f 6172 7261  self, sEphz_arra
-0002bc90: 793d 4e6f 6e65 2c20 6e75 6d62 6572 5f6f  y=None, number_o
-0002bca0: 665f 6672 6571 7565 6e63 6965 733d 4e6f  f_frequencies=No
-0002bcb0: 6e65 202c 200d 0a20 2020 2020 2020 2020  ne , ..         
-0002bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bcd0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-0002bce0: 6e73 3d4e 6f6e 652c 202a 2a6b 7761 7267  ns=None, **kwarg
-0002bcf0: 7320 2029 3a0d 0a20 2020 2020 2020 2022  s  ):..        "
-0002bd00: 2222 0d0a 2020 2020 2020 2020 4d65 7468  ""..        Meth
-0002bd10: 6f64 2074 6f20 7265 6164 2061 6e64 2061  od to read and a
-0002bd20: 7261 6e67 6520 6461 7461 2061 6363 6f72  range data accor
-0002bd30: 6469 6e67 2065 6163 6820 7374 6174 696f  ding each statio
-0002bd40: 6e20 2f53 7461 7469 7374 6963 616c 200d  n /Statistical .
-0002bd50: 0a20 2020 2020 2020 2076 6172 6961 7469  .        variati
-0002bd60: 6f6e 206f 6620 452d 4669 656c 6420 616e  on of E-Field an
-0002bd70: 676c 6573 2076 616c 7565 7320 0d0a 200d  gles values .. .
-0002bd80: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0002bd90: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0002bda0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0002bdb0: 2020 2020 202a 2073 6870 687a 5f61 7272       * shphz_arr
-0002bdc0: 6179 203a 206e 6461 7272 6179 2c20 0d0a  ay : ndarray, ..
-0002bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bde0: 2020 2020 2020 2020 2020 2020 656e 2072              en r
-0002bdf0: 6164 2045 2d46 6965 6c64 2070 6861 7365  ad E-Field phase
-0002be00: 206f 6273 6572 7665 6420 0d0a 2020 2020   observed ..    
-0002be10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be20: 2020 2020 2020 2020 5468 6520 6465 6661          The defa
-0002be30: 756c 7420 6973 204e 6f6e 652e 0d0a 2020  ult is None...  
-0002be40: 2020 2020 2020 2020 2020 2a20 6e75 6d62            * numb
-0002be50: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
-0002be60: 7320 3a20 696e 7420 2c20 6f70 7469 6f6e  s : int , option
-0002be70: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-0002be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be90: 2020 2020 2020 2020 6e75 6d62 6572 206f          number o
-0002bea0: 6620 6672 6571 7565 6e63 6965 7320 666f  f frequencies fo
-0002beb0: 7220 7375 7276 6579 2e0d 0a20 2020 2020  r survey...     
-0002bec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bed0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-0002bee0: 6865 2064 6566 6175 6c74 2069 7320 4e6f  he default is No
-0002bef0: 6e65 2e0d 0a20 2020 2020 2020 2020 2020  ne...           
-0002bf00: 202a 206e 756d 6265 725f 6f66 5f73 7461   * number_of_sta
-0002bf10: 7469 6f6e 7320 3a20 696e 7420 2c20 6f70  tions : int , op
-0002bf20: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0002bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf40: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
-0002bf50: 6620 7374 6174 696f 6e73 2e20 5468 6520  f stations. The 
-0002bf60: 6465 6661 756c 7420 6973 204e 6f6e 652e  default is None.
-0002bf70: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-0002bf80: 746f 5f64 6567 7265 6520 3a20 626f 6f6c  to_degree : bool
-0002bf90: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0002bfa0: 2020 2020 2020 2020 2020 2063 6f6d 7075             compu
-0002bfb0: 7465 2061 6e67 6c65 2074 6f64 6567 7265  te angle todegre
-0002bfc0: 6520 2e20 0d0a 2020 2020 2020 2020 2222  e . ..        ""
-0002bfd0: 220d 0a20 2020 2020 2020 2074 6f5f 6465  "..        to_de
-0002bfe0: 6772 6565 203d 6b77 6172 6773 2e70 6f70  gree =kwargs.pop
-0002bff0: 2822 746f 5f64 6567 7265 6522 2c20 4661  ("to_degree", Fa
-0002c000: 6c73 6529 0d0a 2020 2020 2020 2020 6966  lse)..        if
-0002c010: 2074 6f5f 6465 6772 6565 203a 0d0a 2020   to_degree :..  
-0002c020: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-0002c030: 6f5f 6465 6772 6565 203d 2074 6f5f 6465  o_degree = to_de
-0002c040: 6772 6565 0d0a 2020 2020 2020 2020 0d0a  gree..        ..
-0002c050: 2020 2020 2020 2020 6966 2073 4570 687a          if sEphz
-0002c060: 5f61 7272 6179 2069 7320 6e6f 7420 4e6f  _array is not No
-0002c070: 6e65 203a 2073 656c 662e 5f73 4570 687a  ne : self._sEphz
-0002c080: 203d 7345 7068 7a5f 6172 7261 790d 0a20   =sEphz_array.. 
-0002c090: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0002c0a0: 7345 7068 7a20 6973 204e 6f6e 6520 3a20  sEphz is None : 
-0002c0b0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-0002c0c0: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-0002c0d0: 5445 7272 6f72 5f69 6e70 7574 6172 6775  TError_inputargu
-0002c0e0: 6d65 6e74 7328 0d0a 2020 2020 2020 2020  ments(..        
-0002c0f0: 2020 2020 2020 2020 274e 6f20 7374 6174          'No stat
-0002c100: 2e76 6172 6961 7469 6f6e 2020 422d 6669  .variation  B-fi
-0002c110: 656c 642d 7068 6173 6520 6461 7461 2066  eld-phase data f
-0002c120: 6f75 6e64 2020 2127 290d 0a20 2020 2020  ound  !')..     
-0002c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c150: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0002c160: 2020 2020 2020 2020 6966 206e 756d 6265          if numbe
-0002c170: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
-0002c180: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
-0002c190: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002c1a0: 662e 6e66 7265 7120 3d20 6e75 6d62 6572  f.nfreq = number
-0002c1b0: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
-0002c1c0: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
-0002c1d0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0002c1e0: 6973 6520 4353 6578 2e70 7943 5341 4d54  ise CSex.pyCSAMT
-0002c1f0: 4572 726f 725f 696e 7075 7461 7267 756d  Error_inputargum
-0002c200: 656e 7473 280d 0a20 2020 2020 2020 2020  ents(..         
-0002c210: 2020 2020 2020 2022 506c 6561 7365 2073         "Please s
-0002c220: 7065 6369 6679 2074 6865 206e 756d 6265  pecify the numbe
-0002c230: 7220 6f66 2066 7265 7175 656e 6379 2021  r of frequency !
-0002c240: 2229 0d0a 2020 2020 2020 2020 6966 206e  ")..        if n
-0002c250: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-0002c260: 7320 6973 206e 6f74 204e 6f6e 6520 3a20  s is not None : 
-0002c270: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0002c280: 6c66 2e6e 756d 6265 725f 6f66 5f73 7461  lf.number_of_sta
-0002c290: 7469 6f6e 7320 3d6e 756d 6265 725f 6f66  tions =number_of
-0002c2a0: 5f73 7461 7469 6f6e 7320 0d0a 2020 2020  _stations ..    
-0002c2b0: 2020 2020 656c 7365 203a 200d 0a20 2020      else : ..   
-0002c2c0: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
-0002c2d0: 5365 782e 7079 4353 414d 5445 7272 6f72  Sex.pyCSAMTError
-0002c2e0: 5f69 6e70 7574 6172 6775 6d65 6e74 7328  _inputarguments(
-0002c2f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002c300: 2020 2750 6c65 6173 6520 7370 6563 6966    'Please specif
-0002c310: 7920 7468 6520 6e75 6d62 6572 206f 6620  y the number of 
-0002c320: 7374 6174 696f 6e73 2729 0d0a 2020 2020  stations')..    
-0002c330: 2020 2020 7365 6c66 2e6e 6672 6571 202c      self.nfreq ,
-0002c340: 2073 656c 662e 6e75 6d62 6572 5f6f 665f   self.number_of_
-0002c350: 7374 6174 696f 6e73 203d 6e70 2e69 6e74  stations =np.int
-0002c360: 2873 656c 662e 6e66 7265 7129 2c5c 0d0a  (self.nfreq),\..
-0002c370: 2020 2020 2020 2020 2020 2020 6e70 2e69              np.i
-0002c380: 6e74 2873 656c 662e 6e75 6d62 6572 5f6f  nt(self.number_o
-0002c390: 665f 7374 6174 696f 6e73 2920 2020 200d  f_stations)    .
-0002c3a0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0002c3b0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0002c3c0: 2020 2020 6465 6620 5f69 6e73 7065 6374      def _inspect
-0002c3d0: 5f69 6e70 7574 2028 696e 7075 745f 6f62  _input (input_ob
-0002c3e0: 6a20 2c20 746f 5f64 6567 7265 653d 4661  j , to_degree=Fa
-0002c3f0: 6c73 6529 3a0d 0a20 2020 2020 2020 2020  lse):..         
-0002c400: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0002c410: 2020 2020 4173 6365 7274 6169 6e20 7468      Ascertain th
-0002c420: 6174 2074 6865 2076 616c 7565 2069 7320  at the value is 
-0002c430: 706f 7373 6962 6c65 2066 6f72 2063 6f6d  possible for com
-0002c440: 7075 7469 6e67 2e20 616e 6420 7075 7420  puting. and put 
-0002c450: 6f6e 200d 0a20 2020 2020 2020 2020 2020  on ..           
-0002c460: 206e 6461 7272 6179 2028 6e64 6172 7261   ndarray (ndarra
-0002c470: 792c 3129 0d0a 2020 2020 2020 2020 2020  y,1)..          
-0002c480: 2020 2222 2220 2020 2020 2020 2020 2020    """           
-0002c490: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
-0002c4a0: 7279 203a 200d 0a20 2020 2020 2020 2020  ry : ..         
-0002c4b0: 2020 2020 2020 2069 6e70 7574 5f6f 626a         input_obj
-0002c4c0: 203d 6e70 2e61 7272 6179 285b 666c 6f61   =np.array([floa
-0002c4d0: 7428 7373 2920 666f 7220 7373 2069 6e20  t(ss) for ss in 
-0002c4e0: 696e 7075 745f 6f62 6a5d 290d 0a20 2020  input_obj])..   
-0002c4f0: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-0002c500: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0002c510: 2020 2020 7261 6973 6520 2043 5365 782e      raise  CSex.
-0002c520: 7079 4353 414d 5445 7272 6f72 5f76 616c  pyCSAMTError_val
-0002c530: 7565 280d 0a20 2020 2020 2020 2020 2020  ue(..           
-0002c540: 2020 2020 2020 2020 2022 5661 6c75 6573           "Values
-0002c550: 2070 726f 7669 6465 6420 666f 7220 636f   provided for co
-0002c560: 6d70 7574 696e 6720 6172 6520 7772 6f6e  mputing are wron
-0002c570: 672e 220d 0a20 2020 2020 2020 2020 2020  g."..           
-0002c580: 2020 2020 2020 2020 2022 206d 7573 7420           " must 
-0002c590: 6265 2066 6c6f 6174 206f 7220 696e 7465  be float or inte
-0002c5a0: 6765 7220 2e22 290d 0a20 2020 2020 2020  ger .")..       
-0002c5b0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0002c5c0: 2020 2069 6620 746f 5f64 6567 7265 6520     if to_degree 
-0002c5d0: 3a20 696e 7075 745f 6f62 6a20 3d6e 702e  : input_obj =np.
-0002c5e0: 6170 706c 795f 616c 6f6e 675f 6178 6973  apply_along_axis
-0002c5f0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-0002c600: 2020 2020 2020 2020 6c61 6d62 6461 2078          lambda x
-0002c610: 3a20 7820 2a20 3138 302f 6e70 2e70 692c  : x * 180/np.pi,
-0002c620: 2030 2c20 696e 7075 745f 6f62 6a29 0d0a   0, input_obj)..
-0002c630: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0002c640: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002c650: 2069 6e70 7574 5f6f 626a 200d 0a0d 0a20   input_obj .... 
-0002c660: 2020 2020 2020 2073 656c 662e 5f73 4570         self._sEp
-0002c670: 687a 3d20 5f69 6e73 7065 6374 5f69 6e70  hz= _inspect_inp
-0002c680: 7574 2873 656c 662e 5f73 4570 687a 290d  ut(self._sEphz).
-0002c690: 0a0d 0a20 2020 2020 2020 2069 6620 7365  ...        if se
-0002c6a0: 6c66 2e74 6f5f 6465 6772 6565 203a 2023  lf.to_degree : #
-0002c6b0: 2d2d 2d3e 2073 6574 2061 6e67 6c65 2074  ---> set angle t
-0002c6c0: 6f20 6465 6772 6565 202e 0d0a 2020 2020  o degree ...    
-0002c6d0: 2020 2020 2020 2020 7365 6c66 2e5f 7345          self._sE
-0002c6e0: 7068 7a20 3d5f 696e 7370 6563 745f 696e  phz =_inspect_in
-0002c6f0: 7075 7428 696e 7075 745f 6f62 6a20 3d73  put(input_obj =s
-0002c700: 656c 662e 5f73 4570 687a 2c0d 0a20 2020  elf._sEphz,..   
-0002c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c730: 2020 2020 2074 6f5f 6465 6772 6565 203d       to_degree =
-0002c740: 5472 7565 2920 2020 2020 2020 200d 0a20  True)        .. 
-0002c750: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0002c760: 2023 202d 2d3e 2063 6865 636b 2074 6865   # --> check the
-0002c770: 206d 6178 696d 756d 2061 6e67 6c65 2076   maximum angle v
-0002c780: 616c 7565 2061 6e64 206d 696e 696d 756d  alue and minimum
-0002c790: 2061 6e67 6c65 2076 616c 7565 2e0d 0a20   angle value... 
-0002c7a0: 2020 2020 2020 2076 636f 756e 7473 5f73         vcounts_s
-0002c7b0: 4570 687a 2c20 7265 7065 6174 5f68 7068  Ephz, repeat_hph
-0002c7c0: 7a3d 6e70 2e75 6e69 7175 6520 2873 656c  z=np.unique (sel
-0002c7d0: 662e 5f73 4570 687a 2c20 0d0a 2020 2020  f._sEphz, ..    
-0002c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c800: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002c810: 5f63 6f75 6e74 733d 5472 7565 290d 0a20  _counts=True).. 
-0002c820: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
-0002c830: 6520 3d76 636f 756e 7473 5f73 4570 687a  e =vcounts_sEphz
-0002c840: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
-0002c850: 6178 2c20 7365 6c66 2e6d 696e 203d 7663  ax, self.min =vc
-0002c860: 6f75 6e74 735f 7345 7068 7a2e 6d61 7828  ounts_sEphz.max(
-0002c870: 292c 2076 636f 756e 7473 5f73 4570 687a  ), vcounts_sEphz
-0002c880: 2e6d 696e 2829 0d0a 2020 2020 2020 2020  .min()..        
-0002c890: 0d0a 2020 2020 2020 2020 232d 2d2d 3e20  ..        #---> 
-0002c8a0: 7475 6e63 6174 6564 2041 5647 2073 4870  tuncated AVG sHp
-0002c8b0: 687a 2076 616c 7565 206f 6e20 2064 6963  hz value on  dic
-0002c8c0: 7469 6f6e 6e61 7279 2066 6f72 2065 6173  tionnary for eas
-0002c8d0: 7920 6163 6365 7320 2e20 0d0a 2020 2020  y acces . ..    
-0002c8e0: 2020 2020 7472 756e 6361 7465 645f 7345      truncated_sE
-0002c8f0: 7068 7a3d 5a63 632e 7472 756e 6361 7465  phz=Zcc.truncate
-0002c900: 645f 6461 7461 2820 6461 7461 203d 7365  d_data( data =se
-0002c910: 6c66 2e5f 7345 7068 7a2c 200d 0a20 2020  lf._sEphz, ..   
-0002c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c940: 2020 2020 6e75 6d62 6572 5f6f 665f 7265      number_of_re
-0002c950: 6363 7572 656e 6365 3d73 656c 662e 6e66  ccurence=self.nf
-0002c960: 7265 7129 0d0a 2020 2020 2020 2020 6e61  req)..        na
-0002c970: 6d65 2c20 706f 6c79 6e61 6d65 203d 205a  me, polyname = Z
-0002c980: 6363 2e5f 6e75 6d62 6572 696e 675f 7374  cc._numbering_st
-0002c990: 6174 696f 6e28 0d0a 2020 2020 2020 2020  ation(..        
-0002c9a0: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
-0002c9b0: 6174 696f 6e3d 7365 6c66 2e6e 756d 6265  ation=self.numbe
-0002c9c0: 725f 6f66 5f73 7461 7469 6f6e 732c 200d  r_of_stations, .
-0002c9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9f0: 6e75 6d62 6572 5f6f 665f 6672 6571 203d  number_of_freq =
-0002ca00: 7365 6c66 2e6e 6672 6571 290d 0a20 2020  self.nfreq)..   
-0002ca10: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-0002ca20: 656c 662e 6c6f 6320 3d7b 206b 6579 3a76  elf.loc ={ key:v
-0002ca30: 616c 7565 2066 6f72 206b 6579 2c20 7661  alue for key, va
-0002ca40: 6c75 6520 696e 207a 6970 286e 616d 652c  lue in zip(name,
-0002ca50: 2074 7275 6e63 6174 6564 5f73 4570 687a   truncated_sEphz
-0002ca60: 297d 0d0a 2020 2020 2020 2020 0d0a 636c  )}..        ..cl
-0002ca70: 6173 7320 7063 486d 6167 2028 6f62 6a65  ass pcHmag (obje
-0002ca80: 6374 293a 0d0a 2020 2020 2222 220d 0a20  ct):..    """.. 
-0002ca90: 2020 2053 7461 7469 7374 6963 616c 2076     Statistical v
-0002caa0: 6172 6961 7469 6f6e 206f 6620 6d61 676e  ariation of magn
-0002cab0: 6974 7564 6520 7661 6c75 6573 2066 726f  itude values fro
-0002cac0: 6d20 6176 6572 6167 6564 2064 6174 6120  m averaged data 
-0002cad0: 626c 6f63 6b73 2e0d 0a20 2020 2020 2020  blocks...       
-0002cae0: 2053 7461 6e64 6172 6420 4465 7669 6174   Standard Deviat
-0002caf0: 696f 6e20 2f20 4176 6572 6167 6520 486d  ion / Average Hm
-0002cb00: 6167 2028 7065 7263 656e 7429 0d0a 2020  ag (percent)..  
-0002cb10: 2020 2020 2020 0d0a 2020 2020 2041 7267        ..     Arg
-0002cb20: 756d 656e 7473 203a 0d0a 2020 2020 202d  uments :..     -
-0002cb30: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0002cb40: 2020 202a 2a70 6348 6d61 672a 2a20 203a     **pcHmag**  :
-0002cb50: 206e 6461 7272 6179 0d0a 2020 2020 2020   ndarray..      
-0002cb60: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-0002cb70: 6120 6172 7261 7920 6f66 2073 7461 7469  a array of stati
-0002cb80: 7374 6963 616c 2076 6172 6961 7461 696f  stical variataio
-0002cb90: 6e20 0d0a 2020 2020 2020 2020 2020 2020  n ..            
-0002cba0: 2020 2020 2020 206f 6620 486d 6167 2076         of Hmag v
-0002cbb0: 616c 7565 206f 6e20 7468 6520 6669 656c  alue on the fiel
-0002cbc0: 642e 0d0a 2020 2020 2020 2020 2020 2020  d...            
-0002cbd0: 2020 2020 2020 0d0a 2020 2020 3d3d 3d3d        ..    ====
-0002cbe0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
-0002cbf0: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-0002cc00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002cc10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002cc20: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2041 7474  =======..    Att
-0002cc30: 7269 6275 7465 7320 2020 2020 2020 2020  ributes         
-0002cc40: 5479 7065 2020 2020 2020 2020 4578 706c  Type        Expl
-0002cc50: 616e 6174 696f 6e0d 0a20 2020 203d 3d3d  anation..    ===
-0002cc60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 203d  ============== =
-0002cc70: 3d3d 3d3d 3d3d 3d3d 3d3d 203d 3d3d 3d3d  ========== =====
-0002cc80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002cc90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002cca0: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 7661  ========..    va
-0002ccb0: 6c75 6520 2020 2020 2020 2020 2020 2020  lue             
-0002ccc0: 6e64 2e61 7272 6179 2020 2020 2020 6461  nd.array      da
-0002ccd0: 7461 206f 6620 7063 486d 6167 2020 636f  ta of pcHmag  co
-0002cce0: 6c75 6d6e 2020 6f6e 2061 7667 6669 6c65  lumn  on avgfile
-0002ccf0: 0d0a 2020 2020 6d61 7820 2020 2020 2020  ..    max       
-0002cd00: 2020 2020 2020 2020 666c 6f61 7420 2020          float   
-0002cd10: 2020 2020 2020 6d61 7869 6d75 6d20 2520        maximum % 
-0002cd20: 7661 6c75 6520 6f66 2070 6320 486d 6167  value of pc Hmag
-0002cd30: 0d0a 2020 2020 6d69 6e20 2020 2020 2020  ..    min       
-0002cd40: 2020 2020 2020 2020 666c 6f61 7420 2020          float   
-0002cd50: 2020 2020 2020 6d69 6e69 6d75 6d20 2520        minimum % 
-0002cd60: 7661 6c75 6520 6f66 2070 6348 6d61 6720  value of pcHmag 
-0002cd70: 0d0a 2020 2020 6c6f 6320 2020 2020 2020  ..    loc       
-0002cd80: 2020 2020 2020 2020 6469 6374 2020 2020          dict    
-0002cd90: 2020 2020 2020 6c6f 6361 7469 6f6e 206f        location o
-0002cda0: 6620 2548 7068 7a20 6d61 676e 6974 7564  f %Hphz magnitud
-0002cdb0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-0002cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cdd0: 2020 2020 2020 2076 616c 7565 2061 7420         value at 
-0002cde0: 7468 6520 7374 6174 696f 6e20 6c61 6d62  the station lamb
-0002cdf0: 6461 0d0a 2020 2020 2020 2020 2020 2020  da..            
+0002b7d0: 2020 2020 206e 756d 6265 7220 6f66 2066       number of f
+0002b7e0: 7265 7175 656e 6369 6573 2066 6f72 2073  requencies for s
+0002b7f0: 7572 7665 792e 0d0a 2020 2020 2020 2020  urvey...        
+0002b800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b810: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0002b820: 6465 6661 756c 7420 6973 204e 6f6e 652e  default is None.
+0002b830: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+0002b840: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+0002b850: 6e73 203a 2069 6e74 202c 206f 7074 696f  ns : int , optio
+0002b860: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+0002b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b880: 2020 2020 206e 756d 6265 725f 6f66 2073       number_of s
+0002b890: 7461 7469 6f6e 732e 2054 6865 2064 6566  tations. The def
+0002b8a0: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
+0002b8b0: 2020 2020 2020 2020 2020 202a 2074 6f5f             * to_
+0002b8c0: 6465 6772 6565 203a 2062 6f6f 6c2c 0d0a  degree : bool,..
+0002b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b8e0: 2020 2020 2020 2020 636f 6d70 7574 6520          compute 
+0002b8f0: 616e 676c 6520 746f 6465 6772 6565 202e  angle todegree .
+0002b900: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+0002b910: 2020 2020 2020 2020 746f 5f64 6567 7265          to_degre
+0002b920: 6520 3d6b 7761 7267 732e 706f 7028 2274  e =kwargs.pop("t
+0002b930: 6f5f 6465 6772 6565 222c 2046 616c 7365  o_degree", False
+0002b940: 290d 0a20 2020 2020 2020 2069 6620 746f  )..        if to
+0002b950: 5f64 6567 7265 6520 3a0d 0a20 2020 2020  _degree :..     
+0002b960: 2020 2020 2020 2073 656c 662e 746f 5f64         self.to_d
+0002b970: 6567 7265 6520 3d20 746f 5f64 6567 7265  egree = to_degre
+0002b980: 650d 0a20 2020 2020 2020 200d 0a20 2020  e..        ..   
+0002b990: 2020 2020 2069 6620 7345 7068 7a5f 6172       if sEphz_ar
+0002b9a0: 7261 7920 6973 206e 6f74 204e 6f6e 6520  ray is not None 
+0002b9b0: 3a20 7365 6c66 2e5f 7345 7068 7a20 3d73  : self._sEphz =s
+0002b9c0: 4570 687a 5f61 7272 6179 0d0a 2020 2020  Ephz_array..    
+0002b9d0: 2020 2020 6966 2073 656c 662e 5f73 4570      if self._sEp
+0002b9e0: 687a 2069 7320 4e6f 6e65 203a 2020 0d0a  hz is None :  ..
+0002b9f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002ba00: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
+0002ba10: 2020 2020 2020 2020 2020 2020 2020 274e                'N
+0002ba20: 6f20 7374 6174 2e76 6172 6961 7469 6f6e  o stat.variation
+0002ba30: 2020 422d 6669 656c 642d 7068 6173 6520    B-field-phase 
+0002ba40: 6461 7461 2066 6f75 6e64 2020 2127 290d  data found  !').
+0002ba50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ba80: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+0002ba90: 206e 756d 6265 725f 6f66 5f66 7265 7175   number_of_frequ
+0002baa0: 656e 6369 6573 2069 7320 6e6f 7420 4e6f  encies is not No
+0002bab0: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
+0002bac0: 2020 2073 656c 662e 6e66 7265 7120 3d20     self.nfreq = 
+0002bad0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+0002bae0: 6e63 6965 7320 0d0a 2020 2020 2020 2020  ncies ..        
+0002baf0: 656c 7365 203a 0d0a 2020 2020 2020 2020  else :..        
+0002bb00: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+0002bb10: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+0002bb20: 2020 2020 2020 2250 6c65 6173 6520 7370        "Please sp
+0002bb30: 6563 6966 7920 7468 6520 6e75 6d62 6572  ecify the number
+0002bb40: 206f 6620 6672 6571 7565 6e63 7920 2122   of frequency !"
+0002bb50: 290d 0a20 2020 2020 2020 2069 6620 6e75  )..        if nu
+0002bb60: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0002bb70: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
+0002bb80: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002bb90: 662e 6e75 6d62 6572 5f6f 665f 7374 6174  f.number_of_stat
+0002bba0: 696f 6e73 203d 6e75 6d62 6572 5f6f 665f  ions =number_of_
+0002bbb0: 7374 6174 696f 6e73 200d 0a20 2020 2020  stations ..     
+0002bbc0: 2020 2065 6c73 6520 3a20 0d0a 2020 2020     else : ..    
+0002bbd0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0002bbe0: 7065 4572 726f 7228 0d0a 2020 2020 2020  peError(..      
+0002bbf0: 2020 2020 2020 2020 2020 2750 6c65 6173            'Pleas
+0002bc00: 6520 7370 6563 6966 7920 7468 6520 6e75  e specify the nu
+0002bc10: 6d62 6572 206f 6620 7374 6174 696f 6e73  mber of stations
+0002bc20: 2729 0d0a 2020 2020 2020 2020 7365 6c66  ')..        self
+0002bc30: 2e6e 6672 6571 202c 2073 656c 662e 6e75  .nfreq , self.nu
+0002bc40: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0002bc50: 203d 6e70 2e69 6e74 2873 656c 662e 6e66   =np.int(self.nf
+0002bc60: 7265 7129 2c5c 0d0a 2020 2020 2020 2020  req),\..        
+0002bc70: 2020 2020 6e70 2e69 6e74 2873 656c 662e      np.int(self.
+0002bc80: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+0002bc90: 6e73 2920 2020 200d 0a20 2020 2020 2020  ns)    ..       
+0002bca0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0002bcb0: 2020 0d0a 2020 2020 2020 2020 6465 6620    ..        def 
+0002bcc0: 5f69 6e73 7065 6374 5f69 6e70 7574 2028  _inspect_input (
+0002bcd0: 696e 7075 745f 6f62 6a20 2c20 746f 5f64  input_obj , to_d
+0002bce0: 6567 7265 653d 4661 6c73 6529 3a0d 0a20  egree=False):.. 
+0002bcf0: 2020 2020 2020 2020 2020 2022 2222 0d0a             """..
+0002bd00: 2020 2020 2020 2020 2020 2020 4173 6365              Asce
+0002bd10: 7274 6169 6e20 7468 6174 2074 6865 2076  rtain that the v
+0002bd20: 616c 7565 2069 7320 706f 7373 6962 6c65  alue is possible
+0002bd30: 2066 6f72 2063 6f6d 7075 7469 6e67 2e20   for computing. 
+0002bd40: 616e 6420 7075 7420 6f6e 200d 0a20 2020  and put on ..   
+0002bd50: 2020 2020 2020 2020 206e 6461 7272 6179           ndarray
+0002bd60: 2028 6e64 6172 7261 792c 3129 0d0a 2020   (ndarray,1)..  
+0002bd70: 2020 2020 2020 2020 2020 2222 2220 2020            """   
+0002bd80: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0002bd90: 2020 2020 2020 2074 7279 203a 200d 0a20         try : .. 
+0002bda0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002bdb0: 6e70 7574 5f6f 626a 203d 6e70 2e61 7272  nput_obj =np.arr
+0002bdc0: 6179 285b 666c 6f61 7428 7373 2920 666f  ay([float(ss) fo
+0002bdd0: 7220 7373 2069 6e20 696e 7075 745f 6f62  r ss in input_ob
+0002bde0: 6a5d 290d 0a20 2020 2020 2020 2020 2020  j])..           
+0002bdf0: 2065 7863 6570 7420 3a20 0d0a 2020 2020   except : ..    
+0002be00: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002be10: 6520 2056 616c 7565 4572 726f 7228 0d0a  e  ValueError(..
+0002be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002be30: 2020 2020 2256 616c 7565 7320 7072 6f76      "Values prov
+0002be40: 6964 6564 2066 6f72 2063 6f6d 7075 7469  ided for computi
+0002be50: 6e67 2061 7265 2077 726f 6e67 2e22 0d0a  ng are wrong."..
+0002be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002be70: 2020 2020 2220 6d75 7374 2062 6520 666c      " must be fl
+0002be80: 6f61 7420 6f72 2069 6e74 6567 6572 202e  oat or integer .
+0002be90: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0002bea0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0002beb0: 2074 6f5f 6465 6772 6565 203a 2069 6e70   to_degree : inp
+0002bec0: 7574 5f6f 626a 203d 6e70 2e61 7070 6c79  ut_obj =np.apply
+0002bed0: 5f61 6c6f 6e67 5f61 7869 7320 280d 0a20  _along_axis (.. 
+0002bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bef0: 2020 206c 616d 6264 6120 783a 2078 202a     lambda x: x *
+0002bf00: 2031 3830 2f6e 702e 7069 2c20 302c 2069   180/np.pi, 0, i
+0002bf10: 6e70 7574 5f6f 626a 290d 0a20 2020 2020  nput_obj)..     
+0002bf20: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002bf30: 2020 2020 2072 6574 7572 6e20 696e 7075       return inpu
+0002bf40: 745f 6f62 6a20 0d0a 0d0a 2020 2020 2020  t_obj ....      
+0002bf50: 2020 7365 6c66 2e5f 7345 7068 7a3d 205f    self._sEphz= _
+0002bf60: 696e 7370 6563 745f 696e 7075 7428 7365  inspect_input(se
+0002bf70: 6c66 2e5f 7345 7068 7a29 0d0a 0d0a 2020  lf._sEphz)....  
+0002bf80: 2020 2020 2020 6966 2073 656c 662e 746f        if self.to
+0002bf90: 5f64 6567 7265 6520 3a20 232d 2d2d 3e20  _degree : #---> 
+0002bfa0: 7365 7420 616e 676c 6520 746f 2064 6567  set angle to deg
+0002bfb0: 7265 6520 2e0d 0a20 2020 2020 2020 2020  ree ...         
+0002bfc0: 2020 2073 656c 662e 5f73 4570 687a 203d     self._sEphz =
+0002bfd0: 5f69 6e73 7065 6374 5f69 6e70 7574 2869  _inspect_input(i
+0002bfe0: 6e70 7574 5f6f 626a 203d 7365 6c66 2e5f  nput_obj =self._
+0002bff0: 7345 7068 7a2c 0d0a 2020 2020 2020 2020  sEphz,..        
+0002c000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c020: 746f 5f64 6567 7265 6520 3d54 7275 6529  to_degree =True)
+0002c030: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0002c040: 2020 0d0a 2020 2020 2020 2020 2320 2d2d    ..        # --
+0002c050: 3e20 6368 6563 6b20 7468 6520 6d61 7869  > check the maxi
+0002c060: 6d75 6d20 616e 676c 6520 7661 6c75 6520  mum angle value 
+0002c070: 616e 6420 6d69 6e69 6d75 6d20 616e 676c  and minimum angl
+0002c080: 6520 7661 6c75 652e 0d0a 2020 2020 2020  e value...      
+0002c090: 2020 7663 6f75 6e74 735f 7345 7068 7a2c    vcounts_sEphz,
+0002c0a0: 2072 6570 6561 745f 6870 687a 3d6e 702e   repeat_hphz=np.
+0002c0b0: 756e 6971 7565 2028 7365 6c66 2e5f 7345  unique (self._sE
+0002c0c0: 7068 7a2c 200d 0a20 2020 2020 2020 2020  phz, ..         
+0002c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c0f0: 2020 2020 2072 6574 7572 6e5f 636f 756e       return_coun
+0002c100: 7473 3d54 7275 6529 0d0a 2020 2020 2020  ts=True)..      
+0002c110: 2020 7365 6c66 2e76 616c 7565 203d 7663    self.value =vc
+0002c120: 6f75 6e74 735f 7345 7068 7a0d 0a20 2020  ounts_sEphz..   
+0002c130: 2020 2020 2073 656c 662e 6d61 782c 2073       self.max, s
+0002c140: 656c 662e 6d69 6e20 3d76 636f 756e 7473  elf.min =vcounts
+0002c150: 5f73 4570 687a 2e6d 6178 2829 2c20 7663  _sEphz.max(), vc
+0002c160: 6f75 6e74 735f 7345 7068 7a2e 6d69 6e28  ounts_sEphz.min(
+0002c170: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0002c180: 2020 2020 2023 2d2d 2d3e 2074 756e 6361       #---> tunca
+0002c190: 7465 6420 4156 4720 7348 7068 7a20 7661  ted AVG sHphz va
+0002c1a0: 6c75 6520 6f6e 2020 6469 6374 696f 6e6e  lue on  dictionn
+0002c1b0: 6172 7920 666f 7220 6561 7379 2061 6363  ary for easy acc
+0002c1c0: 6573 202e 200d 0a20 2020 2020 2020 2074  es . ..        t
+0002c1d0: 7275 6e63 6174 6564 5f73 4570 687a 3d5a  runcated_sEphz=Z
+0002c1e0: 6363 2e74 7275 6e63 6174 6564 5f64 6174  cc.truncated_dat
+0002c1f0: 6128 2064 6174 6120 3d73 656c 662e 5f73  a( data =self._s
+0002c200: 4570 687a 2c20 0d0a 2020 2020 2020 2020  Ephz, ..        
+0002c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c220: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0002c230: 756d 6265 725f 6f66 5f72 6563 6375 7265  umber_of_reccure
+0002c240: 6e63 653d 7365 6c66 2e6e 6672 6571 290d  nce=self.nfreq).
+0002c250: 0a20 2020 2020 2020 206e 616d 652c 2070  .        name, p
+0002c260: 6f6c 796e 616d 6520 3d20 5a63 632e 5f6e  olyname = Zcc._n
+0002c270: 756d 6265 7269 6e67 5f73 7461 7469 6f6e  umbering_station
+0002c280: 280d 0a20 2020 2020 2020 2020 2020 206e  (..            n
+0002c290: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+0002c2a0: 3d73 656c 662e 6e75 6d62 6572 5f6f 665f  =self.number_of_
+0002c2b0: 7374 6174 696f 6e73 2c20 0d0a 2020 2020  stations, ..    
+0002c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c2d0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+0002c2e0: 725f 6f66 5f66 7265 7120 3d73 656c 662e  r_of_freq =self.
+0002c2f0: 6e66 7265 7129 0d0a 2020 2020 2020 2020  nfreq)..        
+0002c300: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+0002c310: 6f63 203d 7b20 6b65 793a 7661 6c75 6520  oc ={ key:value 
+0002c320: 666f 7220 6b65 792c 2076 616c 7565 2069  for key, value i
+0002c330: 6e20 7a69 7028 6e61 6d65 2c20 7472 756e  n zip(name, trun
+0002c340: 6361 7465 645f 7345 7068 7a29 7d0d 0a20  cated_sEphz)}.. 
+0002c350: 2020 2020 2020 200d 0a63 6c61 7373 2070         ..class p
+0002c360: 6348 6d61 6720 286f 626a 6563 7429 3a0d  cHmag (object):.
+0002c370: 0a20 2020 2022 2222 0d0a 2020 2020 5374  .    """..    St
+0002c380: 6174 6973 7469 6361 6c20 7661 7269 6174  atistical variat
+0002c390: 696f 6e20 6f66 206d 6167 6e69 7475 6465  ion of magnitude
+0002c3a0: 2076 616c 7565 7320 6672 6f6d 2061 7665   values from ave
+0002c3b0: 7261 6765 6420 6461 7461 2062 6c6f 636b  raged data block
+0002c3c0: 732e 0d0a 2020 2020 2020 2020 5374 616e  s...        Stan
+0002c3d0: 6461 7264 2044 6576 6961 7469 6f6e 202f  dard Deviation /
+0002c3e0: 2041 7665 7261 6765 2048 6d61 6720 2870   Average Hmag (p
+0002c3f0: 6572 6365 6e74 290d 0a20 2020 2020 2020  ercent)..       
+0002c400: 200d 0a20 2020 2020 4172 6775 6d65 6e74   ..     Argument
+0002c410: 7320 3a0d 0a20 2020 2020 2d2d 2d2d 2d2d  s :..     ------
+0002c420: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2a2a  ----..        **
+0002c430: 7063 486d 6167 2a2a 2020 3a20 6e64 6172  pcHmag**  : ndar
+0002c440: 7261 790d 0a20 2020 2020 2020 2020 2020  ray..           
+0002c450: 2020 2020 2020 2020 6461 7461 2061 7272          data arr
+0002c460: 6179 206f 6620 7374 6174 6973 7469 6361  ay of statistica
+0002c470: 6c20 7661 7269 6174 6169 6f6e 200d 0a20  l variataion .. 
+0002c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c490: 2020 6f66 2048 6d61 6720 7661 6c75 6520    of Hmag value 
+0002c4a0: 6f6e 2074 6865 2066 6965 6c64 2e0d 0a20  on the field... 
+0002c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c4c0: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
+0002c4d0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
+0002c4e0: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
+0002c4f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002c500: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002c510: 3d3d 0d0a 2020 2020 4174 7472 6962 7574  ==..    Attribut
+0002c520: 6573 2020 2020 2020 2020 2054 7970 6520  es         Type 
+0002c530: 2020 2020 2020 2045 7870 6c61 6e61 7469         Explanati
+0002c540: 6f6e 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d  on..    ========
+0002c550: 3d3d 3d3d 3d3d 3d3d 3d20 3d3d 3d3d 3d3d  ========= ======
+0002c560: 3d3d 3d3d 3d20 3d3d 3d3d 3d3d 3d3d 3d3d  ===== ==========
+0002c570: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002c580: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002c590: 3d3d 3d0d 0a20 2020 2076 616c 7565 2020  ===..    value  
+0002c5a0: 2020 2020 2020 2020 2020 206e 642e 6172             nd.ar
+0002c5b0: 7261 7920 2020 2020 2064 6174 6120 6f66  ray      data of
+0002c5c0: 2070 6348 6d61 6720 2063 6f6c 756d 6e20   pcHmag  column 
+0002c5d0: 206f 6e20 6176 6766 696c 650d 0a20 2020   on avgfile..   
+0002c5e0: 206d 6178 2020 2020 2020 2020 2020 2020   max            
+0002c5f0: 2020 2066 6c6f 6174 2020 2020 2020 2020     float        
+0002c600: 206d 6178 696d 756d 2025 2076 616c 7565   maximum % value
+0002c610: 206f 6620 7063 2048 6d61 670d 0a20 2020   of pc Hmag..   
+0002c620: 206d 696e 2020 2020 2020 2020 2020 2020   min            
+0002c630: 2020 2066 6c6f 6174 2020 2020 2020 2020     float        
+0002c640: 206d 696e 696d 756d 2025 2076 616c 7565   minimum % value
+0002c650: 206f 6620 7063 486d 6167 200d 0a20 2020   of pcHmag ..   
+0002c660: 206c 6f63 2020 2020 2020 2020 2020 2020   loc            
+0002c670: 2020 2064 6963 7420 2020 2020 2020 2020     dict         
+0002c680: 206c 6f63 6174 696f 6e20 6f66 2025 4870   location of %Hp
+0002c690: 687a 206d 6167 6e69 7475 6465 0d0a 2020  hz magnitude..  
+0002c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6c0: 2020 7661 6c75 6520 6174 2074 6865 2073    value at the s
+0002c6d0: 7461 7469 6f6e 206c 616d 6264 610d 0a20  tation lambda.. 
+0002c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c700: 2020 2065 3a67 202e 206c 6f63 5b27 5330     e:g . loc['S0
+0002c710: 3527 5d20 7368 6f77 2074 6865 2063 7572  5'] show the cur
+0002c720: 7265 6e74 2020 482d 6d61 6720 0d0a 2020  rent  H-mag ..  
+0002c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c750: 2020 6461 7461 2020 6f66 2073 7461 7469    data  of stati
+0002c760: 6f6e 2061 7420 5330 352e 0d0a 2020 2020  on at S05...    
+0002c770: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002c780: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d    ===========  =
+0002c790: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002c7a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002c7b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d 0a20  ===========.... 
+0002c7c0: 2020 204d 6f72 6520 6174 7472 6962 7574     More attribut
+0002c7d0: 6573 2063 616e 2062 6520 6164 6465 6420  es can be added 
+0002c7e0: 6279 2069 6e70 7574 696e 6720 6120 6b65  by inputing a ke
+0002c7f0: 7920 776f 7264 2064 6963 7469 6f6e 6172  y word dictionar
+0002c800: 790d 0a20 2020 200d 0a20 2020 203a 4578  y..    ..    :Ex
+0002c810: 616d 706c 653a 0d0a 2020 2020 2020 2020  ample:..        
+0002c820: 200d 0a20 2020 2020 2020 203e 3e3e 2066   ..        >>> f
+0002c830: 726f 6d20 7079 6373 616d 742e 636f 7265  rom pycsamt.core
+0002c840: 2e61 7667 2069 6d70 6f72 7420 4176 6720  .avg import Avg 
+0002c850: 0d0a 2020 2020 2020 2020 3e3e 3e20 7061  ..        >>> pa
+0002c860: 7468 3d6f 732e 7061 7468 2e6a 6f69 6e28  th=os.path.join(
+0002c870: 6f73 2e65 6e76 6972 6f6e 5b22 7079 4353  os.environ["pyCS
+0002c880: 414d 5422 5d2c 200d 0a20 2020 2020 2020  AMT"], ..       
+0002c890: 202e 2e2e 2020 2020 2020 2770 7963 7361   ...      'pycsa
+0002c8a0: 6d74 272c 2022 6461 7461 222c 2022 4b31  mt', "data", "K1
+0002c8b0: 2e41 5647 2229 0d0a 2020 2020 2020 2020  .AVG")..        
+0002c8c0: 3e3e 3e20 6176 675f 6f62 6a3d 4176 6728  >>> avg_obj=Avg(
+0002c8d0: 7061 7468 290d 0a20 2020 2020 2020 203e  path)..        >
+0002c8e0: 3e3e 2070 6368 6d61 675f 6f62 6a20 3d61  >> pchmag_obj =a
+0002c8f0: 7667 5f6f 626a 2e44 6174 615f 7365 6374  vg_obj.Data_sect
+0002c900: 696f 6e2e 7063 486d 6167 2e6c 6f63 5b27  ion.pcHmag.loc['
+0002c910: 5330 3527 5d0d 0a20 2020 2020 2020 203e  S05']..        >
+0002c920: 3e3e 2070 7269 6e74 2870 6368 6d61 675f  >> print(pchmag_
+0002c930: 6f62 6a29 0d0a 2020 2020 2020 2020 0d0a  obj)..        ..
+0002c940: 2020 2020 2222 220d 0a20 2020 200d 0a20      """..    .. 
+0002c950: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+0002c960: 7365 6c66 2c20 7063 5f68 5f6d 6167 5f61  self, pc_h_mag_a
+0002c970: 7272 6179 3d4e 6f6e 652c 200d 0a20 2020  rray=None, ..   
+0002c980: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+0002c990: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
+0002c9a0: 6965 733d 4e6f 6e65 202c 206e 756d 6265  ies=None , numbe
+0002c9b0: 725f 6f66 5f73 7461 7469 6f6e 733d 4e6f  r_of_stations=No
+0002c9c0: 6e65 202c 202a 2a6b 7761 7267 7329 3a0d  ne , **kwargs):.
+0002c9d0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0002c9e0: 2020 2073 656c 662e 5f70 6348 6d61 6720     self._pcHmag 
+0002c9f0: 3d70 635f 685f 6d61 675f 6172 7261 790d  =pc_h_mag_array.
+0002ca00: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0002ca10: 2020 2073 656c 662e 6e75 6d62 6572 5f6f     self.number_o
+0002ca20: 665f 7374 6174 696f 6e73 203d 6b77 6172  f_stations =kwar
+0002ca30: 6773 2e70 6f70 2822 6e75 6d62 6572 5f6f  gs.pop("number_o
+0002ca40: 665f 7374 6174 696f 6e73 222c 204e 6f6e  f_stations", Non
+0002ca50: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
+0002ca60: 2e6e 6672 6571 203d 6b77 6172 6773 2e70  .nfreq =kwargs.p
+0002ca70: 6f70 2827 6e75 6d62 6572 5f6f 665f 6672  op('number_of_fr
+0002ca80: 6571 7565 6e63 6965 7327 2c20 4e6f 6e65  equencies', None
+0002ca90: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0002caa0: 2020 2020 2073 656c 662e 7661 6c75 6520       self.value 
+0002cab0: 3d4e 6f6e 6520 0d0a 2020 2020 2020 2020  =None ..        
+0002cac0: 7365 6c66 2e6d 696e 203d 204e 6f6e 6520  self.min = None 
+0002cad0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+0002cae0: 6178 203d 204e 6f6e 6520 0d0a 2020 2020  ax = None ..    
+0002caf0: 0d0a 2020 2020 2020 2020 666f 7220 6b65  ..        for ke
+0002cb00: 7920 696e 206c 6973 7428 6b77 6172 6773  y in list(kwargs
+0002cb10: 2e6b 6579 7328 2929 3a0d 0a20 2020 2020  .keys()):..     
+0002cb20: 2020 2020 2020 2073 6574 6174 7472 2873         setattr(s
+0002cb30: 656c 662c 206b 6579 2c20 6b77 6172 6773  elf, key, kwargs
+0002cb40: 5b6b 6579 5d29 0d0a 2020 2020 2020 2020  [key])..        
+0002cb50: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+0002cb60: 2073 656c 662e 5f70 6348 6d61 6720 2069   self._pcHmag  i
+0002cb70: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
+0002cb80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002cb90: 5f72 6561 645f 7063 486d 6167 5f64 6174  _read_pcHmag_dat
+0002cba0: 6120 2829 0d0a 2020 2020 2020 2020 0d0a  a ()..        ..
+0002cbb0: 2020 2020 2020 2020 0d0a 2020 2020 6465          ..    de
+0002cbc0: 6620 5f72 6561 645f 7063 486d 6167 5f64  f _read_pcHmag_d
+0002cbd0: 6174 6120 2873 656c 662c 7063 5f68 5f6d  ata (self,pc_h_m
+0002cbe0: 6167 5f61 7272 6179 3d4e 6f6e 652c 206e  ag_array=None, n
+0002cbf0: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
+0002cc00: 6369 6573 3d4e 6f6e 6520 2c20 0d0a 2020  cies=None , ..  
+0002cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc20: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
+0002cc30: 5f73 7461 7469 6f6e 733d 4e6f 6e65 2029  _stations=None )
+0002cc40: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
+0002cc50: 2020 2020 2020 2020 4d65 7468 6f64 2074          Method t
+0002cc60: 6f20 7265 6164 2061 6e64 2061 7261 6e67  o read and arang
+0002cc70: 6520 6461 7461 2061 6363 6f72 6469 6e67  e data according
+0002cc80: 2065 6163 6820 7374 6174 696f 6e20 2f53   each station /S
+0002cc90: 7461 7469 7374 6963 616c 200d 0a20 2020  tatistical ..   
+0002cca0: 2020 2020 2020 2020 7661 7269 6174 696f          variatio
+0002ccb0: 6e20 6f66 2020 422d 4669 656c 6420 6d61  n of  B-Field ma
+0002ccc0: 676e 6974 7564 6520 7661 6c75 6573 202e  gnitude values .
+0002ccd0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0002cce0: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+0002ccf0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002cd00: 2d2d 0d0a 2020 2020 2020 2020 2020 2020  --..            
+0002cd10: 2a20 7063 5f68 5f6d 6167 5f61 7272 6179  * pc_h_mag_array
+0002cd20: 203a 206e 6461 7272 6179 2c20 6f70 7469   : ndarray, opti
+0002cd30: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+0002cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd50: 2020 452d 4669 656c 6420 7374 6420 7661    E-Field std va
+0002cd60: 7269 6174 696f 6e20 206f 6273 6572 7665  riation  observe
+0002cd70: 6420 6174 2065 6163 6820 7374 6174 696f  d at each statio
+0002cd80: 6e2e 200d 0a20 2020 2020 2020 2020 2020  n. ..           
+0002cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cda0: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+0002cdb0: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2020  None...         
+0002cdc0: 2020 202a 206e 756d 6265 725f 6f66 5f66     * number_of_f
+0002cdd0: 7265 7175 656e 6369 6573 203a 2069 6e74  requencies : int
+0002cde0: 202c 206f 7074 696f 6e61 6c0d 0a20 2020   , optional..   
+0002cdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002ce00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce10: 2020 2020 2020 2020 653a 6720 2e20 6c6f          e:g . lo
-0002ce20: 635b 2753 3035 275d 2073 686f 7720 7468  c['S05'] show th
-0002ce30: 6520 6375 7272 656e 7420 2048 2d6d 6167  e current  H-mag
-0002ce40: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0002ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce60: 2020 2020 2020 2064 6174 6120 206f 6620         data  of 
-0002ce70: 7374 6174 696f 6e20 6174 2053 3035 2e0d  station at S05..
-0002ce80: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
-0002ce90: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
-0002cea0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-0002ceb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002cec0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002ced0: 0d0a 0d0a 2020 2020 4d6f 7265 2061 7474  ....    More att
-0002cee0: 7269 6275 7465 7320 6361 6e20 6265 2061  ributes can be a
-0002cef0: 6464 6564 2062 7920 696e 7075 7469 6e67  dded by inputing
-0002cf00: 2061 206b 6579 2077 6f72 6420 6469 6374   a key word dict
-0002cf10: 696f 6e61 7279 0d0a 2020 2020 0d0a 2020  ionary..    ..  
-0002cf20: 2020 3a45 7861 6d70 6c65 3a0d 0a20 2020    :Example:..   
-0002cf30: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002cf40: 3e3e 3e20 6672 6f6d 2070 7963 7361 6d74  >>> from pycsamt
-0002cf50: 2e66 662e 636f 7265 2e61 7667 2069 6d70  .ff.core.avg imp
-0002cf60: 6f72 7420 4176 6720 0d0a 2020 2020 2020  ort Avg ..      
-0002cf70: 2020 3e3e 3e20 7061 7468 3d6f 732e 7061    >>> path=os.pa
-0002cf80: 7468 2e6a 6f69 6e28 6f73 2e65 6e76 6972  th.join(os.envir
-0002cf90: 6f6e 5b22 7079 4353 414d 5422 5d2c 200d  on["pyCSAMT"], .
-0002cfa0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0002cfb0: 2020 2770 7963 7361 6d74 272c 2022 6461    'pycsamt', "da
-0002cfc0: 7461 222c 2022 4b31 2e41 5647 2229 0d0a  ta", "K1.AVG")..
-0002cfd0: 2020 2020 2020 2020 3e3e 3e20 6176 675f          >>> avg_
-0002cfe0: 6f62 6a3d 4176 6728 7061 7468 290d 0a20  obj=Avg(path).. 
-0002cff0: 2020 2020 2020 203e 3e3e 2070 6368 6d61         >>> pchma
-0002d000: 675f 6f62 6a20 3d61 7667 5f6f 626a 2e44  g_obj =avg_obj.D
-0002d010: 6174 615f 7365 6374 696f 6e2e 7063 486d  ata_section.pcHm
-0002d020: 6167 2e6c 6f63 5b27 5330 3527 5d0d 0a20  ag.loc['S05'].. 
-0002d030: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
-0002d040: 2870 6368 6d61 675f 6f62 6a29 0d0a 2020  (pchmag_obj)..  
-0002d050: 2020 2020 2020 0d0a 2020 2020 2222 220d        ..    """.
-0002d060: 0a20 2020 200d 0a20 2020 2064 6566 205f  .    ..    def _
-0002d070: 5f69 6e69 745f 5f28 7365 6c66 2c20 7063  _init__(self, pc
-0002d080: 5f68 5f6d 6167 5f61 7272 6179 3d4e 6f6e  _h_mag_array=Non
-0002d090: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
-0002d0a0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
-0002d0b0: 6672 6571 7565 6e63 6965 733d 4e6f 6e65  frequencies=None
-0002d0c0: 202c 206e 756d 6265 725f 6f66 5f73 7461   , number_of_sta
-0002d0d0: 7469 6f6e 733d 4e6f 6e65 202c 202a 2a6b  tions=None , **k
-0002d0e0: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
-0002d0f0: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-0002d100: 5f70 6348 6d61 6720 3d70 635f 685f 6d61  _pcHmag =pc_h_ma
-0002d110: 675f 6172 7261 790d 0a20 2020 2020 2020  g_array..       
-0002d120: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-0002d130: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-0002d140: 6e73 203d 6b77 6172 6773 2e70 6f70 2822  ns =kwargs.pop("
-0002d150: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-0002d160: 6e73 222c 204e 6f6e 6529 0d0a 2020 2020  ns", None)..    
-0002d170: 2020 2020 7365 6c66 2e6e 6672 6571 203d      self.nfreq =
-0002d180: 6b77 6172 6773 2e70 6f70 2827 6e75 6d62  kwargs.pop('numb
-0002d190: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
-0002d1a0: 7327 2c20 4e6f 6e65 290d 0a20 2020 2020  s', None)..     
-0002d1b0: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-0002d1c0: 662e 7661 6c75 6520 3d4e 6f6e 6520 0d0a  f.value =None ..
-0002d1d0: 2020 2020 2020 2020 7365 6c66 2e6d 696e          self.min
-0002d1e0: 203d 204e 6f6e 6520 0d0a 2020 2020 2020   = None ..      
-0002d1f0: 2020 7365 6c66 2e6d 6178 203d 204e 6f6e    self.max = Non
-0002d200: 6520 0d0a 2020 2020 0d0a 2020 2020 2020  e ..    ..      
-0002d210: 2020 666f 7220 6b65 7920 696e 206c 6973    for key in lis
-0002d220: 7428 6b77 6172 6773 2e6b 6579 7328 2929  t(kwargs.keys())
-0002d230: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0002d240: 6574 6174 7472 2873 656c 662c 206b 6579  etattr(self, key
-0002d250: 2c20 6b77 6172 6773 5b6b 6579 5d29 0d0a  , kwargs[key])..
-0002d260: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0002d270: 2020 2020 2020 6966 2073 656c 662e 5f70        if self._p
-0002d280: 6348 6d61 6720 2069 7320 6e6f 7420 4e6f  cHmag  is not No
-0002d290: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
-0002d2a0: 2020 2073 656c 662e 5f72 6561 645f 7063     self._read_pc
-0002d2b0: 486d 6167 5f64 6174 6120 2829 0d0a 2020  Hmag_data ()..  
-0002d2c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002d2d0: 0d0a 2020 2020 6465 6620 5f72 6561 645f  ..    def _read_
-0002d2e0: 7063 486d 6167 5f64 6174 6120 2873 656c  pcHmag_data (sel
-0002d2f0: 662c 7063 5f68 5f6d 6167 5f61 7272 6179  f,pc_h_mag_array
-0002d300: 3d4e 6f6e 652c 206e 756d 6265 725f 6f66  =None, number_of
-0002d310: 5f66 7265 7175 656e 6369 6573 3d4e 6f6e  _frequencies=Non
-0002d320: 6520 2c20 0d0a 2020 2020 2020 2020 2020  e , ..          
-0002d330: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0002d340: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-0002d350: 733d 4e6f 6e65 2029 3a0d 0a20 2020 2020  s=None ):..     
-0002d360: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0002d370: 4d65 7468 6f64 2074 6f20 7265 6164 2061  Method to read a
-0002d380: 6e64 2061 7261 6e67 6520 6461 7461 2061  nd arange data a
-0002d390: 6363 6f72 6469 6e67 2065 6163 6820 7374  ccording each st
-0002d3a0: 6174 696f 6e20 2f53 7461 7469 7374 6963  ation /Statistic
-0002d3b0: 616c 200d 0a20 2020 2020 2020 2020 2020  al ..           
-0002d3c0: 7661 7269 6174 696f 6e20 6f66 2020 422d  variation of  B-
-0002d3d0: 4669 656c 6420 6d61 676e 6974 7564 6520  Field magnitude 
-0002d3e0: 7661 6c75 6573 202e 0d0a 2020 2020 2020  values ...      
-0002d3f0: 2020 0d0a 2020 2020 2020 2020 5061 7261    ..        Para
-0002d400: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-0002d410: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-0002d420: 2020 2020 2020 2020 2a20 7063 5f68 5f6d          * pc_h_m
-0002d430: 6167 5f61 7272 6179 203a 206e 6461 7272  ag_array : ndarr
-0002d440: 6179 2c20 6f70 7469 6f6e 616c 0d0a 2020  ay, optional..  
-0002d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d460: 2020 2020 2020 2020 2020 452d 4669 656c            E-Fiel
-0002d470: 6420 7374 6420 7661 7269 6174 696f 6e20  d std variation 
-0002d480: 206f 6273 6572 7665 6420 6174 2065 6163   observed at eac
-0002d490: 6820 7374 6174 696f 6e2e 200d 0a20 2020  h station. ..   
-0002d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4b0: 2020 2020 2020 2020 2054 6865 2064 6566           The def
-0002d4c0: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
-0002d4d0: 2020 2020 2020 2020 2020 202a 206e 756d             * num
-0002d4e0: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-0002d4f0: 6573 203a 2069 6e74 202c 206f 7074 696f  es : int , optio
-0002d500: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-0002d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d520: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-0002d530: 6f66 2066 7265 7175 656e 6369 6573 2066  of frequencies f
-0002d540: 6f72 2073 7572 7665 792e 200d 0a20 2020  or survey. ..   
-0002d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d570: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
-0002d580: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2020  None...         
-0002d590: 2020 202a 206e 756d 6265 725f 6f66 5f73     * number_of_s
-0002d5a0: 7461 7469 6f6e 7320 3a20 696e 7420 2c20  tations : int , 
-0002d5b0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0002d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d5d0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-0002d5e0: 5f6f 6620 7374 6174 696f 6e73 2e20 5468  _of stations. Th
-0002d5f0: 6520 6465 6661 756c 7420 6973 204e 6f6e  e default is Non
-0002d600: 652e 0d0a 2020 2020 2020 2020 2222 220d  e...        """.
-0002d610: 0a20 2020 2020 2020 2069 6620 7063 5f68  .        if pc_h
-0002d620: 5f6d 6167 5f61 7272 6179 2069 7320 6e6f  _mag_array is no
-0002d630: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-0002d640: 2020 2020 2020 2073 656c 662e 5f70 6348         self._pcH
-0002d650: 6d61 6720 3d70 635f 685f 6d61 675f 6172  mag =pc_h_mag_ar
-0002d660: 7261 7920 0d0a 2020 2020 2020 2020 6966  ray ..        if
-0002d670: 2073 656c 662e 5f70 6348 6d61 6720 6973   self._pcHmag is
-0002d680: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
-0002d690: 2020 2020 2020 7261 6973 6520 4353 6578        raise CSex
-0002d6a0: 2e70 7943 5341 4d54 4572 726f 725f 696e  .pyCSAMTError_in
-0002d6b0: 7075 7461 7267 756d 656e 7473 280d 0a20  putarguments(.. 
-0002d6c0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0002d6d0: 4e6f 2042 2d6d 6167 2073 7461 7469 7374  No B-mag statist
-0002d6e0: 6963 616c 2076 6172 6961 7469 6f6e 2020  ical variation  
-0002d6f0: 6461 7461 2066 6f75 6e64 2020 2127 290d  data found  !').
-0002d700: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0002d710: 2020 2020 2020 2069 6620 6e75 6d62 6572         if number
-0002d720: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
-0002d730: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
-0002d740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002d750: 2e6e 6672 6571 203d 6e75 6d62 6572 5f6f  .nfreq =number_o
-0002d760: 665f 6672 6571 7565 6e63 6965 7320 0d0a  f_frequencies ..
-0002d770: 2020 2020 2020 2020 656c 7365 203a 0d0a          else :..
-0002d780: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002d790: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-0002d7a0: 726f 725f 696e 7075 7461 7267 756d 656e  ror_inputargumen
-0002d7b0: 7473 280d 0a20 2020 2020 2020 2020 2020  ts(..           
-0002d7c0: 2020 2020 2022 506c 6561 7365 2073 7065       "Please spe
-0002d7d0: 6369 6679 2074 6865 206e 756d 6265 7220  cify the number 
-0002d7e0: 6f66 2066 7265 7175 656e 6379 2021 2229  of frequency !")
-0002d7f0: 0d0a 2020 2020 2020 2020 6966 206e 756d  ..        if num
-0002d800: 6265 725f 6f66 5f73 7461 7469 6f6e 7320  ber_of_stations 
-0002d810: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
-0002d820: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002d830: 2e6e 756d 6265 725f 6f66 5f73 7461 7469  .number_of_stati
-0002d840: 6f6e 7320 3d6e 756d 6265 725f 6f66 5f73  ons =number_of_s
-0002d850: 7461 7469 6f6e 7320 0d0a 2020 2020 2020  tations ..      
-0002d860: 2020 656c 7365 203a 200d 0a20 2020 2020    else : ..     
-0002d870: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-0002d880: 782e 7079 4353 414d 5445 7272 6f72 5f69  x.pyCSAMTError_i
-0002d890: 6e70 7574 6172 6775 6d65 6e74 7328 0d0a  nputarguments(..
-0002d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d8b0: 2750 6c65 6173 6520 7370 6563 6966 7920  'Please specify 
-0002d8c0: 7468 6520 6e75 6d62 6572 206f 6620 7374  the number of st
-0002d8d0: 6174 696f 6e73 2729 0d0a 2020 2020 2020  ations')..      
-0002d8e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002d8f0: 7472 7920 3a20 0d0a 2020 2020 2020 2020  try : ..        
-0002d900: 2020 2020 7365 6c66 2e6e 6672 6571 202c      self.nfreq ,
-0002d910: 2073 656c 662e 6e75 6d62 6572 5f6f 665f   self.number_of_
-0002d920: 7374 6174 696f 6e73 203d 6e70 2e69 6e74  stations =np.int
-0002d930: 2873 656c 662e 6e66 7265 7129 2c20 5c0d  (self.nfreq), \.
-0002d940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d950: 206e 702e 696e 7428 7365 6c66 2e6e 756d   np.int(self.num
-0002d960: 6265 725f 6f66 5f73 7461 7469 6f6e 7329  ber_of_stations)
-0002d970: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0002d980: 6c66 2e5f 7063 486d 6167 3d6e 702e 6172  lf._pcHmag=np.ar
-0002d990: 7261 7928 5b6e 702e 666c 6f61 7428 6363  ray([np.float(cc
-0002d9a0: 2920 666f 7220 6363 2069 6e20 7365 6c66  ) for cc in self
-0002d9b0: 2e5f 7063 486d 6167 5d29 0d0a 0d0a 2020  ._pcHmag])....  
-0002d9c0: 2020 2020 2020 6578 6365 7074 203a 200d        except : .
-0002d9d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0002d9e0: 7365 2043 5365 782e 7079 4353 414d 5445  se CSex.pyCSAMTE
-0002d9f0: 7272 6f72 5f76 616c 7565 280d 0a20 2020  rror_value(..   
-0002da00: 2020 2020 2020 2020 2020 2020 2022 5661               "Va
-0002da10: 6c75 6573 2070 726f 7669 6465 6420 666f  lues provided fo
-0002da20: 7220 7468 6520 422d 6d61 6720 7374 6174  r the B-mag stat
-0002da30: 2e76 6172 6961 7469 6f6e 2020 6172 6520  .variation  are 
-0002da40: 7772 6f6e 672e 220d 0a20 2020 2020 2020  wrong."..       
-0002da50: 2020 2020 2020 2020 2020 2220 6d75 7374            " must
-0002da60: 2062 6520 666c 6f61 7420 6f72 2069 6e74   be float or int
-0002da70: 6567 6572 202e 2229 0d0a 2020 2020 2020  eger .")..      
-0002da80: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002da90: 7663 6f75 6e74 735f 486d 6167 2c20 7265  vcounts_Hmag, re
-0002daa0: 7065 6174 5f48 6d61 6720 3d6e 702e 756e  peat_Hmag =np.un
-0002dab0: 6971 7565 2028 7365 6c66 2e5f 7063 486d  ique (self._pcHm
-0002dac0: 6167 2c20 7265 7475 726e 5f63 6f75 6e74  ag, return_count
-0002dad0: 733d 5472 7565 290d 0a20 2020 2020 2020  s=True)..       
-0002dae0: 2073 656c 662e 7661 6c75 6520 3d76 636f   self.value =vco
-0002daf0: 756e 7473 5f48 6d61 670d 0a20 2020 2020  unts_Hmag..     
-0002db00: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-0002db10: 662e 6d61 782c 2073 656c 662e 6d69 6e20  f.max, self.min 
-0002db20: 3d76 636f 756e 7473 5f48 6d61 672e 6d61  =vcounts_Hmag.ma
-0002db30: 7828 292c 2076 636f 756e 7473 5f48 6d61  x(), vcounts_Hma
-0002db40: 672e 6d69 6e28 290d 0a20 2020 2020 2020  g.min()..       
-0002db50: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0002db60: 2020 2020 2074 7275 6e63 6174 6564 5f70       truncated_p
-0002db70: 6348 6d61 673d 5a63 632e 7472 756e 6361  cHmag=Zcc.trunca
-0002db80: 7465 645f 6461 7461 2820 6461 7461 203d  ted_data( data =
-0002db90: 7365 6c66 2e5f 7063 486d 6167 2c20 0d0a  self._pcHmag, ..
-0002dba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dbc0: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-0002dbd0: 5f72 6563 6375 7265 6e63 653d 7365 6c66  _reccurence=self
-0002dbe0: 2e6e 6672 6571 290d 0a20 2020 2020 2020  .nfreq)..       
-0002dbf0: 206e 616d 652c 2070 6f6c 796e 616d 6520   name, polyname 
-0002dc00: 3d20 5a63 632e 5f6e 756d 6265 7269 6e67  = Zcc._numbering
-0002dc10: 5f73 7461 7469 6f6e 280d 0a20 2020 2020  _station(..     
-0002dc20: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
-0002dc30: 5f73 7461 7469 6f6e 3d73 656c 662e 6e75  _station=self.nu
-0002dc40: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
-0002dc50: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0002dc60: 6e75 6d62 6572 5f6f 665f 6672 6571 203d  number_of_freq =
-0002dc70: 7365 6c66 2e6e 6672 6571 290d 0a20 2020  self.nfreq)..   
-0002dc80: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-0002dc90: 656c 662e 6c6f 6320 3d7b 206b 6579 3a76  elf.loc ={ key:v
-0002dca0: 616c 7565 2066 6f72 206b 6579 2c20 7661  alue for key, va
-0002dcb0: 6c75 6520 696e 207a 6970 286e 616d 652c  lue in zip(name,
-0002dcc0: 2074 7275 6e63 6174 6564 5f70 6348 6d61   truncated_pcHma
-0002dcd0: 6729 7d20 0d0a 0d0a 0d0a 636c 6173 7320  g)} ......class 
-0002dce0: 7348 7068 7a28 6f62 6a65 6374 2920 3a20  sHphz(object) : 
-0002dcf0: 0d0a 2020 2020 2222 220d 0a20 2020 2053  ..    """..    S
-0002dd00: 7461 7469 7374 6963 616c 2076 6172 6961  tatistical varia
-0002dd10: 7469 6f6e 206f 6620 7468 6520 6461 7461  tion of the data
-0002dd20: 2062 6c6f 636b 7320 6176 6572 6167 6564   blocks averaged
-0002dd30: 2066 6f72 2074 6869 7320 6461 7461 2070   for this data p
-0002dd40: 6f69 6e74 2e0d 0a20 2020 2020 2020 2031  oint...        1
-0002dd50: 3030 202a 2053 7461 6e64 6172 6420 4465  00 * Standard De
-0002dd60: 7669 6174 696f 6e20 6f66 2048 7068 7a20  viation of Hphz 
-0002dd70: 7661 6c75 6573 2028 6d69 6c6c 6972 6164  values (millirad
-0002dd80: 6961 6e73 290d 0a20 2020 2020 2020 200d  ians)..        .
-0002dd90: 0a20 2020 2041 7267 756d 656e 7473 0d0a  .    Arguments..
-0002dda0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-0002ddb0: 2020 2020 2020 2020 2a2a 7368 7068 7a2a          **shphz*
-0002ddc0: 2a20 203a 206e 6461 7272 6179 0d0a 2020  *  : ndarray..  
-0002ddd0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0002dde0: 7461 2061 7272 6179 206f 6620 7374 6174  ta array of stat
-0002ddf0: 6973 7469 6361 6c20 7661 7269 6174 696f  istical variatio
-0002de00: 6e20 6f66 2045 6d61 6720 0d0a 2020 2020  n of Emag ..    
-0002de10: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0002de20: 6520 6f6e 2074 6865 2066 6965 6c64 2e0d  e on the field..
-0002de30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002de40: 2020 200d 0a20 2020 203d 3d3d 3d3d 3d3d     ..    =======
-0002de50: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-0002de60: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-0002de70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002de80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002de90: 3d3d 3d3d 0d0a 2020 2020 4174 7472 6962  ====..    Attrib
-0002dea0: 7574 6573 2020 2020 2020 2020 2054 7970  utes         Typ
-0002deb0: 6520 2020 2020 2020 2045 7870 6c61 6e61  e        Explana
-0002dec0: 7469 6f6e 0d0a 2020 2020 3d3d 3d3d 3d3d  tion..    ======
-0002ded0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-0002dee0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-0002def0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002df00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002df10: 3d3d 3d3d 3d0d 0a20 2020 2076 616c 7565  =====..    value
-0002df20: 2020 2020 2020 2020 2020 2020 206e 642e               nd.
-0002df30: 6172 7261 7920 2020 2020 2064 6174 6120  array      data 
-0002df40: 6f66 2073 4870 687a 2020 636f 6c75 6d6e  of sHphz  column
-0002df50: 206f 6e20 6176 6766 696c 6520 2020 0d0a   on avgfile   ..
-0002df60: 2020 2020 6d61 7820 2020 2020 2020 2020      max         
-0002df70: 2020 2020 2020 666c 6f61 7420 2020 2020        float     
-0002df80: 2020 2020 6d61 7869 6d75 6d20 2520 7661      maximum % va
-0002df90: 6c75 6520 6f66 2073 4870 687a 0d0a 2020  lue of sHphz..  
-0002dfa0: 2020 6d69 6e20 2020 2020 2020 2020 2020    min           
-0002dfb0: 2020 2020 666c 6f61 7420 2020 2020 2020      float       
-0002dfc0: 2020 6d69 6e69 6d75 6d20 2076 616c 7565    minimum  value
-0002dfd0: 206f 6620 7348 7068 7a0d 0a20 2020 206c   of sHphz..    l
-0002dfe0: 6f63 2020 2020 2020 2020 2020 2020 2020  oc              
-0002dff0: 2064 6963 7420 2020 2020 2020 2020 206c   dict          l
-0002e000: 6f63 6174 696f 6e20 6f66 2073 4870 687a  ocation of sHphz
-0002e010: 206d 6167 6e69 7475 6465 0d0a 2020 2020   magnitude..    
+0002ce10: 206e 756d 6265 7220 6f66 2066 7265 7175   number of frequ
+0002ce20: 656e 6369 6573 2066 6f72 2073 7572 7665  encies for surve
+0002ce30: 792e 200d 0a20 2020 2020 2020 2020 2020  y. ..           
+0002ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce50: 2020 2020 2020 2020 2054 6865 2064 6566           The def
+0002ce60: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
+0002ce70: 2020 2020 2020 2020 2020 202a 206e 756d             * num
+0002ce80: 6265 725f 6f66 5f73 7461 7469 6f6e 7320  ber_of_stations 
+0002ce90: 3a20 696e 7420 2c20 6f70 7469 6f6e 616c  : int , optional
+0002cea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002ceb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cec0: 2020 6e75 6d62 6572 5f6f 6620 7374 6174    number_of stat
+0002ced0: 696f 6e73 2e20 5468 6520 6465 6661 756c  ions. The defaul
+0002cee0: 7420 6973 204e 6f6e 652e 0d0a 2020 2020  t is None...    
+0002cef0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0002cf00: 2069 6620 7063 5f68 5f6d 6167 5f61 7272   if pc_h_mag_arr
+0002cf10: 6179 2069 7320 6e6f 7420 4e6f 6e65 203a  ay is not None :
+0002cf20: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+0002cf30: 656c 662e 5f70 6348 6d61 6720 3d70 635f  elf._pcHmag =pc_
+0002cf40: 685f 6d61 675f 6172 7261 7920 0d0a 2020  h_mag_array ..  
+0002cf50: 2020 2020 2020 6966 2073 656c 662e 5f70        if self._p
+0002cf60: 6348 6d61 6720 6973 204e 6f6e 6520 3a20  cHmag is None : 
+0002cf70: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+0002cf80: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
+0002cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cfa0: 274e 6f20 422d 6d61 6720 7374 6174 6973  'No B-mag statis
+0002cfb0: 7469 6361 6c20 7661 7269 6174 696f 6e20  tical variation 
+0002cfc0: 2064 6174 6120 666f 756e 6420 2021 2729   data found  !')
+0002cfd0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+0002cfe0: 2020 2020 2020 2020 6966 206e 756d 6265          if numbe
+0002cff0: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
+0002d000: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
+0002d010: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002d020: 662e 6e66 7265 7120 3d6e 756d 6265 725f  f.nfreq =number_
+0002d030: 6f66 5f66 7265 7175 656e 6369 6573 200d  of_frequencies .
+0002d040: 0a20 2020 2020 2020 2065 6c73 6520 3a0d  .        else :.
+0002d050: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0002d060: 7365 2054 7970 6545 7272 6f72 280d 0a20  se TypeError(.. 
+0002d070: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002d080: 506c 6561 7365 2073 7065 6369 6679 2074  Please specify t
+0002d090: 6865 206e 756d 6265 7220 6f66 2066 7265  he number of fre
+0002d0a0: 7175 656e 6379 2021 2229 0d0a 2020 2020  quency !")..    
+0002d0b0: 2020 2020 6966 206e 756d 6265 725f 6f66      if number_of
+0002d0c0: 5f73 7461 7469 6f6e 7320 6973 206e 6f74  _stations is not
+0002d0d0: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
+0002d0e0: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
+0002d0f0: 725f 6f66 5f73 7461 7469 6f6e 7320 3d6e  r_of_stations =n
+0002d100: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+0002d110: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
+0002d120: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+0002d130: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0002d140: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0002d150: 2020 2027 506c 6561 7365 2073 7065 6369     'Please speci
+0002d160: 6679 2074 6865 206e 756d 6265 7220 6f66  fy the number of
+0002d170: 2073 7461 7469 6f6e 7327 290d 0a20 2020   stations')..   
+0002d180: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0002d190: 2020 2074 7279 203a 200d 0a20 2020 2020     try : ..     
+0002d1a0: 2020 2020 2020 2073 656c 662e 6e66 7265         self.nfre
+0002d1b0: 7120 2c20 7365 6c66 2e6e 756d 6265 725f  q , self.number_
+0002d1c0: 6f66 5f73 7461 7469 6f6e 7320 3d6e 702e  of_stations =np.
+0002d1d0: 696e 7428 7365 6c66 2e6e 6672 6571 292c  int(self.nfreq),
+0002d1e0: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+0002d1f0: 2020 2020 6e70 2e69 6e74 2873 656c 662e      np.int(self.
+0002d200: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+0002d210: 6e73 290d 0a20 2020 2020 2020 2020 2020  ns)..           
+0002d220: 2073 656c 662e 5f70 6348 6d61 673d 6e70   self._pcHmag=np
+0002d230: 2e61 7272 6179 285b 6e70 2e66 6c6f 6174  .array([np.float
+0002d240: 2863 6329 2066 6f72 2063 6320 696e 2073  (cc) for cc in s
+0002d250: 656c 662e 5f70 6348 6d61 675d 290d 0a0d  elf._pcHmag])...
+0002d260: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0002d270: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0002d280: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002d290: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0002d2a0: 2020 2022 5661 6c75 6573 2070 726f 7669     "Values provi
+0002d2b0: 6465 6420 666f 7220 7468 6520 422d 6d61  ded for the B-ma
+0002d2c0: 6720 7374 6174 2e76 6172 6961 7469 6f6e  g stat.variation
+0002d2d0: 2020 6172 6520 7772 6f6e 672e 220d 0a20    are wrong.".. 
+0002d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d2f0: 2220 6d75 7374 2062 6520 666c 6f61 7420  " must be float 
+0002d300: 6f72 2069 6e74 6567 6572 202e 2229 0d0a  or integer .")..
+0002d310: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0002d320: 2020 2020 2020 7663 6f75 6e74 735f 486d        vcounts_Hm
+0002d330: 6167 2c20 7265 7065 6174 5f48 6d61 6720  ag, repeat_Hmag 
+0002d340: 3d6e 702e 756e 6971 7565 2028 7365 6c66  =np.unique (self
+0002d350: 2e5f 7063 486d 6167 2c20 7265 7475 726e  ._pcHmag, return
+0002d360: 5f63 6f75 6e74 733d 5472 7565 290d 0a20  _counts=True).. 
+0002d370: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
+0002d380: 6520 3d76 636f 756e 7473 5f48 6d61 670d  e =vcounts_Hmag.
+0002d390: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0002d3a0: 2020 2073 656c 662e 6d61 782c 2073 656c     self.max, sel
+0002d3b0: 662e 6d69 6e20 3d76 636f 756e 7473 5f48  f.min =vcounts_H
+0002d3c0: 6d61 672e 6d61 7828 292c 2076 636f 756e  mag.max(), vcoun
+0002d3d0: 7473 5f48 6d61 672e 6d69 6e28 290d 0a20  ts_Hmag.min().. 
+0002d3e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002d3f0: 200d 0a20 2020 2020 2020 2074 7275 6e63   ..        trunc
+0002d400: 6174 6564 5f70 6348 6d61 673d 5a63 632e  ated_pcHmag=Zcc.
+0002d410: 7472 756e 6361 7465 645f 6461 7461 2820  truncated_data( 
+0002d420: 6461 7461 203d 7365 6c66 2e5f 7063 486d  data =self._pcHm
+0002d430: 6167 2c20 0d0a 2020 2020 2020 2020 2020  ag, ..          
+0002d440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d450: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0002d460: 6265 725f 6f66 5f72 6563 6375 7265 6e63  ber_of_reccurenc
+0002d470: 653d 7365 6c66 2e6e 6672 6571 290d 0a20  e=self.nfreq).. 
+0002d480: 2020 2020 2020 206e 616d 652c 2070 6f6c         name, pol
+0002d490: 796e 616d 6520 3d20 5a63 632e 5f6e 756d  yname = Zcc._num
+0002d4a0: 6265 7269 6e67 5f73 7461 7469 6f6e 280d  bering_station(.
+0002d4b0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0002d4c0: 6265 725f 6f66 5f73 7461 7469 6f6e 3d73  ber_of_station=s
+0002d4d0: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
+0002d4e0: 6174 696f 6e73 2c20 0d0a 2020 2020 2020  ations, ..      
+0002d4f0: 2020 2020 2020 6e75 6d62 6572 5f6f 665f        number_of_
+0002d500: 6672 6571 203d 7365 6c66 2e6e 6672 6571  freq =self.nfreq
+0002d510: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0002d520: 2020 2020 2073 656c 662e 6c6f 6320 3d7b       self.loc ={
+0002d530: 206b 6579 3a76 616c 7565 2066 6f72 206b   key:value for k
+0002d540: 6579 2c20 7661 6c75 6520 696e 207a 6970  ey, value in zip
+0002d550: 286e 616d 652c 2074 7275 6e63 6174 6564  (name, truncated
+0002d560: 5f70 6348 6d61 6729 7d20 0d0a 0d0a 0d0a  _pcHmag)} ......
+0002d570: 636c 6173 7320 7348 7068 7a28 6f62 6a65  class sHphz(obje
+0002d580: 6374 2920 3a20 0d0a 2020 2020 2222 220d  ct) : ..    """.
+0002d590: 0a20 2020 2053 7461 7469 7374 6963 616c  .    Statistical
+0002d5a0: 2076 6172 6961 7469 6f6e 206f 6620 7468   variation of th
+0002d5b0: 6520 6461 7461 2062 6c6f 636b 7320 6176  e data blocks av
+0002d5c0: 6572 6167 6564 2066 6f72 2074 6869 7320  eraged for this 
+0002d5d0: 6461 7461 2070 6f69 6e74 2e0d 0a20 2020  data point...   
+0002d5e0: 2020 2020 2031 3030 202a 2053 7461 6e64       100 * Stand
+0002d5f0: 6172 6420 4465 7669 6174 696f 6e20 6f66  ard Deviation of
+0002d600: 2048 7068 7a20 7661 6c75 6573 2028 6d69   Hphz values (mi
+0002d610: 6c6c 6972 6164 6961 6e73 290d 0a20 2020  lliradians)..   
+0002d620: 2020 2020 200d 0a20 2020 2041 7267 756d       ..    Argum
+0002d630: 656e 7473 0d0a 2020 2020 2d2d 2d2d 2d2d  ents..    ------
+0002d640: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2a2a  ----..        **
+0002d650: 7368 7068 7a2a 2a20 203a 206e 6461 7272  shphz**  : ndarr
+0002d660: 6179 0d0a 2020 2020 2020 2020 2020 2020  ay..            
+0002d670: 2020 2020 6461 7461 2061 7272 6179 206f      data array o
+0002d680: 6620 7374 6174 6973 7469 6361 6c20 7661  f statistical va
+0002d690: 7269 6174 696f 6e20 6f66 2045 6d61 6720  riation of Emag 
+0002d6a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002d6b0: 2020 7661 6c75 6520 6f6e 2074 6865 2066    value on the f
+0002d6c0: 6965 6c64 2e0d 0a20 2020 2020 2020 2020  ield...         
+0002d6d0: 2020 2020 2020 2020 200d 0a20 2020 203d           ..    =
+0002d6e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+0002d6f0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d   ===========  ==
+0002d700: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002d710: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002d720: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020  ==========..    
+0002d730: 4174 7472 6962 7574 6573 2020 2020 2020  Attributes      
+0002d740: 2020 2054 7970 6520 2020 2020 2020 2045     Type        E
+0002d750: 7870 6c61 6e61 7469 6f6e 0d0a 2020 2020  xplanation..    
+0002d760: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002d770: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d    ===========  =
+0002d780: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002d790: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002d7a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+0002d7b0: 2076 616c 7565 2020 2020 2020 2020 2020   value          
+0002d7c0: 2020 206e 642e 6172 7261 7920 2020 2020     nd.array     
+0002d7d0: 2064 6174 6120 6f66 2073 4870 687a 2020   data of sHphz  
+0002d7e0: 636f 6c75 6d6e 206f 6e20 6176 6766 696c  column on avgfil
+0002d7f0: 6520 2020 0d0a 2020 2020 6d61 7820 2020  e   ..    max   
+0002d800: 2020 2020 2020 2020 2020 2020 666c 6f61              floa
+0002d810: 7420 2020 2020 2020 2020 6d61 7869 6d75  t         maximu
+0002d820: 6d20 2520 7661 6c75 6520 6f66 2073 4870  m % value of sHp
+0002d830: 687a 0d0a 2020 2020 6d69 6e20 2020 2020  hz..    min     
+0002d840: 2020 2020 2020 2020 2020 666c 6f61 7420            float 
+0002d850: 2020 2020 2020 2020 6d69 6e69 6d75 6d20          minimum 
+0002d860: 2076 616c 7565 206f 6620 7348 7068 7a0d   value of sHphz.
+0002d870: 0a20 2020 206c 6f63 2020 2020 2020 2020  .    loc        
+0002d880: 2020 2020 2020 2064 6963 7420 2020 2020         dict     
+0002d890: 2020 2020 206c 6f63 6174 696f 6e20 6f66       location of
+0002d8a0: 2073 4870 687a 206d 6167 6e69 7475 6465   sHphz magnitude
+0002d8b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002d8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d8d0: 2020 2020 2020 7661 6c75 6520 6174 2074        value at t
+0002d8e0: 6865 2073 7461 7469 6f6e 206c 616d 6264  he station lambd
+0002d8f0: 612e 200d 0a20 2020 2020 2020 2020 2020  a. ..           
+0002d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d910: 2020 2020 2020 2020 2065 3a67 203a 206c           e:g : l
+0002d920: 6f63 5b27 5334 3327 5d20 7368 6f77 2074  oc['S43'] show t
+0002d930: 6865 0d0a 2020 2020 2020 2020 2020 2020  he..            
+0002d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d950: 2020 2020 2020 2020 6375 7272 656e 7420          current 
+0002d960: 2073 4870 687a 2064 6174 6120 6f66 2073   sHphz data of s
+0002d970: 7461 7469 6f6e 2061 7420 5334 332e 0d0a  tation at S43...
+0002d980: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
+0002d990: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
+0002d9a0: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
+0002d9b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002d9c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
+0002d9d0: 0a0d 0a20 2020 204d 6f72 6520 6174 7472  ...    More attr
+0002d9e0: 6962 7574 6573 2063 616e 2062 6520 6164  ibutes can be ad
+0002d9f0: 6465 6420 6279 2069 6e70 7574 696e 6720  ded by inputing 
+0002da00: 6120 6b65 7920 776f 7264 2064 6963 7469  a key word dicti
+0002da10: 6f6e 6172 790d 0a20 2020 200d 0a20 2020  onary..    ..   
+0002da20: 203a 4578 616d 706c 653a 200d 0a20 2020   :Example: ..   
+0002da30: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0002da40: 3e3e 3e20 6672 6f6d 2070 7963 7361 6d74  >>> from pycsamt
+0002da50: 2e63 6f72 652e 6176 6720 696d 706f 7220  .core.avg impor 
+0002da60: 4176 6720 0d0a 2020 2020 2020 2020 3e3e  Avg ..        >>
+0002da70: 3e20 7061 7468 3d6f 732e 7061 7468 2e6a  > path=os.path.j
+0002da80: 6f69 6e28 6f73 2e65 6e76 6972 6f6e 5b22  oin(os.environ["
+0002da90: 7079 4353 414d 5422 5d2c 200d 0a20 2020  pyCSAMT"], ..   
+0002daa0: 2020 2020 202e 2e2e 2020 2020 2020 2770       ...      'p
+0002dab0: 7963 7361 6d74 272c 2022 6461 7461 222c  ycsamt', "data",
+0002dac0: 2022 4b31 2e41 5647 2229 0d0a 2020 2020   "K1.AVG")..    
+0002dad0: 2020 2020 3e3e 3e20 6176 675f 6f62 6a3d      >>> avg_obj=
+0002dae0: 4176 6728 7061 7468 290d 0a20 2020 2020  Avg(path)..     
+0002daf0: 2020 203e 3e3e 2073 6870 687a 5f6f 626a     >>> shphz_obj
+0002db00: 203d 6176 675f 6f62 6a2e 4461 7461 5f73   =avg_obj.Data_s
+0002db10: 6563 7469 6f6e 2e73 4870 687a 2e6c 6f63  ection.sHphz.loc
+0002db20: 5b27 5334 3327 5d0d 0a20 2020 2020 2020  ['S43']..       
+0002db30: 203e 3e3e 2070 7269 6e74 2873 6870 687a   >>> print(shphz
+0002db40: 5f6f 626a 290d 0a20 2020 2020 2020 200d  _obj)..        .
+0002db50: 0a20 2020 2022 2222 0d0a 2020 2020 6465  .    """..    de
+0002db60: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+0002db70: 2073 6870 687a 5f61 7272 6179 3d4e 6f6e   shphz_array=Non
+0002db80: 652c 206e 756d 6265 725f 6f66 5f66 7265  e, number_of_fre
+0002db90: 7175 656e 6369 6573 3d4e 6f6e 6520 2c20  quencies=None , 
+0002dba0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002dbb0: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
+0002dbc0: 7469 6f6e 733d 4e6f 6e65 202c 202a 2a6b  tions=None , **k
+0002dbd0: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
+0002dbe0: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+0002dbf0: 5f73 4870 687a 3d20 7368 7068 7a5f 6172  _sHphz= shphz_ar
+0002dc00: 7261 790d 0a20 2020 2020 2020 200d 0a20  ray..        .. 
+0002dc10: 2020 2020 2020 2073 656c 662e 6e75 6d62         self.numb
+0002dc20: 6572 5f6f 665f 7374 6174 696f 6e73 203d  er_of_stations =
+0002dc30: 6b77 6172 6773 2e70 6f70 2822 6e75 6d62  kwargs.pop("numb
+0002dc40: 6572 5f6f 665f 7374 6174 696f 6e73 222c  er_of_stations",
+0002dc50: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
+0002dc60: 7365 6c66 2e6e 6672 6571 203d 6b77 6172  self.nfreq =kwar
+0002dc70: 6773 2e70 6f70 2827 6e75 6d62 6572 5f6f  gs.pop('number_o
+0002dc80: 665f 6672 6571 7565 6e63 6965 7327 2c20  f_frequencies', 
+0002dc90: 4e6f 6e65 290d 0a20 2020 2020 2020 2073  None)..        s
+0002dca0: 656c 662e 746f 5f64 6567 7265 6520 3d6b  elf.to_degree =k
+0002dcb0: 7761 7267 732e 706f 7028 2774 6f5f 6465  wargs.pop('to_de
+0002dcc0: 6772 6565 272c 2046 616c 7365 290d 0a20  gree', False).. 
+0002dcd0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002dce0: 2073 656c 662e 7661 6c75 6520 3d4e 6f6e   self.value =Non
+0002dcf0: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
+0002dd00: 2e6d 696e 203d 204e 6f6e 6520 0d0a 2020  .min = None ..  
+0002dd10: 2020 2020 2020 7365 6c66 2e6d 6178 203d        self.max =
+0002dd20: 204e 6f6e 6520 0d0a 2020 2020 0d0a 2020   None ..    ..  
+0002dd30: 2020 2020 2020 666f 7220 6b65 7920 696e        for key in
+0002dd40: 206c 6973 7428 6b77 6172 6773 2e6b 6579   list(kwargs.key
+0002dd50: 7328 2929 3a0d 0a20 2020 2020 2020 2020  s()):..         
+0002dd60: 2020 2073 6574 6174 7472 2873 656c 662c     setattr(self,
+0002dd70: 206b 6579 2c20 6b77 6172 6773 5b6b 6579   key, kwargs[key
+0002dd80: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0002dd90: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0002dda0: 662e 5f73 4870 687a 2069 7320 6e6f 7420  f._sHphz is not 
+0002ddb0: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+0002ddc0: 2020 2020 2073 656c 662e 5f72 6561 645f       self._read_
+0002ddd0: 7348 7068 7a5f 6461 7461 2028 290d 0a20  sHphz_data ().. 
+0002dde0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002ddf0: 200d 0a20 2020 2064 6566 205f 7265 6164   ..    def _read
+0002de00: 5f73 4870 687a 5f64 6174 6120 2873 656c  _sHphz_data (sel
+0002de10: 662c 2073 4870 687a 5f61 7272 6179 3d4e  f, sHphz_array=N
+0002de20: 6f6e 652c 206e 756d 6265 725f 6f66 5f66  one, number_of_f
+0002de30: 7265 7175 656e 6369 6573 3d4e 6f6e 6520  requencies=None 
+0002de40: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0002de50: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0002de60: 6265 725f 6f66 5f73 7461 7469 6f6e 733d  ber_of_stations=
+0002de70: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 2020  None, **kwargs  
+0002de80: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
+0002de90: 0a20 2020 2020 2020 204d 6574 686f 6420  .        Method 
+0002dea0: 746f 2072 6561 6420 616e 6420 6172 616e  to read and aran
+0002deb0: 6765 2064 6174 6120 6163 636f 7264 696e  ge data accordin
+0002dec0: 6720 6561 6368 2073 7461 7469 6f6e 202f  g each station /
+0002ded0: 5374 6174 6973 7469 6361 6c20 7661 7269  Statistical vari
+0002dee0: 6174 696f 6e20 0d0a 2020 2020 2020 2020  ation ..        
+0002def0: 6f66 2042 2d46 6965 6c64 2061 6e67 6c65  of B-Field angle
+0002df00: 732e 200d 0a20 2020 2020 2020 2020 2020  s. ..           
+0002df10: 2076 616c 7565 7320 2e0d 0a20 2020 2020   values ...     
+0002df20: 2020 200d 0a20 2020 2020 2020 2050 6172     ..        Par
+0002df30: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0002df40: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0002df50: 2020 2020 2020 2020 202a 2073 6870 687a           * shphz
+0002df60: 5f61 7272 6179 203a 206e 6461 7272 6179  _array : ndarray
+0002df70: 2c20 656e 2072 6164 200d 0a20 2020 2020  , en rad ..     
+0002df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002df90: 2020 2020 2020 2045 2d46 6965 6c64 2070         E-Field p
+0002dfa0: 6861 7365 206f 6273 6572 7665 6420 2e20  hase observed . 
+0002dfb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002dfc0: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+0002dfd0: 6520 6465 6661 756c 7420 6973 204e 6f6e  e default is Non
+0002dfe0: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
+0002dff0: 2a20 6e75 6d62 6572 5f6f 665f 6672 6571  * number_of_freq
+0002e000: 7565 6e63 6965 7320 3a20 696e 7420 2c20  uencies : int , 
+0002e010: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
 0002e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e040: 7661 6c75 6520 6174 2074 6865 2073 7461  value at the sta
-0002e050: 7469 6f6e 206c 616d 6264 612e 200d 0a20  tion lambda. .. 
+0002e030: 2020 2020 2020 6e75 6d62 6572 206f 6620        number of 
+0002e040: 6672 6571 7565 6e63 6965 7320 666f 7220  frequencies for 
+0002e050: 7375 7276 6579 2e0d 0a20 2020 2020 2020  survey...       
 0002e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e080: 2020 2065 3a67 203a 206c 6f63 5b27 5334     e:g : loc['S4
-0002e090: 3327 5d20 7368 6f77 2074 6865 0d0a 2020  3'] show the..  
-0002e0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0c0: 2020 6375 7272 656e 7420 2073 4870 687a    current  sHphz
-0002e0d0: 2064 6174 6120 6f66 2073 7461 7469 6f6e   data of station
-0002e0e0: 2061 7420 5334 332e 0d0a 2020 2020 3d3d   at S43...    ==
-0002e0f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==============  
-0002e100: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
-0002e110: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002e120: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002e130: 3d3d 3d3d 3d3d 3d3d 3d0d 0a0d 0a20 2020  =========....   
-0002e140: 204d 6f72 6520 6174 7472 6962 7574 6573   More attributes
-0002e150: 2063 616e 2062 6520 6164 6465 6420 6279   can be added by
-0002e160: 2069 6e70 7574 696e 6720 6120 6b65 7920   inputing a key 
-0002e170: 776f 7264 2064 6963 7469 6f6e 6172 790d  word dictionary.
-0002e180: 0a20 2020 200d 0a20 2020 203a 4578 616d  .    ..    :Exam
-0002e190: 706c 653a 200d 0a20 2020 2020 2020 2020  ple: ..         
-0002e1a0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-0002e1b0: 6f6d 2070 7963 7361 6d74 2e66 662e 636f  om pycsamt.ff.co
-0002e1c0: 7265 2e61 7667 2069 6d70 6f72 2041 7667  re.avg impor Avg
-0002e1d0: 200d 0a20 2020 2020 2020 203e 3e3e 2070   ..        >>> p
-0002e1e0: 6174 683d 6f73 2e70 6174 682e 6a6f 696e  ath=os.path.join
-0002e1f0: 286f 732e 656e 7669 726f 6e5b 2270 7943  (os.environ["pyC
-0002e200: 5341 4d54 225d 2c20 0d0a 2020 2020 2020  SAMT"], ..      
-0002e210: 2020 2e2e 2e20 2020 2020 2027 7079 6373    ...      'pycs
-0002e220: 616d 7427 2c20 2264 6174 6122 2c20 224b  amt', "data", "K
-0002e230: 312e 4156 4722 290d 0a20 2020 2020 2020  1.AVG")..       
-0002e240: 203e 3e3e 2061 7667 5f6f 626a 3d41 7667   >>> avg_obj=Avg
-0002e250: 2870 6174 6829 0d0a 2020 2020 2020 2020  (path)..        
-0002e260: 3e3e 3e20 7368 7068 7a5f 6f62 6a20 3d61  >>> shphz_obj =a
-0002e270: 7667 5f6f 626a 2e44 6174 615f 7365 6374  vg_obj.Data_sect
-0002e280: 696f 6e2e 7348 7068 7a2e 6c6f 635b 2753  ion.sHphz.loc['S
-0002e290: 3433 275d 0d0a 2020 2020 2020 2020 3e3e  43']..        >>
-0002e2a0: 3e20 7072 696e 7428 7368 7068 7a5f 6f62  > print(shphz_ob
-0002e2b0: 6a29 0d0a 2020 2020 2020 2020 0d0a 2020  j)..        ..  
-0002e2c0: 2020 2222 220d 0a20 2020 2064 6566 205f    """..    def _
-0002e2d0: 5f69 6e69 745f 5f28 7365 6c66 2c20 7368  _init__(self, sh
-0002e2e0: 7068 7a5f 6172 7261 793d 4e6f 6e65 2c20  phz_array=None, 
-0002e2f0: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
-0002e300: 6e63 6965 733d 4e6f 6e65 202c 200d 0a20  ncies=None , .. 
-0002e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e320: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-0002e330: 6e73 3d4e 6f6e 6520 2c20 2a2a 6b77 6172  ns=None , **kwar
-0002e340: 6773 293a 0d0a 2020 2020 2020 2020 0d0a  gs):..        ..
-0002e350: 2020 2020 2020 2020 7365 6c66 2e5f 7348          self._sH
-0002e360: 7068 7a3d 2073 6870 687a 5f61 7272 6179  phz= shphz_array
-0002e370: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0002e380: 2020 2020 7365 6c66 2e6e 756d 6265 725f      self.number_
-0002e390: 6f66 5f73 7461 7469 6f6e 7320 3d6b 7761  of_stations =kwa
-0002e3a0: 7267 732e 706f 7028 226e 756d 6265 725f  rgs.pop("number_
-0002e3b0: 6f66 5f73 7461 7469 6f6e 7322 2c20 4e6f  of_stations", No
-0002e3c0: 6e65 290d 0a20 2020 2020 2020 2073 656c  ne)..        sel
-0002e3d0: 662e 6e66 7265 7120 3d6b 7761 7267 732e  f.nfreq =kwargs.
-0002e3e0: 706f 7028 276e 756d 6265 725f 6f66 5f66  pop('number_of_f
-0002e3f0: 7265 7175 656e 6369 6573 272c 204e 6f6e  requencies', Non
-0002e400: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
-0002e410: 2e74 6f5f 6465 6772 6565 203d 6b77 6172  .to_degree =kwar
-0002e420: 6773 2e70 6f70 2827 746f 5f64 6567 7265  gs.pop('to_degre
-0002e430: 6527 2c20 4661 6c73 6529 0d0a 2020 2020  e', False)..    
-0002e440: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
-0002e450: 6c66 2e76 616c 7565 203d 4e6f 6e65 200d  lf.value =None .
-0002e460: 0a20 2020 2020 2020 2073 656c 662e 6d69  .        self.mi
-0002e470: 6e20 3d20 4e6f 6e65 200d 0a20 2020 2020  n = None ..     
-0002e480: 2020 2073 656c 662e 6d61 7820 3d20 4e6f     self.max = No
-0002e490: 6e65 200d 0a20 2020 200d 0a20 2020 2020  ne ..    ..     
-0002e4a0: 2020 2066 6f72 206b 6579 2069 6e20 6c69     for key in li
-0002e4b0: 7374 286b 7761 7267 732e 6b65 7973 2829  st(kwargs.keys()
-0002e4c0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0002e4d0: 7365 7461 7474 7228 7365 6c66 2c20 6b65  setattr(self, ke
-0002e4e0: 792c 206b 7761 7267 735b 6b65 795d 290d  y, kwargs[key]).
-0002e4f0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0002e500: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0002e510: 7348 7068 7a20 6973 206e 6f74 204e 6f6e  sHphz is not Non
-0002e520: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-0002e530: 2020 7365 6c66 2e5f 7265 6164 5f73 4870    self._read_sHp
-0002e540: 687a 5f64 6174 6120 2829 0d0a 2020 2020  hz_data ()..    
-0002e550: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
-0002e560: 2020 2020 6465 6620 5f72 6561 645f 7348      def _read_sH
-0002e570: 7068 7a5f 6461 7461 2028 7365 6c66 2c20  phz_data (self, 
-0002e580: 7348 7068 7a5f 6172 7261 793d 4e6f 6e65  sHphz_array=None
-0002e590: 2c20 6e75 6d62 6572 5f6f 665f 6672 6571  , number_of_freq
-0002e5a0: 7565 6e63 6965 733d 4e6f 6e65 202c 200d  uencies=None , .
-0002e5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e5c0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-0002e5d0: 5f6f 665f 7374 6174 696f 6e73 3d4e 6f6e  _of_stations=Non
-0002e5e0: 652c 202a 2a6b 7761 7267 7320 2029 3a0d  e, **kwargs  ):.
-0002e5f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0002e600: 2020 2020 2020 4d65 7468 6f64 2074 6f20        Method to 
-0002e610: 7265 6164 2061 6e64 2061 7261 6e67 6520  read and arange 
-0002e620: 6461 7461 2061 6363 6f72 6469 6e67 2065  data according e
-0002e630: 6163 6820 7374 6174 696f 6e20 2f53 7461  ach station /Sta
-0002e640: 7469 7374 6963 616c 2076 6172 6961 7469  tistical variati
-0002e650: 6f6e 200d 0a20 2020 2020 2020 206f 6620  on ..        of 
-0002e660: 422d 4669 656c 6420 616e 676c 6573 2e20  B-Field angles. 
-0002e670: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
-0002e680: 6c75 6573 202e 0d0a 2020 2020 2020 2020  lues ...        
-0002e690: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0002e6a0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0002e6b0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0002e6c0: 2020 2020 2020 2a20 7368 7068 7a5f 6172        * shphz_ar
-0002e6d0: 7261 7920 3a20 6e64 6172 7261 792c 2065  ray : ndarray, e
-0002e6e0: 6e20 7261 6420 0d0a 2020 2020 2020 2020  n rad ..        
-0002e6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e700: 2020 2020 452d 4669 656c 6420 7068 6173      E-Field phas
-0002e710: 6520 6f62 7365 7276 6564 202e 200d 0a20  e observed . .. 
-0002e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e730: 2020 2020 2020 2020 2020 2054 6865 2064             The d
-0002e740: 6566 6175 6c74 2069 7320 4e6f 6e65 2e0d  efault is None..
-0002e750: 0a20 2020 2020 2020 2020 2020 202a 206e  .            * n
-0002e760: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
-0002e770: 6369 6573 203a 2069 6e74 202c 206f 7074  cies : int , opt
-0002e780: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
-0002e790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e7a0: 2020 206e 756d 6265 7220 6f66 2066 7265     number of fre
-0002e7b0: 7175 656e 6369 6573 2066 6f72 2073 7572  quencies for sur
-0002e7c0: 7665 792e 0d0a 2020 2020 2020 2020 2020  vey...          
-0002e7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e7e0: 2020 5468 6520 6465 6661 756c 7420 6973    The default is
-0002e7f0: 204e 6f6e 652e 0d0a 2020 2020 2020 2020   None...        
-0002e800: 2020 2020 2a20 6e75 6d62 6572 5f6f 665f      * number_of_
-0002e810: 7374 6174 696f 6e73 203a 2069 6e74 202c  stations : int ,
-0002e820: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-0002e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e840: 2020 2020 6e75 6d62 6572 5f6f 6620 7374      number_of st
-0002e850: 6174 696f 6e73 2e20 5468 6520 6465 6661  ations. The defa
-0002e860: 756c 7420 6973 204e 6f6e 652e 0d0a 2020  ult is None...  
-0002e870: 2020 2020 2020 2020 2020 2a20 746f 5f64            * to_d
-0002e880: 6567 7265 6520 3a20 626f 6f6c 2c0d 0a20  egree : bool,.. 
-0002e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e8a0: 2020 2020 2020 2020 636f 6d70 7574 6520          compute 
-0002e8b0: 616e 676c 6520 746f 6465 6772 6565 202e  angle todegree .
-0002e8c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002e8d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0002e8e0: 2022 2222 0d0a 2020 2020 2020 2020 746f   """..        to
-0002e8f0: 5f64 6567 7265 6520 3d6b 7761 7267 732e  _degree =kwargs.
-0002e900: 706f 7028 2274 6f5f 6465 6772 6565 222c  pop("to_degree",
-0002e910: 2046 616c 7365 290d 0a20 2020 2020 2020   False)..       
-0002e920: 2069 6620 746f 5f64 6567 7265 6520 3a0d   if to_degree :.
-0002e930: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002e940: 662e 746f 5f64 6567 7265 6520 3d20 746f  f.to_degree = to
-0002e950: 5f64 6567 7265 650d 0a20 2020 2020 2020  _degree..       
-0002e960: 200d 0a20 2020 2020 2020 2069 6620 7348   ..        if sH
-0002e970: 7068 7a5f 6172 7261 7920 6973 206e 6f74  phz_array is not
-0002e980: 204e 6f6e 6520 3a20 7365 6c66 2e5f 7348   None : self._sH
-0002e990: 7068 7a20 3d73 4870 687a 5f61 7272 6179  phz =sHphz_array
-0002e9a0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0002e9b0: 662e 5f73 4870 687a 2069 7320 4e6f 6e65  f._sHphz is None
-0002e9c0: 203a 2020 0d0a 2020 2020 2020 2020 2020   :  ..          
-0002e9d0: 2020 7261 6973 6520 4353 6578 2e70 7943    raise CSex.pyC
-0002e9e0: 5341 4d54 4572 726f 725f 696e 7075 7461  SAMTError_inputa
-0002e9f0: 7267 756d 656e 7473 280d 0a20 2020 2020  rguments(..     
-0002ea00: 2020 2020 2020 2020 2020 2027 4e6f 2073             'No s
-0002ea10: 7461 742e 7661 7269 6174 696f 6e20 422d  tat.variation B-
-0002ea20: 6669 656c 642d 7068 6173 6520 6461 7461  field-phase data
-0002ea30: 2066 6f75 6e64 2020 2127 290d 0a20 2020   found  !')..   
+0002e070: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
+0002e080: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2020   is None...     
+0002e090: 2020 2020 2020 202a 206e 756d 6265 725f         * number_
+0002e0a0: 6f66 5f73 7461 7469 6f6e 7320 3a20 696e  of_stations : in
+0002e0b0: 7420 2c20 6f70 7469 6f6e 616c 0d0a 2020  t , optional..  
+0002e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e0d0: 2020 2020 2020 206e 756d 6265 725f 6f66         number_of
+0002e0e0: 2073 7461 7469 6f6e 732e 2054 6865 2064   stations. The d
+0002e0f0: 6566 6175 6c74 2069 7320 4e6f 6e65 2e0d  efault is None..
+0002e100: 0a20 2020 2020 2020 2020 2020 202a 2074  .            * t
+0002e110: 6f5f 6465 6772 6565 203a 2062 6f6f 6c2c  o_degree : bool,
+0002e120: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002e130: 2020 2020 2020 2020 2020 2063 6f6d 7075             compu
+0002e140: 7465 2061 6e67 6c65 2074 6f64 6567 7265  te angle todegre
+0002e150: 6520 2e0d 0a20 2020 2020 2020 2020 2020  e ...           
+0002e160: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0002e170: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0002e180: 2074 6f5f 6465 6772 6565 203d 6b77 6172   to_degree =kwar
+0002e190: 6773 2e70 6f70 2822 746f 5f64 6567 7265  gs.pop("to_degre
+0002e1a0: 6522 2c20 4661 6c73 6529 0d0a 2020 2020  e", False)..    
+0002e1b0: 2020 2020 6966 2074 6f5f 6465 6772 6565      if to_degree
+0002e1c0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0002e1d0: 7365 6c66 2e74 6f5f 6465 6772 6565 203d  self.to_degree =
+0002e1e0: 2074 6f5f 6465 6772 6565 0d0a 2020 2020   to_degree..    
+0002e1f0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+0002e200: 2073 4870 687a 5f61 7272 6179 2069 7320   sHphz_array is 
+0002e210: 6e6f 7420 4e6f 6e65 203a 2073 656c 662e  not None : self.
+0002e220: 5f73 4870 687a 203d 7348 7068 7a5f 6172  _sHphz =sHphz_ar
+0002e230: 7261 790d 0a20 2020 2020 2020 2069 6620  ray..        if 
+0002e240: 7365 6c66 2e5f 7348 7068 7a20 6973 204e  self._sHphz is N
+0002e250: 6f6e 6520 3a20 200d 0a20 2020 2020 2020  one :  ..       
+0002e260: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0002e270: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+0002e280: 2020 2020 2020 2027 4e6f 2073 7461 742e         'No stat.
+0002e290: 7661 7269 6174 696f 6e20 422d 6669 656c  variation B-fiel
+0002e2a0: 642d 7068 6173 6520 6461 7461 2066 6f75  d-phase data fou
+0002e2b0: 6e64 2020 2127 290d 0a20 2020 2020 2020  nd  !')..       
+0002e2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e2e0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+0002e2f0: 2020 2020 2020 2069 6620 6e75 6d62 6572         if number
+0002e300: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
+0002e310: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
+0002e320: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002e330: 6e66 7265 7120 3d20 6e75 6d62 6572 5f6f  nfreq = number_o
+0002e340: 665f 6672 6571 7565 6e63 6965 7320 0d0a  f_frequencies ..
+0002e350: 2020 2020 2020 2020 656c 7365 203a 0d0a          else :..
+0002e360: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002e370: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
+0002e380: 2020 2020 2020 2020 2020 2020 2020 2250                "P
+0002e390: 6c65 6173 6520 7370 6563 6966 7920 7468  lease specify th
+0002e3a0: 6520 6e75 6d62 6572 206f 6620 6672 6571  e number of freq
+0002e3b0: 7565 6e63 7920 2122 290d 0a20 2020 2020  uency !")..     
+0002e3c0: 2020 2069 6620 6e75 6d62 6572 5f6f 665f     if number_of_
+0002e3d0: 7374 6174 696f 6e73 2069 7320 6e6f 7420  stations is not 
+0002e3e0: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+0002e3f0: 2020 2020 2073 656c 662e 6e75 6d62 6572       self.number
+0002e400: 5f6f 665f 7374 6174 696f 6e73 203d 6e75  _of_stations =nu
+0002e410: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+0002e420: 200d 0a20 2020 2020 2020 2065 6c73 6520   ..        else 
+0002e430: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0002e440: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0002e450: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002e460: 2020 2750 6c65 6173 6520 7370 6563 6966    'Please specif
+0002e470: 7920 7468 6520 6e75 6d62 6572 206f 6620  y the number of 
+0002e480: 7374 6174 696f 6e73 2729 0d0a 2020 2020  stations')..    
+0002e490: 2020 2020 7365 6c66 2e6e 6672 6571 202c      self.nfreq ,
+0002e4a0: 2073 656c 662e 6e75 6d62 6572 5f6f 665f   self.number_of_
+0002e4b0: 7374 6174 696f 6e73 203d 6e70 2e69 6e74  stations =np.int
+0002e4c0: 2873 656c 662e 6e66 7265 7129 2c5c 0d0a  (self.nfreq),\..
+0002e4d0: 2020 2020 2020 2020 2020 2020 6e70 2e69              np.i
+0002e4e0: 6e74 2873 656c 662e 6e75 6d62 6572 5f6f  nt(self.number_o
+0002e4f0: 665f 7374 6174 696f 6e73 2920 2020 200d  f_stations)    .
+0002e500: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0002e510: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0002e520: 2020 2020 6465 6620 5f69 6e73 7065 6374      def _inspect
+0002e530: 5f69 6e70 7574 2028 696e 7075 745f 6f62  _input (input_ob
+0002e540: 6a20 2c20 746f 5f64 6567 7265 653d 4661  j , to_degree=Fa
+0002e550: 6c73 6529 3a0d 0a20 2020 2020 2020 2020  lse):..         
+0002e560: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+0002e570: 2020 2020 4173 6365 7274 6169 6e20 7468      Ascertain th
+0002e580: 6174 2074 6865 2076 616c 7565 2069 7320  at the value is 
+0002e590: 706f 7373 6962 6c65 2066 6f72 2063 6f6d  possible for com
+0002e5a0: 7075 7469 6e67 2e20 616e 6420 7075 7420  puting. and put 
+0002e5b0: 6f6e 200d 0a20 2020 2020 2020 2020 2020  on ..           
+0002e5c0: 206e 6461 7272 6179 2028 6e64 6172 7261   ndarray (ndarra
+0002e5d0: 792c 3129 0d0a 2020 2020 2020 2020 2020  y,1)..          
+0002e5e0: 2020 2222 2220 2020 2020 2020 2020 2020    """           
+0002e5f0: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
+0002e600: 7279 203a 200d 0a20 2020 2020 2020 2020  ry : ..         
+0002e610: 2020 2020 2020 2069 6e70 7574 5f6f 626a         input_obj
+0002e620: 203d 6e70 2e61 7272 6179 285b 666c 6f61   =np.array([floa
+0002e630: 7428 7373 2920 666f 7220 7373 2069 6e20  t(ss) for ss in 
+0002e640: 696e 7075 745f 6f62 6a5d 290d 0a20 2020  input_obj])..   
+0002e650: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+0002e660: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0002e670: 2020 2020 7261 6973 6520 2056 616c 7565      raise  Value
+0002e680: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+0002e690: 2020 2020 2020 2020 2020 2020 2256 616c              "Val
+0002e6a0: 7565 7320 7072 6f76 6964 6564 2066 6f72  ues provided for
+0002e6b0: 2063 6f6d 7075 7469 6e67 2061 7265 2077   computing are w
+0002e6c0: 726f 6e67 2e22 5c0d 0a20 2020 2020 2020  rong."\..       
+0002e6d0: 2020 2020 2020 2020 2020 2020 2022 206d               " m
+0002e6e0: 7573 7420 6265 2066 6c6f 6174 206f 7220  ust be float or 
+0002e6f0: 696e 7465 6765 7220 2e22 290d 0a20 2020  integer .")..   
+0002e700: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0002e710: 2020 2020 2020 2069 6620 746f 5f64 6567         if to_deg
+0002e720: 7265 6520 3a20 0d0a 2020 2020 2020 2020  ree : ..        
+0002e730: 2020 2020 2020 2020 696e 7075 745f 6f62          input_ob
+0002e740: 6a20 3d20 6e70 2e61 7070 6c79 5f61 6c6f  j = np.apply_alo
+0002e750: 6e67 5f61 7869 7320 280d 0a20 2020 2020  ng_axis (..     
+0002e760: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0002e770: 616d 6264 6120 783a 2078 202a 2031 3830  ambda x: x * 180
+0002e780: 2f6e 702e 7069 2c20 302c 2069 6e70 7574  /np.pi, 0, input
+0002e790: 5f6f 626a 290d 0a20 2020 2020 2020 2020  _obj)..         
+0002e7a0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0002e7b0: 2072 6574 7572 6e20 696e 7075 745f 6f62   return input_ob
+0002e7c0: 6a20 0d0a 0d0a 2020 2020 2020 2020 7365  j ....        se
+0002e7d0: 6c66 2e5f 7348 7068 7a3d 205f 696e 7370  lf._sHphz= _insp
+0002e7e0: 6563 745f 696e 7075 7428 7365 6c66 2e5f  ect_input(self._
+0002e7f0: 7348 7068 7a29 0d0a 0d0a 0d0a 2020 2020  sHphz)......    
+0002e800: 2020 2020 6966 2073 656c 662e 746f 5f64      if self.to_d
+0002e810: 6567 7265 6520 3a20 232d 2d2d 3e20 7365  egree : #---> se
+0002e820: 7420 616e 676c 6520 746f 2064 6567 7265  t angle to degre
+0002e830: 6520 2e0d 0a20 2020 2020 2020 2020 2020  e ...           
+0002e840: 2073 656c 662e 5f73 4870 687a 203d 5f69   self._sHphz =_i
+0002e850: 6e73 7065 6374 5f69 6e70 7574 2869 6e70  nspect_input(inp
+0002e860: 7574 5f6f 626a 203d 7365 6c66 2e5f 7348  ut_obj =self._sH
+0002e870: 7068 7a2c 2074 6f5f 6465 6772 6565 203d  phz, to_degree =
+0002e880: 5472 7565 2920 2020 2020 2020 200d 0a20  True)        .. 
+0002e890: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002e8a0: 2023 202d 2d3e 2063 6865 636b 2074 6865   # --> check the
+0002e8b0: 206d 6178 696d 756d 2061 6e67 6c65 2076   maximum angle v
+0002e8c0: 616c 7565 2061 6e64 206d 696e 696d 756d  alue and minimum
+0002e8d0: 2061 6e67 6c65 2076 616c 7565 2e0d 0a20   angle value... 
+0002e8e0: 2020 2020 2020 2076 636f 756e 7473 5f73         vcounts_s
+0002e8f0: 6870 687a 2c20 7265 7065 6174 5f68 7068  hphz, repeat_hph
+0002e900: 7a3d 6e70 2e75 6e69 7175 6520 2873 656c  z=np.unique (sel
+0002e910: 662e 5f73 4870 687a 2c20 7265 7475 726e  f._sHphz, return
+0002e920: 5f63 6f75 6e74 733d 5472 7565 290d 0a20  _counts=True).. 
+0002e930: 2020 2020 2020 2073 656c 662e 7661 6c75         self.valu
+0002e940: 6520 3d76 636f 756e 7473 5f73 6870 687a  e =vcounts_shphz
+0002e950: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+0002e960: 6178 2c20 7365 6c66 2e6d 696e 203d 7663  ax, self.min =vc
+0002e970: 6f75 6e74 735f 7368 7068 7a2e 6d61 7828  ounts_shphz.max(
+0002e980: 292c 2076 636f 756e 7473 5f73 6870 687a  ), vcounts_shphz
+0002e990: 2e6d 696e 2829 0d0a 2020 2020 2020 2020  .min()..        
+0002e9a0: 0d0a 2020 2020 2020 2020 232d 2d2d 3e20  ..        #---> 
+0002e9b0: 7475 6e63 6174 6564 2041 5647 2073 4870  tuncated AVG sHp
+0002e9c0: 687a 2076 616c 7565 206f 6e20 2064 6963  hz value on  dic
+0002e9d0: 7469 6f6e 6e61 7279 2066 6f72 2065 6173  tionnary for eas
+0002e9e0: 7920 6163 6365 7320 2e20 0d0a 2020 2020  y acces . ..    
+0002e9f0: 2020 2020 7472 756e 6361 7465 645f 7368      truncated_sh
+0002ea00: 7068 7a3d 5a63 632e 7472 756e 6361 7465  phz=Zcc.truncate
+0002ea10: 645f 6461 7461 2820 6461 7461 203d 7365  d_data( data =se
+0002ea20: 6c66 2e5f 7348 7068 7a2c 200d 0a20 2020  lf._sHphz, ..   
+0002ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea70: 200d 0a20 2020 2020 2020 2069 6620 6e75   ..        if nu
-0002ea80: 6d62 6572 5f6f 665f 6672 6571 7565 6e63  mber_of_frequenc
-0002ea90: 6965 7320 6973 206e 6f74 204e 6f6e 6520  ies is not None 
-0002eaa0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0002eab0: 656c 662e 6e66 7265 7120 3d20 6e75 6d62  elf.nfreq = numb
-0002eac0: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
-0002ead0: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
-0002eae0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0002eaf0: 7261 6973 6520 4353 6578 2e70 7943 5341  raise CSex.pyCSA
-0002eb00: 4d54 4572 726f 725f 696e 7075 7461 7267  MTError_inputarg
-0002eb10: 756d 656e 7473 280d 0a20 2020 2020 2020  uments(..       
-0002eb20: 2020 2020 2020 2020 2022 506c 6561 7365           "Please
-0002eb30: 2073 7065 6369 6679 2074 6865 206e 756d   specify the num
-0002eb40: 6265 7220 6f66 2066 7265 7175 656e 6379  ber of frequency
-0002eb50: 2021 2229 0d0a 2020 2020 2020 2020 6966   !")..        if
-0002eb60: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
-0002eb70: 6f6e 7320 6973 206e 6f74 204e 6f6e 6520  ons is not None 
-0002eb80: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0002eb90: 7365 6c66 2e6e 756d 6265 725f 6f66 5f73  self.number_of_s
-0002eba0: 7461 7469 6f6e 7320 3d6e 756d 6265 725f  tations =number_
-0002ebb0: 6f66 5f73 7461 7469 6f6e 7320 0d0a 2020  of_stations ..  
-0002ebc0: 2020 2020 2020 656c 7365 203a 200d 0a20        else : .. 
-0002ebd0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002ebe0: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-0002ebf0: 6f72 5f69 6e70 7574 6172 6775 6d65 6e74  or_inputargument
-0002ec00: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-0002ec10: 2020 2020 2750 6c65 6173 6520 7370 6563      'Please spec
-0002ec20: 6966 7920 7468 6520 6e75 6d62 6572 206f  ify the number o
-0002ec30: 6620 7374 6174 696f 6e73 2729 0d0a 2020  f stations')..  
-0002ec40: 2020 2020 2020 7365 6c66 2e6e 6672 6571        self.nfreq
-0002ec50: 202c 2073 656c 662e 6e75 6d62 6572 5f6f   , self.number_o
-0002ec60: 665f 7374 6174 696f 6e73 203d 6e70 2e69  f_stations =np.i
-0002ec70: 6e74 2873 656c 662e 6e66 7265 7129 2c5c  nt(self.nfreq),\
-0002ec80: 0d0a 2020 2020 2020 2020 2020 2020 6e70  ..            np
-0002ec90: 2e69 6e74 2873 656c 662e 6e75 6d62 6572  .int(self.number
-0002eca0: 5f6f 665f 7374 6174 696f 6e73 2920 2020  _of_stations)   
-0002ecb0: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-0002ecc0: 0a20 2020 2020 2020 2020 2020 0d0a 2020  .           ..  
-0002ecd0: 2020 2020 2020 6465 6620 5f69 6e73 7065        def _inspe
-0002ece0: 6374 5f69 6e70 7574 2028 696e 7075 745f  ct_input (input_
-0002ecf0: 6f62 6a20 2c20 746f 5f64 6567 7265 653d  obj , to_degree=
-0002ed00: 4661 6c73 6529 3a0d 0a20 2020 2020 2020  False):..       
-0002ed10: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0002ed20: 2020 2020 2020 4173 6365 7274 6169 6e20        Ascertain 
-0002ed30: 7468 6174 2074 6865 2076 616c 7565 2069  that the value i
-0002ed40: 7320 706f 7373 6962 6c65 2066 6f72 2063  s possible for c
-0002ed50: 6f6d 7075 7469 6e67 2e20 616e 6420 7075  omputing. and pu
-0002ed60: 7420 6f6e 200d 0a20 2020 2020 2020 2020  t on ..         
-0002ed70: 2020 206e 6461 7272 6179 2028 6e64 6172     ndarray (ndar
-0002ed80: 7261 792c 3129 0d0a 2020 2020 2020 2020  ray,1)..        
-0002ed90: 2020 2020 2222 2220 2020 2020 2020 2020      """         
-0002eda0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0002edb0: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
-0002edc0: 2020 2020 2020 2020 2069 6e70 7574 5f6f           input_o
-0002edd0: 626a 203d 6e70 2e61 7272 6179 285b 666c  bj =np.array([fl
-0002ede0: 6f61 7428 7373 2920 666f 7220 7373 2069  oat(ss) for ss i
-0002edf0: 6e20 696e 7075 745f 6f62 6a5d 290d 0a20  n input_obj]).. 
-0002ee00: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-0002ee10: 7420 3a20 0d0a 2020 2020 2020 2020 2020  t : ..          
-0002ee20: 2020 2020 2020 7261 6973 6520 2043 5365        raise  CSe
-0002ee30: 782e 7079 4353 414d 5445 7272 6f72 5f76  x.pyCSAMTError_v
-0002ee40: 616c 7565 280d 0a20 2020 2020 2020 2020  alue(..         
-0002ee50: 2020 2020 2020 2020 2020 2022 5661 6c75             "Valu
-0002ee60: 6573 2070 726f 7669 6465 6420 666f 7220  es provided for 
-0002ee70: 636f 6d70 7574 696e 6720 6172 6520 7772  computing are wr
-0002ee80: 6f6e 672e 225c 0d0a 2020 2020 2020 2020  ong."\..        
-0002ee90: 2020 2020 2020 2020 2020 2020 2220 6d75              " mu
-0002eea0: 7374 2062 6520 666c 6f61 7420 6f72 2069  st be float or i
-0002eeb0: 6e74 6567 6572 202e 2229 0d0a 2020 2020  nteger .")..    
-0002eec0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0002eed0: 2020 2020 2020 6966 2074 6f5f 6465 6772        if to_degr
-0002eee0: 6565 203a 200d 0a20 2020 2020 2020 2020  ee : ..         
-0002eef0: 2020 2020 2020 2069 6e70 7574 5f6f 626a         input_obj
-0002ef00: 203d 206e 702e 6170 706c 795f 616c 6f6e   = np.apply_alon
-0002ef10: 675f 6178 6973 2028 0d0a 2020 2020 2020  g_axis (..      
-0002ef20: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-0002ef30: 6d62 6461 2078 3a20 7820 2a20 3138 302f  mbda x: x * 180/
-0002ef40: 6e70 2e70 692c 2030 2c20 696e 7075 745f  np.pi, 0, input_
-0002ef50: 6f62 6a29 0d0a 2020 2020 2020 2020 2020  obj)..          
-0002ef60: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0002ef70: 7265 7475 726e 2069 6e70 7574 5f6f 626a  return input_obj
-0002ef80: 200d 0a0d 0a20 2020 2020 2020 2073 656c   ....        sel
-0002ef90: 662e 5f73 4870 687a 3d20 5f69 6e73 7065  f._sHphz= _inspe
-0002efa0: 6374 5f69 6e70 7574 2873 656c 662e 5f73  ct_input(self._s
-0002efb0: 4870 687a 290d 0a0d 0a0d 0a20 2020 2020  Hphz)......     
-0002efc0: 2020 2069 6620 7365 6c66 2e74 6f5f 6465     if self.to_de
-0002efd0: 6772 6565 203a 2023 2d2d 2d3e 2073 6574  gree : #---> set
-0002efe0: 2061 6e67 6c65 2074 6f20 6465 6772 6565   angle to degree
-0002eff0: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
-0002f000: 7365 6c66 2e5f 7348 7068 7a20 3d5f 696e  self._sHphz =_in
-0002f010: 7370 6563 745f 696e 7075 7428 696e 7075  spect_input(inpu
-0002f020: 745f 6f62 6a20 3d73 656c 662e 5f73 4870  t_obj =self._sHp
-0002f030: 687a 2c20 746f 5f64 6567 7265 6520 3d54  hz, to_degree =T
-0002f040: 7275 6529 2020 2020 2020 2020 0d0a 2020  rue)        ..  
-0002f050: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0002f060: 2320 2d2d 3e20 6368 6563 6b20 7468 6520  # --> check the 
-0002f070: 6d61 7869 6d75 6d20 616e 676c 6520 7661  maximum angle va
-0002f080: 6c75 6520 616e 6420 6d69 6e69 6d75 6d20  lue and minimum 
-0002f090: 616e 676c 6520 7661 6c75 652e 0d0a 2020  angle value...  
-0002f0a0: 2020 2020 2020 7663 6f75 6e74 735f 7368        vcounts_sh
-0002f0b0: 7068 7a2c 2072 6570 6561 745f 6870 687a  phz, repeat_hphz
-0002f0c0: 3d6e 702e 756e 6971 7565 2028 7365 6c66  =np.unique (self
-0002f0d0: 2e5f 7348 7068 7a2c 2072 6574 7572 6e5f  ._sHphz, return_
-0002f0e0: 636f 756e 7473 3d54 7275 6529 0d0a 2020  counts=True)..  
-0002f0f0: 2020 2020 2020 7365 6c66 2e76 616c 7565        self.value
-0002f100: 203d 7663 6f75 6e74 735f 7368 7068 7a0d   =vcounts_shphz.
-0002f110: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-0002f120: 782c 2073 656c 662e 6d69 6e20 3d76 636f  x, self.min =vco
-0002f130: 756e 7473 5f73 6870 687a 2e6d 6178 2829  unts_shphz.max()
-0002f140: 2c20 7663 6f75 6e74 735f 7368 7068 7a2e  , vcounts_shphz.
-0002f150: 6d69 6e28 290d 0a20 2020 2020 2020 200d  min()..        .
-0002f160: 0a20 2020 2020 2020 2023 2d2d 2d3e 2074  .        #---> t
-0002f170: 756e 6361 7465 6420 4156 4720 7348 7068  uncated AVG sHph
-0002f180: 7a20 7661 6c75 6520 6f6e 2020 6469 6374  z value on  dict
-0002f190: 696f 6e6e 6172 7920 666f 7220 6561 7379  ionnary for easy
-0002f1a0: 2061 6363 6573 202e 200d 0a20 2020 2020   acces . ..     
-0002f1b0: 2020 2074 7275 6e63 6174 6564 5f73 6870     truncated_shp
-0002f1c0: 687a 3d5a 6363 2e74 7275 6e63 6174 6564  hz=Zcc.truncated
-0002f1d0: 5f64 6174 6128 2064 6174 6120 3d73 656c  _data( data =sel
-0002f1e0: 662e 5f73 4870 687a 2c20 0d0a 2020 2020  f._sHphz, ..    
-0002f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f210: 2020 206e 756d 6265 725f 6f66 5f72 6563     number_of_rec
-0002f220: 6375 7265 6e63 653d 7365 6c66 2e6e 6672  curence=self.nfr
-0002f230: 6571 290d 0a20 2020 2020 2020 206e 616d  eq)..        nam
-0002f240: 652c 2070 6f6c 796e 616d 6520 3d20 5a63  e, polyname = Zc
-0002f250: 632e 5f6e 756d 6265 7269 6e67 5f73 7461  c._numbering_sta
-0002f260: 7469 6f6e 280d 0a20 2020 2020 2020 2020  tion(..         
-0002f270: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
-0002f280: 7469 6f6e 3d73 656c 662e 6e75 6d62 6572  tion=self.number
-0002f290: 5f6f 665f 7374 6174 696f 6e73 2c20 0d0a  _of_stations, ..
-0002f2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f2b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0002f2c0: 756d 6265 725f 6f66 5f66 7265 7120 3d73  umber_of_freq =s
-0002f2d0: 656c 662e 6e66 7265 7129 0d0a 2020 2020  elf.nfreq)..    
-0002f2e0: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
-0002f2f0: 6c66 2e6c 6f63 203d 7b20 6b65 793a 7661  lf.loc ={ key:va
-0002f300: 6c75 6520 666f 7220 6b65 792c 2076 616c  lue for key, val
-0002f310: 7565 2069 6e20 7a69 7028 6e61 6d65 2c20  ue in zip(name, 
-0002f320: 7472 756e 6361 7465 645f 7368 7068 7a29  truncated_shphz)
-0002f330: 7d0d 0a20 2020 2020 2020 200d 0a20 2020  }..        ..   
-0002f340: 200d 0a63 6c61 7373 2070 6352 686f 2028   ..class pcRho (
-0002f350: 6f62 6a65 6374 293a 0d0a 2020 2020 2222  object):..    ""
-0002f360: 220d 0a20 2020 2053 7461 7469 7374 6963  "..    Statistic
-0002f370: 616c 2076 6172 6961 7469 6f6e 206f 6620  al variation of 
-0002f380: 6d61 676e 6974 7564 6520 7661 6c75 6573  magnitude values
-0002f390: 200d 0a20 2020 2066 726f 6d20 6176 6572   ..    from aver
-0002f3a0: 6167 6564 2064 6174 6120 626c 6f63 6b73  aged data blocks
-0002f3b0: 2e0d 0a20 2020 2053 7461 6e64 6172 6420  ...    Standard 
-0002f3c0: 4465 7669 6174 696f 6e20 2f20 4176 6572  Deviation / Aver
-0002f3d0: 6167 6520 5268 6f20 2870 6572 6365 6e74  age Rho (percent
-0002f3e0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0002f3f0: 2041 7267 756d 656e 7473 200d 0a20 2020   Arguments ..   
-0002f400: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0002f410: 2020 2020 202a 2a70 6352 6573 2a2a 203a       **pcRes** :
-0002f420: 206e 6461 7272 6179 0d0a 2020 2020 2020   ndarray..      
-0002f430: 2020 2020 2020 2020 2073 7461 7469 7374           statist
-0002f440: 6963 616c 2076 6172 6961 7469 6f6e 2061  ical variation a
-0002f450: 7665 7261 6765 6420 7268 6f2e 0d0a 0d0a  veraged rho.....
-0002f460: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
-0002f470: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-0002f480: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-0002f490: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002f4a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002f4b0: 3d0d 0a20 2020 2041 7474 7269 6275 7465  =..    Attribute
-0002f4c0: 7320 2020 2020 2020 2020 5479 7065 2020  s         Type  
-0002f4d0: 2020 2020 2020 4578 706c 616e 6174 696f        Explanatio
-0002f4e0: 6e0d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d  n..    =========
-0002f4f0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
-0002f500: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-0002f510: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002f520: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002f530: 3d3d 0d0a 2020 2020 7661 6c75 6520 2020  ==..    value   
-0002f540: 2020 2020 2020 2020 2020 6e64 6172 7261            ndarra
-0002f550: 7920 2020 2020 2020 6461 7461 206f 6620  y       data of 
-0002f560: 7063 5268 6f20 636f 6c75 6d6e 2020 6f6e  pcRho column  on
-0002f570: 2061 7667 6669 6c65 200d 0a20 2020 206d   avgfile ..    m
-0002f580: 6178 2020 2020 2020 2020 2020 2020 2020  ax              
-0002f590: 2066 6c6f 6174 2020 2020 2020 2020 206d   float         m
-0002f5a0: 6178 696d 756d 2025 2076 616c 7565 206f  aximum % value o
-0002f5b0: 6620 7063 5268 6f0d 0a20 2020 206d 696e  f pcRho..    min
-0002f5c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002f5d0: 6c6f 6174 2020 2020 2020 2020 206d 696e  loat         min
-0002f5e0: 696d 7520 2520 7661 6c75 6520 6f66 2070  imu % value of p
-0002f5f0: 6352 686f 200d 0a20 2020 206c 6f63 2020  cRho ..    loc  
-0002f600: 2020 2020 2020 2020 2020 2020 2064 6963               dic
-0002f610: 7420 2020 2020 2020 2020 206c 6f63 6174  t          locat
-0002f620: 696f 6e20 6f66 2025 5268 6f20 6d61 676e  ion of %Rho magn
-0002f630: 6974 7564 650d 0a20 2020 2020 2020 2020  itude..         
-0002f640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f650: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0002f660: 2061 7420 2074 6865 2073 7461 7469 6f6e   at  the station
-0002f670: 206c 616d 6264 6120 2e0d 0a20 2020 2020   lambda ...     
-0002f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f690: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002f6a0: 3a67 203a 206c 6f63 5b27 5330 3727 5d20  :g : loc['S07'] 
-0002f6b0: 7368 6f77 2020 7468 6520 6375 7272 656e  show  the curren
-0002f6c0: 7420 2048 2d6d 6167 200d 0a20 2020 2020  t  H-mag ..     
+0002ea50: 2020 2020 6e75 6d62 6572 5f6f 665f 7265      number_of_re
+0002ea60: 6363 7572 656e 6365 3d73 656c 662e 6e66  ccurence=self.nf
+0002ea70: 7265 7129 0d0a 2020 2020 2020 2020 6e61  req)..        na
+0002ea80: 6d65 2c20 706f 6c79 6e61 6d65 203d 205a  me, polyname = Z
+0002ea90: 6363 2e5f 6e75 6d62 6572 696e 675f 7374  cc._numbering_st
+0002eaa0: 6174 696f 6e28 0d0a 2020 2020 2020 2020  ation(..        
+0002eab0: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
+0002eac0: 6174 696f 6e3d 7365 6c66 2e6e 756d 6265  ation=self.numbe
+0002ead0: 725f 6f66 5f73 7461 7469 6f6e 732c 200d  r_of_stations, .
+0002eae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eb00: 6e75 6d62 6572 5f6f 665f 6672 6571 203d  number_of_freq =
+0002eb10: 7365 6c66 2e6e 6672 6571 290d 0a20 2020  self.nfreq)..   
+0002eb20: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+0002eb30: 656c 662e 6c6f 6320 3d7b 206b 6579 3a76  elf.loc ={ key:v
+0002eb40: 616c 7565 2066 6f72 206b 6579 2c20 7661  alue for key, va
+0002eb50: 6c75 6520 696e 207a 6970 286e 616d 652c  lue in zip(name,
+0002eb60: 2074 7275 6e63 6174 6564 5f73 6870 687a   truncated_shphz
+0002eb70: 297d 0d0a 2020 2020 2020 2020 0d0a 2020  )}..        ..  
+0002eb80: 2020 0d0a 636c 6173 7320 7063 5268 6f20    ..class pcRho 
+0002eb90: 286f 626a 6563 7429 3a0d 0a20 2020 2022  (object):..    "
+0002eba0: 2222 0d0a 2020 2020 5374 6174 6973 7469  ""..    Statisti
+0002ebb0: 6361 6c20 7661 7269 6174 696f 6e20 6f66  cal variation of
+0002ebc0: 206d 6167 6e69 7475 6465 2076 616c 7565   magnitude value
+0002ebd0: 7320 0d0a 2020 2020 6672 6f6d 2061 7665  s ..    from ave
+0002ebe0: 7261 6765 6420 6461 7461 2062 6c6f 636b  raged data block
+0002ebf0: 732e 0d0a 2020 2020 5374 616e 6461 7264  s...    Standard
+0002ec00: 2044 6576 6961 7469 6f6e 202f 2041 7665   Deviation / Ave
+0002ec10: 7261 6765 2052 686f 2028 7065 7263 656e  rage Rho (percen
+0002ec20: 7429 0d0a 2020 2020 2020 2020 0d0a 2020  t)..        ..  
+0002ec30: 2020 4172 6775 6d65 6e74 7320 0d0a 2020    Arguments ..  
+0002ec40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0002ec50: 2020 2020 2020 2a2a 7063 5265 732a 2a20        **pcRes** 
+0002ec60: 3a20 6e64 6172 7261 790d 0a20 2020 2020  : ndarray..     
+0002ec70: 2020 2020 2020 2020 2020 7374 6174 6973            statis
+0002ec80: 7469 6361 6c20 7661 7269 6174 696f 6e20  tical variation 
+0002ec90: 6176 6572 6167 6564 2072 686f 2e0d 0a0d  averaged rho....
+0002eca0: 0a0d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d  ...    =========
+0002ecb0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
+0002ecc0: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
+0002ecd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002ece0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002ecf0: 3d3d 0d0a 2020 2020 4174 7472 6962 7574  ==..    Attribut
+0002ed00: 6573 2020 2020 2020 2020 2054 7970 6520  es         Type 
+0002ed10: 2020 2020 2020 2045 7870 6c61 6e61 7469         Explanati
+0002ed20: 6f6e 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d  on..    ========
+0002ed30: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
+0002ed40: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+0002ed50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002ed60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002ed70: 3d3d 3d0d 0a20 2020 2076 616c 7565 2020  ===..    value  
+0002ed80: 2020 2020 2020 2020 2020 206e 6461 7272             ndarr
+0002ed90: 6179 2020 2020 2020 2064 6174 6120 6f66  ay       data of
+0002eda0: 2070 6352 686f 2063 6f6c 756d 6e20 206f   pcRho column  o
+0002edb0: 6e20 6176 6766 696c 6520 0d0a 2020 2020  n avgfile ..    
+0002edc0: 6d61 7820 2020 2020 2020 2020 2020 2020  max             
+0002edd0: 2020 666c 6f61 7420 2020 2020 2020 2020    float         
+0002ede0: 6d61 7869 6d75 6d20 2520 7661 6c75 6520  maximum % value 
+0002edf0: 6f66 2070 6352 686f 0d0a 2020 2020 6d69  of pcRho..    mi
+0002ee00: 6e20 2020 2020 2020 2020 2020 2020 2020  n               
+0002ee10: 666c 6f61 7420 2020 2020 2020 2020 6d69  float         mi
+0002ee20: 6e69 6d75 2025 2076 616c 7565 206f 6620  nimu % value of 
+0002ee30: 7063 5268 6f20 0d0a 2020 2020 6c6f 6320  pcRho ..    loc 
+0002ee40: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0002ee50: 6374 2020 2020 2020 2020 2020 6c6f 6361  ct          loca
+0002ee60: 7469 6f6e 206f 6620 2552 686f 206d 6167  tion of %Rho mag
+0002ee70: 6e69 7475 6465 0d0a 2020 2020 2020 2020  nitude..        
+0002ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ee90: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0002eea0: 6520 6174 2020 7468 6520 7374 6174 696f  e at  the statio
+0002eeb0: 6e20 6c61 6d62 6461 202e 0d0a 2020 2020  n lambda ...    
+0002eec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eee0: 653a 6720 3a20 6c6f 635b 2753 3037 275d  e:g : loc['S07']
+0002eef0: 2073 686f 7720 2074 6865 2063 7572 7265   show  the curre
+0002ef00: 6e74 2020 482d 6d61 6720 0d0a 2020 2020  nt  H-mag ..    
+0002ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef30: 6461 7461 206f 6620 7374 6174 696f 6e20  data of station 
+0002ef40: 6174 2053 3037 2e0d 0a20 2020 203d 3d3d  at S07...    ===
+0002ef50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =============  =
+0002ef60: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
+0002ef70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002ef80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0002ef90: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 0d0a  ========..    ..
+0002efa0: 2020 2020 204d 6f72 6520 6174 7472 6962       More attrib
+0002efb0: 7574 6573 2063 616e 2062 6520 6164 6465  utes can be adde
+0002efc0: 6420 6279 2069 6e70 7574 696e 6720 6120  d by inputing a 
+0002efd0: 6b65 7920 776f 7264 2064 6963 7469 6f6e  key word diction
+0002efe0: 6172 790d 0a20 2020 200d 0a20 2020 203a  ary..    ..    :
+0002eff0: 4578 616d 706c 653a 200d 0a20 2020 2020  Example: ..     
+0002f000: 2020 2020 0d0a 2020 2020 2020 2020 3e3e      ..        >>
+0002f010: 3e20 6672 6f6d 2070 7963 7361 6d74 2e63  > from pycsamt.c
+0002f020: 6f72 652e 6176 6720 696d 706f 7274 2041  ore.avg import A
+0002f030: 7667 0d0a 2020 2020 2020 2020 3e3e 3e20  vg..        >>> 
+0002f040: 7061 7468 3d6f 732e 7061 7468 2e6a 6f69  path=os.path.joi
+0002f050: 6e28 6f73 2e65 6e76 6972 6f6e 5b22 7079  n(os.environ["py
+0002f060: 4353 414d 5422 5d2c 200d 0a20 2020 2020  CSAMT"], ..     
+0002f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f080: 2020 2020 2027 7079 6373 616d 7427 2c20       'pycsamt', 
+0002f090: 2264 6174 6122 2c20 224b 312e 4156 4722  "data", "K1.AVG"
+0002f0a0: 290d 0a20 2020 2020 2020 203e 3e3e 2061  )..        >>> a
+0002f0b0: 7667 5f6f 626a 3d41 7667 2870 6174 6829  vg_obj=Avg(path)
+0002f0c0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7063  ..        >>> pc
+0002f0d0: 7268 6f5f 6f62 6a20 3d61 7667 5f6f 626a  rho_obj =avg_obj
+0002f0e0: 2e44 6174 615f 7365 6374 696f 6e2e 7063  .Data_section.pc
+0002f0f0: 5268 6f2e 6c6f 635b 2753 3030 275d 0d0a  Rho.loc['S00']..
+0002f100: 2020 2020 2020 2020 2e2e 2e20 7072 696e          ... prin
+0002f110: 7428 7063 7268 6f2e 6c6f 635b 2753 3030  t(pcrho.loc['S00
+0002f120: 275d 290d 0a20 2020 2020 2020 200d 0a20  '])..        .. 
+0002f130: 2020 2022 2222 0d0a 2020 2020 0d0a 2020     """..    ..  
+0002f140: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+0002f150: 656c 662c 2070 6352 6573 5f61 7272 6179  elf, pcRes_array
+0002f160: 203d 4e6f 6e65 202c 0d0a 2020 2020 2020   =None ,..      
+0002f170: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+0002f180: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
+0002f190: 3d4e 6f6e 6520 2c20 0d0a 2020 2020 2020  =None , ..      
+0002f1a0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+0002f1b0: 725f 6f66 5f73 7461 7469 6f6e 733d 4e6f  r_of_stations=No
+0002f1c0: 6e65 202c 202a 2a6b 7761 7267 7329 3a0d  ne , **kwargs):.
+0002f1d0: 0a0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+0002f1e0: 2020 2020 2073 656c 662e 5f70 6352 6573       self._pcRes
+0002f1f0: 3d70 6352 6573 5f61 7272 6179 0d0a 2020  =pcRes_array..  
+0002f200: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0002f210: 7365 6c66 2e6e 756d 6265 725f 6f66 5f73  self.number_of_s
+0002f220: 7461 7469 6f6e 7320 3d6b 7761 7267 732e  tations =kwargs.
+0002f230: 706f 7028 226e 756d 6265 725f 6f66 5f73  pop("number_of_s
+0002f240: 7461 7469 6f6e 7322 2c20 4e6f 6e65 290d  tations", None).
+0002f250: 0a20 2020 2020 2020 2073 656c 662e 6e66  .        self.nf
+0002f260: 7265 7120 3d6b 7761 7267 732e 706f 7028  req =kwargs.pop(
+0002f270: 276e 756d 6265 725f 6f66 5f66 7265 7175  'number_of_frequ
+0002f280: 656e 6369 6573 272c 204e 6f6e 6529 0d0a  encies', None)..
+0002f290: 2020 2020 2020 2020 7365 6c66 2e53 7265          self.Sre
+0002f2a0: 7320 3d6b 7761 7267 732e 706f 7028 2761  s =kwargs.pop('a
+0002f2b0: 6464 6564 5f61 7374 6174 6963 5f72 686f  dded_astatic_rho
+0002f2c0: 5f61 7272 6179 272c 204e 6f6e 6529 0d0a  _array', None)..
+0002f2d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0002f2e0: 2020 7365 6c66 2e76 616c 7565 203d 4e6f    self.value =No
+0002f2f0: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
+0002f300: 662e 6d69 6e20 3d20 4e6f 6e65 200d 0a20  f.min = None .. 
+0002f310: 2020 2020 2020 2073 656c 662e 6d61 7820         self.max 
+0002f320: 3d20 4e6f 6e65 200d 0a20 2020 200d 0a20  = None ..    .. 
+0002f330: 2020 2020 2020 2066 6f72 206b 6579 2069         for key i
+0002f340: 6e20 6c69 7374 286b 7761 7267 732e 6b65  n list(kwargs.ke
+0002f350: 7973 2829 293a 0d0a 2020 2020 2020 2020  ys()):..        
+0002f360: 2020 2020 7365 7461 7474 7228 7365 6c66      setattr(self
+0002f370: 2c20 6b65 792c 206b 7761 7267 735b 6b65  , key, kwargs[ke
+0002f380: 795d 290d 0a20 2020 2020 2020 2020 2020  y])..           
+0002f390: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
+0002f3a0: 6c66 2e5f 7063 5265 7320 6973 206e 6f74  lf._pcRes is not
+0002f3b0: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
+0002f3c0: 2020 2020 2020 7365 6c66 2e5f 7265 6164        self._read
+0002f3d0: 5f70 6352 6573 5f64 6174 6120 2829 0d0a  _pcRes_data ()..
+0002f3e0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0002f3f0: 2020 0d0a 2020 2020 6465 6620 5f72 6561    ..    def _rea
+0002f400: 645f 7063 5265 735f 6461 7461 2028 7365  d_pcRes_data (se
+0002f410: 6c66 2c20 7063 5265 735f 6172 7261 7920  lf, pcRes_array 
+0002f420: 3d4e 6f6e 652c 206e 756d 6265 725f 6f66  =None, number_of
+0002f430: 5f66 7265 7175 656e 6369 6573 3d4e 6f6e  _frequencies=Non
+0002f440: 6520 2c20 0d0a 2020 2020 2020 2020 2020  e , ..          
+0002f450: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0002f460: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+0002f470: 733d 4e6f 6e65 2c20 5372 6573 3d4e 6f6e  s=None, Sres=Non
+0002f480: 652c 2020 2a2a 6b77 6172 6773 2020 293a  e,  **kwargs  ):
+0002f490: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0002f4a0: 2020 2020 2020 204d 6574 686f 6420 746f         Method to
+0002f4b0: 2072 6561 6420 7265 7369 7469 7669 7479   read resitivity
+0002f4c0: 2020 6163 636f 7264 696e 6720 6561 6368    according each
+0002f4d0: 2073 7461 7469 6f6e 202f 7374 616e 6461   station /standa
+0002f4e0: 7264 2064 6576 6961 7469 6f6e 202a 3130  rd deviation *10
+0002f4f0: 300d 0a20 2020 2020 2020 2066 6f72 2072  0..        for r
+0002f500: 6573 6973 7469 7669 7479 2020 7661 6c75  esistivity  valu
+0002f510: 6573 202e 0d0a 2020 2020 2020 2020 0d0a  es ...        ..
+0002f520: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0002f530: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0002f540: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0002f550: 2020 2020 2a20 7063 5265 735f 6172 7261      * pcRes_arra
+0002f560: 793a 206e 6461 7272 6179 2c20 656e 206f  y: ndarray, en o
+0002f570: 686d 2e6d 0d0a 2020 2020 2020 2020 2020  hm.m..          
+0002f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f590: 2020 5265 7369 7374 6976 6974 7920 6361    Resistivity ca
+0002f5a0: 6c63 756c 6174 6564 2020 6f6e 2074 6865  lculated  on the
+0002f5b0: 2066 6965 6c64 2e0d 0a20 2020 2020 2020   field...       
+0002f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f5d0: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
+0002f5e0: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2020   is None...     
+0002f5f0: 2020 2020 2020 202a 206e 756d 6265 725f         * number_
+0002f600: 6f66 5f66 7265 7175 656e 6369 6573 203a  of_frequencies :
+0002f610: 2069 6e74 202c 206f 7074 696f 6e61 6c0d   int , optional.
+0002f620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f630: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0002f640: 6265 7220 6f66 2066 7265 7175 656e 6369  ber of frequenci
+0002f650: 6573 2066 6f72 2073 7572 7665 792e 200d  es for survey. .
+0002f660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f670: 2020 2020 2020 2020 2020 2020 2054 6865               The
+0002f680: 2064 6566 6175 6c74 2069 7320 4e6f 6e65   default is None
+0002f690: 2e0d 0a20 2020 2020 2020 2020 2020 202a  ...            *
+0002f6a0: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
+0002f6b0: 6f6e 7320 3a20 696e 7420 2c20 6f70 7469  ons : int , opti
+0002f6c0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
 0002f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0002f6f0: 6174 6120 6f66 2073 7461 7469 6f6e 2061  ata of station a
-0002f700: 7420 5330 372e 0d0a 2020 2020 3d3d 3d3d  t S07...    ====
-0002f710: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
-0002f720: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-0002f730: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002f740: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0002f750: 3d3d 3d3d 3d3d 3d0d 0a20 2020 200d 0a20  =======..    .. 
-0002f760: 2020 2020 4d6f 7265 2061 7474 7269 6275      More attribu
-0002f770: 7465 7320 6361 6e20 6265 2061 6464 6564  tes can be added
-0002f780: 2062 7920 696e 7075 7469 6e67 2061 206b   by inputing a k
-0002f790: 6579 2077 6f72 6420 6469 6374 696f 6e61  ey word dictiona
-0002f7a0: 7279 0d0a 2020 2020 0d0a 2020 2020 3a45  ry..    ..    :E
-0002f7b0: 7861 6d70 6c65 3a20 0d0a 2020 2020 2020  xample: ..      
-0002f7c0: 2020 200d 0a20 2020 2020 2020 203e 3e3e     ..        >>>
-0002f7d0: 2066 726f 6d20 7079 6373 616d 742e 6666   from pycsamt.ff
-0002f7e0: 2e63 6f72 652e 6176 6720 696d 706f 7274  .core.avg import
-0002f7f0: 2041 7667 0d0a 2020 2020 2020 2020 3e3e   Avg..        >>
-0002f800: 3e20 7061 7468 3d6f 732e 7061 7468 2e6a  > path=os.path.j
-0002f810: 6f69 6e28 6f73 2e65 6e76 6972 6f6e 5b22  oin(os.environ["
-0002f820: 7079 4353 414d 5422 5d2c 200d 0a20 2020  pyCSAMT"], ..   
-0002f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f840: 2020 2020 2020 2027 7079 6373 616d 7427         'pycsamt'
-0002f850: 2c20 2264 6174 6122 2c20 224b 312e 4156  , "data", "K1.AV
-0002f860: 4722 290d 0a20 2020 2020 2020 203e 3e3e  G")..        >>>
-0002f870: 2061 7667 5f6f 626a 3d41 7667 2870 6174   avg_obj=Avg(pat
-0002f880: 6829 0d0a 2020 2020 2020 2020 3e3e 3e20  h)..        >>> 
-0002f890: 7063 7268 6f5f 6f62 6a20 3d61 7667 5f6f  pcrho_obj =avg_o
-0002f8a0: 626a 2e44 6174 615f 7365 6374 696f 6e2e  bj.Data_section.
-0002f8b0: 7063 5268 6f2e 6c6f 635b 2753 3030 275d  pcRho.loc['S00']
-0002f8c0: 0d0a 2020 2020 2020 2020 2e2e 2e20 7072  ..        ... pr
-0002f8d0: 696e 7428 7063 7268 6f2e 6c6f 635b 2753  int(pcrho.loc['S
-0002f8e0: 3030 275d 290d 0a20 2020 2020 2020 200d  00'])..        .
-0002f8f0: 0a20 2020 2022 2222 0d0a 2020 2020 0d0a  .    """..    ..
-0002f900: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0002f910: 2873 656c 662c 2070 6352 6573 5f61 7272  (self, pcRes_arr
-0002f920: 6179 203d 4e6f 6e65 202c 0d0a 2020 2020  ay =None ,..    
-0002f930: 2020 2020 2020 2020 2020 2020 206e 756d               num
-0002f940: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-0002f950: 6573 3d4e 6f6e 6520 2c20 0d0a 2020 2020  es=None , ..    
-0002f960: 2020 2020 2020 2020 2020 2020 206e 756d               num
-0002f970: 6265 725f 6f66 5f73 7461 7469 6f6e 733d  ber_of_stations=
-0002f980: 4e6f 6e65 202c 202a 2a6b 7761 7267 7329  None , **kwargs)
-0002f990: 3a0d 0a0d 0a20 2020 2020 2020 200d 0a20  :....        .. 
-0002f9a0: 2020 2020 2020 2073 656c 662e 5f70 6352         self._pcR
-0002f9b0: 6573 3d70 6352 6573 5f61 7272 6179 0d0a  es=pcRes_array..
-0002f9c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0002f9d0: 2020 7365 6c66 2e6e 756d 6265 725f 6f66    self.number_of
-0002f9e0: 5f73 7461 7469 6f6e 7320 3d6b 7761 7267  _stations =kwarg
-0002f9f0: 732e 706f 7028 226e 756d 6265 725f 6f66  s.pop("number_of
-0002fa00: 5f73 7461 7469 6f6e 7322 2c20 4e6f 6e65  _stations", None
-0002fa10: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0002fa20: 6e66 7265 7120 3d6b 7761 7267 732e 706f  nfreq =kwargs.po
-0002fa30: 7028 276e 756d 6265 725f 6f66 5f66 7265  p('number_of_fre
-0002fa40: 7175 656e 6369 6573 272c 204e 6f6e 6529  quencies', None)
-0002fa50: 0d0a 2020 2020 2020 2020 7365 6c66 2e53  ..        self.S
-0002fa60: 7265 7320 3d6b 7761 7267 732e 706f 7028  res =kwargs.pop(
-0002fa70: 2761 6464 6564 5f61 7374 6174 6963 5f72  'added_astatic_r
-0002fa80: 686f 5f61 7272 6179 272c 204e 6f6e 6529  ho_array', None)
-0002fa90: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0002faa0: 2020 2020 7365 6c66 2e76 616c 7565 203d      self.value =
-0002fab0: 4e6f 6e65 200d 0a20 2020 2020 2020 2073  None ..        s
-0002fac0: 656c 662e 6d69 6e20 3d20 4e6f 6e65 200d  elf.min = None .
-0002fad0: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-0002fae0: 7820 3d20 4e6f 6e65 200d 0a20 2020 200d  x = None ..    .
-0002faf0: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
-0002fb00: 2069 6e20 6c69 7374 286b 7761 7267 732e   in list(kwargs.
-0002fb10: 6b65 7973 2829 293a 0d0a 2020 2020 2020  keys()):..      
-0002fb20: 2020 2020 2020 7365 7461 7474 7228 7365        setattr(se
-0002fb30: 6c66 2c20 6b65 792c 206b 7761 7267 735b  lf, key, kwargs[
-0002fb40: 6b65 795d 290d 0a20 2020 2020 2020 2020  key])..         
-0002fb50: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-0002fb60: 7365 6c66 2e5f 7063 5265 7320 6973 206e  self._pcRes is n
-0002fb70: 6f74 204e 6f6e 6520 3a20 0d0a 2020 2020  ot None : ..    
-0002fb80: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
-0002fb90: 6164 5f70 6352 6573 5f64 6174 6120 2829  ad_pcRes_data ()
-0002fba0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0002fbb0: 2020 2020 0d0a 2020 2020 6465 6620 5f72      ..    def _r
-0002fbc0: 6561 645f 7063 5265 735f 6461 7461 2028  ead_pcRes_data (
-0002fbd0: 7365 6c66 2c20 7063 5265 735f 6172 7261  self, pcRes_arra
-0002fbe0: 7920 3d4e 6f6e 652c 206e 756d 6265 725f  y =None, number_
-0002fbf0: 6f66 5f66 7265 7175 656e 6369 6573 3d4e  of_frequencies=N
-0002fc00: 6f6e 6520 2c20 0d0a 2020 2020 2020 2020  one , ..        
-0002fc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fc20: 206e 756d 6265 725f 6f66 5f73 7461 7469   number_of_stati
-0002fc30: 6f6e 733d 4e6f 6e65 2c20 5372 6573 3d4e  ons=None, Sres=N
-0002fc40: 6f6e 652c 2020 2a2a 6b77 6172 6773 2020  one,  **kwargs  
-0002fc50: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
-0002fc60: 0a20 2020 2020 2020 204d 6574 686f 6420  .        Method 
-0002fc70: 746f 2072 6561 6420 7265 7369 7469 7669  to read resitivi
-0002fc80: 7479 2020 6163 636f 7264 696e 6720 6561  ty  according ea
-0002fc90: 6368 2073 7461 7469 6f6e 202f 7374 616e  ch station /stan
-0002fca0: 6461 7264 2064 6576 6961 7469 6f6e 202a  dard deviation *
-0002fcb0: 3130 300d 0a20 2020 2020 2020 2066 6f72  100..        for
-0002fcc0: 2072 6573 6973 7469 7669 7479 2020 7661   resistivity  va
-0002fcd0: 6c75 6573 202e 0d0a 2020 2020 2020 2020  lues ...        
-0002fce0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0002fcf0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0002fd00: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0002fd10: 2020 2020 2020 2a20 7063 5265 735f 6172        * pcRes_ar
-0002fd20: 7261 793a 206e 6461 7272 6179 2c20 656e  ray: ndarray, en
-0002fd30: 206f 686d 2e6d 0d0a 2020 2020 2020 2020   ohm.m..        
-0002fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd50: 2020 2020 5265 7369 7374 6976 6974 7920      Resistivity 
-0002fd60: 6361 6c63 756c 6174 6564 2020 6f6e 2074  calculated  on t
-0002fd70: 6865 2066 6965 6c64 2e0d 0a20 2020 2020  he field...     
-0002fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd90: 2020 2020 2020 2054 6865 2064 6566 6175         The defau
-0002fda0: 6c74 2069 7320 4e6f 6e65 2e0d 0a20 2020  lt is None...   
-0002fdb0: 2020 2020 2020 2020 202a 206e 756d 6265           * numbe
-0002fdc0: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
-0002fdd0: 203a 2069 6e74 202c 206f 7074 696f 6e61   : int , optiona
-0002fde0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-0002fdf0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0002fe00: 756d 6265 7220 6f66 2066 7265 7175 656e  umber of frequen
-0002fe10: 6369 6573 2066 6f72 2073 7572 7665 792e  cies for survey.
-0002fe20: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0002fe30: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-0002fe40: 6865 2064 6566 6175 6c74 2069 7320 4e6f  he default is No
-0002fe50: 6e65 2e0d 0a20 2020 2020 2020 2020 2020  ne...           
-0002fe60: 202a 206e 756d 6265 725f 6f66 5f73 7461   * number_of_sta
-0002fe70: 7469 6f6e 7320 3a20 696e 7420 2c20 6f70  tions : int , op
-0002fe80: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0002fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fea0: 2020 2020 6e75 6d62 6572 5f6f 6620 7374      number_of st
-0002feb0: 6174 696f 6e73 2e20 0d0a 2020 2020 2020  ations. ..      
-0002fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fed0: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
-0002fee0: 7420 6973 204e 6f6e 652e 0d0a 2020 2020  t is None...    
-0002fef0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-0002ff00: 200d 0a20 2020 2020 2020 2069 6620 7063   ..        if pc
-0002ff10: 5265 735f 6172 7261 7920 2069 7320 6e6f  Res_array  is no
-0002ff20: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-0002ff30: 2020 2020 2020 2073 656c 662e 5f70 6352         self._pcR
-0002ff40: 6573 3d20 7063 5265 735f 6172 7261 7920  es= pcRes_array 
-0002ff50: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0002ff60: 662e 5f70 6352 6573 2069 7320 4e6f 6e65  f._pcRes is None
-0002ff70: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-0002ff80: 2072 6169 7365 2043 5365 782e 7079 4353   raise CSex.pyCS
-0002ff90: 414d 5445 7272 6f72 5f69 6e70 7574 6172  AMTError_inputar
-0002ffa0: 6775 6d65 6e74 7328 274e 6f20 5265 7369  guments('No Resi
-0002ffb0: 7374 6976 6974 7920 6461 7461 2066 6f75  stivity data fou
-0002ffc0: 6e64 2021 2729 0d0a 0d0a 2020 2020 2020  nd !')....      
-0002ffd0: 2020 6966 206e 756d 6265 725f 6f66 5f66    if number_of_f
-0002ffe0: 7265 7175 656e 6369 6573 2069 7320 6e6f  requencies is no
-0002fff0: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-00030000: 2020 2020 2020 2073 656c 662e 6e66 7265         self.nfre
-00030010: 7120 3d6e 756d 6265 725f 6f66 5f66 7265  q =number_of_fre
-00030020: 7175 656e 6369 6573 200d 0a20 2020 2020  quencies ..     
-00030030: 2020 2065 6c73 6520 3a0d 0a20 2020 2020     else :..     
-00030040: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-00030050: 782e 7079 4353 414d 5445 7272 6f72 5f69  x.pyCSAMTError_i
-00030060: 6e70 7574 6172 6775 6d65 6e74 7328 0d0a  nputarguments(..
-00030070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030080: 2250 6c65 6173 6520 7370 6563 6966 7920  "Please specify 
-00030090: 7468 6520 6e75 6d62 6572 206f 6620 6672  the number of fr
-000300a0: 6571 7565 6e63 7920 2122 290d 0a20 2020  equency !")..   
-000300b0: 2020 2020 2069 6620 6e75 6d62 6572 5f6f       if number_o
-000300c0: 665f 7374 6174 696f 6e73 2069 7320 6e6f  f_stations is no
-000300d0: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
-000300e0: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
-000300f0: 725f 6f66 5f73 7461 7469 6f6e 7320 3d6e  r_of_stations =n
-00030100: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
-00030110: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
-00030120: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00030130: 2072 6169 7365 2043 5365 782e 7079 4353   raise CSex.pyCS
-00030140: 414d 5445 7272 6f72 5f69 6e70 7574 6172  AMTError_inputar
-00030150: 6775 6d65 6e74 7328 0d0a 2020 2020 2020  guments(..      
-00030160: 2020 2020 2020 2020 2020 2750 6c65 6173            'Pleas
-00030170: 6520 7370 6563 6966 7920 7468 6520 6e75  e specify the nu
-00030180: 6d62 6572 206f 6620 7374 6174 696f 6e73  mber of stations
-00030190: 2729 0d0a 2020 2020 2020 0d0a 2020 2020  ')..      ..    
-000301a0: 2020 2020 7472 7920 3a20 0d0a 2020 2020      try : ..    
-000301b0: 2020 2020 2020 2020 7365 6c66 2e6e 6672          self.nfr
-000301c0: 6571 202c 2073 656c 662e 6e75 6d62 6572  eq , self.number
-000301d0: 5f6f 665f 7374 6174 696f 6e73 203d 6e70  _of_stations =np
-000301e0: 2e69 6e74 2873 656c 662e 6e66 7265 7129  .int(self.nfreq)
-000301f0: 2c5c 0d0a 2020 2020 2020 2020 2020 2020  ,\..            
-00030200: 2020 2020 6e70 2e69 6e74 2873 656c 662e      np.int(self.
-00030210: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-00030220: 6e73 290d 0a20 2020 2020 2020 2020 2020  ns)..           
-00030230: 2073 656c 662e 5f70 6352 6573 203d 6e70   self._pcRes =np
-00030240: 2e61 7272 6179 285b 6e70 2e66 6c6f 6174  .array([np.float
-00030250: 2863 6329 2066 6f72 2063 6320 696e 2073  (cc) for cc in s
-00030260: 656c 662e 5f70 6352 6573 5d29 0d0a 0d0a  elf._pcRes])....
-00030270: 2020 2020 2020 2020 6578 6365 7074 203a          except :
-00030280: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00030290: 6973 6520 4353 6578 2e70 7943 5341 4d54  ise CSex.pyCSAMT
-000302a0: 4572 726f 725f 7661 6c75 6528 0d0a 2020  Error_value(..  
-000302b0: 2020 2020 2020 2020 2020 2020 2020 2256                "V
-000302c0: 616c 7565 7320 7072 6f76 6964 6564 2066  alues provided f
-000302d0: 6f72 2074 6865 2052 6573 6973 7469 7669  or the Resistivi
-000302e0: 7469 6573 2061 7265 2077 726f 6e67 2e22  ties are wrong."
-000302f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030300: 2020 2022 206d 7573 7420 6265 2066 6c6f     " must be flo
-00030310: 6174 206f 7220 696e 7465 6765 7220 2e22  at or integer ."
-00030320: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-00030330: 2020 2020 2076 636f 756e 7473 5f70 6372       vcounts_pcr
-00030340: 6573 2c20 7265 7065 6174 5f68 7068 7a3d  es, repeat_hphz=
-00030350: 6e70 2e75 6e69 7175 6520 2873 656c 662e  np.unique (self.
-00030360: 5f70 6352 6573 2c20 7265 7475 726e 5f63  _pcRes, return_c
-00030370: 6f75 6e74 733d 5472 7565 290d 0a20 2020  ounts=True)..   
-00030380: 2020 2020 2069 6620 6e6f 7420 6e70 2e61       if not np.a
-00030390: 6c6c 2872 6570 6561 745f 6870 687a 293a  ll(repeat_hphz):
-000303a0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-000303b0: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-000303c0: 5445 7272 6f72 5f76 616c 7565 280d 0a20  TError_value(.. 
-000303d0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000303e0: 5661 6c75 6573 206f 6620 5268 6f20 7072  Values of Rho pr
-000303f0: 6f76 6964 6564 206d 7573 7420 6861 7665  ovided must have
-00030400: 2074 6865 2073 616d 6520 6c65 6e67 7468   the same length
-00030410: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00030420: 2020 2020 2720 666f 7220 6561 6368 2073      ' for each s
-00030430: 7461 7469 6f6e 732e 2027 290d 0a20 2020  tations. ')..   
-00030440: 2020 2020 2073 656c 662e 7661 6c75 6520       self.value 
-00030450: 3d76 636f 756e 7473 5f70 6372 6573 0d0a  =vcounts_pcres..
-00030460: 2020 2020 2020 2020 7365 6c66 2e6d 6178          self.max
-00030470: 2c20 7365 6c66 2e6d 696e 203d 7663 6f75  , self.min =vcou
-00030480: 6e74 735f 7063 7265 732e 6d61 7828 292c  nts_pcres.max(),
-00030490: 2076 636f 756e 7473 5f70 6372 6573 2e6d   vcounts_pcres.m
-000304a0: 696e 2829 0d0a 2020 2020 2020 2020 7365  in()..        se
-000304b0: 6c66 2e6d 6561 6e3d 7365 6c66 2e5f 7063  lf.mean=self._pc
-000304c0: 5265 732e 6d65 616e 2829 0d0a 2020 2020  Res.mean()..    
-000304d0: 2020 2020 7472 756e 6361 7465 645f 7063      truncated_pc
-000304e0: 7265 733d 5a63 632e 7472 756e 6361 7465  res=Zcc.truncate
-000304f0: 645f 6461 7461 2820 6461 7461 203d 7365  d_data( data =se
-00030500: 6c66 2e5f 7063 5265 732c 200d 0a20 2020  lf._pcRes, ..   
-00030510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030530: 2020 2020 6e75 6d62 6572 5f6f 665f 7265      number_of_re
-00030540: 6363 7572 656e 6365 3d73 656c 662e 6e66  ccurence=self.nf
-00030550: 7265 7129 0d0a 2020 2020 2020 2020 6e61  req)..        na
-00030560: 6d65 2c20 706f 6c79 6e61 6d65 203d 205a  me, polyname = Z
-00030570: 6363 2e5f 6e75 6d62 6572 696e 675f 7374  cc._numbering_st
-00030580: 6174 696f 6e28 0d0a 2020 2020 2020 2020  ation(..        
-00030590: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
-000305a0: 6174 696f 6e3d 7365 6c66 2e6e 756d 6265  ation=self.numbe
-000305b0: 725f 6f66 5f73 7461 7469 6f6e 732c 200d  r_of_stations, .
-000305c0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-000305d0: 6265 725f 6f66 5f66 7265 7120 3d73 656c  ber_of_freq =sel
-000305e0: 662e 6e66 7265 7129 0d0a 2020 2020 2020  f.nfreq)..      
-000305f0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00030600: 2e6c 6f63 203d 7b20 6b65 793a 7661 6c75  .loc ={ key:valu
-00030610: 6520 666f 7220 6b65 792c 2076 616c 7565  e for key, value
-00030620: 2069 6e20 7a69 7028 6e61 6d65 2c20 7472   in zip(name, tr
-00030630: 756e 6361 7465 645f 7063 7265 7320 297d  uncated_pcres )}
-00030640: 0d0a 2020 2020 2020 2020 0d0a 0d0a 636c  ..        ....cl
-00030650: 6173 7320 7350 687a 286f 626a 6563 7429  ass sPhz(object)
-00030660: 203a 200d 0a20 2020 2022 2222 0d0a 2020   : ..    """..  
-00030670: 2020 5374 6174 6973 7469 6361 6c20 7661    Statistical va
-00030680: 7269 6174 696f 6e20 6f66 2074 6865 2064  riation of the d
-00030690: 6174 6120 626c 6f63 6b73 2061 7665 7261  ata blocks avera
-000306a0: 6765 6420 666f 7220 7468 6973 2064 6174  ged for this dat
-000306b0: 6120 706f 696e 742e 0d0a 2020 2020 2020  a point...      
-000306c0: 2020 3130 3020 2a20 5374 616e 6461 7264    100 * Standard
-000306d0: 2044 6576 6961 7469 6f6e 206f 6620 5068   Deviation of Ph
-000306e0: 6173 6520 7661 6c75 6573 2028 6d69 6c6c  ase values (mill
-000306f0: 6972 6164 6961 6e73 290d 0a20 2020 2020  iradians)..     
-00030700: 2020 200d 0a20 2020 2041 7267 756d 656e     ..    Argumen
-00030710: 7473 200d 0a20 2020 202d 2d2d 2d2d 2d2d  ts ..    -------
-00030720: 2d2d 2d0d 0a20 2020 2020 2020 202a 2a73  ---..        **s
-00030730: 7068 7a20 6172 7261 792a 2a20 3a20 6172  phz array** : ar
-00030740: 7261 795f 6c69 6b65 200d 0a20 2020 2020  ray_like ..     
-00030750: 2020 2020 2020 2020 2020 2063 6f65 6666             coeff
-00030760: 6963 6965 6e74 206f 6620 2070 6861 7365  icient of  phase
-00030770: 2076 6172 6961 7469 6f6e 2061 7272 7179   variation arrqy
-00030780: 200d 0a20 2020 2020 2020 202a 2a70 6174   ..        **pat
-00030790: 6820 746f 2061 7667 2a2a 3a73 7472 0d0a  h to avg**:str..
-000307a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000307b0: 6675 6c6c 2070 6174 6820 746f 2066 696c  full path to fil
-000307c0: 656e 616d 6520 0d0a 2020 2020 2020 2020  ename ..        
-000307d0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000307e0: 486f 6c64 7320 7468 6520 666f 6c6c 6f77  Holds the follow
-000307f0: 696e 6720 696e 666f 726d 6174 696f 6e73  ing informations
-00030800: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
-00030810: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-00030820: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =  ==========  =
-00030830: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00030840: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00030850: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
-00030860: 2020 4174 7472 6962 7574 6573 2020 2020    Attributes    
-00030870: 2020 2020 2054 7970 6520 2020 2020 2020       Type       
-00030880: 2045 7870 6c61 6e61 7469 6f6e 0d0a 2020   Explanation..  
-00030890: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-000308a0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==  ==========  
-000308b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000308c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000308d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
-000308e0: 2020 2076 616c 7565 2020 2020 2020 2020     value        
-000308f0: 2020 2020 206e 642e 6172 7261 7920 2020       nd.array   
-00030900: 2020 2064 6174 6120 6f66 2073 5068 7a20     data of sPhz 
-00030910: 2063 6f6c 756d 6e20 6f6e 2061 7667 6669   column on avgfi
-00030920: 6c65 2020 200d 0a20 2020 206d 6178 2020  le   ..    max  
-00030930: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
-00030940: 6174 2020 2020 2020 2020 206d 6178 696d  at         maxim
-00030950: 756d 2025 2076 616c 7565 206f 6620 7348  um % value of sH
-00030960: 7068 7a0d 0a20 2020 206d 696e 2020 2020  phz..    min    
-00030970: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
-00030980: 2020 2020 2020 2020 206d 696e 696d 7520           minimu 
-00030990: 2076 616c 7565 206f 6620 7348 7068 7a0d   value of sHphz.
-000309a0: 0a20 2020 206c 6f63 2020 2020 2020 2020  .    loc        
-000309b0: 2020 2020 2020 2064 6963 7420 2020 2020         dict     
-000309c0: 2020 2020 206c 6f63 6174 696f 6e20 6f66       location of
-000309d0: 2073 5068 7a20 6d61 676e 6974 7564 6520   sPhz magnitude 
-000309e0: 7661 6c75 6520 6174 200d 0a20 2020 2020  value at ..     
-000309f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a00: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00030a10: 6865 2073 7461 7469 6f6e 206c 616d 6264  he station lambd
-00030a20: 6120 2e0d 0a20 2020 2020 2020 2020 2020  a ...           
-00030a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a40: 2020 2020 2020 2020 2065 3a67 202d 206c           e:g - l
-00030a50: 6f63 5b27 5330 3727 5d20 7368 6f77 2074  oc['S07'] show t
-00030a60: 6865 2063 7572 7265 6e74 2020 7350 687a  he current  sPhz
-00030a70: 2064 6174 6120 0d0a 2020 2020 2020 2020   data ..        
-00030a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a90: 2020 2020 2020 2020 2020 2020 6f66 2073              of s
-00030aa0: 7461 7469 6f6e 2061 7420 5330 372e 0d0a  tation at S07...
-00030ab0: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
-00030ac0: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
-00030ad0: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-00030ae0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00030af0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-00030b00: 0a20 2020 200d 0a20 2020 204d 6f72 6520  .    ..    More 
-00030b10: 6174 7472 6962 7574 6573 2063 616e 2062  attributes can b
-00030b20: 6520 6164 6465 6420 6279 2069 6e70 7574  e added by input
-00030b30: 696e 6720 6120 6b65 7920 776f 7264 2064  ing a key word d
-00030b40: 6963 7469 6f6e 6172 790d 0a20 2020 200d  ictionary..    .
-00030b50: 0a20 2020 203a 4578 616d 706c 653a 0d0a  .    :Example:..
-00030b60: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-00030b70: 6f6d 2070 7963 7361 6d74 2e66 662e 636f  om pycsamt.ff.co
-00030b80: 7265 2e61 7667 2069 6d70 6f72 2041 7667  re.avg impor Avg
-00030b90: 0d0a 2020 2020 2020 2020 3e3e 3e20 7061  ..        >>> pa
-00030ba0: 7468 3d6f 732e 7061 7468 2e6a 6f69 6e28  th=os.path.join(
-00030bb0: 6f73 2e65 6e76 6972 6f6e 5b22 7079 4353  os.environ["pyCS
-00030bc0: 414d 5422 5d2c 200d 0a20 2020 2020 2020  AMT"], ..       
-00030bd0: 202e 2e2e 2020 2020 2027 7079 6373 616d   ...     'pycsam
-00030be0: 7427 2c20 2264 6174 6122 2c20 224b 312e  t', "data", "K1.
-00030bf0: 4156 4722 290d 0a20 2020 2020 2020 203e  AVG")..        >
-00030c00: 3e3e 2061 7667 5f6f 626a 3d41 7667 2870  >> avg_obj=Avg(p
-00030c10: 6174 6829 0d0a 2020 2020 2020 2020 3e3e  ath)..        >>
-00030c20: 3e20 7368 7068 7a5f 6f62 6a20 3d61 7667  > shphz_obj =avg
-00030c30: 5f6f 626a 2e44 6174 615f 7365 6374 696f  _obj.Data_sectio
-00030c40: 6e2e 7348 7068 7a2e 6c6f 635b 2734 3327  n.sHphz.loc['43'
-00030c50: 5d0d 0a20 2020 2020 2020 202e 2e2e 2070  ]..        ... p
-00030c60: 7269 6e74 2873 6870 687a 5f6f 626a 290d  rint(shphz_obj).
-00030c70: 0a20 2020 2022 2222 0d0a 2020 2020 6465  .    """..    de
-00030c80: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-00030c90: 2073 5068 6173 655f 6172 7261 793d 4e6f   sPhase_array=No
-00030ca0: 6e65 2c20 6e75 6d62 6572 5f6f 665f 6672  ne, number_of_fr
-00030cb0: 6571 7565 6e63 6965 733d 4e6f 6e65 202c  equencies=None ,
-00030cc0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00030cd0: 2020 2020 6e75 6d62 6572 5f6f 665f 7374      number_of_st
-00030ce0: 6174 696f 6e73 3d4e 6f6e 6520 2c20 2a2a  ations=None , **
-00030cf0: 6b77 6172 6773 293a 0d0a 2020 2020 2020  kwargs):..      
-00030d00: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
-00030d10: 2e5f 7350 6873 3d20 7350 6861 7365 5f61  ._sPhs= sPhase_a
-00030d20: 7272 6179 0d0a 2020 2020 2020 2020 0d0a  rray..        ..
-00030d30: 2020 2020 2020 2020 7365 6c66 2e6e 756d          self.num
-00030d40: 6265 725f 6f66 5f73 7461 7469 6f6e 7320  ber_of_stations 
-00030d50: 3d6b 7761 7267 732e 706f 7028 226e 756d  =kwargs.pop("num
-00030d60: 6265 725f 6f66 5f73 7461 7469 6f6e 7322  ber_of_stations"
-00030d70: 2c20 4e6f 6e65 290d 0a20 2020 2020 2020  , None)..       
-00030d80: 2073 656c 662e 6e66 7265 7120 3d6b 7761   self.nfreq =kwa
-00030d90: 7267 732e 706f 7028 276e 756d 6265 725f  rgs.pop('number_
-00030da0: 6f66 5f66 7265 7175 656e 6369 6573 272c  of_frequencies',
-00030db0: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
-00030dc0: 7365 6c66 2e74 6f5f 6465 6772 6565 203d  self.to_degree =
-00030dd0: 6b77 6172 6773 2e70 6f70 2827 746f 5f64  kwargs.pop('to_d
-00030de0: 6567 7265 6527 2c20 4661 6c73 6529 0d0a  egree', False)..
-00030df0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00030e00: 2020 7365 6c66 2e76 616c 7565 203d 4e6f    self.value =No
-00030e10: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
-00030e20: 662e 6d69 6e20 3d20 4e6f 6e65 200d 0a20  f.min = None .. 
-00030e30: 2020 2020 2020 2073 656c 662e 6d61 7820         self.max 
-00030e40: 3d20 4e6f 6e65 200d 0a20 2020 200d 0a20  = None ..    .. 
-00030e50: 2020 2020 2020 2066 6f72 206b 6579 2069         for key i
-00030e60: 6e20 6c69 7374 286b 7761 7267 732e 6b65  n list(kwargs.ke
-00030e70: 7973 2829 293a 0d0a 2020 2020 2020 2020  ys()):..        
-00030e80: 2020 2020 7365 7461 7474 7228 7365 6c66      setattr(self
-00030e90: 2c20 6b65 792c 206b 7761 7267 735b 6b65  , key, kwargs[ke
-00030ea0: 795d 290d 0a20 2020 2020 2020 2020 2020  y])..           
-00030eb0: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
-00030ec0: 6c66 2e5f 7350 6873 2069 7320 6e6f 7420  lf._sPhs is not 
-00030ed0: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
-00030ee0: 2020 2020 2073 656c 662e 5f72 6561 645f       self._read_
-00030ef0: 7350 6873 5f64 6174 6120 2829 0d0a 2020  sPhs_data ()..  
-00030f00: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00030f10: 0d0a 2020 2020 6465 6620 5f72 6561 645f  ..    def _read_
-00030f20: 7350 687a 5f64 6174 6120 2873 656c 662c  sPhz_data (self,
-00030f30: 2073 5068 6173 655f 6172 7261 793d 4e6f   sPhase_array=No
-00030f40: 6e65 2c20 6e75 6d62 6572 5f6f 665f 6672  ne, number_of_fr
-00030f50: 6571 7565 6e63 6965 733d 4e6f 6e65 202c  equencies=None ,
-00030f60: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00030f70: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00030f80: 6572 5f6f 665f 7374 6174 696f 6e73 3d4e  er_of_stations=N
-00030f90: 6f6e 652c 202a 2a6b 7761 7267 7320 2029  one, **kwargs  )
-00030fa0: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-00030fb0: 2020 2020 2020 2020 4d65 7468 6f64 2074          Method t
-00030fc0: 6f20 7265 6164 2061 6e64 2061 7261 6e67  o read and arang
-00030fd0: 6520 6461 7461 2061 6363 6f72 6469 6e67  e data according
-00030fe0: 2065 6163 6820 7374 6174 696f 6e20 2f53   each station /S
-00030ff0: 7461 7469 7374 6963 616c 200d 0a20 2020  tatistical ..   
-00031000: 2020 2020 2076 6172 6961 7469 6f6e 206f       variation o
-00031010: 6620 7a50 6861 7365 202d 4669 656c 6420  f zPhase -Field 
-00031020: 616e 676c 6573 2e20 0d0a 0d0a 2020 2020  angles. ....    
-00031030: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00031040: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00031050: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2020  ----..          
-00031060: 2020 2a20 7368 7068 7a5f 6172 7261 7920    * shphz_array 
-00031070: 3a20 6e64 6172 7261 792c 2065 6e20 7261  : ndarray, en ra
-00031080: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
-00031090: 2020 2020 2020 2020 2020 2020 452d 4669              E-Fi
-000310a0: 656c 6420 7068 6173 6520 6f62 7365 7276  eld phase observ
-000310b0: 6564 202e 200d 0a20 2020 2020 2020 2020  ed . ..         
-000310c0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-000310d0: 6865 2064 6566 6175 6c74 2069 7320 4e6f  he default is No
-000310e0: 6e65 2e0d 0a20 2020 2020 2020 2020 2020  ne...           
-000310f0: 202a 206e 756d 6265 725f 6f66 5f66 7265   * number_of_fre
-00031100: 7175 656e 6369 6573 203a 2069 6e74 202c  quencies : int ,
-00031110: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-00031120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031130: 2020 206e 756d 6265 7220 6f66 2066 7265     number of fre
-00031140: 7175 656e 6369 6573 2066 6f72 2073 7572  quencies for sur
-00031150: 7665 792e 0d0a 2020 2020 2020 2020 2020  vey...          
-00031160: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00031170: 6520 6465 6661 756c 7420 6973 204e 6f6e  e default is Non
-00031180: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
-00031190: 2a20 6e75 6d62 6572 5f6f 665f 7374 6174  * number_of_stat
-000311a0: 696f 6e73 203a 2069 6e74 202c 206f 7074  ions : int , opt
-000311b0: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
-000311c0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000311d0: 756d 6265 725f 6f66 2073 7461 7469 6f6e  umber_of station
-000311e0: 732e 200d 0a20 2020 2020 2020 2020 2020  s. ..           
-000311f0: 2020 2020 2020 2020 2020 2020 2054 6865               The
-00031200: 2064 6566 6175 6c74 2069 7320 4e6f 6e65   default is None
-00031210: 2e0d 0a20 2020 2020 2020 2020 2020 202a  ...            *
-00031220: 2074 6f5f 6465 6772 6565 203a 2062 6f6f   to_degree : boo
-00031230: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-00031240: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00031250: 7574 6520 616e 676c 6520 746f 6465 6772  ute angle todegr
-00031260: 6565 202e 200d 0a20 2020 2020 2020 2022  ee . ..        "
-00031270: 2222 0d0a 2020 2020 2020 2020 746f 5f64  ""..        to_d
-00031280: 6567 7265 6520 3d6b 7761 7267 732e 706f  egree =kwargs.po
-00031290: 7028 2274 6f5f 6465 6772 6565 222c 2046  p("to_degree", F
-000312a0: 616c 7365 290d 0a20 2020 2020 2020 2069  alse)..        i
-000312b0: 6620 746f 5f64 6567 7265 6520 3a73 656c  f to_degree :sel
-000312c0: 662e 746f 5f64 6567 7265 6520 3d20 746f  f.to_degree = to
-000312d0: 5f64 6567 7265 650d 0a20 2020 2020 2020  _degree..       
-000312e0: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
-000312f0: 0a20 2020 2020 2020 2069 6620 7350 6861  .        if sPha
-00031300: 7365 5f61 7272 6179 2069 7320 6e6f 7420  se_array is not 
-00031310: 4e6f 6e65 203a 2073 656c 662e 5f73 5068  None : self._sPh
-00031320: 7320 3d73 5068 6173 655f 6172 7261 790d  s =sPhase_array.
-00031330: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00031340: 2e5f 7350 6873 2069 7320 4e6f 6e65 203a  ._sPhs is None :
-00031350: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-00031360: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-00031370: 5445 7272 6f72 5f69 6e70 7574 6172 6775  TError_inputargu
-00031380: 6d65 6e74 7328 0d0a 2020 2020 2020 2020  ments(..        
-00031390: 2020 2020 2020 2020 274e 6f20 7374 6174          'No stat
-000313a0: 2e76 6172 6961 7469 6f6e 2020 496d 7065  .variation  Impe
-000313b0: 6461 6e63 6520 5a20 2d70 6861 7365 2064  dance Z -phase d
-000313c0: 6174 6120 666f 756e 6420 2021 2729 0d0a  ata found  !')..
-000313d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000313e0: 0d0a 2020 2020 2020 2020 6966 206e 756d  ..        if num
-000313f0: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
-00031400: 6573 2069 7320 6e6f 7420 4e6f 6e65 203a  es is not None :
-00031410: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00031420: 6c66 2e6e 6672 6571 203d 206e 756d 6265  lf.nfreq = numbe
-00031430: 725f 6f66 5f66 7265 7175 656e 6369 6573  r_of_frequencies
-00031440: 200d 0a20 2020 2020 2020 2065 6c73 6520   ..        else 
-00031450: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00031460: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-00031470: 5445 7272 6f72 5f69 6e70 7574 6172 6775  TError_inputargu
-00031480: 6d65 6e74 7328 0d0a 2020 2020 2020 2020  ments(..        
-00031490: 2020 2020 2020 2020 2250 6c65 6173 6520          "Please 
-000314a0: 7370 6563 6966 7920 7468 6520 6e75 6d62  specify the numb
-000314b0: 6572 206f 6620 6672 6571 7565 6e63 7920  er of frequency 
-000314c0: 2122 290d 0a20 2020 2020 2020 2069 6620  !")..        if 
-000314d0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
-000314e0: 6e73 2069 7320 6e6f 7420 4e6f 6e65 203a  ns is not None :
-000314f0: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-00031500: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-00031510: 6174 696f 6e73 203d 6e75 6d62 6572 5f6f  ations =number_o
-00031520: 665f 7374 6174 696f 6e73 200d 0a20 2020  f_stations ..   
-00031530: 2020 2020 2065 6c73 6520 3a20 0d0a 2020       else : ..  
-00031540: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00031550: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00031560: 725f 696e 7075 7461 7267 756d 656e 7473  r_inputarguments
-00031570: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00031580: 2020 2027 506c 6561 7365 2073 7065 6369     'Please speci
-00031590: 6679 2074 6865 206e 756d 6265 7220 6f66  fy the number of
-000315a0: 2073 7461 7469 6f6e 7327 290d 0a20 2020   stations')..   
-000315b0: 2020 2020 2073 656c 662e 6e66 7265 7120       self.nfreq 
-000315c0: 2c20 7365 6c66 2e6e 756d 6265 725f 6f66  , self.number_of
-000315d0: 5f73 7461 7469 6f6e 7320 3d6e 702e 696e  _stations =np.in
-000315e0: 7428 7365 6c66 2e6e 6672 6571 292c 5c0d  t(self.nfreq),\.
-000315f0: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
-00031600: 696e 7428 7365 6c66 2e6e 756d 6265 725f  int(self.number_
-00031610: 6f66 5f73 7461 7469 6f6e 7329 2020 2020  of_stations)    
-00031620: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00031630: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00031640: 2020 2020 2064 6566 205f 696e 7370 6563       def _inspec
-00031650: 745f 696e 7075 7420 2869 6e70 7574 5f6f  t_input (input_o
-00031660: 626a 202c 2074 6f5f 6465 6772 6565 3d46  bj , to_degree=F
-00031670: 616c 7365 293a 0d0a 2020 2020 2020 2020  alse):..        
-00031680: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00031690: 2020 2020 2041 7363 6572 7461 696e 2074       Ascertain t
-000316a0: 6861 7420 7468 6520 7661 6c75 6520 6973  hat the value is
-000316b0: 2070 6f73 7369 626c 6520 666f 7220 636f   possible for co
-000316c0: 6d70 7574 696e 672e 2061 6e64 2070 7574  mputing. and put
-000316d0: 206f 6e20 0d0a 2020 2020 2020 2020 2020   on ..          
-000316e0: 2020 6e64 6172 7261 7920 286e 6461 7272    ndarray (ndarr
-000316f0: 6179 2c31 2920 616e 6420 636f 6e76 6572  ay,1) and conver
-00031700: 7420 616e 676c 6520 6173 2070 6f73 7369  t angle as possi
-00031710: 626c 6520 746f 2064 6567 7265 652e 0d0a  ble to degree...
-00031720: 2020 2020 2020 2020 2020 2020 2222 2220              """ 
-00031730: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00031740: 2020 2020 2020 2020 2074 7279 203a 200d           try : .
-00031750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031760: 2069 6e70 7574 5f6f 626a 203d 6e70 2e61   input_obj =np.a
-00031770: 7272 6179 285b 666c 6f61 7428 7373 2920  rray([float(ss) 
-00031780: 666f 7220 7373 2069 6e20 696e 7075 745f  for ss in input_
-00031790: 6f62 6a5d 290d 0a20 2020 2020 2020 2020  obj])..         
-000317a0: 2020 2065 7863 6570 7420 3a20 0d0a 2020     except : ..  
-000317b0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000317c0: 6973 6520 2043 5365 782e 7079 4353 414d  ise  CSex.pyCSAM
-000317d0: 5445 7272 6f72 5f76 616c 7565 280d 0a20  TError_value(.. 
-000317e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000317f0: 2020 2022 5661 6c75 6573 2070 726f 7669     "Values provi
-00031800: 6465 6420 666f 7220 636f 6d70 7574 696e  ded for computin
-00031810: 6720 6172 6520 7772 6f6e 672e 225c 0d0a  g are wrong."\..
-00031820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031830: 2020 2020 2220 6d75 7374 2062 6520 666c      " must be fl
-00031840: 6f61 7420 6f72 2069 6e74 6567 6572 202e  oat or integer .
-00031850: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00031860: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00031870: 2074 6f5f 6465 6772 6565 203a 200d 0a20   to_degree : .. 
-00031880: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00031890: 6e70 7574 5f6f 626a 203d 6e70 2e61 7070  nput_obj =np.app
-000318a0: 6c79 5f61 6c6f 6e67 5f61 7869 7320 280d  ly_along_axis (.
-000318b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000318c0: 2020 2020 206c 616d 6264 6120 783a 2078       lambda x: x
-000318d0: 202a 2031 3830 2f6e 702e 7069 2c20 302c   * 180/np.pi, 0,
-000318e0: 696e 7075 745f 6f62 6a29 0d0a 2020 2020  input_obj)..    
-000318f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00031900: 2020 2020 2020 7265 7475 726e 2069 6e70        return inp
-00031910: 7574 5f6f 626a 200d 0a0d 0a20 2020 2020  ut_obj ....     
-00031920: 2020 2073 656c 662e 5f73 5068 733d 5f69     self._sPhs=_i
-00031930: 6e73 7065 6374 5f69 6e70 7574 2873 656c  nspect_input(sel
-00031940: 662e 5f73 5068 7329 0d0a 0d0a 0d0a 2020  f._sPhs)......  
-00031950: 2020 2020 2020 6966 2073 656c 662e 746f        if self.to
-00031960: 5f64 6567 7265 6520 3a20 232d 2d2d 3e20  _degree : #---> 
-00031970: 7365 7420 616e 676c 6520 746f 2064 6567  set angle to deg
-00031980: 7265 6520 2e0d 0a20 2020 2020 2020 2020  ree ...         
-00031990: 2020 2073 656c 662e 5f73 5068 7320 3d5f     self._sPhs =_
-000319a0: 696e 7370 6563 745f 696e 7075 7428 696e  inspect_input(in
-000319b0: 7075 745f 6f62 6a20 3d73 656c 662e 5f73  put_obj =self._s
-000319c0: 5068 732c 2074 6f5f 6465 6772 6565 203d  Phs, to_degree =
-000319d0: 5472 7565 2920 2020 2020 2020 200d 0a20  True)        .. 
-000319e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000319f0: 2023 202d 2d3e 2063 6865 636b 2074 6865   # --> check the
-00031a00: 206d 6178 696d 756d 2061 6e67 6c65 2076   maximum angle v
-00031a10: 616c 7565 2061 6e64 206d 696e 696d 756d  alue and minimum
-00031a20: 2061 6e67 6c65 2076 616c 7565 2e0d 0a20   angle value... 
-00031a30: 2020 2020 2020 2076 636f 756e 7473 5f73         vcounts_s
-00031a40: 7068 7a2c 2072 6570 6561 745f 6870 687a  phz, repeat_hphz
-00031a50: 3d6e 702e 756e 6971 7565 2028 7365 6c66  =np.unique (self
-00031a60: 2e5f 7350 6873 2c20 7265 7475 726e 5f63  ._sPhs, return_c
-00031a70: 6f75 6e74 733d 5472 7565 290d 0a20 2020  ounts=True)..   
-00031a80: 2020 2020 2073 656c 662e 7661 6c75 6520       self.value 
-00031a90: 3d76 636f 756e 7473 5f73 7068 7a0d 0a20  =vcounts_sphz.. 
-00031aa0: 2020 2020 2020 2073 656c 662e 6d61 782c         self.max,
-00031ab0: 2073 656c 662e 6d69 6e20 3d76 636f 756e   self.min =vcoun
-00031ac0: 7473 5f73 7068 7a2e 6d61 7828 292c 2076  ts_sphz.max(), v
-00031ad0: 636f 756e 7473 5f73 7068 7a2e 6d69 6e28  counts_sphz.min(
-00031ae0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-00031af0: 2020 2020 2023 2d2d 2d3e 2074 756e 6361       #---> tunca
-00031b00: 7465 6420 4156 4720 7348 7068 7a20 7661  ted AVG sHphz va
-00031b10: 6c75 6520 6f6e 2020 6469 6374 696f 6e6e  lue on  dictionn
-00031b20: 6172 7920 666f 7220 6561 7379 2061 6363  ary for easy acc
-00031b30: 6573 202e 200d 0a20 2020 2020 2020 2074  es . ..        t
-00031b40: 7275 6e63 6174 6564 5f73 7068 7a3d 5a63  runcated_sphz=Zc
-00031b50: 632e 7472 756e 6361 7465 645f 6461 7461  c.truncated_data
-00031b60: 2820 6461 7461 203d 7365 6c66 2e5f 7350  ( data =self._sP
-00031b70: 6873 2c20 0d0a 2020 2020 2020 2020 2020  hs, ..          
-00031b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b90: 2020 2020 2020 2020 2020 2020 206e 756d               num
-00031ba0: 6265 725f 6f66 5f72 6563 6375 7265 6e63  ber_of_reccurenc
-00031bb0: 653d 7365 6c66 2e6e 6672 6571 290d 0a20  e=self.nfreq).. 
-00031bc0: 2020 2020 2020 206e 616d 652c 2070 6f6c         name, pol
-00031bd0: 796e 616d 6520 3d20 5a63 632e 5f6e 756d  yname = Zcc._num
-00031be0: 6265 7269 6e67 5f73 7461 7469 6f6e 280d  bering_station(.
-00031bf0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-00031c00: 6265 725f 6f66 5f73 7461 7469 6f6e 3d73  ber_of_station=s
-00031c10: 656c 662e 6e75 6d62 6572 5f6f 665f 7374  elf.number_of_st
-00031c20: 6174 696f 6e73 2c20 0d0a 2020 2020 2020  ations, ..      
-00031c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031c40: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-00031c50: 6f66 5f66 7265 7120 3d73 656c 662e 6e66  of_freq =self.nf
-00031c60: 7265 7129 0d0a 2020 2020 2020 2020 0d0a  req)..        ..
-00031c70: 2020 2020 2020 2020 7365 6c66 2e6c 6f63          self.loc
-00031c80: 203d 7b20 6b65 793a 7661 6c75 6520 666f   ={ key:value fo
-00031c90: 7220 6b65 792c 2076 616c 7565 2069 6e20  r key, value in 
-00031ca0: 7a69 7028 6e61 6d65 2c20 7472 756e 6361  zip(name, trunca
-00031cb0: 7465 645f 7370 687a 297d 0d0a 2020 2020  ted_sphz)}..    
-00031cc0: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
-00031cd0: 0d0a 2020 2020 2020 2020 0d0a 0d0a 0d0a  ..        ......
-00031ce0: 2020 2020 0d0a 0d0a 2020 2020 0d0a 2020      ....    ..  
-00031cf0: 2020 0d0a 2020 2020 0d0a 2020 2020 0d0a    ..    ..    ..
-00031d00: 2020 2020 2020 2020 0d0a 2020 2020 0d0a          ..    ..
-00031d10: 0d0a                                     ..
+0002f6e0: 2020 6e75 6d62 6572 5f6f 6620 7374 6174    number_of stat
+0002f6f0: 696f 6e73 2e20 0d0a 2020 2020 2020 2020  ions. ..        
+0002f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f710: 2020 2020 5468 6520 6465 6661 756c 7420      The default 
+0002f720: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
+0002f730: 2020 2222 220d 0a20 2020 2020 2020 200d    """..        .
+0002f740: 0a20 2020 2020 2020 2069 6620 7063 5265  .        if pcRe
+0002f750: 735f 6172 7261 7920 2069 7320 6e6f 7420  s_array  is not 
+0002f760: 4e6f 6e65 203a 200d 0a20 2020 2020 2020  None : ..       
+0002f770: 2020 2020 2073 656c 662e 5f70 6352 6573       self._pcRes
+0002f780: 3d20 7063 5265 735f 6172 7261 7920 0d0a  = pcRes_array ..
+0002f790: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002f7a0: 5f70 6352 6573 2069 7320 4e6f 6e65 203a  _pcRes is None :
+0002f7b0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+0002f7c0: 6169 7365 2054 7970 6545 7272 6f72 2827  aise TypeError('
+0002f7d0: 4e6f 2052 6573 6973 7469 7669 7479 2064  No Resistivity d
+0002f7e0: 6174 6120 666f 756e 6420 2127 290d 0a0d  ata found !')...
+0002f7f0: 0a20 2020 2020 2020 2069 6620 6e75 6d62  .        if numb
+0002f800: 6572 5f6f 665f 6672 6571 7565 6e63 6965  er_of_frequencie
+0002f810: 7320 6973 206e 6f74 204e 6f6e 6520 3a20  s is not None : 
+0002f820: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0002f830: 6c66 2e6e 6672 6571 203d 6e75 6d62 6572  lf.nfreq =number
+0002f840: 5f6f 665f 6672 6571 7565 6e63 6965 7320  _of_frequencies 
+0002f850: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+0002f860: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+0002f870: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
+0002f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f890: 2250 6c65 6173 6520 7370 6563 6966 7920  "Please specify 
+0002f8a0: 7468 6520 6e75 6d62 6572 206f 6620 6672  the number of fr
+0002f8b0: 6571 7565 6e63 7920 2122 290d 0a20 2020  equency !")..   
+0002f8c0: 2020 2020 2069 6620 6e75 6d62 6572 5f6f       if number_o
+0002f8d0: 665f 7374 6174 696f 6e73 2069 7320 6e6f  f_stations is no
+0002f8e0: 7420 4e6f 6e65 203a 0d0a 2020 2020 2020  t None :..      
+0002f8f0: 2020 2020 2020 7365 6c66 2e6e 756d 6265        self.numbe
+0002f900: 725f 6f66 5f73 7461 7469 6f6e 7320 3d6e  r_of_stations =n
+0002f910: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+0002f920: 7320 0d0a 2020 2020 2020 2020 656c 7365  s ..        else
+0002f930: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+0002f940: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0002f950: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0002f960: 2020 2027 506c 6561 7365 2073 7065 6369     'Please speci
+0002f970: 6679 2074 6865 206e 756d 6265 7220 6f66  fy the number of
+0002f980: 2073 7461 7469 6f6e 7327 290d 0a20 2020   stations')..   
+0002f990: 2020 200d 0a20 2020 2020 2020 2074 7279     ..        try
+0002f9a0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+0002f9b0: 2073 656c 662e 6e66 7265 7120 2c20 7365   self.nfreq , se
+0002f9c0: 6c66 2e6e 756d 6265 725f 6f66 5f73 7461  lf.number_of_sta
+0002f9d0: 7469 6f6e 7320 3d6e 702e 696e 7428 7365  tions =np.int(se
+0002f9e0: 6c66 2e6e 6672 6571 292c 5c0d 0a20 2020  lf.nfreq),\..   
+0002f9f0: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+0002fa00: 696e 7428 7365 6c66 2e6e 756d 6265 725f  int(self.number_
+0002fa10: 6f66 5f73 7461 7469 6f6e 7329 0d0a 2020  of_stations)..  
+0002fa20: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0002fa30: 7063 5265 7320 3d6e 702e 6172 7261 7928  pcRes =np.array(
+0002fa40: 5b6e 702e 666c 6f61 7428 6363 2920 666f  [np.float(cc) fo
+0002fa50: 7220 6363 2069 6e20 7365 6c66 2e5f 7063  r cc in self._pc
+0002fa60: 5265 735d 290d 0a0d 0a20 2020 2020 2020  Res])....       
+0002fa70: 2065 7863 6570 7420 3a0d 0a20 2020 2020   except :..     
+0002fa80: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0002fa90: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
+0002faa0: 2020 2020 2020 2020 2020 2256 616c 7565            "Value
+0002fab0: 7320 7072 6f76 6964 6564 2066 6f72 2074  s provided for t
+0002fac0: 6865 2052 6573 6973 7469 7669 7469 6573  he Resistivities
+0002fad0: 2061 7265 2077 726f 6e67 2e22 0d0a 2020   are wrong."..  
+0002fae0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002faf0: 206d 7573 7420 6265 2066 6c6f 6174 206f   must be float o
+0002fb00: 7220 696e 7465 6765 7220 2e22 290d 0a20  r integer .").. 
+0002fb10: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0002fb20: 2076 636f 756e 7473 5f70 6372 6573 2c20   vcounts_pcres, 
+0002fb30: 7265 7065 6174 5f68 7068 7a3d 6e70 2e75  repeat_hphz=np.u
+0002fb40: 6e69 7175 6520 2873 656c 662e 5f70 6352  nique (self._pcR
+0002fb50: 6573 2c20 7265 7475 726e 5f63 6f75 6e74  es, return_count
+0002fb60: 733d 5472 7565 290d 0a20 2020 2020 2020  s=True)..       
+0002fb70: 2069 6620 6e6f 7420 6e70 2e61 6c6c 2872   if not np.all(r
+0002fb80: 6570 6561 745f 6870 687a 293a 200d 0a20  epeat_hphz): .. 
+0002fb90: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002fba0: 2056 616c 7565 4572 726f 7228 0d0a 2020   ValueError(..  
+0002fbb0: 2020 2020 2020 2020 2020 2020 2020 2756                'V
+0002fbc0: 616c 7565 7320 6f66 2052 686f 2070 726f  alues of Rho pro
+0002fbd0: 7669 6465 6420 6d75 7374 2068 6176 6520  vided must have 
+0002fbe0: 7468 6520 7361 6d65 206c 656e 6774 6827  the same length'
+0002fbf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002fc00: 2020 2027 2066 6f72 2065 6163 6820 7374     ' for each st
+0002fc10: 6174 696f 6e73 2e20 2729 0d0a 2020 2020  ations. ')..    
+0002fc20: 2020 2020 7365 6c66 2e76 616c 7565 203d      self.value =
+0002fc30: 7663 6f75 6e74 735f 7063 7265 730d 0a20  vcounts_pcres.. 
+0002fc40: 2020 2020 2020 2073 656c 662e 6d61 782c         self.max,
+0002fc50: 2073 656c 662e 6d69 6e20 3d76 636f 756e   self.min =vcoun
+0002fc60: 7473 5f70 6372 6573 2e6d 6178 2829 2c20  ts_pcres.max(), 
+0002fc70: 7663 6f75 6e74 735f 7063 7265 732e 6d69  vcounts_pcres.mi
+0002fc80: 6e28 290d 0a20 2020 2020 2020 2073 656c  n()..        sel
+0002fc90: 662e 6d65 616e 3d73 656c 662e 5f70 6352  f.mean=self._pcR
+0002fca0: 6573 2e6d 6561 6e28 290d 0a20 2020 2020  es.mean()..     
+0002fcb0: 2020 2074 7275 6e63 6174 6564 5f70 6372     truncated_pcr
+0002fcc0: 6573 3d5a 6363 2e74 7275 6e63 6174 6564  es=Zcc.truncated
+0002fcd0: 5f64 6174 6128 2064 6174 6120 3d73 656c  _data( data =sel
+0002fce0: 662e 5f70 6352 6573 2c20 0d0a 2020 2020  f._pcRes, ..    
+0002fcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd10: 2020 206e 756d 6265 725f 6f66 5f72 6563     number_of_rec
+0002fd20: 6375 7265 6e63 653d 7365 6c66 2e6e 6672  curence=self.nfr
+0002fd30: 6571 290d 0a20 2020 2020 2020 206e 616d  eq)..        nam
+0002fd40: 652c 2070 6f6c 796e 616d 6520 3d20 5a63  e, polyname = Zc
+0002fd50: 632e 5f6e 756d 6265 7269 6e67 5f73 7461  c._numbering_sta
+0002fd60: 7469 6f6e 280d 0a20 2020 2020 2020 2020  tion(..         
+0002fd70: 2020 206e 756d 6265 725f 6f66 5f73 7461     number_of_sta
+0002fd80: 7469 6f6e 3d73 656c 662e 6e75 6d62 6572  tion=self.number
+0002fd90: 5f6f 665f 7374 6174 696f 6e73 2c20 0d0a  _of_stations, ..
+0002fda0: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+0002fdb0: 6572 5f6f 665f 6672 6571 203d 7365 6c66  er_of_freq =self
+0002fdc0: 2e6e 6672 6571 290d 0a20 2020 2020 2020  .nfreq)..       
+0002fdd0: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+0002fde0: 6c6f 6320 3d7b 206b 6579 3a76 616c 7565  loc ={ key:value
+0002fdf0: 2066 6f72 206b 6579 2c20 7661 6c75 6520   for key, value 
+0002fe00: 696e 207a 6970 286e 616d 652c 2074 7275  in zip(name, tru
+0002fe10: 6e63 6174 6564 5f70 6372 6573 2029 7d0d  ncated_pcres )}.
+0002fe20: 0a20 2020 2020 2020 200d 0a0d 0a63 6c61  .        ....cla
+0002fe30: 7373 2073 5068 7a28 6f62 6a65 6374 2920  ss sPhz(object) 
+0002fe40: 3a20 0d0a 2020 2020 2222 220d 0a20 2020  : ..    """..   
+0002fe50: 2053 7461 7469 7374 6963 616c 2076 6172   Statistical var
+0002fe60: 6961 7469 6f6e 206f 6620 7468 6520 6461  iation of the da
+0002fe70: 7461 2062 6c6f 636b 7320 6176 6572 6167  ta blocks averag
+0002fe80: 6564 2066 6f72 2074 6869 7320 6461 7461  ed for this data
+0002fe90: 2070 6f69 6e74 2e0d 0a20 2020 2020 2020   point...       
+0002fea0: 2031 3030 202a 2053 7461 6e64 6172 6420   100 * Standard 
+0002feb0: 4465 7669 6174 696f 6e20 6f66 2050 6861  Deviation of Pha
+0002fec0: 7365 2076 616c 7565 7320 286d 696c 6c69  se values (milli
+0002fed0: 7261 6469 616e 7329 0d0a 2020 2020 2020  radians)..      
+0002fee0: 2020 0d0a 2020 2020 4172 6775 6d65 6e74    ..    Argument
+0002fef0: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
+0002ff00: 2d2d 0d0a 2020 2020 2020 2020 2a2a 7370  --..        **sp
+0002ff10: 687a 2061 7272 6179 2a2a 203a 2061 7272  hz array** : arr
+0002ff20: 6179 5f6c 696b 6520 0d0a 2020 2020 2020  ay_like ..      
+0002ff30: 2020 2020 2020 2020 2020 636f 6566 6669            coeffi
+0002ff40: 6369 656e 7420 6f66 2020 7068 6173 6520  cient of  phase 
+0002ff50: 7661 7269 6174 696f 6e20 6172 7271 7920  variation arrqy 
+0002ff60: 0d0a 2020 2020 2020 2020 2a2a 7061 7468  ..        **path
+0002ff70: 2074 6f20 6176 672a 2a3a 7374 720d 0a20   to avg**:str.. 
+0002ff80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002ff90: 756c 6c20 7061 7468 2074 6f20 6669 6c65  ull path to file
+0002ffa0: 6e61 6d65 200d 0a20 2020 2020 2020 2020  name ..         
+0002ffb0: 2020 2020 2020 2020 200d 0a20 2020 2048           ..    H
+0002ffc0: 6f6c 6473 2074 6865 2066 6f6c 6c6f 7769  olds the followi
+0002ffd0: 6e67 2069 6e66 6f72 6d61 7469 6f6e 733a  ng informations:
+0002ffe0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0002fff0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00030000: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d    ==========  ==
+00030010: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00030020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00030030: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+00030040: 2041 7474 7269 6275 7465 7320 2020 2020   Attributes     
+00030050: 2020 2020 5479 7065 2020 2020 2020 2020      Type        
+00030060: 4578 706c 616e 6174 696f 6e0d 0a20 2020  Explanation..   
+00030070: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00030080: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d20 203d  =  ==========  =
+00030090: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000300a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000300b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
+000300c0: 2020 7661 6c75 6520 2020 2020 2020 2020    value         
+000300d0: 2020 2020 6e64 2e61 7272 6179 2020 2020      nd.array    
+000300e0: 2020 6461 7461 206f 6620 7350 687a 2020    data of sPhz  
+000300f0: 636f 6c75 6d6e 206f 6e20 6176 6766 696c  column on avgfil
+00030100: 6520 2020 0d0a 2020 2020 6d61 7820 2020  e   ..    max   
+00030110: 2020 2020 2020 2020 2020 2020 666c 6f61              floa
+00030120: 7420 2020 2020 2020 2020 6d61 7869 6d75  t         maximu
+00030130: 6d20 2520 7661 6c75 6520 6f66 2073 4870  m % value of sHp
+00030140: 687a 0d0a 2020 2020 6d69 6e20 2020 2020  hz..    min     
+00030150: 2020 2020 2020 2020 2020 666c 6f61 7420            float 
+00030160: 2020 2020 2020 2020 6d69 6e69 6d75 2020          minimu  
+00030170: 7661 6c75 6520 6f66 2073 4870 687a 0d0a  value of sHphz..
+00030180: 2020 2020 6c6f 6320 2020 2020 2020 2020      loc         
+00030190: 2020 2020 2020 6469 6374 2020 2020 2020        dict      
+000301a0: 2020 2020 6c6f 6361 7469 6f6e 206f 6620      location of 
+000301b0: 7350 687a 206d 6167 6e69 7475 6465 2076  sPhz magnitude v
+000301c0: 616c 7565 2061 7420 0d0a 2020 2020 2020  alue at ..      
+000301d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000301e0: 2020 2020 2020 2020 2020 2020 2020 7468                th
+000301f0: 6520 7374 6174 696f 6e20 6c61 6d62 6461  e station lambda
+00030200: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
+00030210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030220: 2020 2020 2020 2020 653a 6720 2d20 6c6f          e:g - lo
+00030230: 635b 2753 3037 275d 2073 686f 7720 7468  c['S07'] show th
+00030240: 6520 6375 7272 656e 7420 2073 5068 7a20  e current  sPhz 
+00030250: 6461 7461 200d 0a20 2020 2020 2020 2020  data ..         
+00030260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030270: 2020 2020 2020 2020 2020 206f 6620 7374             of st
+00030280: 6174 696f 6e20 6174 2053 3037 2e0d 0a20  ation at S07... 
+00030290: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
+000302a0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d20  ===  ========== 
+000302b0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+000302c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000302d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+000302e0: 2020 2020 0d0a 2020 2020 4d6f 7265 2061      ..    More a
+000302f0: 7474 7269 6275 7465 7320 6361 6e20 6265  ttributes can be
+00030300: 2061 6464 6564 2062 7920 696e 7075 7469   added by inputi
+00030310: 6e67 2061 206b 6579 2077 6f72 6420 6469  ng a key word di
+00030320: 6374 696f 6e61 7279 0d0a 2020 2020 0d0a  ctionary..    ..
+00030330: 2020 2020 3a45 7861 6d70 6c65 3a0d 0a0d      :Example:...
+00030340: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+00030350: 6d20 7079 6373 616d 742e 636f 7265 2e61  m pycsamt.core.a
+00030360: 7667 2069 6d70 6f72 2041 7667 0d0a 2020  vg impor Avg..  
+00030370: 2020 2020 2020 3e3e 3e20 7061 7468 3d6f        >>> path=o
+00030380: 732e 7061 7468 2e6a 6f69 6e28 6f73 2e65  s.path.join(os.e
+00030390: 6e76 6972 6f6e 5b22 7079 4353 414d 5422  nviron["pyCSAMT"
+000303a0: 5d2c 200d 0a20 2020 2020 2020 202e 2e2e  ], ..        ...
+000303b0: 2020 2020 2027 7079 6373 616d 7427 2c20       'pycsamt', 
+000303c0: 2264 6174 6122 2c20 224b 312e 4156 4722  "data", "K1.AVG"
+000303d0: 290d 0a20 2020 2020 2020 203e 3e3e 2061  )..        >>> a
+000303e0: 7667 5f6f 626a 3d41 7667 2870 6174 6829  vg_obj=Avg(path)
+000303f0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7368  ..        >>> sh
+00030400: 7068 7a5f 6f62 6a20 3d61 7667 5f6f 626a  phz_obj =avg_obj
+00030410: 2e44 6174 615f 7365 6374 696f 6e2e 7348  .Data_section.sH
+00030420: 7068 7a2e 6c6f 635b 2734 3327 5d0d 0a20  phz.loc['43'].. 
+00030430: 2020 2020 2020 202e 2e2e 2070 7269 6e74         ... print
+00030440: 2873 6870 687a 5f6f 626a 290d 0a20 2020  (shphz_obj)..   
+00030450: 2022 2222 0d0a 2020 2020 6465 6620 5f5f   """..    def __
+00030460: 696e 6974 5f5f 2873 656c 662c 2073 5068  init__(self, sPh
+00030470: 6173 655f 6172 7261 793d 4e6f 6e65 2c20  ase_array=None, 
+00030480: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+00030490: 6e63 6965 733d 4e6f 6e65 202c 200d 0a20  ncies=None , .. 
+000304a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000304b0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+000304c0: 6e73 3d4e 6f6e 6520 2c20 2a2a 6b77 6172  ns=None , **kwar
+000304d0: 6773 293a 0d0a 2020 2020 2020 2020 0d0a  gs):..        ..
+000304e0: 2020 2020 2020 2020 7365 6c66 2e5f 7350          self._sP
+000304f0: 6873 3d20 7350 6861 7365 5f61 7272 6179  hs= sPhase_array
+00030500: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00030510: 2020 2020 7365 6c66 2e6e 756d 6265 725f      self.number_
+00030520: 6f66 5f73 7461 7469 6f6e 7320 3d6b 7761  of_stations =kwa
+00030530: 7267 732e 706f 7028 226e 756d 6265 725f  rgs.pop("number_
+00030540: 6f66 5f73 7461 7469 6f6e 7322 2c20 4e6f  of_stations", No
+00030550: 6e65 290d 0a20 2020 2020 2020 2073 656c  ne)..        sel
+00030560: 662e 6e66 7265 7120 3d6b 7761 7267 732e  f.nfreq =kwargs.
+00030570: 706f 7028 276e 756d 6265 725f 6f66 5f66  pop('number_of_f
+00030580: 7265 7175 656e 6369 6573 272c 204e 6f6e  requencies', Non
+00030590: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
+000305a0: 2e74 6f5f 6465 6772 6565 203d 6b77 6172  .to_degree =kwar
+000305b0: 6773 2e70 6f70 2827 746f 5f64 6567 7265  gs.pop('to_degre
+000305c0: 6527 2c20 4661 6c73 6529 0d0a 2020 2020  e', False)..    
+000305d0: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+000305e0: 6c66 2e76 616c 7565 203d 4e6f 6e65 200d  lf.value =None .
+000305f0: 0a20 2020 2020 2020 2073 656c 662e 6d69  .        self.mi
+00030600: 6e20 3d20 4e6f 6e65 200d 0a20 2020 2020  n = None ..     
+00030610: 2020 2073 656c 662e 6d61 7820 3d20 4e6f     self.max = No
+00030620: 6e65 200d 0a20 2020 200d 0a20 2020 2020  ne ..    ..     
+00030630: 2020 2066 6f72 206b 6579 2069 6e20 6c69     for key in li
+00030640: 7374 286b 7761 7267 732e 6b65 7973 2829  st(kwargs.keys()
+00030650: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00030660: 7365 7461 7474 7228 7365 6c66 2c20 6b65  setattr(self, ke
+00030670: 792c 206b 7761 7267 735b 6b65 795d 290d  y, kwargs[key]).
+00030680: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00030690: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+000306a0: 7350 6873 2069 7320 6e6f 7420 4e6f 6e65  sPhs is not None
+000306b0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+000306c0: 2073 656c 662e 5f72 6561 645f 7350 6873   self._read_sPhs
+000306d0: 5f64 6174 6120 2829 0d0a 2020 2020 2020  _data ()..      
+000306e0: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
+000306f0: 2020 6465 6620 5f72 6561 645f 7350 687a    def _read_sPhz
+00030700: 5f64 6174 6120 2873 656c 662c 2073 5068  _data (self, sPh
+00030710: 6173 655f 6172 7261 793d 4e6f 6e65 2c20  ase_array=None, 
+00030720: 6e75 6d62 6572 5f6f 665f 6672 6571 7565  number_of_freque
+00030730: 6e63 6965 733d 4e6f 6e65 202c 200d 0a20  ncies=None , .. 
+00030740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030750: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+00030760: 665f 7374 6174 696f 6e73 3d4e 6f6e 652c  f_stations=None,
+00030770: 202a 2a6b 7761 7267 7320 2029 3a0d 0a20   **kwargs  ):.. 
+00030780: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00030790: 2020 2020 4d65 7468 6f64 2074 6f20 7265      Method to re
+000307a0: 6164 2061 6e64 2061 7261 6e67 6520 6461  ad and arange da
+000307b0: 7461 2061 6363 6f72 6469 6e67 2065 6163  ta according eac
+000307c0: 6820 7374 6174 696f 6e20 2f53 7461 7469  h station /Stati
+000307d0: 7374 6963 616c 200d 0a20 2020 2020 2020  stical ..       
+000307e0: 2076 6172 6961 7469 6f6e 206f 6620 7a50   variation of zP
+000307f0: 6861 7365 202d 4669 656c 6420 616e 676c  hase -Field angl
+00030800: 6573 2e20 0d0a 0d0a 2020 2020 2020 2020  es. ....        
+00030810: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+00030820: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00030830: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+00030840: 7368 7068 7a5f 6172 7261 7920 3a20 6e64  shphz_array : nd
+00030850: 6172 7261 792c 2065 6e20 7261 6420 0d0a  array, en rad ..
+00030860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030870: 2020 2020 2020 2020 452d 4669 656c 6420          E-Field 
+00030880: 7068 6173 6520 6f62 7365 7276 6564 202e  phase observed .
+00030890: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000308a0: 2020 2020 2020 2020 2020 2054 6865 2064             The d
+000308b0: 6566 6175 6c74 2069 7320 4e6f 6e65 2e0d  efault is None..
+000308c0: 0a20 2020 2020 2020 2020 2020 202a 206e  .            * n
+000308d0: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
+000308e0: 6369 6573 203a 2069 6e74 202c 206f 7074  cies : int , opt
+000308f0: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
+00030900: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00030910: 756d 6265 7220 6f66 2066 7265 7175 656e  umber of frequen
+00030920: 6369 6573 2066 6f72 2073 7572 7665 792e  cies for survey.
+00030930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00030940: 2020 2020 2020 2020 2020 5468 6520 6465            The de
+00030950: 6661 756c 7420 6973 204e 6f6e 652e 0d0a  fault is None...
+00030960: 2020 2020 2020 2020 2020 2020 2a20 6e75              * nu
+00030970: 6d62 6572 5f6f 665f 7374 6174 696f 6e73  mber_of_stations
+00030980: 203a 2069 6e74 202c 206f 7074 696f 6e61   : int , optiona
+00030990: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+000309a0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+000309b0: 725f 6f66 2073 7461 7469 6f6e 732e 200d  r_of stations. .
+000309c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000309d0: 2020 2020 2020 2020 2054 6865 2064 6566           The def
+000309e0: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
+000309f0: 2020 2020 2020 2020 2020 202a 2074 6f5f             * to_
+00030a00: 6465 6772 6565 203a 2062 6f6f 6c2c 0d0a  degree : bool,..
+00030a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a20: 2020 2020 2020 2020 636f 6d70 7574 6520          compute 
+00030a30: 616e 676c 6520 746f 6465 6772 6565 202e  angle todegree .
+00030a40: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+00030a50: 2020 2020 2020 2020 746f 5f64 6567 7265          to_degre
+00030a60: 6520 3d6b 7761 7267 732e 706f 7028 2274  e =kwargs.pop("t
+00030a70: 6f5f 6465 6772 6565 222c 2046 616c 7365  o_degree", False
+00030a80: 290d 0a20 2020 2020 2020 2069 6620 746f  )..        if to
+00030a90: 5f64 6567 7265 6520 3a73 656c 662e 746f  _degree :self.to
+00030aa0: 5f64 6567 7265 6520 3d20 746f 5f64 6567  _degree = to_deg
+00030ab0: 7265 650d 0a20 2020 2020 2020 2020 2020  ree..           
+00030ac0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00030ad0: 2020 2020 2069 6620 7350 6861 7365 5f61       if sPhase_a
+00030ae0: 7272 6179 2069 7320 6e6f 7420 4e6f 6e65  rray is not None
+00030af0: 203a 2073 656c 662e 5f73 5068 7320 3d73   : self._sPhs =s
+00030b00: 5068 6173 655f 6172 7261 790d 0a20 2020  Phase_array..   
+00030b10: 2020 2020 2069 6620 7365 6c66 2e5f 7350       if self._sP
+00030b20: 6873 2069 7320 4e6f 6e65 203a 200d 0a20  hs is None : .. 
+00030b30: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00030b40: 205a 4572 726f 7228 0d0a 2020 2020 2020   ZError(..      
+00030b50: 2020 2020 2020 2020 2020 274e 6f20 7374            'No st
+00030b60: 6174 2e76 6172 6961 7469 6f6e 2020 496d  at.variation  Im
+00030b70: 7065 6461 6e63 6520 5a20 2d70 6861 7365  pedance Z -phase
+00030b80: 2064 6174 6120 666f 756e 6420 2021 2729   data found  !')
+00030b90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00030ba0: 2020 0d0a 2020 2020 2020 2020 6966 206e    ..        if n
+00030bb0: 756d 6265 725f 6f66 5f66 7265 7175 656e  umber_of_frequen
+00030bc0: 6369 6573 2069 7320 6e6f 7420 4e6f 6e65  cies is not None
+00030bd0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00030be0: 7365 6c66 2e6e 6672 6571 203d 206e 756d  self.nfreq = num
+00030bf0: 6265 725f 6f66 5f66 7265 7175 656e 6369  ber_of_frequenci
+00030c00: 6573 200d 0a20 2020 2020 2020 2065 6c73  es ..        els
+00030c10: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
+00030c20: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00030c30: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00030c40: 2020 2020 2250 6c65 6173 6520 7370 6563      "Please spec
+00030c50: 6966 7920 7468 6520 6e75 6d62 6572 206f  ify the number o
+00030c60: 6620 6672 6571 7565 6e63 7920 2122 290d  f frequency !").
+00030c70: 0a20 2020 2020 2020 2069 6620 6e75 6d62  .        if numb
+00030c80: 6572 5f6f 665f 7374 6174 696f 6e73 2069  er_of_stations i
+00030c90: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
+00030ca0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00030cb0: 6e75 6d62 6572 5f6f 665f 7374 6174 696f  number_of_statio
+00030cc0: 6e73 203d 6e75 6d62 6572 5f6f 665f 7374  ns =number_of_st
+00030cd0: 6174 696f 6e73 200d 0a20 2020 2020 2020  ations ..       
+00030ce0: 2065 6c73 6520 3a20 0d0a 2020 2020 2020   else : ..      
+00030cf0: 2020 2020 2020 7261 6973 6520 5374 6174        raise Stat
+00030d00: 696f 6e45 7272 6f72 280d 0a20 2020 2020  ionError(..     
+00030d10: 2020 2020 2020 2020 2020 2027 506c 6561             'Plea
+00030d20: 7365 2073 7065 6369 6679 2074 6865 206e  se specify the n
+00030d30: 756d 6265 7220 6f66 2073 7461 7469 6f6e  umber of station
+00030d40: 7327 290d 0a20 2020 2020 2020 2073 656c  s')..        sel
+00030d50: 662e 6e66 7265 7120 2c20 7365 6c66 2e6e  f.nfreq , self.n
+00030d60: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+00030d70: 7320 3d6e 702e 696e 7428 7365 6c66 2e6e  s =np.int(self.n
+00030d80: 6672 6571 292c 5c0d 0a20 2020 2020 2020  freq),\..       
+00030d90: 2020 2020 206e 702e 696e 7428 7365 6c66       np.int(self
+00030da0: 2e6e 756d 6265 725f 6f66 5f73 7461 7469  .number_of_stati
+00030db0: 6f6e 7329 2020 2020 0d0a 2020 2020 2020  ons)    ..      
+00030dc0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00030dd0: 2020 200d 0a20 2020 2020 2020 2064 6566     ..        def
+00030de0: 205f 696e 7370 6563 745f 696e 7075 7420   _inspect_input 
+00030df0: 2869 6e70 7574 5f6f 626a 202c 2074 6f5f  (input_obj , to_
+00030e00: 6465 6772 6565 3d46 616c 7365 293a 0d0a  degree=False):..
+00030e10: 2020 2020 2020 2020 2020 2020 2222 220d              """.
+00030e20: 0a20 2020 2020 2020 2020 2020 2041 7363  .            Asc
+00030e30: 6572 7461 696e 2074 6861 7420 7468 6520  ertain that the 
+00030e40: 7661 6c75 6520 6973 2070 6f73 7369 626c  value is possibl
+00030e50: 6520 666f 7220 636f 6d70 7574 696e 672e  e for computing.
+00030e60: 2061 6e64 2070 7574 206f 6e20 0d0a 2020   and put on ..  
+00030e70: 2020 2020 2020 2020 2020 6e64 6172 7261            ndarra
+00030e80: 7920 286e 6461 7272 6179 2c31 2920 616e  y (ndarray,1) an
+00030e90: 6420 636f 6e76 6572 7420 616e 676c 6520  d convert angle 
+00030ea0: 6173 2070 6f73 7369 626c 6520 746f 2064  as possible to d
+00030eb0: 6567 7265 652e 0d0a 2020 2020 2020 2020  egree...        
+00030ec0: 2020 2020 2222 2220 2020 2020 2020 2020      """         
+00030ed0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00030ee0: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
+00030ef0: 2020 2020 2020 2020 2069 6e70 7574 5f6f           input_o
+00030f00: 626a 203d 6e70 2e61 7272 6179 285b 666c  bj =np.array([fl
+00030f10: 6f61 7428 7373 2920 666f 7220 7373 2069  oat(ss) for ss i
+00030f20: 6e20 696e 7075 745f 6f62 6a5d 290d 0a20  n input_obj]).. 
+00030f30: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00030f40: 7420 3a20 0d0a 2020 2020 2020 2020 2020  t : ..          
+00030f50: 2020 2020 2020 7261 6973 6520 2056 616c        raise  Val
+00030f60: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
+00030f70: 2020 2020 2020 2020 2020 2020 2020 2256                "V
+00030f80: 616c 7565 7320 7072 6f76 6964 6564 2066  alues provided f
+00030f90: 6f72 2063 6f6d 7075 7469 6e67 2061 7265  or computing are
+00030fa0: 2077 726f 6e67 2e22 5c0d 0a20 2020 2020   wrong."\..     
+00030fb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00030fc0: 206d 7573 7420 6265 2066 6c6f 6174 206f   must be float o
+00030fd0: 7220 696e 7465 6765 7220 2e22 290d 0a20  r integer .").. 
+00030fe0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00030ff0: 2020 2020 2020 2020 2069 6620 746f 5f64           if to_d
+00031000: 6567 7265 6520 3a20 0d0a 2020 2020 2020  egree : ..      
+00031010: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+00031020: 6f62 6a20 3d6e 702e 6170 706c 795f 616c  obj =np.apply_al
+00031030: 6f6e 675f 6178 6973 2028 0d0a 2020 2020  ong_axis (..    
+00031040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031050: 6c61 6d62 6461 2078 3a20 7820 2a20 3138  lambda x: x * 18
+00031060: 302f 6e70 2e70 692c 2030 2c69 6e70 7574  0/np.pi, 0,input
+00031070: 5f6f 626a 290d 0a20 2020 2020 2020 2020  _obj)..         
+00031080: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00031090: 2072 6574 7572 6e20 696e 7075 745f 6f62   return input_ob
+000310a0: 6a20 0d0a 0d0a 2020 2020 2020 2020 7365  j ....        se
+000310b0: 6c66 2e5f 7350 6873 3d5f 696e 7370 6563  lf._sPhs=_inspec
+000310c0: 745f 696e 7075 7428 7365 6c66 2e5f 7350  t_input(self._sP
+000310d0: 6873 290d 0a0d 0a0d 0a20 2020 2020 2020  hs)......       
+000310e0: 2069 6620 7365 6c66 2e74 6f5f 6465 6772   if self.to_degr
+000310f0: 6565 203a 2023 2d2d 2d3e 2073 6574 2061  ee : #---> set a
+00031100: 6e67 6c65 2074 6f20 6465 6772 6565 202e  ngle to degree .
+00031110: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00031120: 6c66 2e5f 7350 6873 203d 5f69 6e73 7065  lf._sPhs =_inspe
+00031130: 6374 5f69 6e70 7574 2869 6e70 7574 5f6f  ct_input(input_o
+00031140: 626a 203d 7365 6c66 2e5f 7350 6873 2c20  bj =self._sPhs, 
+00031150: 746f 5f64 6567 7265 6520 3d54 7275 6529  to_degree =True)
+00031160: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00031170: 2020 0d0a 2020 2020 2020 2020 2320 2d2d    ..        # --
+00031180: 3e20 6368 6563 6b20 7468 6520 6d61 7869  > check the maxi
+00031190: 6d75 6d20 616e 676c 6520 7661 6c75 6520  mum angle value 
+000311a0: 616e 6420 6d69 6e69 6d75 6d20 616e 676c  and minimum angl
+000311b0: 6520 7661 6c75 652e 0d0a 2020 2020 2020  e value...      
+000311c0: 2020 7663 6f75 6e74 735f 7370 687a 2c20    vcounts_sphz, 
+000311d0: 7265 7065 6174 5f68 7068 7a3d 6e70 2e75  repeat_hphz=np.u
+000311e0: 6e69 7175 6520 2873 656c 662e 5f73 5068  nique (self._sPh
+000311f0: 732c 2072 6574 7572 6e5f 636f 756e 7473  s, return_counts
+00031200: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+00031210: 7365 6c66 2e76 616c 7565 203d 7663 6f75  self.value =vcou
+00031220: 6e74 735f 7370 687a 0d0a 2020 2020 2020  nts_sphz..      
+00031230: 2020 7365 6c66 2e6d 6178 2c20 7365 6c66    self.max, self
+00031240: 2e6d 696e 203d 7663 6f75 6e74 735f 7370  .min =vcounts_sp
+00031250: 687a 2e6d 6178 2829 2c20 7663 6f75 6e74  hz.max(), vcount
+00031260: 735f 7370 687a 2e6d 696e 2829 0d0a 2020  s_sphz.min()..  
+00031270: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00031280: 232d 2d2d 3e20 7475 6e63 6174 6564 2041  #---> tuncated A
+00031290: 5647 2073 4870 687a 2076 616c 7565 206f  VG sHphz value o
+000312a0: 6e20 2064 6963 7469 6f6e 6e61 7279 2066  n  dictionnary f
+000312b0: 6f72 2065 6173 7920 6163 6365 7320 2e20  or easy acces . 
+000312c0: 0d0a 2020 2020 2020 2020 7472 756e 6361  ..        trunca
+000312d0: 7465 645f 7370 687a 3d5a 6363 2e74 7275  ted_sphz=Zcc.tru
+000312e0: 6e63 6174 6564 5f64 6174 6128 2064 6174  ncated_data( dat
+000312f0: 6120 3d73 656c 662e 5f73 5068 732c 200d  a =self._sPhs, .
+00031300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031320: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+00031330: 665f 7265 6363 7572 656e 6365 3d73 656c  f_reccurence=sel
+00031340: 662e 6e66 7265 7129 0d0a 2020 2020 2020  f.nfreq)..      
+00031350: 2020 6e61 6d65 2c20 706f 6c79 6e61 6d65    name, polyname
+00031360: 203d 205a 6363 2e5f 6e75 6d62 6572 696e   = Zcc._numberin
+00031370: 675f 7374 6174 696f 6e28 0d0a 2020 2020  g_station(..    
+00031380: 2020 2020 2020 2020 6e75 6d62 6572 5f6f          number_o
+00031390: 665f 7374 6174 696f 6e3d 7365 6c66 2e6e  f_station=self.n
+000313a0: 756d 6265 725f 6f66 5f73 7461 7469 6f6e  umber_of_station
+000313b0: 732c 200d 0a20 2020 2020 2020 2020 2020  s, ..           
+000313c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000313d0: 2020 2020 6e75 6d62 6572 5f6f 665f 6672      number_of_fr
+000313e0: 6571 203d 7365 6c66 2e6e 6672 6571 290d  eq =self.nfreq).
+000313f0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00031400: 2020 2073 656c 662e 6c6f 6320 3d7b 206b     self.loc ={ k
+00031410: 6579 3a76 616c 7565 2066 6f72 206b 6579  ey:value for key
+00031420: 2c20 7661 6c75 6520 696e 207a 6970 286e  , value in zip(n
+00031430: 616d 652c 2074 7275 6e63 6174 6564 5f73  ame, truncated_s
+00031440: 7068 7a29 7d0d 0a20 2020 2020 2020 200d  phz)}..        .
+00031450: 0a20 2020 2020 2020 200d 0a0d 0a20 2020  .        ....   
+00031460: 2020 2020 200d 0a0d 0a0d 0a20 2020 200d       ......    .
+00031470: 0a0d 0a20 2020 200d 0a20 2020 200d 0a20  ...    ..    .. 
+00031480: 2020 200d 0a20 2020 200d 0a20 2020 2020     ..    ..     
+00031490: 2020 200d 0a20 2020 200d 0a0d 0a            ..    ....
```

### Comparing `pycsamt-1.1.2/pycsamt/ff/core/cs.py` & `pycsamt-1.2.1/pycsamt/core/cs.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,44 +1,53 @@
 # -*- coding: utf-8 -*-
 #       Created on Wed Dec  2 11:29:32 2020
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
 #       Licence: LGPL
 """
-.. _module-cs:: `pycsamt.ff.core.cs` 
+.. _module-cs:: `pycsamt.core.cs` 
     
    :synopsis: Super class or CSAMT Far Field implementation 
                Deal with AVG file and EDI files 
 """
 
 import os 
 import warnings
 import datetime
 import numpy as np
 
-import pycsamt.ff.core.avg as CSAMTavg 
-import pycsamt.ff.core.edi as CSAMTedi 
-import pycsamt.ff.core.z as CSAMTz 
+import pycsamt.core.avg as CSAMTavg 
+import pycsamt.core.edi as CSAMTedi 
+import pycsamt.core.z as CSAMTz 
 import pycsamt.utils.zcalculator as Zcc
 from pycsamt.utils import _p as inFO
-from  pycsamt.ff.core import j as CSAMTj 
-from pycsamt.ff.site import (Site, Location, Profile) 
-from pycsamt.utils import exceptions as CSex
+from pycsamt.core import j as CSAMTj 
+from pycsamt.site import (
+    Site, 
+    Location, 
+    Profile
+ ) 
 from pycsamt.utils import func_utils as func
-from pycsamt.utils._csamtpylog import csamtpylog
-_logger = csamtpylog.get_csamtpy_logger(__name__)
-
+from pycsamt.utils.exceptions import ( 
+    ProcessingError, 
+    JError, 
+    AVGError, 
+    FileHanglingError
+)
+from pycsamt._csamtpylog import csamtpylog
 try : 
     from pycsamt.__init__ import itqdm 
     if itqdm : 
         import tqdm
     else:
         itqdm = False # for consistency  
     
 except: pass
- 
+
+_logger = csamtpylog.get_csamtpy_logger(__name__)
+
 class CSAMT(object): 
     """
      CSAMT class is a class container of all the information of the 
      other classes,J, Avg and Edi. In fact, the CS object collect all 
      the information of the other classes for specific uses.
      Objet CSAMT can recognize the typical input obj of file and 
      set attributes for use . 
@@ -84,14 +93,27 @@
     zyx                 dict                impedanceTensor  at each station 
                                              from xy
     zyx_err             dict                imped. Tensor error  at each
                                             station from yx
     freq                ndarray,1           frequency array from survey   
     verbose             int                 control the level of verbosity. 
                                             Higher more messages. Default is 0.
+    component           str                 Given component to read and populate 
+                                            attributes. Can be `xy`, `yx`, 
+                                            `xx` and `yy`. Default is `xy` 
+    sort_edi_along      str                 Value to sort edi files. Default  
+                                            sort i in alphabetic order. If edi 
+                                            is composed of station name and 
+                                            digit, `sort_edi_along` with force 
+                                            the sort to be only on the digit. 
+                                            For instance "new_E1_97.edi" file 
+                                            can be sorted efficiently by given 
+                                            to the param `sort_edi_along` to 
+                                            ``'new_E1_'`` which correspond to 
+                                            the edi prefix before the digit `97`. 
     =================  ===================  ===================================
 
     ===========================  ==============================================
     Methods                         Description 
     ===========================  ==============================================
     _read_csamt_objs                read in CSAMT file [EDI|AVG|J]
     _read_edi_obj                   read_edi_obj and set attributes 
@@ -99,15 +121,15 @@
     _read_j_obj                     read A.G. Jones file and set attributes.
     avg2edi                         convert AVG to EDI files 
     j2edi                           convert J to EDI files
     ===========================  ==============================================
      
     :Example:
         
-        >>> from pycsamt.ff.core.cs import CSAMT
+        >>> from pycsamt.core.cs import CSAMT
         >>> profile_stn='K1.stn'
         >>> for ii in ['csi000.dat', 'testemap3.edi', 'K1.AVG']:
         >>> path =  os.path.join(os.environ["pyCSAMT"], 
         ...                  'pycsamt','data', ii)
         >>> csamt_obj = CSAMT(fn = path, 
         ...                      profile_fn= os.path.join(
         ...                          os.path.dirname(path), file_stn))
@@ -116,15 +138,14 @@
         ... print(csamt_obj.phase_err['S00'])
     """
     
     def __init__(self, data_fn=None , profile_fn = None , **kwargs): 
         
         self._logging =csamtpylog.get_csamtpy_logger(self.__class__.__name__)
         
-        
         self.Site =Site()
         self.Location =Location()
         self.Profile =Profile()
    
         self._z_xy = None 
         self._z_yx =None
         self._z_err =None
@@ -139,14 +160,16 @@
         
         self._fn = data_fn 
         
         self._pfn =profile_fn
         self._fpath =None 
         
         self.save_path = kwargs.pop('savepath', None)
+        ### ADD component attributes 
+        self.component = kwargs.pop('component', 'xy')
         self.verbose =kwargs.pop('verbose', 0)
         
         for key  in list(kwargs.keys()): 
             setattr(self, key, kwargs[key])
         
         if self._fn is not None or self._fpath  is not None: 
             self._read_csamt_objs()
@@ -229,15 +252,15 @@
      
         if self.fpath not in ('edipath','jpath','j','edi','avg'):
             warnings.warn(
                 'Currently pyCSAMT works with "edi", "j" and "avg" file. '
                  'Please provide one amomg them.')
             self._logging.warn('It seems file provided <%s> does not match '
                                '"edi" nor "avg" nor "j" file.' % self._fn)
-            raise CSex.pyCSAMTError_file_handling(
+            raise FileHanglingError(
                 f"Unable to read {self._fn!r}. Only 'edi', 'j' and 'avg' "
                 " formats can be parsed. Please check your path|file." )
             
         if self.fpath == 'avg': 
             self._read_avg_obj(avgfile = self._fn)
                     
         elif self.fpath in ('edipath','edi') :
@@ -255,68 +278,101 @@
                         where edifiles are located . 
         :type edi_fn: str 
             
         1. Read single edifile
         
         :Example:
   
-            >>> from pycsamt.ff.core.cs import CSAMT 
+            >>> from pycsamt.core.cs import CSAMT 
             >>> path = os.path.join(os.environ['pyCSAMT'], 
             ...                        'data', 'edi')
             >>> csamt_obj = CSAMT(
                 data_fn = os.path.join(path,'csi000.dat')
                 )
             ... print(csamt_obj.resistivity['S00'])
             ... print(csamt_obj.lat)
             ... print(csamt_obj.freq)
                 
         2. Read read multiple edifiles  
          
         :Example:
       
-            >>> from pycsamt.ff.core.cs import CSAMT 
+            >>> from pycsamt.core.cs import CSAMT 
             >>> csamt_obj = CSAMT( data_fn = edipath )
             ... print(csamt_obj.resistivity['S05'])
             ... print(csamt_obj.resistivity_err['S00'])
         """
         
         self._logging.info("Reading <%s> edifile from edi_obj "% edi_fn)
          
         if edi_fn is not None :
             self._fn =edi_fn
         
         # if self._fn is not None : 
-        if self.fpath  =='edipath': #---> set the path then collect all jfiles .
-        
+            #---> set the path then collect all jfiles .
+        if self.fpath  =='edipath': 
+            eddfiles  = sorted(os.listdir(self._fn)) 
             edifiles =[os.path.join(self._fn, eddfile) for
-                       eddfile in os.listdir(self._fn) 
+                       eddfile in eddfiles 
                        if eddfile.endswith('.edi')]
-        
         # if edifile is not None : self._fn =edifile 
         #-- > once only edifile is provided then put on list ...
         elif self.fpath  == 'edi' : 
             edifiles =[self._fn]
-  
-        edi_obj = CSAMTedi.Edi_collection(list_of_edifiles =edifiles)
-
+            
+        # read the collectoions with ediObjs
+        edi_obj = CSAMTedi.Edi_collection(list_of_edifiles= edifiles )# ediObjs = ediObjs)
+        self.edinames = edi_obj.edinames 
+        
         self._logging.info ('Compute Z impedance Tensor  and '
                             'set attributes. _ Func '
                             '<%s>'%self._read_edi_obj.__name__)
         
-        self._res = edi_obj.res_xy 
-        self._res_err = edi_obj.res_err_xy
-        
-        self._phs_err =edi_obj.phs_err_xy
-        self._phs = edi_obj.phs_xy
-        
+        self.component = str(self.component).lower() 
+        if self.component not in ('xx', 'yy', 'xy', 'yx'): 
+            warnings.warn(f"Component {self.component} is wrong. Shoud be "
+                          f"{func.smart_format(['xx', 'yy', 'xy', 'yx'])}."
+                          " Default is `xy`")
+            self.component ='xy'
+            
+        #################
+        self._res_xy= edi_obj.res_xy 
+        self._res_err_xy  = edi_obj.res_err_xy
+        self._phs_err_xy =edi_obj.phs_err_xy
+        self._phs_xy= edi_obj.phs_xy
         self._z_xy =edi_obj.z_xy 
+        self._z_err_xy =edi_obj.z_err_xy
+            
+        self._res_yx = edi_obj.res_yx 
+        self._res_err_yx= edi_obj.res_err_yx
+        self._phs_err_yx=edi_obj.phs_err_yx
+        self._phs_yx= edi_obj.phs_yx
         self._z_yx =edi_obj.z_yx
-        self.z_err_xy =edi_obj.z_err_xy
-        self.z_err_yx =edi_obj.z_err_yx
-        
+        self._z_err_yx =edi_obj.z_err_yx
+
+        self._res_xx= edi_obj.res_xx 
+        self._res_err_xx= edi_obj.res_err_xx
+        self._phs_err_xx=edi_obj.phs_err_xx
+        self._phs_xx= edi_obj.phs_xx
+        self._z_xx =edi_obj.z_xx 
+        self._z_err_xx =edi_obj.z_err_xx
+
+        self._res_yy= edi_obj.res_yy 
+        self._res_err_yy= edi_obj.res_err_yy
+        self._phs_err_yy =edi_obj.phs_err_yy
+        self._phs_yy= edi_obj.phs_yy
+        self._z_yy=edi_obj.z_yy
+        self._z_err_yy =edi_obj.z_err_yy
+    
+        # selected the needeed components  
+        for attr in ('res', 'res_err', 'phs', 'phs_err', 'z', 'z_err'): 
+            setattr(self, f'_{attr}', 
+                    getattr(self, f'_{attr}_{self.component}')
+                    )
+            
         self._freq = edi_obj.freq_array
         
     
         self.lat =edi_obj.latitude
         self.lon= edi_obj.longitude
     
         self.Location.convert_location_2_utm(latitude =self.lat, 
@@ -337,29 +393,29 @@
                     or full path to all jfiles .
         :type j_fn: str
   
         1.  read single jfile 
         
         :Example: 
  
-            >>> from pycsamt.ff.core.cs import CSAMT 
+            >>> from pycsamt.core.cs import CSAMT 
             >>> path = os.path.join(os.environ['pyCSAMT'], 
                                'data', 'j')
             >>> csamt_obj = CSAMT(
                 fn = os.path.join(data_fn,
                                   'csi000.dat'))
             ... print(csamt_obj.resistivity['S00'])
             ... print(csamt_obj.lat)
             ... print(csamt_obj.freq)
              
         2. Read multiple files 
 
         :Example:
                      
-            >>> from pycsamt.ff.core.cs import CSAMT 
+            >>> from pycsamt.core.cs import CSAMT 
             >>> csamt_obj = CSAMT( data_fn = path )
             ... print(csamt_obj.resistivity['S05'])
             ... print(csamt_obj.lat)
         """
         self._logging.info("Reading <%s> edifile from edi_obj "% j_fn)
         
         if j_fn is not None : self._fn =j_fn 
@@ -411,15 +467,15 @@
         # set attributes accordingly -----
         #--> build Z_obj
         
         self._logging.info (
             'Compute Z impedance Tensor ''and set attributes.'
             ' _ Func <%s>'%self._read_j_obj.__name__)
         
-        self._z_err_xy,  self._z_xy,   self._z_yx = [{} for ii in range(3)]
+        self._z_err,  self._z,   self._z_yx = [{} for ii in range(3)]
         csamt_z_obj =CSAMTz.Z()
         for stn, values in self._res.items(): 
             # csamt_obj =  CSAMTz.Z()
             phs_array , phs_err_array = np.zeros ((self._freq.size, 2, 2),
                                                   dtype =np.float),  np.zeros (
                                                       (self._freq.size, 2, 2), 
                                                       dtype= np.float)
@@ -435,16 +491,16 @@
             
             csamt_z_obj.set_res_phase( res_array =res_array ,
                                       phase_array = phs_array,  
                                       freq=self._freq, 
                                       res_err_array= res_err_array, 
                                       phase_err_array= phs_err_array)
                                   
-            self._z_err_xy [stn] = csamt_z_obj.z_err [:, 0, 1]
-            self._z_xy [stn] = csamt_z_obj.z [:, 0, 1]
+            self._z_err [stn] = csamt_z_obj.z_err [:, 0, 1]
+            self._z[stn] = csamt_z_obj.z [:, 0, 1]
             self._z_yx [stn] = csamt_z_obj.z[:, 1, 0]
         
         
         func.make_introspection(self , j_obj)
       
     def _read_avg_obj (self, avgfile=None, **kwargs) : 
         """
@@ -453,15 +509,15 @@
         :param avgfile: full path to avg file
         :type avgfile: str 
                 
         :Example:  
             
             >>> path =  os.path.join(os.environ["pyCSAMT"], 
                               'pycsamt','data', file_stn)
-            >>> from csampty.ff.core.cs import CSAMT
+            >>> from csampty.core.cs import CSAMT
             >>> csamt_obj = CSAMT(fn = os.path.join(
                 os.path.dirname(path), file_1), profile_fn= path)
             ... print(csamt_obj.resistivity)
             ... print(csamt_obj.phase)
             ... print(csamt_obj.resistivity_err)
         """
         profile_fn = kwargs.pop('profile_fn', None)
@@ -521,15 +577,15 @@
         
         # self._freq = avg_obj.Data_section.Frequency.loc 
         self._freq=avg_obj.Data_section.Frequency.value 
         self._phs_err = {stn : (180 * sphz_value) /100 * (1e-3/ np.pi) 
                          for stn , sphz_value  in  std_phase_obj.items()}
         
         #--> build Z_obj 
-        self._z_err_xy,  self._z_xy,   self._z_yx = [{} for ii in range(3)]
+        self._z_err,  self._z,   self._z_yx = [{} for ii in range(3)]
         csamt_z_obj =CSAMTz.Z()
         for stn, values in self._res.items(): 
             # csamt_obj =  CSAMTz.Z()
             phs_array , phs_err_array = np.zeros ((self._freq.size, 2, 2),
                                                   dtype =np.float),  np.zeros (
                                                       (self._freq.size, 2, 2), 
                                                       dtype= np.float)
@@ -545,16 +601,16 @@
             
             csamt_z_obj.set_res_phase( res_array =res_array ,
                                       phase_array = phs_array,  
                                       freq=self._freq, 
                                       res_err_array= res_err_array, 
                                       phase_err_array= phs_err_array)
                                   
-            self._z_err_xy [stn] = csamt_z_obj.z_err [:, 0, 1]
-            self._z_xy [stn] = csamt_z_obj.z [:, 0, 1]
+            self._z_err [stn] = csamt_z_obj.z_err [:, 0, 1]
+            self._z [stn] = csamt_z_obj.z [:, 0, 1]
             self._z_yx [stn] = csamt_z_obj.z[:, 1, 0]
         
         #---> set coordinates attributes 
         if self._pfn  is not None: 
         # self.north= profile_obj.north
             self.north = self.Profile.north
             # self.east =profile_obj.east 
@@ -583,43 +639,48 @@
         return self._res 
     
     @property 
     def phase (self): 
         return {stn: value %90 for stn , value in self._phs.items()} 
     
     @property 
-    def zxy (self): 
-        return self._z_xy 
+    def z(self): 
+        return self._z 
     
-    @property 
-    def zyx (self): 
-        return self._z_yx 
+    # @property 
+    # def zyx (self): 
+    #     return self._z_yx 
     
     @property 
     def resistivity_err (self): 
         return self._res_err 
         
-        
     @property 
     def phase_err (self): 
         return self._phs_err 
     
     @property 
     def z_err (self): 
-        return self._z_err_xy 
+        return self._z_err
+    @z_err.setter 
+    def z_err (self, zerr): 
+        self._z_err = zerr 
+        
     
     @property 
     def dipolelength (self): 
         return self.Profile.compute_dipolelength_from_coords(
             easting =self.east, 
             northing =self.north)[0]
     @property 
     def skindepth (self): 
-        return {stn: 503 * np.sqrt( self.resistivity [stn]/ self.freq) 
-                for stn in self.resistivity}
+        ress = func.resize_resphase_values(
+            self.resistivity,c = self.freq, return_array= False) 
+        return {stn: 503 * np.sqrt(ress [stn]/ self.freq) 
+                for stn in self.resistivity} 
     @property 
     def doi (self): 
         return {stn :  2 ** 0.5 * self.skindepth[stn] 
                 for stn in self.skindepth }
     
     @property 
     def station_distance (self): 
@@ -683,15 +744,15 @@
         :type list_of_files: str  
 
         :rtype: str
         :returns: edifiles from Jobjects
         
         :Example:
             
-            >>> from pycsamt.ff.core.j import J_collection as JObjs
+            >>> from pycsamt.core.j import J_collection as JObjs
             >>> path2j = 'data/j' 
             >>> jObjs= JObjs().j2edi(path2j)
             
         """
         prospect =kwargs.pop('contractor_name', None)
         #hardwareInfos = kwargs.pop('hardware_name', None)
         fileby =kwargs.pop('fileby', 'jediSoftware')
@@ -705,15 +766,15 @@
             self._fn =data_fn 
 
         if self._fn is not None:
             self._read_j_obj(j_fn =self._fn, jpath = self.fpath)
             # self.jfiles_list = jfn
 
         if self.jfiles_list is None : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'No files found !  Please provide A.G. J-files ')
         # export to savepath 
         if savepath is not None: 
             self.save_path =savepath 
         # create a folder in your current work directory 
         self.save_path =func.cpath(self.save_path, '_outputJ2EDI_')
     
@@ -942,39 +1003,39 @@
         number_of_skin_depth   float        number of skin_depth can be 1 to 10
                                             when using filter AMA. 
                                             *Default* is 3.
         ====================  ==========  =====================================
                                      
         :Example:   
             
-            >>> from pycsamt.ff.core import avg 
+            >>> from pycsamt.core import avg 
             >>> avg_obj= avg.Avg()
             >>> avg_obj.avg_to_edifile(data_fn= os.path.join(
             ...    path_to_avgfile, avgfile) , 
             ...           profile_fn = os.path.join(
             ...    path_to_avgfile, station_profile_file), 
             ...           savepath =save_edipath, 
             ...           apply_filter=None ) 
         """
 
         #######################################################################
-        from pycsamt.ff.processing import corr 
+        from pycsamt.processing import corr 
         #######################################################################
 
         utm_zone = kwargs.pop('utm_zone', None)
         verbose = kwargs.pop('verbose', None)
         if verbose is not None: 
             self.verbose =verbose 
         if self.verbose is None: 
             self.verbose =0
         
         if data_fn is not None : 
             self._fn = data_fn 
         if self._fn is None : 
-            raise CSex.pyCSAMTError_avg_file(
+            raise AVGError(
                 "Could not find any path to read ."
                 "Please provide your right AVG file.")
         
         
         # export to savepath
         if savepath is not None: 
             self.save_path =savepath 
@@ -1125,15 +1186,15 @@
      
             elif apply_filter is not None and apply_filter  not in ['tma, ama, flma']: 
                 warnings.warn('filter %s provided is UNrecognizing.'
                               ' Pogram worsk currently with : TMA or FLMA ,'
                               ' Please provided the right filters'
                               ' for computing.'% apply_filter)
                                   
-                raise CSex.pyCSAMTError_processing(
+                raise ProcessingError(
                     'Filters provided is not acceptable.'
                     ' Recognized filters are "TMA","AMA" AND "FLMA"')
         
         if apply_filter is None : 
             if self.Header.HardwareInfos.numfilterfreq is None\
                 and self.Header.HardwareInfos.freq_filter is None :
                  avgfilter, descritipfilter = '', ""
```

### Comparing `pycsamt-1.1.2/pycsamt/ff/core/edi.py` & `pycsamt-1.2.1/pycsamt/core/edi.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,45 +1,69 @@
 # -*- coding: utf-8 -*-
 #       Created on Mon Jan 11 11:37:51 2021
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
-#       Licence: LGPL
+#       Licence: GPL
 """
-.. _module-edi:: `pycsamt.ff.core.edi`
-   :synopsis: EDI module can read and write an .edi file as the 'standard '
-             formatof magnetotellurics. Each sectionof the .edi file is given 
-             its own class, so the elements of each section are attributes for 
-             easy access.Edi file will write following the SEG document
-             instructions of  EMAP (Electromagnetic  Array Profiling)
-             ...
+Module EDI 
+==========
+
+EDI stands for Electrical Data Interchange module can read and write an *.edi 
+file as the 'standard ' format of magnetotellurics. Each section of the .edi 
+file belongs to a class object, thus the elements of each section are attributes 
+for easy access. Edi is outputted  following the SEG documentation and rules  
+of EMAP (Electromagnetic  Array Profiling) and MT sections. 
+
+References 
+----------
+.. [1] Wight, D.E., Drive, B., 1988. MT/EMAP Data Interchange Standard, 1rt ed.
+     Society of Exploration Geophysicists, Texas 7831, USA.
+             
 """
+from __future__ import annotations 
 import os
 import re
 import warnings
 import datetime
 import shutil
 import time
 import numpy as np 
 
+import pycsamt
+from pycsamt.__init__ import imtpy  
 import pycsamt.utils.func_utils as func
-import pycsamt.ff.core.z as MTz
+import pycsamt.core.z as MTz
 from pycsamt.utils. _p import suit 
-from pycsamt.ff.site import  Location
+from pycsamt.site import  Location
 from pycsamt.utils. _p import _sensitive as SB 
 from pycsamt.utils import gis_tools as gis 
-from pycsamt.utils import exceptions as CSex
-from pycsamt.utils._csamtpylog import csamtpylog
-
+from pycsamt.utils.exceptions import ( 
+	EDIError, 
+	HeaderError 
+	)
+from pycsamt._csamtpylog import csamtpylog
+
+if imtpy:
+    import mtpy
+else:
+    warnings.warn("Module 'MTpy' is not detected! Install it mannualy.")
+    imtpy = False
+    
+    
 _logger = csamtpylog.get_csamtpy_logger(__name__)
 
+    
 
 class Edi_collection : 
     """
-    Super class to deal with Edifiles .Collect edifiles and set important 
-    properties form Controled Source audiofrequency magnetotelluRic  ,
-   two(2) components XY and YX will be set and calculated .
+    Collection class to deal with Edifiles.
+    
+    Collect edifiles and set important properties from audio magnetotelluric,
+    two(2) components XY and YX will be set and calculated. Can read MT data 
+    instead, However the full handling transfer function like Tipper and Spectra
+    is not completed. Use `MTpy`_ or other MT softwares for a long periods data. 
     
     Arguments 
     ---------
         **list_of_edifiles** : list 
                     list of edifiles
         **edipath** : str 
                     path to edifiles. If no listis provided ,
@@ -83,88 +107,54 @@
                                             from 2 comps xy|yx 
                                             XX : res|phs|z  stn : name of 
                                             site eg stn :S00, S01 , .., Snn
     =====================  ===============  ===================================
     
     :Example: 
         
-       >>> from pycsamt.ff.core.edi import Edi_collection 
+       >>> from pycsamt.core.edi import Edi_collection 
        >>> edilist = [os.path.join(path, edi)for edi in os.listdir 
                       (path) if edi.endswith('.edi')]
        ... edi_objs = Edi_collection(list_of_edifiles = edilist)
        ... print(edi_objs.res_xy['S01'])
        ... print(edi_objs.phs_err_xy['S00'])
        ... print(edi_objs.z_err_xy['S00'])
+       
+       
     """
-    
-    def __init__(self, list_of_edifiles =None, edipath =None , 
-                 survey_name =None ): 
+    _keys = ['_latitude',
+            '_longitude', 
+            '_azimuth', 
+            '_elevation', 
+            '_station_names',
+            '_z', 
+            '_z_err',
+            '_z_det',
+            '_res',
+            '_res_err',
+            '_res_det',
+            '_phs',
+            '_phs_det',
+            '_phs_det_err'
+                  ] 
+        
+    def __init__(self, list_of_edifiles=None, ediObjs =None, survey_name =None ): 
         self._logging= csamtpylog.get_csamtpy_logger(self.__class__.__name__)
         self.edifiles =list_of_edifiles
-        self.survey_name =survey_name
-        self.Edi =Edi()
+        self.ediObjs = ediObjs 
         self.Location =Location ()
+        self.survey_name =survey_name
         
-        self.freq_array = None 
-        
-        if self.edifiles is None and edipath is not None : 
-            self._logging.info (
-                'Getting edifiles from edipath <%s>'% edipath )
-            
-            if os.path.isfile(edipath) is True : 
-                if edipath.endswith('.edi') is True : 
-                    self.edifiles =[edipath] 
-            else:
-                try :os.path.isdir(edipath)
-                except :raise CSex.pyCSAMTError_EDI(
-                        'Wrong Path, Does not exist,'
-                        ' Please provided right path !')
-                else :
-                    self.edifiles = [os.path.join(edipath , ediobj)
-                                     for ediobj in os.listdir(edipath)
-                                  if ediobj.endswith('.edi') ]
-        if len(self.edifiles ) < 1 : 
-            warnings.warn(
-                'No edifiles found in the path provided <%s>.'
-                ' Iseems the edipath does not match'
-                ' the right edipath.'% edipath)
-            raise CSex.pyCSAMTError_EDI(
-                'No edifiles detected. Please provided the right path.')
-        else :
-            self._logging.info (
-                'Number of edifiles found are <%s>'%len(self.edifiles))
-        
-        if self.edifiles is None and edipath is None : 
-            warnings.warn (
-                'May provided a least alist of edifiles or edipath '
-                'where edifiles are located.None value cannot be computed'
-                ' .Please check your path or your edilist. ')
-            self._logging.warning(
-                'May provided a least alist of edifiles or edipath'
-                ' where edifiles are located.None value cannot be computed.'
-                  ' Please get check your path or your edilist. ')
-            raise CSex.pyCSAMTError_EDI(
-                'Empty list and wrong edipath can not be read. '
-                'Please provided either the list of edifiles '
-                 'or the right edipath. None value can not be computed.')
-                
-        #---> construction of georeference attributes : 
-        for _key in ['_latitude', '_longitude', '_azimuth', 
-                     '_elevation', 'station_names']: 
-            self.__setattr__(_key, None )
-
-        # construction of impedances , resistivities and
-        #phasetensor attributes and set all to None value.
-        for tensor  in ['_z', '_z_err', '_z_det','_res', '_res_err',
-                        '_res_det','_phs', '_phs_det', '_phs_det_err'
-                         ] :  self.__setattr__( tensor, None) 
-                                 
-        if self.edifiles is not None : 
+        #---> inititalize key attributes :
+        for k in self._keys: 
+            self.__setattr__(k, None )
+
+        if (self.edifiles is not None ) or (self.ediObjs is not None)  : 
             self._collect_edifiles()
-        
+
     @property 
     def latitude(self): 
         return self.Location.latitude
     @latitude.setter 
     def latitude(self, latitude): 
         self.Location.latitude = latitude
         
@@ -183,192 +173,498 @@
         self.Location.elevation =elevation
         
     @property 
     def stnames(self):
         return self._station_names
     @stnames.setter 
     def stnames (self, edi_stations):
-        if isinstance(edi_stations, np.ndarray ) :
-            edi_stations = edi_stations.tolist()
-        if isinstance(edi_stations, list) :
-            if len(self.edifiles) != len(edi_stations): 
-                self._station_names =self.id  # use station id to work 
-            else :self._station_names =edi_stations
+        try : func._assert_all_types(edi_stations, list, tuple, np.ndarray)
+        except : self._station_names = self.id_ 
+        else : self._station_names = list(map(lambda n: n.replace('.edi', ''), 
+                                       edi_stations))
+        if len(set (self._station_names)) ==1 : 
+            self._station_names = self.id 
             
+        if len(self._station_names) != len(self.ediObjs): 
+            self._station_names = self.id  
+        
+ 
       
-    def _collect_edifiles(self, edifiles_list =None,
-                          ediobjs =None, edipath =None ):
+    def _collect_edifiles(self, list_of_edifiles =None, *,  ediObjs =None):
         """
         collect edifiles and set appropriates attributes for each stations. 
 
-        :param edifiles_list: list of edifiles
-        :param edifiles_list: list 
+        :param list_of_edifiles: list of edifiles
+        :type list_of_edifiles: list 
         
-        :param ediobjs:  can provided from  class built.
-        :param ediobjs: obj 
+        :param ediObjs:  can provided from  class built.
+        :type ediObjs: pycsamt.core.edi.Edi
+
         
         :Example: 
             
-            >>> from pycsamt.ff.core.edi import Edi_collection 
+            >>> from pycsamt.core.edi import Edi_collection 
             >>> path =r'F:\__main__csamt__\paper2_data_old\
                 data_edifiles - numStations\K1_edi\new_EDI'
             >>> edilist = [os.path.join(path, edi)for
             ...               edi in os.listdir (path) 
             ...               if edi.endswith('.edi')]
             ... edi_objs = Edi_collection._collect_edifiles(
                 list_of_edifiles = edilist)
             ... print(edi_objs.phs_xy['S01'])
             ... print(edi_objs.freq_array)
             
         """
+        def _fetch_headinfos (cobj,  attr): 
+            """ Set attribute `attr` from collection object `cobj`."""
+            return list(map (lambda o: getattr(o, attr), cobj))
+        
         self._logging.info (
             'Collectiong edilfiles from <%s>'% self.__class__.__name__)
         
-        if edifiles_list is not None : 
-            self.edifiles = edifiles_list
-        if self.edifiles is None and ediobjs is None  : 
-            raise CSex.pyCSAMTError_EDI(
-                'No edifiles found to read.Please check your right path ')
-        
-        self._logging.debug('Building EDI object from edi files.') 
-        if self.edifiles is not None : 
-            if isinstance(self.edifiles , str):
-                self.edifiles = [self.edifiles]
-            self.edifiles=sorted (self.edifiles)
-            self.edi_obj_list = [Edi(edi_filename= ediobj) 
-                                 for  ediobj in self.edifiles ]
-            
-        elif ediobjs is not None : 
-            self.edi_obj_list= list(ediobjs)
-            
-        assert len(self.edi_obj_list) > 0 , CSex.pyCSAMTError_EDI(
-            "Can't read none value. Provided at least one edifile!")
-            
-        self._logging.info (
-            'Running list of <%s> edifiles'% len(self.edifiles))
+        rfiles =[] # count number of reading files.
+        #--------------------------------------
+        if list_of_edifiles is not None: 
+            self.edifiles = list_of_edifiles   
+        if ediObjs is not None: 
+            self.ediObjs = ediObjs 
+            
+        if isinstance(self.edifiles, str): 
+            # single edi and get the path 
+            if os.path.isfile (self.edifiles): 
+                edipath = os.path.dirname (self.edifiles) 
+            elif os.path.dirname (self.edifiles): 
+                # path is given and read  
+                edipath = self.edifiles
+            else : raise EDIError(
+                f"Path to {self.edifiles!r} is wrong!")
+                
+            rfiles = os.listdir (edipath)
+            self.edifiles= sorted ([ os.path.join(edipath, edi ) 
+                               for edi in rfiles if edi.endswith ('.edi')])  
+            
+        elif isinstance(self.edifiles, (tuple, list)): 
+            self.edifiles= sorted(self.edifiles)
+            rfiles = self.edifiles.copy() 
+
+        if self.edifiles is not None:
+            try :
+                self.ediObjs = list(map(
+                    lambda o: _assert_edi_obj(o), self.edifiles)) 
+            except TypeError : 
+                # in the case a single object is given at the param
+                # the list-of edifiles rather than ediObjs 
+                self.ediObjs = list(map(
+                    lambda o: _assert_edi_obj(o), [self.edifiles])) 
+                
+        # for consistency 
+        if self.ediObjs is not None:
+            if not isinstance (self.ediObjs,(list,tuple, np.ndarray)): 
+                 self.ediObjs = [self.ediObjs]
+        
+            rfiles = self.ediObjs
+                
+            try:
+                self.ediObjs = list(map(
+                    lambda o: _assert_edi_obj(o), self.ediObjs)) 
+            except EDIError: 
+                raise ValueError ("Expect a list of EDI objects not "
+                                  f"{type(self.ediObjs[0]).__name__!r}")
+            
+                
+        if self.ediObjs is None: 
+            raise EDIError("None EDI object detected!")
+            
+        # sorted ediObjs from latlong  
+        self.ediObjs , self.edinames = func.fit_by_ll(self.ediObjs)
+        # reorganize  edis in lon lat order. 
+        self.edifiles = list(map(lambda o: o.edifile , self.ediObjs))
+
         try:
-            func.show_quick_edi_stats(self.edifiles, self.edi_obj_list)
+            func.show_quick_edi_stats(rfiles, self.ediObjs)
         except: pass 
-
-        sta , lat,lon, elev , freq , zz, zz_err, rho,\
-            rho_err, phs , phs_err =[[] for ii in range (11)]
-            
-        #--> set gereference attributes 
-        for  edi_obj in self.edi_obj_list : 
-            sta.append(edi_obj.Head.dataid ) 
-            if edi_obj.Head.long is None : 
-                edi_obj.Head.long= edi_obj.DefineMeasurement.reflong 
-                self._logging.info (
-                    'Longitude of Headid <{0}> has'
-                    ' been set from Edi.DefineMeasurenement'.
-                        format(edi_obj.Head.dataid))
-                
-            lon.append(edi_obj.Head.long)
-            
-            if edi_obj.Head.lat is None : 
-                edi_obj.Head.lat= edi_obj.DefineMeasurement.reflat 
-                self._logging.info ('Latitude of Headid <{0}> has been '
-                                    'set from Edi.DefineMeasurenement'.\
-                                        format(edi_obj.Head.dataid))
-            lat.append(edi_obj.Head.lat)
-            if edi_obj.Head.elev is None : 
-                edi_obj.Head.elev = edi_obj.DefineMeasurement.refelev 
-                self._logging.info('Elevation of Headid <{0}> has been '
-                                   'set from Edi.DefineMeasurenement'.\
-                                       format(edi_obj.Head.dataid))
-            elev.append(edi_obj.Head.elev)
-            freq.append(edi_obj.Z.freq) 
-            
-        # ---> get impednaces , phase tensor and
-        # resistivities values form ediobject
-        self._logging.debug('Setting impedances tensor , phases tensor and '
-                            ' resisvitivities values from ediobjs.')
         
-        zz= [edi_obj.Z.z for edi_obj in self.edi_obj_list]
-        zz_err= [edi_obj.Z.z_err for edi_obj in self.edi_obj_list]
-
-        rho= [edi_obj.Z.resistivity for edi_obj in self.edi_obj_list]
-        rho_err= [edi_obj.Z.resistivity_err for edi_obj in self.edi_obj_list]
-
-        phs= [edi_obj.Z.phase for edi_obj in self.edi_obj_list]
-        phs_err= [edi_obj.Z.phase_err for edi_obj in self.edi_obj_list]
-
-         #---> set attribute on dictionnary 
-        self.id = ['S{0:02}'.format(ii) for ii in range(len(self.edifiles))]
-        self.longitude, self.latitude, self.elevation = lon , lat, elev
+        #-----get coordinates values and correct lon_lat ------------------
+        lat  = _fetch_headinfos(self.ediObjs, 'lat')
+        lon  = _fetch_headinfos(self.ediObjs, 'lon')
+        elev = _fetch_headinfos(self.ediObjs, 'elev')
+        lon,*_ = func.scale_position(lon) if len(self.ediObjs)> 1 else lon 
+        lat,*_ = func.scale_position(lat) if len(self.ediObjs)> 1 else lat
+        # ---> get impednaces, phase tensor and
+        # resistivities values form ediobject
+        self._logging.info('Setting impedances and phases tensors and'
+                           'resisvitivity values from a collection ediobj.')
+        zz= [edi_obj.Z.z for edi_obj in self.ediObjs]
+        zz_err= [edi_obj.Z.z_err for edi_obj in self.ediObjs]
+
+        rho= [edi_obj.Z.resistivity for edi_obj in self.ediObjs]
+        rho_err= [edi_obj.Z.resistivity_err for edi_obj in self.ediObjs]
+
+        phs= [edi_obj.Z.phase for edi_obj in self.ediObjs]
+        phs_err= [edi_obj.Z.phase_err for edi_obj in self.ediObjs]
+        
+        # Create the station ids 
+        self.id = func.make_ids(self.ediObjs, prefix='S')
+    
+        self.longitude= lon 
+        self.latitude= lat  
+        self.elevation= elev
         
         # get frequency array from the first value of edifiles.
-        self.freq_array = freq[0] 
+        self.freq_array = self.ediObjs[0].Z.freq
 
         #---> set ino dictionnary the impdance and phase Tensor 
-        self._logging.debug('Setting impedances, resistivities and'
-                            ' phase tensors into dictionnaries.')
-        
         self._z = {key:value for key , value in zip (self.id, zz)}
         self._z_err ={key:value for key , value in zip (self.id, zz_err)}
 
         self._res = {key:value for key , value in zip (self.id, rho)} 
         self._res_err ={key:value for key , value in zip (self.id, rho_err)}
 
         self._phs ={key:value for key , value in zip (self.id, phs)}
         self._phs_err ={key:value for key , value in zip (self.id, phs_err)}
         
-    #---> set a few pertinent atttributes thought components xy and yx 
+        self.stnames = self.edinames 
+        
+        return self 
+    
+    def rewrite_edis (self, ediObjs=None,  by = 'name' , prefix = None, 
+                      dataid =None, savepath = None, how='py', correct_ll=True, 
+                      make_coords =False, reflong=None, reflat=None, step ='1km',
+                      edi_prefix =None, export =True, **kws): 
+        
+        """ Rewrite Edis, correct station coordinates and dipole length. 
+        
+        Can rename the dataid,  customize sites and correct the positioning
+        latitudes and longitudes. 
+        
+        Parameters 
+        ------------
+  
+        ediObjs: list 
+            Collection of edi object from pycsamt.core.edi.Edi 
+        dataid: list 
+            list of ids to  rename the existing EDI-dataid from  
+            :class:`Head.dataid`. If given, it should match the length of 
+            the collections of `ediObjs`. A ValueError will occurs if the 
+            length of ids provided is out of the range of the number of EDis
+            objects 
+
+        by: str 
+            Rename according to the inner module Id. Can be ``name``, ``id``, 
+            ``number``. Default is ``name``. If :attr:`~.Edi_collection.survey_name`
+            is given, the whole survey name should be used. An other argument 
+            is ``ix`` out of number formating. 
+            
+        prefix: str
+            Prefix the number of the site. It could be the abbreviation   
+            of the survey area. 
+
+        correct_ll: bool,
+            Write the scaled positions( longitude and latitude). Default is
+            ``True``. 
+            
+        make_coords: bool 
+            Useful to hide the real coordinates of the sites by generating 
+            a 'fake' coordinates for a specific purposes. When setting to ``True``
+            be sure to provide the `reflong` and `reflat` values otherwise and 
+            error will occurs. 
+            
+        reflong: float or string 
+            Reference longitude  in degree decimal or in DD:MM:SS for the  
+            site considered as the origin of the lamdmark.
+            
+        reflat: float or string 
+            Reference latitude in degree decimal or in DD:MM:SS for the reference  
+            site considered as the landmark origin.
+            
+        step: float or str 
+            Offset or the distance of seperation between different sites in meters. 
+            If the value is given as string type, except the ``km``, it should be 
+            considered as a ``m`` value. Only meters and kilometers are accepables.
+            Default value of seperation between the site is ``1km``. 
+             
+        savepath: str 
+            Full path of the save directory. If not given, EDIs  should be 
+            outputed in the created directory. 
+    
+        how: str 
+            The way to index the stations. Default is the Python indexing
+            i.e. the counting starts by 0. Any other value will start counting 
+            the site from 1.
+            
+        export: bool, 
+            Export new edi-files 
+            
+        kws: dict 
+            Additionnal keyword arguments from `~Edi.write_edifile` and 
+            :func:`pycsamt.utils.func_utils.make_ll_coordinates`. 
+            
+        Returns 
+        --------
+            cobjs: array-like, Shape (N, ) 
+            A collection of new ediObjs 
+            
+        Examples
+        ---------
+        >>> from pycsamt.core.edi import Edi_Collection
+        >>> edipath = r'/Users/Daniel/Desktop/edi'
+        >>> savepath =  r'/Users/Daniel/Desktop/ediout'
+        >>> cObjs = Edi_collection (edipath)
+        >>> cObjs.rewrite_edis(by='id', edi_prefix ='b1',savepath =savepath)
+        
+        """
+        def replace_reflatlon (  olist , nval, kind ='reflat'):
+            """ Replace Definemeaseurement Reflat and Reflong by the interpolated
+            values.
+            
+            :param olist: old list composing the read EDI measurement infos.
+            :type olist: list 
+            :param nval: New reflat or reflong list. Mostly is the DD:MM:SS 
+                value interpolated. 
+            :param kind: Type of measurement to write. 
+            :type kind:str 
+            
+            :return: List of old element replaced. 
+            :rtype: list 
+            """
+            try : 
+                for ii, comp in enumerate (olist):
+                    if comp.strip().find(kind)>=0: 
+                        olist[ii]= f' {kind}={nval}\n'
+                        break 
+            except:
+                pass
+            return olist 
+        regex = re.compile('\d+', re.IGNORECASE)
+        by = str(by).lower() 
+        if by.find('survey')>=0 :
+            by ='name'
+        
+        prefix = str(prefix) 
+        
+        if ediObjs is not None:
+           self.ediObjs = ediObjs
+           self.id = func.make_ids(self.ediObjs, prefix='S', how= how )
+           
+        if how !='py': 
+            self.id = func.make_ids(self.ediObjs, prefix='S',
+                                    cmode =None)  
+        if dataid is None: 
+            if prefix !='None' : 
+                dataid = list(map(lambda s: s.replace('S', prefix), self.id))
+                
+            elif by =='name': 
+                # get the first name of dataId of the EDI ediObjs  and filled
+                # the rename dataId. remove the trail'_'  
+                name = self.survey_name or  regex.sub(
+                    '', self.ediObjs[0].Head.dataid).replace('_', '') 
+                # remove prefix )'S' and keep only the digit 
+                dataid = list(map(lambda n: name + n, regex.findall(
+                    ''.join(self.id)) ))
+                
+            elif by.find('num')>=0: 
+               
+               dataid = regex.findall(''.join(self.id))  
+               
+            elif by =='id': 
+                dataid = self.id 
+                
+            elif by =='ix': 
+                dataid = list(map(
+                    lambda x: str(int(x)), regex.findall(''.join(self.id))))  
+            else :
+                dataid = list(map(lambda obj: obj.Head.dataid, self.ediObjs))
+
+        elif dataid is not None: 
+            if not np.iterable(dataid): 
+                raise ValueError('DataId parameter should be an iterable '
+                                 f'object, not {type(dataid).__name__!r}')
+            if len(dataid) != len(self.ediObjs): 
+                raise ValueError (
+                    'DataId length must have the same length with the number'
+                    ' of collected EDIs({0}). But {1} {2} given.'.format(
+                    len(self.ediObjs), len(dataid),
+                    f"{'is' if len(dataid)<=1 else 'are'}"))
+       
+    
+        if make_coords: 
+            if (reflong or reflat) is None: 
+                raise ValueError('Reflong and reflat params must not be None!')
+            self.longitude, self.latitude = func.make_ll_coordinates(
+               reflong = reflong, reflat= reflat, nsites= len(self.ediObjs),
+               step = step , **kws) 
+        # clean the old main Edi section info and 
+        # and get the new values
+        if correct_ll or make_coords:
+            londms,*_ = func.scale_position(self.longitude, todms=True)
+            latdms,*_ = func.scale_position(self.latitude, todms=True)
+
+        # collect new ediObjs 
+        cobjs = np.zeros_like (self.ediObjs, dtype=object ) 
+        
+        for k, (obj, did) in enumerate(zip(self.ediObjs, dataid)): 
+            obj.Head.edi_header = None  
+            obj.Head.dataid = did 
+            obj.Info.ediinfo = None 
+            
+            if correct_ll or make_coords:
+                obj.Head.long = float(self.longitude[k])
+                obj.Head.lat = float(self.latitude[k])
+                obj.Head.elev = float(self.elevation[k])
+                oc = obj.DefineMeasurement.define_measurement
+                oc= replace_reflatlon(oc, nval= latdms[k])
+                oc= replace_reflatlon(oc, nval= londms[k], kind='reflong')
+                oc = replace_reflatlon(oc, nval= self.elevation[k], 
+                                       kind='refelev')
+                obj.DefineMeasurement.define_measurement = oc 
+            # Empty the previous MTEMAP infos and 
+            # fetch the attribute values newly set.
+            obj.MTEMAP.mtemapsectinfo =None 
+            obj.MTEMAP.sectid= did
+            
+            if export: 
+                obj.write_edifile(
+                    savepath = savepath ,new_edifilename = edi_prefix,  **kws)
+            cobjs[k] = obj 
+        
+        self.ediObjs = cobjs 
+        
+        return self   
     
     @property 
     def res_xy (self): 
-        return {stn :res[: , 0, 1] for stn, res in self._res.items()}
+        return {stn :res[: , 0, 1] 
+                for stn, res in self._res.items()}
     @property 
     def res_yx (self): 
-        return {stn :res[: , 1, 0] for stn, res in self._res.items()}
+        return {stn :res[: , 1, 0]
+                for stn, res in self._res.items()}
 
     @property 
     def res_err_xy (self): 
         return {stn :res_err[: , 0, 1] 
                 for stn, res_err in self._res_err.items()}
     @property 
     def res_err_yx (self): 
         return {stn :res_err[: , 1, 0] 
                 for stn, res_err in self._res_err.items()}
     
-    
+    @property 
+    def res_xx (self): 
+        return {stn :res[: , 0, 0] 
+                for stn, res in self._res.items()}
+    @property 
+    def res_yy (self): 
+        return {stn :res[: , 1, 1] 
+                for stn, res in self._res.items()}
+
+    @property 
+    def res_err_xx (self): 
+        return {stn :res_err[: , 0, 0] 
+                for stn, res_err in self._res_err.items()}
+    @property 
+    def res_err_yy (self): 
+        return {stn :res_err[: , 1, 1] 
+                for stn, res_err in self._res_err.items()}
+
     @property 
     def z_xy (self): 
-        return {stn :z[: , 0, 1] for stn, z in self._z.items()}
+        return {stn :z[: , 0, 1] 
+                for stn, z in self._z.items()}
     @property 
     def z_yx (self): 
-        return {stn :z[: , 1, 0] for stn, z in self._z.items()}
+        return {stn :z[: , 1, 0] 
+                for stn, z in self._z.items()}
 
+    @property 
+    def z_xx (self): 
+        return {stn :z[: , 0, 0]
+                for stn, z in self._z.items()}
+    @property 
+    def z_yy (self): 
+        return {stn :z[: , 1, 1] 
+                for stn, z in self._z.items()}
+    @property 
+    def z_err_xx (self): 
+        return {stn :z_err[: , 0, 0] 
+                for stn, z_err in self._z_err.items()}
+    @property 
+    def z_err_yy (self): 
+        return {stn :z_err[: , 1, 1] 
+                for stn, z_err in self._z_err.items()}
     
     @property 
     def z_err_xy (self): 
-        return {stn :z_err[: , 0, 1] for stn, z_err in self._z_err.items()}
+        return {stn :z_err[: , 0, 1] 
+                for stn, z_err in self._z_err.items()}
     @property 
     def z_err_yx (self): 
-        return {stn :z_err[: , 1, 0] for stn, z_err in self._z_err.items()}
-    
+        return {stn :z_err[: , 1, 0] 
+                for stn, z_err in self._z_err.items()}
     
     @property 
     def phs_xy (self): 
-        return {stn :phs[: , 0, 1] for stn, phs in self._phs.items()}
+        return {stn :phs[: , 0, 1] 
+                for stn, phs in self._phs.items()}
     @property 
     def phs_yx (self): 
-        return {stn :phs[: , 1, 0] for stn, phs in self._phs.items()}
+        return {stn :phs[: , 1, 0] 
+                for stn, phs in self._phs.items()}
 
-    
     @property 
     def phs_err_xy (self): 
         return {stn :phs_err[: , 0, 1] 
                 for stn, phs_err in self._phs_err.items()}
     @property 
     def phs_err_yx (self): 
         return {stn :phs_err[: , 1, 0] 
                 for stn, phs_err in self._phs_err.items()}
+    @property 
+    def phs_xx (self): 
+        return {stn :phs[: , 0, 0] 
+                for stn, phs in self._phs.items()}
+    @property 
+    def phs_yy (self): 
+        return {stn :phs[: , 1, 1]
+                for stn, phs in self._phs.items()}
+
     
+    @property 
+    def phs_err_xx (self): 
+        return {stn :phs_err[: , 0, 0] 
+                for stn, phs_err in self._phs_err.items()}
+    @property 
+    def phs_err_yy (self): 
+        return {stn :phs_err[: , 1, 1] 
+                for stn, phs_err in self._phs_err.items()}
+           
+def _assert_edi_obj (
+        obj: str | pycsamt.core.edi | mtpy.core.edi  
+        )-> pycsamt.core.edi | mtpy.core.edi : 
+    """Assert that the given argument is an EDI -object from modules 
+    EDi of pyCSAMT and MTpy packages. A TypeError will occurs otherwise.
+    
+    :param obj: Full path EDI file or `pyCSAMT`_ and `MTpy`_ object. 
+    :type obj: str or str or  pycsamt.core.edi.Edi or mtpy.core.edi.Edi 
+    
+    :return: Identical object after asserting.
+    
+    """
+    if isinstance(obj, str): 
+        obj = Edi(obj) 
+    try : 
+        obj = func._assert_all_types (
+            obj, mtpy.core.edi.Edi, pycsamt.core.edi.Edi)
+    except AttributeError: 
+        # force checking instead
+        from pycsamt.core import edi 
+        obj = func._assert_all_types (obj, edi.Edi)
+    return  obj 
 
+       
 class Edi : 
     """
     Ediclass  is for especialy dedicated to .edi files, mainly reading 
     and writingwhich are meant to follow the archaic EDI format put forward 
     by SEG.Can read impedance, Tipper but not spectra. To read spectra format
     please consult MTpy documentation https://mtpy2.readthedocs.io/en/develop/ 
     The Edi class contains a class for each major section of the .edi file.
@@ -421,15 +717,15 @@
                             data to impedance , rho and phase .
     _write_components       Write MT or EMAP components blocks for data blocks
         _blocks_mt          of the .edi file.
     =====================  ===================================================
    
     :Example:  
          
-        >>> import pycsamt.ff.core.edi as csedi
+        >>> import pycsamt.core.edi as csedi
         >>> path =  os.path.join(os.environ["pyCSAMT"], 
         ...                        'data','edi', csa000.edi)
         >>> edihead= csedi.Head.get_header_list_from_edi(
         ...                edi_fn=path)
         >>> info_obj =csedi.Info.get_info_list_from_edi(
         ...                    edi_fn=path)
         >>> edi_obj =csedi.Edi(edi_filename=path )
@@ -444,14 +740,15 @@
         self.edifile =edi_filename 
         self.Head =Head()
         self.Info=Info()
         self.DefineMeasurement =DefineMeasurement()
         self.MTEMAP =MTEMAP()
         self.Z =MTz.Z()
         self.Tip =MTz.Tipper()
+
         self.verbose =verbose 
 
         self.block_size = 6 
         self.data_head_com ='>!****{0}****!\n'
         self.bloc_num_format  =' 15.6e'
         
         self. _z_comps = [zz.lower().strip('>') for \
@@ -467,32 +764,39 @@
         self._phs_comps = [phs.lower().strip('>') for phs in\
                          SB._edi if  re.match("^>PHS", phs) is not None  ]
         
         self.edi_data_sectionline =None 
        
         if self.edifile is not None : 
                 self.read_edi ()
-    
+         
+    @property 
+    def dataid (self) : 
+        return self.Head.dataid 
+    @dataid.setter 
+    def dataid (self, did): 
+        self.Head.dataid = did 
+        
     @property 
     def lon(self): 
-        return self.Head.lon
+        return self.Head.long or self.DefineMeasurement.reflong 
     @lon.setter 
     def lon (self, longitude): 
-        self.Head.lon =longitude 
+        self.Head.long =longitude  
     
     @property 
     def lat(self): 
-        return self.Head.lat 
+        return self.Head.lat or self.DefineMeasurement.reflat 
     @lat.setter 
     def lat (self, latitude): 
         self.Head.lat=latitude 
         
     @property 
     def elev(self): 
-        return self.Head.elev 
+        return self.Head.elev or self.DefineMeasurement.refelev 
     @elev.setter 
     def elev (self, elevation): 
         self.Head.elev =elevation
         
 
     def read_edi (self, edifile =None): 
         """
@@ -500,21 +804,22 @@
 
         :param edifile: full path to edifile 
         :type edifile: str 
         
         """
         self._logging.info ("Reading <{0}> edifile.".format(edifile))
         
-        if edifile is not None :self.edifile = edifile 
+        if edifile is not None :
+            self.edifile = edifile 
         if self.edifile is None : 
-            raise CSex.pyCSAMTError_EDI('NoneType can not read. '
+            raise EDIError('NoneType can not read. '
                                         'Please provide at least an edifile.')
         if self.edifile is not None :
-            if  os.path.isfile(self.edifile) is False:
-                raise CSex.pyCSAMTError_EDI('Can not find edifile to read.'
+            if  not os.path.isfile(self.edifile):
+                raise EDIError('Can not find edifile to read.'
                                             ' Please check your path.')
                 
         #---> read each section and populate attribute 
         if SB.which_file(filename =self.edifile ) =='edi': 
             self.Head = Head.get_header_list_from_edi(edi_fn=self.edifile )
             self.Info = Info.get_info_list_from_edi(edi_fn=self.edifile)   
             self.DefineMeasurement = \
@@ -549,20 +854,20 @@
         
         """
         
         self._logging.info('Read <get_specific_comp> in edi_data'
                            ' section :edifile :{0}.'.format( edifile))
         
         if edifile is not None : self.edifile = edifile 
-        else :raise CSex.pyCSAMTError_EDI(
+        else :raise EDIError(
             'Can not find edifile to read.'
              ' NoneType can not be read. Check, your rigth path.')
         if self.edifile is not None :
             if os.path.isfile(self.edifile) is False :
-                raise CSex.pyCSAMTError_EDI(
+                raise EDIError(
                     'No edifile file .Please check your edipath.')
                 
         # we assume that the file will check above , 
         #just to get to microsec running        
         if SB.which_file(filename =self.edifile , deep=False) =='edi': 
             with open (self.edifile, 'r', encoding ='utf8')  as fedi : 
                 edilines =fedi.readlines()
@@ -614,16 +919,18 @@
         :type data_dict: dict 
                      
         """
         #frequency arranged to highest to lowest . 
         #if 1 mean is lower to highest 
         flag_freqOrder = 0          
         
-        if data_dict is not None : self.comp_dict = data_dict
-        elif data_dict is None :CSex.pyCSAMTError_EDI(
+        if data_dict is not None : 
+            self.comp_dict = data_dict
+        elif data_dict is None :
+            raise EDIError(
                 'None value found. Can not read data')
         
         # get frequency array and initialise z_array and Z_error 
         freq_array = np.array(self.comp_dict['freq'], dtype =np.float)
         z_array , z_error_array =  np.zeros(
             (freq_array.size , 2 , 2),dtype =np.complex),\
                             np.zeros ((freq_array.size , 2 , 2), 
@@ -726,15 +1033,15 @@
     def write_edifile (self, edi_fn=None,  new_edifilename=None, datatype =None , 
                        savepath =None, add_filter_array =None, **kwargs  ): 
         """
         Method to write edifiles from data setting oin attribute of Edi 
         or from existing file. Can write also EMAP data are filled attribute 
         of EDI.
 
-        :param edifile: new edifile name .If None , will write edi using 
+        :new_edifilename: new edifile name .If None , will write edi using 
                         station_name plus type of survey (MT of EMAP) plus 
                         year of writing as< S00_emap.2021.edi> or 
                         <S00_mt.2021.edi>
         :type edifile: str                   
                                                
         :param datatype: type of file , "mt" or "emap" if None , program will 
                         detect which file is provided . If datatype is set , 
@@ -776,24 +1083,27 @@
         ]
                                                             
         tip_labels =[['txr.exp', 'txi.exp', 'txvar.exp'],
                      ['tyr.exp', 'tyi.exp', 'tyvar.exp']]
                           
         f=0
         verbose = kwargs.pop('verbose', None)
+   
         if verbose is not None: 
             self.verbose = verbose 
         if self.verbose is None: self.verbose =0 
+        
         if not hasattr(self, 'savepath'):
             self.savepath =None 
             
         if savepath is not None: 
             self.savepath =savepath 
         
-        if edi_fn is not None : self.edifile =edi_fn 
+        if edi_fn is not None : 
+            self.edifile =edi_fn 
         
         if new_edifilename is not None : 
             try: 
                 new_edifilename += '.{0}.edi'
                 f=2 
             except: 
                 new_edifilename =None 
@@ -807,15 +1117,14 @@
                 new_edifilename = '{0}_{1}.{2}.edi'
             
         
         if self.Head.dataid is None : 
             self.read_edi()
 
         # write info, definemeasurement and mtsection or emapsection 
-        
         edi_header_infolines = self.Head.write_head_info()
         edi_info_infolines =self.Info.write_edi_info()
         edi_definemeasurement_infolines =\
             self.DefineMeasurement.write_define_measurement()
         edi_mtemap_infolines =\
             self.MTEMAP.write_mtemap_section(nfreq=self.Z.freq.size)
 
@@ -828,15 +1137,15 @@
         elif datatype is not None : 
             if re.match(datatype.lower(), 'emapsect') is None \
                 and re.match(datatype.lower(), 'mtsect') is None :
                 warnings.warn (
                     'Currently <pyCSAMT> can write ">=MTSECT" or '
                      ' ">=EMAPSECT". The only acceptables datatype keys '
                      ' are either "mt" or "emap".')
-                raise CSex.pyCSAMTError_EDI(
+                raise EDIError(
                     'Datatype provided is not acceptable .'
                     'Please try "mt" or "emap".')
 
             self.typefile= datatype 
         
         if f==1 :
             new_edifilename = new_edifilename.format(
@@ -920,17 +1229,15 @@
                     comp_key =z_rho_phs_labels [0][ii *2 + jj][2])
                 
                 zreal_datalines.append('\n'), zimag_datalines.append('\n')
                 zvariance_datalines.append('\n')
                 edi_z_data_infolines.extend(zreal_datalines)
                 edi_z_data_infolines.extend(zimag_datalines)
                 edi_z_data_infolines.extend(zvariance_datalines)
-                
-       
-        #===============================================================
+
         # write EMAP  :
         #---------------------------------------------------------------                      
         if self.typefile =='emap':
             # define rho and phase array 
             edi_rhophs_infolines =[self.data_head_com.format(
                 'Resistivities and phases'.upper())]
             rho = np.zeros ((self.Z.freq.size , 2, 4), dtype=np.float)
@@ -984,16 +1291,14 @@
                         
                             fres_datalines.append('\n')
                             edi_rhophs_infolines.extend(fres_datalines)
 
             # delete one more return                 
             edi_z_data_infolines = edi_z_data_infolines[:-1] 
 
-   
-        #===============================================================
         # write EMAP  pass :***TIPPER  *** 
         #---------------------------------------------------------------
         if np.all(self.Tip.tipper ==0 ) and self.Tip.tipper is not None :
             edi_tip_data_infolines , edi_tip_rot_infolines =[''], ['']
         else : 
              #>!****TIPPER ROTATION ANGLES****!
             try :
@@ -1026,15 +1331,15 @@
                                    comp_key=tip_labels[ss][2])
                         edi_tip_data_infolines.extend( tipreal_lines )
                         edi_tip_data_infolines.extend( tipimag_lines )
                         edi_tip_data_infolines.extend( tipvariance_lines)
             except : 
                 edi_tip_data_infolines , edi_tip_rot_infolines =[''], ['']
                 
-        #WRITE 
+        #WRITE EDI
         write_edilines = edi_header_infolines + edi_info_infolines +\
             edi_definemeasurement_infolines + edi_mtemap_infolines  
 
         if self.typefile =='mt': 
             for ilines in [edi_freq_infolines , 
                            edi_zrot_infolines,
                            edi_z_data_infolines,
@@ -1046,64 +1351,37 @@
             
         if self.typefile =='emap': 
             for ilines in [edi_freq_infolines , edi_z_data_infolines,
                            edi_rhophs_infolines]:
                 write_edilines +=ilines +['\n'] 
         
         write_edilines.append('>END')
-        # writenow file : 
+        # write file : 
         with open (new_edifilename , 'w+', encoding = 'utf8') as fw : 
             fw.writelines(write_edilines)
             
-        if self.savepath  is None : 
-            # create a folder in your current work directory
-            self.savepath = os.path.join(os.getcwd(), '_outputEDI_')
-            
-        if self.savepath is not None: 
-            try :
-                if not os.path.isdir(self.savepath):
-                    os.mkdir(self.savepath)
-                    self._logging.info (
-                        'New path <%s> created to save edifile'% self.savepath)    
-            except : 
-                if self.verbose > 0:
-                    warnings.warn(
-                        f"It seems the path {self.savepath!r} already exists!")
-                
-                new_path = 'new_edi.{0}.{1}'.format(
-                    'ff', datetime.datetime.now().month)
-                
-                self._logging.info (
-                    'Create another path <%s> to save edifiles'% os.path.join(
-                        os.path.realpath('.'), new_path))
-                
-                os.mkdir(new_path)    
-                self.savepath =os.path.join(
-                    os.path.realpath ('.'), new_path )
+        self.savepath = func.cpath(self.savepath, '_outputEDI_')
 
-            try : 
-                if os.path.isdir(self.savepath) : 
-                    shutil.move(os.path.join(os.getcwd(),new_edifilename), 
-                                self.savepath )
-            except : pass 
+        try : 
+            shutil.move(new_edifilename, self.savepath )
+        except : 
+            pass 
 
         write_edilines=[]
         
         if self.verbose >0 : 
             print('-'*77)
             print('---> Edifile <{0}> has be successfully written to'
                   ' your savepath.\n---> savepath : <{1}>'.\
                   format(os.path.basename(new_edifilename), self.savepath ))
 
         return new_edifilename
             
-      
-            
-        
-    def _write_components_blocks (self, edi_datacomp , comp_key, datatype=None ): 
+    def _write_components_blocks (self, edi_datacomp , 
+                                  comp_key, datatype=None ): 
         """
         Method to write blocks  with data components keys . 
         
         :param edi_datacomp: array of data components,
         :type edi_datacomp: ndarray (nfreq, 2, 2)
  
         :param comp_key: component to write in edifile .
@@ -1123,19 +1401,14 @@
         self._logging.info ('Ready to write edi data component blocks info list !')
         
         block_rot =['ROT=ZROT', 'ROT=TROT', 'ROT=NONE']
 
         if datatype is None : 
             datatype =self.typefile
         
-        # print(edi_datacomp)
-        # print(len(edi_datacomp))
-        # print(type(edi_datacomp))
-        # print(edi_datacomp.size)
-    
         if comp_key.lower() =='freq':
             comp_block_line=['>FREQ  //{0}\n'.format(edi_datacomp.size)]
         if datatype.lower() in ["mt", '>=mtsect', 'mtsect'] :
  
             if comp_key.lower() =='zrot' or comp_key.lower()=='trot':
                 comp_block_line=['>{0}  //{1}\n'.format(comp_key.upper(), 
                                                         edi_datacomp.size)]
@@ -1147,35 +1420,34 @@
             elif comp_key.lower().find('t')>=0 \
                 and comp_key.lower()  not in ['zrot', 'trot']:
                 comp_block_line = ['>{0} {1}  //{2}\n'.format(
                     comp_key.upper(),block_rot[1],edi_datacomp.size)]
                                                                                                     
             else :
                 if comp_key.lower()!='freq':
-                    raise CSex.pyCSAMTError_EDI(
+                    raise EDIError(
                         'Could not write the component key <%s>'% comp_key)
             
         elif datatype in ['emap', '>=emapsect','emapsect']: 
             if comp_key.lower()!='freq': 
                 comp_block_line = ['>{0} {1}  //{2}\n'.format(
                     comp_key.upper(), block_rot[2],edi_datacomp.size)]
                                          
-            # else : raise CSex.pyCSAMTError_EDI(
+            # else : raise EDIError(
             #'Could not write the component key <%s>'% comp_key)
             
         else :#datatype.lower() not in ['mt' , '>=mtsect'] 
         #and datatype.lower() not in ['emap', '>=emapsect']: 
-            
             warnings.warn (
                 'Two Types of data can be read either  MTsection or EMAPsection.'
                 'The dataType provided <{0}> does not match any of them.'
                  ' We suggest to use "mt" or "emap".as datatype key, if not '
                  'please refer to SEG-Edile ''write principles.'.format(datatype)) 
       
-            raise CSex.pyCSAMTError_EDI(
+            raise EDIError(
                 'DataType <{0}> provided is wrong!'
                  ' please use "MT"or "EMAP".'.format(datatype))
         
         #-- > read value form component edi_data_comp 
         for index_data , datacomp in enumerate (edi_datacomp , 1) : 
  
             if datacomp == 0.0 and comp_key.lower() not in ['zrot', 'trot']: 
@@ -1194,15 +1466,14 @@
             
         return comp_block_line
     
     @property 
     def station (self): 
         return self.Head.dataid 
 
-    
     @property 
     def processingsoftware (self): 
         return self.Info.Processing.ProcessingSoftware.name 
     
     
     @station.setter 
     def station(self, set_station_name): 
@@ -1213,16 +1484,175 @@
         self.MTEMAP.sectid = set_station_name
     
     @processingsoftware.setter 
     def processingsoftware (self, sofware_name): 
         self.Info.Processing.ProcessingSoftware.name = sofware_name
     
 
+    def interpolateZ(self, new_freq_array, interp_type='slinear',
+                    bounds_error=True, period_buffer=None):
+        """
+        Interpolate the impedance tensor onto different frequencies.
 
-        
+        :param new_freq_array: a 1-d array of frequencies to interpolate on
+                               to.  Must be with in the bounds of the existing
+                               frequency range, anything outside and an error
+                               will occur.
+        :type new_freq_array: np.ndarray
+        :param period_buffer: maximum ratio of a data period and the closest
+                              interpolation period. Any points outside this
+                              ratio will be excluded from the interpolated
+                              impedance array.
+
+        :returns: a new impedance object with the corresponding
+                               frequencies and components.
+        :rtype: pycsamt.core.z.Z
+
+        :Interpolate: ::
+
+            >>> import pycsamt.core.edi as CSedi
+            >>> edi_fn = r"/home/edi_files/cs_01.edi"
+            >>> edi_obj = CSedi.Edi(edi_fn)
+            >>> # create a new frequency range to interpolate onto
+            >>> new_freq = np.logspace(-3, 3, 24)
+            >>> new_z_object= edi_obj.interpolate(new_freq)
+            >>> edi_obj.write_new_edifile(new_edi_fn=r"/home/edi_files/cs_01_interp.edi",
+            >>> ...                   new_Z_obj=new_z_object,
+            >>> ...                   )
+
+        """
+        
+        # if the interpolation module has not been loaded return
+        if func.interp_import is False:
+            raise ImportError('could not interpolate, need to install scipy')
+
+        # make sure the input is a numpy array
+        if not isinstance(new_freq_array, np.ndarray):
+            new_freq_array = np.array(new_freq_array)
+            
+        new_freq_array = np.around (new_freq_array, 2)  
+        
+        if period_buffer is not None:
+            if 0. < period_buffer < 1.:
+                period_buffer += 1.
+                print("Warning: period buffer must be > 1. Updating to",
+                      period_buffer)
+
+        # check the bounds of the new frequency array
+        if bounds_error:
+            # logger.debug("new freq array %s", new_freq_array)
+            if self.Z.freq.min() > new_freq_array.min():
+                raise ValueError(
+                    'New frequency minimum of {0:.5g}'.format(new_freq_array.min()) + \
+                    ' is smaller than old frequency minimum of {0:.5g}'.format(
+                        self.Z.freq.min()) + \
+                    '.  The new frequency range needs to be within the ' +
+                    'bounds of the old one.')
+            if self.Z.freq.max() < new_freq_array.max():
+                
+                raise ValueError(
+                    'New frequency maximum of {0:.5g}'.format(new_freq_array.max()) + \
+                    ' is larger than old frequency maximum of {0:.5g}'.format(
+                        self.Z.freq.max()) + \
+                    '.  The new frequency range needs to be within the ' +
+                    'bounds of the old one.')
+
+        # make a new Z object
+        new_Z = MTz.Z(z_array=np.zeros((new_freq_array.shape[0], 2, 2),
+                                       dtype='complex'),
+                      z_err_array=np.zeros((new_freq_array.shape[0], 2, 2)),
+                      freq=new_freq_array)
+        # interpolate the impedance tensor
+        for ii in range(2):
+            for jj in range(2):
+                # need to look out for zeros in the impedance
+                # get the indicies of non-zero components
+                nz_index = np.nonzero(self.Z.z[:, ii, jj])
+
+                if len(nz_index[0]) == 0:
+                    continue
+                # get the non-zero components
+                z_real = self.Z.z[nz_index, ii, jj].real
+                z_imag = self.Z.z[nz_index, ii, jj].imag
+                z_err = self.Z.z_err[nz_index, ii, jj]
+
+                # get the frequencies of non-zero components
+                f = self.Z.freq[nz_index]
+
+                # get frequencies to interpolate on to, making sure the
+                # bounds are with in non-zero components
+                new_nz_index = np.where((new_freq_array >= f.min()) & 
+                                        (new_freq_array <= f.max()))[0]
+                new_f = new_freq_array[new_nz_index]
+                
+                # apply period buffer
+                if type(period_buffer) in [float, int]:
+                    new_f_update = []
+                    new_nz_index_update = []
+                    for ifidx,ifreq in enumerate(new_f):
+                        # find nearest data period
+                        difference = np.abs(np.log10(ifreq) - np.log10(f))
+                        fidx = np.where(difference == np.amin(difference))[0][0]
+                        if max(f[fidx] / ifreq, ifreq / f[fidx]) < period_buffer:
+                            new_f_update.append(ifreq)
+                            new_nz_index_update.append(new_nz_index[ifidx])
+                    new_f = np.array(new_f_update)
+                    new_nz_index = np.array(new_nz_index_update)
+
+                # create a function that does 1d interpolation
+                z_func_real = func.spi.interp1d(f, z_real, kind=interp_type)
+                z_func_imag = func.spi.interp1d(f, z_imag, kind=interp_type)
+                z_func_err = func.spi.interp1d(f, z_err, kind=interp_type)
+
+                # interpolate onto new frequency range
+                new_Z.z[new_nz_index, ii, jj] = z_func_real(
+                    new_f) + 1j * z_func_imag(new_f)
+                new_Z.z_err[new_nz_index, ii, jj] = z_func_err(new_f)
+                
+        # compute resistivity and phase for new Z object
+        new_Z.compute_resistivity_phase()
+
+        return new_Z 
+        
+    # --> write new edi file
+    def write_new_edifile(self, new_edi_fn=None, new_Z=None,**kws):
+        """
+        write a new edi file if things have changed.  Note if new_Z is not 
+        None, they are not changed in `Edi` object, you  need to change them 
+        manually if you want them to be changed. Similarly, the new function 
+        name does not change the `Edi` object `edi_filename` attribute but does
+        change Edi.edi_object.edi_filename attribute.
+
+        :param edi_fn: full path to new edi file
+        :type new_edi_fn: string
+
+        :param new_Z: new Z object
+        :type new_Z: pycsamt.core.z.Z
+
+        :param new_Tipper: new Tipper object
+        :type new_Tipper: pycsamt.core.z.Tipper
+
+        :returns edi_fn: full path to edi file written
+        :rtype edi_fn: string
+        """
+
+        # get header information, mostly from site
+        edi_obj = Edi(edi_filename=self.edifile) 
+        
+        if new_Z is not None:
+            edi_obj.Z = new_Z
+        else:
+            edi_obj.Z = self._Z
+
+        # --> write edi file
+        edi_fn = edi_obj.write_edifile(new_edifilename= new_edi_fn, **kws)
+
+        return edi_fn
+    
+     
 class Head (object): 
     """
     The edi head block contains a series of options which (1) identity the data  
     set, (2) describe whn , where and by whoom was acquired , and (3) describe   
     when , how  and by whom it was written.
     
     Arguments 
@@ -1312,15 +1742,15 @@
         self.country =None 
         self.state =None 
         self.county =None 
         self.prospect =None 
         self.loc =None 
         self.units ='m'
         self.stdvers='SEG 1.0'
-        self.progvers='pyCSAMT'
+        self.progvers=f'pyCSAMT {pycsamt.__version__}'[:-2]
         self.progdate =datetime.datetime.utcnow().strftime('%Y/%m/%d')
         self.coordsys ='Geomagnetic North'
         self.declination =None 
         self.datum ='WGS84'
         self.maxsect =None 
         self.bindata =None
         self.project =None
@@ -1336,20 +1766,22 @@
             self.read_head()
             
     @property 
     def lat (self): 
         return self.Location.latitude 
     @lat.setter 
     def lat (self, lat):
-        try :float(lat)
+        try :
+            float(lat)
         except :
                 self.Location.latitude =gis.convert_position_str2float(lat) 
                 self.logging.info (
                     'Converted string "dms" input latitude  to decimal degree.')
-        else : self.Location.latitude =float(lat)
+        else : 
+            self.Location.latitude =float(lat)
 
 
     @property 
     def long (self): 
         return self.Location.longitude 
     @long.setter 
     def long (self, long):
@@ -1377,68 +1809,73 @@
         
         :paramedi_fn: full path to edifile
         :type edi_fn: str 
         
         """
         _logger.info ('Geting <%s> Head info'% edi_fn)
         
-        if edi_fn is None : raise CSex.pyCSAMTError_EDI(
+        if edi_fn is None : raise EDIError(
                 'Edile file not found ! Please check your right path.')
         markhead , ediheadlist=0,[]
         if SB.which_file(filename= edi_fn, deep=False ) =='edi': 
             if SB.which_file(filename= edi_fn, deep=True) !='edi': 
-                raise CSex.pyCSAMTError_Header(
+                raise HeaderError(
                     'Edifile <{0}> - Header is not correct.'
                     'Please check your edifile'.format(
                         os.apth.basename(edi_fn)))
             
             with open(edi_fn , 'r', encoding ='utf8') as fh : 
                 head_lines = fh.readlines()
-
                 for hh, headitems in enumerate (head_lines): 
                     
                     if '>HEAD' in headitems or \
                         re.match(r'>HEAD', headitems) is not None:
                         markhead = hh
    
-                    if '>INFO' in headitems or\
-                        re.match(r'>INFO', headitems) is not None :
+                    if ('>INFO' in headitems or\
+                        re.match(r'>INFO', headitems) is not None) or (
+                        ###BUG 
+                        # sometimes >INFO data are missing so for safety 
+                        # we try to use for stop the next EDI section which 
+                        # >=DEFINEMEAS'
+                        #re.match(r'>=DEFINEMEAS', headitems) is not None
+                        headitems.find('>=DEFINEMEAS')>=0 
+                        ):
                         
                         ediheadlist.extend(head_lines[markhead:hh])
 
                         break 
- 
             return cls(edi_header_list = ediheadlist)
 
     
     def read_head (self, edi_header_list =None):
         """
         read_header_list and set attributes values
         
         :param edi_header_list: list of edifile header infos 
         :type edi_header_list: list 
         
         :Example:
              
-            >>> from pycsamt.ff.core.edi import Head
+            >>> from pycsamt.core.edi import Head
             >>>> file_edi= 'S00_ss.edi'
             >>>> path =  os.path.join(os.environ["pyCSAMT"], 
             ...                      'pycsamt','data', file_edi)
             >>> edihead= Head.get_header_list_from_edi(edi_fn=path)
             >>> print(edihead.lat)
             >>> print(edihead.long)
             >>> print(edihead.elev)
             >>> print(edihead.acqby)
         """
         self.logging.info ('Reading info list.')
         
         if edi_header_list is not None :
             self.edi_header = edi_header_list
         if self.edi_header is None :
-            raise CSex.pyCSAMTError_Header('None items found to read.')
+            raise HeaderError('None items found to read.')
         new_header =[]
         if self.edi_header is not None :
             for ii, item in enumerate(self.edi_header) :
                 item= item.strip().replace('"','') # replace any blank line 
                 for key in self.head_keys :
                     # some Edifile use LON instead of LONG ,
                     # must take into accountfor parsing
@@ -1448,22 +1885,25 @@
                         #for more consistency , 
                         #try to clean possible space before setting attribute 
                         # function return a list of clean value
                         keyi =func._strip_item(
                             item_to_clean=item.lower().split('=')[0])[0] 
                         if keyi=='lon': keyi= 'long'
                         if keyi =='coordsys' :keyi =='coordinate_system'
-                        value = func._strip_item(
-                            item_to_clean=item.split('=')[1])[0]
-                        
+
+                        try :
+                            value = func._strip_item(
+                                item_to_clean=item.split('=')[1])[0]  
+                        except: value =''
                         self.__setattr__(keyi.lower(), value)
                         new_header.append(''.join([keyi.upper(), '=', value]))
 
         self.edi_header = new_header
-
+        
+        return self 
     
     def write_head_info (self , head_list_infos =None): 
         """
         Write list info . Can read edi and rewrite list or  to provide 
         input as ['key_01=value_01', 'key_02=value_02', ...,'key_nn=value_nn']
         
         .. Note:: If value is  None ,  don't need to write the key . 
@@ -1473,28 +1913,28 @@
         
         :returns: write_info list , list ready to write to let
                 EDI file more visible .
         :rtype: list 
         
         :Example:
             
-            >>> from pycsamt.ff.core.edi import Head
+            >>> from pycsamt.core.edi import Head
             >>> path =  os.path.join(os.environ["pyCSAMT"],
             ...                         'pycsamt','data', S00_ss.edi)
             >>> edihead= Head.get_header_list_from_edi(edi_fn=path)
             >>> print(edihead.write_head_info(
             ...    head_list_infos = edihead.edi_header))
         """
         self.logging.info ('Writing Edifile info .')
 
         write_header =['>HEAD\n']
-        if head_list_infos is not None : self.edi_header = head_list_infos 
+        if head_list_infos is not None : 
+            self.edi_header = head_list_infos 
         
         if  self.edi_header is None:
-
             for key in self.head_keys : 
                 keyvalue =getattr(self, key)
                 if keyvalue == None :  continue#keyvalue=''
                 elif keyvalue !=None : 
                     if key =='long' or key=='lat':
                         keyvalue =gis.convert_position_float2str(keyvalue)
                     if key =='dataid' :
@@ -1604,15 +2044,15 @@
         
         """
         _logger.info (
             'subclass :Reading <%s> Ediinfo and return  class.'% cls.__name__)
         
         info_mark=0
         if edi_fn is None : 
-            raise CSex.pyCSAMTError_EDI(
+            raise EDIError(
                 'None infos to read! Please provide the right path .')
         # we do this simultaneous assement to get a ms of computation .
         if SB.which_file(filename =edi_fn, deep=False)=='edi': 
             if SB.which_file(filename= edi_fn, deep =True )=='edi': 
                 with open(edi_fn, 'r', encoding ='utf8') as fi:
                     edi_lines =fi.readlines()
                     
@@ -1639,15 +2079,15 @@
         :type edi_info_list: list 
         
         """
         listinfo=[]
         
         if edi_info_list is not None : self.ediinfo =edi_info_list 
         if self.ediinfo is None :
-            raise CSex.pyCSAMTError_EDI('None list found. can not read.')
+            raise EDIError('None list found. can not read.')
         
         for ii , iteminfo in enumerate(self.ediinfo ):
             iteminfo=iteminfo.replace('"','')
             if iteminfo =='\n':continue #continue 
             elif iteminfo !='\n':
                 try : 
                     item , infovalue = iteminfo.strip().split('=')
@@ -1683,17 +2123,18 @@
                 if self.Processing.ProcessingSoftware.name is None : 
                      self.Processing.ProcessingSoftware.__setattr__('name', infovalue)
             else :
                 self.__setattr__(item, infovalue)
                 listinfo.append(''.join([' {0}'.format(
                     item.upper()), '=', infovalue]))
         
-
         self.ediinfo = listinfo
-
+        
+        return self 
+    
             
     def write_edi_info (self, edi_info_list =None ): 
         """
         Write edi information info . Can read edi and rewrite list or to provide 
         input as ['key_01=value_01', 'key_02=value_02', ...,'key_nn=value_nn' ]
         Note : If value is absent i.e None ,  don't write the key . Info write 
         method add somefield notes informations from other softwares if exists.  
@@ -1702,15 +2143,15 @@
         :type edi_info_list: list 
         
         :returns: list of info 
         :rtype: list 
             
         :Example:
             
-            >>> from pycsamt.ff.core.edi import Info 
+            >>> from pycsamt.core.edi import Info 
             >>> file_edi_2='SAMTEX.edi_2.edi'
             >>> file_edi= 'S00_ss.edi'
             >>> path =  os.path.join(os.environ["pyCSAMT"], 
             ...                         'pycsamt','data', file_edi_2)
             >>> info_obj =Info.get_info_list_from_edi(edi_fn=path)
             >>> print(info_obj.write_edi_info())
             
@@ -1771,15 +2212,15 @@
                     write_info.append(''.join(
                         ['  {0}'.format('FILTER'), '=', 
                          getattr(self, 'filter'), '\n']))
                 else : valueinf =getattr(self, infok)
                 
                 if valueinf is None :continue   
                 else : write_info.append(''.join(
-                    ['  {0}'.format(infok.upper()), '=', valueinf, '\n']))
+                    ['  {0}'.format(infok.upper()), '=', str(valueinf), '\n']))
                 
             
             for value in self.ediinfo: #add others info from procesing files.
                 keyi, valueinf  = value.strip().split('=')
                 keyi = func._strip_item(item_to_clean =keyi)[0]
                 valueinf = func._strip_item(item_to_clean =valueinf)[0]
                 if keyi.lower() in suit.latitude :
@@ -1917,15 +2358,15 @@
         """
         _logger.info(
             'Reading < %s> file from <%s>' % (os.path.basename(edi_fn), 
                                               cls.__name__))
         
         _flagmeas =0
         dfmeasurementlist = [] 
-        if edi_fn is None : raise CSex.pyCSAMTError_EDI(
+        if edi_fn is None : raise EDIError(
                 'Can not read edifile .None value is found.')
         if SB.which_file(filename = edi_fn) =='edi': 
             with open(edi_fn , 'r', encoding= 'utf8') as fdefm : 
                 edilines =fdefm.readlines ()
             for dd , dmvalue in enumerate(edilines) : 
                 if '>=definemeas'.upper() in dmvalue or dmvalue.find(
                         '>=DEFINEMEAS')>=0 or\
@@ -1952,42 +2393,42 @@
                                 Emeas and Hmeas will be set on dictionnary
                                 and call the class to populate attribute
                                 *default* is None 
         :type define_measurement_list: list
         
         :Example:
             
-            >>> from pycsamt.ff.core.edi import DefineMeasurement    
+            >>> from pycsamt.core.edi import DefineMeasurement    
             >>> file_edi= 'S00_ss.edi'
             >>> path =  os.path.join(os.environ["pyCSAMT"], 
             ...                         'pycsamt','data', file_edi_2)
             >>> definemeas =DefineMeasurement.get_measurement_info(edi_fn=path)
             >>> print(definemeas.define_measurement)
             >>> print(definemeas.meas_ex)
                 
         .. note:: to get measurement_hx or measurement_ex  
                     for instance get attribute <id> of Emeasurement, run the 
                     following script
                     
         :Example:
             
-          >>> from pycsamt.ff.core.edi import DefineMeasurement 
+          >>> from pycsamt.core.edi import DefineMeasurement 
           >>> definemeas =DefineMeasurement.get_measurement_info(edi_fn=path)
           >>> print(definemeas.meas_ex.id) 
           ... 1004.
           
         """
         self.logging.info (
             'Reading DefineMeasurement info <%s>' % self.__class__.__name__)
         xmeas_list =[]
 
         if define_measurement_list is not None :
             self.define_measurement= define_measurement_list
         if self.define_measurement is None :
-            raise CSex.pyCSAMTError_EDI(
+            raise EDIError(
                 'Can not find DefineMeasurment list to read.'
                 'Please provide the list of definemeasurment.'
                 ' e:g:[key_01=value_01 , ..., key_xx = value_xx] ')
         for keys in self.define_measurement :
             if re.match('r^{0}'.format('hmeas'.upper()), keys) is None or\
                 re.match('r^{0}'.format('emeas'.upper()),keys) is None :   
                 try : 
@@ -2077,14 +2518,16 @@
          
                 
         self.logging.info (
             'Number of channels "emeas" and "hmeas" found is <%s>.' % self.nchan)
         
    
         self.define_measurement = xmeas_list
+        
+        return self 
 
     def write_define_measurement(self, define_measurement_list = None): 
         """
         Write definemeasurement method ,intend to write and rewrite measurements 
         infos into list. informations must be on list as possible if not may 
         set attribute manually i.e 
         [key01=value02 , ..., keynn=valuenn + dictXX ]dictXX ={meas_e}, {meas_hx},
@@ -2133,18 +2576,18 @@
                     'list provided cannot be write.Please provide key values'
                     '  as :[key01=value02 , ..., keynn=valuenn + dictXX ]'
                     'with dictXX ={meas_e}, {meas_hx}, {meas_ey}{meas_hx},'
                     ' {meas_hy} {meas_hz}')
                 
                 self.logging.warn(
                     'Please check your definemeasurement '
-                    'list provided. Can not be write.')
-                raise CSex.pyCSAMTError_EDI(
+                    'list provided. Can not be written.')
+                raise EDIError(
                     "Can not write the items on the definemeasurement "
-                     "list provided. It seems no right parser if found.")
+                     "list provided. It seems no right parser is found.")
             
             for ii, itemkey in enumerate(self.define_measurement):
                 if not isinstance(itemkey, dict) :
                    keydfmeas , valuedfmeas = itemkey.strip().split("=")
                    keydfmeas , valuedfmeas =func._strip_item(
                        item_to_clean=keydfmeas)[0],func._strip_item(
                            item_to_clean=valuedfmeas)[0] 
@@ -2192,21 +2635,19 @@
             # then write Hmeasurement and Emeasurements throught their attributes.
             for meastype in chtype : 
                 if hasattr(self, 'meas_{0}'.format(meastype)):
                     if 'e' in meastype :
                         write_dfmeasurements.append('>emeas'.upper())
                         for eattr in Emeasurement.emeasurementkey :
                             try :tempattr =getattr(self, 'meas_{0}'.format(meastype))
-                            except :
-                                AttributeError 
-                                pass 
+                            except :pass 
                             else : 
                                 
                                 valuemeasxx = tempattr.__dict__["{0}".format(eattr)]
-
+    
                                 if valuemeasxx ==None : valuemeasxx=''
                                 write_dfmeasurements.append(''.join(
                                     ['  {0}'.format(eattr.upper()), '=',
                                      '{0:>10}'.format(str(valuemeasxx).upper())]))
                         write_dfmeasurements.append('\n')
                     elif 'h' in meastype :
                         write_dfmeasurements.append('>hmeas'.upper())
@@ -2219,14 +2660,15 @@
                             else : 
                                 valuemeasyy = tempattr.__dict__["{0}".format(hattr)]
                                 if valuemeasyy ==None : valuemeasyy =''
                                 write_dfmeasurements.append(''.join(
                                     ['  {0}'.format(hattr.upper()),
                                      '=', '{0:>10}'.format(str(valuemeasyy).upper())]))
                         write_dfmeasurements.append('\n')
+                        
         write_dfmeasurements.append('\n')
         
         return write_dfmeasurements
                              
 class Hmeasurement(object): 
     """
     Define the sensor location and orientation , and run parameters for
@@ -2248,15 +2690,15 @@
     measdate               date of run ("")
     =====================  ====================================================
      
     To fill Metadata, let get a look of this example 
     
     :Example:
         
-        >>> import pycsamt.ff.core.edi as csedi
+        >>> import pycsamt.core.edi as csedi
         >>> hmeas_dict = {'id': '1000.3', 'chtype':'hx', 'x':0, 
         ...                  'y':0, 'azm':0, 'sensor':'None'}
         >>> hmeas = csedi.Hmeasurement(**hmeas_dict )
         >>> print(hmeas.chtype)
         >>> print(hmeas.azm)
         >>> print(hmeas.measdate)
         >>> print(hmeas.sensor)
@@ -2302,15 +2744,15 @@
     measdate               date of run ("")
     =====================  ====================================================
 
     To Fill Metadata , let take this example 
     
     :Example: 
         
-        >>> import pycsamt.ff.core.edi as csedi
+        >>> import pycsamt.core.edi as csedi
         >>> emeas_dict = {'id': '1000.4', 'chtype':'ex', 'x':0,
         ...                  'y':0, 'azm':0, 'acqchan':'ex', }
         >>> emeas = csedi.Hmeasurement(**emeas_dict)
         ... print(emeas.chtype)
         ... print(emeas.azm)
         ... print(emeas.measdate)
      """
@@ -2437,15 +2879,16 @@
         :returns: newclass contained a list of mtemap infos 
         :rtype: list 
         
         """
         _logger.info (
             "Read MT Section on edifile <%s>: %s" % (
                 os.path.basename(edi_fn),cls.__name__))
-        if edi_fn is None :CSex.pyCSAMTError_EDI(
+        if edi_fn is None :
+            raise EDIError(
                 'NoneType can not be read. Please provide your right edipath.')
         mtflag,  mtsection = 0, []
         gmtsectmeasurement=[]
         
         #check whether it is an edifile.
         if SB.which_file(filename =edi_fn) =='edi': 
             with open (edi_fn , 'r',encoding ='utf8') as fmt : 
@@ -2487,15 +2930,15 @@
             [key01=value01, ..., keynn=valuenn] 
             
         :param mt_or_emap_section_list: `mt` or `emap` section list 
         :type mt_or_emap_section_list: list 
             
         :Example:
             
-            >>> import pycsamt.ff.core.edi as csedi 
+            >>> import pycsamt.core.edi as csedi 
             >>> mtsection_obj= csedi.MTEMAP.get_mtemap_section_list(edi_fn =path)
             >>> info = mtsection_obj.read_mtemap_section()
             >>> print(mtsection_obj.sectid) 
         """
 
         mtemapsectionlist, fmt =[],"{:>12}"
         
@@ -2503,15 +2946,15 @@
         
         if mt_or_emap_section_list is not None :
             self.mtsectinfo =mt_or_emap_section_list
         if self.mtemapsectinfo is None : 
             warnings.warn(
                 'Nonelist can not be read. Please '
                 'provide the right MT section list info.')
-            raise CSex.pyCSAMTError_EDI(
+            raise EDIError(
                 'Nonelist found. cannot read MTsection info.'
                 ' Please provide the riht path.')
         
 
         for ii , mtinfo in enumerate (self.mtemapsectinfo):
             
             try : 
@@ -2544,28 +2987,31 @@
         #--> rewrite the list for consistency 
         self._logging.info (
             'FileType with DataType supposed to be written'
             ' is on <%s>_sect format ' % mtemapsectionlist[0])
         
         self.mtemapsectinfo =mtemapsectionlist
         
+        return self 
+    
+    
     def write_mtemap_section (self, mt_or_emap_section_list =None ,
                               nfreq=None):
         """
         Method to write MT or EMAP section into list by providing list as
         ['key01= value01', ..., keyxx=valuexx ]. Method can recognize whether
          edifile provided is MT or EMAP then can read file according to. 
 
         :param mt_or_emap_section_list:
             list of mt or eamp sectiionvalidate by egal ('=')
         :type mt_or_emap_section_list: list 
             
         :Example: 
             
-            >>> from pycsamt.ff.core.edi  import MTEMAP
+            >>> from pycsamt.core.edi  import MTEMAP
             >>> mtemapinfo ={'sectid':'yobkro','nfreq':18 , 'maxblks':100, 'hx':"1003.1",
             ...         'ex':'1005.4','hz':'1006.3', 'ey':1002.3 , 
             ...         'hy':'1000.2'}#'chksum':18, 'ndipole':47, 'type':'hann'
             >>> mtemapsection_obj = MTEMAP(**mtinfo)
             >>> writeinfomtemapsect = mtemapsection_obj.write_mtemap_section()
             >>> print(writeinfomtemapsect)
         """ 
@@ -2647,15 +3093,15 @@
     year              int         year published
     ================  ==========  ===============================
 
     More attributes can be added by inputing a key word dictionary
     
     :Example: 
         
-        >>> from pycsamt.ff.core.edi import References
+        >>> from pycsamt.core.edi import References
         >>> refobj = References(**{'volume':18, 'pages':'234--214', 
         ...                           'title':'pyCSAMT :python toolbox for CSAMT' ,
         ...                  'journal':'Computers and Geosciences', 
         ...                  'year':'2021', 'author':'DMaryE'})
         >>> print(refobj.journal)
     """
     def __init__(self, **kwargs):
@@ -2685,15 +3131,15 @@
     release_status      string      release status [ open | public |proprietary]
     =================  ===========  ===========================================
 
     More attributes can be added by inputing a key word dictionary
     
     :Example:
         
-        >>> from pycsamt.ff.core.edi import Copyright 
+        >>> from pycsamt.core.edi import Copyright 
         >>> Copyright(**{'owner':'University of CSAMT',
         ...                  'contact':'Cagniard'})
     """
 
     def __init__(self, **kwargs):
         self.References = References()
         self.conditions_of_use = ''.join([
@@ -2732,15 +3178,15 @@
                                        archiving
     =====================  ==========  ========================================
 
     More attributes can be added by inputing a key word dictionary
     
     :Example:
         
-        >>> from pycsamt.ff.core.edi import Source
+        >>> from pycsamt.core.edi import Source
         >>> Source(**{'archive':'IRIS', 
         ...             'reprocessed_by':'grad_student'})
     """
 
     def __init__(self, **kwargs):
         
         for key in ['project', 'survey', 'sitename']: 
@@ -2770,15 +3216,15 @@
     organization_url  string      organizations web address
     ================  ==========  =============================================
 
     More attributes can be added by inputing a key word dictionary
     
     :Example:
         
-        >>> from pycsamt.ff.core.edi import Person
+        >>> from pycsamt.core.edi import Person
         >>> person =Person(**{'name':'ABA', 'email':'aba@cagniard.res.org',
         ...                  'phone':'00225-0769980706', 
         ...          'organization':'CagniadRES'})
         >>> person.name 
         ... ABA
         >>> person.organisation
         ... CagniardRES
@@ -2841,15 +3287,15 @@
     release             string      latest version release
     ================= =========== ========================
 
     More attributes can be added by inputing a key word dictionary
     
     :Example:
         
-        >>> from pycsamt.ff.core.edi import Software
+        >>> from pycsamt.core.edi import Software
         >>> Software(**{'release':'0.11.23'})
     """
 
     def __init__(self, **kwargs):
         for key in ['name', 'version', 'release'] :
             self.__setattr__(key, None)
         self.Author = Person()
@@ -2867,15 +3313,15 @@
     
     :param parser:  parser edifile section DefineMeasurement, 
                     can be change. *default* is egal (=)    
     :type parser: str 
                 
     :Example:  
         
-        >>> from pycsamt.ff.core.edi  import DefineMeasurement 
+        >>> from pycsamt.core.edi  import DefineMeasurement 
         >>> file_edi= 'S00_ss.edi'
         >>> path =  os.path.join(os.environ["pyCSAMT"], 
         ...                         'pycsamt','data', file_edi_2)
         >>> definemeas =DefineMeasurement.get_measurement_info(edi_fn=path)
         >>> minimparser = minimum_parser_to_write_edi(
         ...    edilines =definemeas.define_measurement)
         >>> print(minimparser)
@@ -2918,15 +3364,15 @@
     :type parser: str 
 
     :returns:  list solded with egal like <key=value> 
     :rtype: list 
     
     :Example: 
         
-        >>> from pycsamt.ff.core.edi import gather_measurement_key_value_with_str_parser
+        >>> from pycsamt.core.edi import gather_measurement_key_value_with_str_parser
         >>> measm = [ ['>HMEAS', 'ID=1001.001', 'CHTYPE=HX', 'X=', '0.0', 'Y=', 
         ...               '0.0', 'Z=', '0.0', 'AZM=', '0.0', 'TS='],
         ...                 ['>HMEAS', 'ID=1002.001', 'CHTYPE=HY', 'X=', '0.0', 
         ...                     'Y=', '0.0', 'Z=', '0.0', 'AZM=', '90.0'],
         ...                 ['>HMEAS', 'ID=1003.001', 'CHTYPE=HZ', 'X=', '0.0', 'Y=',
         ...                     '0.0', 'Z=', '0.0', 'AZM=', '0.0', 'TS=', '']] 
         >>> for item in measm: 
@@ -2956,15 +3402,60 @@
                 except :
                     new_list.append(''.join([item, 'None']))
                     pass
                 else : new_list.append(''.join([item, str(addvalue)]))
 
     return new_list
                         
-
+def get_ediObjs (
+    edipath: str | object  ,
+    posix: int | None  = None
+)-> pycsamt.core.edi | mtpy.core.edi  : 
+    """ Get the collections object from edipath. 
+    
+    Parameters 
+    ---------
+    edipath: str , Path-Like object 
+        Full path to EDI-files.Must be a valid path. 
+        
+    posix: int, 
+        Position to retrieve a specific EDI object into the collection list. 
+        Will raise and error if the position index is larger than the number 
+        of EDI-files read. Default is ``None`` , returns all the collection
+        of Edi-object. 
+        
+    Retuns 
+    -------
+    ediObjs : array-like object  
+        Collection of  EDI-objects from `pyCSAMT`_ and `MTpy`_ packages 
+        
+    Examples 
+    ----------
+    >>> from pycsamt.core import get_ediObjs 
+    >>> edipath = 'data/3edis'
+    >>> ediObjs = get_ediObjs (edipath)
+    >>> ediObjs 
+    ... array([<pycsamt.core.edi.Edi object at 0x000001F74E8F7070>,
+           <pycsamt.core.edi.Edi object at 0x000001F74E8F30A0>,
+           <pycsamt.core.edi.Edi object at 0x000001F74BCBC2E0>], dtype=object)
+    """  
+    # assert that ediObjs is given rather than edipath 
+    try : ediObjs = list(map(lambda o: _assert_edi_obj(o), edipath)) 
+    except : edipath = func._assert_all_types(edipath , str )
+    else : return ediObjs if posix is None else ediObjs [posix]
+    
+    if os.path.isfile (edipath): 
+        edipath = os.path.dirname(edipath)
+    cediObjs = Edi_collection(edipath) 
+    if posix is not None: 
+        posix = func._assert_all_types(posix, int)
+        if posix >= len(cediObjs.ediObjs):  
+            raise IndexError("Expect edi position to be less than "
+                             f"{ str(len(cediObjs.ediObjs))!r}.")
+    return cediObjs.ediObjs if posix is None else cediObjs.ediObjs [posix]
                  
 
 # if __name__== '__main__': 
 #     file_14 ='csi000.dat'
 #     file_edi_2='SAMTEX.edi_2.edi'
 #     file_edi_3 ='csa000j.edi'
```

### Comparing `pycsamt-1.1.2/pycsamt/ff/core/j.py` & `pycsamt-1.2.1/pycsamt/core/j.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 # -*- coding: utf-8 -*-
 #       Created on Thu Dec  3 22:31:16 2020
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
 #       Licence: LGPL
 """
-.. _module-j:: `pycsamt.ff.core.j
+.. _module-j:: `pycsamt.core.j
 
    :synopsis: Deal with J files.  The J class can read and write an A.G.Jones file
              file, the 'standard format' of magnetotellurics.  Each section
              of the .edi file is given its own class, so the elements of each
              section are attributes for easy access.
              ...
 """
@@ -15,22 +15,22 @@
 import re
 import shutil
 import warnings
 import datetime
 import webbrowser
 import numpy as np 
 
-from pycsamt.ff.site import Site, Location, Profile 
+from pycsamt.site import Site, Location, Profile 
 from pycsamt.utils._p import notion
-from pycsamt.ff.core.edi import (Edi, Hmeasurement, Emeasurement) 
+from pycsamt.core.edi import (Edi, Hmeasurement, Emeasurement) 
 from pycsamt.utils._p import _sensitive as SB 
 from pycsamt.utils.decorator import deprecated
 import pycsamt.utils.func_utils as func
-from pycsamt.utils import exceptions as CSex
-from pycsamt.utils._csamtpylog import csamtpylog
+from pycsamt.utils.exceptions import JError
+from pycsamt._csamtpylog import csamtpylog
 
 _logger = csamtpylog.get_csamtpy_logger(__name__)
 
 class J_collection : 
     """
     J collection Class . Collect jfiles
     
@@ -169,55 +169,55 @@
             self._station_names = J.jname(number_of_sites=jstnames, 
                                         survey_name=self.survey_name)
         else : 
             try : 
                 self._station_names = J.jname(number_of_sites= int(jstnames), 
                                           survey_name=self.survey_name)
             except :
-                raise CSex.pyCSAMTError_J(
+                raise JError(
                     'Stations names must be on list or the number'
                     ' of stations not <{0}>.'.format(type(jstnames)))
                 
     
-    @deprecated("Use `pycsamt.ff.core.CSAMT.j2edi ` instead.")
+    @deprecated("Use `pycsamt.core.CSAMT.j2edi ` instead.")
     def j2edi(self, jfn=None, savepath =None, **kwargs): 
         """
         Method to convert j-files to edi files. Method calls CSAMT 
         class objectand get from this class edi infos. 
         
         :param jfn: collection of jfiles or path-like str  
         :type list_of_files: str  
 
         :rtype: str
         :returns: edifiles from Jobjects
         
         :Example:
             
-            >>> from pycsamt.ff.core.j import J_collection as JObjs
+            >>> from pycsamt.core.j import J_collection as JObjs
             >>> path2j = 'data/j' 
             >>> jObjs= JObjs().j2edi(path2j)
   
         """
         #####################################################################
-        import pycsamt.ff.core.cs  as cs_obj
+        import pycsamt.core.cs  as cs_obj
         #####################################################################
         prospect =kwargs.pop('contractor_name', None)
         #hardwareInfos = kwargs.pop('hardware_name', None)
         fileby =kwargs.pop('fileby', 'jediSoftware')
         acqby =kwargs.pop('acqby', 'jedi')
         county =kwargs.pop('county', None)
         project_name =kwargs.pop('project_name', None)
         dipole_length =kwargs.pop('dipole_length', 100.)
         rotation_angle =kwargs.pop ('rotation_angle', 0.)
        
         if jfn is not None:
             self.jfiles_list = jfn
 
         if self.jfiles_list is None : 
-            raise CSex.pyCSAMTError_J('No files found !'
+            raise JError('No files found !'
                                       ' Please provide A.G. J-files ')
         # export to savepath 
         if savepath is None : # create a folder in your current work directory
             try :
                 savepath = os.path.join(os.getcwd(), '_outputJ2EDI_')
                 if not os.path.isdir(savepath):
                     os.mkdir(savepath)#  mode =0o666)
@@ -395,15 +395,15 @@
         
         if list_of_jfiles is not None : 
             if isinstance( list_of_jfiles, str) : #we assume to read only one  file 
                 self.jfiles_list = [list_of_jfiles] 
             self.jfiles_list = sorted(list_of_jfiles)
             
         elif self.jfiles_list is None : 
-            raise CSex.pyCSAMTError_J ('Can not find a list of j files.'
+            raise JError ('Can not find a list of j files.'
                                        ' Please check your path !')
             
         # we assume that only file is read than put on list  for looping.
         if isinstance(self.jfiles_list, str): 
             self.jfiles_list =[self.jfiles_list]
         
         self._logging.info(
@@ -519,15 +519,15 @@
         :type savefig: str 
         
         .. note:: 
             Work but not stable ...
         """
         
         if list_of_jfiles is not None : self.jfiles_list= list_of_jfiles 
-        if self.jfiles_list is None : raise CSex.pyCSAMTError_J(
+        if self.jfiles_list is None : raise JError(
                 'Can not compute NoneType.Check your path')
         elif self.jfiles_list is not None :
             self.collect_jfiles(list_of_jfiles =self.jfiles_list )
             
         #######################################################################
         from pycsamt.viewer.plot import Plot1d 
         #######################################################################
@@ -603,15 +603,15 @@
         if survey_name is not None : 
             self.survey_name =survey_name 
             
         if savepath is not None: 
             self.savepath = savepath 
             
         if self.jfiles_list is  None : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'No files found to read . '
                  'Please check your path <%s>'% os.getcwd())  
         elif self.jfiles_list is not None : 
             self.collect_jfiles(list_of_jfiles =self.jfiles_list )
          
         #--- > start writing 
         write_jlines =[]
@@ -795,15 +795,15 @@
     
     .. note ::`-999` means missing data marker
             
     More attributes can be added by inputing a key word dictionary
     
     :Example:
         
-        >>> from pycsamt.ff.core import J 
+        >>> from pycsamt.core import J 
         >>> j=J()
         >>> jmode = j.jMode(polarization_type='RXY')
         >>>  print(jmode)
     """
 
     jdalpha , jdbeta ={'R':'apparent resistivities and phases', 
                           'S':'as "R" but upward-biased estimates', 
@@ -875,171 +875,171 @@
     def jperiod(self, jperds): 
         for ii, item in enumerate(jperds): 
             if item in ['','*'] or item == str(self._jnan): 
                 jperds[ii]=np.nan
         try :
             self._jperiod=np.array([float(ii) for ii in jperds])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Can not convert "str"jperiod value to float.')
     
     @property 
     def japp_rho (self): 
         return self._app_rho 
     @japp_rho.setter 
     def japp_rho (self, japp_rho): 
         for ii, item in enumerate(japp_rho): 
             if item in ['','*'] or item == str(self._jnan): 
                 japp_rho[ii]=np.nan
         try : 
             self._app_rho=np.array([float(ii) for ii in japp_rho])
         except :
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Can not convert "str" apparent resistivity value to float.')
     
     @property 
     def jpha(self): 
         return self._jpha 
     @jpha.setter 
     def jpha (self, jphase): 
         for ii, item in enumerate(jphase): 
             if item in ['','*'] or item == str(self._jnan):
                 jphase[ii]=np.nan
         try : 
             self._jpha=np.array([float(ii) for ii in jphase])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str" phase value to float.')
         
     @property 
     def jrhomax(self): 
         return self._jrhomax 
     @jrhomax.setter 
     def jrhomax (self, jrhomax): 
         for ii, item in enumerate(jrhomax): 
             if item in ['','*']or item == str(self._jnan): 
                 jrhomax[ii]=np.nan
         try : 
             self._jrhomax=np.array([float(ii) for ii in jrhomax])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str"jrhomax value to float.')
         
     @property 
     def jphamax(self): 
         return self._jphamax 
     @jphamax.setter 
     def jphamax (self, jphamax): 
         for ii, item in enumerate(jphamax): 
             if item in  ['','*'] or item == str(self._jnan): 
                 jphamax[ii]=np.nan
         try : 
             self._jphamax=np.array([float(ii) for ii in jphamax])
         except :
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str"jphamax value to float.')
         
     @property 
     def jrhomin(self): 
         return self._jrhomin 
     @jrhomin.setter 
     def jrhomin (self, jrhomin): 
         for ii, item in enumerate(jrhomin): 
             if item in ['','*']or item == str(self._jnan):
                 jrhomin[ii]=np.nan
         try : 
             self._jrhomin=np.array([float(ii) for ii in jrhomin])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str"jrhomin value to float.')
         
     @property 
     def jphamin(self): 
         return self._jphamin 
     @jphamin.setter 
     def jphamin (self, jphamin): 
         for ii, item in enumerate(jphamin): 
             if item in ['','*'] or item == str(self._jnan):
                 jphamin[ii]=np.nan
         try :
             self._jphamin=np.array([float(ii) for ii in jphamin])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str" jphamin value to float.')
         
     @property 
     def jwrho(self): 
         return self._jwrho
     @jwrho.setter 
     def jwrho (self, jwrho): 
         for ii, item in enumerate(jwrho): 
             if item in  ['','*'] or item == str(self._jnan): 
                 jwrho[ii]=np.nan
         try : 
             self._jwrho=np.array(
                 [float(ii) for ii in jwrho])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str" jwrho value to float.')
     
     @property 
     def jwpha(self): 
         return self._jwpha
     @jwpha.setter 
     def jwpha (self, jwpha): 
         for ii, item in enumerate(jwpha): 
             if item in ['','*'] or item == str(self._jnan): 
                 jwpha[ii]=np.nan
         try : 
             self._jwpha=np.array([float(ii) for ii in jwpha])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str" jwphase value to float.')
     
     @property 
     def jreal(self): 
         return self._jreal
     @jreal.setter 
     def jreal (self, jreal): 
         for ii, item in enumerate(jreal): 
             if item in ['','*'] or item == str(self._jnan): 
                 jreal[ii]=np.nan
         try : 
             self._jreal=np.array([float(ii) for ii in jreal])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str" jreal value to float.')   
 
 
     @property 
     def jimag(self): 
         return self._jimag
     @jimag.setter 
     def jimag (self, jimag): 
         for ii, item in enumerate(jimag): 
             if item in ['','*'] or item == str(self._jnan):
                 jimag[ii]=np.nan
         try : 
             self._jimag=np.array([float(ii) for ii in jimag])
         except :
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str" jimag value to float.')   
 
     @property 
     def jerror(self): 
         return self._jerror
     @jerror.setter 
     def jerror (self, jerror): 
         for ii, item in enumerate(jerror): 
             if item in ['','*'] or item == str(self._jnan):
                 jerror[ii]=np.nan
         try : 
             self._jerror=np.array([float(ii) for ii in jerror])
         except :
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str" jerror value to float.')  
 
     @property 
     def jweight(self): 
         return self._jweight
     @jweight.setter 
     def jweight (self, jweight):
@@ -1047,26 +1047,26 @@
             self._jweight = np.full((self.japp_rho.size,),1.)
         for ii, item in enumerate(jweight): 
             if item in ['','*'] or item == str(self._jnan): 
                 jweight[ii]=np.nan
         try : 
             self._jweight=np.array([float(ii) for ii in jweight])
         except : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Could not convert "str" jweight value to float.')  
 
 
     @property 
     def jmode (self):
         return self._jmode 
     
     @jmode.setter 
     def jmode(self, jpolar):
         if not isinstance(jpolar, str):
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'jMode polarization must be on str not <{}>'.format(type(jpolar)))
         self._jmode =self.jMode(polarization_type=jpolar)
         
 
     @staticmethod
     def jname( number_of_sites, survey_name= None,):
         """
@@ -1083,15 +1083,15 @@
         :rtype: list
               
         """
         alpha, cunm ='abcdefghijklmnopqrstuvwxyz', []
         if not isinstance(number_of_sites, int): 
             try :number_of_sites = int(number_of_sites)
             except : 
-                raise CSex.pyCSAMTError_J(
+                raise JError(
                     'Number of sites must be int not <{0}>.'.
                      format(type(number_of_sites)))
         for ss in range(number_of_sites):
             if survey_name is not None :
                 symb=survey_name[:2].lower() 
             else:  symb='cs'
             if ss == 0 :
@@ -1128,15 +1128,15 @@
                 'Please consults the Dictionnary of jPolarisation mode above.')
             
             [print('{0:<5}:{1:<55}'.format(keys,values)) for keys,
              values in zip(list(jmodeDICT.keys()), list(jmodeDICT.values()))]
                          
             print(notion.j)
             
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Value provided is not in polarization mode '
                  '.Please consult the dict above.') 
         
         return polarization_type
     
     def read_j (self, j_fn=None  ): 
         """
@@ -1145,29 +1145,29 @@
         :param j_fn: path to jfile 
         :type j_fn: str
         """ 
 
         jdata=[]
         if j_fn is not None : self.jfn =j_fn 
         if self.jfn is None : 
-            raise CSex.pyCSAMTError_J(
+            raise JError(
                 'Error file. Please Provide the right path!')
   
         self._logging.info('Reading A.G.Jones J-format "%s"'%os.path.basename(
             self.jfn))
         
         if self.jfn is not None : 
 
             if SB.which_file(filename=self.jfn) =='j': 
                 with open(self.jfn , 'r', encoding='utf8') as fj: 
                     j_data_lines =fj.readlines()
             else :
                 self._logging.warn("File <%s>is not J-format file." %self.jfn)
                 warnings.warn('File <%s> is not J-Format File.'% self.jfn)
-                raise CSex.pyCSAMTError_J(
+                raise JError(
                     'File provided doesn no match the J-format.'
                     ' Please consult :"http://mtnet.info/docs/jformat.txt" {0}'.\
                      format(webbrowser.open('http://mtnet.info/docs/jformat.txt')))
             
             #set attribute when loop in the file . 
             for ss , jitems in enumerate(j_data_lines):
                 # set comments infos from jfile :
@@ -1242,29 +1242,29 @@
                     self.jperiod, self.japp_rho, self.jpha, self.jrhomax , self.jrhomin , \
                         self.jphamax, self.jphamin , self.jwrho , self.jwpha = jDATA
                         
                 else :
                     warnings.warn (
                         'J-FORMAT expects to get "9" records'
                          ' values like <{0}>'.format(*list(notion.j_recordR.keys())))
-                    raise CSex.pyCSAMTError_J(
+                    raise JError(
                         'For data type=R?? Only  9 Range values are not '
                         'acceptable. You provided <{0}>'.format(JDAT.shape[1]))
             elif (re.match(r'^Z', self.jmode) is True) or \
                 (re.match(r'^T', self.jmode)  is True):
                 if JDAT.shape[1] == 5 : 
                     jDATA = [np.reshape(ii,( ii.shape[0],)) \
                              for ii in np.hsplit(JDAT,5) ]
                     self.jperiod , self.jreal , self.jimag ,\
                         self.jerror, self.jweight = jDATA
                 else :
                     warnings.warn('JFORMAT for GSC responses expects'
                                   ' to get "5" records values like<{0}>'.\
                                       format(*list(notion.j_recordZ.keys())))
-                    raise CSex.pyCSAMTError_J(
+                    raise JError(
                         'For data type=R?? Only  9 Range values'
                         ' are not acceptable. You provided <{0}>'.format(JDAT.shape[1]))
         
      
 class J_infos (object):
     """
      J_infos class - set the information of J_file
```

### Comparing `pycsamt-1.1.2/pycsamt/ff/core/z.py` & `pycsamt-1.2.1/pycsamt/core/z.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,36 +1,36 @@
 #!/usr/bin/env python
 #       Authors: Lars Krieger, Jared R. Peacock & Alison Louise Kirkby
 #       contact: < https://github.com/MTgeophysics/mtpy.git>
 #       Licence: GPL
 
 """
-.. module:: Z
-   :synopsis: Deal with MT responses Z and Tipper
-        Module belongs to  MTpy .see  https://mtpy2.readthedocs.io/en/develop/ 
-        CSAMT and MT are  very close geophysical methods
-        We slighty edited this module for CSAMT purpose. 
-        However we keep the Exception of MTpy for authorships.
-        If you use this module , please you may cite authors:
-        Kirkby, A.L., Zhang, F., Peacock, J., Hassan, R., Duan, J., 2019. 
+Module  Z
+==========
+.. _MTpy: https://github.com/MTgeophysics/mtpy.git
+
+Deal with magnetotelluric (MT) tensor responses Z and Tipper. 
+Module is copyrighted to  `MTpy`_ package. Refer to  https://mtpy2.readthedocs.io/en/develop/ 
+for additional details. If you use this module, please you may cite authors::
+    
+    * Kirkby, A.L., Zhang, F., Peacock, J., Hassan, R., Duan, J., 2019. 
         The MTPy software package for magnetotelluric data analysis and visualisation.
         Journal of Open Source Software, 4(37), 1358. https://doi.org/10.21105/joss.01358
-        ...
-
+   
 """
 
 import cmath
 import copy
 import math
 import numpy as np
 # =================================================================
 
 import pycsamt.utils.mtcalculator as MTcc
-import pycsamt.utils.exceptions as MTex
-from pycsamt.utils._csamtpylog import csamtpylog
+from pycsamt.utils.exceptions import ZError
+from pycsamt._csamtpylog import csamtpylog
 _logger = csamtpylog.get_csamtpy_logger(__name__)
 
 
 # ==============================================================================
 # Resistivity and phase object
 # ==============================================================================
 class ResPhase(object):
@@ -97,15 +97,16 @@
         if z_array is not None:
             self._z = z_array
         if z_err_array is not None:
             self._z_err = z_err_array
         if freq is not None:
             self.freq = freq
 
-        #if self._z is None or self._z_err is None or self.freq is None: #The _z_err can be None!!!
+        #if self._z is None or self._z_err is None or self.freq is None: 
+        #The _z_err can be None!!!
         if self._z is None or self.freq is None:
             raise MT_Z_Error('Values are None, check _z, _z_err, freq')
 
         self._resistivity = np.apply_along_axis(lambda x: np.abs(x) ** 2 / self.freq * 0.2,
                                                 0, self._z)
         self._phase = np.rad2deg(np.angle(self._z))
 
@@ -155,19 +156,19 @@
         self._phase = phase_array
         self.freq = freq
         self._resistivity_err = res_err_array
         self._phase_err = phase_err_array
 
         # assert real array:
         if np.linalg.norm(np.imag(res_array)) != 0:
-            raise MTex.MTpyError_inputarguments('Error - array "res" is not' + \
+            raise TypeError('Error - array "res" is not' + \
                                                 'real valued !')
 
         if np.linalg.norm(np.imag(phase_array)) != 0:
-            raise MTex.MTpyError_inputarguments('Error - array "phase" is' + \
+            raise TypeError('Error - array "phase" is' + \
                                                 'not real valued !')
 
         abs_z = np.sqrt(5.0 * self.freq * (self.resistivity.T)).T
         self._z = abs_z * np.exp(1j * np.radians(self.phase))
 
         self._z_err = np.zeros_like(self._z, dtype=np.float)
         # ---------------------------
@@ -528,15 +529,15 @@
             return
 
         inverse = copy.copy(self.z)
         for idx_f in range(len(inverse)):
             try:
                 inverse[idx_f, :, :] = np.array((np.matrix(self.z[idx_f, :, :])).I)
             except:
-                raise MTex.MTpyError_Z('The {0}ith impedance'.format(idx_f + 1) + \
+                raise ZError('The {0}ith impedance'.format(idx_f + 1) + \
                                        'tensor cannot be inverted')
 
         return inverse
 
     def rotate(self, alpha):
         """
         Rotate Z array by angle alpha.
@@ -683,15 +684,16 @@
                 lo_x_factors = np.repeat(x_factor,
                                          len(reduce_res_factor_x))
             except ValueError:
                 self._logger.error('"reduce_res_factor_x" must be valid numbers')
                 return
 
         if len(lo_x_factors) != len(self.z):
-            self._logger.error('Wrong number Number of reduce_res_factor_x - need {0}'.format(len(self.z)))
+            self._logger.error('Wrong number Number of '
+                               'reduce_res_factor_x - need {0}'.format(len(self.z)))
             return
 
         # check for iterable list/set of reduce_res_factor_y - if so,
         # it must have length 1 or same as len(z):
         if np.iterable(reduce_res_factor_y) == 0:
             try:
                 y_factor = float(reduce_res_factor_y)
@@ -790,21 +792,21 @@
             if not (distortion_tensor.shape == (2, 2)) and \
                     (distortion_err_tensor.shape == (2, 2)):
                 raise ValueError('Shape not the same')
 
             distortion_tensor = np.matrix(np.real(distortion_tensor))
 
         except ValueError:
-            raise MTex.MTpyError_Z('The array provided is not a proper' + \
+            raise ZError('The array provided is not a proper' + \
                                    'distortion tensor')
 
         try:
             DI = distortion_tensor.I
         except np.linalg.LinAlgError:
-            raise MTex.MTpyError_Z('The provided distortion tensor is' + \
+            raise ZError('The provided distortion tensor is' + \
                                    'singular - I cannot invert that!')
 
         # propagation of errors (using 1-norm) - step 1 - inversion of D:
         DI_err = np.zeros_like(distortion_err_tensor)
 
         # todo :include error on  determinant!!
         # D_det = np.linalg.det(distortion_tensor)
@@ -1234,17 +1236,18 @@
                                  in the shape of [Tx, Ty].
                                  Must be the same shape as tipper_array.
                                  *default* is None
         :type tipper_err_array: np.ndarray((nf, 1, 2))
         """
         if self.tipper_err is not None and \
                 (self._tipper_err.shape != tipper_err_array.shape):
-            raise MT_Z_Error('Shape of new "tipper_err" array does not match old' + \
-                             'new shape {0} != old shape {1}'.format(tipper_err_array.shape),
+            raise ZError('Shape of new "tipper_err" array does not match old' 
+                         'new shape {0} != old shape {1}'.format(tipper_err_array.shape,
                              self._tipper_err.shape)
+                         )
 
         # make sure the input array is of required shape
         if tipper_err_array is not None:
             if len(tipper_err_array.shape) == 3 and \
                             tipper_err_array.shape[1:3] == (1, 2):
                 if tipper_err_array.dtype in ['float', 'int']:
                     self._tipper_err = tipper_err_array
@@ -1610,29 +1613,29 @@
 
         if Z_prime.dtype not in ['complex', 'float', 'int']:
             raise
 
         Z_prime = np.matrix(Z_prime)
 
     except:
-        raise MTex.MTpyError_inputarguments('ERROR - Z array not valid!' + \
+        raise TypeError('ERROR - Z array not valid!' + \
                                             'Must be 2x2 complex array')
 
     if Z_prime_error is not None:
         try:
             if len(Z_prime_error.shape) != 2:
                 raise
             if Z_prime_error.shape != (2, 2):
                 raise
 
             if Z_prime_error.dtype not in ['float', 'int']:
                 raise
 
         except:
-            raise MTex.MTpyError_inputarguments('ERROR - Z-error array not' + \
+            raise TypeError('ERROR - Z-error array not' + \
                                                 'valid! Must be 2x2 real array')
 
     T = np.matrix(np.zeros((2, 2)))
     U = np.matrix(np.zeros((2, 2)))
 
     dummy1 = cmath.rect(1, math.radians(Ex))
 
@@ -1648,15 +1651,15 @@
     dummy4 = cmath.rect(1, math.radians(By))
     U[0, 1] = np.real(dummy4)
     U[1, 1] = np.imag(dummy4)
 
     try:
         z_arr = np.array(np.dot(T, np.dot(Z_prime, U.I)))
     except:
-        raise MTex.MTpyError_inputarguments("ERROR - Given angles do not" + \
+        raise TypeError("ERROR - Given angles do not" + \
                                             "define basis for 2 dimensions - cannot convert Z'")
 
     z_err_arr = copy.copy(Z_prime_error)
 
     # TODO: calculate error propagation
 
     return z_arr, z_err_arr
```

### Comparing `pycsamt-1.1.2/pycsamt/ff/processing/corr.py` & `pycsamt-1.2.1/pycsamt/processing/corr.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,51 +1,66 @@
 # -*- coding: utf-8 -*-
 #       Created on Sat Dec 12 13:55:47 2020
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
-#       Licence: LGPL
-""" 
-.. _module-Shifting::`pycsamt.ff.processing.corr` 
-        :synopsis: Deal with all data files. It corrects apparent resistivity
-                by shitibg value to rj static factor . Apply correction 
-                and filters. Some filters applied to correct apparent
-                 resistivities are TMA , AMA and FLMA. 
-        ...
-        
-Created on Sat Dec 12 13:55:47 2020
-"""
+#       Licence: GPL
+
+import os 
 import copy 
 import warnings
 import numpy as np 
 import pandas as pd 
 import matplotlib.pyplot as plt
 import scipy.interpolate  as spi 
 
-from pycsamt.ff.core.cs import CSAMT
-from pycsamt.ff.core  import z as CSAMTz
+try : 
+    from mtpy.core.mt import MT
+except :
+    pass 
+
+from pycsamt.__init__ import is_installing 
+from pycsamt.core.edi import Edi 
+from pycsamt.core.cs import CSAMT
+from pycsamt.core  import z as CSAMTz
 from pycsamt.utils import zcalculator as Zcc
-from pycsamt.utils._csamtpylog import csamtpylog
 from pycsamt.utils.decorator import deprecated
-from pycsamt.utils import exceptions as CSex
 from pycsamt.utils import func_utils as func 
+from pycsamt._csamtpylog import csamtpylog
+from pycsamt.utils.exceptions import ( 
+    ProcessingError , 
+    FrequencyError, 
+    ResistivityError, 
+    PhaseError, 
+    FileHandlingError
+    
+    )
 try : 
     from pycsamt.__init__ import itqdm 
     if itqdm : 
         import tqdm
 except: itqdm = False 
 
+try: 
+    from sklearn.decomposition import PCA 
+except : 
+    is_success = is_installing ('sklearn')
+    if not is_success : 
+        raise ImportError( 'Could not import module `sklearn`. Please '
+                          'install scikit-learn manually.')
+
+
 TAGS =dict(
     ama= 'Adaptative moving-average', 
     tma = 'Trimming moving-average',
     flma = 'Fixed-length dipole moving-average', 
     ss = 'MT remove static-shift',
     dist = 'MT remove distorsion',
     ) 
-class shifting(object):
+class Processing(object):
     """ 
-    processing class : shifting processing workflow correction  class
+    processing class : Processing workflow correction  class
      deal with  AVG Zonge station file "*.stn" or SEG-EDI file. 
      
      
     Arguments
     ----------
         **data_fn** : str 
                     path to Zonge *AVG file or SEG-EDI files or jfiles
@@ -87,18 +102,18 @@
     
      .. note:: Reference frequency doesnt need to  be on frequency range
                If value is not in frequency array, program will 
                interpolate value
     
    :Example:
        
-       >>> from pycsamt.ff.processing.corr import Shifting
+       >>> from pycsamt.processing.corr import Processing
        >>> path =  os.path.join(os.environ["pyCSAMT"], 
        ...                       'pycsamt','data', LCS01.AVG)
-       ... static_cor =shifting().TMA (data_fn=path,
+       ... static_cor =Processing().TMA (data_fn=path,
        ...                                 reference_freq=1024.,
        ...                                 number_of_TMA_points =5 )
        ... print(static_cor)   
     """
     
     def __init__(self, data_fn=None , freq_array=None, 
                  res_array=None, phase_array =None , verbose =0,
@@ -106,14 +121,15 @@
         
         self._logging =csamtpylog.get_csamtpy_logger(self.__class__.__name__)
         
         self.data_fn =data_fn 
         self._freq_array =freq_array 
         self._res_array =res_array
         self.verbose = verbose 
+        self.component = kwargs.pop('component', 'xy')
         self.profile_fn = kwargs.pop('profile_fn', None)
         self.savepath = kwargs.pop('savepath', None)
         
         self._reference_frequency =None 
         self._phase_array =None
         self._norm_freq=None 
         self._rj =None 
@@ -129,53 +145,53 @@
     @property 
     def frequency (self): 
         return self._freq_array
     @frequency.setter 
     def frequency(self, freq): 
         if freq.dtype not in ['float', 'int']:
             try : freq = np.array([float(ff) for ff in freq])
-            except : raise CSex.pyCSAMTError_frequency(
+            except : raise FrequencyError(
                     'Frequency must be float number!')
         else : self._freq_array=freq
         
  
     @property 
     def app_rho (self): 
         return self._res_array 
     @app_rho.setter 
     def app_rho (self, app_res): 
         if app_res.dtype not in ['float', 'int']: 
             try : app_res =np.array([float(res) for res in app_res])
-            except : raise CSex.pyCSAMTError_rho(
+            except : raise ResistivityError(
                     'Apparent resistivities values must be float number.!')
         self._res_array=app_res
             
     @property 
     def referencefreq(self):
         return self._reference_frequency 
     @referencefreq.setter
     def referencefreq(self, reffreq):
         
         if isinstance(reffreq, tuple) : # the case where value are preforced 
             reffreq = reffreq[0]
         try :reffreq =float(reffreq)
-        except:raise CSex.pyCSAMTError_frequency(
+        except:raise FrequencyError(
             'Reference frequency must be a float or int number.')
 
         if reffreq not in self.frequency:
             print('---> Reference frequency is not in frequeny range'
                   ' frequency should be will be interpolated')
             if reffreq < self._freq_array.min() or reffreq >\
                 self._freq_array.max():
                 warnings.warn(
                     'Frequency out off the range, Please provide frequency'
                     'inside the range <{0}  to {1}>'.format(
                         self._freq_array.min(),self._freq_array.max()))
                                                           
-                raise CSex.pyCSAMTError_frequency(
+                raise FrequencyError(
                     'Frequency out of the range !')
                 
             self._reference_frequency =Zcc.find_reference_frequency(
                 freq_array=self.frequency, reffreq_value=reffreq ,
                                             sharp=True, etching=True)
                                                                     
         else : self._reference_frequency= reffreq
@@ -188,23 +204,24 @@
         try : 
             if isinstance(phz, tuple):
                 phz = phz[0]
 
             phz=np.array([float(pzz) for pzz in phz])
         except:
             
-            raise CSex.pyCSAMTError_Phase(
+            raise PhaseError(
             'Phase input must be a float number and radians.')
 
         self._phase_array=phz
         
 
     def read_processing_file(self, data_fn=None , 
                              profile_fn=None,
                               reference_freq=None,
+                              component =None, 
                               **kwargs ):
         """
         Mehod read processing files and load attributes for use.
         
         :param data_fn: full path to data file ,  coulb be `avg` of 
             Zonge International Engineering  or `edi`  of Society of 
             Exploration Geophysics or `j|dat` format of AG.Jones MT.
@@ -228,30 +245,32 @@
         if freq_array  is not None : 
             self.frequency = freq_array
         
         if res_array is not None : 
             self.res_app_obj = res_array 
         if phase_array is not None:
             self.phase_obj = phase_array
-        
+        if component is not None: 
+            self.component = component 
+            
         flag = 0            # flag to figure out edifiles to to use avg  file
                             # without it profile stn could be possible 
         if self.data_fn is None :
             if self.frequency is None or self.res_app_obj is None or \
                 self.phase_obj is None :
                 mess= ''.join([
                     'NoneType data can not be computed. Please provide your',
                     ' data path or station dictionnaries of resistivities',
                     ' and phases values or ndarray(len(frequency),len(sites))',
                     ' of resistivities and phases values in degree.'])
                     
                 self._logging.info(mess)
                 warnings.warn(mess)
                 
-                raise CSex.pyCSAMTError_processing(
+                raise ProcessingError(
                     'Could not process data with Nonetype obj!'
                     'Please provide your right data files or '
                     ' ndarray|dict of resistivies and phases values in degree.')
                 
             else: # enter in this loop assumes that res and  phase value are  
             #provided manually , phase values are in degree.
                 # check the len of dictionnaries
@@ -274,29 +293,30 @@
                 if len(self.res_app_obj) != len(self.phase_obj ) : 
                     mess='Resistivity and phase length must be the same.'+\
                         'The resistivity size is ={0} and phase is= {1}'
                     warnings.warn(mess.format(len(self.res_app_obj,
                                                   len(self.phase_obj))))
                     self._logging.error(mess.format(len(self.res_app_obj,
                                                         len(self.phase_obj))))              
-                    raise CSex.pyCSAMTError_processing(
+                    raise ProcessingError(
                         'Resistivity and phase must be the same length!')
                     
                 # convert values in rad 
                 self.phase_obj = {stn: np.deg2rad(phs_values %90)
                              for stn,phs_values in self.phase_obj.items()}
                               
         if self.data_fn is not None :
     
             if self.data_fn.lower().endswith('avg') is True :
                 flag=1
                 
             try : 
                 csamt_obj = CSAMT(data_fn = self.data_fn, 
-                                    profile_fn =self.profile_fn)
+                                    profile_fn =self.profile_fn,
+                                    component=self.component)
                 self.frequency = csamt_obj.freq 
                 self.res_app_obj = csamt_obj.resistivity
                 self.phase_obj ={ key:np.deg2rad(values) 
                             for key, values in csamt_obj.phase.items()
                             }
                 self.site_id= sorted(self.res_app_obj.keys())
                 self.station_distance = csamt_obj.station_distance 
@@ -311,16 +331,16 @@
                     warnings.warn(mess)
                     self.dipolelength = 50.
                 else :
                     if self.dipolelength is None:
                         warnings.warn(mess)
                         self.dipolelength =50.
                         
-            except CSex.pyCSAMTError_file_handling: 
-                raise CSex.pyCSAMTError_file_handling(
+            except FileHandlingError: 
+                raise FileHandlingError(
                     f" It seems {self.data_fn!r} does not exist."
                     "  Please provide the right filename or path.")            
 
             except PermissionError: 
                 l1=''.join([' https://stackoverflow.com/questions/13215716/', 
                               'ioerror-errno-13-permission-denied-when-trying-to', 
                               '-open-hidden-file-in-w-mod'])
@@ -332,15 +352,15 @@
                       f"Please consult the following links: {l1!r} and {l2!r} .")
 
             except: 
                 if flag ==1 and self.profile_fn is None: 
                     # force to read only avg data from avg object
                     # without station profile file
                     ######################################################
-                    from pycsamt.ff.core  import avg as CSAMTavg
+                    from pycsamt.core  import avg as CSAMTavg
                     ######################################################
                     
                     csamt_obj =CSAMTavg.Avg(data_fn =self.data_fn)
                     self.res_app_obj= csamt_obj.Data_section.Resistivity.loc
                     # Zonge phase are in mrad then converted to rad 
                     # for consistency converted to degree and read again 
                     self.phase_obj =csamt_obj.Data_section.Phase.loc
@@ -351,17 +371,23 @@
                     self.site_id=sorted(self.res_app_obj.keys()) 
                     # get avg data and seek the reference frequency at safety data 
                     # avg_data_section = csamt_obj.Data_section._data_array
                     self.frequency= csamt_obj.Data_section.Frequency.value 
                     self.station_distance = csamt_obj.Data_section.Station.value
                     
         # set the matrix of rho data 
+        # ignore the dimensionality of the data at each station and masked the 
+        # nan values 
+        self.phase_obj = func.resize_resphase_values(
+            self.phase_obj, return_array =False)
         self.phase_=buildBlock_freqRhoOrPhase(self.phase_obj)
         self.phase_ = np.rad2deg(self.phase_)%90 
         
+        self.res_app_obj= func.resize_resphase_values(
+            self.res_app_obj, return_array =False)
         self.app_res_= buildBlock_freqRhoOrPhase(self.res_app_obj)
         #-----------------------------------------------------------        
         #---> set reference frequency . if not will detect automatically  
         # as higher frequency with clean data 
         if reference_freq is not None :
             self.referencefreq=reference_freq
         
@@ -421,30 +447,30 @@
                station j to n. 
         
   
         1.  corrected data from [AVG]
         
         :Example:
             
-            >>> from pycsamt.ff.processing.corr import Shifting
+            >>> from pycsamt.processing.corr import Shifting
             >>> path =  os.path.join(os.environ["pyCSAMT"], 
             ...         'pycsamt','data', LCS01.AVG)
             ... static_cor =shifting().TMA (data_fn=path, 
             ...                            reference_freq=1024.,
                                         number_of_TMA_points =5 )
                   
         2. corrected from edifiles [EDI] 
         
         :Example:
             
-            >>> from pycsamt.ff.core.cs import CSAMT
-            >>> from pycsamt.ff.processing.corr import Shifting
+            >>> from pycsamt.core.cs import CSAMT
+            >>> from pycsamt.processing.corr import Processing
             >>> edipath = r'C:/Users\Administrator\Desktop\test\edirewrite'
             >>> csamt_obj =CSAMT(edipath =edipath)
-            >>> static_cor =shifting().TMA( reference_freq =256. ,
+            >>> static_cor =Processing().TMA( reference_freq =256. ,
             ...                               freq_array = csamt_obj.freq ,
             ...                               res_array = csamt_obj.resistivity , 
             ...                            phase_array =csamt_obj.phase ,
             ...                            number_of_TMA_points=5)
             ... print(static_cor)
             
         """
@@ -457,16 +483,18 @@
                                               '=', 
                                               "Trimming moving-average(TMA)"))
         
         self._logging.info (
             'Computing Trimming Moving Average  filter to correct'
             ' apparent resistivities.!')
         
-        if data_fn is not None : self.data_fn  = data_fn 
-        if profile_fn is not None : self.profile_fn = profile_fn
+        if data_fn is not None :
+            self.data_fn  = data_fn 
+        if profile_fn is not None :
+            self.profile_fn = profile_fn
         
         # print(reference_freq)
         # if reference_freq is not None : self.referencefreq = reference_freq 
         
         if res_array is not None :
             self.res_app_obj = res_array 
         if phase_array is not None : 
@@ -600,31 +628,31 @@
          .. note:: skin depth param is not to used for `FLMA` filter application.
                   It is not necessary to provide when apply for `FLMA` filter.
                   
         1. read from edipath or jpath 
         
         :Example:
             
-            >>> from pycsamt.ff.processing.corr import shifting 
+            >>> from pycsamt.processing.corr import shifting 
             >>> edipath =os.path.join(os.environ['pyCSAMT'], 'data', 'edi')
             >>> corr_obj= shifting(data_fn =edipath)
             >>> corrapp  = corr_obj.FLMA(number_of_dipole=7,
             ...                             reference_freq=1024.)
             >>> corr_obj._rj
             >>> corrapp
            
         2. read Zonge avg file 
          
         :Example:
             
-            >>> from pycsamt.ff.processing.corr import shifting 
+            >>> from pycsamt.processing.corr import Processing
             >>> avg_path = os.path.join(os.environ['pyCSAMT'], 'data', 'avg')
             >>>  csamt_obj =CSAMT(data_fn =os.path.join(avg_path, 'K2.AVG'),
             ...                  profile_fn=os.path.join(avg_path, 'K2.stn'))
-            >>> corr_obj= shifting(data_fn =os.path.join(avg_path, 'K2.AVG'),
+            >>> corr_obj= Processing(data_fn =os.path.join(avg_path, 'K2.AVG'),
             ...                     profile_fn=os.path.join(avg_path, 'K2.stn'))
             >>> corrapp  = corr_obj.FLMA(number_of_dipole=7, reference_freq=8000.)
             >>> print(corr_obj._rj)
             >>> print(corrapp)
         
         """
         profile_fn= kwargs.pop('profile_fn', None)
@@ -775,27 +803,27 @@
                  see  the docstring of `FlMA`
                  
          
         1. read from edipath or jpath 
         
         :Example:
             
-            >>> from pycsamt.ff.processing.corr import shifting 
+            >>> from pycsamt.processing.corr import shifting 
             >>> edipath =os.path.join(os.environ['pyCSAMT'], 'data', 'edi')
             >>> corr_obj= shifting(data_fn =edipath)
             >>> corrapp  = corr_obj.AMA(number_of_points=7,
             ...                             reference_freq=1024.)
             >>> corr_obj._rj
             >>> corrapp
            
         2. read Zonge avg file 
          
         :Example:
             
-            >>> from pycsamt.ff.processing.corr import shifting 
+            >>> from pycsamt.processing.corr import shifting 
             >>> avg_path = os.path.join(os.environ['pyCSAMT'], 'data', 'avg')
             >>>  csamt_obj =CSAMT(data_fn =os.path.join(avg_path, 'K2.AVG'),
             ...                  profile_fn=os.path.join(avg_path, 'K2.stn'))
             >>> corr_obj= shifting(data_fn =os.path.join(avg_path, 'K2.AVG'),
             ...                     profile_fn=os.path.join(avg_path, 'K2.stn'))
             >>> corrapp  = corr_obj.AMA(number_of_points=5, reference_freq=8000.)
             >>> print(corr_obj._rj)
@@ -815,28 +843,28 @@
                               phase_dict_arrays=phase_array, 
                               res_dict_arrays=res_array,
                               fname='ama', 
                               freq_array=freq_array)
 
         return self.ama
     
-    @deprecated('Deprecated method! use `pycsamt.ff.processing.Processing.AMA` '
-                ' or `pycsamt.ff.processing.Processing.FLMA` instead.')
+    @deprecated('Deprecated method! use `pycsamt.processing.Processing.AMA` '
+                ' or `pycsamt.processing.Processing.FLMA` instead.')
     def compute_fixed_and_adaptative_moving_average(self, filterfunc, 
                          data_fn =None, profile_fn =None ,
                          dipole_length =50., reference_freq=None, 
                          **kwargs):
         """
         Can use this fonction  to compute at the same time FLMA and AMA by 
         setting only the `filter func` argument . If the function is used 
         set the param `filterfunc` to the filter we need. Avoid repetition 
         in the code Later.
         
-        .. _filter-AMA::`pycsamt.ff.core.processing.zcalculator.compute_AMA`
-        .. _filter-AMA::`pycsamt.ff.core.processing.zcalculator.compute_FLMA`
+        * :meth:`pycsamt.core.processing.zcalculator.compute_AMA`
+        * :meth:`pycsamt.core.processing.zcalculator.compute_FLMA`
         
         :param filterfunc: filter fonction , can be :ref:`filter-AMA` or 
                             :ref:`filter-FLMA`
         :type filterfunc: obj
         
         :param data_fn: full path to data file , could be[AVG|EDI|J]
         :type data_fn: str 
@@ -851,28 +879,28 @@
                     if not provided reference will be compute automaticcally 
         :type reference_freq: int, float 
         
         1. compute fixed length dipole moving average FLMA 
         
         :Example:
             
-            >>> from pycsamt.ff.processing.corr import shifting 
+            >>> from pycsamt.processing.corr import shifting 
             >>> edipath =os.path.join(os.environ['pyCSAMT'], 'data', 'edi')
             >>> corr_obj= shifting(data_fn =edipath)
             >>> res_flma_obj  = corr_obj.compute_fixed_and_adaptative_moving_average(
                 filterfunc=Zcc.compute_FLMA,  number_of_points=7,
             ...                             reference_freq=8192.)
             >>> corr_obj._rj
             >>> res_flma_obj 
             
         2. compute adaptative moving-average AMA
         
         :Example:
             
-            >>> from pycsamt.ff.processing.corr import shifting 
+            >>> from pycsamt.processing.corr import shifting 
             >>> edipath =os.path.join(os.environ['pyCSAMT'], 'data', 'edi')
             >>> corr_obj= shifting(data_fn =edipath)
             >>> res_ama_obj   = corr_obj.compute_fixed_and_adaptative_moving_average(
                 filterfunc=Zcc.compute_FLMA,  number_of_skin_depth=7,
             ...                             reference_freq=8192.)
             >>> corr_obj._rj
             >>> res_ama_obj 
@@ -900,15 +928,15 @@
         
         if self.data_fn is None : 
             if res_array is not None: res_app_obj =res_array 
             if phase_array is not None :  phase_obj =phase_array 
             if freq_array is not None : 
                 self.frequency =freq_array 
             if res_array is None or phase_array is None or freq_array is None :
-                raise CSex.pyCSAMTError_processing('NoneType can be computed.'
+                raise ProcessingError('NoneType can be computed.'
                     ' Please provide either path to data file ' 
                     ' or provided resistivity , phase and frequeny arrays!')
         
         # be sure that if data_fn is provided , data should be read  
         # as priority 
         if self.data_fn is not None : 
             csamt_obj= CSAMT(data_fn =self.data_fn, 
@@ -1027,15 +1055,15 @@
         self.flma_or_ama ={stn: mm_rho[:,ii] 
                     for ii , stn in enumerate(stnNames)}
         # compte corrected phase  in degree 
         self.phase_corrected = {stn: np.rad2deg(mm_phase[:,ii]) %90 
                                 for ii , stn in enumerate(stnNames)}
         return self.flma_or_ama    
     
-    @deprecated ("Use 'pycsamt.ff.processing.Processing.correct_edi' instead."
+    @deprecated ("Use 'pycsamt.processing.Processing.correct_edi' instead."
                  " Faster and avoid circular reading.")
     def write_corrected_edi (self, 
                      data_fn =None,
                      reference_frequency=None, 
                      FILTER ='tma' , 
                      **kwargs):
         """
@@ -1087,38 +1115,38 @@
         savepath                str         full path to save outputfile.
         =====================  ==========  ====================================
         
         1. corrected single edifile 
         
         :Example: 
             
-            >>> from pycsamt.ff.processing import shifting
+            >>> from pycsamt.processing import shifting
             >>>  edifile =os.path.join(os.environ['pyCSAMT'], 'data', 
             ...                           'edi', 'new_csa000.edi' )
             >>> corr_obj= shifting()
             >>> corr_obj.write_corrected_edi(data_fn = edifile,
             ...                                 number_of_points =1., 
             ...                             dipole_length =50., FILTER='ss')
             
         
         2. corrected multi edifiles EMAP
         
         :Example: 
             
-            >>> from pycsamt.ff.processing import shifting
+            >>> from pycsamt.processing import shifting
             >>>  edipath =os.path.join(os.environ['pyCSAMT'], 'data', 'edi')
             >>> corr_obj= shifting()
             >>> corr_obj.write_corrected_edi(data_fn = edipath,
             ...                             number_of_points =7., 
             ...                             dipole_length =50.,
             ...                                FILTER='flma')
             
         """
         #######################################################################
-        from pycsamt.ff.core  import edi as CSAMTedi
+        from pycsamt.core  import edi as CSAMTedi
         #######################################################################
         new_edifilename =kwargs.pop('filename', None)
         number_of_points= kwargs.pop('number_of_points', 1)
         dipole_length = kwargs.pop('dipole_length', 50.)
         number_of_skin_depth= kwargs.pop('number_of_skin_depth', 3.)
         
         reduce_res_factor_x=kwargs.pop('reduce_res_factor_x', 1.)
@@ -1136,25 +1164,25 @@
         
         self.savepath =func.cpath(self.savepath , '_coutputEDI_')
         
         if FILTER is None :FILTER ='tma' # block None to default 'tma'
         
         try: _filter =FILTER.lower()
         except : 
-            raise CSex.pyCSAMTError_processing(
+            raise ProcessingError(
                 'name of filters is `str` not  `{0}`'.format(type(_filter)))
         
         
         if _filter not in ['tma', 'ama' , 'flma', 'ss', 'dist']: 
            
            warnings.warn('Filter provided is UNrecognized'
                          'we will set filter to `tma`')
            print('--> Filter is resetting to TMA')
            
-           raise CSex.pyCSAMTError_processing(
+           raise ProcessingError(
                'Filter provided is Unrecognizable!')
            
         self._logging.info('Rewrite edifiles by applying filters')
  
         # controle the range of frequencies :
             # Default range is Highest frequency to lowest 
         flip_freq =False 
@@ -1198,15 +1226,15 @@
         if datatype =='emap':           # read EMAP edifiles and apply filters 
             if _filter not in ['flma', 'tma', 'ama']:
                 print('--> Filter no found! Reseeting filter'
                       ' to  default filter :`tma`')
                 _filter ='tma'
                 
         #call now corrected obbjects
-        corr_obj =shifting(data_fn =self.data_fn , 
+        corr_obj =Processing(data_fn =self.data_fn , 
                             profile_fn =self.profile_fn )
         
         if _filter =='tma': # apply filter tma 
             res_corrected =  corr_obj.TMA( 
                 number_of_TMA_points= number_of_points,
                         reference_freq = reference_frequency)
             
@@ -1306,15 +1334,15 @@
                 if _filter =='dist': # remove only distorsion 
                     if distortion_tensor is None : 
                         warnings.warn(
                             'Could not remove distorsion .Provided real '
                             'distortion tensor as a 2x2 matrices.')
                         print('---> Remove distorsion Error ! Please provide '
                               'the distortion Tensor as 2x2 matrices. ')
-                        raise CSex.pyCSAMTError_processing(
+                        raise ProcessingError(
                             'Could not remove distorsion.Please provided real '
                             ' distortion 2x2 matrixes')
                     _, z_corrected, z_corrected_err = \
                         edi_obj.Z.remove_distortion(
                             distortion_tensor =distortion_tensor,
                             distortion_err_tensor=distortion_err_tensor)
                         
@@ -1430,72 +1458,64 @@
         savepath                str         full path to save outputfile.
         =====================  ==========  ====================================
         
         1. corrected single edifile 
         
         :Example: 
             
-            >>> from pycsamt.ff.processing import shifting
+            >>> from pycsamt.processing import shifting
             >>>  edifile =os.path.join(os.environ['pyCSAMT'], 'data', 
             ...                           'edi', 'new_csa000.edi' )
             >>> corr_obj= shifting()
             >>> corr_obj.write_corrected_edi(data_fn = edifile,
             ...                                 number_of_points =1., 
             ...                             dipole_length =50., FILTER='ss')
             
         
         2. corrected multi edifiles EMAP
         
         :Example: 
             
-            >>> from pycsamt.ff.processing import shifting
+            >>> from pycsamt.processing import shifting
             >>>  edipath =os.path.join(os.environ['pyCSAMT'], 'data', 'edi')
             >>> corr_obj= shifting()
             >>> corr_obj.write_corrected_edi(data_fn = edipath,
             ...                             number_of_points =7., 
             ...                             dipole_length =50.,
             ...                                FILTER='flma')
             
         """
         new_edifilename =kwargs.pop('filename', None)
         number_of_points= kwargs.pop('number_of_points', 1)
         dipole_length = kwargs.pop('dipole_length', 50.)
         number_of_skin_depth= kwargs.pop('number_of_skin_depth', 3.)
-        
-        reduce_res_factor_x=kwargs.pop('reduce_res_factor_x', 1.)
-        reduce_res_factor_y =kwargs.pop('reduce_res_factor_y', 1.)
-        
-        distortion_tensor =kwargs.pop('distortion_tensor', None)
-        distortion_err_tensor =kwargs.pop('distortion_err_tensor', None)
-        
-        distortion_tensor, distortion_err_tensor
-   
         datatype =kwargs.pop('datatype', None)
         savepath = kwargs.pop('savepath', None)
+        
         if savepath is not None: 
             self.savepath =savepath 
         
         self.savepath =func.cpath(self.savepath , '_coutputEDI_')
         
         if FILTER is None :FILTER ='tma' # block None to default 'tma'
         
         try: _filter =FILTER.lower()
         except : 
-            raise CSex.pyCSAMTError_processing(
+            raise ProcessingError(
                 'name of filters is `str` not  `{0}`'.format(type(_filter)))
 
         if _filter not in TAGS.keys(): 
            msg =''.join([
                f"UNknown filter {_filter!r}. Recognized filters are: ",
                f"{func.smart_format(TAGS.keys())}."])
            
            warnings.warn(msg )
-           raise CSex.pyCSAMTError_processing(msg)
+           raise ProcessingError(msg)
     
-        self._logging.info('Apply filters {_filter!r} to edifiles')
+        self._logging.info(f'Apply filters {_filter!r} to edifiles')
  
         # controle the range of frequencies :
             # Default range is Highest frequency to lowest 
         flip_freq =False 
         
         if data_fn is not None : 
             self.data_fn = data_fn # call data path  
@@ -1554,15 +1574,15 @@
             else : frequency_array =self.frequency
         
         elif _filter =='flma':
             res_corrected =  self.FLMA(number_of_dipole= number_of_points, 
                                     reference_freq = reference_frequency,
                                     dipole_length = dipole_length
                                     )
-       
+            
             phase_corrected = self.phase_corrected
             
             flip_freq =self.flip_freq 
             
             # for consistency 
             if self.frequency [0] < self.frequency[-1]:
                frequency_array =self.frequency[::-1]
@@ -1590,15 +1610,14 @@
 
         if itqdm : 
             pbar =tqdm.tqdm(total= len(edi_objs_id),
                              ascii=True,unit='B',
                              desc ='WEgeophysics-pycsamt[---> EDICorrected]', 
                              ncols =77)
             
-        
         #-----> loop all edi objects from collections edifiles 
         # print(res_corrected)
         for k , (stn, edi_obj)  in enumerate(zip (edi_objs_id , ediObjs), 1): 
             
             # create for each edi obj  temporary corrector
             #object for resetting z impedance Tensor 
             csamt_z_obj = CSAMTz.Z()
@@ -1622,57 +1641,15 @@
                     
                 res_array [:, 0 , 1 ] =  res_corrected[stn]
                 phs_array[: , 0, 1] = phase_corrected[stn]
                     
                 # now recompute  all component with corrected values
                 csamt_z_obj.set_res_phase(res_array = res_array,
                             phase_array=phs_array,
-                            freq=  frequency_array) 
-               
-             # use filters `ss` and `dist` for MT data     
-            if  datatype =='mt' or _filter in ['ss', 'dist']:       
-                if _filter =='ss':
-                    static_shift, z_corrected = \
-                        edi_obj.Z.remove_ss(
-                            reduce_res_factor_x=reduce_res_factor_x, 
-                            reduce_res_factor_y=reduce_res_factor_y)
-    
-                    csamt_z_obj.compute_resistivity_phase(
-                        z_array=z_corrected,
-                        z_err_array= edi_obj.Z.z_err, 
-                        freq=edi_obj.Z.freq)
-                # set z_erray error 
-                    z_err_array = edi_obj.Z.z_err 
-                    if self.verbose >0:
-                        print('--> Remove  static shift is done !')
-                
-                if _filter =='dist': # remove only distorsion 
-                    if distortion_tensor is None : 
-                        warnings.warn(
-                            'Could not remove distorsion .Provided real '
-                            'distortion tensor as a 2x2 matrices.')
-                        print('---> Remove distorsion Error ! Please provide '
-                              'the distortion Tensor as 2x2 matrices. ')
-                        raise CSex.pyCSAMTError_processing(
-                            'Could not remove distorsion.Please provided real '
-                            ' distortion 2x2 matrixes')
-                    _, z_corrected, z_corrected_err = \
-                        edi_obj.Z.remove_distortion(
-                            distortion_tensor =distortion_tensor,
-                            distortion_err_tensor=distortion_err_tensor)
-                        
-                    if self.verbose > 0:
-                        print('--> ! Remove  distortion is done !')
-                    
-                    z_err_array = z_corrected_err
-                    
-                csamt_z_obj.compute_resistivity_phase(z_array=z_corrected,
-                                                  z_err_array= z_err_array,
-                                                  freq=edi_obj.Z.freq)
-                                    
+                            freq=  frequency_array)                
             # Resset all components  to let edi 
             #containers to hold news corrected values 
             edi_obj.Z._z = csamt_z_obj.z
             edi_obj.Z._z_err = csamt_z_obj.z_err
             edi_obj.Z._resistivity = csamt_z_obj.resistivity 
             edi_obj.Z._resistivity_err = csamt_z_obj.resistivity_err 
             edi_obj.Z._phase = csamt_z_obj.phase
@@ -1688,15 +1665,14 @@
         # close the progress bar
         if itqdm :
             pbar.close()
         print(' completed' if itqdm else '--- correction completed ----')
         print('{0:*^77}'.format('EDI {0} FILE'.format(datatype.upper())))    
    
         for ff, name in list(TAGS.items()):
-            
             if  ff == _filter :
                 print('** {0:<27} {1} {2}'.format(
                     'Filter ','=', _filter.upper()))
                 print('** {0:<27} {1} {2}'.format(
                     'Type of correction ','=',name.capitalize()))
                 
                 if _filter =='tma' : 
@@ -1722,14 +1698,365 @@
                                           '=', len(ediObjs)))
         
         print('** {0:<27} {1} {2}'.format('Save directory',
                                           '=', self.savepath))
         print('*'*77)
         
         
+    @staticmethod 
+    def remove_static_shift( edi_fn, ss_x=1., ss_y=1., **kws):
+        """
+        Remove static shift from the apparent resistivity
+
+        Assume the original observed tensor Z is built by a static shift S
+        and an unperturbated "correct" Z0 :
+
+             * Z = S * Z0
+
+        therefore the correct Z will be :
+            * Z0 = S^(-1) * Z
+            
+        :param ss_x: correction factor for x component
+        :type ss_x: float
+    
+        :param ss_y: correction factor for y component
+        :type ss_y: float
+    
+        :returns: new Z object with static shift removed
+        :rtype: pycsamt.core.z.Z
+    
+        .. note:: The factors are in resistivity scale, so the
+                  entries of  the matrix "S" need to be given by their
+                  square-roots!
+
+        :Remove Static Shift: ::
+
+            >>> import pycsamt.processing as Processing 
+            >>> import pycsamt.processing as Processing 
+            >>> edifile = '/Users/Daniel/Desktop/Data/AMT/E1/di_test/new_csa00.edi'
+            >>> outputedi = 'rmss_csa00.edi'
+            >>> Processing.remove_static_shift(
+                edi_fn = edifile, ss_x= .5, ss_y=1.2,new_edi_fn = outputedi
+                                               )
+        """
+        
+        cedi_obj = MT(fn =edi_fn)
+        new_z_obj = cedi_obj.remove_static_shift(ss_x=ss_x , ss_y=ss_y)
+        ediobj = Edi(edi_filename=edi_fn)
+        ediobj.write_new_edifile( new_Z=new_z_obj, **kws)
+        return new_z_obj  
+        
+        
+    @staticmethod 
+    def remove_distortion( edi_fn , num_freq=None, **kws):
+        """
+        remove distortion following Bibby et al. [2005].
+
+        :param num_freq: number of frequencies to look for distortion from the
+                         highest frequency
+        :type num_freq: int
+
+        :returns: Distortion matrix
+        :rtype: np.ndarray(2, 2, dtype=real)
+
+        :returns: Z with distortion removed
+        :rtype: pycsamt.core.z.Z
+
+        :Remove distortion and write new .edi file: ::
+
+            >>> import pycsamt.processing as Processing 
+            >>> import pycsamt.ff.processing as Processing 
+            >>> edifile = '/Users/Daniel/Desktop/Data/AMT/E1/di_test/new_csa00.edi'
+            >>> outputedi = 'rmss_csa00.edi'
+            >>> Processing.remove_distortion(edi_fn = edifile, new_edi_fn= outputedi
+                )
+
+        """
+        dedi_obj = MT(fn =edi_fn)
+        D, new_z = dedi_obj.remove_distortion()
+        ediobj = Edi(edi_filename=edi_fn)
+        ediobj.write_new_edifile( new_Z=new_z, **kws)
+        return D, new_z   
+        
+    @staticmethod 
+    def noiseRemoval(edi_fn = None, kind='sim', **kws): 
+        """ Remove multiple noises in EDIs and save to new files. Noise can be 
+        either a `staticshift` , `distorsion` noises or other interferences. 
+        
+        For Electromagnetic Array Profiling (EMAP) data correction, may refer to 
+        :meth:`pycsamt.processing.Processing.correct_edi`. The Remove 
+        distortion following Bibby et al. [2005]. Remove static shift from the 
+        apparent resistivity assume the original observed tensor Z is built by
+        a static shift S and an unperturbated 
+        
+             * Z = S * Z0
+     
+        therefore the correct Z will be :
+            
+            * Z0 = S^(-1) * Z
+                
+        :param edi_fn: Path-Like object. Full path to EDI-files. 
+        :type edi_fn: str 
+        
+        :param kind: Type of noise to remove. Can be a static shift effect for 
+            ``ss``, distorsion for ``dist``. The human activites can be removed 
+            using the `pca`` and the other interferences can be removed using 
+            the simplier filters ``sim``. Default is ``sim``. 
+        :type kind: str 
+        
+        :param ss_x: correction factor for x component
+        :type ss_x: float
+    
+        :param ss_y: correction factor for y component
+        :type ss_y: float
+        
+        :param num_freq: number of frequencies to look for distortion from the
+                         highest frequency
+        :type num_freq: int
+
+        :returns: Distortion matrix
+        :rtype: np.ndarray(2, 2, dtype=real)
+    
+        :returns: 
+            - new Z object with static shift removed
+            - Distortion matrix
+            
+        :rtype: pycsamt.core.z.Z
+        
+        .. note:: The factors are in resistivity scale, so the
+                  entries of  the matrix "S" need to be given by their
+                  square-roots!
+                  
+        :Example:
+            >>> from pycsamt.processing import Processing 
+            >>> edipath = '/Users/Desktop/ediout/'
+            >>> Processing.noiseRemoval(edi_fn =edipath)
+            
+        :See also: 
+            
+            - MTpy of Alison.Kirkby@ga.gov.au via https://github.com/MTgeophysics/mtpy
+            
+        """
+        kind =str(kind).lower() 
+        if kind in ('ss', 'staticshift'): kind =='ss'
+        elif kind in ('dt', 'dist', 'distortion'): kind =='dt'
+        elif kind in  ('principal component analysis', 'pca', 'sklearn'): 
+            kind ='pca'
+        elif kind in ('simple', 's0', 'simplier', 'light', 'base'): 
+            kind ='sim' 
+        else : 
+            raise ValueError(f"Wrong Param `kind`: {kind}. "
+                             "Should be `ss` or `dist`"
+                             )
+        if os.path.isfile(edi_fn): 
+            edi_fn = os.path.dirname (edi_fn) # keep only the path 
+        if not os.path.dirname(edi_fn): 
+            raise ValueError(f'Wrong given EDI path: {edi_fn}')
+            
+        D= None 
+        # show progress bar 
+        if itqdm : 
+            pbar =tqdm.tqdm(total= len(os.listdir(edi_fn)),ascii=True,unit='B',
+                             desc ='WEgeophysics-pycsamt[---> NoiseRemoval]', 
+                             ncols =77)
+        for k, edi in enumerate (os.listdir(edi_fn)): 
+            edifile = os.path.join(edi_fn, edi)
+            with warnings.catch_warnings(): # ignore multiple warnings 
+                warnings.simplefilter('ignore')
+                if kind =='ss': 
+                    new_z = Processing.remove_static_shift(edifile, **kws)
+                elif kind =='dt': 
+                    D, new_z = Processing.remove_distortion (edifile, **kws)
+                elif kind =='pca': 
+                    new_z = Processing.pca_filter(edifile, **kws)
+                elif kind =='sim': 
+                    new_z = Processing.simpler_filter(edifile, **kws)
+            # show the progress bar ;
+            if itqdm :
+                pbar.update(k)
+        # close the progress bar
+        if itqdm :
+            pbar.close()
+    
+        print(' completed' if itqdm else '--- process completed ----')
+        
+        return new_z, D 
+     
+    @staticmethod 
+    def pca_filter (edi_fn, var=.95 , **kws): 
+        """ Sanitize EDIs data and remove the outliers using the principal 
+        component analysis (PCA).
+        
+        In considering the human activity noises removal using the PCA
+        
+        :param edi_fn: Path-Like object. Full path to EDI-file. 
+        :type edi_fn: str 
+        
+        :param var: component or ratio of moise to remove.  Default value is 
+            ``.95``. 
+        :type var: float
+        
+        :param kws: Additional keywords arguments from
+            :mod:`sklearn.decomposition.PCA` 
+        :type kws: dict 
+        
+        :returns: New Z impedance object with remove outliers. 
+
+        :rtype: pycsamt.core.z.Z
+        
+        :Example: 
+        >>> from pycsamt.processing import Processing 
+        >>> from pycsamt.core.edi import Edi 
+        >>> edifile = '/home/edi/m20.E000.edi'
+        >>> newZ =Processing.pca_filter ( edifile, var =.80 ) 
+        >>> #write a new corrected edifile 
+        >>> _= Edi(edifile).write_new_edifile(new_Z= newZ, 
+        ...               new_edi_fn ='m20.removeO.E000.edi')
+            
+        """
+ 
+        def reshape_and_fit_z (z , back =False , fit= 'transform') :
+            """ Reshape z for to np.ndarray(nfreq, 1) for scikit-learn API  
+            back for filling the z ndarray (nfreq, 2, 2)"""
+            z = z.reshape ((1, z.shape [0])) if back else z.reshape (
+                (z.shape [1], 1)) 
+             
+            z = (pca.fit_transform(z) if fit =='transform' else 
+                 pca.inverse_transform(z) ) if fit is not None else z 
+            return z 
+
+                              
+        edi_fn = func._assert_all_types(edi_fn, str)
+        if not os.path.isfile(edi_fn): 
+            raise ValueError(f'Wrong given EDI file: {edi_fn}')
+    
+        if isinstance (var, str):
+            try : var =float(var) 
+            except: 
+                if '%' in var: 
+                    var = float(var.replace('%', ''))*1e-2
+                else: 
+                    raise ValueError('Variance could be a float '
+                                     f'value not: {type(var).__name__!r}')
+        if var > 1.: 
+            raise ValueError('Variance ratio should be '
+                             f'less than 1 :{str(var)!r}')
+    
+        #create an EDI OBJECT 
+        ediObj = Edi(edi_fn )
+        # make a new object 
+        new_Z = CSAMTz.Z(z_array=np.zeros((ediObj.Z.freq.shape[0], 2, 2),
+                                       dtype='complex'),
+                      z_err_array=np.zeros((ediObj.Z.freq.shape[0], 2, 2)),
+                      freq=ediObj.Z.freq)
+       
+        # construct the pca object from sklearn 
+        pca = PCA(n_components= var, **kws) 
+        # loop to remove outliers on the Z impedance object 
+        for ii in range(2):
+            for jj in range(2):
+                # need to look out for zeros in the impedance
+                # get the indicies of non-zero components
+                nz_index = np.nonzero(ediObj.Z.z[:, ii, jj])
+                 
+                if len(nz_index[0]) == 0:
+                    continue
+                # get the non_zeros components 
+                with np.errstate(all='ignore'):
+                    z_real = ediObj.Z.z[nz_index, ii, jj].real
+                    z_imag = ediObj.Z.z[nz_index, ii, jj].imag
+                    z_err = ediObj.Z.z_err[nz_index, ii, jj]
+    
+                    z_real_t =reshape_and_fit_z(z_real) 
+                    z_imag_t = reshape_and_fit_z(z_imag) 
+                    z_err_t = reshape_and_fit_z(z_err)               
+                    z_real_b =reshape_and_fit_z(z_real_t,back=True,fit =None) 
+                    z_imag_b = reshape_and_fit_z(z_imag_t,back=True,fit =None) 
+                    z_err_b = reshape_and_fit_z(z_err_t,back=True,fit =None 
+
+                                                ) 
+               # set the new Z object 
+                new_Z.z[nz_index, ii, jj] = z_real_b  + 1j * z_imag_b 
+                new_Z.z_err[nz_index, ii, jj] = z_err_b
+                
+        # compute resistivity and phase for new Z object
+        new_Z.compute_resistivity_phase()
+     
+        return new_Z
+    
+    @staticmethod 
+    def simpler_filter (edi_fn, **kws): 
+        """ Sanitize EDIs data and remove the outliers using simple 
+        fitting function. 
+        
+        In considering the other interferences noises removal using the base 
+        or simpler filter via fitting impedances values. 
+        
+        
+        :param edi_fn: Path-Like object. Full path to EDI-file. 
+        :type edi_fn: str 
+        
+        :param kws: additional keyword arguments for correct values 
+        
+        :Example: 
+        >>> from pycsamt.processing import Processing 
+        >>> from pycsamt.core.edi import Edi 
+        >>> edifile = '/home/edi/m20.E000.edi'
+        >>> newZ =Processing.simple_removal( edifile ) 
+        >>> #write a new corrected edifile 
+        >>> _= Edi(edifile).write_new_edifile(new_Z= newZ, 
+        ...               new_edi_fn ='m20.removeSR.E000.edi')
+        
+        """
+        
+        edi_fn = func._assert_all_types(edi_fn, str)
+        if not os.path.isfile(edi_fn): 
+            raise ValueError(f'Wrong given EDI file: {edi_fn}')
+    
+        #create an EDI OBJECT 
+        ediObj = Edi(edi_fn )
+        
+        # make a new object 
+        new_Z = CSAMTz.Z(z_array=np.zeros((ediObj.Z.freq.shape[0], 2, 2),
+                                       dtype='complex'),
+                      z_err_array=np.zeros((ediObj.Z.freq.shape[0], 2, 2)),
+                      freq=ediObj.Z.freq)
+    
+        # loop to correct the Z impedance object values 
+        for ii in range(2):
+            for jj in range(2):
+                # need to look out for zeros in the impedance
+                # get the indicies of non-zero components
+                nz_index = np.nonzero(ediObj.Z.z[:, ii, jj])
+        
+                if len(nz_index[0]) == 0:
+                    continue
+                # get the non_zeros components 
+                with np.errstate(all='ignore'):
+                    z_real = func.reshape(
+                        ediObj.Z.z[nz_index, ii, jj].real)
+                    z_imag = func.reshape(
+                        ediObj.Z.z[nz_index, ii, jj].imag)
+                    z_err = func.reshape(
+                        ediObj.Z.z_err[nz_index, ii, jj]) 
+                    # correct the values 
+                    z_real_c, *_ =func.scale_values (z_real,**kws) 
+                    z_imag_c, *_ = func.scale_values(z_imag, **kws) 
+                    z_err_c, *_ = func.scale_values(z_err, **kws) 
+                    
+               # set the new Z object 
+                new_Z.z[nz_index, ii, jj] = func.reshape(
+                    z_real_c, 1)   + 1j * func.reshape(z_imag_c, 1) 
+                new_Z.z_err[nz_index, ii, jj] = func.reshape(z_err_c, 1)
+                
+        # compute resistivity and phase for new Z object
+        new_Z.compute_resistivity_phase()
+     
+        return new_Z
+
 def interp_to_reference_freq(freq_array, rho_array, 
                              reference_freq, plot=False): 
     """
     Interpolate frequencies to the reference frequencies.
     
     :param freq_array:  frequency array
     :type freq_array: array_like
@@ -1746,15 +2073,15 @@
        raise TypeError(
            'Apparent Resistivities values must be on float number')
     # do it in the case dtype value are integer.  
     freqObj=np.array([float(kk) for kk in freqObj]) 
     rhoObj=np.array([float(kk) for kk in rhoObj])
     
     if reference_freq not in freqObj : 
-        raise CSex.pyCSAMTError_frequency(
+        raise FrequencyError(
             'Reference frequency selected as input '
         'argument is not Found on the frequency array.'
             ' Please select the right frequency ')
     
     def cut_off_array_to_interp(freq_array, reference_freq,
                                 kind_interp='linear'):
 
@@ -1807,19 +2134,15 @@
     """
 
     df_= pd.DataFrame(dictRhoOrPhase)
     data_block = df_.to_numpy()
     return data_block 
 
 
-  
-    
-    
-    
-    
+
```

### Comparing `pycsamt-1.1.2/pycsamt/ff/site.py` & `pycsamt-1.2.1/pycsamt/site.py`

 * *Files 6% similar despite different names*

```diff
@@ -9,4666 +9,4642 @@
 00000080: 2020 2020 204c 6963 656e 6365 3a20 4c47       Licence: LG
 00000090: 504c 0d0a 696d 706f 7274 206f 730d 0a69  PL..import os..i
 000000a0: 6d70 6f72 7420 7265 0d0a 696d 706f 7274  mport re..import
 000000b0: 2074 696d 650d 0a69 6d70 6f72 7420 7368   time..import sh
 000000c0: 7574 696c 0d0a 696d 706f 7274 2077 6172  util..import war
 000000d0: 6e69 6e67 7320 0d0a 696d 706f 7274 206e  nings ..import n
 000000e0: 756d 7079 2061 7320 6e70 200d 0a0d 0a66  umpy as np ....f
-000000f0: 726f 6d20 7079 6373 616d 742e 7574 696c  rom pycsamt.util
-00000100: 7320 696d 706f 7274 205f 7020 6173 2069  s import _p as i
-00000110: 6e46 4f0d 0a66 726f 6d20 7079 6373 616d  nFO..from pycsam
-00000120: 742e 7574 696c 7320 696d 706f 7274 2065  t.utils import e
-00000130: 7863 6570 7469 6f6e 7320 6173 2043 5365  xceptions as CSe
-00000140: 780d 0a66 726f 6d20 7079 6373 616d 742e  x..from pycsamt.
-00000150: 7574 696c 7320 696d 706f 7274 2067 6973  utils import gis
-00000160: 5f74 6f6f 6c73 2061 7320 6769 7320 0d0a  _tools as gis ..
-00000170: 6672 6f6d 2070 7963 7361 6d74 2e75 7469  from pycsamt.uti
-00000180: 6c73 2069 6d70 6f72 7420 6176 675f 7574  ls import avg_ut
-00000190: 696c 7320 6173 2063 6675 6e63 0d0a 6672  ils as cfunc..fr
-000001a0: 6f6d 2070 7963 7361 6d74 2e75 7469 6c73  om pycsamt.utils
-000001b0: 2e5f 6373 616d 7470 796c 6f67 2069 6d70  ._csamtpylog imp
-000001c0: 6f72 7420 6373 616d 7470 796c 6f67 0d0a  ort csamtpylog..
-000001d0: 6672 6f6d 2070 7963 7361 6d74 2e75 7469  from pycsamt.uti
-000001e0: 6c73 2069 6d70 6f72 7420 6675 6e63 5f75  ls import func_u
-000001f0: 7469 6c73 2020 6173 2066 756e 630d 0a5f  tils  as func.._
-00000200: 6c6f 6767 6572 203d 2063 7361 6d74 7079  logger = csamtpy
-00000210: 6c6f 672e 6765 745f 6373 616d 7470 795f  log.get_csamtpy_
-00000220: 6c6f 6767 6572 285f 5f6e 616d 655f 5f29  logger(__name__)
-00000230: 0d0a 0d0a 7472 7920 3a20 0d0a 2020 2020  ....try : ..    
-00000240: 696d 706f 7274 2073 6369 7079 2061 7320  import scipy as 
-00000250: 7370 200d 0a20 2020 2069 6d70 6f72 7420  sp ..    import 
-00000260: 7363 6970 792e 7374 6174 7320 6173 2073  scipy.stats as s
-00000270: 7053 5441 5453 0d0a 2020 2020 7363 6970  pSTATS..    scip
-00000280: 795f 7665 7273 696f 6e20 3d20 5b69 6e74  y_version = [int
-00000290: 2876 6572 7329 2066 6f72 2076 6572 7320  (vers) for vers 
-000002a0: 696e 2073 702e 5f5f 7665 7273 696f 6e5f  in sp.__version_
-000002b0: 5f2e 7370 6c69 7428 272e 2729 5d20 235b  _.split('.')] #[
-000002c0: 312c 342c 315d 0d0a 2020 2020 6966 2073  1,4,1]..    if s
-000002d0: 6369 7079 5f76 6572 7369 6f6e 205b 305d  cipy_version [0]
-000002e0: 203d 3d20 3120 3a20 0d0a 2020 2020 2020   == 1 : ..      
-000002f0: 2020 6966 2073 6369 7079 5f76 6572 7369    if scipy_versi
-00000300: 6f6e 205b 315d 203c 2034 203a 0d0a 2020  on [1] < 4 :..  
-00000310: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00000320: 6773 2e77 6172 6e28 274e 6f74 653a 206e  gs.warn('Note: n
-00000330: 6565 6420 7363 6970 7920 7665 7273 696f  eed scipy versio
-00000340: 6e20 312e 342e 3020 6f72 206d 6f72 6520  n 1.4.0 or more 
-00000350: 2e20 4974 206d 6179 2027 0d0a 2020 2020  . It may '..    
-00000360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000370: 2020 2020 2020 2770 726f 6261 626c 7920        'probably 
-00000380: 2067 6574 2061 2074 726f 7562 6c65 2077   get a trouble w
-00000390: 6865 6e20 696d 706f 7274 2022 7374 6174  hen import "stat
-000003a0: 7322 2061 7474 7269 6275 7465 270d 0a20  s" attribute'.. 
-000003b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000003c0: 2020 2020 2020 2020 2027 756e 6465 7220           'under 
-000003d0: 7375 6368 2076 6572 7369 6f6e 2e49 7420  such version.It 
-000003e0: 6d61 7920 7072 6f62 6162 6c79 206d 6f76  may probably mov
-000003f0: 6520 6672 6f6d 2027 2c0d 0a20 2020 2020  e from ',..     
-00000400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000410: 2020 2020 2049 6d70 6f72 7457 6172 6e69       ImportWarni
-00000420: 6e67 290d 0a20 2020 2020 2020 2020 2020  ng)..           
-00000430: 205f 6c6f 6767 6572 2e77 6172 6e69 6e67   _logger.warning
-00000440: 2827 4e6f 7465 3a20 6e65 6564 2073 6369  ('Note: need sci
-00000450: 7079 2076 6572 7369 6f6e 2030 2e31 342e  py version 0.14.
-00000460: 3020 6f72 2068 6967 6865 7220 6f72 2066  0 or higher or f
-00000470: 6f72 270d 0a20 2020 2020 2020 2020 2020  or'..           
-00000480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000490: 2027 2073 7461 7473 2e6c 696e 6561 7265   ' stats.lineare
-000004a0: 6772 6573 732e 2055 6e64 6572 2073 7563  gress. Under suc
-000004b0: 6820 7665 7273 696f 6e27 0d0a 2020 2020  h version'..    
-000004c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000004d0: 2020 2020 2020 2020 2769 7420 6d69 6768          'it migh
-000004e0: 7420 6e6f 7420 776f 726b 2e27 290d 0a20  t not work.').. 
-000004f0: 2020 2023 2066 726f 6d20 7370 2069 6d70     # from sp imp
-00000500: 6f72 7420 7374 6174 7320 0d0a 2020 2020  ort stats ..    
-00000510: 7374 6174 735f 696d 706f 7274 203d 5472  stats_import =Tr
-00000520: 7565 200d 0a20 2020 2020 2020 2020 2020  ue ..           
-00000530: 200d 0a65 7863 6570 7420 3a0d 0a20 2020   ..except :..   
-00000540: 2077 6172 6e69 6e67 732e 7761 726e 2827   warnings.warn('
-00000550: 436f 756c 6420 6e6f 7420 6669 6e64 2073  Could not find s
-00000560: 6369 7079 2e73 7461 7473 2c20 6361 6e6e  cipy.stats, cann
-00000570: 6f74 2075 7365 206d 6574 686f 6420 6c69  ot use method li
-00000580: 6e65 6172 7265 6772 6573 7369 6f6e 270d  nearregression'.
-00000590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000005a0: 2020 2027 6368 6563 6b20 696e 7374 616c     'check instal
-000005b0: 6c61 7469 6f6e 2079 6f75 2063 616e 2067  lation you can g
-000005c0: 6574 2073 6369 7079 2066 726f 6d20 7363  et scipy from sc
-000005d0: 6970 792e 6f72 672e 2729 0d0a 2020 2020  ipy.org.')..    
-000005e0: 5f6c 6f67 6765 722e 7761 726e 696e 6728  _logger.warning(
-000005f0: 2743 6f75 6c64 206e 6f74 2066 696e 6420  'Could not find 
-00000600: 7363 6970 792e 7374 6174 732c 2063 616e  scipy.stats, can
-00000610: 6e6f 7420 7573 6520 6d65 7468 6f64 206c  not use method l
-00000620: 696e 6561 7265 6772 6573 7327 0d0a 2020  inearegress'..  
-00000630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000640: 2020 2763 6865 636b 2069 6e73 7461 6c6c    'check install
-00000650: 6174 696f 6e20 796f 7520 6361 6e20 6765  ation you can ge
-00000660: 7420 7363 6970 7920 6672 6f6d 2073 6369  t scipy from sci
-00000670: 7079 2e6f 7267 2e27 290d 0a20 2020 200d  py.org.')..    .
-00000680: 0a20 2020 2073 7461 7473 5f69 6d70 6f72  .    stats_impor
-00000690: 7420 3d46 616c 7365 200d 0a0d 0a23 3d3d  t =False ....#==
-000006a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000006b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000006c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000006d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000006e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2320  ============..# 
-000006f0: 4c4f 4341 5449 4f4e 2043 4c41 5353 200d  LOCATION CLASS .
-00000700: 0a23 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  .#==============
+000000f0: 726f 6d20 7079 6373 616d 742e 5f63 7361  rom pycsamt._csa
+00000100: 6d74 7079 6c6f 6720 696d 706f 7274 2063  mtpylog import c
+00000110: 7361 6d74 7079 6c6f 670d 0a66 726f 6d20  samtpylog..from 
+00000120: 7079 6373 616d 742e 7574 696c 7320 696d  pycsamt.utils im
+00000130: 706f 7274 205f 7020 6173 2069 6e46 4f0d  port _p as inFO.
+00000140: 0a66 726f 6d20 7079 6373 616d 742e 7574  .from pycsamt.ut
+00000150: 696c 7320 696d 706f 7274 2067 6973 5f74  ils import gis_t
+00000160: 6f6f 6c73 2061 7320 6769 7320 0d0a 6672  ools as gis ..fr
+00000170: 6f6d 2070 7963 7361 6d74 2e75 7469 6c73  om pycsamt.utils
+00000180: 2069 6d70 6f72 7420 6176 675f 7574 696c   import avg_util
+00000190: 7320 6173 2063 6675 6e63 0d0a 6672 6f6d  s as cfunc..from
+000001a0: 2070 7963 7361 6d74 2e75 7469 6c73 2069   pycsamt.utils i
+000001b0: 6d70 6f72 7420 6675 6e63 5f75 7469 6c73  mport func_utils
+000001c0: 2020 6173 2066 756e 630d 0a66 726f 6d20    as func..from 
+000001d0: 7079 6373 616d 742e 7574 696c 732e 6578  pycsamt.utils.ex
+000001e0: 6365 7074 696f 6e73 2069 6d70 6f72 7420  ceptions import 
+000001f0: 2820 0d0a 2020 2020 5374 6174 696f 6e45  ( ..    StationE
+00000200: 7272 6f72 2c20 0d0a 2020 2020 4c6f 6361  rror, ..    Loca
+00000210: 7469 6f6e 4572 726f 722c 200d 0a20 2020  tionError, ..   
+00000220: 2050 726f 6669 6c65 4572 726f 722c 200d   ProfileError, .
+00000230: 0a20 2020 2053 6974 6545 7272 6f72 2c20  .    SiteError, 
+00000240: 0d0a 2020 2020 417a 696d 7574 6845 7272  ..    AzimuthErr
+00000250: 6f72 0d0a 2020 2020 290d 0a5f 6c6f 6767  or..    ).._logg
+00000260: 6572 203d 2063 7361 6d74 7079 6c6f 672e  er = csamtpylog.
+00000270: 6765 745f 6373 616d 7470 795f 6c6f 6767  get_csamtpy_logg
+00000280: 6572 285f 5f6e 616d 655f 5f29 0d0a 0d0a  er(__name__)....
+00000290: 7472 7920 3a20 0d0a 2020 2020 696d 706f  try : ..    impo
+000002a0: 7274 2073 6369 7079 2061 7320 7370 200d  rt scipy as sp .
+000002b0: 0a20 2020 2069 6d70 6f72 7420 7363 6970  .    import scip
+000002c0: 792e 7374 6174 7320 6173 2073 7053 5441  y.stats as spSTA
+000002d0: 5453 0d0a 2020 2020 7363 6970 795f 7665  TS..    scipy_ve
+000002e0: 7273 696f 6e20 3d20 5b69 6e74 2876 6572  rsion = [int(ver
+000002f0: 7329 2066 6f72 2076 6572 7320 696e 2073  s) for vers in s
+00000300: 702e 5f5f 7665 7273 696f 6e5f 5f2e 7370  p.__version__.sp
+00000310: 6c69 7428 272e 2729 5d20 235b 312c 342c  lit('.')] #[1,4,
+00000320: 315d 0d0a 2020 2020 6966 2073 6369 7079  1]..    if scipy
+00000330: 5f76 6572 7369 6f6e 205b 305d 203d 3d20  _version [0] == 
+00000340: 3120 3a20 0d0a 2020 2020 2020 2020 6966  1 : ..        if
+00000350: 2073 6369 7079 5f76 6572 7369 6f6e 205b   scipy_version [
+00000360: 315d 203c 2034 203a 0d0a 2020 2020 2020  1] < 4 :..      
+00000370: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00000380: 6172 6e28 274e 6f74 653a 206e 6565 6420  arn('Note: need 
+00000390: 7363 6970 7920 7665 7273 696f 6e20 312e  scipy version 1.
+000003a0: 342e 3020 6f72 206d 6f72 6520 2e20 4974  4.0 or more . It
+000003b0: 206d 6179 2027 0d0a 2020 2020 2020 2020   may '..        
+000003c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000003d0: 2020 2770 726f 6261 626c 7920 2067 6574    'probably  get
+000003e0: 2061 2074 726f 7562 6c65 2077 6865 6e20   a trouble when 
+000003f0: 696d 706f 7274 2022 7374 6174 7322 2061  import "stats" a
+00000400: 7474 7269 6275 7465 270d 0a20 2020 2020  ttribute'..     
+00000410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000420: 2020 2020 2027 756e 6465 7220 7375 6368       'under such
+00000430: 2076 6572 7369 6f6e 2e49 7420 6d61 7920   version.It may 
+00000440: 7072 6f62 6162 6c79 206d 6f76 6520 6672  probably move fr
+00000450: 6f6d 2027 2c0d 0a20 2020 2020 2020 2020  om ',..         
+00000460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000470: 2049 6d70 6f72 7457 6172 6e69 6e67 290d   ImportWarning).
+00000480: 0a20 2020 2020 2020 2020 2020 205f 6c6f  .            _lo
+00000490: 6767 6572 2e77 6172 6e69 6e67 2827 4e6f  gger.warning('No
+000004a0: 7465 3a20 6e65 6564 2073 6369 7079 2076  te: need scipy v
+000004b0: 6572 7369 6f6e 2030 2e31 342e 3020 6f72  ersion 0.14.0 or
+000004c0: 2068 6967 6865 7220 6f72 2066 6f72 270d   higher or for'.
+000004d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000004e0: 2020 2020 2020 2020 2020 2020 2027 2073               ' s
+000004f0: 7461 7473 2e6c 696e 6561 7265 6772 6573  tats.linearegres
+00000500: 732e 2055 6e64 6572 2073 7563 6820 7665  s. Under such ve
+00000510: 7273 696f 6e27 0d0a 2020 2020 2020 2020  rsion'..        
+00000520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000530: 2020 2020 2769 7420 6d69 6768 7420 6e6f      'it might no
+00000540: 7420 776f 726b 2e27 290d 0a20 2020 2023  t work.')..    #
+00000550: 2066 726f 6d20 7370 2069 6d70 6f72 7420   from sp import 
+00000560: 7374 6174 7320 0d0a 2020 2020 7374 6174  stats ..    stat
+00000570: 735f 696d 706f 7274 203d 5472 7565 200d  s_import =True .
+00000580: 0a20 2020 2020 2020 2020 2020 200d 0a65  .            ..e
+00000590: 7863 6570 7420 3a0d 0a20 2020 2077 6172  xcept :..    war
+000005a0: 6e69 6e67 732e 7761 726e 2827 436f 756c  nings.warn('Coul
+000005b0: 6420 6e6f 7420 6669 6e64 2073 6369 7079  d not find scipy
+000005c0: 2e73 7461 7473 2c20 6361 6e6e 6f74 2075  .stats, cannot u
+000005d0: 7365 206d 6574 686f 6420 6c69 6e65 6172  se method linear
+000005e0: 7265 6772 6573 7369 6f6e 270d 0a20 2020  regression'..   
+000005f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00000600: 6368 6563 6b20 696e 7374 616c 6c61 7469  check installati
+00000610: 6f6e 2079 6f75 2063 616e 2067 6574 2073  on you can get s
+00000620: 6369 7079 2066 726f 6d20 7363 6970 792e  cipy from scipy.
+00000630: 6f72 672e 2729 0d0a 2020 2020 5f6c 6f67  org.')..    _log
+00000640: 6765 722e 7761 726e 696e 6728 2743 6f75  ger.warning('Cou
+00000650: 6c64 206e 6f74 2066 696e 6420 7363 6970  ld not find scip
+00000660: 792e 7374 6174 732c 2063 616e 6e6f 7420  y.stats, cannot 
+00000670: 7573 6520 6d65 7468 6f64 206c 696e 6561  use method linea
+00000680: 7265 6772 6573 7327 0d0a 2020 2020 2020  regress'..      
+00000690: 2020 2020 2020 2020 2020 2020 2020 2763                'c
+000006a0: 6865 636b 2069 6e73 7461 6c6c 6174 696f  heck installatio
+000006b0: 6e20 796f 7520 6361 6e20 6765 7420 7363  n you can get sc
+000006c0: 6970 7920 6672 6f6d 2073 6369 7079 2e6f  ipy from scipy.o
+000006d0: 7267 2e27 290d 0a20 2020 200d 0a20 2020  rg.')..    ..   
+000006e0: 2073 7461 7473 5f69 6d70 6f72 7420 3d46   stats_import =F
+000006f0: 616c 7365 200d 0a0d 0a23 3d3d 3d3d 3d3d  alse ....#======
+00000700: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000710: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000720: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000730: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000740: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000760: 0d0a 636c 6173 7320 4c6f 6361 7469 6f6e  ..class Location
-00000770: 2028 6f62 6a65 6374 293a 200d 0a20 2020   (object): ..   
-00000780: 2022 2222 0d0a 2020 2020 4465 7461 696c   """..    Detail
-00000790: 7320 6f66 2073 7461 7469 6f6e 206c 6f63  s of station loc
-000007a0: 6174 696f 6e2e 2043 6c61 7373 2075 7365  ation. Class use
-000007b0: 6420 746f 2063 6f6e 7665 7274 200d 0a20  d to convert .. 
-000007c0: 2020 2063 6f72 6469 6e6e 6174 6573 2061     cordinnates a
-000007d0: 6e64 2063 6865 636b 2076 616c 7565 7320  nd check values 
-000007e0: 666f 7220 6c61 742f 6c6f 6e20 2c20 6561  for lat/lon , ea
-000007f0: 7374 2f6e 6f72 7468 200d 0a0d 0a20 2020  st/north ....   
-00000800: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-00000810: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-00000820: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-00000830: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000840: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
-00000850: 2020 4174 7472 6962 7574 6573 2020 2020    Attributes    
-00000860: 2020 2020 2020 2020 2020 5479 7065 2020            Type  
-00000870: 2020 2020 2020 2020 2020 2020 2020 4465                De
-00000880: 7363 7269 7074 696f 6e20 200d 0a20 2020  scription  ..   
-00000890: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-000008a0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-000008b0: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-000008c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000008d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2020  ============..  
-000008e0: 2020 6c61 7469 7475 6465 2020 2020 2020    latitude      
-000008f0: 2020 2020 2020 666c 6f61 742f 6e64 6172        float/ndar
-00000900: 7261 792c 3120 2020 2020 2020 2020 7361  ray,1         sa
-00000910: 7469 6f6e 206c 6174 6974 7564 6520 0d0a  tion latitude ..
-00000920: 2020 2020 6c6f 6e67 6974 7564 6520 2020      longitude   
-00000930: 2020 2020 2020 2020 666c 6f61 742f 6e64          float/nd
-00000940: 6172 7261 792c 3120 2020 2020 2020 2020  array,1         
-00000950: 7374 6174 696f 6e20 6c6f 6e67 6974 7564  station longitud
-00000960: 6520 0d0a 2020 2020 656c 6576 6174 696f  e ..    elevatio
-00000970: 6e20 2020 2020 2020 2020 2020 666c 6f61  n           floa
-00000980: 742f 6e64 6172 7261 7920 2020 2020 2020  t/ndarray       
-00000990: 2020 2020 7374 6174 696f 6e20 656c 6576      station elev
-000009a0: 616e 7469 6f6e 2069 6e20 6d20 6f72 2066  antion in m or f
-000009b0: 7420 0d0a 2020 2020 6561 7374 696e 6720  t ..    easting 
-000009c0: 2020 2020 2020 2020 2020 2020 666c 6f61              floa
-000009d0: 742f 6e64 6172 7261 792e 3120 2020 2020  t/ndarray.1     
-000009e0: 2020 2020 7374 6174 696f 6e20 6561 7374      station east
-000009f0: 696e 6720 636f 6f72 6469 6e61 7465 2028  ing coordinate (
-00000a00: 6d29 0d0a 2020 2020 6e6f 7274 6869 6e67  m)..    northing
-00000a10: 2020 2020 2020 2020 2020 2020 666c 6f61              floa
-00000a20: 742f 6e64 6172 7261 792c 3120 2020 2020  t/ndarray,1     
-00000a30: 2020 2020 7374 6174 696f 6e20 6e6f 7274      station nort
-00000a40: 6869 6e67 2063 6f6f 7264 696e 6174 6520  hing coordinate 
-00000a50: 286d 290d 0a20 2020 2061 7a69 6d75 7468  (m)..    azimuth
-00000a60: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
-00000a70: 6174 2f6e 6461 7272 6179 2c31 2020 2020  at/ndarray,1    
-00000a80: 2020 2020 2073 7461 7469 6f6e 2061 7a69       station azi
-00000a90: 6d75 7468 2020 696e 206d 6574 6572 200d  muth  in meter .
-00000aa0: 0a20 2020 2073 746e 5f70 6f73 2020 2020  .    stn_pos    
-00000ab0: 2020 2020 2020 2020 206e 6461 7272 6179           ndarray
-00000ac0: 2c31 2020 2020 2020 2020 2020 2020 2020  ,1              
-00000ad0: 2073 6174 696f 6e20 6469 706f 6c65 706f   sation dipolepo
-00000ae0: 7369 7469 6f6e 0d0a 2020 2020 7574 6d5f  sition..    utm_
-00000af0: 7a6f 6e65 2020 2020 2020 2020 2020 2020  zone            
-00000b00: 7374 7220 2020 2020 2020 2020 2020 2020  str             
-00000b10: 2020 2020 2020 2020 5554 4d20 6c6f 6361          UTM loca
-00000b20: 7469 6f6e 207a 6f6e 6520 0d0a 2020 2020  tion zone ..    
-00000b30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000b40: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-00000b50: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
-00000b60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000b70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
-00000b80: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
-00000b90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000ba0: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-00000bb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000740: 3d3d 3d3d 3d3d 3d3d 0d0a 2320 4c4f 4341  ========..# LOCA
+00000750: 5449 4f4e 2043 4c41 5353 200d 0a23 3d3d  TION CLASS ..#==
+00000760: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000770: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000780: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000790: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000007a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 2020  ============    
+000007b0: 2020 2020 2020 2020 2020 2020 0d0a 636c              ..cl
+000007c0: 6173 7320 4c6f 6361 7469 6f6e 2028 6f62  ass Location (ob
+000007d0: 6a65 6374 293a 200d 0a20 2020 2022 2222  ject): ..    """
+000007e0: 0d0a 2020 2020 4465 7461 696c 7320 6f66  ..    Details of
+000007f0: 2073 7461 7469 6f6e 206c 6f63 6174 696f   station locatio
+00000800: 6e2e 2043 6c61 7373 2075 7365 6420 746f  n. Class used to
+00000810: 2063 6f6e 7665 7274 200d 0a20 2020 2063   convert ..    c
+00000820: 6f72 6469 6e6e 6174 6573 2061 6e64 2063  ordinnates and c
+00000830: 6865 636b 2076 616c 7565 7320 666f 7220  heck values for 
+00000840: 6c61 742f 6c6f 6e20 2c20 6561 7374 2f6e  lat/lon , east/n
+00000850: 6f72 7468 200d 0a0d 0a20 2020 203d 3d3d  orth ....    ===
+00000860: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+00000870: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00000880: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00000890: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000008a0: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 4174  ========..    At
+000008b0: 7472 6962 7574 6573 2020 2020 2020 2020  tributes        
+000008c0: 2020 2020 2020 5479 7065 2020 2020 2020        Type      
+000008d0: 2020 2020 2020 2020 2020 4465 7363 7269            Descri
+000008e0: 7074 696f 6e20 200d 0a20 2020 203d 3d3d  ption  ..    ===
+000008f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+00000900: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00000910: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00000920: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000930: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 6c61  ========..    la
+00000940: 7469 7475 6465 2020 2020 2020 2020 2020  titude          
+00000950: 2020 666c 6f61 742f 6e64 6172 7261 792c    float/ndarray,
+00000960: 3120 2020 2020 2020 2020 7361 7469 6f6e  1         sation
+00000970: 206c 6174 6974 7564 6520 0d0a 2020 2020   latitude ..    
+00000980: 6c6f 6e67 6974 7564 6520 2020 2020 2020  longitude       
+00000990: 2020 2020 666c 6f61 742f 6e64 6172 7261      float/ndarra
+000009a0: 792c 3120 2020 2020 2020 2020 7374 6174  y,1         stat
+000009b0: 696f 6e20 6c6f 6e67 6974 7564 6520 0d0a  ion longitude ..
+000009c0: 2020 2020 656c 6576 6174 696f 6e20 2020      elevation   
+000009d0: 2020 2020 2020 2020 666c 6f61 742f 6e64          float/nd
+000009e0: 6172 7261 7920 2020 2020 2020 2020 2020  array           
+000009f0: 7374 6174 696f 6e20 656c 6576 616e 7469  station elevanti
+00000a00: 6f6e 2069 6e20 6d20 6f72 2066 7420 0d0a  on in m or ft ..
+00000a10: 2020 2020 6561 7374 696e 6720 2020 2020      easting     
+00000a20: 2020 2020 2020 2020 666c 6f61 742f 6e64          float/nd
+00000a30: 6172 7261 792e 3120 2020 2020 2020 2020  array.1         
+00000a40: 7374 6174 696f 6e20 6561 7374 696e 6720  station easting 
+00000a50: 636f 6f72 6469 6e61 7465 2028 6d29 0d0a  coordinate (m)..
+00000a60: 2020 2020 6e6f 7274 6869 6e67 2020 2020      northing    
+00000a70: 2020 2020 2020 2020 666c 6f61 742f 6e64          float/nd
+00000a80: 6172 7261 792c 3120 2020 2020 2020 2020  array,1         
+00000a90: 7374 6174 696f 6e20 6e6f 7274 6869 6e67  station northing
+00000aa0: 2063 6f6f 7264 696e 6174 6520 286d 290d   coordinate (m).
+00000ab0: 0a20 2020 2061 7a69 6d75 7468 2020 2020  .    azimuth    
+00000ac0: 2020 2020 2020 2020 2066 6c6f 6174 2f6e           float/n
+00000ad0: 6461 7272 6179 2c31 2020 2020 2020 2020  darray,1        
+00000ae0: 2073 7461 7469 6f6e 2061 7a69 6d75 7468   station azimuth
+00000af0: 2020 696e 206d 6574 6572 200d 0a20 2020    in meter ..   
+00000b00: 2073 746e 5f70 6f73 2020 2020 2020 2020   stn_pos        
+00000b10: 2020 2020 206e 6461 7272 6179 2c31 2020       ndarray,1  
+00000b20: 2020 2020 2020 2020 2020 2020 2073 6174               sat
+00000b30: 696f 6e20 6469 706f 6c65 706f 7369 7469  ion dipolepositi
+00000b40: 6f6e 0d0a 2020 2020 7574 6d5f 7a6f 6e65  on..    utm_zone
+00000b50: 2020 2020 2020 2020 2020 2020 7374 7220              str 
+00000b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000b70: 2020 2020 5554 4d20 6c6f 6361 7469 6f6e      UTM location
+00000b80: 207a 6f6e 6520 0d0a 2020 2020 3d3d 3d3d   zone ..    ====
+00000b90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==============  
+00000ba0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000bb0: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
 00000bc0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000bd0: 3d3d 0d0a 2020 2020 4d65 7468 6f64 7320  ==..    Methods 
-00000be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000bf0: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
-00000c00: 696f 6e20 0d0a 2020 2020 3d3d 3d3d 3d3d  ion ..    ======
+00000bd0: 3d3d 3d3d 3d3d 3d0d 0a20 2020 200d 0a20  =======..    .. 
+00000be0: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
+00000bf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+00000c00: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
 00000c10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000c20: 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d  ======  ========
-00000c30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000c40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000c50: 3d3d 3d3d 3d0d 0a20 2020 2063 6f6e 7665  =====..    conve
-00000c60: 7274 5f6c 6f63 6174 696f 6e5f 325f 7574  rt_location_2_ut
-00000c70: 6d20 2020 2020 2020 2020 2063 6f6e 7665  m          conve
-00000c80: 7274 2070 6f73 6974 696f 6e20 6c6f 6361  rt position loca
-00000c90: 7469 6f6e 206c 6f6e 2f6c 6174 2069 6e20  tion lon/lat in 
-00000ca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000cc0: 2020 2020 2020 7574 6d20 6561 7374 696e        utm eastin
-00000cd0: 6720 6e6f 7274 6869 6e67 200d 0a20 2020  g northing ..   
-00000ce0: 2063 6f6e 7665 7274 5f6c 6f63 6174 696f   convert_locatio
-00000cf0: 6e5f 325f 6c61 746c 6f6e 2020 2020 2020  n_2_latlon      
-00000d00: 2063 6f6e 7665 7274 206c 6f63 6174 696f   convert locatio
-00000d10: 6e20 706f 7374 696f 6e20 2066 726f 6d20  n postion  from 
-00000d20: 6561 7374 2f6e 6f72 7468 200d 0a20 2020  east/north ..   
-00000d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000d50: 2074 6f20 6c61 7469 7475 6465 2f6c 6f6e   to latitude/lon
-00000d60: 6769 7475 6465 200d 0a20 2020 203d 3d3d  gitude ..    ===
-00000d70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000d80: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
-00000d90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000da0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00000db0: 3d3d 3d3d 3d3d 3d3d 0d0a 2020 2020 2222  ========..    ""
-00000dc0: 220d 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-00000dd0: 745f 5f28 7365 6c66 2c20 2a2a 6b77 6172  t__(self, **kwar
-00000de0: 6773 2920 3a0d 0a20 2020 2020 2020 2073  gs) :..        s
-00000df0: 656c 662e 6461 7475 6d20 3d27 5747 5338  elf.datum ='WGS8
-00000e00: 3427 0d0a 2020 2020 2020 2020 7365 6c66  4'..        self
-00000e10: 2e5f 6c61 7469 7475 6465 203d 4e6f 6e65  ._latitude =None
-00000e20: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-00000e30: 5f6c 6f6e 6769 7475 6465 203d 4e6f 6e65  _longitude =None
-00000e40: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-00000e50: 5f65 6173 7469 6e67 203d 4e6f 6e65 200d  _easting =None .
-00000e60: 0a20 2020 2020 2020 2073 656c 662e 5f6e  .        self._n
-00000e70: 6f72 7468 696e 6720 3d4e 6f6e 650d 0a20  orthing =None.. 
-00000e80: 2020 2020 2020 2073 656c 662e 5f65 6c65         self._ele
-00000e90: 7661 7469 6f6e 203d 4e6f 6e65 200d 0a20  vation =None .. 
-00000ea0: 2020 2020 2020 2073 656c 662e 5f75 746d         self._utm
-00000eb0: 5f7a 6f6e 6520 3d4e 6f6e 650d 0a20 2020  _zone =None..   
-00000ec0: 2020 2020 2073 656c 662e 5f73 746e 5f70       self._stn_p
-00000ed0: 6f73 203d 204e 6f6e 6520 0d0a 2020 2020  os = None ..    
-00000ee0: 2020 2020 7365 6c66 2e5f 617a 696d 7574      self._azimut
-00000ef0: 6820 3d20 4e6f 6e65 200d 0a20 0d0a 2020  h = None .. ..  
-00000f00: 2020 2020 2020 666f 7220 6b65 7920 696e        for key in
-00000f10: 206c 6973 7428 6b77 6172 6773 2e6b 6579   list(kwargs.key
-00000f20: 7328 2929 3a20 0d0a 2020 2020 2020 2020  s()): ..        
-00000f30: 2020 2020 7365 6c66 2e5f 5f73 6574 6174      self.__setat
-00000f40: 7472 5f5f 286b 6579 2c20 6b77 6172 6773  tr__(key, kwargs
-00000f50: 5b6b 6579 5d29 0d0a 2020 2020 0d0a 2020  [key])..    ..  
-00000f60: 2020 4070 726f 7065 7274 7920 0d0a 2020    @property ..  
-00000f70: 2020 6465 6620 7574 6d5f 7a6f 6e65 2028    def utm_zone (
-00000f80: 7365 6c66 293a 200d 0a20 2020 2020 2020  self): ..       
-00000f90: 2072 6574 7572 6e20 7365 6c66 2e5f 7574   return self._ut
-00000fa0: 6d5f 7a6f 6e65 0d0a 2020 2020 2020 2020  m_zone..        
-00000fb0: 0d0a 2020 2020 4070 726f 7065 7274 7920  ..    @property 
-00000fc0: 0d0a 2020 2020 6465 6620 6c61 7469 7475  ..    def latitu
-00000fd0: 6465 2873 656c 6629 3a20 0d0a 2020 2020  de(self): ..    
-00000fe0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00000ff0: 5f6c 6174 6974 7564 650d 0a20 2020 2040  _latitude..    @
-00001000: 7072 6f70 6572 7479 200d 0a20 2020 2064  property ..    d
-00001010: 6566 206c 6f6e 6769 7475 6465 2028 7365  ef longitude (se
-00001020: 6c66 2920 3a20 0d0a 2020 2020 2020 2020  lf) : ..        
-00001030: 7265 7475 726e 2073 656c 662e 5f6c 6f6e  return self._lon
-00001040: 6769 7475 6465 0d0a 2020 2020 4070 726f  gitude..    @pro
-00001050: 7065 7274 7920 0d0a 2020 2020 6465 6620  perty ..    def 
-00001060: 6561 7374 696e 6728 7365 6c66 2029 3a20  easting(self ): 
-00001070: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00001080: 2073 656c 662e 5f65 6173 7469 6e67 200d   self._easting .
-00001090: 0a20 2020 2040 7072 6f70 6572 7479 200d  .    @property .
-000010a0: 0a20 2020 2064 6566 206e 6f72 7468 696e  .    def northin
-000010b0: 6720 2873 656c 6629 3a0d 0a20 2020 2020  g (self):..     
-000010c0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000010d0: 6e6f 7274 6869 6e67 200d 0a20 2020 2040  northing ..    @
-000010e0: 7072 6f70 6572 7479 200d 0a20 2020 2064  property ..    d
-000010f0: 6566 2065 6c65 7661 7469 6f6e 2873 656c  ef elevation(sel
-00001100: 6629 3a20 0d0a 2020 2020 2020 2020 7265  f): ..        re
-00001110: 7475 726e 2073 656c 662e 5f65 6c65 7661  turn self._eleva
-00001120: 7469 6f6e 0d0a 2020 2020 4070 726f 7065  tion..    @prope
-00001130: 7274 7920 0d0a 2020 2020 6465 6620 7374  rty ..    def st
-00001140: 6e5f 706f 7320 2873 656c 6629 3a20 0d0a  n_pos (self): ..
-00001150: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00001160: 656c 662e 5f73 746e 5f70 6f73 0d0a 2020  elf._stn_pos..  
-00001170: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
-00001180: 2064 6566 2061 7a69 6d75 7468 2873 656c   def azimuth(sel
-00001190: 6629 3a20 0d0a 2020 2020 2020 2020 6966  f): ..        if
-000011a0: 2073 656c 662e 6561 7374 2069 7320 6e6f   self.east is no
-000011b0: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
-000011c0: 6e6f 7274 6820 6973 206e 6f74 204e 6f6e  north is not Non
-000011d0: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-000011e0: 2020 2020 2020 7265 7475 726e 2066 756e        return fun
-000011f0: 632e 636f 6d70 7574 655f 617a 696d 7574  c.compute_azimut
-00001200: 6828 6561 7374 696e 673d 6e70 2e61 7272  h(easting=np.arr
-00001210: 6179 280d 0a20 2020 2020 2020 2020 2020  ay(..           
-00001220: 2020 2020 2020 2020 205b 666c 6f61 7428           [float(
-00001230: 6561 7329 2066 6f72 2065 6173 2069 6e20  eas) for eas in 
-00001240: 7365 6c66 2e65 6173 7469 6e67 5d29 2c0d  self.easting]),.
-00001250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001270: 2020 2020 2020 2020 2020 2020 206e 6f72               nor
-00001280: 7468 696e 673d 6e70 2e61 7272 6179 280d  thing=np.array(.
-00001290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000012a0: 2020 2020 2020 5b66 6c6f 6174 286e 6f72        [float(nor
-000012b0: 2920 666f 7220 6e6f 7220 696e 2073 656c  ) for nor in sel
-000012c0: 662e 6e6f 7274 6869 6e67 5d29 290d 0a20  f.northing])).. 
-000012d0: 2020 2020 2020 2065 6c73 6520 3a20 7265         else : re
-000012e0: 7475 726e 2073 656c 662e 5f61 7a69 6d75  turn self._azimu
-000012f0: 7468 200d 0a20 2020 200d 0a20 2020 2023  th ..    ..    #
-00001300: 2d2d 2d2d 2d2d 2d2d 2d2d 2d73 6574 7469  -----------setti
-00001310: 6e67 202d 2d2d 2d20 0d0a 2020 2020 4075  ng ---- ..    @u
-00001320: 746d 5f7a 6f6e 652e 7365 7474 6572 200d  tm_zone.setter .
-00001330: 0a20 2020 2064 6566 2075 746d 5f7a 6f6e  .    def utm_zon
-00001340: 6520 2873 656c 662c 2075 746d 5f7a 6f6e  e (self, utm_zon
-00001350: 6529 3a20 0d0a 2020 2020 2020 2020 6966  e): ..        if
-00001360: 2069 7369 6e73 7461 6e63 6528 7574 6d5f   isinstance(utm_
-00001370: 7a6f 6e65 2c28 666c 6f61 742c 696e 7429  zone,(float,int)
-00001380: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00001390: 7761 726e 696e 6773 2e77 6172 6e28 2757  warnings.warn('W
-000013a0: 726f 6e67 2055 544d 207a 6f6e 6520 696e  rong UTM zone in
-000013b0: 7075 742e 204d 7573 7420 6265 2061 2073  put. Must be a s
-000013c0: 7472 206e 756d 6265 722e 2729 0d0a 2020  tr number.')..  
-000013d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000013e0: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-000013f0: 725f 6c6f 6361 7469 6f6e 280d 0a20 2020  r_location(..   
-00001400: 2020 2020 2020 2020 2020 2020 2027 5554               'UT
-00001410: 4d20 5a6f 6e65 206d 7573 7420 6265 2073  M Zone must be s
-00001420: 7472 696e 672c 2027 0d0a 2020 2020 2020  tring, '..      
-00001430: 2020 2020 2020 2020 2020 2027 6e6f 7420             'not 
-00001440: 3c7b 307d 3e74 7970 652e 272e 666f 726d  <{0}>type.'.form
-00001450: 6174 2874 7970 6528 7574 6d5f 7a6f 6e65  at(type(utm_zone
-00001460: 2929 290d 0a20 2020 2020 2020 2065 6c73  )))..        els
-00001470: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-00001480: 2020 7472 7920 3a0d 0a20 2020 2020 2020    try :..       
-00001490: 2020 2020 2020 2020 2066 6c6f 6174 2875           float(u
-000014a0: 746d 5f7a 6f6e 655b 3a2d 325d 290d 0a20  tm_zone[:-2]).. 
-000014b0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-000014c0: 7420 3a20 7261 6973 6520 4353 6578 2e70  t : raise CSex.p
-000014d0: 7943 5341 4d54 4572 726f 725f 6c6f 6361  yCSAMTError_loca
-000014e0: 7469 6f6e 280d 0a20 2020 2020 2020 2020  tion(..         
-000014f0: 2020 2020 2020 2020 2020 2027 4572 726f             'Erro
-00001500: 7220 5554 4d20 5a6f 6e65 2064 6573 6967  r UTM Zone desig
-00001510: 6e61 746f 722e 2042 6f74 6820 6669 7273  nator. Both firs
-00001520: 7420 6c65 7474 6572 7327 0d0a 2020 2020  t letters'..    
-00001530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001540: 2720 7072 6f76 6964 6564 2061 7265 206e  ' provided are n
-00001550: 6f74 2061 6363 656f 7461 626c 6520 2127  ot acceotable !'
-00001560: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00001570: 6c73 6520 3a20 0d0a 2020 2020 2020 2020  lse : ..        
-00001580: 2020 2020 2020 2020 6966 2075 746d 5f7a          if utm_z
-00001590: 6f6e 655b 2d31 5d20 6e6f 7420 696e 206c  one[-1] not in l
-000015a0: 6973 7428 0d0a 2020 2020 2020 2020 2020  ist(..          
-000015b0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000015c0: 464f 2e6e 6f74 696f 6e2e 7574 6d5f 7a6f  FO.notion.utm_zo
-000015d0: 6e65 5f64 6963 745f 6465 7369 676e 6174  ne_dict_designat
-000015e0: 6f72 2e6b 6579 7328 2929 3a20 0d0a 2020  or.keys()): ..  
+00000c20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+00000c30: 2020 2020 4d65 7468 6f64 7320 2020 2020      Methods     
+00000c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c50: 2020 2020 4465 7363 7269 7074 696f 6e20      Description 
+00000c60: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
+00000c70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000c80: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
+00000c90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000ca0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000cb0: 3d0d 0a20 2020 2063 6f6e 7665 7274 5f6c  =..    convert_l
+00000cc0: 6f63 6174 696f 6e5f 325f 7574 6d20 2020  ocation_2_utm   
+00000cd0: 2020 2020 2020 2063 6f6e 7665 7274 2070         convert p
+00000ce0: 6f73 6974 696f 6e20 6c6f 6361 7469 6f6e  osition location
+00000cf0: 206c 6f6e 2f6c 6174 2069 6e20 0d0a 2020   lon/lat in ..  
+00000d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000d20: 2020 7574 6d20 6561 7374 696e 6720 6e6f    utm easting no
+00000d30: 7274 6869 6e67 200d 0a20 2020 2063 6f6e  rthing ..    con
+00000d40: 7665 7274 5f6c 6f63 6174 696f 6e5f 325f  vert_location_2_
+00000d50: 6c61 746c 6f6e 2020 2020 2020 2063 6f6e  latlon       con
+00000d60: 7665 7274 206c 6f63 6174 696f 6e20 706f  vert location po
+00000d70: 7374 696f 6e20 2066 726f 6d20 6561 7374  stion  from east
+00000d80: 2f6e 6f72 7468 200d 0a20 2020 2020 2020  /north ..       
+00000d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000da0: 2020 2020 2020 2020 2020 2020 2074 6f20               to 
+00000db0: 6c61 7469 7475 6465 2f6c 6f6e 6769 7475  latitude/longitu
+00000dc0: 6465 200d 0a20 2020 203d 3d3d 3d3d 3d3d  de ..    =======
+00000dd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000de0: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00000df0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00000e10: 3d3d 3d3d 0d0a 2020 2020 2222 220d 0a20  ====..    """.. 
+00000e20: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00000e30: 7365 6c66 2c20 2a2a 6b77 6172 6773 2920  self, **kwargs) 
+00000e40: 3a0d 0a20 2020 2020 2020 2073 656c 662e  :..        self.
+00000e50: 6461 7475 6d20 3d27 5747 5338 3427 0d0a  datum ='WGS84'..
+00000e60: 2020 2020 2020 2020 7365 6c66 2e5f 6c61          self._la
+00000e70: 7469 7475 6465 203d 4e6f 6e65 200d 0a20  titude =None .. 
+00000e80: 2020 2020 2020 2073 656c 662e 5f6c 6f6e         self._lon
+00000e90: 6769 7475 6465 203d 4e6f 6e65 200d 0a20  gitude =None .. 
+00000ea0: 2020 2020 2020 2073 656c 662e 5f65 6173         self._eas
+00000eb0: 7469 6e67 203d 4e6f 6e65 200d 0a20 2020  ting =None ..   
+00000ec0: 2020 2020 2073 656c 662e 5f6e 6f72 7468       self._north
+00000ed0: 696e 6720 3d4e 6f6e 650d 0a20 2020 2020  ing =None..     
+00000ee0: 2020 2073 656c 662e 5f65 6c65 7661 7469     self._elevati
+00000ef0: 6f6e 203d 4e6f 6e65 200d 0a20 2020 2020  on =None ..     
+00000f00: 2020 2073 656c 662e 5f75 746d 5f7a 6f6e     self._utm_zon
+00000f10: 6520 3d4e 6f6e 650d 0a20 2020 2020 2020  e =None..       
+00000f20: 2073 656c 662e 5f73 746e 5f70 6f73 203d   self._stn_pos =
+00000f30: 204e 6f6e 6520 0d0a 2020 2020 2020 2020   None ..        
+00000f40: 7365 6c66 2e5f 617a 696d 7574 6820 3d20  self._azimuth = 
+00000f50: 4e6f 6e65 200d 0a20 0d0a 2020 2020 2020  None .. ..      
+00000f60: 2020 666f 7220 6b65 7920 696e 206c 6973    for key in lis
+00000f70: 7428 6b77 6172 6773 2e6b 6579 7328 2929  t(kwargs.keys())
+00000f80: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00000f90: 7365 6c66 2e5f 5f73 6574 6174 7472 5f5f  self.__setattr__
+00000fa0: 286b 6579 2c20 6b77 6172 6773 5b6b 6579  (key, kwargs[key
+00000fb0: 5d29 0d0a 2020 2020 0d0a 2020 2020 4070  ])..    ..    @p
+00000fc0: 726f 7065 7274 7920 0d0a 2020 2020 6465  roperty ..    de
+00000fd0: 6620 7574 6d5f 7a6f 6e65 2028 7365 6c66  f utm_zone (self
+00000fe0: 293a 200d 0a20 2020 2020 2020 2072 6574  ): ..        ret
+00000ff0: 7572 6e20 7365 6c66 2e5f 7574 6d5f 7a6f  urn self._utm_zo
+00001000: 6e65 0d0a 2020 2020 2020 2020 0d0a 2020  ne..        ..  
+00001010: 2020 4070 726f 7065 7274 7920 0d0a 2020    @property ..  
+00001020: 2020 6465 6620 6c61 7469 7475 6465 2873    def latitude(s
+00001030: 656c 6629 3a20 0d0a 2020 2020 2020 2020  elf): ..        
+00001040: 7265 7475 726e 2073 656c 662e 5f6c 6174  return self._lat
+00001050: 6974 7564 650d 0a20 2020 2040 7072 6f70  itude..    @prop
+00001060: 6572 7479 200d 0a20 2020 2064 6566 206c  erty ..    def l
+00001070: 6f6e 6769 7475 6465 2028 7365 6c66 2920  ongitude (self) 
+00001080: 3a20 0d0a 2020 2020 2020 2020 7265 7475  : ..        retu
+00001090: 726e 2073 656c 662e 5f6c 6f6e 6769 7475  rn self._longitu
+000010a0: 6465 0d0a 2020 2020 4070 726f 7065 7274  de..    @propert
+000010b0: 7920 0d0a 2020 2020 6465 6620 6561 7374  y ..    def east
+000010c0: 696e 6728 7365 6c66 2029 3a20 0d0a 2020  ing(self ): ..  
+000010d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000010e0: 662e 5f65 6173 7469 6e67 200d 0a20 2020  f._easting ..   
+000010f0: 2040 7072 6f70 6572 7479 200d 0a20 2020   @property ..   
+00001100: 2064 6566 206e 6f72 7468 696e 6720 2873   def northing (s
+00001110: 656c 6629 3a0d 0a20 2020 2020 2020 2072  elf):..        r
+00001120: 6574 7572 6e20 7365 6c66 2e5f 6e6f 7274  eturn self._nort
+00001130: 6869 6e67 200d 0a20 2020 2040 7072 6f70  hing ..    @prop
+00001140: 6572 7479 200d 0a20 2020 2064 6566 2065  erty ..    def e
+00001150: 6c65 7661 7469 6f6e 2873 656c 6629 3a20  levation(self): 
+00001160: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00001170: 2073 656c 662e 5f65 6c65 7661 7469 6f6e   self._elevation
+00001180: 0d0a 2020 2020 4070 726f 7065 7274 7920  ..    @property 
+00001190: 0d0a 2020 2020 6465 6620 7374 6e5f 706f  ..    def stn_po
+000011a0: 7320 2873 656c 6629 3a20 0d0a 2020 2020  s (self): ..    
+000011b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000011c0: 5f73 746e 5f70 6f73 0d0a 2020 2020 4070  _stn_pos..    @p
+000011d0: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+000011e0: 2061 7a69 6d75 7468 2873 656c 6629 3a20   azimuth(self): 
+000011f0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00001200: 662e 6561 7374 2069 7320 6e6f 7420 4e6f  f.east is not No
+00001210: 6e65 2061 6e64 2073 656c 662e 6e6f 7274  ne and self.nort
+00001220: 6820 6973 206e 6f74 204e 6f6e 6520 3a20  h is not None : 
+00001230: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001240: 2020 7265 7475 726e 2066 756e 632e 636f    return func.co
+00001250: 6d70 7574 655f 617a 696d 7574 6828 6561  mpute_azimuth(ea
+00001260: 7374 696e 673d 6e70 2e61 7272 6179 280d  sting=np.array(.
+00001270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001280: 2020 2020 205b 666c 6f61 7428 6561 7329       [float(eas)
+00001290: 2066 6f72 2065 6173 2069 6e20 7365 6c66   for eas in self
+000012a0: 2e65 6173 7469 6e67 5d29 2c0d 0a20 2020  .easting]),..   
+000012b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000012c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000012d0: 2020 2020 2020 2020 206e 6f72 7468 696e           northin
+000012e0: 673d 6e70 2e61 7272 6179 280d 0a20 2020  g=np.array(..   
+000012f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001300: 2020 5b66 6c6f 6174 286e 6f72 2920 666f    [float(nor) fo
+00001310: 7220 6e6f 7220 696e 2073 656c 662e 6e6f  r nor in self.no
+00001320: 7274 6869 6e67 5d29 290d 0a20 2020 2020  rthing]))..     
+00001330: 2020 2065 6c73 6520 3a20 7265 7475 726e     else : return
+00001340: 2073 656c 662e 5f61 7a69 6d75 7468 200d   self._azimuth .
+00001350: 0a20 2020 200d 0a20 2020 2023 2d2d 2d2d  .    ..    #----
+00001360: 2d2d 2d2d 2d2d 2d73 6574 7469 6e67 202d  -------setting -
+00001370: 2d2d 2d20 0d0a 2020 2020 4075 746d 5f7a  --- ..    @utm_z
+00001380: 6f6e 652e 7365 7474 6572 200d 0a20 2020  one.setter ..   
+00001390: 2064 6566 2075 746d 5f7a 6f6e 6520 2873   def utm_zone (s
+000013a0: 656c 662c 2075 746d 5f7a 6f6e 6529 3a20  elf, utm_zone): 
+000013b0: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+000013c0: 6e73 7461 6e63 6528 7574 6d5f 7a6f 6e65  nstance(utm_zone
+000013d0: 2c28 666c 6f61 742c 696e 7429 293a 0d0a  ,(float,int)):..
+000013e0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+000013f0: 696e 6773 2e77 6172 6e28 2757 726f 6e67  ings.warn('Wrong
+00001400: 2055 544d 207a 6f6e 6520 696e 7075 742e   UTM zone input.
+00001410: 204d 7573 7420 6265 2061 2073 7472 206e   Must be a str n
+00001420: 756d 6265 722e 2729 0d0a 2020 2020 2020  umber.')..      
+00001430: 2020 2020 2020 7261 6973 6520 4c6f 6361        raise Loca
+00001440: 7469 6f6e 4572 726f 7228 0d0a 2020 2020  tionError(..    
+00001450: 2020 2020 2020 2020 2020 2020 2755 544d              'UTM
+00001460: 205a 6f6e 6520 6d75 7374 2062 6520 7374   Zone must be st
+00001470: 7269 6e67 2c20 270d 0a20 2020 2020 2020  ring, '..       
+00001480: 2020 2020 2020 2020 2020 276e 6f74 203c            'not <
+00001490: 7b30 7d3e 7479 7065 2e27 2e66 6f72 6d61  {0}>type.'.forma
+000014a0: 7428 7479 7065 2875 746d 5f7a 6f6e 6529  t(type(utm_zone)
+000014b0: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
+000014c0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+000014d0: 2074 7279 203a 0d0a 2020 2020 2020 2020   try :..        
+000014e0: 2020 2020 2020 2020 666c 6f61 7428 7574          float(ut
+000014f0: 6d5f 7a6f 6e65 5b3a 2d32 5d29 0d0a 2020  m_zone[:-2])..  
+00001500: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00001510: 203a 2072 6169 7365 204c 6f63 6174 696f   : raise Locatio
+00001520: 6e45 7272 6f72 280d 0a20 2020 2020 2020  nError(..       
+00001530: 2020 2020 2020 2020 2020 2020 2027 4572               'Er
+00001540: 726f 7220 5554 4d20 5a6f 6e65 2064 6573  ror UTM Zone des
+00001550: 6967 6e61 746f 722e 2042 6f74 6820 6669  ignator. Both fi
+00001560: 7273 7420 6c65 7474 6572 7327 0d0a 2020  rst letters'..  
+00001570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001580: 2020 2720 7072 6f76 6964 6564 2061 7265    ' provided are
+00001590: 206e 6f74 2061 6363 656f 7461 626c 6520   not acceotable 
+000015a0: 2127 290d 0a20 2020 2020 2020 2020 2020  !')..           
+000015b0: 2065 6c73 6520 3a20 0d0a 2020 2020 2020   else : ..      
+000015c0: 2020 2020 2020 2020 2020 6966 2075 746d            if utm
+000015d0: 5f7a 6f6e 655b 2d31 5d20 6e6f 7420 696e  _zone[-1] not in
+000015e0: 206c 6973 7428 0d0a 2020 2020 2020 2020   list(..        
 000015f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001600: 2020 7261 6973 6520 4353 6578 2e70 7943    raise CSex.pyC
-00001610: 5341 4d54 4572 726f 725f 6c6f 6361 7469  SAMTError_locati
-00001620: 6f6e 280d 0a20 2020 2020 2020 2020 2020  on(..           
-00001630: 2020 2020 2020 2020 2020 2020 2027 5772               'Wr
-00001640: 6f6e 6720 5554 4d20 5a6f 6e65 206c 6574  ong UTM Zone let
-00001650: 7465 7220 6465 7369 676e 6174 6f72 2e27  ter designator.'
-00001660: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00001670: 2020 2020 2020 2020 2020 2720 4c65 7474            ' Lett
-00001680: 6572 206d 7573 7420 6265 2061 6d6f 6e67  er must be among
-00001690: 203c 7b30 7d3e 272e 0d0a 2020 2020 2020   <{0}>'...      
-000016a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000016b0: 2020 2020 2020 666f 726d 6174 2827 7c27        format('|'
-000016c0: 2e6a 6f69 6e28 6c69 7374 280d 0a20 2020  .join(list(..   
+00001600: 696e 464f 2e6e 6f74 696f 6e2e 7574 6d5f  inFO.notion.utm_
+00001610: 7a6f 6e65 5f64 6963 745f 6465 7369 676e  zone_dict_design
+00001620: 6174 6f72 2e6b 6579 7328 2929 3a20 0d0a  ator.keys()): ..
+00001630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001640: 2020 2020 7261 6973 6520 4c6f 6361 7469      raise Locati
+00001650: 6f6e 4572 726f 7228 0d0a 2020 2020 2020  onError(..      
+00001660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001670: 2020 2757 726f 6e67 2055 544d 205a 6f6e    'Wrong UTM Zon
+00001680: 6520 6c65 7474 6572 2064 6573 6967 6e61  e letter designa
+00001690: 746f 722e 270d 0a20 2020 2020 2020 2020  tor.'..         
+000016a0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000016b0: 204c 6574 7465 7220 6d75 7374 2062 6520   Letter must be 
+000016c0: 616d 6f6e 6720 3c7b 307d 3e27 2e0d 0a20  among <{0}>'... 
 000016d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000016e0: 2020 2020 2020 2069 6e46 4f2e 6e6f 7469         inFO.noti
-000016f0: 6f6e 2e75 746d 5f7a 6f6e 655f 6469 6374  on.utm_zone_dict
-00001700: 5f64 6573 6967 6e61 746f 722e 6b65 7973  _designator.keys
-00001710: 2829 2929 2929 0d0a 2020 2020 2020 2020  ()))))..        
-00001720: 2020 2020 7365 6c66 2e5f 7574 6d5f 7a6f      self._utm_zo
-00001730: 6e65 203d 7574 6d5f 7a6f 6e65 0d0a 2020  ne =utm_zone..  
-00001740: 2020 0d0a 2020 2020 406c 6174 6974 7564    ..    @latitud
-00001750: 652e 7365 7474 6572 200d 0a20 2020 2064  e.setter ..    d
-00001760: 6566 206c 6174 6974 7564 6520 2873 656c  ef latitude (sel
-00001770: 662c 206c 6174 6974 7564 6529 3a20 0d0a  f, latitude): ..
-00001780: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00001790: 7461 6e63 6528 6c61 7469 7475 6465 2c20  tance(latitude, 
-000017a0: 2866 6c6f 6174 2c69 6e74 2c73 7472 2929  (float,int,str))
-000017b0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-000017c0: 656c 662e 5f6c 6174 6974 7564 653d 2067  elf._latitude= g
-000017d0: 6973 2e61 7373 6572 745f 6c61 745f 7661  is.assert_lat_va
-000017e0: 6c75 6528 6c61 7469 7475 6465 290d 0a20  lue(latitude).. 
-000017f0: 2020 2020 2020 2065 6c73 653a 2073 656c         else: sel
-00001800: 662e 5f6c 6174 6974 7564 6520 3d20 6e70  f._latitude = np
-00001810: 2e61 7272 6179 285b 6769 732e 6173 7365  .array([gis.asse
-00001820: 7274 5f6c 6174 5f76 616c 7565 286c 6174  rt_lat_value(lat
-00001830: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00001840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001850: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00001860: 6c61 7420 696e 206c 6174 6974 7564 6520  lat in latitude 
-00001870: 5d29 0d0a 2020 2020 2020 2020 0d0a 2020  ])..        ..  
-00001880: 2020 406c 6f6e 6769 7475 6465 2e73 6574    @longitude.set
-00001890: 7465 7220 0d0a 2020 2020 6465 6620 6c6f  ter ..    def lo
-000018a0: 6e67 6974 7564 6528 7365 6c66 2c20 6c6f  ngitude(self, lo
-000018b0: 6e67 6974 7564 6529 203a 200d 0a20 2020  ngitude) : ..   
-000018c0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-000018d0: 6365 286c 6f6e 6769 7475 6465 2c20 2866  ce(longitude, (f
-000018e0: 6c6f 6174 2c69 6e74 2c73 7472 2929 3a0d  loat,int,str)):.
-000018f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00001900: 662e 5f6c 6f6e 6769 7475 6465 3d20 6769  f._longitude= gi
-00001910: 732e 6173 7365 7274 5f6c 6f6e 5f76 616c  s.assert_lon_val
-00001920: 7565 286c 6f6e 6769 7475 6465 290d 0a20  ue(longitude).. 
-00001930: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
-00001940: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00001950: 5f6c 6f6e 6769 7475 6465 203d 206e 702e  _longitude = np.
-00001960: 6172 7261 7928 5b67 6973 2e61 7373 6572  array([gis.asser
-00001970: 745f 6c6f 6e5f 7661 6c75 6528 6c6f 6e29  t_lon_value(lon)
-00001980: 2066 6f72 200d 0a20 2020 2020 2020 2020   for ..         
-00001990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000019a0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000019b0: 6f6e 2069 6e20 6c6f 6e67 6974 7564 6520  on in longitude 
-000019c0: 5d29 0d0a 2020 2020 2020 2020 0d0a 2020  ])..        ..  
-000019d0: 2020 4065 6c65 7661 7469 6f6e 2e73 6574    @elevation.set
-000019e0: 7465 7220 0d0a 2020 2020 6465 6620 656c  ter ..    def el
-000019f0: 6576 6174 696f 6e28 7365 6c66 2c20 656c  evation(self, el
-00001a00: 6576 6174 696f 6e29 203a 200d 0a20 2020  evation) : ..   
-00001a10: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00001a20: 6365 2865 6c65 7661 7469 6f6e 2c20 2866  ce(elevation, (f
-00001a30: 6c6f 6174 2c69 6e74 2c73 7472 2929 3a20  loat,int,str)): 
-00001a40: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00001a50: 6c66 2e5f 656c 6576 6174 696f 6e3d 2067  lf._elevation= g
-00001a60: 6973 2e61 7373 6572 745f 656c 6576 6174  is.assert_elevat
-00001a70: 696f 6e5f 7661 6c75 6528 656c 6576 6174  ion_value(elevat
-00001a80: 696f 6e29 0d0a 2020 2020 2020 2020 656c  ion)..        el
-00001a90: 7365 203a 0d0a 2020 2020 2020 2020 2020  se :..          
-00001aa0: 2020 7365 6c66 2e5f 656c 6576 6174 696f    self._elevatio
-00001ab0: 6e20 3d20 6e70 2e61 7272 6179 285b 6769  n = np.array([gi
-00001ac0: 732e 6173 7365 7274 5f65 6c65 7661 7469  s.assert_elevati
-00001ad0: 6f6e 5f76 616c 7565 2028 656c 6576 290d  on_value (elev).
-00001ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001b00: 2020 2020 2020 2020 2066 6f72 2065 6c65           for ele
-00001b10: 7620 696e 2065 6c65 7661 7469 6f6e 5d29  v in elevation])
-00001b20: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00001b30: 2040 6561 7374 696e 672e 7365 7474 6572   @easting.setter
-00001b40: 200d 0a20 2020 2064 6566 2065 6173 7469   ..    def easti
-00001b50: 6e67 2028 7365 6c66 2c20 6561 7374 696e  ng (self, eastin
-00001b60: 6729 3a20 0d0a 2020 2020 2020 2020 6966  g): ..        if
-00001b70: 2069 7369 6e73 7461 6e63 6528 6561 7374   isinstance(east
-00001b80: 696e 672c 2028 666c 6f61 742c 696e 742c  ing, (float,int,
-00001b90: 7374 7229 293a 200d 0a20 2020 2020 2020  str)): ..       
-00001ba0: 2020 2020 2073 656c 662e 5f65 6173 7469       self._easti
-00001bb0: 6e67 3d20 6e70 2e61 7272 6179 2865 6173  ng= np.array(eas
-00001bc0: 7469 6e67 2c20 6474 7970 653d 666c 6f61  ting, dtype=floa
-00001bd0: 7429 0d0a 2020 2020 2020 2020 656c 7365  t)..        else
-00001be0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00001bf0: 2074 7279 203a 2073 656c 662e 5f65 6173   try : self._eas
-00001c00: 7469 6e67 203d 206e 702e 6172 7261 7928  ting = np.array(
-00001c10: 5b20 666c 6f61 7428 6561 7374 290d 0a20  [ float(east).. 
-00001c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c40: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-00001c50: 6173 7420 696e 2065 6173 7469 6e67 5d29  ast in easting])
-00001c60: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-00001c70: 6365 7074 203a 7261 6973 6520 4353 6578  cept :raise CSex
-00001c80: 2e70 7943 5341 4d54 4572 726f 725f 666c  .pyCSAMTError_fl
-00001c90: 6f61 7428 0d0a 2020 2020 2020 2020 2020  oat(..          
-00001ca0: 2020 2020 2020 2020 2020 2745 6173 7469            'Easti
-00001cb0: 6e67 206d 7573 7420 6265 2066 6c6f 6174  ng must be float
-00001cc0: 206f 7220 616e 2061 7272 6179 206f 6620   or an array of 
-00001cd0: 666c 6f61 7420 6e75 6d62 6572 2e27 290d  float number.').
-00001ce0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00001cf0: 2020 2040 6e6f 7274 6869 6e67 2e73 6574     @northing.set
-00001d00: 7465 7220 0d0a 2020 2020 6465 6620 6e6f  ter ..    def no
-00001d10: 7274 6869 6e67 2028 7365 6c66 2c20 6e6f  rthing (self, no
-00001d20: 7274 6869 6e67 293a 200d 0a20 2020 2020  rthing): ..     
-00001d30: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00001d40: 286e 6f72 7468 696e 672c 2028 666c 6f61  (northing, (floa
-00001d50: 742c 696e 742c 7374 7229 293a 200d 0a20  t,int,str)): .. 
-00001d60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00001d70: 5f6e 6f72 7468 696e 673d 206e 702e 6172  _northing= np.ar
-00001d80: 7261 7928 6e6f 7274 6869 6e67 2c20 6474  ray(northing, dt
-00001d90: 7970 653d 666c 6f61 7429 0d0a 2020 2020  ype=float)..    
-00001da0: 2020 2020 656c 7365 203a 200d 0a20 2020      else : ..   
-00001db0: 2020 2020 2020 2020 2074 7279 203a 2073           try : s
-00001dc0: 656c 662e 5f6e 6f72 7468 696e 6720 3d20  elf._northing = 
-00001dd0: 6e70 2e61 7272 6179 285b 666c 6f61 7428  np.array([float(
-00001de0: 6e6f 7274 6829 200d 0a20 2020 2020 2020  north) ..       
-00001df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e10: 2020 2020 2020 666f 7220 6e6f 7274 6820        for north 
-00001e20: 696e 206e 6f72 7468 696e 675d 290d 0a20  in northing]).. 
-00001e30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00001e40: 2020 2020 2065 7863 6570 7420 3a20 7261       except : ra
-00001e50: 6973 6520 4353 6578 2e70 7943 5341 4d54  ise CSex.pyCSAMT
-00001e60: 4572 726f 725f 666c 6f61 7428 0d0a 2020  Error_float(..  
-00001e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e80: 2020 276e 6f72 7468 696e 6720 6d75 7374    'northing must
-00001e90: 2062 6520 666c 6f61 7420 6f72 2061 6e20   be float or an 
-00001ea0: 6172 7261 7920 6f66 2066 6c6f 6174 206e  array of float n
-00001eb0: 756d 6265 722e 2027 290d 0a20 2020 2020  umber. ')..     
-00001ec0: 2020 200d 0a20 2020 2040 7374 6e5f 706f     ..    @stn_po
-00001ed0: 732e 7365 7474 6572 200d 0a20 2020 2064  s.setter ..    d
-00001ee0: 6566 2073 746e 5f70 6f73 2028 7365 6c66  ef stn_pos (self
-00001ef0: 2c20 7374 6e5f 706b 293a 200d 0a20 2020  , stn_pk): ..   
-00001f00: 2020 2020 2074 7279 203a 2073 656c 662e       try : self.
-00001f10: 5f73 746e 5f70 6f73 203d 6e70 2e61 7272  _stn_pos =np.arr
-00001f20: 6179 285b 666c 6f61 7428 7374 6e29 200d  ay([float(stn) .
-00001f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f50: 2020 2020 2020 2020 666f 7220 7374 6e20          for stn 
-00001f60: 696e 2073 746e 5f70 6b5d 290d 0a20 2020  in stn_pk])..   
-00001f70: 2020 2020 2065 7863 6570 743a 7261 6973       except:rais
-00001f80: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-00001f90: 726f 725f 7374 6174 696f 6e28 0d0a 2020  ror_station(..  
-00001fa0: 2020 2020 2020 2020 2020 2753 7461 7469            'Stati
-00001fb0: 6f6e 2070 6b61 206d 7573 7420 6265 2066  on pka must be f
-00001fc0: 6c6f 6174 206e 756d 6265 722e 2120 2729  loat number.! ')
-00001fd0: 0d0a 0d0a 0d0a 2020 2020 4061 7a69 6d75  ......    @azimu
-00001fe0: 7468 2e73 6574 7465 7220 0d0a 2020 2020  th.setter ..    
-00001ff0: 6465 6620 617a 696d 7574 6820 2873 656c  def azimuth (sel
-00002000: 662c 2065 6173 7469 6e67 5f6e 6f72 7468  f, easting_north
-00002010: 696e 6729 3a0d 0a20 2020 2020 2020 2070  ing):..        p
-00002020: 7269 6e74 2865 6173 7469 6e67 5f6e 6f72  rint(easting_nor
-00002030: 7468 696e 6729 0d0a 2020 2020 2020 2020  thing)..        
-00002040: 6966 2065 6173 7469 6e67 5f6e 6f72 7468  if easting_north
-00002050: 696e 672e 7368 6170 655b 315d 2021 3d32  ing.shape[1] !=2
-00002060: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00002070: 2072 6169 7365 2043 5365 782e 7079 4353   raise CSex.pyCS
-00002080: 414d 5445 7272 6f72 5f61 7a69 6d75 7468  AMTError_azimuth
-00002090: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-000020a0: 2020 2027 417a 696d 7574 6820 6578 7065     'Azimuth expe
-000020b0: 6374 6564 2074 6f20 6765 7420 7477 6f20  cted to get two 
-000020c0: 6172 7261 795f 6c69 6b65 286e 6461 7272  array_like(ndarr
-000020d0: 6179 2c32 2927 2920 2020 2020 2020 2020  ay,2)')         
+000016e0: 2020 2020 2020 2020 2020 2066 6f72 6d61             forma
+000016f0: 7428 277c 272e 6a6f 696e 286c 6973 7428  t('|'.join(list(
+00001700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001710: 2020 2020 2020 2020 2020 2020 696e 464f              inFO
+00001720: 2e6e 6f74 696f 6e2e 7574 6d5f 7a6f 6e65  .notion.utm_zone
+00001730: 5f64 6963 745f 6465 7369 676e 6174 6f72  _dict_designator
+00001740: 2e6b 6579 7328 2929 2929 290d 0a20 2020  .keys()))))..   
+00001750: 2020 2020 2020 2020 2073 656c 662e 5f75           self._u
+00001760: 746d 5f7a 6f6e 6520 3d75 746d 5f7a 6f6e  tm_zone =utm_zon
+00001770: 650d 0a20 2020 200d 0a20 2020 2040 6c61  e..    ..    @la
+00001780: 7469 7475 6465 2e73 6574 7465 7220 0d0a  titude.setter ..
+00001790: 2020 2020 6465 6620 6c61 7469 7475 6465      def latitude
+000017a0: 2028 7365 6c66 2c20 6c61 7469 7475 6465   (self, latitude
+000017b0: 293a 200d 0a20 2020 2020 2020 2069 6620  ): ..        if 
+000017c0: 6973 696e 7374 616e 6365 286c 6174 6974  isinstance(latit
+000017d0: 7564 652c 2028 666c 6f61 742c 696e 742c  ude, (float,int,
+000017e0: 7374 7229 293a 0d0a 2020 2020 2020 2020  str)):..        
+000017f0: 2020 2020 7365 6c66 2e5f 6c61 7469 7475      self._latitu
+00001800: 6465 3d20 6769 732e 6173 7365 7274 5f6c  de= gis.assert_l
+00001810: 6174 5f76 616c 7565 286c 6174 6974 7564  at_value(latitud
+00001820: 6529 0d0a 2020 2020 2020 2020 656c 7365  e)..        else
+00001830: 3a20 7365 6c66 2e5f 6c61 7469 7475 6465  : self._latitude
+00001840: 203d 206e 702e 6172 7261 7928 5b67 6973   = np.array([gis
+00001850: 2e61 7373 6572 745f 6c61 745f 7661 6c75  .assert_lat_valu
+00001860: 6528 6c61 7429 0d0a 2020 2020 2020 2020  e(lat)..        
+00001870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001890: 2066 6f72 206c 6174 2069 6e20 6c61 7469   for lat in lati
+000018a0: 7475 6465 205d 290d 0a20 2020 2020 2020  tude ])..       
+000018b0: 200d 0a20 2020 2040 6c6f 6e67 6974 7564   ..    @longitud
+000018c0: 652e 7365 7474 6572 200d 0a20 2020 2064  e.setter ..    d
+000018d0: 6566 206c 6f6e 6769 7475 6465 2873 656c  ef longitude(sel
+000018e0: 662c 206c 6f6e 6769 7475 6465 2920 3a20  f, longitude) : 
+000018f0: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00001900: 6e73 7461 6e63 6528 6c6f 6e67 6974 7564  nstance(longitud
+00001910: 652c 2028 666c 6f61 742c 696e 742c 7374  e, (float,int,st
+00001920: 7229 293a 0d0a 2020 2020 2020 2020 2020  r)):..          
+00001930: 2020 7365 6c66 2e5f 6c6f 6e67 6974 7564    self._longitud
+00001940: 653d 2067 6973 2e61 7373 6572 745f 6c6f  e= gis.assert_lo
+00001950: 6e5f 7661 6c75 6528 6c6f 6e67 6974 7564  n_value(longitud
+00001960: 6529 0d0a 2020 2020 2020 2020 656c 7365  e)..        else
+00001970: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00001980: 7365 6c66 2e5f 6c6f 6e67 6974 7564 6520  self._longitude 
+00001990: 3d20 6e70 2e61 7272 6179 285b 6769 732e  = np.array([gis.
+000019a0: 6173 7365 7274 5f6c 6f6e 5f76 616c 7565  assert_lon_value
+000019b0: 286c 6f6e 2920 666f 7220 0d0a 2020 2020  (lon) for ..    
+000019c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000019d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000019e0: 2020 2020 6c6f 6e20 696e 206c 6f6e 6769      lon in longi
+000019f0: 7475 6465 205d 290d 0a20 2020 2020 2020  tude ])..       
+00001a00: 200d 0a20 2020 2040 656c 6576 6174 696f   ..    @elevatio
+00001a10: 6e2e 7365 7474 6572 200d 0a20 2020 2064  n.setter ..    d
+00001a20: 6566 2065 6c65 7661 7469 6f6e 2873 656c  ef elevation(sel
+00001a30: 662c 2065 6c65 7661 7469 6f6e 2920 3a20  f, elevation) : 
+00001a40: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00001a50: 6e73 7461 6e63 6528 656c 6576 6174 696f  nstance(elevatio
+00001a60: 6e2c 2028 666c 6f61 742c 696e 742c 7374  n, (float,int,st
+00001a70: 7229 293a 200d 0a20 2020 2020 2020 2020  r)): ..         
+00001a80: 2020 2073 656c 662e 5f65 6c65 7661 7469     self._elevati
+00001a90: 6f6e 3d20 6769 732e 6173 7365 7274 5f65  on= gis.assert_e
+00001aa0: 6c65 7661 7469 6f6e 5f76 616c 7565 2865  levation_value(e
+00001ab0: 6c65 7661 7469 6f6e 290d 0a20 2020 2020  levation)..     
+00001ac0: 2020 2065 6c73 6520 3a0d 0a20 2020 2020     else :..     
+00001ad0: 2020 2020 2020 2073 656c 662e 5f65 6c65         self._ele
+00001ae0: 7661 7469 6f6e 203d 206e 702e 6172 7261  vation = np.arra
+00001af0: 7928 5b67 6973 2e61 7373 6572 745f 656c  y([gis.assert_el
+00001b00: 6576 6174 696f 6e5f 7661 6c75 6520 2865  evation_value (e
+00001b10: 6c65 7629 0d0a 2020 2020 2020 2020 2020  lev)..          
+00001b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001b30: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00001b40: 7220 656c 6576 2069 6e20 656c 6576 6174  r elev in elevat
+00001b50: 696f 6e5d 2920 0d0a 2020 2020 2020 2020  ion]) ..        
+00001b60: 0d0a 2020 2020 4065 6173 7469 6e67 2e73  ..    @easting.s
+00001b70: 6574 7465 7220 0d0a 2020 2020 6465 6620  etter ..    def 
+00001b80: 6561 7374 696e 6720 2873 656c 662c 2065  easting (self, e
+00001b90: 6173 7469 6e67 293a 200d 0a20 2020 2020  asting): ..     
+00001ba0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00001bb0: 2865 6173 7469 6e67 2c20 2866 6c6f 6174  (easting, (float
+00001bc0: 2c69 6e74 2c73 7472 2929 3a20 0d0a 2020  ,int,str)): ..  
+00001bd0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00001be0: 6561 7374 696e 673d 206e 702e 6172 7261  easting= np.arra
+00001bf0: 7928 6561 7374 696e 672c 2064 7479 7065  y(easting, dtype
+00001c00: 3d66 6c6f 6174 290d 0a20 2020 2020 2020  =float)..       
+00001c10: 2065 6c73 6520 3a20 0d0a 2020 2020 2020   else : ..      
+00001c20: 2020 2020 2020 7472 7920 3a20 7365 6c66        try : self
+00001c30: 2e5f 6561 7374 696e 6720 3d20 6e70 2e61  ._easting = np.a
+00001c40: 7272 6179 285b 2066 6c6f 6174 2865 6173  rray([ float(eas
+00001c50: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+00001c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001c80: 666f 7220 6561 7374 2069 6e20 6561 7374  for east in east
+00001c90: 696e 675d 290d 0a20 2020 2020 2020 2020  ing])..         
+00001ca0: 2020 2065 7863 6570 7420 3a72 6169 7365     except :raise
+00001cb0: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
+00001cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001cd0: 2027 4561 7374 696e 6720 6d75 7374 2062   'Easting must b
+00001ce0: 6520 666c 6f61 7420 6f72 2061 6e20 6172  e float or an ar
+00001cf0: 7261 7920 6f66 2066 6c6f 6174 206e 756d  ray of float num
+00001d00: 6265 722e 2729 0d0a 2020 2020 2020 2020  ber.')..        
+00001d10: 2020 2020 0d0a 2020 2020 406e 6f72 7468      ..    @north
+00001d20: 696e 672e 7365 7474 6572 200d 0a20 2020  ing.setter ..   
+00001d30: 2064 6566 206e 6f72 7468 696e 6720 2873   def northing (s
+00001d40: 656c 662c 206e 6f72 7468 696e 6729 3a20  elf, northing): 
+00001d50: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00001d60: 6e73 7461 6e63 6528 6e6f 7274 6869 6e67  nstance(northing
+00001d70: 2c20 2866 6c6f 6174 2c69 6e74 2c73 7472  , (float,int,str
+00001d80: 2929 3a20 0d0a 2020 2020 2020 2020 2020  )): ..          
+00001d90: 2020 7365 6c66 2e5f 6e6f 7274 6869 6e67    self._northing
+00001da0: 3d20 6e70 2e61 7272 6179 286e 6f72 7468  = np.array(north
+00001db0: 696e 672c 2064 7479 7065 3d66 6c6f 6174  ing, dtype=float
+00001dc0: 290d 0a20 2020 2020 2020 2065 6c73 6520  )..        else 
+00001dd0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00001de0: 7472 7920 3a20 7365 6c66 2e5f 6e6f 7274  try : self._nort
+00001df0: 6869 6e67 203d 206e 702e 6172 7261 7928  hing = np.array(
+00001e00: 5b66 6c6f 6174 286e 6f72 7468 2920 0d0a  [float(north) ..
+00001e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e30: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00001e40: 206e 6f72 7468 2069 6e20 6e6f 7274 6869   north in northi
+00001e50: 6e67 5d29 0d0a 2020 2020 2020 2020 0d0a  ng])..        ..
+00001e60: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00001e70: 7074 203a 2072 6169 7365 2054 7970 6545  pt : raise TypeE
+00001e80: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00001e90: 2020 2020 2020 2020 2020 2027 6e6f 7274             'nort
+00001ea0: 6869 6e67 206d 7573 7420 6265 2066 6c6f  hing must be flo
+00001eb0: 6174 206f 7220 616e 2061 7272 6179 206f  at or an array o
+00001ec0: 6620 666c 6f61 7420 6e75 6d62 6572 2e20  f float number. 
+00001ed0: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
+00001ee0: 2020 4073 746e 5f70 6f73 2e73 6574 7465    @stn_pos.sette
+00001ef0: 7220 0d0a 2020 2020 6465 6620 7374 6e5f  r ..    def stn_
+00001f00: 706f 7320 2873 656c 662c 2073 746e 5f70  pos (self, stn_p
+00001f10: 6b29 3a20 0d0a 2020 2020 2020 2020 7472  k): ..        tr
+00001f20: 7920 3a20 7365 6c66 2e5f 7374 6e5f 706f  y : self._stn_po
+00001f30: 7320 3d6e 702e 6172 7261 7928 5b66 6c6f  s =np.array([flo
+00001f40: 6174 2873 746e 2920 0d0a 2020 2020 2020  at(stn) ..      
+00001f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f70: 2066 6f72 2073 746e 2069 6e20 7374 6e5f   for stn in stn_
+00001f80: 706b 5d29 0d0a 2020 2020 2020 2020 6578  pk])..        ex
+00001f90: 6365 7074 3a72 6169 7365 2053 7461 7469  cept:raise Stati
+00001fa0: 6f6e 4572 726f 7228 0d0a 2020 2020 2020  onError(..      
+00001fb0: 2020 2020 2020 2753 7461 7469 6f6e 2070        'Station p
+00001fc0: 6b61 206d 7573 7420 6265 2066 6c6f 6174  ka must be float
+00001fd0: 206e 756d 6265 722e 2120 2729 0d0a 0d0a   number.! ')....
+00001fe0: 0d0a 2020 2020 4061 7a69 6d75 7468 2e73  ..    @azimuth.s
+00001ff0: 6574 7465 7220 0d0a 2020 2020 6465 6620  etter ..    def 
+00002000: 617a 696d 7574 6820 2873 656c 662c 2065  azimuth (self, e
+00002010: 6173 7469 6e67 5f6e 6f72 7468 696e 6729  asting_northing)
+00002020: 3a0d 0a20 2020 2020 2020 2070 7269 6e74  :..        print
+00002030: 2865 6173 7469 6e67 5f6e 6f72 7468 696e  (easting_northin
+00002040: 6729 0d0a 2020 2020 2020 2020 6966 2065  g)..        if e
+00002050: 6173 7469 6e67 5f6e 6f72 7468 696e 672e  asting_northing.
+00002060: 7368 6170 655b 315d 2021 3d32 203a 200d  shape[1] !=2 : .
+00002070: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00002080: 7365 2041 7a69 6d75 7468 4572 726f 7228  se AzimuthError(
+00002090: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000020a0: 2020 2741 7a69 6d75 7468 2065 7870 6563    'Azimuth expec
+000020b0: 7465 6420 746f 2067 6574 2074 776f 2061  ted to get two a
+000020c0: 7272 6179 5f6c 696b 6528 6e64 6172 7261  rray_like(ndarra
+000020d0: 792c 3229 2729 2020 2020 2020 2020 2020  y,2)')          
 000020e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000020f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002100: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002110: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002130: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00002140: 2020 2020 2065 6c69 6620 6561 7374 696e       elif eastin
-00002150: 675f 6e6f 7274 6869 6e67 2e73 6861 7065  g_northing.shape
-00002160: 5b31 5d20 3d3d 3220 3a20 0d0a 2020 2020  [1] ==2 : ..    
-00002170: 2020 2020 2020 2020 6561 7374 696e 6720          easting 
-00002180: 2c20 6e6f 7274 6869 6e67 203d 6e70 2e68  , northing =np.h
-00002190: 7370 6c69 7428 6561 7374 696e 675f 6e6f  split(easting_no
-000021a0: 7274 6869 6e67 2c20 3229 0d0a 2020 2020  rthing, 2)..    
-000021b0: 2020 2020 2020 2020 7365 6c66 2e5f 617a          self._az
-000021c0: 696d 7574 6820 3d66 756e 632e 636f 6d70  imuth =func.comp
-000021d0: 7574 655f 617a 696d 7574 6828 6561 7374  ute_azimuth(east
-000021e0: 696e 673d 6e70 2e61 7272 6179 280d 0a20  ing=np.array(.. 
-000021f0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00002200: 666c 6f61 7428 6561 7329 666f 7220 6561  float(eas)for ea
-00002210: 7320 696e 2065 6173 7469 6e67 5d29 2c20  s in easting]), 
-00002220: 6e6f 7274 6869 6e67 3d6e 702e 6172 7261  northing=np.arra
-00002230: 7928 5b66 6c6f 6174 286e 6f72 2920 0d0a  y([float(nor) ..
+00002130: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00002140: 2020 2020 656c 6966 2065 6173 7469 6e67      elif easting
+00002150: 5f6e 6f72 7468 696e 672e 7368 6170 655b  _northing.shape[
+00002160: 315d 203d 3d32 203a 200d 0a20 2020 2020  1] ==2 : ..     
+00002170: 2020 2020 2020 2065 6173 7469 6e67 202c         easting ,
+00002180: 206e 6f72 7468 696e 6720 3d6e 702e 6873   northing =np.hs
+00002190: 706c 6974 2865 6173 7469 6e67 5f6e 6f72  plit(easting_nor
+000021a0: 7468 696e 672c 2032 290d 0a20 2020 2020  thing, 2)..     
+000021b0: 2020 2020 2020 2073 656c 662e 5f61 7a69         self._azi
+000021c0: 6d75 7468 203d 6675 6e63 2e63 6f6d 7075  muth =func.compu
+000021d0: 7465 5f61 7a69 6d75 7468 2865 6173 7469  te_azimuth(easti
+000021e0: 6e67 3d6e 702e 6172 7261 7928 0d0a 2020  ng=np.array(..  
+000021f0: 2020 2020 2020 2020 2020 2020 2020 5b66                [f
+00002200: 6c6f 6174 2865 6173 2966 6f72 2065 6173  loat(eas)for eas
+00002210: 2069 6e20 6561 7374 696e 675d 292c 206e   in easting]), n
+00002220: 6f72 7468 696e 673d 6e70 2e61 7272 6179  orthing=np.array
+00002230: 285b 666c 6f61 7428 6e6f 7229 200d 0a20  ([float(nor) .. 
 00002240: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002260: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00002270: 7220 6e6f 7220 696e 206e 6f72 7468 696e  r nor in northin
-00002280: 675d 2929 0d0a 0d0a 2020 2020 6465 6620  g]))....    def 
-00002290: 636f 6e76 6572 745f 6c6f 6361 7469 6f6e  convert_location
-000022a0: 5f32 5f75 746d 2028 7365 6c66 2c20 6c61  _2_utm (self, la
-000022b0: 7469 7475 6465 203d 4e6f 6e65 2020 2c20  titude =None  , 
-000022c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002260: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00002270: 206e 6f72 2069 6e20 6e6f 7274 6869 6e67   nor in northing
+00002280: 5d29 290d 0a0d 0a20 2020 2064 6566 2063  ]))....    def c
+00002290: 6f6e 7665 7274 5f6c 6f63 6174 696f 6e5f  onvert_location_
+000022a0: 325f 7574 6d20 2873 656c 662c 206c 6174  2_utm (self, lat
+000022b0: 6974 7564 6520 3d4e 6f6e 6520 202c 200d  itude =None  , .
+000022c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000022d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000022e0: 2020 6c6f 6e67 6974 7564 653d 4e6f 6e65    longitude=None
-000022f0: 2029 3a20 0d0a 2020 2020 2020 2020 2222   ): ..        ""
-00002300: 220d 0a20 2020 2020 2020 2050 726f 6a65  "..        Proje
-00002310: 6374 2063 6f6f 7264 696e 6174 6573 2074  ct coordinates t
-00002320: 6f20 7574 6d20 6966 2063 6f6f 7264 696e  o utm if coordin
-00002330: 6174 6573 2061 7265 2069 6e20 6465 6772  ates are in degr
-00002340: 6565 7320 6174 2020 0d0a 2020 2020 2020  ees at  ..      
-00002350: 2020 6769 7665 6e20 7265 6665 7265 6e63    given referenc
-00002360: 6520 656c 6c69 7073 6f69 6420 636f 6e73  e ellipsoid cons
-00002370: 7472 6169 6e65 6420 746f 2057 4753 3834  trained to WGS84
-00002380: 2e0d 0a20 2020 2020 2020 2020 0d0a 2020  ...         ..  
-00002390: 2020 2020 2020 3a70 6172 616d 206c 6174        :param lat
-000023a0: 6974 7564 653a 2020 6c61 7469 7475 6465  itude:  latitude
-000023b0: 206e 756d 6265 7220 0d0a 2020 2020 2020   number ..      
-000023c0: 2020 3a74 7970 6520 6c61 7469 7475 6465    :type latitude
-000023d0: 3a20 666c 6f61 7420 0d0a 2020 2020 2020  : float ..      
-000023e0: 2020 0d0a 2020 2020 2020 2020 3a70 6172    ..        :par
-000023f0: 616d 206c 6f6e 6769 7475 6465 3a20 6c6f  am longitude: lo
-00002400: 6e67 6974 7564 6520 6e75 6d62 6572 200d  ngitude number .
-00002410: 0a20 2020 2020 2020 203a 7479 7065 206c  .        :type l
-00002420: 6f6e 6769 7475 6465 3a20 666c 6f61 7420  ongitude: float 
-00002430: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00002440: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00002450: 2069 6620 6c61 7469 7475 6465 2069 7320   if latitude is 
-00002460: 6e6f 7420 4e6f 6e65 203a 2073 656c 662e  not None : self.
-00002470: 6c61 7469 7475 6465 203d 206c 6174 6974  latitude = latit
-00002480: 7564 650d 0a20 2020 2020 2020 2069 6620  ude..        if 
-00002490: 6c6f 6e67 6974 7564 6520 6973 206e 6f74  longitude is not
-000024a0: 204e 6f6e 6520 3a20 7365 6c66 2e6c 6f6e   None : self.lon
-000024b0: 6769 7475 6465 203d 6c6f 6e67 6974 7564  gitude =longitud
-000024c0: 650d 0a20 2020 2020 2020 200d 0a20 2020  e..        ..   
-000024d0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-000024e0: 6365 2873 656c 662e 6c61 7469 7475 6465  ce(self.latitude
-000024f0: 2c20 6e70 2e6e 6461 7272 6179 293a 0d0a  , np.ndarray):..
-00002500: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00002510: 656c 662e 6c61 7469 7475 6465 2e73 697a  elf.latitude.siz
-00002520: 6520 3e3d 2031 206f 7220 7365 6c66 2e6c  e >= 1 or self.l
-00002530: 6f6e 6769 7475 6465 203e 3d31 3a20 2320  ongitude >=1: # 
-00002540: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002550: 2020 6173 7365 7274 2020 7365 6c66 2e6c    assert  self.l
-00002560: 6174 6974 7564 652e 7369 7a65 203d 3d73  atitude.size ==s
-00002570: 656c 662e 6c6f 6e67 6974 7564 652e 7369  elf.longitude.si
-00002580: 7a65 2c5c 0d0a 2020 2020 2020 2020 2020  ze,\..          
-00002590: 2020 2020 2020 2020 2020 4353 6578 2e70            CSex.p
-000025a0: 7943 5341 4d54 4572 726f 725f 6c6f 6361  yCSAMTError_loca
-000025b0: 7469 6f6e 280d 0a20 2020 2020 2020 2020  tion(..         
-000025c0: 2020 2020 2020 2020 2020 2027 6c61 7469             'lati
-000025d0: 7475 6465 2061 6e64 206c 6f6e 6769 7475  tude and longitu
-000025e0: 6465 206d 7573 7420 6265 2074 6865 2073  de must be the s
-000025f0: 616d 6520 7369 7a65 2e27 2920 0d0a 2020  ame size.') ..  
-00002600: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00002610: 2020 2020 7365 6c66 2e65 6173 7469 6e67      self.easting
-00002620: 203d 206e 702e 6172 7261 7928 5b20 0d0a   = np.array([ ..
-00002630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002640: 2020 2020 6769 732e 6c6c 5f74 6f5f 7574      gis.ll_to_ut
-00002650: 6d28 7265 6665 7265 6e63 655f 656c 6c69  m(reference_elli
-00002660: 7073 6f69 643d 3233 2c0d 0a20 2020 2020  psoid=23,..     
-00002670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002680: 2020 206c 6174 3d73 656c 662e 6c61 7469     lat=self.lati
-00002690: 7475 6465 5b69 695d 2c0d 0a20 2020 2020  tude[ii],..     
-000026a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000026b0: 2020 206c 6f6e 3d73 656c 662e 6c6f 6e67     lon=self.long
-000026c0: 6974 7564 655b 6969 5d29 205b 315d 0d0a  itude[ii]) [1]..
+000022e0: 206c 6f6e 6769 7475 6465 3d4e 6f6e 6520   longitude=None 
+000022f0: 293a 200d 0a20 2020 2020 2020 2022 2222  ): ..        """
+00002300: 0d0a 2020 2020 2020 2020 5072 6f6a 6563  ..        Projec
+00002310: 7420 636f 6f72 6469 6e61 7465 7320 746f  t coordinates to
+00002320: 2075 746d 2069 6620 636f 6f72 6469 6e61   utm if coordina
+00002330: 7465 7320 6172 6520 696e 2064 6567 7265  tes are in degre
+00002340: 6573 2061 7420 200d 0a20 2020 2020 2020  es at  ..       
+00002350: 2067 6976 656e 2072 6566 6572 656e 6365   given reference
+00002360: 2065 6c6c 6970 736f 6964 2063 6f6e 7374   ellipsoid const
+00002370: 7261 696e 6564 2074 6f20 5747 5338 342e  rained to WGS84.
+00002380: 0d0a 2020 2020 2020 2020 200d 0a20 2020  ..         ..   
+00002390: 2020 2020 203a 7061 7261 6d20 6c61 7469       :param lati
+000023a0: 7475 6465 3a20 206c 6174 6974 7564 6520  tude:  latitude 
+000023b0: 6e75 6d62 6572 200d 0a20 2020 2020 2020  number ..       
+000023c0: 203a 7479 7065 206c 6174 6974 7564 653a   :type latitude:
+000023d0: 2066 6c6f 6174 200d 0a20 2020 2020 2020   float ..       
+000023e0: 200d 0a20 2020 2020 2020 203a 7061 7261   ..        :para
+000023f0: 6d20 6c6f 6e67 6974 7564 653a 206c 6f6e  m longitude: lon
+00002400: 6769 7475 6465 206e 756d 6265 7220 0d0a  gitude number ..
+00002410: 2020 2020 2020 2020 3a74 7970 6520 6c6f          :type lo
+00002420: 6e67 6974 7564 653a 2066 6c6f 6174 200d  ngitude: float .
+00002430: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00002440: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00002450: 6966 206c 6174 6974 7564 6520 6973 206e  if latitude is n
+00002460: 6f74 204e 6f6e 6520 3a20 7365 6c66 2e6c  ot None : self.l
+00002470: 6174 6974 7564 6520 3d20 6c61 7469 7475  atitude = latitu
+00002480: 6465 0d0a 2020 2020 2020 2020 6966 206c  de..        if l
+00002490: 6f6e 6769 7475 6465 2069 7320 6e6f 7420  ongitude is not 
+000024a0: 4e6f 6e65 203a 2073 656c 662e 6c6f 6e67  None : self.long
+000024b0: 6974 7564 6520 3d6c 6f6e 6769 7475 6465  itude =longitude
+000024c0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000024d0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000024e0: 6528 7365 6c66 2e6c 6174 6974 7564 652c  e(self.latitude,
+000024f0: 206e 702e 6e64 6172 7261 7929 3a0d 0a20   np.ndarray):.. 
+00002500: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00002510: 6c66 2e6c 6174 6974 7564 652e 7369 7a65  lf.latitude.size
+00002520: 203e 3d20 3120 6f72 2073 656c 662e 6c6f   >= 1 or self.lo
+00002530: 6e67 6974 7564 6520 3e3d 313a 2023 200d  ngitude >=1: # .
+00002540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002550: 2061 7373 6572 7420 2073 656c 662e 6c61   assert  self.la
+00002560: 7469 7475 6465 2e73 697a 6520 3d3d 7365  titude.size ==se
+00002570: 6c66 2e6c 6f6e 6769 7475 6465 2e73 697a  lf.longitude.siz
+00002580: 652c 5c0d 0a20 2020 2020 2020 2020 2020  e,\..           
+00002590: 2020 2020 2020 2020 204c 6f63 6174 696f           Locatio
+000025a0: 6e45 7272 6f72 280d 0a20 2020 2020 2020  nError(..       
+000025b0: 2020 2020 2020 2020 2020 2020 2027 6c61               'la
+000025c0: 7469 7475 6465 2061 6e64 206c 6f6e 6769  titude and longi
+000025d0: 7475 6465 206d 7573 7420 6265 2074 6865  tude must be the
+000025e0: 2073 616d 6520 7369 7a65 2e27 2920 0d0a   same size.') ..
+000025f0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00002600: 2020 2020 2020 7365 6c66 2e65 6173 7469        self.easti
+00002610: 6e67 203d 206e 702e 6172 7261 7928 5b20  ng = np.array([ 
+00002620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002630: 2020 2020 2020 6769 732e 6c6c 5f74 6f5f        gis.ll_to_
+00002640: 7574 6d28 7265 6665 7265 6e63 655f 656c  utm(reference_el
+00002650: 6c69 7073 6f69 643d 3233 2c0d 0a20 2020  lipsoid=23,..   
+00002660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002670: 2020 2020 206c 6174 3d73 656c 662e 6c61       lat=self.la
+00002680: 7469 7475 6465 5b69 695d 2c0d 0a20 2020  titude[ii],..   
+00002690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000026a0: 2020 2020 206c 6f6e 3d73 656c 662e 6c6f       lon=self.lo
+000026b0: 6e67 6974 7564 655b 6969 5d29 205b 315d  ngitude[ii]) [1]
+000026c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 000026d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000026e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000026f0: 666f 7220 6969 2069 6e20 7261 6e67 6528  for ii in range(
-00002700: 7365 6c66 2e6c 6174 6974 7564 652e 7369  self.latitude.si
-00002710: 7a65 295d 290d 0a20 2020 2020 2020 2020  ze)])..         
-00002720: 2020 2020 2020 2073 656c 662e 6e6f 7274         self.nort
-00002730: 6869 6e67 203d 6e70 2e61 7272 6179 2820  hing =np.array( 
-00002740: 5b20 0d0a 2020 2020 2020 2020 2020 2020  [ ..            
-00002750: 2020 2020 2020 2020 6769 732e 6c6c 5f74          gis.ll_t
-00002760: 6f5f 7574 6d28 7265 6665 7265 6e63 655f  o_utm(reference_
-00002770: 656c 6c69 7073 6f69 643d 3233 2c0d 0a20  ellipsoid=23,.. 
+000026e0: 2020 666f 7220 6969 2069 6e20 7261 6e67    for ii in rang
+000026f0: 6528 7365 6c66 2e6c 6174 6974 7564 652e  e(self.latitude.
+00002700: 7369 7a65 295d 290d 0a20 2020 2020 2020  size)])..       
+00002710: 2020 2020 2020 2020 2073 656c 662e 6e6f           self.no
+00002720: 7274 6869 6e67 203d 6e70 2e61 7272 6179  rthing =np.array
+00002730: 2820 5b20 0d0a 2020 2020 2020 2020 2020  ( [ ..          
+00002740: 2020 2020 2020 2020 2020 6769 732e 6c6c            gis.ll
+00002750: 5f74 6f5f 7574 6d28 7265 6665 7265 6e63  _to_utm(referenc
+00002760: 655f 656c 6c69 7073 6f69 643d 3233 2c0d  e_ellipsoid=23,.
+00002770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00002780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002790: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000027a0: 6174 3d73 656c 662e 6c61 7469 7475 6465  at=self.latitude
-000027b0: 5b69 695d 2c0d 0a20 2020 2020 2020 2020  [ii],..         
-000027c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000027d0: 2020 2020 2020 206c 6f6e 3d73 656c 662e         lon=self.
-000027e0: 6c6f 6e67 6974 7564 655b 6969 5d29 205b  longitude[ii]) [
-000027f0: 325d 200d 0a20 2020 2020 2020 2020 2020  2] ..           
-00002800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002810: 2066 6f72 2069 6920 696e 2072 616e 6765   for ii in range
-00002820: 2873 656c 662e 6c61 7469 7475 6465 2e73  (self.latitude.s
-00002830: 697a 6529 5d29 0d0a 2020 2020 2020 2020  ize)])..        
-00002840: 2020 2020 0d0a 2020 2020 2020 2020 656c      ..        el
-00002850: 7365 203a 200d 0a20 2020 2020 2020 2020  se : ..         
-00002860: 2020 205f 6461 7461 5f69 6e66 6f5f 7574     _data_info_ut
-00002870: 6d20 3d67 6973 2e6c 6c5f 746f 5f75 746d  m =gis.ll_to_utm
-00002880: 2872 6566 6572 656e 6365 5f65 6c6c 6970  (reference_ellip
-00002890: 736f 6964 3d32 332c 0d0a 2020 2020 2020  soid=23,..      
+00002790: 206c 6174 3d73 656c 662e 6c61 7469 7475   lat=self.latitu
+000027a0: 6465 5b69 695d 2c0d 0a20 2020 2020 2020  de[ii],..       
+000027b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000027c0: 2020 2020 2020 2020 206c 6f6e 3d73 656c           lon=sel
+000027d0: 662e 6c6f 6e67 6974 7564 655b 6969 5d29  f.longitude[ii])
+000027e0: 205b 325d 200d 0a20 2020 2020 2020 2020   [2] ..         
+000027f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002800: 2020 2066 6f72 2069 6920 696e 2072 616e     for ii in ran
+00002810: 6765 2873 656c 662e 6c61 7469 7475 6465  ge(self.latitude
+00002820: 2e73 697a 6529 5d29 0d0a 2020 2020 2020  .size)])..      
+00002830: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00002840: 656c 7365 203a 200d 0a20 2020 2020 2020  else : ..       
+00002850: 2020 2020 205f 6461 7461 5f69 6e66 6f5f       _data_info_
+00002860: 7574 6d20 3d67 6973 2e6c 6c5f 746f 5f75  utm =gis.ll_to_u
+00002870: 746d 2872 6566 6572 656e 6365 5f65 6c6c  tm(reference_ell
+00002880: 6970 736f 6964 3d32 332c 0d0a 2020 2020  ipsoid=23,..    
+00002890: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000028a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028c0: 2020 2020 6c61 743d 7365 6c66 2e6c 6174      lat=self.lat
-000028d0: 6974 7564 652c 0d0a 2020 2020 2020 2020  itude,..        
+000028b0: 2020 2020 2020 6c61 743d 7365 6c66 2e6c        lat=self.l
+000028c0: 6174 6974 7564 652c 0d0a 2020 2020 2020  atitude,..      
+000028d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000028e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002900: 2020 6c6f 6e3d 7365 6c66 2e6c 6f6e 6769    lon=self.longi
-00002910: 7475 6465 290d 0a20 2020 2020 2020 2020  tude)..         
-00002920: 2020 2073 656c 662e 7574 6d5f 7a6f 6e65     self.utm_zone
-00002930: 203d 205f 6461 7461 5f69 6e66 6f5f 7574   = _data_info_ut
-00002940: 6d5b 305d 0d0a 2020 2020 2020 2020 2020  m[0]..          
-00002950: 2020 7365 6c66 2e65 6173 7469 6e67 203d    self.easting =
-00002960: 5f64 6174 615f 696e 666f 5f75 746d 5b31  _data_info_utm[1
-00002970: 5d0d 0a20 2020 2020 2020 2020 2020 2073  ]..            s
-00002980: 656c 662e 6e6f 7274 6869 6e67 3d5f 6461  elf.northing=_da
-00002990: 7461 5f69 6e66 6f5f 7574 6d20 5b32 5d0d  ta_info_utm [2].
-000029a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000029b0: 2020 200d 0a20 2020 2064 6566 2063 6f6e     ..    def con
-000029c0: 7665 7274 5f6c 6f63 6174 696f 6e5f 325f  vert_location_2_
-000029d0: 6c61 746c 6f6e 2873 656c 662c 2075 746d  latlon(self, utm
-000029e0: 5f7a 6f6e 6520 3d4e 6f6e 6520 293a 200d  _zone =None ): .
-000029f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00002a00: 2020 2020 2020 5072 6f6a 6563 7420 636f        Project co
-00002a10: 6f64 696e 6174 6520 6f6e 206c 6f6e 6769  odinate on longi
-00002a20: 7475 6465 206c 6174 6974 7564 6520 6f6e  tude latitude on
-00002a30: 6365 2020 0d0a 2020 2020 2020 2020 6461  ce  ..        da
-00002a40: 7461 2061 7265 2075 746d 2061 7420 2067  ta are utm at  g
-00002a50: 6976 656e 2072 6566 6572 656e 6365 2065  iven reference e
-00002a60: 6c6c 6973 706f 6964 200d 0a20 2020 2020  llispoid ..     
-00002a70: 2020 2063 6f6e 7374 7261 696e 6564 2074     constrained t
-00002a80: 6f20 5747 532d 3834 2e0d 0a20 2020 2020  o WGS-84...     
-00002a90: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00002aa0: 6966 2075 746d 5f7a 6f6e 6520 6973 206e  if utm_zone is n
-00002ab0: 6f74 204e 6f6e 6520 3a20 7365 6c66 2e5f  ot None : self._
-00002ac0: 7574 6d5f 7a6f 6e65 203d 7574 6d5f 7a6f  utm_zone =utm_zo
-00002ad0: 6e65 200d 0a20 2020 2020 2020 2069 6620  ne ..        if 
-00002ae0: 7365 6c66 2e5f 7574 6d5f 7a6f 6e65 2069  self._utm_zone i
-00002af0: 7320 4e6f 6e65 203a 0d0a 2020 2020 2020  s None :..      
-00002b00: 2020 2020 2020 7261 6973 6520 4353 6578        raise CSex
-00002b10: 2e70 7943 5341 4d54 4572 726f 725f 6c6f  .pyCSAMTError_lo
-00002b20: 6361 7469 6f6e 280d 0a20 2020 2020 2020  cation(..       
-00002b30: 2020 2020 2020 2020 2027 5472 7920 746f           'Try to
-00002b40: 2069 6e70 7574 2074 6865 2075 746d 5f7a   input the utm_z
-00002b50: 6f6e 6520 3a20 652e 672e 3a20 3439 4e27  one : e.g.: 49N'
-00002b60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000028f0: 2020 2020 6c6f 6e3d 7365 6c66 2e6c 6f6e      lon=self.lon
+00002900: 6769 7475 6465 290d 0a20 2020 2020 2020  gitude)..       
+00002910: 2020 2020 2073 656c 662e 7574 6d5f 7a6f       self.utm_zo
+00002920: 6e65 203d 205f 6461 7461 5f69 6e66 6f5f  ne = _data_info_
+00002930: 7574 6d5b 305d 0d0a 2020 2020 2020 2020  utm[0]..        
+00002940: 2020 2020 7365 6c66 2e65 6173 7469 6e67      self.easting
+00002950: 203d 5f64 6174 615f 696e 666f 5f75 746d   =_data_info_utm
+00002960: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
+00002970: 2073 656c 662e 6e6f 7274 6869 6e67 3d5f   self.northing=_
+00002980: 6461 7461 5f69 6e66 6f5f 7574 6d20 5b32  data_info_utm [2
+00002990: 5d0d 0a20 2020 2020 2020 200d 0a20 2020  ]..        ..   
+000029a0: 2020 2020 200d 0a20 2020 2064 6566 2063       ..    def c
+000029b0: 6f6e 7665 7274 5f6c 6f63 6174 696f 6e5f  onvert_location_
+000029c0: 325f 6c61 746c 6f6e 2873 656c 662c 2075  2_latlon(self, u
+000029d0: 746d 5f7a 6f6e 6520 3d4e 6f6e 6520 293a  tm_zone =None ):
+000029e0: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+000029f0: 2020 2020 2020 2020 5072 6f6a 6563 7420          Project 
+00002a00: 636f 6f64 696e 6174 6520 6f6e 206c 6f6e  coodinate on lon
+00002a10: 6769 7475 6465 206c 6174 6974 7564 6520  gitude latitude 
+00002a20: 6f6e 6365 2020 0d0a 2020 2020 2020 2020  once  ..        
+00002a30: 6461 7461 2061 7265 2075 746d 2061 7420  data are utm at 
+00002a40: 2067 6976 656e 2072 6566 6572 656e 6365   given reference
+00002a50: 2065 6c6c 6973 706f 6964 200d 0a20 2020   ellispoid ..   
+00002a60: 2020 2020 2063 6f6e 7374 7261 696e 6564       constrained
+00002a70: 2074 6f20 5747 532d 3834 2e0d 0a20 2020   to WGS-84...   
+00002a80: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00002a90: 2020 6966 2075 746d 5f7a 6f6e 6520 6973    if utm_zone is
+00002aa0: 206e 6f74 204e 6f6e 6520 3a20 7365 6c66   not None : self
+00002ab0: 2e5f 7574 6d5f 7a6f 6e65 203d 7574 6d5f  ._utm_zone =utm_
+00002ac0: 7a6f 6e65 200d 0a20 2020 2020 2020 2069  zone ..        i
+00002ad0: 6620 7365 6c66 2e5f 7574 6d5f 7a6f 6e65  f self._utm_zone
+00002ae0: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
+00002af0: 2020 2020 2020 2020 7261 6973 6520 4c6f          raise Lo
+00002b00: 6361 7469 6f6e 4572 726f 7228 0d0a 2020  cationError(..  
+00002b10: 2020 2020 2020 2020 2020 2020 2020 2754                'T
+00002b20: 7279 2074 6f20 696e 7075 7420 7468 6520  ry to input the 
+00002b30: 7574 6d5f 7a6f 6e65 203a 2065 2e67 2e3a  utm_zone : e.g.:
+00002b40: 2034 394e 2729 0d0a 2020 2020 2020 2020   49N')..        
+00002b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ba0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00002bb0: 2020 5f64 6174 615f 696e 666f 5f6c 6c20    _data_info_ll 
-00002bc0: 3d20 6769 732e 7574 6d5f 746f 5f6c 6c28  = gis.utm_to_ll(
-00002bd0: 7265 6665 7265 6e63 655f 656c 6c69 7073  reference_ellips
-00002be0: 6f69 643d 3233 2c0d 0a20 2020 2020 2020  oid=23,..       
-00002bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c00: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00002c10: 6f72 7468 696e 673d 2073 656c 662e 6e6f  orthing= self.no
-00002c20: 7274 6869 6e67 2c20 0d0a 2020 2020 2020  rthing, ..      
-00002c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c50: 6561 7374 696e 673d 7365 6c66 2e65 6173  easting=self.eas
-00002c60: 7469 6e67 2c20 0d0a 2020 2020 2020 2020  ting, ..        
-00002c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c80: 2020 2020 2020 2020 2020 2020 2020 7a6f                zo
-00002c90: 6e65 203d 7365 6c66 2e5f 7574 6d5f 7a6f  ne =self._utm_zo
-00002ca0: 6e65 2029 0d0a 2020 2020 2020 2020 0d0a  ne )..        ..
-00002cb0: 2020 2020 2020 2020 7365 6c66 2e6c 6174          self.lat
-00002cc0: 6974 7564 653d 205f 6461 7461 5f69 6e66  itude= _data_inf
-00002cd0: 6f5f 6c6c 5b30 5d0d 0a20 2020 2020 2020  o_ll[0]..       
-00002ce0: 2073 656c 662e 6c6f 6e67 6974 7564 6520   self.longitude 
-00002cf0: 3d20 5f64 6174 615f 696e 666f 5f6c 6c5b  = _data_info_ll[
-00002d00: 315d 0d0a 2020 2020 2020 2020 0d0a 2020  1]..        ..  
-00002d10: 2020 6465 6620 6765 745f 6561 7374 6e6f    def get_eastno
-00002d20: 7274 685f 6172 7261 795f 6672 6f6d 5f6c  rth_array_from_l
-00002d30: 6174 6c6f 6e28 7365 6c66 2c61 7272 5f6c  atlon(self,arr_l
-00002d40: 6174 202c 2061 7272 5f6c 6f6e 293a 0d0a  at , arr_lon):..
-00002d50: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00002d60: 2020 2020 204d 6574 686f 6420 746f 2071       Method to q
-00002d70: 7569 636c 7920 636f 6e76 6572 7420 6172  uicly convert ar
-00002d80: 7261 7920 6f66 206c 6174 6974 7564 6520  ray of latitude 
-00002d90: 616e 6420 0d0a 2020 2020 2020 2020 6e6f  and ..        no
-00002da0: 7274 6869 6e67 2069 6e74 6f20 6561 7374  rthing into east
-00002db0: 696e 6720 6e6f 7274 6869 6e67 0d0a 2020  ing northing..  
-00002dc0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00002dd0: 3a70 6172 616d 2061 7272 5f6c 6174 3a20  :param arr_lat: 
-00002de0: 6172 7261 7920 6f66 206c 6174 6974 7564  array of latitud
-00002df0: 6520 7661 6c75 6520 0d0a 2020 2020 2020  e value ..      
-00002e00: 2020 3a74 7970 6520 6172 725f 6c61 743a    :type arr_lat:
-00002e10: 2061 7272 6179 5f6c 696b 6520 0d0a 2020   array_like ..  
-00002e20: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00002e30: 3a70 6172 616d 2061 7272 6179 5f6c 6f6e  :param array_lon
-00002e40: 3a20 6172 7261 7920 6f66 206c 6f6e 6769  : array of longi
-00002e50: 7475 6465 2076 616c 7565 2e20 0d0a 2020  tude value. ..  
-00002e60: 2020 2020 2020 3a74 7970 6520 6172 7261        :type arra
-00002e70: 795f 6c6f 6e3a 2061 7272 6179 5f6c 696b  y_lon: array_lik
-00002e80: 6520 0d0a 2020 2020 2020 2020 0d0a 2020  e ..        ..  
-00002e90: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-00002ea0: 6561 7374 696e 6720 6172 7261 790d 0a20  easting array.. 
-00002eb0: 2020 2020 2020 203a 7274 7970 6520 3a20         :rtype : 
-00002ec0: 6172 7261 795f 6c69 6b65 200d 0a20 2020  array_like ..   
-00002ed0: 2020 2020 200d 0a20 2020 2020 2020 203a       ..        :
-00002ee0: 7265 7475 726e 733a 206e 6f72 7468 696e  returns: northin
-00002ef0: 6720 6172 7261 790d 0a20 2020 2020 2020  g array..       
-00002f00: 203a 7274 7970 653a 2020 6172 7261 795f   :rtype:  array_
-00002f10: 6c69 6b65 200d 0a20 2020 2020 2020 2022  like ..        "
-00002f20: 2222 0d0a 2020 2020 2020 2020 6172 7261  ""..        arra
-00002f30: 795f 6561 7374 696e 6720 2c20 6172 7261  y_easting , arra
-00002f40: 795f 6e6f 7274 6869 6e67 203d 5b5b 5d20  y_northing =[[] 
-00002f50: 666f 7220 6969 2069 6e20 7261 6e67 6528  for ii in range(
-00002f60: 3229 5d0d 0a20 2020 2020 2020 2066 6f72  2)]..        for
-00002f70: 2069 6920 696e 2072 616e 6765 2861 7272   ii in range(arr
-00002f80: 5f6c 6174 2e73 697a 6529 3a0d 0a20 2020  _lat.size):..   
-00002f90: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-00002fa0: 6e76 6572 745f 6c6f 6361 7469 6f6e 5f32  nvert_location_2
-00002fb0: 5f75 746d 286c 6174 6974 7564 6520 3d61  _utm(latitude =a
-00002fc0: 7272 5f6c 6174 5b69 695d 2c0d 0a20 2020  rr_lat[ii],..   
-00002fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ff0: 2020 2020 206c 6f6e 6769 7475 6465 3d61       longitude=a
-00003000: 7272 5f6c 6f6e 5b69 695d 290d 0a20 2020  rr_lon[ii])..   
-00003010: 2020 2020 2020 2020 2061 7272 6179 5f65           array_e
-00003020: 6173 7469 6e67 2e61 7070 656e 6428 7365  asting.append(se
-00003030: 6c66 2e65 6173 7469 6e67 290d 0a20 2020  lf.easting)..   
-00003040: 2020 2020 2020 2020 2061 7272 6179 5f6e           array_n
-00003050: 6f72 7468 696e 672e 6170 7065 6e64 2873  orthing.append(s
-00003060: 656c 662e 6e6f 7274 6869 6e67 290d 0a20  elf.northing).. 
-00003070: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00003080: 2072 6574 7572 6e20 6e70 2e61 7272 6179   return np.array
-00003090: 2861 7272 6179 5f65 6173 7469 6e67 292c  (array_easting),
-000030a0: 206e 702e 6172 7261 7928 6172 7261 795f   np.array(array_
-000030b0: 6e6f 7274 6869 6e67 290d 0a23 3d3d 3d3d  northing)..#====
+00002b80: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00002b90: 2020 2020 2020 205f 6461 7461 5f69 6e66         _data_inf
+00002ba0: 6f5f 6c6c 203d 2067 6973 2e75 746d 5f74  o_ll = gis.utm_t
+00002bb0: 6f5f 6c6c 2872 6566 6572 656e 6365 5f65  o_ll(reference_e
+00002bc0: 6c6c 6970 736f 6964 3d32 332c 0d0a 2020  llipsoid=23,..  
+00002bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002bf0: 2020 2020 6e6f 7274 6869 6e67 3d20 7365      northing= se
+00002c00: 6c66 2e6e 6f72 7468 696e 672c 200d 0a20  lf.northing, .. 
+00002c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c30: 2020 2020 2065 6173 7469 6e67 3d73 656c       easting=sel
+00002c40: 662e 6561 7374 696e 672c 200d 0a20 2020  f.easting, ..   
+00002c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c70: 2020 207a 6f6e 6520 3d73 656c 662e 5f75     zone =self._u
+00002c80: 746d 5f7a 6f6e 6520 290d 0a20 2020 2020  tm_zone )..     
+00002c90: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
+00002ca0: 662e 6c61 7469 7475 6465 3d20 5f64 6174  f.latitude= _dat
+00002cb0: 615f 696e 666f 5f6c 6c5b 305d 0d0a 2020  a_info_ll[0]..  
+00002cc0: 2020 2020 2020 7365 6c66 2e6c 6f6e 6769        self.longi
+00002cd0: 7475 6465 203d 205f 6461 7461 5f69 6e66  tude = _data_inf
+00002ce0: 6f5f 6c6c 5b31 5d0d 0a20 2020 2020 2020  o_ll[1]..       
+00002cf0: 200d 0a20 2020 2064 6566 2067 6574 5f65   ..    def get_e
+00002d00: 6173 746e 6f72 7468 5f61 7272 6179 5f66  astnorth_array_f
+00002d10: 726f 6d5f 6c61 746c 6f6e 2873 656c 662c  rom_latlon(self,
+00002d20: 6172 725f 6c61 7420 2c20 6172 725f 6c6f  arr_lat , arr_lo
+00002d30: 6e29 3a0d 0a20 2020 2020 2020 2022 2222  n):..        """
+00002d40: 0d0a 2020 2020 2020 2020 4d65 7468 6f64  ..        Method
+00002d50: 2074 6f20 7175 6963 6c79 2063 6f6e 7665   to quicly conve
+00002d60: 7274 2061 7272 6179 206f 6620 6c61 7469  rt array of lati
+00002d70: 7475 6465 2061 6e64 200d 0a20 2020 2020  tude and ..     
+00002d80: 2020 206e 6f72 7468 696e 6720 696e 746f     northing into
+00002d90: 2065 6173 7469 6e67 206e 6f72 7468 696e   easting northin
+00002da0: 670d 0a20 2020 2020 2020 200d 0a20 2020  g..        ..   
+00002db0: 2020 2020 203a 7061 7261 6d20 6172 725f       :param arr_
+00002dc0: 6c61 743a 2061 7272 6179 206f 6620 6c61  lat: array of la
+00002dd0: 7469 7475 6465 2076 616c 7565 200d 0a20  titude value .. 
+00002de0: 2020 2020 2020 203a 7479 7065 2061 7272         :type arr
+00002df0: 5f6c 6174 3a20 6172 7261 795f 6c69 6b65  _lat: array_like
+00002e00: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00002e10: 2020 2020 203a 7061 7261 6d20 6172 7261       :param arra
+00002e20: 795f 6c6f 6e3a 2061 7272 6179 206f 6620  y_lon: array of 
+00002e30: 6c6f 6e67 6974 7564 6520 7661 6c75 652e  longitude value.
+00002e40: 200d 0a20 2020 2020 2020 203a 7479 7065   ..        :type
+00002e50: 2061 7272 6179 5f6c 6f6e 3a20 6172 7261   array_lon: arra
+00002e60: 795f 6c69 6b65 200d 0a20 2020 2020 2020  y_like ..       
+00002e70: 200d 0a20 2020 2020 2020 203a 7265 7475   ..        :retu
+00002e80: 726e 733a 2065 6173 7469 6e67 2061 7272  rns: easting arr
+00002e90: 6179 0d0a 2020 2020 2020 2020 3a72 7479  ay..        :rty
+00002ea0: 7065 203a 2061 7272 6179 5f6c 696b 6520  pe : array_like 
+00002eb0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00002ec0: 2020 2020 3a72 6574 7572 6e73 3a20 6e6f      :returns: no
+00002ed0: 7274 6869 6e67 2061 7272 6179 0d0a 2020  rthing array..  
+00002ee0: 2020 2020 2020 3a72 7479 7065 3a20 2061        :rtype:  a
+00002ef0: 7272 6179 5f6c 696b 6520 0d0a 2020 2020  rray_like ..    
+00002f00: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00002f10: 2061 7272 6179 5f65 6173 7469 6e67 202c   array_easting ,
+00002f20: 2061 7272 6179 5f6e 6f72 7468 696e 6720   array_northing 
+00002f30: 3d5b 5b5d 2066 6f72 2069 6920 696e 2072  =[[] for ii in r
+00002f40: 616e 6765 2832 295d 0d0a 2020 2020 2020  ange(2)]..      
+00002f50: 2020 666f 7220 6969 2069 6e20 7261 6e67    for ii in rang
+00002f60: 6528 6172 725f 6c61 742e 7369 7a65 293a  e(arr_lat.size):
+00002f70: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00002f80: 6c66 2e63 6f6e 7665 7274 5f6c 6f63 6174  lf.convert_locat
+00002f90: 696f 6e5f 325f 7574 6d28 6c61 7469 7475  ion_2_utm(latitu
+00002fa0: 6465 203d 6172 725f 6c61 745b 6969 5d2c  de =arr_lat[ii],
+00002fb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002fd0: 2020 2020 2020 2020 2020 6c6f 6e67 6974            longit
+00002fe0: 7564 653d 6172 725f 6c6f 6e5b 6969 5d29  ude=arr_lon[ii])
+00002ff0: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+00003000: 7261 795f 6561 7374 696e 672e 6170 7065  ray_easting.appe
+00003010: 6e64 2873 656c 662e 6561 7374 696e 6729  nd(self.easting)
+00003020: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+00003030: 7261 795f 6e6f 7274 6869 6e67 2e61 7070  ray_northing.app
+00003040: 656e 6428 7365 6c66 2e6e 6f72 7468 696e  end(self.northin
+00003050: 6729 0d0a 2020 2020 2020 2020 0d0a 2020  g)..        ..  
+00003060: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
+00003070: 6172 7261 7928 6172 7261 795f 6561 7374  array(array_east
+00003080: 696e 6729 2c20 6e70 2e61 7272 6179 2861  ing), np.array(a
+00003090: 7272 6179 5f6e 6f72 7468 696e 6729 0d0a  rray_northing)..
+000030a0: 233d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  #===============
+000030b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 000030c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 000030d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 000030e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000030f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00003100: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a23  =============..#
-00003110: 2053 4954 4520 434c 4153 5320 0d0a 233d   SITE CLASS ..#=
+000030f0: 3d3d 0d0a 2320 5349 5445 2043 4c41 5353  ==..# SITE CLASS
+00003100: 200d 0a23 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ..#============
+00003110: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00003120: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00003130: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00003140: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00003150: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00003160: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00003170: 0d0a 636c 6173 7320 5369 7465 286f 626a  ..class Site(obj
-00003180: 6563 7429 3a20 0d0a 2020 2020 2222 220d  ect): ..    """.
-00003190: 0a20 2020 2053 7065 6369 6669 6320 7369  .    Specific si
-000031a0: 7465 206f 626a 6563 7420 4561 7379 2070  te object Easy p
-000031b0: 6163 6b20 6461 7461 203a 6c61 742c 206c  ack data :lat, l
-000031c0: 6f6e 2c20 656c 6576 2c20 617a 696d 2c0d  on, elev, azim,.
-000031d0: 0a20 2020 2065 6173 742c 206e 6f72 7468  .    east, north
-000031e0: 2c20 696e 746f 2064 6963 7469 6f6e 6e61  , into dictionna
-000031f0: 7279 2066 6f72 2065 6173 7920 6163 6365  ry for easy acce
-00003200: 7373 202e 0d0a 2020 2020 2020 2020 0d0a  ss ...        ..
-00003210: 2020 2020 4172 6775 6d65 6e74 7320 0d0a      Arguments ..
-00003220: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d 0a20      ---------.. 
-00003230: 2020 2020 2020 202a 2a64 6174 615f 666e         **data_fn
-00003240: 2a2a 203a 7374 7220 0d0a 2020 2020 2020  ** :str ..      
-00003250: 2020 2020 2020 2020 2020 2070 6174 6820             path 
-00003260: 746f 2073 6974 6520 6669 6c65 202c 2074  to site file , t
-00003270: 6865 2073 616d 6520 6669 6c65 2061 7320  he same file as 
-00003280: 7072 6f66 696c 6520 0d0a 2020 2020 2020  profile ..      
-00003290: 2020 2020 2020 2020 2020 206f 7220 582c             or X,
-000032a0: 5920 636f 6f72 6469 6e61 7465 7320 7661  Y coordinates va
-000032b0: 6c75 6573 200d 0a20 2020 203a 4578 616d  lues ..    :Exam
-000032c0: 706c 653a 200d 0a20 2020 2020 2020 200d  ple: ..        .
-000032d0: 0a20 2020 2020 2020 203e 3e3e 2020 6672  .        >>>  fr
-000032e0: 6f6d 2070 7963 7361 6d74 2e66 662e 7369  om pycsamt.ff.si
-000032f0: 7465 2069 6d70 6f72 7420 5369 7465 200d  te import Site .
-00003300: 0a20 2020 2020 2020 203e 3e3e 2020 7369  .        >>>  si
-00003310: 7465 3d53 6974 6528 6461 7461 5f66 6e3d  te=Site(data_fn=
-00003320: 7061 7468 290d 0a20 2020 2020 2020 203e  path)..        >
-00003330: 3e3e 2020 7072 696e 7428 7369 7465 2e65  >>  print(site.e
-00003340: 6173 745b 2753 3037 275d 290d 0a20 2020  ast['S07'])..   
-00003350: 2020 2020 203e 3e3e 2020 7072 696e 7428       >>>  print(
-00003360: 7369 7465 2e6e 6f72 7468 5b27 5330 3927  site.north['S09'
-00003370: 5d29 0d0a 2020 2020 2222 220d 0a20 2020  ])..    """..   
-00003380: 200d 0a20 2020 2064 6566 205f 5f69 6e69   ..    def __ini
-00003390: 745f 5f28 7365 6c66 2c20 6461 7461 5f66  t__(self, data_f
-000033a0: 6e20 3d4e 6f6e 6520 2c20 2a2a 6b77 6172  n =None , **kwar
-000033b0: 6773 293a 0d0a 2020 2020 2020 2020 0d0a  gs):..        ..
-000033c0: 2020 2020 2020 2020 7365 6c66 2e73 6974          self.sit
-000033d0: 6564 6174 6120 3d64 6174 615f 666e 0d0a  edata =data_fn..
-000033e0: 2020 2020 2020 2020 7365 6c66 2e4c 6f63          self.Loc
-000033f0: 6174 696f 6e3d 4c6f 6361 7469 6f6e 2829  ation=Location()
-00003400: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00003410: 6c61 7420 3d4e 6f6e 650d 0a20 2020 2020  lat =None..     
-00003420: 2020 2073 656c 662e 5f6c 6f6e 203d 4e6f     self._lon =No
+00003150: 3d3d 3d3d 3d0d 0a63 6c61 7373 2053 6974  =====..class Sit
+00003160: 6528 6f62 6a65 6374 293a 200d 0a20 2020  e(object): ..   
+00003170: 2022 2222 0d0a 2020 2020 5370 6563 6966   """..    Specif
+00003180: 6963 2073 6974 6520 6f62 6a65 6374 2045  ic site object E
+00003190: 6173 7920 7061 636b 2064 6174 6120 3a6c  asy pack data :l
+000031a0: 6174 2c20 6c6f 6e2c 2065 6c65 762c 2061  at, lon, elev, a
+000031b0: 7a69 6d2c 0d0a 2020 2020 6561 7374 2c20  zim,..    east, 
+000031c0: 6e6f 7274 682c 2069 6e74 6f20 6469 6374  north, into dict
+000031d0: 696f 6e6e 6172 7920 666f 7220 6561 7379  ionnary for easy
+000031e0: 2061 6363 6573 7320 2e0d 0a20 2020 2020   access ...     
+000031f0: 2020 200d 0a20 2020 2041 7267 756d 656e     ..    Argumen
+00003200: 7473 200d 0a20 2020 202d 2d2d 2d2d 2d2d  ts ..    -------
+00003210: 2d2d 0d0a 2020 2020 2020 2020 2a2a 6461  --..        **da
+00003220: 7461 5f66 6e2a 2a20 3a73 7472 200d 0a20  ta_fn** :str .. 
+00003230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003240: 7061 7468 2074 6f20 7369 7465 2066 696c  path to site fil
+00003250: 6520 2c20 7468 6520 7361 6d65 2066 696c  e , the same fil
+00003260: 6520 6173 2070 726f 6669 6c65 200d 0a20  e as profile .. 
+00003270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003280: 6f72 2058 2c59 2063 6f6f 7264 696e 6174  or X,Y coordinat
+00003290: 6573 2076 616c 7565 7320 0d0a 2020 2020  es values ..    
+000032a0: 3a45 7861 6d70 6c65 3a20 0d0a 2020 2020  :Example: ..    
+000032b0: 2020 2020 0d0a 2020 2020 2020 2020 3e3e      ..        >>
+000032c0: 3e20 2066 726f 6d20 7079 6373 616d 742e  >  from pycsamt.
+000032d0: 6666 2e73 6974 6520 696d 706f 7274 2053  ff.site import S
+000032e0: 6974 6520 0d0a 2020 2020 2020 2020 3e3e  ite ..        >>
+000032f0: 3e20 2073 6974 653d 5369 7465 2864 6174  >  site=Site(dat
+00003300: 615f 666e 3d70 6174 6829 0d0a 2020 2020  a_fn=path)..    
+00003310: 2020 2020 3e3e 3e20 2070 7269 6e74 2873      >>>  print(s
+00003320: 6974 652e 6561 7374 5b27 5330 3727 5d29  ite.east['S07'])
+00003330: 0d0a 2020 2020 2020 2020 3e3e 3e20 2070  ..        >>>  p
+00003340: 7269 6e74 2873 6974 652e 6e6f 7274 685b  rint(site.north[
+00003350: 2753 3039 275d 290d 0a20 2020 2022 2222  'S09'])..    """
+00003360: 0d0a 2020 2020 0d0a 2020 2020 6465 6620  ..    ..    def 
+00003370: 5f5f 696e 6974 5f5f 2873 656c 662c 2064  __init__(self, d
+00003380: 6174 615f 666e 203d 4e6f 6e65 202c 202a  ata_fn =None , *
+00003390: 2a6b 7761 7267 7329 3a0d 0a20 2020 2020  *kwargs):..     
+000033a0: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
+000033b0: 662e 7369 7465 6461 7461 203d 6461 7461  f.sitedata =data
+000033c0: 5f66 6e0d 0a20 2020 2020 2020 2073 656c  _fn..        sel
+000033d0: 662e 4c6f 6361 7469 6f6e 3d4c 6f63 6174  f.Location=Locat
+000033e0: 696f 6e28 290d 0a20 2020 2020 2020 2073  ion()..        s
+000033f0: 656c 662e 5f6c 6174 203d 4e6f 6e65 0d0a  elf._lat =None..
+00003400: 2020 2020 2020 2020 7365 6c66 2e5f 6c6f          self._lo
+00003410: 6e20 3d4e 6f6e 6520 0d0a 2020 2020 2020  n =None ..      
+00003420: 2020 7365 6c66 2e5f 6561 7374 3d20 4e6f    self._east= No
 00003430: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
-00003440: 662e 5f65 6173 743d 204e 6f6e 6520 0d0a  f._east= None ..
-00003450: 2020 2020 2020 2020 7365 6c66 2e5f 6e6f          self._no
-00003460: 7274 6820 3d4e 6f6e 6520 0d0a 2020 2020  rth =None ..    
-00003470: 2020 2020 7365 6c66 2e5f 617a 696d 203d      self._azim =
-00003480: 204e 6f6e 6520 0d0a 2020 2020 2020 2020   None ..        
-00003490: 7365 6c66 2e5f 656c 6576 203d 4e6f 6e65  self._elev =None
-000034a0: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-000034b0: 5f6c 656e 5f73 746e 3d4e 6f6e 6520 0d0a  _len_stn=None ..
-000034c0: 2020 2020 2020 2020 7365 6c66 2e5f 7374          self._st
-000034d0: 6e5f 6e61 6d65 3d4e 6f6e 6520 0d0a 2020  n_name=None ..  
-000034e0: 2020 2020 2020 7365 6c66 2e75 746d 5f7a        self.utm_z
-000034f0: 6f6e 6520 3d6b 7761 7267 732e 706f 7028  one =kwargs.pop(
-00003500: 2775 746d 5f7a 6f6e 6527 2c20 2734 394e  'utm_zone', '49N
-00003510: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
-00003520: 2020 2020 2020 666f 7220 6b65 7973 2069        for keys i
-00003530: 6e20 6c69 7374 286b 7761 7267 732e 6b65  n list(kwargs.ke
-00003540: 7973 2829 293a 0d0a 2020 2020 2020 2020  ys()):..        
-00003550: 2020 2020 7365 7461 7474 7228 7365 6c66      setattr(self
-00003560: 2c20 6b65 7973 2c20 6b77 6172 6773 5b6b  , keys, kwargs[k
-00003570: 6579 735d 290d 0a20 2020 2020 2020 2020  eys])..         
-00003580: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-00003590: 7365 6c66 2e73 6974 6564 6174 6120 6973  self.sitedata is
-000035a0: 206e 6f74 204e 6f6e 6520 3a20 0d0a 2020   not None : ..  
-000035b0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-000035c0: 6574 5f73 6974 655f 696e 666f 2829 0d0a  et_site_info()..
-000035d0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000035e0: 2020 4070 726f 7065 7274 7920 0d0a 2020    @property ..  
-000035f0: 2020 6465 6620 7374 6e5f 6e61 6d65 2873    def stn_name(s
-00003600: 656c 6629 3a20 0d0a 2020 2020 2020 2020  elf): ..        
-00003610: 7265 7475 726e 2073 656c 662e 5f73 746e  return self._stn
-00003620: 5f6e 616d 6520 0d0a 2020 2020 4073 746e  _name ..    @stn
-00003630: 5f6e 616d 652e 7365 7474 6572 200d 0a20  _name.setter .. 
-00003640: 2020 2064 6566 2073 746e 5f6e 616d 6520     def stn_name 
-00003650: 2873 656c 662c 206e 616d 6573 5f6f 725f  (self, names_or_
-00003660: 6e75 6d62 4f66 5374 6174 696f 6e73 2029  numbOfStations )
-00003670: 3a20 0d0a 2020 2020 2020 2020 0d0a 2020  : ..        ..  
-00003680: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00003690: 6e63 6528 6e61 6d65 735f 6f72 5f6e 756d  nce(names_or_num
-000036a0: 624f 6653 7461 7469 6f6e 732c 2069 6e74  bOfStations, int
-000036b0: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
-000036c0: 2073 656c 662e 5f73 746e 5f6e 616d 6520   self._stn_name 
-000036d0: 3d20 5b27 537b 303a 3032 7d27 2e66 6f72  = ['S{0:02}'.for
-000036e0: 6d61 7428 6969 2920 0d0a 2020 2020 2020  mat(ii) ..      
-000036f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003700: 2020 2020 2020 2020 666f 7220 6969 2069          for ii i
-00003710: 6e20 7261 6e67 6528 6e61 6d65 735f 6f72  n range(names_or
-00003720: 5f6e 756d 624f 6653 7461 7469 6f6e 7329  _numbOfStations)
-00003730: 5d0d 0a20 2020 2020 2020 2065 6c73 6520  ]..        else 
-00003740: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00003750: 6620 6973 696e 7374 616e 6365 286e 616d  f isinstance(nam
-00003760: 6573 5f6f 725f 6e75 6d62 4f66 5374 6174  es_or_numbOfStat
-00003770: 696f 6e73 2c20 6e70 2e6e 6461 7272 6179  ions, np.ndarray
-00003780: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00003790: 2020 2020 7365 6c66 2e5f 7374 6e5f 6e61      self._stn_na
-000037a0: 6d65 203d 206e 616d 6573 5f6f 725f 6e75  me = names_or_nu
-000037b0: 6d62 4f66 5374 6174 696f 6e73 2e74 6f6c  mbOfStations.tol
-000037c0: 6973 7428 290d 0a20 2020 2020 2020 2020  ist()..         
-000037d0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-000037e0: 6365 286e 616d 6573 5f6f 725f 6e75 6d62  ce(names_or_numb
-000037f0: 4f66 5374 6174 696f 6e73 2c20 6c69 7374  OfStations, list
-00003800: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
-00003810: 2020 2020 2073 656c 662e 5f73 746e 5f6e       self._stn_n
-00003820: 616d 6520 3d6e 616d 6573 5f6f 725f 6e75  ame =names_or_nu
-00003830: 6d62 4f66 5374 6174 696f 6e73 0d0a 2020  mbOfStations..  
-00003840: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00003850: 4070 726f 7065 7274 7920 0d0a 2020 2020  @property ..    
-00003860: 6465 6620 6c61 7428 7365 6c66 293a 200d  def lat(self): .
-00003870: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003880: 7365 6c66 2e5f 6c61 7420 0d0a 2020 2020  self._lat ..    
-00003890: 406c 6174 2e73 6574 7465 7220 0d0a 2020  @lat.setter ..  
-000038a0: 2020 6465 6620 6c61 7420 2873 656c 662c    def lat (self,
-000038b0: 206c 6174 6974 7564 6529 3a0d 0a20 2020   latitude):..   
-000038c0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-000038d0: 6620 6973 696e 7374 616e 6365 286c 6174  f isinstance(lat
-000038e0: 6974 7564 652c 206c 6973 7429 203a 6c61  itude, list) :la
-000038f0: 7469 7475 6465 203d 6e70 2e61 7272 6179  titude =np.array
-00003900: 286c 6174 6974 7564 6529 0d0a 2020 2020  (latitude)..    
-00003910: 2020 2020 6966 2073 656c 662e 7374 6e5f      if self.stn_
-00003920: 6e61 6d65 2069 7320 4e6f 6e65 203a 200d  name is None : .
-00003930: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00003940: 662e 7374 6e5f 6e61 6d65 203d 206c 6174  f.stn_name = lat
-00003950: 6974 7564 652e 7369 7a65 0d0a 2020 2020  itude.size..    
-00003960: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00003970: 2e77 6172 6e28 0d0a 2020 2020 2020 2020  .warn(..        
-00003980: 2020 2020 2020 2020 2242 7920 6465 6661          "By defa
-00003990: 756c 742c 2074 6865 2073 7461 7469 6f6e  ult, the station
-000039a0: 206e 616d 6573 2073 686f 756c 6420 6265   names should be
-000039b0: 2064 6566 696e 6564 2075 7369 6e67 2022   defined using "
-000039c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000039d0: 2020 2220 7468 6520 7072 6566 6978 202d    " the prefix -
-000039e0: 532e 2065 2e67 2e3c 7b30 7d20 2d2d 2d3e  S. e.g.<{0} --->
-000039f0: 207b 317d 3e22 2e66 6f72 6d61 7428 0d0a   {1}>".format(..
-00003a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003a10: 7365 6c66 2e73 746e 5f6e 616d 655b 305d  self.stn_name[0]
-00003a20: 2c20 7365 6c66 2e73 746e 5f6e 616d 655b  , self.stn_name[
-00003a30: 2d31 5d29 290d 0a20 2020 2020 2020 2020  -1]))..         
-00003a40: 2020 200d 0a20 2020 2020 2020 2065 6c69     ..        eli
-00003a50: 6620 7365 6c66 2e73 746e 5f6e 616d 6520  f self.stn_name 
-00003a60: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
-00003a70: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00003a80: 7274 206c 656e 2873 656c 662e 7374 6e5f  rt len(self.stn_
-00003a90: 6e61 6d65 293d 3d20 6c61 7469 7475 6465  name)== latitude
-00003aa0: 2e73 697a 652c 205c 0d0a 2020 2020 2020  .size, \..      
-00003ab0: 2020 2020 2020 2020 2020 4353 6578 2e70            CSex.p
-00003ac0: 7943 5341 4d54 4572 726f 725f 7369 7465  yCSAMTError_site
-00003ad0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00003ae0: 2020 2027 5374 6174 696f 6e20 6e61 6d65     'Station name
-00003af0: 7320 616e 6420 6c61 7469 7475 6465 2064  s and latitude d
-00003b00: 6174 6120 6d75 7374 2068 6176 6520 7468  ata must have th
-00003b10: 6520 7361 6d65 2073 697a 652e 270d 0a20  e same size.'.. 
-00003b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b30: 2720 4275 7420 7468 6520 6769 7665 6e20  ' But the given 
-00003b40: 6c61 7469 7475 6465 2073 697a 6520 6973  latitude size is
-00003b50: 203c 7b30 7d3e 272e 666f 726d 6174 286c   <{0}>'.format(l
-00003b60: 6174 6974 7564 652e 7369 7a65 2929 0d0a  atitude.size))..
-00003b70: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00003b80: 6c61 7420 3d7b 7374 6e3a 6c61 7420 666f  lat ={stn:lat fo
-00003b90: 7220 7374 6e2c 206c 6174 2069 6e20 7a69  r stn, lat in zi
-00003ba0: 7020 2873 656c 662e 7374 6e5f 6e61 6d65  p (self.stn_name
-00003bb0: 2c20 6c61 7469 7475 6465 297d 0d0a 2020  , latitude)}..  
-00003bc0: 2020 0d0a 2020 2020 4070 726f 7065 7274    ..    @propert
-00003bd0: 7920 0d0a 2020 2020 6465 6620 6c6f 6e28  y ..    def lon(
-00003be0: 7365 6c66 293a 200d 0a20 2020 2020 2020  self): ..       
-00003bf0: 2072 6574 7572 6e20 7365 6c66 2e5f 6c6f   return self._lo
-00003c00: 6e0d 0a20 2020 2040 6c6f 6e2e 7365 7474  n..    @lon.sett
-00003c10: 6572 200d 0a20 2020 2064 6566 206c 6f6e  er ..    def lon
-00003c20: 2873 656c 662c 206c 6f6e 6769 7475 6465  (self, longitude
-00003c30: 293a 200d 0a20 2020 2020 2020 2069 6620  ): ..        if 
-00003c40: 7365 6c66 2e73 746e 5f6e 616d 6520 6973  self.stn_name is
-00003c50: 204e 6f6e 6520 3a20 7365 6c66 2e73 746e   None : self.stn
-00003c60: 5f6e 616d 6520 3d20 6c6f 6e67 6974 7564  _name = longitud
-00003c70: 652e 7369 7a65 0d0a 2020 2020 2020 2020  e.size..        
-00003c80: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00003c90: 6528 6c6f 6e67 6974 7564 652c 6e70 2e6e  e(longitude,np.n
-00003ca0: 6461 7272 6179 293a 206c 6f6e 6769 7475  darray): longitu
-00003cb0: 6465 203d 6e70 2e61 7272 6179 286c 6f6e  de =np.array(lon
-00003cc0: 6769 7475 6465 290d 0a20 2020 2020 2020  gitude)..       
-00003cd0: 2069 6620 6c65 6e28 7365 6c66 2e73 746e   if len(self.stn
-00003ce0: 5f6e 616d 6529 2021 3d20 6c6f 6e67 6974  _name) != longit
-00003cf0: 7564 652e 7369 7a65 203a 0d0a 2020 2020  ude.size :..    
-00003d00: 2020 2020 2020 2020 7261 6973 6520 4353          raise CS
-00003d10: 6578 2e70 7943 5341 4d54 4572 726f 725f  ex.pyCSAMTError_
-00003d20: 7369 7465 280d 0a20 2020 2020 2020 2020  site(..         
-00003d30: 2020 2020 2020 2027 5374 6174 696f 6e5f         'Station_
-00003d40: 6e61 6d65 737c 6c6f 6e67 6974 7564 6520  names|longitude 
-00003d50: 6d75 7374 270d 0a20 2020 2020 2020 2020  must'..         
-00003d60: 2020 2020 2020 2020 2720 6861 7665 2074          ' have t
-00003d70: 6865 2073 616d 6520 7369 7a65 2e4c 6f6e  he same size.Lon
-00003d80: 6769 7475 6465 2073 697a 6520 6973 203c  gitude size is <
-00003d90: 7b30 7d3e 272e 0d0a 2020 2020 2020 2020  {0}>'...        
-00003da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003db0: 2020 666f 726d 6174 286c 6f6e 6769 7475    format(longitu
-00003dc0: 6465 2e73 697a 6529 290d 0a20 2020 2020  de.size))..     
-00003dd0: 2020 2073 656c 662e 5f6c 6f6e 203d 7b73     self._lon ={s
-00003de0: 746e 3a6c 6f6e 2066 6f72 2073 746e 2c20  tn:lon for stn, 
-00003df0: 6c6f 6e20 696e 207a 6970 2028 7365 6c66  lon in zip (self
-00003e00: 2e73 746e 5f6e 616d 652c 206c 6f6e 6769  .stn_name, longi
-00003e10: 7475 6465 297d 0d0a 2020 2020 2020 2020  tude)}..        
-00003e20: 0d0a 2020 2020 4070 726f 7065 7274 7920  ..    @property 
-00003e30: 0d0a 2020 2020 6465 6620 656c 6576 2873  ..    def elev(s
-00003e40: 656c 6629 3a20 0d0a 2020 2020 2020 2020  elf): ..        
-00003e50: 7265 7475 726e 2073 656c 662e 5f65 6c65  return self._ele
-00003e60: 760d 0a20 2020 2040 656c 6576 2e73 6574  v..    @elev.set
-00003e70: 7465 7220 0d0a 2020 2020 6465 6620 656c  ter ..    def el
-00003e80: 6576 2873 656c 662c 2065 6c65 7661 7469  ev(self, elevati
-00003e90: 6f6e 293a 200d 0a20 2020 2020 2020 2069  on): ..        i
-00003ea0: 6620 7365 6c66 2e73 746e 5f6e 616d 6520  f self.stn_name 
-00003eb0: 6973 204e 6f6e 6520 3a20 7365 6c66 2e73  is None : self.s
-00003ec0: 746e 5f6e 616d 6520 3d20 656c 6576 6174  tn_name = elevat
-00003ed0: 696f 6e2e 7369 7a65 0d0a 2020 2020 2020  ion.size..      
-00003ee0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00003ef0: 6e63 6528 656c 6576 6174 696f 6e2c 6e70  nce(elevation,np
-00003f00: 2e6e 6461 7272 6179 293a 0d0a 2020 2020  .ndarray):..    
-00003f10: 2020 2020 2020 2020 656c 6576 6174 696f          elevatio
-00003f20: 6e20 3d6e 702e 6172 7261 7928 656c 6576  n =np.array(elev
-00003f30: 6174 696f 6e29 0d0a 2020 2020 2020 2020  ation)..        
-00003f40: 6966 206c 656e 2873 656c 662e 7374 6e5f  if len(self.stn_
-00003f50: 6e61 6d65 2920 213d 2065 6c65 7661 7469  name) != elevati
-00003f60: 6f6e 2e73 697a 6520 3a0d 0a20 2020 2020  on.size :..     
-00003f70: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-00003f80: 782e 7079 4353 414d 5445 7272 6f72 5f73  x.pyCSAMTError_s
-00003f90: 6974 6528 2753 7461 7469 6f6e 5f6e 616d  ite('Station_nam
-00003fa0: 6573 7c45 6c65 7661 7469 6f6e 206d 7573  es|Elevation mus
-00003fb0: 7427 0d0a 2020 2020 2020 2020 2020 2020  t'..            
-00003fc0: 2020 2020 2027 2068 6176 6520 7468 6520       ' have the 
-00003fd0: 7361 6d65 2073 697a 652e 456c 6576 6174  same size.Elevat
-00003fe0: 696f 6e20 7369 7a65 2069 7327 0d0a 2020  ion size is'..  
-00003ff0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00004000: 203c 7b30 7d3e 272e 666f 726d 6174 2865   <{0}>'.format(e
-00004010: 6c65 7661 7469 6f6e 2e73 697a 6529 290d  levation.size)).
-00004020: 0a20 2020 2020 2020 2073 656c 662e 5f65  .        self._e
-00004030: 6c65 7620 3d7b 7374 6e3a 656c 6576 2066  lev ={stn:elev f
-00004040: 6f72 2073 746e 2c20 656c 6576 2069 6e20  or stn, elev in 
-00004050: 7a69 7020 2873 656c 662e 7374 6e5f 6e61  zip (self.stn_na
-00004060: 6d65 2c20 656c 6576 6174 696f 6e29 7d20  me, elevation)} 
-00004070: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00004080: 4070 726f 7065 7274 7920 0d0a 2020 2020  @property ..    
-00004090: 6465 6620 617a 696d 2873 656c 6629 3a20  def azim(self): 
-000040a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000040b0: 2073 656c 662e 5f61 7a69 6d0d 0a20 2020   self._azim..   
-000040c0: 2040 617a 696d 2e73 6574 7465 7220 0d0a   @azim.setter ..
-000040d0: 2020 2020 6465 6620 617a 696d 2873 656c      def azim(sel
-000040e0: 662c 2061 7a69 6d75 7468 293a 200d 0a20  f, azimuth): .. 
-000040f0: 2020 2020 2020 2069 6620 7365 6c66 2e73         if self.s
-00004100: 746e 5f6e 616d 6520 6973 204e 6f6e 6520  tn_name is None 
-00004110: 3a20 7365 6c66 2e73 746e 5f6e 616d 6520  : self.stn_name 
-00004120: 3d20 617a 696d 7574 682e 7369 7a65 0d0a  = azimuth.size..
-00004130: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00004140: 7369 6e73 7461 6e63 6528 617a 696d 7574  sinstance(azimut
-00004150: 682c 6e70 2e6e 6461 7272 6179 293a 2061  h,np.ndarray): a
-00004160: 7a69 6d75 7468 203d 6e70 2e61 7272 6179  zimuth =np.array
-00004170: 2861 7a69 6d75 7468 290d 0a20 2020 2020  (azimuth)..     
-00004180: 2020 2069 6620 6c65 6e28 7365 6c66 2e73     if len(self.s
-00004190: 746e 5f6e 616d 6529 2021 3d20 617a 696d  tn_name) != azim
-000041a0: 7574 682e 7369 7a65 203a 0d0a 2020 2020  uth.size :..    
-000041b0: 2020 2020 2020 2020 7261 6973 6520 4353          raise CS
-000041c0: 6578 2e70 7943 5341 4d54 4572 726f 725f  ex.pyCSAMTError_
-000041d0: 7369 7465 280d 0a20 2020 2020 2020 2020  site(..         
-000041e0: 2020 2020 2020 2027 5374 6174 696f 6e5f         'Station_
-000041f0: 6e61 6d65 737c 417a 696d 7574 6820 6d75  names|Azimuth mu
-00004200: 7374 270d 0a20 2020 2020 2020 2020 2020  st'..           
-00004210: 2020 2020 2027 2068 6176 6520 7468 6520       ' have the 
-00004220: 7361 6d65 2073 697a 652e 417a 696d 7574  same size.Azimut
-00004230: 6820 7369 7a65 2069 7320 3c7b 307d 3e27  h size is <{0}>'
-00004240: 2e5c 0d0a 2020 2020 2020 2020 2020 2020  .\..            
-00004250: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00004260: 726d 6174 2861 7a69 6d75 7468 2e73 697a  rmat(azimuth.siz
-00004270: 6529 290d 0a20 2020 2020 2020 2073 656c  e))..        sel
-00004280: 662e 5f61 7a69 6d20 3d7b 7374 6e3a 617a  f._azim ={stn:az
-00004290: 696d 2066 6f72 2073 746e 2c20 617a 696d  im for stn, azim
-000042a0: 2069 6e20 7a69 7020 2873 656c 662e 7374   in zip (self.st
-000042b0: 6e5f 6e61 6d65 2c20 617a 696d 7574 6829  n_name, azimuth)
-000042c0: 7d20 2020 0d0a 2020 2020 2020 2020 0d0a  }   ..        ..
-000042d0: 2020 2020 4070 726f 7065 7274 7920 0d0a      @property ..
-000042e0: 2020 2020 6465 6620 6e6f 7274 6828 7365      def north(se
-000042f0: 6c66 293a 200d 0a20 2020 2020 2020 2072  lf): ..        r
-00004300: 6574 7572 6e20 7365 6c66 2e5f 6e6f 7274  eturn self._nort
-00004310: 680d 0a20 2020 2040 6e6f 7274 682e 7365  h..    @north.se
-00004320: 7474 6572 200d 0a20 2020 2064 6566 206e  tter ..    def n
-00004330: 6f72 7468 2873 656c 662c 206e 6f72 7468  orth(self, north
-00004340: 696e 6729 3a20 0d0a 2020 2020 2020 2020  ing): ..        
-00004350: 6966 2073 656c 662e 7374 6e5f 6e61 6d65  if self.stn_name
-00004360: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
-00004370: 2020 2020 2020 2020 7365 6c66 2e73 746e          self.stn
-00004380: 5f6e 616d 6520 3d20 6e6f 7274 6869 6e67  _name = northing
-00004390: 2e73 697a 650d 0a20 2020 2020 2020 2020  .size..         
-000043a0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-000043b0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-000043c0: 2020 2027 596f 7520 6172 6520 6e6f 7420     'You are not 
-000043d0: 7072 6f76 6964 6564 2073 7461 7469 6f6e  provided station
-000043e0: 735f 6e61 6d65 7320 3a20 5765 2077 696c  s_names : We wil
-000043f0: 6c20 6465 6665 6e69 6564 2027 0d0a 2020  l defenied '..  
-00004400: 2020 2020 2020 2020 2020 2020 2020 2773                's
-00004410: 7461 7469 6f6e 7320 6e61 6d65 7320 6175  tations names au
-00004420: 746f 6d61 7469 6361 6c6c 7920 7374 6172  tomatically star
-00004430: 7469 6e67 2062 7920 532d 5858 205b 7b30  ting by S-XX [{0
-00004440: 7d27 0d0a 2020 2020 2020 2020 2020 2020  }'..            
-00004450: 2020 2020 2020 272c 2e2e 2c7b 317d 5d73        ',..,{1}]s
-00004460: 6f20 746f 207a 6970 2064 6174 6120 7769  o to zip data wi
-00004470: 7468 206c 6174 6974 7564 652e 2049 6620  th latitude. If 
-00004480: 796f 7520 646f 6e74 2077 616e 7427 0d0a  you dont want'..
-00004490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000044a0: 2020 2720 7468 6973 2073 7461 7469 6f6e    ' this station
-000044b0: 206e 6f6d 656e 636c 6174 7572 6520 706c   nomenclature pl
-000044c0: 6561 7365 2070 726f 7669 6465 2073 7461  ease provide sta
-000044d0: 7469 6f6e 270d 0a20 2020 2020 2020 2020  tion'..         
-000044e0: 2020 2020 2020 2020 2027 206e 616d 6573           ' names
-000044f0: 2e27 2e66 6f72 6d61 7428 7365 6c66 2e73  .'.format(self.s
-00004500: 746e 5f6e 616d 655b 305d 2c20 7365 6c66  tn_name[0], self
-00004510: 2e73 746e 5f6e 616d 655b 2d31 5d29 290d  .stn_name[-1])).
-00004520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004530: 200d 0a20 2020 2020 2020 2069 6620 6e6f   ..        if no
-00004540: 7420 6973 696e 7374 616e 6365 286e 6f72  t isinstance(nor
-00004550: 7468 696e 672c 6e70 2e6e 6461 7272 6179  thing,np.ndarray
-00004560: 293a 206e 6f72 7468 696e 6720 3d6e 702e  ): northing =np.
-00004570: 6172 7261 7928 6e6f 7274 6869 6e67 290d  array(northing).
-00004580: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00004590: 7365 6c66 2e73 746e 5f6e 616d 6529 2021  self.stn_name) !
-000045a0: 3d20 6e6f 7274 6869 6e67 2e73 697a 6520  = northing.size 
-000045b0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-000045c0: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-000045d0: 5445 7272 6f72 5f73 6974 6528 0d0a 2020  TError_site(..  
-000045e0: 2020 2020 2020 2020 2020 2020 2020 2753                'S
-000045f0: 7461 7469 6f6e 5f6e 616d 6573 7c4e 6f72  tation_names|Nor
-00004600: 7468 696e 6720 6d75 7374 270d 0a20 2020  thing must'..   
-00004610: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
-00004620: 6861 7665 2074 6865 2073 616d 6520 7369  have the same si
-00004630: 7a65 2e4e 6f72 7468 696e 6720 7369 7a65  ze.Northing size
-00004640: 2069 7320 3c7b 307d 3e27 2e0d 0a20 2020   is <{0}>'...   
-00004650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004660: 666f 726d 6174 286e 6f72 7468 696e 672e  format(northing.
-00004670: 7369 7a65 2929 0d0a 2020 2020 2020 2020  size))..        
-00004680: 7365 6c66 2e5f 6e6f 7274 683d 7b73 746e  self._north={stn
-00004690: 3a6e 6f72 7468 2066 6f72 2073 746e 2c20  :north for stn, 
-000046a0: 6e6f 7274 6820 696e 207a 6970 2028 7365  north in zip (se
-000046b0: 6c66 2e73 746e 5f6e 616d 652c 206e 6f72  lf.stn_name, nor
-000046c0: 7468 696e 6729 7d20 200d 0a20 2020 2020  thing)}  ..     
-000046d0: 2020 200d 0a20 2020 2040 7072 6f70 6572     ..    @proper
-000046e0: 7479 200d 0a20 2020 2064 6566 2065 6173  ty ..    def eas
-000046f0: 7428 7365 6c66 293a 200d 0a20 2020 2020  t(self): ..     
-00004700: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00004710: 6561 7374 0d0a 2020 2020 4065 6173 742e  east..    @east.
-00004720: 7365 7474 6572 200d 0a20 2020 2064 6566  setter ..    def
-00004730: 2065 6173 7428 7365 6c66 2c20 6561 7374   east(self, east
-00004740: 696e 6729 3a20 0d0a 2020 2020 2020 2020  ing): ..        
-00004750: 6966 2073 656c 662e 7374 6e5f 6e61 6d65  if self.stn_name
-00004760: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
-00004770: 2020 2020 2020 2020 7365 6c66 2e73 746e          self.stn
-00004780: 5f6e 616d 6520 3d20 6561 7374 696e 672e  _name = easting.
-00004790: 7369 7a65 200d 0a20 2020 2020 2020 2069  size ..        i
-000047a0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-000047b0: 2865 6173 7469 6e67 2c6e 702e 6e64 6172  (easting,np.ndar
-000047c0: 7261 7929 3a20 6561 7374 696e 6720 3d6e  ray): easting =n
-000047d0: 702e 6172 7261 7928 6561 7374 696e 6729  p.array(easting)
-000047e0: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
-000047f0: 2873 656c 662e 7374 6e5f 6e61 6d65 2920  (self.stn_name) 
-00004800: 213d 2065 6173 7469 6e67 2e73 697a 6520  != easting.size 
-00004810: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00004820: 6169 7365 2043 5365 782e 7079 4353 414d  aise CSex.pyCSAM
-00004830: 5445 7272 6f72 5f73 6974 6528 0d0a 2020  TError_site(..  
-00004840: 2020 2020 2020 2020 2020 2020 2020 2753                'S
-00004850: 7461 7469 6f6e 5f6e 616d 6573 7c45 6173  tation_names|Eas
-00004860: 7469 6e67 206d 7573 7427 0d0a 2020 2020  ting must'..    
-00004870: 2020 2020 2020 2020 2020 2020 2027 2068               ' h
-00004880: 6176 6520 7468 6520 7361 6d65 2073 697a  ave the same siz
-00004890: 652e 4561 7374 696e 6720 7369 7a65 2069  e.Easting size i
-000048a0: 7320 3c7b 307d 3e27 2e5c 0d0a 2020 2020  s <{0}>'.\..    
-000048b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000048c0: 2020 2020 666f 726d 6174 2865 6173 7469      format(easti
-000048d0: 6e67 2e73 697a 6529 290d 0a20 2020 2020  ng.size))..     
-000048e0: 2020 2073 656c 662e 5f65 6173 7420 3d7b     self._east ={
-000048f0: 7374 6e3a 6561 7374 2066 6f72 2073 746e  stn:east for stn
-00004900: 2c20 6561 7374 2069 6e20 7a69 7020 2873  , east in zip (s
-00004910: 656c 662e 7374 6e5f 6e61 6d65 2c20 6561  elf.stn_name, ea
-00004920: 7374 696e 6729 7d20 0d0a 2020 2020 2020  sting)} ..      
-00004930: 2020 0d0a 2020 2020 0d0a 2020 2020 6465    ..    ..    de
-00004940: 6620 7365 745f 7369 7465 5f69 6e66 6f28  f set_site_info(
-00004950: 7365 6c66 2c20 6461 7461 5f66 6e20 3d20  self, data_fn = 
-00004960: 4e6f 6e65 2c20 6561 7374 696e 6720 3d4e  None, easting =N
-00004970: 6f6e 6520 2c0d 0a20 2020 2020 2020 2020  one ,..         
-00004980: 2020 2020 2020 2020 2020 2020 206e 6f72               nor
-00004990: 7468 696e 6720 3d4e 6f6e 6520 2c20 7574  thing =None , ut
-000049a0: 6d5f 7a6f 6e65 3d4e 6f6e 6520 293a 0d0a  m_zone=None ):..
-000049b0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-000049c0: 2020 2020 2053 6574 2d69 6e66 6f20 6672       Set-info fr
-000049d0: 6f6d 2073 6974 6520 6669 6c65 2c20 6361  om site file, ca
-000049e0: 6e20 7265 6164 207a 6f6e 6765 202a 7374  n read zonge *st
-000049f0: 6e2a 2070 726f 6669 6c65 2066 696e 6520  n* profile fine 
-00004a00: 6f72 2073 0d0a 2020 2020 2020 2020 6574  or s..        et
-00004a10: 2065 6173 7469 6e67 2061 6e64 206e 6f72   easting and nor
-00004a20: 7468 696e 6720 636f 6f72 6469 6e61 7465  thing coordinate
-00004a30: 732e 0d0a 200d 0a20 2020 2020 2020 203a  s... ..        :
-00004a40: 7061 7261 6d20 6461 7461 5f66 6e3a 2020  param data_fn:  
-00004a50: 7061 7468 2074 6f20 7369 7465 2064 6174  path to site dat
-00004a60: 6120 6669 6c65 202e 200d 0a20 2020 2020  a file . ..     
-00004a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a80: 2020 6d61 7920 5573 6520 5374 6e20 206f    may Use Stn  o
-00004a90: 7220 6f74 6865 7220 6669 6c65 206f 660d  r other file of.
-00004aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004ab0: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
-00004ac0: 7465 7320 696e 666f 730d 0a20 2020 2020  tes infos..     
-00004ad0: 2020 203a 7479 7065 2064 6174 615f 666e     :type data_fn
-00004ae0: 3a20 7374 7220 0d0a 2020 2020 2020 2020  : str ..        
-00004af0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00004b00: 2020 3a70 6172 616d 2075 746d 5f7a 6f6e    :param utm_zon
-00004b10: 653a 2055 746d 207a 6f6e 6520 5747 5338  e: Utm zone WGS8
-00004b20: 3420 0d0a 2020 2020 2020 2020 3a74 7970  4 ..        :typ
-00004b30: 6520 7574 6d5f 7a6f 6e65 3a20 7374 7220  e utm_zone: str 
-00004b40: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00004b50: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00004b60: 2020 6966 2075 746d 5f7a 6f6e 6520 6973    if utm_zone is
-00004b70: 206e 6f74 204e 6f6e 6520 3a20 7365 6c66   not None : self
-00004b80: 2e75 746d 5f7a 6f6e 6520 3d75 746d 5f7a  .utm_zone =utm_z
-00004b90: 6f6e 6520 0d0a 2020 2020 2020 2020 6966  one ..        if
-00004ba0: 2064 6174 615f 666e 2069 7320 6e6f 7420   data_fn is not 
-00004bb0: 4e6f 6e65 203a 2073 656c 662e 7369 7465  None : self.site
-00004bc0: 6461 7461 203d 2064 6174 615f 666e 200d  data = data_fn .
-00004bd0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00004be0: 2e73 6974 6564 6174 6120 6973 204e 6f6e  .sitedata is Non
-00004bf0: 6520 2061 6e64 2065 6173 7469 6e67 2069  e  and easting i
-00004c00: 7320 4e6f 6e65 2020 616e 6420 206e 6f72  s None  and  nor
-00004c10: 7468 696e 6720 6973 204e 6f6e 6520 3a0d  thing is None :.
-00004c20: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00004c30: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00004c40: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-00004c50: 6f72 5f70 726f 6669 6c65 2827 436f 756c  or_profile('Coul
-00004c60: 6420 6e6f 7420 6669 6e64 2074 6865 2066  d not find the f
-00004c70: 696c 6520 746f 2072 6561 642e 2027 0d0a  ile to read. '..
-00004c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ca0: 2020 2020 2020 2020 2020 2020 2750 6c65              'Ple
-00004cb0: 6173 6520 7072 6f76 6964 6520 7468 6520  ase provide the 
-00004cc0: 7269 6768 7420 7061 7468 2e27 290d 0a20  right path.').. 
-00004cd0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00004ce0: 2e73 6974 6564 6174 6120 6973 206e 6f74  .sitedata is not
-00004cf0: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
-00004d00: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
-00004d10: 2e69 7366 696c 6520 2873 656c 662e 7369  .isfile (self.si
-00004d20: 7465 6461 7461 2920 3a20 0d0a 2020 2020  tedata) : ..    
-00004d30: 2020 2020 2020 2020 2020 2020 7072 6f66              prof
-00004d40: 696c 655f 6f62 6a20 3d50 726f 6669 6c65  ile_obj =Profile
-00004d50: 2870 726f 6669 6c65 5f66 6e3d 7365 6c66  (profile_fn=self
-00004d60: 2e73 6974 6564 6174 6129 0d0a 2020 2020  .sitedata)..    
-00004d70: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00004d80: 2020 2020 2020 656c 7365 203a 2072 6169        else : rai
-00004d90: 7365 2043 5365 782e 7079 4353 414d 5445  se CSex.pyCSAMTE
-00004da0: 7272 6f72 5f70 726f 6669 6c65 280d 0a20  rror_profile(.. 
-00004db0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00004dc0: 556e 6162 6c65 2074 6f20 7265 6164 2020  Unable to read  
-00004dd0: 6120 6669 6c65 2e20 506c 6561 7365 2070  a file. Please p
-00004de0: 726f 7669 6465 2074 6865 2072 6967 6874  rovide the right
-00004df0: 2066 696c 652e 2729 0d0a 2020 2020 2020   file.')..      
-00004e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e20: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00004e30: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00004e40: 2020 2020 2065 6c69 6620 6561 7374 696e       elif eastin
-00004e50: 6720 6973 206e 6f74 204e 6f6e 6520 616e  g is not None an
-00004e60: 6420 6e6f 7274 6869 6e67 2069 7320 6e6f  d northing is no
-00004e70: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-00004e80: 2020 2020 2020 2070 726f 6669 6c65 5f6f         profile_o
-00004e90: 626a 203d 5072 6f66 696c 6528 292e 7265  bj =Profile().re
-00004ea0: 6164 5f73 746e 7072 6f66 696c 6528 6561  ad_stnprofile(ea
-00004eb0: 7374 696e 6720 3d65 6173 7469 6e67 2c20  sting =easting, 
-00004ec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ef0: 2020 2020 206e 6f72 7468 696e 6720 3d6e       northing =n
-00004f00: 6f72 7468 696e 6729 0d0a 2020 2020 2020  orthing)..      
-00004f10: 2020 0d0a 2020 2020 2020 2020 2363 616c    ..        #cal
-00004f20: 6c20 7072 6f66 696c 6520 6f62 6a65 6374  l profile object
-00004f30: 2061 6e64 2070 6f70 756c 6174 6520 7468   and populate th
-00004f40: 6520 6d69 7373 696e 6720 636f 6f72 6469  e missing coordi
-00004f50: 6e61 7465 206c 6174 2f6c 6f6e 2c20 0d0a  nate lat/lon, ..
-00004f60: 2020 2020 2020 2020 236f 7220 6561 7374          #or east
-00004f70: 2f6e 6f72 7468 200d 0a20 2020 2020 2020  /north ..       
-00004f80: 200d 0a20 2020 2020 2020 2069 6620 7072   ..        if pr
-00004f90: 6f66 696c 655f 6f62 6a2e 6c61 7420 6973  ofile_obj.lat is
-00004fa0: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
-00004fb0: 2020 2020 2020 7365 6c66 2e4c 6f63 6174        self.Locat
-00004fc0: 696f 6e2e 6561 7374 696e 673d 7072 6f66  ion.easting=prof
-00004fd0: 696c 655f 6f62 6a2e 6561 7374 200d 0a20  ile_obj.east .. 
-00004fe0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00004ff0: 4c6f 6361 7469 6f6e 2e6e 6f72 7468 696e  Location.northin
-00005000: 6720 3d70 726f 6669 6c65 5f6f 626a 2e6e  g =profile_obj.n
-00005010: 6f72 7468 200d 0a20 2020 2020 2020 2020  orth ..         
-00005020: 2020 2073 656c 662e 4c6f 6361 7469 6f6e     self.Location
-00005030: 2e63 6f6e 7665 7274 5f6c 6f63 6174 696f  .convert_locatio
-00005040: 6e5f 325f 6c61 746c 6f6e 2875 746d 5f7a  n_2_latlon(utm_z
-00005050: 6f6e 653d 7365 6c66 2e75 746d 5f7a 6f6e  one=self.utm_zon
-00005060: 6520 290d 0a20 2020 2020 2020 2020 2020  e )..           
-00005070: 2073 656c 662e 6c6f 6e20 2c20 7365 6c66   self.lon , self
-00005080: 2e6c 6174 203d 2073 656c 662e 4c6f 6361  .lat = self.Loca
-00005090: 7469 6f6e 2e6c 6f6e 6769 7475 6465 2c0d  tion.longitude,.
-000050a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000050b0: 662e 4c6f 6361 7469 6f6e 2e6c 6174 6974  f.Location.latit
-000050c0: 7564 6520 0d0a 2020 2020 2020 2020 656c  ude ..        el
-000050d0: 7365 203a 200d 0a20 2020 2020 2020 2020  se : ..         
-000050e0: 2020 2073 656c 662e 6c61 742c 2073 656c     self.lat, sel
-000050f0: 662e 6c6f 6e3d 7072 6f66 696c 655f 6f62  f.lon=profile_ob
-00005100: 6a2e 6c61 742c 2070 726f 6669 6c65 5f6f  j.lat, profile_o
-00005110: 626a 2e6c 6f6e 200d 0a0d 0a20 2020 2020  bj.lon ....     
-00005120: 2020 2069 6620 2870 726f 6669 6c65 5f6f     if (profile_o
-00005130: 626a 2e65 6173 7420 6973 204e 6f6e 6529  bj.east is None)
-00005140: 206f 7220 2870 726f 6669 6c65 5f6f 626a   or (profile_obj
-00005150: 2e6e 6f72 7468 2069 7320 4e6f 6e65 293a  .north is None):
-00005160: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-00005170: 656c 662e 4c6f 6361 7469 6f6e 2e6c 6174  elf.Location.lat
-00005180: 6974 7564 6520 3d70 726f 6669 6c65 5f6f  itude =profile_o
-00005190: 626a 2e6c 6174 200d 0a20 2020 2020 2020  bj.lat ..       
-000051a0: 2020 2020 2073 656c 662e 4c6f 6361 7469       self.Locati
-000051b0: 6f6e 2e6c 6f6e 6769 7475 6465 203d 7072  on.longitude =pr
-000051c0: 6f66 696c 655f 6f62 6a2e 6c6f 6e20 0d0a  ofile_obj.lon ..
-000051d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000051e0: 2e4c 6f63 6174 696f 6e2e 636f 6e76 6572  .Location.conver
-000051f0: 745f 6c6f 6361 7469 6f6e 5f32 5f75 746d  t_location_2_utm
-00005200: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00005210: 2020 206c 6174 6974 7564 653d 7365 6c66     latitude=self
-00005220: 2e4c 6f63 6174 696f 6e2e 6c61 7469 7475  .Location.latitu
-00005230: 6465 2c20 0d0a 2020 2020 2020 2020 2020  de, ..          
-00005240: 2020 2020 2020 6c6f 6e67 6974 7564 653d        longitude=
-00005250: 7365 6c66 2e4c 6f63 6174 696f 6e2e 6c6f  self.Location.lo
-00005260: 6e67 6974 7564 6529 200d 0a20 2020 200d  ngitude) ..    .
-00005270: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005280: 662e 6561 7374 2c20 7365 6c66 2e6e 6f72  f.east, self.nor
-00005290: 7468 203d 7365 6c66 2e4c 6f63 6174 696f  th =self.Locatio
-000052a0: 6e2e 6561 7374 696e 672c 2073 656c 662e  n.easting, self.
-000052b0: 4c6f 6361 7469 6f6e 2e6e 6f72 7468 696e  Location.northin
-000052c0: 6720 0d0a 2020 2020 2020 2020 2020 2020  g ..            
-000052d0: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
-000052e0: 2073 656c 662e 6561 7374 2c20 7365 6c66   self.east, self
-000052f0: 2e6e 6f72 7468 203d 7072 6f66 696c 655f  .north =profile_
-00005300: 6f62 6a2e 6561 7374 2c20 7072 6f66 696c  obj.east, profil
-00005310: 655f 6f62 6a2e 6e6f 7274 680d 0a20 2020  e_obj.north..   
-00005320: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00005330: 2020 2073 656c 662e 656c 6576 2c20 7365     self.elev, se
-00005340: 6c66 2e61 7a69 6d20 3d70 726f 6669 6c65  lf.azim =profile
-00005350: 5f6f 626a 2e65 6c65 7620 2c20 7072 6f66  _obj.elev , prof
-00005360: 696c 655f 6f62 6a2e 617a 696d 7574 680d  ile_obj.azimuth.
-00005370: 0a20 2020 2020 2020 200d 0a23 3d3d 3d3d  .        ..#====
+00003440: 662e 5f6e 6f72 7468 203d 4e6f 6e65 200d  f._north =None .
+00003450: 0a20 2020 2020 2020 2073 656c 662e 5f61  .        self._a
+00003460: 7a69 6d20 3d20 4e6f 6e65 200d 0a20 2020  zim = None ..   
+00003470: 2020 2020 2073 656c 662e 5f65 6c65 7620       self._elev 
+00003480: 3d4e 6f6e 6520 0d0a 2020 2020 2020 2020  =None ..        
+00003490: 7365 6c66 2e5f 6c65 6e5f 7374 6e3d 4e6f  self._len_stn=No
+000034a0: 6e65 200d 0a20 2020 2020 2020 2073 656c  ne ..        sel
+000034b0: 662e 5f73 746e 5f6e 616d 653d 4e6f 6e65  f._stn_name=None
+000034c0: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
+000034d0: 7574 6d5f 7a6f 6e65 203d 6b77 6172 6773  utm_zone =kwargs
+000034e0: 2e70 6f70 2827 7574 6d5f 7a6f 6e65 272c  .pop('utm_zone',
+000034f0: 2027 3439 4e27 290d 0a20 2020 2020 2020   '49N')..       
+00003500: 200d 0a20 2020 2020 2020 2066 6f72 206b   ..        for k
+00003510: 6579 7320 696e 206c 6973 7428 6b77 6172  eys in list(kwar
+00003520: 6773 2e6b 6579 7328 2929 3a0d 0a20 2020  gs.keys()):..   
+00003530: 2020 2020 2020 2020 2073 6574 6174 7472           setattr
+00003540: 2873 656c 662c 206b 6579 732c 206b 7761  (self, keys, kwa
+00003550: 7267 735b 6b65 7973 5d29 0d0a 2020 2020  rgs[keys])..    
+00003560: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00003570: 2020 6966 2073 656c 662e 7369 7465 6461    if self.siteda
+00003580: 7461 2069 7320 6e6f 7420 4e6f 6e65 203a  ta is not None :
+00003590: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+000035a0: 656c 662e 7365 745f 7369 7465 5f69 6e66  elf.set_site_inf
+000035b0: 6f28 290d 0a20 2020 2020 2020 2020 2020  o()..           
+000035c0: 200d 0a20 2020 2040 7072 6f70 6572 7479   ..    @property
+000035d0: 200d 0a20 2020 2064 6566 2073 746e 5f6e   ..    def stn_n
+000035e0: 616d 6528 7365 6c66 293a 200d 0a20 2020  ame(self): ..   
+000035f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00003600: 2e5f 7374 6e5f 6e61 6d65 200d 0a20 2020  ._stn_name ..   
+00003610: 2040 7374 6e5f 6e61 6d65 2e73 6574 7465   @stn_name.sette
+00003620: 7220 0d0a 2020 2020 6465 6620 7374 6e5f  r ..    def stn_
+00003630: 6e61 6d65 2028 7365 6c66 2c20 6e61 6d65  name (self, name
+00003640: 735f 6f72 5f6e 756d 624f 6653 7461 7469  s_or_numbOfStati
+00003650: 6f6e 7320 293a 200d 0a20 2020 2020 2020  ons ): ..       
+00003660: 200d 0a20 2020 2020 2020 2069 6620 6973   ..        if is
+00003670: 696e 7374 616e 6365 286e 616d 6573 5f6f  instance(names_o
+00003680: 725f 6e75 6d62 4f66 5374 6174 696f 6e73  r_numbOfStations
+00003690: 2c20 696e 7429 3a20 0d0a 2020 2020 2020  , int): ..      
+000036a0: 2020 2020 2020 7365 6c66 2e5f 7374 6e5f        self._stn_
+000036b0: 6e61 6d65 203d 205b 2753 7b30 3a30 327d  name = ['S{0:02}
+000036c0: 272e 666f 726d 6174 2869 6929 200d 0a20  '.format(ii) .. 
+000036d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000036e0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+000036f0: 2069 6920 696e 2072 616e 6765 286e 616d   ii in range(nam
+00003700: 6573 5f6f 725f 6e75 6d62 4f66 5374 6174  es_or_numbOfStat
+00003710: 696f 6e73 295d 0d0a 2020 2020 2020 2020  ions)]..        
+00003720: 656c 7365 203a 0d0a 2020 2020 2020 2020  else :..        
+00003730: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00003740: 6528 6e61 6d65 735f 6f72 5f6e 756d 624f  e(names_or_numbO
+00003750: 6653 7461 7469 6f6e 732c 206e 702e 6e64  fStations, np.nd
+00003760: 6172 7261 7929 3a0d 0a20 2020 2020 2020  array):..       
+00003770: 2020 2020 2020 2020 2073 656c 662e 5f73           self._s
+00003780: 746e 5f6e 616d 6520 3d20 6e61 6d65 735f  tn_name = names_
+00003790: 6f72 5f6e 756d 624f 6653 7461 7469 6f6e  or_numbOfStation
+000037a0: 732e 746f 6c69 7374 2829 0d0a 2020 2020  s.tolist()..    
+000037b0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+000037c0: 6e73 7461 6e63 6528 6e61 6d65 735f 6f72  nstance(names_or
+000037d0: 5f6e 756d 624f 6653 7461 7469 6f6e 732c  _numbOfStations,
+000037e0: 206c 6973 7429 3a20 0d0a 2020 2020 2020   list): ..      
+000037f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00003800: 7374 6e5f 6e61 6d65 203d 6e61 6d65 735f  stn_name =names_
+00003810: 6f72 5f6e 756d 624f 6653 7461 7469 6f6e  or_numbOfStation
+00003820: 730d 0a20 2020 2020 2020 2020 2020 200d  s..            .
+00003830: 0a20 2020 2040 7072 6f70 6572 7479 200d  .    @property .
+00003840: 0a20 2020 2064 6566 206c 6174 2873 656c  .    def lat(sel
+00003850: 6629 3a20 0d0a 2020 2020 2020 2020 7265  f): ..        re
+00003860: 7475 726e 2073 656c 662e 5f6c 6174 200d  turn self._lat .
+00003870: 0a20 2020 2040 6c61 742e 7365 7474 6572  .    @lat.setter
+00003880: 200d 0a20 2020 2064 6566 206c 6174 2028   ..    def lat (
+00003890: 7365 6c66 2c20 6c61 7469 7475 6465 293a  self, latitude):
+000038a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000038b0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000038c0: 6528 6c61 7469 7475 6465 2c20 6c69 7374  e(latitude, list
+000038d0: 2920 3a6c 6174 6974 7564 6520 3d6e 702e  ) :latitude =np.
+000038e0: 6172 7261 7928 6c61 7469 7475 6465 290d  array(latitude).
+000038f0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00003900: 2e73 746e 5f6e 616d 6520 6973 204e 6f6e  .stn_name is Non
+00003910: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+00003920: 2020 7365 6c66 2e73 746e 5f6e 616d 6520    self.stn_name 
+00003930: 3d20 6c61 7469 7475 6465 2e73 697a 650d  = latitude.size.
+00003940: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00003950: 6e69 6e67 732e 7761 726e 280d 0a20 2020  nings.warn(..   
+00003960: 2020 2020 2020 2020 2020 2020 2022 4279               "By
+00003970: 2064 6566 6175 6c74 2c20 7468 6520 7374   default, the st
+00003980: 6174 696f 6e20 6e61 6d65 7320 7368 6f75  ation names shou
+00003990: 6c64 2062 6520 6465 6669 6e65 6420 7573  ld be defined us
+000039a0: 696e 6720 220d 0a20 2020 2020 2020 2020  ing "..         
+000039b0: 2020 2020 2020 2022 2074 6865 2070 7265         " the pre
+000039c0: 6669 7820 2d53 2e20 652e 672e 3c7b 307d  fix -S. e.g.<{0}
+000039d0: 202d 2d2d 3e20 7b31 7d3e 222e 666f 726d   ---> {1}>".form
+000039e0: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
+000039f0: 2020 2020 2073 656c 662e 7374 6e5f 6e61       self.stn_na
+00003a00: 6d65 5b30 5d2c 2073 656c 662e 7374 6e5f  me[0], self.stn_
+00003a10: 6e61 6d65 5b2d 315d 2929 0d0a 2020 2020  name[-1]))..    
+00003a20: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00003a30: 2020 656c 6966 2073 656c 662e 7374 6e5f    elif self.stn_
+00003a40: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
+00003a50: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00003a60: 2061 7373 6572 7420 6c65 6e28 7365 6c66   assert len(self
+00003a70: 2e73 746e 5f6e 616d 6529 3d3d 206c 6174  .stn_name)== lat
+00003a80: 6974 7564 652e 7369 7a65 2c20 5c0d 0a20  itude.size, \.. 
+00003a90: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+00003aa0: 6974 6545 7272 6f72 280d 0a20 2020 2020  iteError(..     
+00003ab0: 2020 2020 2020 2020 2020 2027 5374 6174             'Stat
+00003ac0: 696f 6e20 6e61 6d65 7320 616e 6420 6c61  ion names and la
+00003ad0: 7469 7475 6465 2064 6174 6120 6d75 7374  titude data must
+00003ae0: 2068 6176 6520 7468 6520 7361 6d65 2073   have the same s
+00003af0: 697a 652e 270d 0a20 2020 2020 2020 2020  ize.'..         
+00003b00: 2020 2020 2020 2020 2720 4275 7420 7468          ' But th
+00003b10: 6520 6769 7665 6e20 6c61 7469 7475 6465  e given latitude
+00003b20: 2073 697a 6520 6973 203c 7b30 7d3e 272e   size is <{0}>'.
+00003b30: 666f 726d 6174 286c 6174 6974 7564 652e  format(latitude.
+00003b40: 7369 7a65 2929 0d0a 0d0a 2020 2020 2020  size))....      
+00003b50: 2020 7365 6c66 2e5f 6c61 7420 3d7b 7374    self._lat ={st
+00003b60: 6e3a 6c61 7420 666f 7220 7374 6e2c 206c  n:lat for stn, l
+00003b70: 6174 2069 6e20 7a69 7020 2873 656c 662e  at in zip (self.
+00003b80: 7374 6e5f 6e61 6d65 2c20 6c61 7469 7475  stn_name, latitu
+00003b90: 6465 297d 0d0a 2020 2020 0d0a 2020 2020  de)}..    ..    
+00003ba0: 4070 726f 7065 7274 7920 0d0a 2020 2020  @property ..    
+00003bb0: 6465 6620 6c6f 6e28 7365 6c66 293a 200d  def lon(self): .
+00003bc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003bd0: 7365 6c66 2e5f 6c6f 6e0d 0a20 2020 2040  self._lon..    @
+00003be0: 6c6f 6e2e 7365 7474 6572 200d 0a20 2020  lon.setter ..   
+00003bf0: 2064 6566 206c 6f6e 2873 656c 662c 206c   def lon(self, l
+00003c00: 6f6e 6769 7475 6465 293a 200d 0a20 2020  ongitude): ..   
+00003c10: 2020 2020 2069 6620 7365 6c66 2e73 746e       if self.stn
+00003c20: 5f6e 616d 6520 6973 204e 6f6e 6520 3a20  _name is None : 
+00003c30: 7365 6c66 2e73 746e 5f6e 616d 6520 3d20  self.stn_name = 
+00003c40: 6c6f 6e67 6974 7564 652e 7369 7a65 0d0a  longitude.size..
+00003c50: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00003c60: 7369 6e73 7461 6e63 6528 6c6f 6e67 6974  sinstance(longit
+00003c70: 7564 652c 6e70 2e6e 6461 7272 6179 293a  ude,np.ndarray):
+00003c80: 206c 6f6e 6769 7475 6465 203d 6e70 2e61   longitude =np.a
+00003c90: 7272 6179 286c 6f6e 6769 7475 6465 290d  rray(longitude).
+00003ca0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00003cb0: 7365 6c66 2e73 746e 5f6e 616d 6529 2021  self.stn_name) !
+00003cc0: 3d20 6c6f 6e67 6974 7564 652e 7369 7a65  = longitude.size
+00003cd0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00003ce0: 7261 6973 6520 5369 7465 4572 726f 7228  raise SiteError(
+00003cf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003d00: 2020 2753 7461 7469 6f6e 5f6e 616d 6573    'Station_names
+00003d10: 7c6c 6f6e 6769 7475 6465 206d 7573 7427  |longitude must'
+00003d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003d30: 2020 2027 2068 6176 6520 7468 6520 7361     ' have the sa
+00003d40: 6d65 2073 697a 652e 4c6f 6e67 6974 7564  me size.Longitud
+00003d50: 6520 7369 7a65 2069 7320 3c7b 307d 3e27  e size is <{0}>'
+00003d60: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00003d70: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00003d80: 6d61 7428 6c6f 6e67 6974 7564 652e 7369  mat(longitude.si
+00003d90: 7a65 2929 0d0a 2020 2020 2020 2020 7365  ze))..        se
+00003da0: 6c66 2e5f 6c6f 6e20 3d7b 7374 6e3a 6c6f  lf._lon ={stn:lo
+00003db0: 6e20 666f 7220 7374 6e2c 206c 6f6e 2069  n for stn, lon i
+00003dc0: 6e20 7a69 7020 2873 656c 662e 7374 6e5f  n zip (self.stn_
+00003dd0: 6e61 6d65 2c20 6c6f 6e67 6974 7564 6529  name, longitude)
+00003de0: 7d0d 0a20 2020 2020 2020 200d 0a20 2020  }..        ..   
+00003df0: 2040 7072 6f70 6572 7479 200d 0a20 2020   @property ..   
+00003e00: 2064 6566 2065 6c65 7628 7365 6c66 293a   def elev(self):
+00003e10: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
+00003e20: 6e20 7365 6c66 2e5f 656c 6576 0d0a 2020  n self._elev..  
+00003e30: 2020 4065 6c65 762e 7365 7474 6572 200d    @elev.setter .
+00003e40: 0a20 2020 2064 6566 2065 6c65 7628 7365  .    def elev(se
+00003e50: 6c66 2c20 656c 6576 6174 696f 6e29 3a20  lf, elevation): 
+00003e60: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00003e70: 662e 7374 6e5f 6e61 6d65 2069 7320 4e6f  f.stn_name is No
+00003e80: 6e65 203a 2073 656c 662e 7374 6e5f 6e61  ne : self.stn_na
+00003e90: 6d65 203d 2065 6c65 7661 7469 6f6e 2e73  me = elevation.s
+00003ea0: 697a 650d 0a20 2020 2020 2020 2069 6620  ize..        if 
+00003eb0: 6e6f 7420 6973 696e 7374 616e 6365 2865  not isinstance(e
+00003ec0: 6c65 7661 7469 6f6e 2c6e 702e 6e64 6172  levation,np.ndar
+00003ed0: 7261 7929 3a0d 0a20 2020 2020 2020 2020  ray):..         
+00003ee0: 2020 2065 6c65 7661 7469 6f6e 203d 6e70     elevation =np
+00003ef0: 2e61 7272 6179 2865 6c65 7661 7469 6f6e  .array(elevation
+00003f00: 290d 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
+00003f10: 6e28 7365 6c66 2e73 746e 5f6e 616d 6529  n(self.stn_name)
+00003f20: 2021 3d20 656c 6576 6174 696f 6e2e 7369   != elevation.si
+00003f30: 7a65 203a 0d0a 2020 2020 2020 2020 2020  ze :..          
+00003f40: 2020 7261 6973 6520 5369 7465 4572 726f    raise SiteErro
+00003f50: 7228 2753 7461 7469 6f6e 5f6e 616d 6573  r('Station_names
+00003f60: 7c45 6c65 7661 7469 6f6e 206d 7573 7427  |Elevation must'
+00003f70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003f80: 2020 2027 2068 6176 6520 7468 6520 7361     ' have the sa
+00003f90: 6d65 2073 697a 652e 456c 6576 6174 696f  me size.Elevatio
+00003fa0: 6e20 7369 7a65 2069 7327 0d0a 2020 2020  n size is'..    
+00003fb0: 2020 2020 2020 2020 2020 2020 2027 203c               ' <
+00003fc0: 7b30 7d3e 272e 666f 726d 6174 2865 6c65  {0}>'.format(ele
+00003fd0: 7661 7469 6f6e 2e73 697a 6529 290d 0a20  vation.size)).. 
+00003fe0: 2020 2020 2020 2073 656c 662e 5f65 6c65         self._ele
+00003ff0: 7620 3d7b 7374 6e3a 656c 6576 2066 6f72  v ={stn:elev for
+00004000: 2073 746e 2c20 656c 6576 2069 6e20 7a69   stn, elev in zi
+00004010: 7020 2873 656c 662e 7374 6e5f 6e61 6d65  p (self.stn_name
+00004020: 2c20 656c 6576 6174 696f 6e29 7d20 0d0a  , elevation)} ..
+00004030: 2020 2020 2020 2020 0d0a 2020 2020 4070          ..    @p
+00004040: 726f 7065 7274 7920 0d0a 2020 2020 6465  roperty ..    de
+00004050: 6620 617a 696d 2873 656c 6629 3a20 0d0a  f azim(self): ..
+00004060: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00004070: 656c 662e 5f61 7a69 6d0d 0a20 2020 2040  elf._azim..    @
+00004080: 617a 696d 2e73 6574 7465 7220 0d0a 2020  azim.setter ..  
+00004090: 2020 6465 6620 617a 696d 2873 656c 662c    def azim(self,
+000040a0: 2061 7a69 6d75 7468 293a 200d 0a20 2020   azimuth): ..   
+000040b0: 2020 2020 2069 6620 7365 6c66 2e73 746e       if self.stn
+000040c0: 5f6e 616d 6520 6973 204e 6f6e 6520 3a20  _name is None : 
+000040d0: 7365 6c66 2e73 746e 5f6e 616d 6520 3d20  self.stn_name = 
+000040e0: 617a 696d 7574 682e 7369 7a65 0d0a 2020  azimuth.size..  
+000040f0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00004100: 6e73 7461 6e63 6528 617a 696d 7574 682c  nstance(azimuth,
+00004110: 6e70 2e6e 6461 7272 6179 293a 2061 7a69  np.ndarray): azi
+00004120: 6d75 7468 203d 6e70 2e61 7272 6179 2861  muth =np.array(a
+00004130: 7a69 6d75 7468 290d 0a20 2020 2020 2020  zimuth)..       
+00004140: 2069 6620 6c65 6e28 7365 6c66 2e73 746e   if len(self.stn
+00004150: 5f6e 616d 6529 2021 3d20 617a 696d 7574  _name) != azimut
+00004160: 682e 7369 7a65 203a 0d0a 2020 2020 2020  h.size :..      
+00004170: 2020 2020 2020 7261 6973 6520 5369 7465        raise Site
+00004180: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00004190: 2020 2020 2020 2020 2753 7461 7469 6f6e          'Station
+000041a0: 5f6e 616d 6573 7c41 7a69 6d75 7468 206d  _names|Azimuth m
+000041b0: 7573 7427 0d0a 2020 2020 2020 2020 2020  ust'..          
+000041c0: 2020 2020 2020 2720 6861 7665 2074 6865        ' have the
+000041d0: 2073 616d 6520 7369 7a65 2e41 7a69 6d75   same size.Azimu
+000041e0: 7468 2073 697a 6520 6973 203c 7b30 7d3e  th size is <{0}>
+000041f0: 272e 5c0d 0a20 2020 2020 2020 2020 2020  '.\..           
+00004200: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00004210: 6f72 6d61 7428 617a 696d 7574 682e 7369  ormat(azimuth.si
+00004220: 7a65 2929 0d0a 2020 2020 2020 2020 7365  ze))..        se
+00004230: 6c66 2e5f 617a 696d 203d 7b73 746e 3a61  lf._azim ={stn:a
+00004240: 7a69 6d20 666f 7220 7374 6e2c 2061 7a69  zim for stn, azi
+00004250: 6d20 696e 207a 6970 2028 7365 6c66 2e73  m in zip (self.s
+00004260: 746e 5f6e 616d 652c 2061 7a69 6d75 7468  tn_name, azimuth
+00004270: 297d 2020 200d 0a20 2020 2020 2020 200d  )}   ..        .
+00004280: 0a20 2020 2040 7072 6f70 6572 7479 200d  .    @property .
+00004290: 0a20 2020 2064 6566 206e 6f72 7468 2873  .    def north(s
+000042a0: 656c 6629 3a20 0d0a 2020 2020 2020 2020  elf): ..        
+000042b0: 7265 7475 726e 2073 656c 662e 5f6e 6f72  return self._nor
+000042c0: 7468 0d0a 2020 2020 406e 6f72 7468 2e73  th..    @north.s
+000042d0: 6574 7465 7220 0d0a 2020 2020 6465 6620  etter ..    def 
+000042e0: 6e6f 7274 6828 7365 6c66 2c20 6e6f 7274  north(self, nort
+000042f0: 6869 6e67 293a 200d 0a20 2020 2020 2020  hing): ..       
+00004300: 2069 6620 7365 6c66 2e73 746e 5f6e 616d   if self.stn_nam
+00004310: 6520 6973 204e 6f6e 6520 3a0d 0a20 2020  e is None :..   
+00004320: 2020 2020 2020 2020 2073 656c 662e 7374           self.st
+00004330: 6e5f 6e61 6d65 203d 206e 6f72 7468 696e  n_name = northin
+00004340: 672e 7369 7a65 0d0a 2020 2020 2020 2020  g.size..        
+00004350: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00004360: 6e28 0d0a 2020 2020 2020 2020 2020 2020  n(..            
+00004370: 2020 2020 2759 6f75 2061 7265 206e 6f74      'You are not
+00004380: 2070 726f 7669 6465 6420 7374 6174 696f   provided statio
+00004390: 6e73 5f6e 616d 6573 203a 2057 6520 7769  ns_names : We wi
+000043a0: 6c6c 2064 6566 656e 6965 6420 270d 0a20  ll defenied '.. 
+000043b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000043c0: 7374 6174 696f 6e73 206e 616d 6573 2061  stations names a
+000043d0: 7574 6f6d 6174 6963 616c 6c79 2073 7461  utomatically sta
+000043e0: 7274 696e 6720 6279 2053 2d58 5820 5b7b  rting by S-XX [{
+000043f0: 307d 270d 0a20 2020 2020 2020 2020 2020  0}'..           
+00004400: 2020 2020 2020 2027 2c2e 2e2c 7b31 7d5d         ',..,{1}]
+00004410: 736f 2074 6f20 7a69 7020 6461 7461 2077  so to zip data w
+00004420: 6974 6820 6c61 7469 7475 6465 2e20 4966  ith latitude. If
+00004430: 2079 6f75 2064 6f6e 7420 7761 6e74 270d   you dont want'.
+00004440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004450: 2020 2027 2074 6869 7320 7374 6174 696f     ' this statio
+00004460: 6e20 6e6f 6d65 6e63 6c61 7475 7265 2070  n nomenclature p
+00004470: 6c65 6173 6520 7072 6f76 6964 6520 7374  lease provide st
+00004480: 6174 696f 6e27 0d0a 2020 2020 2020 2020  ation'..        
+00004490: 2020 2020 2020 2020 2020 2720 6e61 6d65            ' name
+000044a0: 732e 272e 666f 726d 6174 2873 656c 662e  s.'.format(self.
+000044b0: 7374 6e5f 6e61 6d65 5b30 5d2c 2073 656c  stn_name[0], sel
+000044c0: 662e 7374 6e5f 6e61 6d65 5b2d 315d 2929  f.stn_name[-1]))
+000044d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000044e0: 2020 0d0a 2020 2020 2020 2020 6966 206e    ..        if n
+000044f0: 6f74 2069 7369 6e73 7461 6e63 6528 6e6f  ot isinstance(no
+00004500: 7274 6869 6e67 2c6e 702e 6e64 6172 7261  rthing,np.ndarra
+00004510: 7929 3a20 6e6f 7274 6869 6e67 203d 6e70  y): northing =np
+00004520: 2e61 7272 6179 286e 6f72 7468 696e 6729  .array(northing)
+00004530: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+00004540: 2873 656c 662e 7374 6e5f 6e61 6d65 2920  (self.stn_name) 
+00004550: 213d 206e 6f72 7468 696e 672e 7369 7a65  != northing.size
+00004560: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00004570: 7261 6973 6520 5369 7465 4572 726f 7228  raise SiteError(
+00004580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004590: 2020 2753 7461 7469 6f6e 5f6e 616d 6573    'Station_names
+000045a0: 7c4e 6f72 7468 696e 6720 6d75 7374 270d  |Northing must'.
+000045b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000045c0: 2020 2720 6861 7665 2074 6865 2073 616d    ' have the sam
+000045d0: 6520 7369 7a65 2e4e 6f72 7468 696e 6720  e size.Northing 
+000045e0: 7369 7a65 2069 7320 3c7b 307d 3e27 2e0d  size is <{0}>'..
+000045f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004600: 2020 2020 666f 726d 6174 286e 6f72 7468      format(north
+00004610: 696e 672e 7369 7a65 2929 0d0a 2020 2020  ing.size))..    
+00004620: 2020 2020 7365 6c66 2e5f 6e6f 7274 683d      self._north=
+00004630: 7b73 746e 3a6e 6f72 7468 2066 6f72 2073  {stn:north for s
+00004640: 746e 2c20 6e6f 7274 6820 696e 207a 6970  tn, north in zip
+00004650: 2028 7365 6c66 2e73 746e 5f6e 616d 652c   (self.stn_name,
+00004660: 206e 6f72 7468 696e 6729 7d20 200d 0a20   northing)}  .. 
+00004670: 2020 2020 2020 200d 0a20 2020 2040 7072         ..    @pr
+00004680: 6f70 6572 7479 200d 0a20 2020 2064 6566  operty ..    def
+00004690: 2065 6173 7428 7365 6c66 293a 200d 0a20   east(self): .. 
+000046a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000046b0: 6c66 2e5f 6561 7374 0d0a 2020 2020 4065  lf._east..    @e
+000046c0: 6173 742e 7365 7474 6572 200d 0a20 2020  ast.setter ..   
+000046d0: 2064 6566 2065 6173 7428 7365 6c66 2c20   def east(self, 
+000046e0: 6561 7374 696e 6729 3a20 0d0a 2020 2020  easting): ..    
+000046f0: 2020 2020 6966 2073 656c 662e 7374 6e5f      if self.stn_
+00004700: 6e61 6d65 2069 7320 4e6f 6e65 203a 0d0a  name is None :..
+00004710: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00004720: 2e73 746e 5f6e 616d 6520 3d20 6561 7374  .stn_name = east
+00004730: 696e 672e 7369 7a65 200d 0a20 2020 2020  ing.size ..     
+00004740: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00004750: 616e 6365 2865 6173 7469 6e67 2c6e 702e  ance(easting,np.
+00004760: 6e64 6172 7261 7929 3a20 6561 7374 696e  ndarray): eastin
+00004770: 6720 3d6e 702e 6172 7261 7928 6561 7374  g =np.array(east
+00004780: 696e 6729 0d0a 2020 2020 2020 2020 6966  ing)..        if
+00004790: 206c 656e 2873 656c 662e 7374 6e5f 6e61   len(self.stn_na
+000047a0: 6d65 2920 213d 2065 6173 7469 6e67 2e73  me) != easting.s
+000047b0: 697a 6520 3a0d 0a20 2020 2020 2020 2020  ize :..         
+000047c0: 2020 2072 6169 7365 2053 6974 6545 7272     raise SiteErr
+000047d0: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+000047e0: 2020 2020 2027 5374 6174 696f 6e5f 6e61       'Station_na
+000047f0: 6d65 737c 4561 7374 696e 6720 6d75 7374  mes|Easting must
+00004800: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+00004810: 2020 2020 2720 6861 7665 2074 6865 2073      ' have the s
+00004820: 616d 6520 7369 7a65 2e45 6173 7469 6e67  ame size.Easting
+00004830: 2073 697a 6520 6973 203c 7b30 7d3e 272e   size is <{0}>'.
+00004840: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
+00004850: 2020 2020 2020 2020 2020 2066 6f72 6d61             forma
+00004860: 7428 6561 7374 696e 672e 7369 7a65 2929  t(easting.size))
+00004870: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00004880: 6561 7374 203d 7b73 746e 3a65 6173 7420  east ={stn:east 
+00004890: 666f 7220 7374 6e2c 2065 6173 7420 696e  for stn, east in
+000048a0: 207a 6970 2028 7365 6c66 2e73 746e 5f6e   zip (self.stn_n
+000048b0: 616d 652c 2065 6173 7469 6e67 297d 200d  ame, easting)} .
+000048c0: 0a20 2020 2020 2020 200d 0a20 2020 200d  .        ..    .
+000048d0: 0a20 2020 2064 6566 2073 6574 5f73 6974  .    def set_sit
+000048e0: 655f 696e 666f 2873 656c 662c 2064 6174  e_info(self, dat
+000048f0: 615f 666e 203d 204e 6f6e 652c 2065 6173  a_fn = None, eas
+00004900: 7469 6e67 203d 4e6f 6e65 202c 0d0a 2020  ting =None ,..  
+00004910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004920: 2020 2020 6e6f 7274 6869 6e67 203d 4e6f      northing =No
+00004930: 6e65 202c 2075 746d 5f7a 6f6e 653d 4e6f  ne , utm_zone=No
+00004940: 6e65 2029 3a0d 0a20 2020 2020 2020 2022  ne ):..        "
+00004950: 2222 0d0a 2020 2020 2020 2020 5365 742d  ""..        Set-
+00004960: 696e 666f 2066 726f 6d20 7369 7465 2066  info from site f
+00004970: 696c 652c 2063 616e 2072 6561 6420 7a6f  ile, can read zo
+00004980: 6e67 6520 2a73 746e 2a20 7072 6f66 696c  nge *stn* profil
+00004990: 6520 6669 6e65 206f 7220 730d 0a20 2020  e fine or s..   
+000049a0: 2020 2020 2065 7420 6561 7374 696e 6720       et easting 
+000049b0: 616e 6420 6e6f 7274 6869 6e67 2063 6f6f  and northing coo
+000049c0: 7264 696e 6174 6573 2e0d 0a20 0d0a 2020  rdinates... ..  
+000049d0: 2020 2020 2020 3a70 6172 616d 2064 6174        :param dat
+000049e0: 615f 666e 3a20 2070 6174 6820 746f 2073  a_fn:  path to s
+000049f0: 6974 6520 6461 7461 2066 696c 6520 2e20  ite data file . 
+00004a00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004a10: 2020 2020 2020 2020 206d 6179 2055 7365           may Use
+00004a20: 2053 746e 2020 6f72 206f 7468 6572 2066   Stn  or other f
+00004a30: 696c 6520 6f66 0d0a 2020 2020 2020 2020  ile of..        
+00004a40: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00004a50: 6f6f 7264 696e 6174 6573 2069 6e66 6f73  oordinates infos
+00004a60: 0d0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+00004a70: 6461 7461 5f66 6e3a 2073 7472 200d 0a20  data_fn: str .. 
+00004a80: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00004a90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00004aa0: 7574 6d5f 7a6f 6e65 3a20 5574 6d20 7a6f  utm_zone: Utm zo
+00004ab0: 6e65 2057 4753 3834 200d 0a20 2020 2020  ne WGS84 ..     
+00004ac0: 2020 203a 7479 7065 2075 746d 5f7a 6f6e     :type utm_zon
+00004ad0: 653a 2073 7472 2020 2020 2020 2020 2020  e: str          
+00004ae0: 2020 0d0a 2020 2020 2020 2020 2222 220d    ..        """.
+00004af0: 0a20 2020 2020 2020 2069 6620 7574 6d5f  .        if utm_
+00004b00: 7a6f 6e65 2069 7320 6e6f 7420 4e6f 6e65  zone is not None
+00004b10: 203a 2073 656c 662e 7574 6d5f 7a6f 6e65   : self.utm_zone
+00004b20: 203d 7574 6d5f 7a6f 6e65 200d 0a20 2020   =utm_zone ..   
+00004b30: 2020 2020 2069 6620 6461 7461 5f66 6e20       if data_fn 
+00004b40: 6973 206e 6f74 204e 6f6e 6520 3a20 7365  is not None : se
+00004b50: 6c66 2e73 6974 6564 6174 6120 3d20 6461  lf.sitedata = da
+00004b60: 7461 5f66 6e20 0d0a 2020 2020 2020 2020  ta_fn ..        
+00004b70: 6966 2073 656c 662e 7369 7465 6461 7461  if self.sitedata
+00004b80: 2069 7320 4e6f 6e65 2020 616e 6420 6561   is None  and ea
+00004b90: 7374 696e 6720 6973 204e 6f6e 6520 2061  sting is None  a
+00004ba0: 6e64 2020 6e6f 7274 6869 6e67 2069 7320  nd  northing is 
+00004bb0: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+00004bc0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00004bd0: 2020 7261 6973 6520 5072 6f66 696c 6545    raise ProfileE
+00004be0: 7272 6f72 2827 436f 756c 6420 6e6f 7420  rror('Could not 
+00004bf0: 6669 6e64 2074 6865 2066 696c 6520 746f  find the file to
+00004c00: 2072 6561 642e 2027 0d0a 2020 2020 2020   read. '..      
+00004c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c30: 2020 2020 2020 2750 6c65 6173 6520 7072        'Please pr
+00004c40: 6f76 6964 6520 7468 6520 7269 6768 7420  ovide the right 
+00004c50: 7061 7468 2e27 290d 0a20 2020 2020 2020  path.')..       
+00004c60: 2065 6c69 6620 7365 6c66 2e73 6974 6564   elif self.sited
+00004c70: 6174 6120 6973 206e 6f74 204e 6f6e 6520  ata is not None 
+00004c80: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00004c90: 6966 206f 732e 7061 7468 2e69 7366 696c  if os.path.isfil
+00004ca0: 6520 2873 656c 662e 7369 7465 6461 7461  e (self.sitedata
+00004cb0: 2920 3a20 0d0a 2020 2020 2020 2020 2020  ) : ..          
+00004cc0: 2020 2020 2020 7072 6f66 696c 655f 6f62        profile_ob
+00004cd0: 6a20 3d50 726f 6669 6c65 2870 726f 6669  j =Profile(profi
+00004ce0: 6c65 5f66 6e3d 7365 6c66 2e73 6974 6564  le_fn=self.sited
+00004cf0: 6174 6129 0d0a 2020 2020 2020 2020 2020  ata)..          
+00004d00: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00004d10: 656c 7365 203a 2072 6169 7365 2050 726f  else : raise Pro
+00004d20: 6669 6c65 4572 726f 7228 0d0a 2020 2020  fileError(..    
+00004d30: 2020 2020 2020 2020 2020 2020 2755 6e61              'Una
+00004d40: 626c 6520 746f 2072 6561 6420 2061 2066  ble to read  a f
+00004d50: 696c 652e 2050 6c65 6173 6520 7072 6f76  ile. Please prov
+00004d60: 6964 6520 7468 6520 7269 6768 7420 6669  ide the right fi
+00004d70: 6c65 2e27 290d 0a20 2020 2020 2020 2020  le.')..         
+00004d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004da0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00004db0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00004dc0: 2020 656c 6966 2065 6173 7469 6e67 2069    elif easting i
+00004dd0: 7320 6e6f 7420 4e6f 6e65 2061 6e64 206e  s not None and n
+00004de0: 6f72 7468 696e 6720 6973 206e 6f74 204e  orthing is not N
+00004df0: 6f6e 6520 3a20 0d0a 2020 2020 2020 2020  one : ..        
+00004e00: 2020 2020 7072 6f66 696c 655f 6f62 6a20      profile_obj 
+00004e10: 3d50 726f 6669 6c65 2829 2e72 6561 645f  =Profile().read_
+00004e20: 7374 6e70 726f 6669 6c65 2865 6173 7469  stnprofile(easti
+00004e30: 6e67 203d 6561 7374 696e 672c 200d 0a20  ng =easting, .. 
+00004e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e70: 2020 6e6f 7274 6869 6e67 203d 6e6f 7274    northing =nort
+00004e80: 6869 6e67 290d 0a20 2020 2020 2020 200d  hing)..        .
+00004e90: 0a20 2020 2020 2020 2023 6361 6c6c 2070  .        #call p
+00004ea0: 726f 6669 6c65 206f 626a 6563 7420 616e  rofile object an
+00004eb0: 6420 706f 7075 6c61 7465 2074 6865 206d  d populate the m
+00004ec0: 6973 7369 6e67 2063 6f6f 7264 696e 6174  issing coordinat
+00004ed0: 6520 6c61 742f 6c6f 6e2c 200d 0a20 2020  e lat/lon, ..   
+00004ee0: 2020 2020 2023 6f72 2065 6173 742f 6e6f       #or east/no
+00004ef0: 7274 6820 0d0a 2020 2020 2020 2020 0d0a  rth ..        ..
+00004f00: 2020 2020 2020 2020 6966 2070 726f 6669          if profi
+00004f10: 6c65 5f6f 626a 2e6c 6174 2069 7320 4e6f  le_obj.lat is No
+00004f20: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
+00004f30: 2020 2073 656c 662e 4c6f 6361 7469 6f6e     self.Location
+00004f40: 2e65 6173 7469 6e67 3d70 726f 6669 6c65  .easting=profile
+00004f50: 5f6f 626a 2e65 6173 7420 0d0a 2020 2020  _obj.east ..    
+00004f60: 2020 2020 2020 2020 7365 6c66 2e4c 6f63          self.Loc
+00004f70: 6174 696f 6e2e 6e6f 7274 6869 6e67 203d  ation.northing =
+00004f80: 7072 6f66 696c 655f 6f62 6a2e 6e6f 7274  profile_obj.nort
+00004f90: 6820 0d0a 2020 2020 2020 2020 2020 2020  h ..            
+00004fa0: 7365 6c66 2e4c 6f63 6174 696f 6e2e 636f  self.Location.co
+00004fb0: 6e76 6572 745f 6c6f 6361 7469 6f6e 5f32  nvert_location_2
+00004fc0: 5f6c 6174 6c6f 6e28 7574 6d5f 7a6f 6e65  _latlon(utm_zone
+00004fd0: 3d73 656c 662e 7574 6d5f 7a6f 6e65 2029  =self.utm_zone )
+00004fe0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00004ff0: 6c66 2e6c 6f6e 202c 2073 656c 662e 6c61  lf.lon , self.la
+00005000: 7420 3d20 7365 6c66 2e4c 6f63 6174 696f  t = self.Locatio
+00005010: 6e2e 6c6f 6e67 6974 7564 652c 0d0a 2020  n.longitude,..  
+00005020: 2020 2020 2020 2020 2020 7365 6c66 2e4c            self.L
+00005030: 6f63 6174 696f 6e2e 6c61 7469 7475 6465  ocation.latitude
+00005040: 200d 0a20 2020 2020 2020 2065 6c73 6520   ..        else 
+00005050: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00005060: 7365 6c66 2e6c 6174 2c20 7365 6c66 2e6c  self.lat, self.l
+00005070: 6f6e 3d70 726f 6669 6c65 5f6f 626a 2e6c  on=profile_obj.l
+00005080: 6174 2c20 7072 6f66 696c 655f 6f62 6a2e  at, profile_obj.
+00005090: 6c6f 6e20 0d0a 0d0a 2020 2020 2020 2020  lon ....        
+000050a0: 6966 2028 7072 6f66 696c 655f 6f62 6a2e  if (profile_obj.
+000050b0: 6561 7374 2069 7320 4e6f 6e65 2920 6f72  east is None) or
+000050c0: 2028 7072 6f66 696c 655f 6f62 6a2e 6e6f   (profile_obj.no
+000050d0: 7274 6820 6973 204e 6f6e 6529 3a20 0d0a  rth is None): ..
+000050e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000050f0: 2e4c 6f63 6174 696f 6e2e 6c61 7469 7475  .Location.latitu
+00005100: 6465 203d 7072 6f66 696c 655f 6f62 6a2e  de =profile_obj.
+00005110: 6c61 7420 0d0a 2020 2020 2020 2020 2020  lat ..          
+00005120: 2020 7365 6c66 2e4c 6f63 6174 696f 6e2e    self.Location.
+00005130: 6c6f 6e67 6974 7564 6520 3d70 726f 6669  longitude =profi
+00005140: 6c65 5f6f 626a 2e6c 6f6e 200d 0a20 2020  le_obj.lon ..   
+00005150: 2020 2020 2020 2020 2073 656c 662e 4c6f           self.Lo
+00005160: 6361 7469 6f6e 2e63 6f6e 7665 7274 5f6c  cation.convert_l
+00005170: 6f63 6174 696f 6e5f 325f 7574 6d28 0d0a  ocation_2_utm(..
+00005180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005190: 6c61 7469 7475 6465 3d73 656c 662e 4c6f  latitude=self.Lo
+000051a0: 6361 7469 6f6e 2e6c 6174 6974 7564 652c  cation.latitude,
+000051b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000051c0: 2020 206c 6f6e 6769 7475 6465 3d73 656c     longitude=sel
+000051d0: 662e 4c6f 6361 7469 6f6e 2e6c 6f6e 6769  f.Location.longi
+000051e0: 7475 6465 2920 0d0a 2020 2020 0d0a 2020  tude) ..    ..  
+000051f0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00005200: 6173 742c 2073 656c 662e 6e6f 7274 6820  ast, self.north 
+00005210: 3d73 656c 662e 4c6f 6361 7469 6f6e 2e65  =self.Location.e
+00005220: 6173 7469 6e67 2c20 7365 6c66 2e4c 6f63  asting, self.Loc
+00005230: 6174 696f 6e2e 6e6f 7274 6869 6e67 200d  ation.northing .
+00005240: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00005250: 2020 2020 2020 2065 6c73 6520 3a20 7365         else : se
+00005260: 6c66 2e65 6173 742c 2073 656c 662e 6e6f  lf.east, self.no
+00005270: 7274 6820 3d70 726f 6669 6c65 5f6f 626a  rth =profile_obj
+00005280: 2e65 6173 742c 2070 726f 6669 6c65 5f6f  .east, profile_o
+00005290: 626a 2e6e 6f72 7468 0d0a 2020 2020 2020  bj.north..      
+000052a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000052b0: 7365 6c66 2e65 6c65 762c 2073 656c 662e  self.elev, self.
+000052c0: 617a 696d 203d 7072 6f66 696c 655f 6f62  azim =profile_ob
+000052d0: 6a2e 656c 6576 202c 2070 726f 6669 6c65  j.elev , profile
+000052e0: 5f6f 626a 2e61 7a69 6d75 7468 0d0a 2020  _obj.azimuth..  
+000052f0: 2020 2020 2020 0d0a 233d 3d3d 3d3d 3d3d        ..#=======
+00005300: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005310: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005320: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005330: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005340: 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 2320 5052  ==========..# PR
+00005350: 4f46 494c 4520 434c 4153 5320 0d0a 233d  OFILE CLASS ..#=
+00005360: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005370: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00005380: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00005390: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 000053a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000053b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000053c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a23  =============..#
-000053d0: 2050 524f 4649 4c45 2043 4c41 5353 200d   PROFILE CLASS .
-000053e0: 0a23 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  .#==============
-000053f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005400: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005410: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005420: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005430: 3d3d 3d0d 0a20 2020 200d 0a63 6c61 7373  ===..    ..class
-00005440: 2050 726f 6669 6c65 2028 6f62 6a65 6374   Profile (object
-00005450: 293a 200d 0a20 2020 2022 2222 0d0a 2020  ): ..    """..  
-00005460: 2020 5072 6f66 696c 6520 636c 6173 7320    Profile class 
-00005470: 6465 616c 2077 6974 6820 2041 5647 205a  deal with  AVG Z
-00005480: 6f6e 6765 2073 7461 7469 6f6e 2066 696c  onge station fil
-00005490: 6520 616e 6420 7374 6174 6174 696f 6e20  e and statation 
-000054a0: 6c6f 6361 7469 6f6e 7320 0d0a 2020 2020  locations ..    
-000054b0: 636f 6f72 6469 6e61 7465 7320 636f 756c  coordinates coul
-000054c0: 6420 6265 2066 696e 6420 696e 202a 2e73  d be find in *.s
-000054d0: 746e 2a20 6669 6c65 206f 7220 5345 472d  tn* file or SEG-
-000054e0: 4544 4920 6669 6c65 2e20 0d0a 2020 2020  EDI file. ..    
-000054f0: 200d 0a20 2020 2020 0d0a 2020 2020 3a70   ..     ..    :p
-00005500: 6172 616d 2070 726f 6669 6c65 5f66 6e3a  aram profile_fn:
-00005510: 2020 5061 7468 2074 6f20 5a6f 6e67 6520    Path to Zonge 
-00005520: 2a53 544e 2066 696c 6520 6f66 200d 0a20  *STN file of .. 
-00005530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005540: 2020 2020 2020 2053 4547 2d45 4449 206c         SEG-EDI l
-00005550: 6f63 6174 696f 6e73 206f 7220 5a6f 6e67  ocations or Zong
-00005560: 6520 7374 6174 696f 6e20 6669 6c65 0d0a  e station file..
-00005570: 2020 2020 3a74 7970 6520 7072 6f66 696c      :type profil
-00005580: 655f 666e 3a20 7374 7220 0d0a 2020 2020  e_fn: str ..    
-00005590: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000055a0: 2020 2e2e 204e 6f74 6520 3a3a 2057 6865    .. Note :: Whe
-000055b0: 6e20 2045 4449 2066 696c 6520 6973 2063  n  EDI file is c
-000055c0: 616c 6c65 6420 2c20 4544 492d 636f 6c6c  alled , EDI-coll
-000055d0: 6563 746f 6e0d 0a20 2020 2020 2020 2020  ecton..         
-000055e0: 2020 2020 2020 2020 6175 746f 2070 6f70          auto pop
-000055f0: 756c 6174 6564 2020 7072 6f66 696c 6520  ulated  profile 
-00005600: 6174 7472 6962 7574 6573 2061 6e64 200d  attributes and .
-00005610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005620: 2020 636f 6f72 6469 6e61 7465 7320 6172    coordinates ar
-00005630: 6520 6175 746f 6d61 7469 6361 6c6c 7920  e automatically 
-00005640: 7265 7363 616c 6c65 642e 200d 0a20 2020  rescalled. ..   
-00005650: 2020 2020 0d0a 2020 2020 3d3d 3d3d 3d3d      ..    ======
-00005660: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-00005670: 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d 3d3d  ========  ======
+000053b0: 0d0a 2020 2020 0d0a 636c 6173 7320 5072  ..    ..class Pr
+000053c0: 6f66 696c 6520 286f 626a 6563 7429 3a20  ofile (object): 
+000053d0: 0d0a 2020 2020 2222 220d 0a20 2020 2050  ..    """..    P
+000053e0: 726f 6669 6c65 2063 6c61 7373 2064 6561  rofile class dea
+000053f0: 6c20 7769 7468 2020 4156 4720 5a6f 6e67  l with  AVG Zong
+00005400: 6520 7374 6174 696f 6e20 6669 6c65 2061  e station file a
+00005410: 6e64 2073 7461 7461 7469 6f6e 206c 6f63  nd statation loc
+00005420: 6174 696f 6e73 200d 0a20 2020 2063 6f6f  ations ..    coo
+00005430: 7264 696e 6174 6573 2063 6f75 6c64 2062  rdinates could b
+00005440: 6520 6669 6e64 2069 6e20 2a2e 7374 6e2a  e find in *.stn*
+00005450: 2066 696c 6520 6f72 2053 4547 2d45 4449   file or SEG-EDI
+00005460: 2066 696c 652e 200d 0a20 2020 2020 0d0a   file. ..     ..
+00005470: 2020 2020 200d 0a20 2020 203a 7061 7261       ..    :para
+00005480: 6d20 7072 6f66 696c 655f 666e 3a20 2050  m profile_fn:  P
+00005490: 6174 6820 746f 205a 6f6e 6765 202a 5354  ath to Zonge *ST
+000054a0: 4e20 6669 6c65 206f 6620 0d0a 2020 2020  N file of ..    
+000054b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000054c0: 2020 2020 5345 472d 4544 4920 6c6f 6361      SEG-EDI loca
+000054d0: 7469 6f6e 7320 6f72 205a 6f6e 6765 2073  tions or Zonge s
+000054e0: 7461 7469 6f6e 2066 696c 650d 0a20 2020  tation file..   
+000054f0: 203a 7479 7065 2070 726f 6669 6c65 5f66   :type profile_f
+00005500: 6e3a 2073 7472 200d 0a20 2020 2020 2020  n: str ..       
+00005510: 2020 2020 2020 2020 200d 0a20 2020 202e           ..    .
+00005520: 2e20 4e6f 7465 203a 3a20 5768 656e 2020  . Note :: When  
+00005530: 4544 4920 6669 6c65 2069 7320 6361 6c6c  EDI file is call
+00005540: 6564 202c 2045 4449 2d63 6f6c 6c65 6374  ed , EDI-collect
+00005550: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
+00005560: 2020 2020 2061 7574 6f20 706f 7075 6c61       auto popula
+00005570: 7465 6420 2070 726f 6669 6c65 2061 7474  ted  profile att
+00005580: 7269 6275 7465 7320 616e 6420 0d0a 2020  ributes and ..  
+00005590: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000055a0: 6f6f 7264 696e 6174 6573 2061 7265 2061  oordinates are a
+000055b0: 7574 6f6d 6174 6963 616c 6c79 2072 6573  utomatically res
+000055c0: 6361 6c6c 6564 2e20 0d0a 2020 2020 2020  called. ..      
+000055d0: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
+000055e0: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
+000055f0: 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d  =====  =========
+00005600: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005610: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005620: 3d3d 0d0a 2020 2020 4174 7472 6962 7574  ==..    Attribut
+00005630: 6573 2020 2020 2020 2020 2054 7970 6520  es         Type 
+00005640: 2020 2020 2020 2020 4578 706c 616e 6174          Explanat
+00005650: 696f 6e0d 0a20 2020 203d 3d3d 3d3d 3d3d  ion..    =======
+00005660: 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d  =========  =====
+00005670: 3d3d 3d3d 3d3d 3d20 203d 3d3d 3d3d 3d3d  =======  =======
 00005680: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00005690: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000056a0: 3d3d 3d3d 3d0d 0a20 2020 2041 7474 7269  =====..    Attri
-000056b0: 6275 7465 7320 2020 2020 2020 2020 5479  butes         Ty
-000056c0: 7065 2020 2020 2020 2020 2045 7870 6c61  pe         Expla
-000056d0: 6e61 7469 6f6e 0d0a 2020 2020 3d3d 3d3d  nation..    ====
-000056e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d  ============  ==
-000056f0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 3d3d 3d3d  ==========  ====
-00005700: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005710: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005720: 3d3d 3d3d 3d3d 3d0d 0a20 2020 204c 6f63  =======..    Loc
-00005730: 6174 696f 6e20 2020 2020 2020 2020 2020  ation           
-00005740: 636c 6173 7320 2020 2020 2020 204c 6f63  class        Loc
-00005750: 6174 696f 6e20 636c 6173 7320 666f 7220  ation class for 
-00005760: 4561 7374 696e 6720 204e 6f72 7468 696e  Easting  Northin
-00005770: 6720 0d0a 2020 2020 2020 2020 2020 2020  g ..            
+000056a0: 3d3d 3d3d 0d0a 2020 2020 4c6f 6361 7469  ====..    Locati
+000056b0: 6f6e 2020 2020 2020 2020 2020 2063 6c61  on           cla
+000056c0: 7373 2020 2020 2020 2020 4c6f 6361 7469  ss        Locati
+000056d0: 6f6e 2063 6c61 7373 2066 6f72 2045 6173  on class for Eas
+000056e0: 7469 6e67 2020 4e6f 7274 6869 6e67 200d  ting  Northing .
+000056f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005710: 2020 2020 2061 7a69 6d75 7468 2064 6574       azimuth det
+00005720: 6169 6c73 2e20 0d0a 2020 2020 7072 6f66  ails. ..    prof
+00005730: 696c 655f 616e 676c 6520 2020 2020 2066  ile_angle      f
+00005740: 6c6f 6174 2020 2020 2020 2020 4966 2075  loat        If u
+00005750: 7365 7220 646f 6573 6e74 204b 6e6f 7720  ser doesnt Know 
+00005760: 2020 7468 6520 616e 676c 6520 7072 6f66    the angle prof
+00005770: 696c 6520 2e20 0d0a 2020 2020 2020 2020  ile . ..        
 00005780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005790: 2020 2020 2020 2020 617a 696d 7574 6820          azimuth 
-000057a0: 6465 7461 696c 732e 200d 0a20 2020 2070  details. ..    p
-000057b0: 726f 6669 6c65 5f61 6e67 6c65 2020 2020  rofile_angle    
-000057c0: 2020 666c 6f61 7420 2020 2020 2020 2049    float        I
-000057d0: 6620 7573 6572 2064 6f65 736e 7420 4b6e  f user doesnt Kn
-000057e0: 6f77 2020 2074 6865 2061 6e67 6c65 2070  ow   the angle p
-000057f0: 726f 6669 6c65 202e 200d 0a20 2020 2020  rofile . ..     
-00005800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005810: 2020 2020 2020 2020 2020 2020 2020 2048                 H
-00005820: 6520 6361 6e20 7573 6520 7468 6520 6d65  e can use the me
-00005830: 7468 6f64 2022 6765 745f 7072 6f66 696c  thod "get_profil
-00005840: 655f 616e 676c 6522 2020 0d0a 2020 2020  e_angle"  ..    
-00005850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005870: 746f 2067 6574 2074 6865 2076 616c 7565  to get the value
-00005880: 206f 6620 7072 6f66 696c 6520 616e 676c   of profile angl
-00005890: 652e 200d 0a20 2020 2073 746e 5f69 6e74  e. ..    stn_int
-000058a0: 6572 7661 6c20 2020 2020 2020 286e 6461  erval       (nda
-000058b0: 7272 6179 2c31 2920 2041 7272 6179 206f  rray,1)  Array o
-000058c0: 6620 7374 6174 696f 6e20 7365 7061 7261  f station separa
-000058d0: 7469 6f6e 2e20 0d0a 2020 2020 6469 706f  tion. ..    dipo
-000058e0: 6c65 5f6c 656e 6774 6820 2020 2020 2066  le_length      f
-000058f0: 6c6f 6174 2020 2020 2020 2020 4469 706f  loat        Dipo
-00005900: 6c65 206c 656e 6774 6820 7661 6c75 6520  le length value 
-00005910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005930: 2020 2020 2020 636f 6d70 7574 6564 2061        computed a
-00005940: 7574 6f6d 6174 6963 616c 6c79 2e20 2020  utomatically.   
-00005950: 2020 2020 2020 200d 0a20 2020 206c 6174         ..    lat
-00005960: 2f6c 6f6e 2020 2020 2020 2020 2020 2020  /lon            
-00005970: 286e 6461 7272 6179 2c31 2920 206c 6174  (ndarray,1)  lat
-00005980: 6974 7564 652f 6c6f 6e67 6974 7564 6520  itude/longitude 
-00005990: 6f66 2020 7374 6174 696f 6e73 2070 6f69  of  stations poi
-000059a0: 6e74 7320 2e20 0d0a 2020 2020 6561 7374  nts . ..    east
-000059b0: 2f6e 6f72 7468 2020 2020 2020 2020 2028  /north         (
-000059c0: 6e64 6172 7261 792c 3129 2020 4561 7374  ndarray,1)  East
-000059d0: 696e 6720 616e 6420 6e6f 7274 6869 6e67  ing and northing
-000059e0: 206f 6620 7374 6174 696f 6e73 2070 6f69   of stations poi
-000059f0: 6e74 732e 2020 0d0a 2020 2020 617a 696d  nts.  ..    azim
-00005a00: 7574 6820 2020 2020 2020 2020 2020 2028  uth            (
-00005a10: 6e64 6172 7261 792c 3129 2020 417a 696d  ndarray,1)  Azim
-00005a20: 7574 6820 6172 7261 7920 7374 6174 696f  uth array statio
-00005a30: 6e73 202e 2020 2020 0d0a 2020 2020 656c  ns .    ..    el
-00005a40: 6520 2020 2020 2020 2020 2020 2020 2020  e               
-00005a50: 2028 6e64 6172 7261 792c 3129 2020 456c   (ndarray,1)  El
-00005a60: 6576 6174 696f 6e20 6172 7261 7920 6174  evation array at
-00005a70: 2065 6163 6820 7374 6174 696f 6e20 706f   each station po
-00005a80: 696e 7473 2e0d 0a20 2020 2073 746e 5f70  ints...    stn_p
-00005a90: 6f73 6974 696f 6e20 2020 2020 2020 286e  osition       (n
-00005aa0: 6461 7272 6179 2c31 2920 2053 7461 7469  darray,1)  Stati
-00005ab0: 6f6e 2070 6f73 6974 696f 6e20 6f63 6375  on position occu
-00005ac0: 7069 6564 2020 0d0a 2020 2020 2020 2020  pied  ..        
-00005ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ae0: 2020 2020 2020 2020 2020 2020 6174 2065              at e
-00005af0: 6163 6820 7374 6174 696f 6e73 2e0d 0a20  ach stations... 
-00005b00: 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d     =============
-00005b10: 3d3d 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ===  ===========
-00005b20: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
-00005b30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005b40: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-00005b50: 2020 2020 0d0a 2020 2020 3d3d 3d3d 3d3d      ..    ======
-00005b60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005b70: 3d3d 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ====  ==========
+00005790: 2020 2020 2020 2020 2020 2020 4865 2063              He c
+000057a0: 616e 2075 7365 2074 6865 206d 6574 686f  an use the metho
+000057b0: 6420 2267 6574 5f70 726f 6669 6c65 5f61  d "get_profile_a
+000057c0: 6e67 6c65 2220 200d 0a20 2020 2020 2020  ngle"  ..       
+000057d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057e0: 2020 2020 2020 2020 2020 2020 2074 6f20               to 
+000057f0: 6765 7420 7468 6520 7661 6c75 6520 6f66  get the value of
+00005800: 2070 726f 6669 6c65 2061 6e67 6c65 2e20   profile angle. 
+00005810: 0d0a 2020 2020 7374 6e5f 696e 7465 7276  ..    stn_interv
+00005820: 616c 2020 2020 2020 2028 6e64 6172 7261  al       (ndarra
+00005830: 792c 3129 2020 4172 7261 7920 6f66 2073  y,1)  Array of s
+00005840: 7461 7469 6f6e 2073 6570 6172 6174 696f  tation separatio
+00005850: 6e2e 200d 0a20 2020 2064 6970 6f6c 655f  n. ..    dipole_
+00005860: 6c65 6e67 7468 2020 2020 2020 666c 6f61  length      floa
+00005870: 7420 2020 2020 2020 2044 6970 6f6c 6520  t        Dipole 
+00005880: 6c65 6e67 7468 2076 616c 7565 200d 0a20  length value .. 
+00005890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058b0: 2020 2063 6f6d 7075 7465 6420 6175 746f     computed auto
+000058c0: 6d61 7469 6361 6c6c 792e 2020 2020 2020  matically.      
+000058d0: 2020 2020 0d0a 2020 2020 6c61 742f 6c6f      ..    lat/lo
+000058e0: 6e20 2020 2020 2020 2020 2020 2028 6e64  n            (nd
+000058f0: 6172 7261 792c 3129 2020 6c61 7469 7475  array,1)  latitu
+00005900: 6465 2f6c 6f6e 6769 7475 6465 206f 6620  de/longitude of 
+00005910: 2073 7461 7469 6f6e 7320 706f 696e 7473   stations points
+00005920: 202e 200d 0a20 2020 2065 6173 742f 6e6f   . ..    east/no
+00005930: 7274 6820 2020 2020 2020 2020 286e 6461  rth         (nda
+00005940: 7272 6179 2c31 2920 2045 6173 7469 6e67  rray,1)  Easting
+00005950: 2061 6e64 206e 6f72 7468 696e 6720 6f66   and northing of
+00005960: 2073 7461 7469 6f6e 7320 706f 696e 7473   stations points
+00005970: 2e20 200d 0a20 2020 2061 7a69 6d75 7468  .  ..    azimuth
+00005980: 2020 2020 2020 2020 2020 2020 286e 6461              (nda
+00005990: 7272 6179 2c31 2920 2041 7a69 6d75 7468  rray,1)  Azimuth
+000059a0: 2061 7272 6179 2073 7461 7469 6f6e 7320   array stations 
+000059b0: 2e20 2020 200d 0a20 2020 2065 6c65 2020  .    ..    ele  
+000059c0: 2020 2020 2020 2020 2020 2020 2020 286e                (n
+000059d0: 6461 7272 6179 2c31 2920 2045 6c65 7661  darray,1)  Eleva
+000059e0: 7469 6f6e 2061 7272 6179 2061 7420 6561  tion array at ea
+000059f0: 6368 2073 7461 7469 6f6e 2070 6f69 6e74  ch station point
+00005a00: 732e 0d0a 2020 2020 7374 6e5f 706f 7369  s...    stn_posi
+00005a10: 7469 6f6e 2020 2020 2020 2028 6e64 6172  tion       (ndar
+00005a20: 7261 792c 3129 2020 5374 6174 696f 6e20  ray,1)  Station 
+00005a30: 706f 7369 7469 6f6e 206f 6363 7570 6965  position occupie
+00005a40: 6420 200d 0a20 2020 2020 2020 2020 2020  d  ..           
+00005a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a60: 2020 2020 2020 2020 2061 7420 6561 6368           at each
+00005a70: 2073 7461 7469 6f6e 732e 0d0a 2020 2020   stations...    
+00005a80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005a90: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020    ============  
+00005aa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005ab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005ac0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20 2020  ===========..   
+00005ad0: 200d 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d   ..    =========
+00005ae0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005af0: 3d20 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  =  =============
+00005b00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005b10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005b20: 3d3d 0d0a 2020 2020 4d65 7468 6f64 7320  ==..    Methods 
+00005b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b40: 2020 2020 4465 7363 7269 7074 696f 6e0d      Description.
+00005b50: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+00005b60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
+00005b70: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
 00005b80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00005b90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005ba0: 3d3d 3d3d 3d0d 0a20 2020 204d 6574 686f  =====..    Metho
-00005bb0: 6473 2020 2020 2020 2020 2020 2020 2020  ds              
-00005bc0: 2020 2020 2020 2044 6573 6372 6970 7469         Descripti
-00005bd0: 6f6e 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d  on..    ========
-00005be0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005bf0: 3d3d 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ==  ============
-00005c00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005c10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005c20: 3d3d 3d0d 0a20 2020 2072 6561 645f 7374  ===..    read_st
-00005c30: 6e70 726f 6669 6c65 2020 2020 2020 2020  nprofile        
-00005c40: 2020 2020 2052 6561 6420 7468 6520 7072       Read the pr
-00005c50: 6f66 696c 6520 6669 6c65 202e 0d0a 2020  ofile file ...  
-00005c60: 2020 6765 745f 7072 6f66 696c 655f 616e    get_profile_an
-00005c70: 676c 6520 2020 2020 2020 2020 2020 436f  gle           Co
-00005c80: 6d70 7574 6520 7468 6520 7072 6f66 696c  mpute the profil
-00005c90: 6520 206c 696e 6520 616e 6420 7374 7269  e  line and stri
-00005ca0: 6b65 2061 6e67 6c65 202e 0d0a 2020 2020  ke angle ...    
-00005cb0: 7265 616a 7573 745f 636f 6f72 6469 6e61  reajust_coordina
-00005cc0: 7465 735f 7661 6c75 6573 2020 5265 616a  tes_values  Reaj
-00005cd0: 7573 746d 656e 7420 6f66 2063 6f6f 7264  ustment of coord
-00005ce0: 696e 6174 6573 2076 616c 7565 732e 2020  inates values.  
-00005cf0: 0d0a 2020 2020 7374 7261 6967 6874 656e  ..    straighten
-00005d00: 5f70 726f 6669 6c65 6c69 6e65 2020 2020  _profileline    
-00005d10: 2020 5265 6472 6573 7320 7468 6520 7072    Redress the pr
-00005d20: 6f66 696c 6520 6c69 6e65 202e 200d 0a20  ofile line . .. 
-00005d30: 2020 2072 6577 7269 7465 5f73 7461 7469     rewrite_stati
-00005d40: 6f6e 5f70 726f 6669 6c65 2020 2020 2052  on_profile     R
-00005d50: 6577 7269 7465 2074 6865 2073 7461 7469  ewrite the stati
-00005d60: 6f6e 2070 726f 6669 6c65 0d0a 2020 2020  on profile..    
-00005d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d80: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00005d90: 6765 6e65 7261 7465 2061 206e 6577 2073  generate a new s
-00005da0: 746e 2066 696c 652e 0d0a 2020 2020 7374  tn file...    st
-00005db0: 6e5f 7365 7061 7261 7469 6f6e 2020 2020  n_separation    
-00005dc0: 2020 2020 2020 2020 2020 436f 6d70 7574            Comput
-00005dd0: 6520 7468 6520 7374 6174 696f 6e73 2020  e the stations  
-00005de0: 7365 7061 7261 7469 6f6e 7320 2e20 2020  separations .   
-00005df0: 2020 200d 0a20 2020 2063 6f6d 7075 7465     ..    compute
-00005e00: 5f64 6970 6f6c 655c 0d0a 2020 2020 2020  _dipole\..      
-00005e10: 2020 6c65 6e67 7468 5f66 726f 6d5f 636f    length_from_co
-00005e20: 6f72 6473 2020 2020 2020 636f 6d70 7574  ords      comput
-00005e30: 6520 6469 706f 6c65 6c65 6e67 7468 0d0a  e dipolelength..
-00005e40: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d      ============
-00005e50: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020  ==============  
-00005e60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005e70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005e80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d  ===============.
-00005e90: 0a0d 0a20 2020 204d 6f72 6520 6174 7472  ...    More attr
-00005ea0: 6962 7574 6573 2063 616e 2062 6520 6164  ibutes can be ad
-00005eb0: 6465 6420 6279 2069 6e70 7574 696e 6720  ded by inputing 
-00005ec0: 6120 6b65 7920 776f 7264 2064 6963 7469  a key word dicti
-00005ed0: 6f6e 6172 790d 0a20 2020 200d 0a20 2020  onary..    ..   
-00005ee0: 203a 4578 616d 706c 653a 200d 0a20 2020   :Example: ..   
-00005ef0: 2020 2020 200d 0a20 2020 2020 2020 203e       ..        >
-00005f00: 3e3e 2066 726f 6d20 7079 6373 616d 742e  >> from pycsamt.
-00005f10: 6666 2e73 6974 6520 696d 706f 7274 2050  ff.site import P
-00005f20: 726f 6669 6c65 200d 0a20 2020 2020 2020  rofile ..       
-00005f30: 203e 3e3e 2066 696c 655f 7374 6e20 3d20   >>> file_stn = 
-00005f40: 274b 312e 7374 6e27 0d0a 2020 2020 2020  'K1.stn'..      
-00005f50: 2020 3e3e 3e20 7061 7468 203d 2020 6f73    >>> path =  os
-00005f60: 2e70 6174 682e 6a6f 696e 286f 732e 656e  .path.join(os.en
-00005f70: 7669 726f 6e5b 2270 7943 5341 4d54 225d  viron["pyCSAMT"]
-00005f80: 2c20 0d0a 2020 2020 2020 2020 2e2e 2e20  , ..        ... 
-00005f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005fa0: 2020 2020 2027 7079 6373 616d 7427 2c27       'pycsamt','
-00005fb0: 6461 7461 272c 2066 696c 655f 7374 6e29  data', file_stn)
-00005fc0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7072  ..        >>> pr
-00005fd0: 6f66 696c 6520 3d50 726f 6669 6c65 2028  ofile =Profile (
-00005fe0: 7072 6f66 696c 655f 666e 3d70 6174 6829  profile_fn=path)
-00005ff0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7072  ..        >>> pr
-00006000: 6f66 696c 652e 7374 7261 6967 6874 656e  ofile.straighten
-00006010: 5f70 726f 6669 6c65 6c69 6e65 280d 0a20  _profileline(.. 
-00006020: 2020 2020 2020 2020 2020 2058 3d70 726f             X=pro
-00006030: 6669 6c65 2e65 6173 742c 2059 3d70 726f  file.east, Y=pro
-00006040: 6669 6c65 2e6e 6f72 7468 2c73 7472 6169  file.north,strai
-00006050: 6768 745f 7479 7065 3d27 6e27 290d 0a20  ght_type='n').. 
-00006060: 2020 2020 2020 203e 3e3e 2070 726f 6669         >>> profi
-00006070: 6c65 2e72 6577 7269 7465 5f73 7461 7469  le.rewrite_stati
-00006080: 6f6e 5f70 726f 6669 6c65 280d 0a20 2020  on_profile(..   
-00006090: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-000060a0: 2020 2020 6561 7374 696e 673d 7072 6f66      easting=prof
-000060b0: 696c 652e 6561 7374 2c20 0d0a 2020 2020  ile.east, ..    
-000060c0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-000060d0: 2020 206e 6f72 7468 696e 673d 7072 6f66     northing=prof
-000060e0: 696c 652e 6e6f 7274 682c 200d 0a20 2020  ile.north, ..   
-000060f0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-00006100: 2020 2020 656c 6576 6174 696f 6e20 3d70      elevation =p
-00006110: 726f 6669 6c65 2e65 6c65 762c 200d 0a20  rofile.elev, .. 
-00006120: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-00006130: 2020 2020 2020 6164 645f 617a 696d 7574        add_azimut
-00006140: 683d 5472 7565 290d 0a20 2020 2020 2020  h=True)..       
-00006150: 203e 3e3e 2073 6570 6172 6174 696f 6e20   >>> separation 
-00006160: 3d20 7072 6f66 696c 652e 7374 6e5f 7365  = profile.stn_se
-00006170: 7061 7261 7469 6f6e 280d 0a20 2020 2020  paration(..     
-00006180: 2020 202e 2e2e 2020 2020 6561 7374 696e     ...    eastin
-00006190: 6720 3d20 7072 6f66 696c 652e 6561 7374  g = profile.east
-000061a0: 2c20 0d0a 2020 2020 2020 2020 2e2e 2e20  , ..        ... 
-000061b0: 2020 206e 6f72 7468 696e 6720 3d70 726f     northing =pro
-000061c0: 6669 6c65 2e6e 6f72 7468 290d 0a20 2020  file.north)..   
-000061d0: 2022 2222 0d0a 2020 2020 6465 6620 5f5f   """..    def __
-000061e0: 696e 6974 5f5f 2873 656c 6620 2c20 7072  init__(self , pr
-000061f0: 6f66 696c 655f 666e 3d4e 6f6e 6520 2c20  ofile_fn=None , 
-00006200: 202a 2a6b 7761 7267 7329 3a0d 0a20 2020   **kwargs):..   
-00006210: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00006220: 656c 662e 5f6c 6f67 6769 6e67 203d 2063  elf._logging = c
-00006230: 7361 6d74 7079 6c6f 672e 6765 745f 6373  samtpylog.get_cs
-00006240: 616d 7470 795f 6c6f 6767 6572 2873 656c  amtpy_logger(sel
-00006250: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00006260: 6d65 5f5f 290d 0a20 2020 2020 2020 2073  me__)..        s
-00006270: 656c 662e 7072 6f66 696c 655f 666e 203d  elf.profile_fn =
-00006280: 7072 6f66 696c 655f 666e 200d 0a20 2020  profile_fn ..   
-00006290: 2020 2020 2073 656c 662e 4c6f 6361 7469       self.Locati
-000062a0: 6f6e 203d 4c6f 6361 7469 6f6e 2028 290d  on =Location ().
-000062b0: 0a20 2020 2020 2020 2073 656c 662e 5369  .        self.Si
-000062c0: 7465 203d 5369 7465 2829 0d0a 2020 2020  te =Site()..    
-000062d0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-000062e0: 656c 662e 7072 6f66 696c 655f 616e 676c  elf.profile_angl
-000062f0: 653d 4e6f 6e65 0d0a 2020 2020 2020 2020  e=None..        
-00006300: 7365 6c66 2e5f 7374 6e5f 706f 7369 7469  self._stn_positi
-00006310: 6f6e 203d 4e6f 6e65 200d 0a0d 0a20 2020  on =None ....   
-00006320: 2020 2020 2073 656c 662e 7374 6e5f 696e       self.stn_in
-00006330: 7465 7276 616c 3d4e 6f6e 650d 0a20 2020  terval=None..   
-00006340: 2020 2020 2073 656c 662e 6469 706f 6c65       self.dipole
-00006350: 5f6c 656e 6774 6820 3d4e 6f6e 6520 0d0a  _length =None ..
-00006360: 2020 2020 2020 2020 7365 6c66 2e61 7a69          self.azi
-00006370: 6d75 7468 203d 4e6f 6e65 200d 0a20 2020  muth =None ..   
-00006380: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00006390: 656c 662e 7574 6d5f 7a6f 6e65 203d 6b77  elf.utm_zone =kw
-000063a0: 6172 6773 2e70 6f70 2827 7574 6d5f 7a6f  args.pop('utm_zo
-000063b0: 6e65 272c 2027 3439 4e27 290d 0a20 2020  ne', '49N')..   
-000063c0: 2020 2020 2073 656c 662e 7361 7665 7061       self.savepa
-000063d0: 7468 203d 6b77 6172 6773 2e70 6f70 2827  th =kwargs.pop('
-000063e0: 7361 7665 7061 7468 272c 204e 6f6e 6529  savepath', None)
-000063f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00006400: 2020 2020 666f 7220 6b65 7973 2069 6e20      for keys in 
-00006410: 6c69 7374 286b 7761 7267 732e 6b65 7973  list(kwargs.keys
-00006420: 2829 293a 200d 0a20 2020 2020 2020 2020  ()): ..         
-00006430: 2020 2073 6574 6174 7472 2873 656c 662c     setattr(self,
-00006440: 206b 6579 732c 206b 7761 7267 735b 6b65   keys, kwargs[ke
-00006450: 7973 5d29 0d0a 2020 2020 2020 2020 0d0a  ys])..        ..
-00006460: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00006470: 2020 6966 2073 656c 662e 7072 6f66 696c    if self.profil
-00006480: 655f 666e 2069 7320 6e6f 7420 4e6f 6e65  e_fn is not None
-00006490: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-000064a0: 2073 656c 662e 7265 6164 5f73 746e 7072   self.read_stnpr
-000064b0: 6f66 696c 6528 290d 0a20 2020 2020 2020  ofile()..       
-000064c0: 2020 2020 200d 0a20 2020 2023 2d2d 2d2d       ..    #----
-000064d0: 2073 6574 2070 726f 6669 6c65 2070 726f   set profile pro
-000064e0: 7065 7274 6965 7320 2d2d 2d2d 2d0d 0a20  perties -----.. 
-000064f0: 2020 2040 7072 6f70 6572 7479 200d 0a20     @property .. 
-00006500: 2020 2064 6566 206c 6174 2028 7365 6c66     def lat (self
-00006510: 293a 200d 0a20 2020 2020 2020 2072 6574  ): ..        ret
-00006520: 7572 6e20 7365 6c66 2e4c 6f63 6174 696f  urn self.Locatio
-00006530: 6e2e 6c61 7469 7475 6465 200d 0a20 2020  n.latitude ..   
-00006540: 2040 7072 6f70 6572 7479 200d 0a20 2020   @property ..   
-00006550: 2064 6566 206c 6f6e 2028 7365 6c66 293a   def lon (self):
-00006560: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
-00006570: 6e20 7365 6c66 2e4c 6f63 6174 696f 6e2e  n self.Location.
-00006580: 6c6f 6e67 6974 7564 6520 0d0a 2020 2020  longitude ..    
-00006590: 4070 726f 7065 7274 7920 0d0a 2020 2020  @property ..    
-000065a0: 6465 6620 656c 6576 2028 7365 6c66 293a  def elev (self):
-000065b0: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
-000065c0: 6e20 7365 6c66 2e4c 6f63 6174 696f 6e2e  n self.Location.
-000065d0: 656c 6576 6174 696f 6e20 200d 0a20 2020  elevation  ..   
-000065e0: 2040 7072 6f70 6572 7479 200d 0a20 2020   @property ..   
-000065f0: 2064 6566 206e 6f72 7468 2028 7365 6c66   def north (self
-00006600: 293a 200d 0a20 2020 2020 2020 2072 6574  ): ..        ret
-00006610: 7572 6e20 7365 6c66 2e4c 6f63 6174 696f  urn self.Locatio
-00006620: 6e2e 6e6f 7274 6869 6e67 0d0a 2020 2020  n.northing..    
-00006630: 4070 726f 7065 7274 7920 0d0a 2020 2020  @property ..    
-00006640: 6465 6620 6561 7374 2028 7365 6c66 293a  def east (self):
-00006650: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
-00006660: 6e20 7365 6c66 2e4c 6f63 6174 696f 6e2e  n self.Location.
-00006670: 6561 7374 696e 6720 0d0a 2020 2020 4070  easting ..    @p
-00006680: 726f 7065 7274 7920 0d0a 2020 2020 6465  roperty ..    de
-00006690: 6620 7374 6e5f 706f 7369 7469 6f6e 2028  f stn_position (
-000066a0: 7365 6c66 293a 200d 0a20 2020 2020 2020  self): ..       
-000066b0: 2072 6574 7572 6e20 7365 6c66 2e4c 6f63   return self.Loc
-000066c0: 6174 696f 6e2e 7374 6e5f 706f 730d 0a20  ation.stn_pos.. 
-000066d0: 200d 0a20 2020 2023 202d 2d2d 2d20 7365   ..    # ---- se
-000066e0: 7420 6675 6e63 7469 6f6e 7320 2d2d 2d2d  t functions ----
-000066f0: 0d0a 2020 2020 406c 6174 2e73 6574 7465  ..    @lat.sette
-00006700: 7220 0d0a 2020 2020 6465 6620 6c61 7428  r ..    def lat(
-00006710: 7365 6c66 2c20 6c61 7469 7475 6465 293a  self, latitude):
-00006720: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-00006730: 4c6f 6361 7469 6f6e 2e6c 6174 6974 7564  Location.latitud
-00006740: 6520 3d6c 6174 6974 7564 6520 0d0a 0d0a  e =latitude ....
-00006750: 2020 2020 406c 6f6e 2e73 6574 7465 7220      @lon.setter 
-00006760: 0d0a 2020 2020 6465 6620 6c6f 6e20 2873  ..    def lon (s
-00006770: 656c 662c 206c 6f6e 6769 7475 6465 293a  elf, longitude):
-00006780: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-00006790: 4c6f 6361 7469 6f6e 2e6c 6f6e 6769 7475  Location.longitu
-000067a0: 6465 203d 206c 6f6e 6769 7475 6465 200d  de = longitude .
-000067b0: 0a0d 0a20 2020 2040 6e6f 7274 682e 7365  ...    @north.se
-000067c0: 7474 6572 200d 0a20 2020 2064 6566 206e  tter ..    def n
-000067d0: 6f72 7468 2028 7365 6c66 2c20 6e6f 7274  orth (self, nort
-000067e0: 6869 6e67 293a 200d 0a20 2020 2020 2020  hing): ..       
-000067f0: 2073 656c 662e 4c6f 6361 7469 6f6e 2e6e   self.Location.n
-00006800: 6f72 7468 696e 6720 3d6e 6f72 7468 696e  orthing =northin
-00006810: 670d 0a20 2020 2020 2020 200d 0a20 2020  g..        ..   
-00006820: 2040 6561 7374 2e73 6574 7465 7220 0d0a   @east.setter ..
-00006830: 2020 2020 6465 6620 6561 7374 2873 656c      def east(sel
-00006840: 662c 2065 6173 7469 6e67 293a 200d 0a20  f, easting): .. 
-00006850: 2020 2020 2020 2073 656c 662e 4c6f 6361         self.Loca
-00006860: 7469 6f6e 2e65 6173 7469 6e67 203d 2065  tion.easting = e
-00006870: 6173 7469 6e67 0d0a 200d 0a20 2020 2040  asting.. ..    @
-00006880: 656c 6576 2e73 6574 7465 7220 0d0a 2020  elev.setter ..  
-00006890: 2020 6465 6620 656c 6576 2028 7365 6c66    def elev (self
-000068a0: 2c20 656c 6576 6174 696f 6e29 3a20 0d0a  , elevation): ..
-000068b0: 2020 2020 2020 2020 7365 6c66 2e4c 6f63          self.Loc
-000068c0: 6174 696f 6e2e 656c 6576 6174 696f 6e20  ation.elevation 
-000068d0: 3d20 656c 6576 6174 696f 6e20 0d0a 2020  = elevation ..  
-000068e0: 2020 4073 746e 5f70 6f73 6974 696f 6e2e    @stn_position.
-000068f0: 7365 7474 6572 200d 0a20 2020 2064 6566  setter ..    def
-00006900: 2073 746e 5f70 6f73 6974 696f 6e20 2873   stn_position (s
-00006910: 656c 662c 2070 6f73 6974 696f 6e5f 6172  elf, position_ar
-00006920: 7261 7929 3a20 0d0a 2020 2020 2020 2020  ray): ..        
-00006930: 7365 6c66 2e4c 6f63 6174 696f 6e2e 7374  self.Location.st
-00006940: 6e5f 706f 7320 3d20 706f 7369 7469 6f6e  n_pos = position
-00006950: 5f61 7272 6179 0d0a 0d0a 2020 2020 2020  _array....      
-00006960: 2020 0d0a 2020 2020 6465 6620 7265 6164    ..    def read
-00006970: 5f73 746e 7072 6f66 696c 6520 2873 656c  _stnprofile (sel
-00006980: 662c 2070 726f 6669 6c65 5f66 6e20 3d4e  f, profile_fn =N
-00006990: 6f6e 6520 2c0d 0a20 2020 2020 2020 2020  one ,..         
-000069a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069b0: 6561 7374 696e 673d 4e6f 6e65 202c 206e  easting=None , n
-000069c0: 6f72 7468 696e 673d 4e6f 6e65 202c 0d0a  orthing=None ,..
-000069d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069e0: 2020 2020 2020 2020 2065 6c65 7661 7469           elevati
-000069f0: 6f6e 203d 4e6f 6e65 202c 2073 706c 6974  on =None , split
-00006a00: 5f74 7970 653d 4e6f 6e65 2c0d 0a20 2020  _type=None,..   
-00006a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a20: 2020 2020 2020 2a2a 6b77 6172 6773 293a        **kwargs):
-00006a30: 0d0a 2020 2020 2020 2020 2222 2220 0d0a  ..        """ ..
-00006a40: 2020 2020 2020 2020 4d65 7468 6f64 2074          Method t
-00006a50: 6f20 7265 6164 2070 726f 6669 6c65 2073  o read profile s
-00006a60: 7461 7469 6f6e 2066 696c 652e 0d0a 2020  tation file...  
-00006a70: 2020 2020 2020 7573 6572 2063 616e 2075        user can u
-00006a80: 7365 2069 7473 2073 7065 6369 616c 2066  se its special f
-00006a90: 696c 6520 2e75 7365 7220 6361 6e20 7370  ile .user can sp
-00006aa0: 6563 6966 7920 0d0a 2020 2020 2020 2020  ecify ..        
-00006ab0: 6120 6865 6164 206f 6620 6974 7320 6669  a head of its fi
-00006ac0: 6c65 2e20 6d65 7468 6f64 2077 696c 6c20  le. method will 
-00006ad0: 7265 6164 2061 6e64 2077 696c 6c20 7061  read and will pa
-00006ae0: 7273 6520 0d0a 2020 2020 2020 2020 6561  rse ..        ea
-00006af0: 7374 696e 6720 2c20 6e6f 7274 6869 6e67  sting , northing
-00006b00: 202c 2065 6c65 7661 7469 6f6e 202c 206f   , elevation , o
-00006b10: 7220 0d0a 2020 2020 2020 2020 6c6f 6e2c  r ..        lon,
-00006b20: 206c 6174 2c20 656c 6576 206f 7220 7374   lat, elev or st
-00006b30: 6174 696f 6e20 2e20 5573 6572 2063 616e  ation . User can
-00006b40: 2061 6c73 6f20 7072 6f76 6964 6564 200d   also provided .
-00006b50: 0a20 2020 2020 2020 2065 6173 7469 6e67  .        easting
-00006b60: 202c 206e 6f72 7468 696e 6720 616e 6420   , northing and 
-00006b70: 656c 6576 6174 696f 6e20 7661 6c75 6520  elevation value 
-00006b80: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-00006b90: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00006ba0: 2020 0d0a 2020 2020 2020 2020 2d2d 2d2d    ..        ----
-00006bb0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00006bc0: 2020 2020 202a 2070 726f 6669 6c65 5f66       * profile_f
-00006bd0: 6e20 3a73 7472 200d 0a20 2020 2020 2020  n :str ..       
+00005ba0: 0d0a 2020 2020 7265 6164 5f73 746e 7072  ..    read_stnpr
+00005bb0: 6f66 696c 6520 2020 2020 2020 2020 2020  ofile           
+00005bc0: 2020 5265 6164 2074 6865 2070 726f 6669    Read the profi
+00005bd0: 6c65 2066 696c 6520 2e0d 0a20 2020 2067  le file ...    g
+00005be0: 6574 5f70 726f 6669 6c65 5f61 6e67 6c65  et_profile_angle
+00005bf0: 2020 2020 2020 2020 2020 2043 6f6d 7075             Compu
+00005c00: 7465 2074 6865 2070 726f 6669 6c65 2020  te the profile  
+00005c10: 6c69 6e65 2061 6e64 2073 7472 696b 6520  line and strike 
+00005c20: 616e 676c 6520 2e0d 0a20 2020 2072 6561  angle ...    rea
+00005c30: 6a75 7374 5f63 6f6f 7264 696e 6174 6573  just_coordinates
+00005c40: 5f76 616c 7565 7320 2052 6561 6a75 7374  _values  Reajust
+00005c50: 6d65 6e74 206f 6620 636f 6f72 6469 6e61  ment of coordina
+00005c60: 7465 7320 7661 6c75 6573 2e20 200d 0a20  tes values.  .. 
+00005c70: 2020 2073 7472 6169 6768 7465 6e5f 7072     straighten_pr
+00005c80: 6f66 696c 656c 696e 6520 2020 2020 2052  ofileline      R
+00005c90: 6564 7265 7373 2074 6865 2070 726f 6669  edress the profi
+00005ca0: 6c65 206c 696e 6520 2e20 0d0a 2020 2020  le line . ..    
+00005cb0: 7265 7772 6974 655f 7374 6174 696f 6e5f  rewrite_station_
+00005cc0: 7072 6f66 696c 6520 2020 2020 5265 7772  profile     Rewr
+00005cd0: 6974 6520 7468 6520 7374 6174 696f 6e20  ite the station 
+00005ce0: 7072 6f66 696c 650d 0a20 2020 2020 2020  profile..       
+00005cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d00: 2020 2020 2020 2020 2061 6e64 2067 656e           and gen
+00005d10: 6572 6174 6520 6120 6e65 7720 7374 6e20  erate a new stn 
+00005d20: 6669 6c65 2e0d 0a20 2020 2073 746e 5f73  file...    stn_s
+00005d30: 6570 6172 6174 696f 6e20 2020 2020 2020  eparation       
+00005d40: 2020 2020 2020 2043 6f6d 7075 7465 2074         Compute t
+00005d50: 6865 2073 7461 7469 6f6e 7320 2073 6570  he stations  sep
+00005d60: 6172 6174 696f 6e73 202e 2020 2020 2020  arations .      
+00005d70: 0d0a 2020 2020 636f 6d70 7574 655f 6469  ..    compute_di
+00005d80: 706f 6c65 5c0d 0a20 2020 2020 2020 206c  pole\..        l
+00005d90: 656e 6774 685f 6672 6f6d 5f63 6f6f 7264  ength_from_coord
+00005da0: 7320 2020 2020 2063 6f6d 7075 7465 2064  s      compute d
+00005db0: 6970 6f6c 656c 656e 6774 680d 0a20 2020  ipolelength..   
+00005dc0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
+00005dd0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d20 203d 3d3d  ===========  ===
+00005de0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005df0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005e00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a 0d0a  ============....
+00005e10: 2020 2020 4d6f 7265 2061 7474 7269 6275      More attribu
+00005e20: 7465 7320 6361 6e20 6265 2061 6464 6564  tes can be added
+00005e30: 2062 7920 696e 7075 7469 6e67 2061 206b   by inputing a k
+00005e40: 6579 2077 6f72 6420 6469 6374 696f 6e61  ey word dictiona
+00005e50: 7279 0d0a 2020 2020 0d0a 2020 2020 3a45  ry..    ..    :E
+00005e60: 7861 6d70 6c65 3a20 0d0a 2020 2020 2020  xample: ..      
+00005e70: 2020 0d0a 2020 2020 2020 2020 3e3e 3e20    ..        >>> 
+00005e80: 6672 6f6d 2070 7963 7361 6d74 2e66 662e  from pycsamt.ff.
+00005e90: 7369 7465 2069 6d70 6f72 7420 5072 6f66  site import Prof
+00005ea0: 696c 6520 0d0a 2020 2020 2020 2020 3e3e  ile ..        >>
+00005eb0: 3e20 6669 6c65 5f73 746e 203d 2027 4b31  > file_stn = 'K1
+00005ec0: 2e73 746e 270d 0a20 2020 2020 2020 203e  .stn'..        >
+00005ed0: 3e3e 2070 6174 6820 3d20 206f 732e 7061  >> path =  os.pa
+00005ee0: 7468 2e6a 6f69 6e28 6f73 2e65 6e76 6972  th.join(os.envir
+00005ef0: 6f6e 5b22 7079 4353 414d 5422 5d2c 200d  on["pyCSAMT"], .
+00005f00: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00005f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f20: 2020 2770 7963 7361 6d74 272c 2764 6174    'pycsamt','dat
+00005f30: 6127 2c20 6669 6c65 5f73 746e 290d 0a20  a', file_stn).. 
+00005f40: 2020 2020 2020 203e 3e3e 2070 726f 6669         >>> profi
+00005f50: 6c65 203d 5072 6f66 696c 6520 2870 726f  le =Profile (pro
+00005f60: 6669 6c65 5f66 6e3d 7061 7468 290d 0a20  file_fn=path).. 
+00005f70: 2020 2020 2020 203e 3e3e 2070 726f 6669         >>> profi
+00005f80: 6c65 2e73 7472 6169 6768 7465 6e5f 7072  le.straighten_pr
+00005f90: 6f66 696c 656c 696e 6528 0d0a 2020 2020  ofileline(..    
+00005fa0: 2020 2020 2020 2020 583d 7072 6f66 696c          X=profil
+00005fb0: 652e 6561 7374 2c20 593d 7072 6f66 696c  e.east, Y=profil
+00005fc0: 652e 6e6f 7274 682c 7374 7261 6967 6874  e.north,straight
+00005fd0: 5f74 7970 653d 276e 2729 0d0a 2020 2020  _type='n')..    
+00005fe0: 2020 2020 3e3e 3e20 7072 6f66 696c 652e      >>> profile.
+00005ff0: 7265 7772 6974 655f 7374 6174 696f 6e5f  rewrite_station_
+00006000: 7072 6f66 696c 6528 0d0a 2020 2020 2020  profile(..      
+00006010: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+00006020: 2065 6173 7469 6e67 3d70 726f 6669 6c65   easting=profile
+00006030: 2e65 6173 742c 200d 0a20 2020 2020 2020  .east, ..       
+00006040: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+00006050: 6e6f 7274 6869 6e67 3d70 726f 6669 6c65  northing=profile
+00006060: 2e6e 6f72 7468 2c20 0d0a 2020 2020 2020  .north, ..      
+00006070: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+00006080: 2065 6c65 7661 7469 6f6e 203d 7072 6f66   elevation =prof
+00006090: 696c 652e 656c 6576 2c20 0d0a 2020 2020  ile.elev, ..    
+000060a0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+000060b0: 2020 2061 6464 5f61 7a69 6d75 7468 3d54     add_azimuth=T
+000060c0: 7275 6529 0d0a 2020 2020 2020 2020 3e3e  rue)..        >>
+000060d0: 3e20 7365 7061 7261 7469 6f6e 203d 2070  > separation = p
+000060e0: 726f 6669 6c65 2e73 746e 5f73 6570 6172  rofile.stn_separ
+000060f0: 6174 696f 6e28 0d0a 2020 2020 2020 2020  ation(..        
+00006100: 2e2e 2e20 2020 2065 6173 7469 6e67 203d  ...    easting =
+00006110: 2070 726f 6669 6c65 2e65 6173 742c 200d   profile.east, .
+00006120: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00006130: 6e6f 7274 6869 6e67 203d 7072 6f66 696c  northing =profil
+00006140: 652e 6e6f 7274 6829 0d0a 2020 2020 2222  e.north)..    ""
+00006150: 220d 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+00006160: 745f 5f28 7365 6c66 202c 2070 726f 6669  t__(self , profi
+00006170: 6c65 5f66 6e3d 4e6f 6e65 202c 2020 2a2a  le_fn=None ,  **
+00006180: 6b77 6172 6773 293a 0d0a 2020 2020 2020  kwargs):..      
+00006190: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+000061a0: 2e5f 6c6f 6767 696e 6720 3d20 6373 616d  ._logging = csam
+000061b0: 7470 796c 6f67 2e67 6574 5f63 7361 6d74  tpylog.get_csamt
+000061c0: 7079 5f6c 6f67 6765 7228 7365 6c66 2e5f  py_logger(self._
+000061d0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+000061e0: 5f29 0d0a 2020 2020 2020 2020 7365 6c66  _)..        self
+000061f0: 2e70 726f 6669 6c65 5f66 6e20 3d70 726f  .profile_fn =pro
+00006200: 6669 6c65 5f66 6e20 0d0a 2020 2020 2020  file_fn ..      
+00006210: 2020 7365 6c66 2e4c 6f63 6174 696f 6e20    self.Location 
+00006220: 3d4c 6f63 6174 696f 6e20 2829 0d0a 2020  =Location ()..  
+00006230: 2020 2020 2020 7365 6c66 2e53 6974 6520        self.Site 
+00006240: 3d53 6974 6528 290d 0a20 2020 2020 2020  =Site()..       
+00006250: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+00006260: 2e70 726f 6669 6c65 5f61 6e67 6c65 3d4e  .profile_angle=N
+00006270: 6f6e 650d 0a20 2020 2020 2020 2073 656c  one..        sel
+00006280: 662e 5f73 746e 5f70 6f73 6974 696f 6e20  f._stn_position 
+00006290: 3d4e 6f6e 6520 0d0a 0d0a 2020 2020 2020  =None ....      
+000062a0: 2020 7365 6c66 2e73 746e 5f69 6e74 6572    self.stn_inter
+000062b0: 7661 6c3d 4e6f 6e65 0d0a 2020 2020 2020  val=None..      
+000062c0: 2020 7365 6c66 2e64 6970 6f6c 655f 6c65    self.dipole_le
+000062d0: 6e67 7468 203d 4e6f 6e65 200d 0a20 2020  ngth =None ..   
+000062e0: 2020 2020 2073 656c 662e 617a 696d 7574       self.azimut
+000062f0: 6820 3d4e 6f6e 6520 0d0a 2020 2020 2020  h =None ..      
+00006300: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+00006310: 2e75 746d 5f7a 6f6e 6520 3d6b 7761 7267  .utm_zone =kwarg
+00006320: 732e 706f 7028 2775 746d 5f7a 6f6e 6527  s.pop('utm_zone'
+00006330: 2c20 2734 394e 2729 0d0a 2020 2020 2020  , '49N')..      
+00006340: 2020 7365 6c66 2e73 6176 6570 6174 6820    self.savepath 
+00006350: 3d6b 7761 7267 732e 706f 7028 2773 6176  =kwargs.pop('sav
+00006360: 6570 6174 6827 2c20 4e6f 6e65 290d 0a20  epath', None).. 
+00006370: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00006380: 2066 6f72 206b 6579 7320 696e 206c 6973   for keys in lis
+00006390: 7428 6b77 6172 6773 2e6b 6579 7328 2929  t(kwargs.keys())
+000063a0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000063b0: 7365 7461 7474 7228 7365 6c66 2c20 6b65  setattr(self, ke
+000063c0: 7973 2c20 6b77 6172 6773 5b6b 6579 735d  ys, kwargs[keys]
+000063d0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+000063e0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+000063f0: 6620 7365 6c66 2e70 726f 6669 6c65 5f66  f self.profile_f
+00006400: 6e20 6973 206e 6f74 204e 6f6e 6520 3a20  n is not None : 
+00006410: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00006420: 6c66 2e72 6561 645f 7374 6e70 726f 6669  lf.read_stnprofi
+00006430: 6c65 2829 0d0a 2020 2020 2020 2020 2020  le()..          
+00006440: 2020 0d0a 2020 2020 232d 2d2d 2d20 7365    ..    #---- se
+00006450: 7420 7072 6f66 696c 6520 7072 6f70 6572  t profile proper
+00006460: 7469 6573 202d 2d2d 2d2d 0d0a 2020 2020  ties -----..    
+00006470: 4070 726f 7065 7274 7920 0d0a 2020 2020  @property ..    
+00006480: 6465 6620 6c61 7420 2873 656c 6629 3a20  def lat (self): 
+00006490: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000064a0: 2073 656c 662e 4c6f 6361 7469 6f6e 2e6c   self.Location.l
+000064b0: 6174 6974 7564 6520 0d0a 2020 2020 4070  atitude ..    @p
+000064c0: 726f 7065 7274 7920 0d0a 2020 2020 6465  roperty ..    de
+000064d0: 6620 6c6f 6e20 2873 656c 6629 3a20 0d0a  f lon (self): ..
+000064e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000064f0: 656c 662e 4c6f 6361 7469 6f6e 2e6c 6f6e  elf.Location.lon
+00006500: 6769 7475 6465 200d 0a20 2020 2040 7072  gitude ..    @pr
+00006510: 6f70 6572 7479 200d 0a20 2020 2064 6566  operty ..    def
+00006520: 2065 6c65 7620 2873 656c 6629 3a20 0d0a   elev (self): ..
+00006530: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00006540: 656c 662e 4c6f 6361 7469 6f6e 2e65 6c65  elf.Location.ele
+00006550: 7661 7469 6f6e 2020 0d0a 2020 2020 4070  vation  ..    @p
+00006560: 726f 7065 7274 7920 0d0a 2020 2020 6465  roperty ..    de
+00006570: 6620 6e6f 7274 6820 2873 656c 6629 3a20  f north (self): 
+00006580: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00006590: 2073 656c 662e 4c6f 6361 7469 6f6e 2e6e   self.Location.n
+000065a0: 6f72 7468 696e 670d 0a20 2020 2040 7072  orthing..    @pr
+000065b0: 6f70 6572 7479 200d 0a20 2020 2064 6566  operty ..    def
+000065c0: 2065 6173 7420 2873 656c 6629 3a20 0d0a   east (self): ..
+000065d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000065e0: 656c 662e 4c6f 6361 7469 6f6e 2e65 6173  elf.Location.eas
+000065f0: 7469 6e67 200d 0a20 2020 2040 7072 6f70  ting ..    @prop
+00006600: 6572 7479 200d 0a20 2020 2064 6566 2073  erty ..    def s
+00006610: 746e 5f70 6f73 6974 696f 6e20 2873 656c  tn_position (sel
+00006620: 6629 3a20 0d0a 2020 2020 2020 2020 7265  f): ..        re
+00006630: 7475 726e 2073 656c 662e 4c6f 6361 7469  turn self.Locati
+00006640: 6f6e 2e73 746e 5f70 6f73 0d0a 2020 0d0a  on.stn_pos..  ..
+00006650: 2020 2020 2320 2d2d 2d2d 2073 6574 2066      # ---- set f
+00006660: 756e 6374 696f 6e73 202d 2d2d 2d0d 0a20  unctions ----.. 
+00006670: 2020 2040 6c61 742e 7365 7474 6572 200d     @lat.setter .
+00006680: 0a20 2020 2064 6566 206c 6174 2873 656c  .    def lat(sel
+00006690: 662c 206c 6174 6974 7564 6529 3a20 0d0a  f, latitude): ..
+000066a0: 2020 2020 2020 2020 7365 6c66 2e4c 6f63          self.Loc
+000066b0: 6174 696f 6e2e 6c61 7469 7475 6465 203d  ation.latitude =
+000066c0: 6c61 7469 7475 6465 200d 0a0d 0a20 2020  latitude ....   
+000066d0: 2040 6c6f 6e2e 7365 7474 6572 200d 0a20   @lon.setter .. 
+000066e0: 2020 2064 6566 206c 6f6e 2028 7365 6c66     def lon (self
+000066f0: 2c20 6c6f 6e67 6974 7564 6529 3a20 0d0a  , longitude): ..
+00006700: 2020 2020 2020 2020 7365 6c66 2e4c 6f63          self.Loc
+00006710: 6174 696f 6e2e 6c6f 6e67 6974 7564 6520  ation.longitude 
+00006720: 3d20 6c6f 6e67 6974 7564 6520 0d0a 0d0a  = longitude ....
+00006730: 2020 2020 406e 6f72 7468 2e73 6574 7465      @north.sette
+00006740: 7220 0d0a 2020 2020 6465 6620 6e6f 7274  r ..    def nort
+00006750: 6820 2873 656c 662c 206e 6f72 7468 696e  h (self, northin
+00006760: 6729 3a20 0d0a 2020 2020 2020 2020 7365  g): ..        se
+00006770: 6c66 2e4c 6f63 6174 696f 6e2e 6e6f 7274  lf.Location.nort
+00006780: 6869 6e67 203d 6e6f 7274 6869 6e67 0d0a  hing =northing..
+00006790: 2020 2020 2020 2020 0d0a 2020 2020 4065          ..    @e
+000067a0: 6173 742e 7365 7474 6572 200d 0a20 2020  ast.setter ..   
+000067b0: 2064 6566 2065 6173 7428 7365 6c66 2c20   def east(self, 
+000067c0: 6561 7374 696e 6729 3a20 0d0a 2020 2020  easting): ..    
+000067d0: 2020 2020 7365 6c66 2e4c 6f63 6174 696f      self.Locatio
+000067e0: 6e2e 6561 7374 696e 6720 3d20 6561 7374  n.easting = east
+000067f0: 696e 670d 0a20 0d0a 2020 2020 4065 6c65  ing.. ..    @ele
+00006800: 762e 7365 7474 6572 200d 0a20 2020 2064  v.setter ..    d
+00006810: 6566 2065 6c65 7620 2873 656c 662c 2065  ef elev (self, e
+00006820: 6c65 7661 7469 6f6e 293a 200d 0a20 2020  levation): ..   
+00006830: 2020 2020 2073 656c 662e 4c6f 6361 7469       self.Locati
+00006840: 6f6e 2e65 6c65 7661 7469 6f6e 203d 2065  on.elevation = e
+00006850: 6c65 7661 7469 6f6e 200d 0a20 2020 2040  levation ..    @
+00006860: 7374 6e5f 706f 7369 7469 6f6e 2e73 6574  stn_position.set
+00006870: 7465 7220 0d0a 2020 2020 6465 6620 7374  ter ..    def st
+00006880: 6e5f 706f 7369 7469 6f6e 2028 7365 6c66  n_position (self
+00006890: 2c20 706f 7369 7469 6f6e 5f61 7272 6179  , position_array
+000068a0: 293a 200d 0a20 2020 2020 2020 2073 656c  ): ..        sel
+000068b0: 662e 4c6f 6361 7469 6f6e 2e73 746e 5f70  f.Location.stn_p
+000068c0: 6f73 203d 2070 6f73 6974 696f 6e5f 6172  os = position_ar
+000068d0: 7261 790d 0a0d 0a20 2020 2020 2020 200d  ray....        .
+000068e0: 0a20 2020 2064 6566 2072 6561 645f 7374  .    def read_st
+000068f0: 6e70 726f 6669 6c65 2028 7365 6c66 2c20  nprofile (self, 
+00006900: 7072 6f66 696c 655f 666e 203d 4e6f 6e65  profile_fn =None
+00006910: 202c 0d0a 2020 2020 2020 2020 2020 2020   ,..            
+00006920: 2020 2020 2020 2020 2020 2020 2065 6173               eas
+00006930: 7469 6e67 3d4e 6f6e 6520 2c20 6e6f 7274  ting=None , nort
+00006940: 6869 6e67 3d4e 6f6e 6520 2c0d 0a20 2020  hing=None ,..   
+00006950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006960: 2020 2020 2020 656c 6576 6174 696f 6e20        elevation 
+00006970: 3d4e 6f6e 6520 2c20 7370 6c69 745f 7479  =None , split_ty
+00006980: 7065 3d4e 6f6e 652c 0d0a 2020 2020 2020  pe=None,..      
+00006990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000069a0: 2020 202a 2a6b 7761 7267 7329 3a0d 0a20     **kwargs):.. 
+000069b0: 2020 2020 2020 2022 2222 200d 0a20 2020         """ ..   
+000069c0: 2020 2020 204d 6574 686f 6420 746f 2072       Method to r
+000069d0: 6561 6420 7072 6f66 696c 6520 7374 6174  ead profile stat
+000069e0: 696f 6e20 6669 6c65 2e0d 0a20 2020 2020  ion file...     
+000069f0: 2020 2075 7365 7220 6361 6e20 7573 6520     user can use 
+00006a00: 6974 7320 7370 6563 6961 6c20 6669 6c65  its special file
+00006a10: 202e 7573 6572 2063 616e 2073 7065 6369   .user can speci
+00006a20: 6679 200d 0a20 2020 2020 2020 2061 2068  fy ..        a h
+00006a30: 6561 6420 6f66 2069 7473 2066 696c 652e  ead of its file.
+00006a40: 206d 6574 686f 6420 7769 6c6c 2072 6561   method will rea
+00006a50: 6420 616e 6420 7769 6c6c 2070 6172 7365  d and will parse
+00006a60: 200d 0a20 2020 2020 2020 2065 6173 7469   ..        easti
+00006a70: 6e67 202c 206e 6f72 7468 696e 6720 2c20  ng , northing , 
+00006a80: 656c 6576 6174 696f 6e20 2c20 6f72 200d  elevation , or .
+00006a90: 0a20 2020 2020 2020 206c 6f6e 2c20 6c61  .        lon, la
+00006aa0: 742c 2065 6c65 7620 6f72 2073 7461 7469  t, elev or stati
+00006ab0: 6f6e 202e 2055 7365 7220 6361 6e20 616c  on . User can al
+00006ac0: 736f 2070 726f 7669 6465 6420 0d0a 2020  so provided ..  
+00006ad0: 2020 2020 2020 6561 7374 696e 6720 2c20        easting , 
+00006ae0: 6e6f 7274 6869 6e67 2061 6e64 2065 6c65  northing and ele
+00006af0: 7661 7469 6f6e 2076 616c 7565 202e 200d  vation value . .
+00006b00: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00006b10: 2020 2050 6172 616d 6574 6572 7320 200d     Parameters  .
+00006b20: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006b30: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2020  ----..          
+00006b40: 2020 2a20 7072 6f66 696c 655f 666e 203a    * profile_fn :
+00006b50: 7374 7220 0d0a 2020 2020 2020 2020 2020  str ..          
+00006b60: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00006b70: 7468 2074 6f20 7374 6174 696f 6e20 7072  th to station pr
+00006b80: 6f66 696c 6520 6669 6c65 200d 0a20 2020  ofile file ..   
+00006b90: 2020 2020 2020 2020 202a 2073 706c 6974           * split
+00006ba0: 5f74 7970 6520 3a73 7472 200d 0a20 2020  _type :str ..   
+00006bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006bc0: 2020 2020 2048 6f77 2064 6174 6120 6973       How data is
+00006bd0: 2073 6570 6172 6564 202e 200d 0a20 2020   separed . ..   
 00006be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006bf0: 2070 6174 6820 746f 2073 7461 7469 6f6e   path to station
-00006c00: 2070 726f 6669 6c65 2066 696c 6520 0d0a   profile file ..
-00006c10: 2020 2020 2020 2020 2020 2020 2a20 7370              * sp
-00006c20: 6c69 745f 7479 7065 203a 7374 7220 0d0a  lit_type :str ..
+00006bf0: 2020 2020 2044 6566 6175 6c74 2020 6973       Default  is
+00006c00: 2022 222e 0d0a 2020 2020 2020 2020 2020   ""...          
+00006c10: 2020 2a20 6561 7374 696e 6720 3a20 6172    * easting : ar
+00006c20: 7261 795f 6c69 6b65 2020 0d0a 2020 2020  ray_like  ..    
 00006c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c40: 2020 2020 2020 2020 486f 7720 6461 7461          How data
-00006c50: 2069 7320 7365 7061 7265 6420 2e20 0d0a   is separed . ..
-00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c70: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-00006c80: 2069 7320 2222 2e0d 0a20 2020 2020 2020   is ""...       
-00006c90: 2020 2020 202a 2065 6173 7469 6e67 203a       * easting :
-00006ca0: 2061 7272 6179 5f6c 696b 6520 200d 0a20   array_like  .. 
-00006cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006cc0: 2020 2020 2020 2065 6173 7469 6e67 2063         easting c
-00006cd0: 6f6f 7264 696e 6174 6520 286d 292c 200d  oordinate (m), .
-00006ce0: 0a20 2020 2020 2020 2020 2020 202a 206e  .            * n
-00006cf0: 6f72 7468 696e 6720 3a20 6172 7261 795f  orthing : array_
-00006d00: 6c69 6b65 2020 0d0a 2020 2020 2020 2020  like  ..        
-00006d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d20: 6e6f 7274 6869 6e67 2063 6f6f 7264 696e  northing coordin
-00006d30: 6174 6520 7661 6c75 6520 286d 290d 0a20  ate value (m).. 
-00006d40: 2020 2020 2020 2020 2020 202a 206c 6174             * lat
-00006d50: 203a 2061 7272 6179 5f6c 696b 6520 0d0a   : array_like ..
-00006d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006d70: 2020 2020 6c61 7469 7475 6465 2063 6f6f      latitude coo
-00006d80: 7264 696e 6174 6520 696e 2064 6567 7265  rdinate in degre
-00006d90: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-00006da0: 2a20 6c6f 6e20 3a20 6172 7261 795f 6c69  * lon : array_li
-00006db0: 6b65 2020 0d0a 2020 2020 2020 2020 2020  ke  ..          
-00006dc0: 2020 2020 2020 2020 2020 6c6f 6e67 6974            longit
-00006dd0: 7564 6520 636f 6f72 6469 6e61 7465 2069  ude coordinate i
-00006de0: 6e20 6465 6772 6565 0d0a 2020 2020 2020  n degree..      
-00006df0: 2020 2020 2020 2a20 617a 696d 203a 2061        * azim : a
-00006e00: 7272 6179 5f6c 696b 6520 2c0d 0a20 2020  rray_like ,..   
-00006e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e20: 2061 7a69 6d75 7468 2069 6e20 6465 6772   azimuth in degr
-00006e30: 6565 200d 0a20 2020 2020 2020 2020 2020  ee ..           
-00006e40: 2020 2020 2020 2020 2049 6620 6e6f 7420           If not 
-00006e50: 7072 6f76 6964 6564 2063 616e 2063 6f6d  provided can com
-00006e60: 7075 7465 6420 6175 746f 6d61 7469 6361  puted automatica
-00006e70: 6c6c 7920 0d0a 2020 2020 2020 2020 2020  lly ..          
-00006e80: 2020 2a20 7574 6d5f 7a6f 6e65 203a 7374    * utm_zone :st
-00006e90: 7220 2020 2020 200d 0a20 2020 2020 2020  r      ..       
-00006ea0: 2020 2020 2020 2020 2020 2020 2073 7572               sur
-00006eb0: 7665 7920 7574 6d20 7a6f 6e65 200d 0a20  vey utm zone .. 
-00006ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ed0: 2020 2069 6620 6e6f 7420 706f 7276 6964     if not porvid
-00006ee0: 6564 2061 6e64 206c 6174 2061 6e64 206c  ed and lat and l
-00006ef0: 6f6e 2069 7320 7365 7420 2c0d 0a20 2020  on is set ,..   
-00006f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006f10: 2063 616e 2063 6f6d 7075 7465 2061 7574   can compute aut
-00006f20: 6f6d 6174 6963 616c 6c79 200d 0a20 2020  omatically ..   
-00006f30: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00006f40: 2020 6c61 7420 3d20 6b77 6172 6773 2e70    lat = kwargs.p
-00006f50: 6f70 2827 6c61 7469 7475 6465 272c 204e  op('latitude', N
-00006f60: 6f6e 6529 0d0a 2020 2020 2020 2020 6c6f  one)..        lo
-00006f70: 6e20 3d20 6b77 6172 6773 2e70 6f70 2827  n = kwargs.pop('
-00006f80: 6c6f 6e67 6974 7564 6527 2c20 4e6f 6e65  longitude', None
-00006f90: 290d 0a20 2020 2020 2020 2061 7a69 6d20  )..        azim 
-00006fa0: 3d6b 7761 7267 732e 706f 7028 2761 7a69  =kwargs.pop('azi
-00006fb0: 6d75 7468 272c 204e 6f6e 6529 0d0a 2020  muth', None)..  
-00006fc0: 2020 2020 2020 7574 6d5f 7a6f 6e65 203d        utm_zone =
-00006fd0: 6b77 6172 6773 2e70 6f70 2827 7574 6d5f  kwargs.pop('utm_
-00006fe0: 7a6f 6e65 272c 204e 6f6e 6529 0d0a 2020  zone', None)..  
-00006ff0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00007000: 6966 2075 746d 5f7a 6f6e 6520 6973 206e  if utm_zone is n
-00007010: 6f74 204e 6f6e 6520 3a20 7365 6c66 2e75  ot None : self.u
-00007020: 746d 5f7a 6f6e 6520 3d20 7574 6d5f 7a6f  tm_zone = utm_zo
-00007030: 6e65 0d0a 0d0a 2020 2020 2020 2020 5f70  ne....        _p
-00007040: 666c 6167 203d 300d 0a20 2020 2020 2020  flag =0..       
-00007050: 2069 6620 7072 6f66 696c 655f 666e 2069   if profile_fn i
-00007060: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
-00007070: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00007080: 7072 6f66 696c 655f 666e 203d 7072 6f66  profile_fn =prof
-00007090: 696c 655f 666e 0d0a 0d0a 2020 2020 2020  ile_fn....      
-000070a0: 2020 6966 2073 656c 662e 7072 6f66 696c    if self.profil
-000070b0: 655f 666e 2069 7320 6e6f 7420 4e6f 6e65  e_fn is not None
-000070c0: 203a 205f 7066 6c61 6720 3d20 310d 0a20   : _pflag = 1.. 
-000070d0: 2020 2020 2020 2065 6c69 6620 6561 7374         elif east
-000070e0: 696e 6720 6973 206e 6f74 204e 6f6e 6520  ing is not None 
-000070f0: 616e 6420 6e6f 7274 6869 6e67 2069 7320  and northing is 
-00007100: 6e6f 7420 4e6f 6e65 203a 205f 7066 6c61  not None : _pfla
-00007110: 6720 3d20 320d 0a20 2020 2020 2020 2065  g = 2..        e
-00007120: 6c69 6620 6c61 7420 6973 206e 6f74 204e  lif lat is not N
-00007130: 6f6e 6520 616e 6420 6c6f 6e20 6973 206e  one and lon is n
-00007140: 6f74 204e 6f6e 6520 3a20 5f70 666c 6167  ot None : _pflag
-00007150: 203d 2033 0d0a 2020 2020 2020 2020 656c   = 3..        el
-00007160: 6966 2073 656c 662e 7072 6f66 696c 655f  if self.profile_
-00007170: 666e 2020 6973 204e 6f6e 6520 616e 6420  fn  is None and 
-00007180: 2865 6173 7469 6e67 2069 7320 6e6f 7420  (easting is not 
-00007190: 4e6f 6e65 206f 7220 0d0a 2020 2020 2020  None or ..      
-000071a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000071b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000071c0: 2020 2020 206e 6f72 7468 696e 6720 6973       northing is
-000071d0: 204e 6f6e 6529 2061 6e64 205c 0d0a 2020   None) and \..  
-000071e0: 2020 2020 2020 2020 2020 286c 6174 2069            (lat i
-000071f0: 7320 4e6f 6e65 206f 7220 6c6f 6e20 6973  s None or lon is
-00007200: 204e 6f6e 6529 203a 200d 0a20 2020 2020   None) : ..     
-00007210: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-00007220: 782e 7079 4353 414d 5445 7272 6f72 5f70  x.pyCSAMTError_p
-00007230: 726f 6669 6c65 280d 0a20 2020 2020 2020  rofile(..       
-00007240: 2020 2020 2020 2020 2027 5072 6f76 6964           'Provid
-00007250: 6564 2061 7420 6c65 6173 7420 6561 7374  ed at least east
-00007260: 696e 6720 6f72 206c 6f6e 206f 7220 4e6f  ing or lon or No
-00007270: 7274 6869 6e67 270d 0a20 2020 2020 2020  rthing'..       
-00007280: 2020 2020 2020 2020 2027 206f 7220 6c61           ' or la
-00007290: 7420 7661 6c75 6520 6f72 2070 726f 6669  t value or profi
-000072a0: 6c65 2073 746e 2066 696c 652e 2729 2020  le stn file.')  
-000072b0: 2020 0d0a 2020 2020 2020 2020 0d0a 0d0a    ..        ....
-000072c0: 2020 2020 2020 2020 6966 205f 7066 6c61          if _pfla
-000072d0: 6720 3d3d 313a 0d0a 2020 2020 2020 2020  g ==1:..        
-000072e0: 2020 2020 6966 2069 6e46 4f2e 5f73 656e      if inFO._sen
-000072f0: 7369 7469 7665 2e77 6869 6368 5f66 696c  sitive.which_fil
-00007300: 6528 6669 6c65 6e61 6d65 203d 7365 6c66  e(filename =self
-00007310: 2e70 726f 6669 6c65 5f66 6e20 2920 3d3d  .profile_fn ) ==
-00007320: 2773 746e 273a 200d 0a20 2020 2020 2020  'stn': ..       
-00007330: 2020 2020 2020 2020 2072 6566 3d27 6e6f           ref='no
-00007340: 6e65 2720 0d0a 2020 2020 2020 2020 2020  ne' ..          
-00007350: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
-00007360: 2e62 6173 656e 616d 6528 7365 6c66 2e70  .basename(self.p
-00007370: 726f 6669 6c65 5f66 6e29 2e66 696e 6428  rofile_fn).find(
-00007380: 275f 7265 616a 2729 203e 3d30 2020 6f72  '_reaj') >=0  or
-00007390: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
-000073a0: 2020 2020 2020 206f 732e 7061 7468 2e62         os.path.b
-000073b0: 6173 656e 616d 6528 7365 6c66 2e70 726f  asename(self.pro
-000073c0: 6669 6c65 5f66 6e29 2e66 696e 6428 275f  file_fn).find('_
-000073d0: 636f 7227 2920 3e3d 3020 6f72 205c 0d0a  cor') >=0 or \..
-000073e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073f0: 2020 2020 2020 2020 6f73 2e70 6174 682e          os.path.
-00007400: 6261 7365 6e61 6d65 2873 656c 662e 7072  basename(self.pr
-00007410: 6f66 696c 655f 666e 292e 6669 6e64 2827  ofile_fn).find('
-00007420: 5f73 6361 2729 203e 3d30 203a 200d 0a20  _sca') >=0 : .. 
-00007430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007440: 2020 2072 6566 203d 2773 6361 6c6c 6564     ref ='scalled
-00007450: 270d 0a20 2020 0d0a 2020 2020 2020 2020  '..   ..        
-00007460: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
-00007470: 6e28 7365 6c66 2e70 726f 6669 6c65 5f66  n(self.profile_f
-00007480: 6e2c 2027 7227 2c20 656e 636f 6469 6e67  n, 'r', encoding
-00007490: 3d27 7574 6638 2729 2061 7320 666e 203a  ='utf8') as fn :
-000074a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000074b0: 2020 2020 2020 6461 7461 5f6c 696e 6573        data_lines
-000074c0: 203d 666e 2e72 6561 646c 696e 6573 2028   =fn.readlines (
-000074d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000074e0: 2020 2020 2020 2023 2069 6620 7573 6572         # if user
-000074f0: 2064 6f65 736e 7420 7072 6f76 6964 6520   doesnt provide 
-00007500: 7468 6520 7370 6c69 7420 7479 7065 203a  the split type :
-00007510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007520: 2020 2020 2020 2020 2020 2320 7072 6f67            # prog
-00007530: 7261 6d20 7769 6c6c 2073 6561 7263 6820  ram will search 
-00007540: 6175 746f 6d61 7469 6361 6c6c 7920 0d0a  automatically ..
-00007550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007560: 2020 2020 6966 2073 706c 6974 5f74 7970      if split_typ
-00007570: 6520 6973 204e 6f6e 6520 3a20 0d0a 2020  e is None : ..  
-00007580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007590: 2020 2020 2020 7370 6c69 745f 7479 7065        split_type
-000075a0: 203d 2066 756e 632e 7374 6e5f 6368 6563   = func.stn_chec
-000075b0: 6b5f 7370 6c69 745f 7479 7065 280d 0a20  k_split_type(.. 
-000075c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075d0: 2020 2020 2020 2020 2020 2064 6174 615f             data_
-000075e0: 6c69 6e65 733d 6461 7461 5f6c 696e 6573  lines=data_lines
-000075f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00007600: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00007610: 2020 2020 2020 2020 2020 2020 2023 2069               # i
-00007620: 6e20 7468 6520 6361 7365 2077 6865 7265  n the case where
-00007630: 2075 7365 7220 7072 6f76 6964 6520 7468   user provide th
-00007640: 6520 6669 6c65 2077 7269 7474 656e 2062  e file written b
-00007650: 7920 0d0a 2020 2020 2020 2020 2020 2020  y ..            
-00007660: 2020 2020 2020 2020 2374 6861 7420 736f          #that so
-00007670: 6674 7761 7265 202c 6967 6e6f 7265 2074  ftware ,ignore t
-00007680: 6865 2020 2368 6561 6c69 6e65 7320 7374  he  #healines st
-00007690: 6172 7420 6279 2027 3e20 6f72 2027 210d  art by '> or '!.
-000076a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000076b0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-000076c0: 2020 2020 2020 2020 2020 7465 6d70 3d5b            temp=[
-000076d0: 5d20 2020 2020 2020 2020 2020 2020 2320  ]             # 
-000076e0: 7265 6275 696c 6420 6120 6e65 7720 6461  rebuild a new da
-000076f0: 7461 206c 696e 6573 2066 6f72 2073 6166  ta lines for saf
-00007700: 6574 790d 0a20 2020 2020 2020 2020 2020  ety..           
-00007710: 2020 2020 2020 2020 2066 6f72 2068 6820           for hh 
-00007720: 2c20 7661 6c75 6573 2020 696e 2065 6e75  , values  in enu
-00007730: 6d65 7261 7465 2864 6174 615f 6c69 6e65  merate(data_line
-00007740: 7329 203a 200d 0a20 2020 2020 2020 2020  s) : ..         
-00007750: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00007760: 6620 7265 2e6d 6174 6368 2872 275e 3e27  f re.match(r'^>'
-00007770: 2c20 7661 6c75 6573 2920 6973 206e 6f74  , values) is not
-00007780: 204e 6f6e 6520 6f72 5c0d 0a20 2020 2020   None or\..     
-00007790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077a0: 2020 2020 2020 2072 652e 6d61 7463 6828         re.match(
-000077b0: 2772 5e21 272c 2076 616c 7565 7329 2069  'r^!', values) i
-000077c0: 7320 206e 6f74 204e 6f6e 6520 5c0d 0a20  s  not None \.. 
-000077d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077e0: 2020 2020 2020 2020 2020 206f 7220 7661             or va
-000077f0: 6c75 6573 2e66 696e 6428 272b 2b2b 2b2b  lues.find('+++++
-00007800: 2b2b 2b27 2920 3e3d 3020 203a 2070 6173  +++') >=0  : pas
-00007810: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
-00007820: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00007830: 203a 7465 6d70 2e61 7070 656e 6428 7661   :temp.append(va
-00007840: 6c75 6573 290d 0a20 2020 2020 2020 2020  lues)..         
-00007850: 2020 2020 2020 2020 2020 2069 6620 276c             if 'l
-00007860: 656e 2720 696e 2074 656d 705b 305d 2061  en' in temp[0] a
-00007870: 6e64 2027 7374 6127 2069 6e20 7465 6d70  nd 'sta' in temp
-00007880: 5b30 5d20 616e 6420 2761 7a69 6d27 205c  [0] and 'azim' \
-00007890: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000078a0: 2020 2020 2020 2020 2020 696e 2074 656d            in tem
-000078b0: 705b 305d 203a 200d 0a20 2020 2020 2020  p[0] : ..       
-000078c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000078d0: 2072 6566 203d 2770 7943 5341 4d54 2720   ref ='pyCSAMT' 
-000078e0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-000078f0: 2020 2020 2020 2020 2064 6174 615f 6c69           data_li
-00007900: 6e65 733d 7465 6d70 0d0a 2020 2020 2020  nes=temp..      
-00007910: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-00007920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007930: 2020 2020 6465 6369 7369 6f6e 202c 2073      decision , s
-00007940: 746e 5f68 6561 646c 696e 6573 5f69 6420  tn_headlines_id 
-00007950: 3d20 6366 756e 632e 5f76 616c 6964 6174  = cfunc._validat
-00007960: 655f 7374 6e70 726f 6669 6c65 280d 0a20  e_stnprofile(.. 
-00007970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007980: 2020 2020 2020 2070 726f 6669 6c65 5f6c         profile_l
-00007990: 696e 6573 3d20 6461 7461 5f6c 696e 6573  ines= data_lines
-000079a0: 202c 2073 706c 6974 696e 673d 7370 6c69   , spliting=spli
-000079b0: 745f 7479 7065 290d 0a20 2020 2020 2020  t_type)..       
-000079c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000079d0: 6465 6369 7369 6f6e 203c 323a 0d0a 2020  decision <2:..  
-000079e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000079f0: 2020 2020 2020 7261 6973 6520 4353 6578        raise CSex
-00007a00: 2e70 7943 5341 4d54 4572 726f 725f 7072  .pyCSAMTError_pr
-00007a10: 6f66 696c 6528 0d0a 2020 2020 2020 2020  ofile(..        
-00007a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a30: 2020 2020 2750 6c65 6173 6520 7072 6f76      'Please prov
-00007a40: 6964 6520 6174 206c 6561 7374 2074 6865  ide at least the
-00007a50: 2045 6173 7469 6e67 270d 0a20 2020 2020   Easting'..     
-00007a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a70: 2020 2020 2020 2020 2720 616e 6420 6e6f          ' and no
-00007a80: 7274 6869 6e67 2063 6f6f 7264 696e 6174  rthing coordinat
-00007a90: 6573 206f 7220 7365 7420 7468 6520 270d  es or set the '.
-00007aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007ab0: 2020 2020 2020 2020 2020 2020 2020 276c                'l
-00007ac0: 6174 2f6c 6f6e 2076 616c 7565 7320 746f  at/lon values to
-00007ad0: 2070 6172 7365 2074 6865 2064 6174 612e   parse the data.
-00007ae0: 2027 290d 0a20 2020 2020 2020 2020 2020   ')..           
-00007af0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00007b00: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
-00007b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b20: 2020 2020 2020 2064 6174 615f 6c69 7374         data_list
-00007b30: 5f6f 665f 6172 7261 793d 205b 6e70 2e61  _of_array= [np.a
-00007b40: 7272 6179 2028 0d0a 2020 2020 2020 2020  rray (..        
-00007b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b60: 2020 2020 6c69 6e65 2e73 7472 6970 2829      line.strip()
-00007b70: 2e73 706c 6974 2873 706c 6974 5f74 7970  .split(split_typ
-00007b80: 6529 2920 0d0a 2020 2020 2020 2020 2020  e)) ..          
-00007b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ba0: 2020 2020 2066 6f72 2069 692c 2020 6c69       for ii,  li
-00007bb0: 6e65 2069 6e20 656e 756d 6572 6174 6528  ne in enumerate(
-00007bc0: 6461 7461 5f6c 696e 6573 295d 0d0a 0d0a  data_lines)]....
-00007bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007be0: 2020 2020 2020 2020 6461 7461 5f61 7272          data_arr
-00007bf0: 6179 203d 6675 6e63 2e63 6f6e 6361 745f  ay =func.concat_
-00007c00: 6172 7261 795f 6672 6f6d 5f6c 6973 7428  array_from_list(
-00007c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007c20: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00007c30: 7374 5f6f 665f 6172 7261 793d 6461 7461  st_of_array=data
-00007c40: 5f6c 6973 745f 6f66 5f61 7272 6179 2c20  _list_of_array, 
-00007c50: 636f 6e63 6174 5f61 7869 733d 3029 0d0a  concat_axis=0)..
-00007c60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007c70: 2020 666f 7220 6c61 622c 2069 6e64 6578    for lab, index
-00007c80: 2069 6e20 7374 6e5f 6865 6164 6c69 6e65   in stn_headline
-00007c90: 735f 6964 3a20 0d0a 2020 2020 2020 2020  s_id: ..        
-00007ca0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00007cb0: 6566 203d 3d27 7363 616c 6c65 6427 3a20  ef =='scalled': 
-00007cc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007cd0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00007ce0: 6773 2e77 6172 6e28 0d0a 2020 2020 2020  gs.warn(..      
-00007cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d00: 2020 2020 2020 2249 7420 7365 656d 7320        "It seems 
-00007d10: 7468 6520 7072 6f66 696c 6520 6461 7461  the profile data
-00007d20: 2069 7320 616c 7265 6164 7922 0d0a 2020   is already"..  
-00007d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d40: 2020 2020 2020 2020 2020 2273 6361 6c65            "scale
-00007d50: 642e 2050 6c65 6173 6520 7573 6520 2074  d. Please use  t
-00007d60: 6865 206d 6574 686f 6420 220d 0a20 2020  he method "..   
-00007d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d80: 2020 2020 2020 2020 2022 3c70 7963 7361           "<pycsa
-00007d90: 6d74 2e73 6974 652e 5072 6f66 696c 652e  mt.site.Profile.
-00007da0: 7265 616a 7573 745f 636f 6f72 6469 6e61  reajust_coordina
-00007db0: 7465 735f 7661 6c75 653e 220d 0a20 2020  tes_value>"..   
-00007dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007dd0: 2020 2020 2020 2020 2022 2074 6f20 666f           " to fo
-00007de0: 7263 6520 7363 616c 696e 672e 2229 0d0a  rce scaling.")..
-00007df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e00: 2020 2020 2020 2020 636f 6f72 6473 5f61          coords_a
-00007e10: 7272 6179 203d 2064 6174 615f 6172 7261  rray = data_arra
-00007e20: 795b 313a 2c20 696e 6465 785d 0d0a 2020  y[1:, index]..  
-00007e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e40: 2020 656c 7365 203a 200d 0a20 2020 2020    else : ..     
-00007e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e60: 2020 2073 656c 662e 5f6c 6f67 6769 6e67     self._logging
-00007e70: 2e69 6e66 6f28 0d0a 2020 2020 2020 2020  .info(..        
-00007e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e90: 2020 2020 2752 6573 6361 6c69 6e67 2073      'Rescaling s
-00007ea0: 7461 7469 6f6e 2070 6f73 6974 696f 6e73  tation positions
-00007eb0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00007ec0: 2020 2020 2020 2020 2020 2027 2066 726f             ' fro
-00007ed0: 6d20 6669 6c65 203c 2573 3e27 2520 6f73  m file <%s>'% os
-00007ee0: 2e70 6174 682e 6261 7365 6e61 6d65 2873  .path.basename(s
-00007ef0: 656c 662e 7072 6f66 696c 655f 666e 2929  elf.profile_fn))
-00007f00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007f10: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00007f20: 6773 2e77 6172 6e28 0d0a 2020 2020 2020  gs.warn(..      
-00007f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f40: 2020 2720 5a6f 6e67 6520 4861 7264 7761    ' Zonge Hardwa
-00007f50: 7265 2075 7375 616c 6c79 2070 726f 7669  re usually provi
-00007f60: 6465 7320 7468 6520 7374 6174 696f 6e20  des the station 
-00007f70: 6c6f 6361 7469 6f6e 7320 270d 0a20 2020  locations '..   
-00007f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f90: 2020 2020 2027 2061 7420 6561 6368 2065       ' at each e
-00007fa0: 6c65 6374 726f 6465 206c 6f63 6174 696f  lectrode locatio
-00007fb0: 6e20 7261 7468 6572 2074 6861 6e20 7468  n rather than th
-00007fc0: 6520 6365 6e74 6572 206f 6620 270d 0a20  e center of '.. 
-00007fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007fe0: 2020 2020 2020 2027 6469 706f 6c65 732e         'dipoles.
-00007ff0: 204c 6f63 6174 696f 6e73 2073 686f 756c   Locations shoul
-00008000: 6420 6d6f 7665 2074 6f20 7468 6520 6469  d move to the di
-00008010: 706f 6c65 2063 656e 7465 722e 270d 0a20  pole center.'.. 
-00008020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008030: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00008040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008050: 2020 2320 7472 7920 3a0d 0a20 2020 2020    # try :..     
-00008060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008070: 2020 2063 6f6f 7264 735f 6172 7261 7920     coords_array 
-00008080: 3d63 6675 6e63 2e64 6970 6f6c 655f 6365  =cfunc.dipole_ce
-00008090: 6e74 6572 5f70 6f73 6974 696f 6e28 0d0a  nter_position(..
-000080a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000080b0: 2020 2020 2020 2020 2020 2020 6469 706f              dipo
-000080c0: 6c65 5f70 6f73 6974 696f 6e20 3d20 6461  le_position = da
-000080d0: 7461 5f61 7272 6179 5b31 3a2c 696e 6465  ta_array[1:,inde
-000080e0: 785d 290d 0a20 2020 2020 2020 2020 2020  x])..           
-000080f0: 2020 2020 2020 2020 2020 2020 2023 2065               # e
-00008100: 7863 6570 7420 3a70 6173 7320 0d0a 200d  xcept :pass .. .
-00008110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008120: 2020 2020 2069 6620 6c61 6220 3d3d 2069       if lab == i
-00008130: 6e46 4f2e 7375 6974 2e65 6173 7469 6e67  nFO.suit.easting
-00008140: 5b30 5d20 6f72 5c0d 0a20 2020 2020 2020  [0] or\..       
-00008150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008160: 206c 6162 2e6c 6f77 6572 2829 2e66 696e   lab.lower().fin
-00008170: 6428 2765 6173 7427 293e 3d30 203a 200d  d('east')>=0 : .
-00008180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008190: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
-000081a0: 7365 7461 7474 725f 5f28 2765 6173 7427  setattr__('east'
-000081b0: 2c20 636f 6f72 6473 5f61 7272 6179 290d  , coords_array).
-000081c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000081d0: 2020 2020 2069 6620 6c61 6220 3d3d 2069       if lab == i
-000081e0: 6e46 4f2e 7375 6974 2e6e 6f72 7468 696e  nFO.suit.northin
-000081f0: 675b 305d 2020 6f72 5c0d 0a20 2020 2020  g[0]  or\..     
-00008200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008210: 2020 206c 6162 2e6c 6f77 6572 2829 2e66     lab.lower().f
-00008220: 696e 6428 276e 6f72 7468 2729 3e3d 303a  ind('north')>=0:
-00008230: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008240: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00008250: 5f73 6574 6174 7472 5f5f 2827 6e6f 7274  _setattr__('nort
-00008260: 6827 2c20 636f 6f72 6473 5f61 7272 6179  h', coords_array
-00008270: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008280: 2020 2020 2020 2069 6620 6c61 6220 3d3d         if lab ==
-00008290: 2069 6e46 4f2e 7375 6974 2e65 6c65 7661   inFO.suit.eleva
-000082a0: 7469 6f6e 5b30 5d20 6f72 205c 0d0a 2020  tion[0] or \..  
-000082b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000082c0: 2020 2020 2020 6c61 622e 6c6f 7765 7228        lab.lower(
-000082d0: 292e 6669 6e64 2827 656c 6576 2729 3e3d  ).find('elev')>=
-000082e0: 3020 3a20 0d0a 2020 2020 2020 2020 2020  0 : ..          
-000082f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00008300: 6c66 2e5f 5f73 6574 6174 7472 5f5f 2827  lf.__setattr__('
-00008310: 656c 6576 272c 2063 6f6f 7264 735f 6172  elev', coords_ar
-00008320: 7261 7929 0d0a 2020 2020 2020 2020 2020  ray)..          
-00008330: 2020 2020 2020 2020 2020 6966 206c 6162            if lab
-00008340: 2e6c 6f77 6572 2829 2e66 696e 6428 276c  .lower().find('l
-00008350: 6174 2729 3e3d 3020 3a0d 0a20 2020 2020  at')>=0 :..     
-00008360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008370: 2020 2073 656c 662e 5f5f 7365 7461 7474     self.__setatt
-00008380: 725f 5f28 276c 6174 272c 2063 6f6f 7264  r__('lat', coord
-00008390: 735f 6172 7261 7929 0d0a 2020 2020 2020  s_array)..      
-000083a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000083b0: 206c 6162 202e 6c6f 7765 7228 292e 6669   lab .lower().fi
-000083c0: 6e64 2827 6c6f 6e27 293e 3d30 3a20 0d0a  nd('lon')>=0: ..
-000083d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083e0: 2020 2020 2020 2020 7365 6c66 2e5f 5f73          self.__s
-000083f0: 6574 6174 7472 5f5f 2827 6c6f 6e27 2c20  etattr__('lon', 
-00008400: 636f 6f72 6473 5f61 7272 6179 290d 0a20  coords_array).. 
-00008410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008420: 2020 2069 6620 6c61 6220 2e6c 6f77 6572     if lab .lower
-00008430: 2829 2e66 696e 6428 2764 6f74 2729 3e3d  ().find('dot')>=
-00008440: 303a 200d 0a20 2020 2020 2020 2020 2020  0: ..           
-00008450: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00008460: 662e 5f5f 7365 7461 7474 725f 5f28 2773  f.__setattr__('s
-00008470: 746e 5f70 6f73 6974 696f 6e27 2c20 636f  tn_position', co
-00008480: 6f72 6473 5f61 7272 6179 290d 0a0d 0a20  ords_array).... 
-00008490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000084a0: 2020 2069 6620 7265 6620 3d3d 2770 7943     if ref =='pyC
-000084b0: 5341 4d54 273a 200d 0a20 2020 2020 2020  SAMT': ..       
-000084c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000084d0: 2069 6620 6c61 623d 3d27 6c65 6e27 206f   if lab=='len' o
-000084e0: 7220 6c61 622e 6669 6e64 2827 6c65 6e27  r lab.find('len'
-000084f0: 2920 3e3d 3020 3a0d 0a20 2020 2020 2020  ) >=0 :..       
-00008500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008510: 2020 2020 2073 656c 662e 5f5f 7365 7461       self.__seta
-00008520: 7474 725f 5f28 2773 746e 5f70 6f73 6974  ttr__('stn_posit
-00008530: 696f 6e27 2c20 636f 6f72 6473 5f61 7272  ion', coords_arr
-00008540: 6179 290d 0a20 2020 2020 2020 2020 2020  ay)..           
-00008550: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00008560: 6c61 623d 3d27 617a 696d 2720 6f72 206c  lab=='azim' or l
-00008570: 6162 2e66 696e 6428 2761 7a69 6d27 293e  ab.find('azim')>
-00008580: 3d30 203a 200d 0a20 2020 2020 2020 2020  =0 : ..         
+00006c40: 2020 2020 6561 7374 696e 6720 636f 6f72      easting coor
+00006c50: 6469 6e61 7465 2028 6d29 2c20 0d0a 2020  dinate (m), ..  
+00006c60: 2020 2020 2020 2020 2020 2a20 6e6f 7274            * nort
+00006c70: 6869 6e67 203a 2061 7272 6179 5f6c 696b  hing : array_lik
+00006c80: 6520 200d 0a20 2020 2020 2020 2020 2020  e  ..           
+00006c90: 2020 2020 2020 2020 2020 2020 206e 6f72               nor
+00006ca0: 7468 696e 6720 636f 6f72 6469 6e61 7465  thing coordinate
+00006cb0: 2076 616c 7565 2028 6d29 0d0a 2020 2020   value (m)..    
+00006cc0: 2020 2020 2020 2020 2a20 6c61 7420 3a20          * lat : 
+00006cd0: 6172 7261 795f 6c69 6b65 200d 0a20 2020  array_like ..   
+00006ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cf0: 206c 6174 6974 7564 6520 636f 6f72 6469   latitude coordi
+00006d00: 6e61 7465 2069 6e20 6465 6772 6565 200d  nate in degree .
+00006d10: 0a20 2020 2020 2020 2020 2020 202a 206c  .            * l
+00006d20: 6f6e 203a 2061 7272 6179 5f6c 696b 6520  on : array_like 
+00006d30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00006d40: 2020 2020 2020 206c 6f6e 6769 7475 6465         longitude
+00006d50: 2063 6f6f 7264 696e 6174 6520 696e 2064   coordinate in d
+00006d60: 6567 7265 650d 0a20 2020 2020 2020 2020  egree..         
+00006d70: 2020 202a 2061 7a69 6d20 3a20 6172 7261     * azim : arra
+00006d80: 795f 6c69 6b65 202c 0d0a 2020 2020 2020  y_like ,..      
+00006d90: 2020 2020 2020 2020 2020 2020 2020 617a                az
+00006da0: 696d 7574 6820 696e 2064 6567 7265 6520  imuth in degree 
+00006db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006dc0: 2020 2020 2020 4966 206e 6f74 2070 726f        If not pro
+00006dd0: 7669 6465 6420 6361 6e20 636f 6d70 7574  vided can comput
+00006de0: 6564 2061 7574 6f6d 6174 6963 616c 6c79  ed automatically
+00006df0: 200d 0a20 2020 2020 2020 2020 2020 202a   ..            *
+00006e00: 2075 746d 5f7a 6f6e 6520 3a73 7472 2020   utm_zone :str  
+00006e10: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00006e20: 2020 2020 2020 2020 2020 7375 7276 6579            survey
+00006e30: 2075 746d 207a 6f6e 6520 0d0a 2020 2020   utm zone ..    
+00006e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e50: 6966 206e 6f74 2070 6f72 7669 6465 6420  if not porvided 
+00006e60: 616e 6420 6c61 7420 616e 6420 6c6f 6e20  and lat and lon 
+00006e70: 6973 2073 6574 202c 0d0a 2020 2020 2020  is set ,..      
+00006e80: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+00006e90: 6e20 636f 6d70 7574 6520 6175 746f 6d61  n compute automa
+00006ea0: 7469 6361 6c6c 7920 0d0a 2020 2020 2020  tically ..      
+00006eb0: 2020 2222 220d 0a20 2020 2020 2020 206c    """..        l
+00006ec0: 6174 203d 206b 7761 7267 732e 706f 7028  at = kwargs.pop(
+00006ed0: 276c 6174 6974 7564 6527 2c20 4e6f 6e65  'latitude', None
+00006ee0: 290d 0a20 2020 2020 2020 206c 6f6e 203d  )..        lon =
+00006ef0: 206b 7761 7267 732e 706f 7028 276c 6f6e   kwargs.pop('lon
+00006f00: 6769 7475 6465 272c 204e 6f6e 6529 0d0a  gitude', None)..
+00006f10: 2020 2020 2020 2020 617a 696d 203d 6b77          azim =kw
+00006f20: 6172 6773 2e70 6f70 2827 617a 696d 7574  args.pop('azimut
+00006f30: 6827 2c20 4e6f 6e65 290d 0a20 2020 2020  h', None)..     
+00006f40: 2020 2075 746d 5f7a 6f6e 6520 3d6b 7761     utm_zone =kwa
+00006f50: 7267 732e 706f 7028 2775 746d 5f7a 6f6e  rgs.pop('utm_zon
+00006f60: 6527 2c20 4e6f 6e65 290d 0a20 2020 2020  e', None)..     
+00006f70: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+00006f80: 7574 6d5f 7a6f 6e65 2069 7320 6e6f 7420  utm_zone is not 
+00006f90: 4e6f 6e65 203a 2073 656c 662e 7574 6d5f  None : self.utm_
+00006fa0: 7a6f 6e65 203d 2075 746d 5f7a 6f6e 650d  zone = utm_zone.
+00006fb0: 0a0d 0a20 2020 2020 2020 205f 7066 6c61  ...        _pfla
+00006fc0: 6720 3d30 0d0a 2020 2020 2020 2020 6966  g =0..        if
+00006fd0: 2070 726f 6669 6c65 5f66 6e20 6973 206e   profile_fn is n
+00006fe0: 6f74 204e 6f6e 6520 3a20 0d0a 2020 2020  ot None : ..    
+00006ff0: 2020 2020 2020 2020 7365 6c66 2e70 726f          self.pro
+00007000: 6669 6c65 5f66 6e20 3d70 726f 6669 6c65  file_fn =profile
+00007010: 5f66 6e0d 0a0d 0a20 2020 2020 2020 2069  _fn....        i
+00007020: 6620 7365 6c66 2e70 726f 6669 6c65 5f66  f self.profile_f
+00007030: 6e20 6973 206e 6f74 204e 6f6e 6520 3a20  n is not None : 
+00007040: 5f70 666c 6167 203d 2031 0d0a 2020 2020  _pflag = 1..    
+00007050: 2020 2020 656c 6966 2065 6173 7469 6e67      elif easting
+00007060: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00007070: 206e 6f72 7468 696e 6720 6973 206e 6f74   northing is not
+00007080: 204e 6f6e 6520 3a20 5f70 666c 6167 203d   None : _pflag =
+00007090: 2032 0d0a 2020 2020 2020 2020 656c 6966   2..        elif
+000070a0: 206c 6174 2069 7320 6e6f 7420 4e6f 6e65   lat is not None
+000070b0: 2061 6e64 206c 6f6e 2069 7320 6e6f 7420   and lon is not 
+000070c0: 4e6f 6e65 203a 205f 7066 6c61 6720 3d20  None : _pflag = 
+000070d0: 330d 0a20 2020 2020 2020 2065 6c69 6620  3..        elif 
+000070e0: 7365 6c66 2e70 726f 6669 6c65 5f66 6e20  self.profile_fn 
+000070f0: 2069 7320 4e6f 6e65 2061 6e64 2028 6561   is None and (ea
+00007100: 7374 696e 6720 6973 206e 6f74 204e 6f6e  sting is not Non
+00007110: 6520 6f72 200d 0a20 2020 2020 2020 2020  e or ..         
+00007120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007140: 2020 6e6f 7274 6869 6e67 2069 7320 4e6f    northing is No
+00007150: 6e65 2920 616e 6420 5c0d 0a20 2020 2020  ne) and \..     
+00007160: 2020 2020 2020 2028 6c61 7420 6973 204e         (lat is N
+00007170: 6f6e 6520 6f72 206c 6f6e 2069 7320 4e6f  one or lon is No
+00007180: 6e65 2920 3a20 0d0a 2020 2020 2020 2020  ne) : ..        
+00007190: 2020 2020 7261 6973 6520 5072 6f66 696c      raise Profil
+000071a0: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
+000071b0: 2020 2020 2020 2020 2027 5072 6f76 6964           'Provid
+000071c0: 6564 2061 7420 6c65 6173 7420 6561 7374  ed at least east
+000071d0: 696e 6720 6f72 206c 6f6e 206f 7220 4e6f  ing or lon or No
+000071e0: 7274 6869 6e67 270d 0a20 2020 2020 2020  rthing'..       
+000071f0: 2020 2020 2020 2020 2027 206f 7220 6c61           ' or la
+00007200: 7420 7661 6c75 6520 6f72 2070 726f 6669  t value or profi
+00007210: 6c65 2073 746e 2066 696c 652e 2729 2020  le stn file.')  
+00007220: 2020 0d0a 2020 2020 2020 2020 0d0a 0d0a    ..        ....
+00007230: 2020 2020 2020 2020 6966 205f 7066 6c61          if _pfla
+00007240: 6720 3d3d 313a 0d0a 2020 2020 2020 2020  g ==1:..        
+00007250: 2020 2020 6966 2069 6e46 4f2e 5f73 656e      if inFO._sen
+00007260: 7369 7469 7665 2e77 6869 6368 5f66 696c  sitive.which_fil
+00007270: 6528 6669 6c65 6e61 6d65 203d 7365 6c66  e(filename =self
+00007280: 2e70 726f 6669 6c65 5f66 6e20 2920 3d3d  .profile_fn ) ==
+00007290: 2773 746e 273a 200d 0a20 2020 2020 2020  'stn': ..       
+000072a0: 2020 2020 2020 2020 2072 6566 3d27 6e6f           ref='no
+000072b0: 6e65 2720 0d0a 2020 2020 2020 2020 2020  ne' ..          
+000072c0: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
+000072d0: 2e62 6173 656e 616d 6528 7365 6c66 2e70  .basename(self.p
+000072e0: 726f 6669 6c65 5f66 6e29 2e66 696e 6428  rofile_fn).find(
+000072f0: 275f 7265 616a 2729 203e 3d30 2020 6f72  '_reaj') >=0  or
+00007300: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
+00007310: 2020 2020 2020 206f 732e 7061 7468 2e62         os.path.b
+00007320: 6173 656e 616d 6528 7365 6c66 2e70 726f  asename(self.pro
+00007330: 6669 6c65 5f66 6e29 2e66 696e 6428 275f  file_fn).find('_
+00007340: 636f 7227 2920 3e3d 3020 6f72 205c 0d0a  cor') >=0 or \..
+00007350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007360: 2020 2020 2020 2020 6f73 2e70 6174 682e          os.path.
+00007370: 6261 7365 6e61 6d65 2873 656c 662e 7072  basename(self.pr
+00007380: 6f66 696c 655f 666e 292e 6669 6e64 2827  ofile_fn).find('
+00007390: 5f73 6361 2729 203e 3d30 203a 200d 0a20  _sca') >=0 : .. 
+000073a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000073b0: 2020 2072 6566 203d 2773 6361 6c6c 6564     ref ='scalled
+000073c0: 270d 0a20 2020 0d0a 2020 2020 2020 2020  '..   ..        
+000073d0: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
+000073e0: 6e28 7365 6c66 2e70 726f 6669 6c65 5f66  n(self.profile_f
+000073f0: 6e2c 2027 7227 2c20 656e 636f 6469 6e67  n, 'r', encoding
+00007400: 3d27 7574 6638 2729 2061 7320 666e 203a  ='utf8') as fn :
+00007410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007420: 2020 2020 2020 6461 7461 5f6c 696e 6573        data_lines
+00007430: 203d 666e 2e72 6561 646c 696e 6573 2028   =fn.readlines (
+00007440: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00007450: 2020 2020 2020 2023 2069 6620 7573 6572         # if user
+00007460: 2064 6f65 736e 7420 7072 6f76 6964 6520   doesnt provide 
+00007470: 7468 6520 7370 6c69 7420 7479 7065 203a  the split type :
+00007480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007490: 2020 2020 2020 2020 2020 2320 7072 6f67            # prog
+000074a0: 7261 6d20 7769 6c6c 2073 6561 7263 6820  ram will search 
+000074b0: 6175 746f 6d61 7469 6361 6c6c 7920 0d0a  automatically ..
+000074c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074d0: 2020 2020 6966 2073 706c 6974 5f74 7970      if split_typ
+000074e0: 6520 6973 204e 6f6e 6520 3a20 0d0a 2020  e is None : ..  
+000074f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007500: 2020 2020 2020 7370 6c69 745f 7479 7065        split_type
+00007510: 203d 2066 756e 632e 7374 6e5f 6368 6563   = func.stn_chec
+00007520: 6b5f 7370 6c69 745f 7479 7065 280d 0a20  k_split_type(.. 
+00007530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007540: 2020 2020 2020 2020 2020 2064 6174 615f             data_
+00007550: 6c69 6e65 733d 6461 7461 5f6c 696e 6573  lines=data_lines
+00007560: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00007570: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00007580: 2020 2020 2020 2020 2020 2020 2023 2069               # i
+00007590: 6e20 7468 6520 6361 7365 2077 6865 7265  n the case where
+000075a0: 2075 7365 7220 7072 6f76 6964 6520 7468   user provide th
+000075b0: 6520 6669 6c65 2077 7269 7474 656e 2062  e file written b
+000075c0: 7920 0d0a 2020 2020 2020 2020 2020 2020  y ..            
+000075d0: 2020 2020 2020 2020 2374 6861 7420 736f          #that so
+000075e0: 6674 7761 7265 202c 6967 6e6f 7265 2074  ftware ,ignore t
+000075f0: 6865 2020 2368 6561 6c69 6e65 7320 7374  he  #healines st
+00007600: 6172 7420 6279 2027 3e20 6f72 2027 210d  art by '> or '!.
+00007610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007620: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00007630: 2020 2020 2020 2020 2020 7465 6d70 3d5b            temp=[
+00007640: 5d20 2020 2020 2020 2020 2020 2020 2320  ]             # 
+00007650: 7265 6275 696c 6420 6120 6e65 7720 6461  rebuild a new da
+00007660: 7461 206c 696e 6573 2066 6f72 2073 6166  ta lines for saf
+00007670: 6574 790d 0a20 2020 2020 2020 2020 2020  ety..           
+00007680: 2020 2020 2020 2020 2066 6f72 2068 6820           for hh 
+00007690: 2c20 7661 6c75 6573 2020 696e 2065 6e75  , values  in enu
+000076a0: 6d65 7261 7465 2864 6174 615f 6c69 6e65  merate(data_line
+000076b0: 7329 203a 200d 0a20 2020 2020 2020 2020  s) : ..         
+000076c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000076d0: 6620 7265 2e6d 6174 6368 2872 275e 3e27  f re.match(r'^>'
+000076e0: 2c20 7661 6c75 6573 2920 6973 206e 6f74  , values) is not
+000076f0: 204e 6f6e 6520 6f72 5c0d 0a20 2020 2020   None or\..     
+00007700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007710: 2020 2020 2020 2072 652e 6d61 7463 6828         re.match(
+00007720: 2772 5e21 272c 2076 616c 7565 7329 2069  'r^!', values) i
+00007730: 7320 206e 6f74 204e 6f6e 6520 5c0d 0a20  s  not None \.. 
+00007740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007750: 2020 2020 2020 2020 2020 206f 7220 7661             or va
+00007760: 6c75 6573 2e66 696e 6428 272b 2b2b 2b2b  lues.find('+++++
+00007770: 2b2b 2b27 2920 3e3d 3020 203a 2070 6173  +++') >=0  : pas
+00007780: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
+00007790: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000077a0: 203a 7465 6d70 2e61 7070 656e 6428 7661   :temp.append(va
+000077b0: 6c75 6573 290d 0a20 2020 2020 2020 2020  lues)..         
+000077c0: 2020 2020 2020 2020 2020 2069 6620 276c             if 'l
+000077d0: 656e 2720 696e 2074 656d 705b 305d 2061  en' in temp[0] a
+000077e0: 6e64 2027 7374 6127 2069 6e20 7465 6d70  nd 'sta' in temp
+000077f0: 5b30 5d20 616e 6420 2761 7a69 6d27 205c  [0] and 'azim' \
+00007800: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007810: 2020 2020 2020 2020 2020 696e 2074 656d            in tem
+00007820: 705b 305d 203a 200d 0a20 2020 2020 2020  p[0] : ..       
+00007830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007840: 2072 6566 203d 2770 7943 5341 4d54 2720   ref ='pyCSAMT' 
+00007850: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00007860: 2020 2020 2020 2020 2064 6174 615f 6c69           data_li
+00007870: 6e65 733d 7465 6d70 0d0a 2020 2020 2020  nes=temp..      
+00007880: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00007890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000078a0: 2020 2020 6465 6369 7369 6f6e 202c 2073      decision , s
+000078b0: 746e 5f68 6561 646c 696e 6573 5f69 6420  tn_headlines_id 
+000078c0: 3d20 6366 756e 632e 5f76 616c 6964 6174  = cfunc._validat
+000078d0: 655f 7374 6e70 726f 6669 6c65 280d 0a20  e_stnprofile(.. 
+000078e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000078f0: 2020 2020 2020 2070 726f 6669 6c65 5f6c         profile_l
+00007900: 696e 6573 3d20 6461 7461 5f6c 696e 6573  ines= data_lines
+00007910: 202c 2073 706c 6974 696e 673d 7370 6c69   , spliting=spli
+00007920: 745f 7479 7065 290d 0a20 2020 2020 2020  t_type)..       
+00007930: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00007940: 6465 6369 7369 6f6e 203c 323a 0d0a 2020  decision <2:..  
+00007950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007960: 2020 2020 2020 7261 6973 6520 5072 6f66        raise Prof
+00007970: 696c 6545 7272 6f72 280d 0a20 2020 2020  ileError(..     
+00007980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007990: 2020 2020 2020 2027 506c 6561 7365 2070         'Please p
+000079a0: 726f 7669 6465 2061 7420 6c65 6173 7420  rovide at least 
+000079b0: 7468 6520 4561 7374 696e 6727 0d0a 2020  the Easting'..  
+000079c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000079d0: 2020 2020 2020 2020 2020 2027 2061 6e64             ' and
+000079e0: 206e 6f72 7468 696e 6720 636f 6f72 6469   northing coordi
+000079f0: 6e61 7465 7320 6f72 2073 6574 2074 6865  nates or set the
+00007a00: 2027 0d0a 2020 2020 2020 2020 2020 2020   '..            
+00007a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007a20: 2027 6c61 742f 6c6f 6e20 7661 6c75 6573   'lat/lon values
+00007a30: 2074 6f20 7061 7273 6520 7468 6520 6461   to parse the da
+00007a40: 7461 2e20 2729 0d0a 2020 2020 2020 2020  ta. ')..        
+00007a50: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00007a60: 2020 2020 2020 2020 2020 656c 7365 203a            else :
+00007a70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007a80: 2020 2020 2020 2020 2020 6461 7461 5f6c            data_l
+00007a90: 6973 745f 6f66 5f61 7272 6179 3d20 5b6e  ist_of_array= [n
+00007aa0: 702e 6172 7261 7920 280d 0a20 2020 2020  p.array (..     
+00007ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ac0: 2020 2020 2020 206c 696e 652e 7374 7269         line.stri
+00007ad0: 7028 292e 7370 6c69 7428 7370 6c69 745f  p().split(split_
+00007ae0: 7479 7065 2929 200d 0a20 2020 2020 2020  type)) ..       
+00007af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b00: 2020 2020 2020 2020 666f 7220 6969 2c20          for ii, 
+00007b10: 206c 696e 6520 696e 2065 6e75 6d65 7261   line in enumera
+00007b20: 7465 2864 6174 615f 6c69 6e65 7329 5d0d  te(data_lines)].
+00007b30: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00007b40: 2020 2020 2020 2020 2020 2064 6174 615f             data_
+00007b50: 6172 7261 7920 3d66 756e 632e 636f 6e63  array =func.conc
+00007b60: 6174 5f61 7272 6179 5f66 726f 6d5f 6c69  at_array_from_li
+00007b70: 7374 280d 0a20 2020 2020 2020 2020 2020  st(..           
+00007b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b90: 206c 6973 745f 6f66 5f61 7272 6179 3d64   list_of_array=d
+00007ba0: 6174 615f 6c69 7374 5f6f 665f 6172 7261  ata_list_of_arra
+00007bb0: 792c 2063 6f6e 6361 745f 6178 6973 3d30  y, concat_axis=0
+00007bc0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00007bd0: 2020 2020 2066 6f72 206c 6162 2c20 696e       for lab, in
+00007be0: 6465 7820 696e 2073 746e 5f68 6561 646c  dex in stn_headl
+00007bf0: 696e 6573 5f69 643a 200d 0a20 2020 2020  ines_id: ..     
+00007c00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007c10: 6620 7265 6620 3d3d 2773 6361 6c6c 6564  f ref =='scalled
+00007c20: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
+00007c30: 2020 2020 2020 2020 2020 2020 2077 6172               war
+00007c40: 6e69 6e67 732e 7761 726e 280d 0a20 2020  nings.warn(..   
+00007c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c60: 2020 2020 2020 2020 2022 4974 2073 6565           "It see
+00007c70: 6d73 2074 6865 2070 726f 6669 6c65 2064  ms the profile d
+00007c80: 6174 6120 6973 2061 6c72 6561 6479 220d  ata is already".
+00007c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007ca0: 2020 2020 2020 2020 2020 2020 2022 7363               "sc
+00007cb0: 616c 6564 2e20 506c 6561 7365 2075 7365  aled. Please use
+00007cc0: 2020 7468 6520 6d65 7468 6f64 2022 0d0a    the method "..
+00007cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ce0: 2020 2020 2020 2020 2020 2020 223c 7079              "<py
+00007cf0: 6373 616d 742e 7369 7465 2e50 726f 6669  csamt.site.Profi
+00007d00: 6c65 2e72 6561 6a75 7374 5f63 6f6f 7264  le.reajust_coord
+00007d10: 696e 6174 6573 5f76 616c 7565 3e22 0d0a  inates_value>"..
+00007d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d30: 2020 2020 2020 2020 2020 2020 2220 746f              " to
+00007d40: 2066 6f72 6365 2073 6361 6c69 6e67 2e22   force scaling."
+00007d50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00007d60: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
+00007d70: 735f 6172 7261 7920 3d20 6461 7461 5f61  s_array = data_a
+00007d80: 7272 6179 5b31 3a2c 2069 6e64 6578 5d0d  rray[1:, index].
+00007d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007da0: 2020 2020 2065 6c73 6520 3a20 0d0a 2020       else : ..  
+00007db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007dc0: 2020 2020 2020 7365 6c66 2e5f 6c6f 6767        self._logg
+00007dd0: 696e 672e 696e 666f 280d 0a20 2020 2020  ing.info(..     
+00007de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007df0: 2020 2020 2020 2027 5265 7363 616c 696e         'Rescalin
+00007e00: 6720 7374 6174 696f 6e20 706f 7369 7469  g station positi
+00007e10: 6f6e 7327 0d0a 2020 2020 2020 2020 2020  ons'..          
+00007e20: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
+00007e30: 6672 6f6d 2066 696c 6520 3c25 733e 2725  from file <%s>'%
+00007e40: 206f 732e 7061 7468 2e62 6173 656e 616d   os.path.basenam
+00007e50: 6528 7365 6c66 2e70 726f 6669 6c65 5f66  e(self.profile_f
+00007e60: 6e29 290d 0a20 2020 2020 2020 2020 2020  n))..           
+00007e70: 2020 2020 2020 2020 2020 2020 2077 6172               war
+00007e80: 6e69 6e67 732e 7761 726e 280d 0a20 2020  nings.warn(..   
+00007e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ea0: 2020 2020 2027 205a 6f6e 6765 2048 6172       ' Zonge Har
+00007eb0: 6477 6172 6520 7573 7561 6c6c 7920 7072  dware usually pr
+00007ec0: 6f76 6964 6573 2074 6865 2073 7461 7469  ovides the stati
+00007ed0: 6f6e 206c 6f63 6174 696f 6e73 2027 0d0a  on locations '..
+00007ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ef0: 2020 2020 2020 2020 2720 6174 2065 6163          ' at eac
+00007f00: 6820 656c 6563 7472 6f64 6520 6c6f 6361  h electrode loca
+00007f10: 7469 6f6e 2072 6174 6865 7220 7468 616e  tion rather than
+00007f20: 2074 6865 2063 656e 7465 7220 6f66 2027   the center of '
+00007f30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007f40: 2020 2020 2020 2020 2020 2764 6970 6f6c            'dipol
+00007f50: 6573 2e20 4c6f 6361 7469 6f6e 7320 7368  es. Locations sh
+00007f60: 6f75 6c64 206d 6f76 6520 746f 2074 6865  ould move to the
+00007f70: 2064 6970 6f6c 6520 6365 6e74 6572 2e27   dipole center.'
+00007f80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007f90: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00007fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007fb0: 2020 2020 2023 2074 7279 203a 0d0a 2020       # try :..  
+00007fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007fd0: 2020 2020 2020 636f 6f72 6473 5f61 7272        coords_arr
+00007fe0: 6179 203d 6366 756e 632e 6469 706f 6c65  ay =cfunc.dipole
+00007ff0: 5f63 656e 7465 725f 706f 7369 7469 6f6e  _center_position
+00008000: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00008010: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00008020: 6970 6f6c 655f 706f 7369 7469 6f6e 203d  ipole_position =
+00008030: 2064 6174 615f 6172 7261 795b 313a 2c69   data_array[1:,i
+00008040: 6e64 6578 5d29 0d0a 2020 2020 2020 2020  ndex])..        
+00008050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008060: 2320 6578 6365 7074 203a 7061 7373 200d  # except :pass .
+00008070: 0a20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
+00008080: 2020 2020 2020 2020 6966 206c 6162 203d          if lab =
+00008090: 3d20 696e 464f 2e73 7569 742e 6561 7374  = inFO.suit.east
+000080a0: 696e 675b 305d 206f 725c 0d0a 2020 2020  ing[0] or\..    
+000080b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080c0: 2020 2020 6c61 622e 6c6f 7765 7228 292e      lab.lower().
+000080d0: 6669 6e64 2827 6561 7374 2729 3e3d 3020  find('east')>=0 
+000080e0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000080f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00008100: 2e5f 5f73 6574 6174 7472 5f5f 2827 6561  .__setattr__('ea
+00008110: 7374 272c 2063 6f6f 7264 735f 6172 7261  st', coords_arra
+00008120: 7929 0d0a 2020 2020 2020 2020 2020 2020  y)..            
+00008130: 2020 2020 2020 2020 6966 206c 6162 203d          if lab =
+00008140: 3d20 696e 464f 2e73 7569 742e 6e6f 7274  = inFO.suit.nort
+00008150: 6869 6e67 5b30 5d20 206f 725c 0d0a 2020  hing[0]  or\..  
+00008160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008170: 2020 2020 2020 6c61 622e 6c6f 7765 7228        lab.lower(
+00008180: 292e 6669 6e64 2827 6e6f 7274 6827 293e  ).find('north')>
+00008190: 3d30 3a0d 0a20 2020 2020 2020 2020 2020  =0:..           
+000081a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000081b0: 662e 5f5f 7365 7461 7474 725f 5f28 276e  f.__setattr__('n
+000081c0: 6f72 7468 272c 2063 6f6f 7264 735f 6172  orth', coords_ar
+000081d0: 7261 7929 0d0a 2020 2020 2020 2020 2020  ray)..          
+000081e0: 2020 2020 2020 2020 2020 6966 206c 6162            if lab
+000081f0: 203d 3d20 696e 464f 2e73 7569 742e 656c   == inFO.suit.el
+00008200: 6576 6174 696f 6e5b 305d 206f 7220 5c0d  evation[0] or \.
+00008210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008220: 2020 2020 2020 2020 206c 6162 2e6c 6f77           lab.low
+00008230: 6572 2829 2e66 696e 6428 2765 6c65 7627  er().find('elev'
+00008240: 293e 3d30 203a 200d 0a20 2020 2020 2020  )>=0 : ..       
+00008250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008260: 2073 656c 662e 5f5f 7365 7461 7474 725f   self.__setattr_
+00008270: 5f28 2765 6c65 7627 2c20 636f 6f72 6473  _('elev', coords
+00008280: 5f61 7272 6179 290d 0a20 2020 2020 2020  _array)..       
+00008290: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000082a0: 6c61 622e 6c6f 7765 7228 292e 6669 6e64  lab.lower().find
+000082b0: 2827 6c61 7427 293e 3d30 203a 0d0a 2020  ('lat')>=0 :..  
+000082c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000082d0: 2020 2020 2020 7365 6c66 2e5f 5f73 6574        self.__set
+000082e0: 6174 7472 5f5f 2827 6c61 7427 2c20 636f  attr__('lat', co
+000082f0: 6f72 6473 5f61 7272 6179 290d 0a20 2020  ords_array)..   
+00008300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008310: 2069 6620 6c61 6220 2e6c 6f77 6572 2829   if lab .lower()
+00008320: 2e66 696e 6428 276c 6f6e 2729 3e3d 303a  .find('lon')>=0:
+00008330: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00008340: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00008350: 5f5f 7365 7461 7474 725f 5f28 276c 6f6e  __setattr__('lon
+00008360: 272c 2063 6f6f 7264 735f 6172 7261 7929  ', coords_array)
+00008370: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008380: 2020 2020 2020 6966 206c 6162 202e 6c6f        if lab .lo
+00008390: 7765 7228 292e 6669 6e64 2827 646f 7427  wer().find('dot'
+000083a0: 293e 3d30 3a20 0d0a 2020 2020 2020 2020  )>=0: ..        
+000083b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083c0: 7365 6c66 2e5f 5f73 6574 6174 7472 5f5f  self.__setattr__
+000083d0: 2827 7374 6e5f 706f 7369 7469 6f6e 272c  ('stn_position',
+000083e0: 2063 6f6f 7264 735f 6172 7261 7929 0d0a   coords_array)..
+000083f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008400: 2020 2020 2020 6966 2072 6566 203d 3d27        if ref =='
+00008410: 7079 4353 414d 5427 3a20 0d0a 2020 2020  pyCSAMT': ..    
+00008420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008430: 2020 2020 6966 206c 6162 3d3d 276c 656e      if lab=='len
+00008440: 2720 6f72 206c 6162 2e66 696e 6428 276c  ' or lab.find('l
+00008450: 656e 2729 203e 3d30 203a 0d0a 2020 2020  en') >=0 :..    
+00008460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008470: 2020 2020 2020 2020 7365 6c66 2e5f 5f73          self.__s
+00008480: 6574 6174 7472 5f5f 2827 7374 6e5f 706f  etattr__('stn_po
+00008490: 7369 7469 6f6e 272c 2063 6f6f 7264 735f  sition', coords_
+000084a0: 6172 7261 7929 0d0a 2020 2020 2020 2020  array)..        
+000084b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000084c0: 6966 206c 6162 3d3d 2761 7a69 6d27 206f  if lab=='azim' o
+000084d0: 7220 6c61 622e 6669 6e64 2827 617a 696d  r lab.find('azim
+000084e0: 2729 3e3d 3020 3a20 0d0a 2020 2020 2020  ')>=0 : ..      
+000084f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008500: 2020 2020 2020 7365 6c66 2e5f 5f73 6574        self.__set
+00008510: 6174 7472 5f5f 2827 617a 696d 7574 6827  attr__('azimuth'
+00008520: 2c20 636f 6f72 6473 5f61 7272 6179 290d  , coords_array).
+00008530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008540: 2020 2020 2069 6620 7265 6620 3d3d 276e       if ref =='n
+00008550: 6f6e 6527 3a0d 0a20 2020 2020 2020 2020  one':..         
+00008560: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00008570: 6620 6c61 6220 696e 2069 6e46 4f2e 7375  f lab in inFO.su
+00008580: 6974 2e73 7461 7469 6f6e 203a 0d0a 2020  it.station :..  
 00008590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085a0: 2020 2073 656c 662e 5f5f 7365 7461 7474     self.__setatt
-000085b0: 725f 5f28 2761 7a69 6d75 7468 272c 2063  r__('azimuth', c
-000085c0: 6f6f 7264 735f 6172 7261 7929 0d0a 2020  oords_array)..  
-000085d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085e0: 2020 6966 2072 6566 203d 3d27 6e6f 6e65    if ref =='none
-000085f0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-00008600: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00008610: 6162 2069 6e20 696e 464f 2e73 7569 742e  ab in inFO.suit.
-00008620: 7374 6174 696f 6e20 3a0d 0a20 2020 2020  station :..     
-00008630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008640: 2020 2020 2020 2073 656c 662e 5f5f 7365         self.__se
-00008650: 7461 7474 725f 5f28 2773 746e 5f70 6f73  tattr__('stn_pos
-00008660: 6974 696f 6e27 2c20 636f 6f72 6473 5f61  ition', coords_a
-00008670: 7272 6179 290d 0a0d 0a20 2020 2020 2020  rray)....       
-00008680: 2020 2020 2023 2d2d 2d2d 2063 6f6d 7075       #---- compu
-00008690: 7465 2061 7a69 6d75 7468 202c 2073 7461  te azimuth , sta
-000086a0: 7469 6f6e 2069 6e74 6572 7661 6c20 616e  tion interval an
-000086b0: 6420 6469 706f 6c65 5f6c 656e 6774 6820  d dipole_length 
-000086c0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a20 2020  ---------....   
-000086d0: 2020 2020 2020 2020 2069 6620 2873 656c           if (sel
-000086e0: 662e 6561 7374 2069 7320 6e6f 7420 4e6f  f.east is not No
-000086f0: 6e65 2029 2061 6e64 2028 7365 6c66 2e6e  ne ) and (self.n
-00008700: 6f72 7468 2069 7320 6e6f 7420 4e6f 6e65  orth is not None
-00008710: 2029 3a20 0d0a 2020 2020 2020 2020 2020   ): ..          
-00008720: 2020 2020 2020 6966 2073 656c 662e 617a        if self.az
-00008730: 696d 7574 6820 6973 204e 6f6e 6520 3a0d  imuth is None :.
-00008740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008750: 2020 2020 2073 656c 662e 617a 696d 7574       self.azimut
-00008760: 6820 3d20 6675 6e63 2e63 6f6d 7075 7465  h = func.compute
-00008770: 5f61 7a69 6d75 7468 2865 6173 7469 6e67  _azimuth(easting
-00008780: 3d73 656c 662e 6561 7374 2c0d 0a20 2020  =self.east,..   
-00008790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000087a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000087b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000087c0: 2020 2020 206e 6f72 7468 696e 6720 3d73       northing =s
-000087d0: 656c 662e 6e6f 7274 682c 200d 0a20 2020  elf.north, ..   
+000085a0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000085b0: 5f73 6574 6174 7472 5f5f 2827 7374 6e5f  _setattr__('stn_
+000085c0: 706f 7369 7469 6f6e 272c 2063 6f6f 7264  position', coord
+000085d0: 735f 6172 7261 7929 0d0a 0d0a 2020 2020  s_array)....    
+000085e0: 2020 2020 2020 2020 232d 2d2d 2d20 636f          #---- co
+000085f0: 6d70 7574 6520 617a 696d 7574 6820 2c20  mpute azimuth , 
+00008600: 7374 6174 696f 6e20 696e 7465 7276 616c  station interval
+00008610: 2061 6e64 2064 6970 6f6c 655f 6c65 6e67   and dipole_leng
+00008620: 7468 202d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a  th ---------....
+00008630: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+00008640: 7365 6c66 2e65 6173 7420 6973 206e 6f74  self.east is not
+00008650: 204e 6f6e 6520 2920 616e 6420 2873 656c   None ) and (sel
+00008660: 662e 6e6f 7274 6820 6973 206e 6f74 204e  f.north is not N
+00008670: 6f6e 6520 293a 200d 0a20 2020 2020 2020  one ): ..       
+00008680: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00008690: 2e61 7a69 6d75 7468 2069 7320 4e6f 6e65  .azimuth is None
+000086a0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+000086b0: 2020 2020 2020 2020 7365 6c66 2e61 7a69          self.azi
+000086c0: 6d75 7468 203d 2066 756e 632e 636f 6d70  muth = func.comp
+000086d0: 7574 655f 617a 696d 7574 6828 6561 7374  ute_azimuth(east
+000086e0: 696e 673d 7365 6c66 2e65 6173 742c 0d0a  ing=self.east,..
+000086f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008720: 2020 2020 2020 2020 6e6f 7274 6869 6e67          northing
+00008730: 203d 7365 6c66 2e6e 6f72 7468 2c20 0d0a   =self.north, ..
+00008740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008770: 2020 2020 6578 7472 6170 6f6c 6174 653d      extrapolate=
+00008780: 5472 7565 290d 0a20 200d 0a20 2020 2020  True)..  ..     
+00008790: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000087a0: 7374 6e5f 696e 7465 7276 616c 3d73 656c  stn_interval=sel
+000087b0: 662e 7374 6e5f 7365 7061 7261 7469 6f6e  f.stn_separation
+000087c0: 2865 6173 7469 6e67 3d20 7365 6c66 2e65  (easting= self.e
+000087d0: 6173 742c 200d 0a20 2020 2020 2020 2020  ast, ..         
 000087e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000087f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008810: 2065 7874 7261 706f 6c61 7465 3d54 7275   extrapolate=Tru
-00008820: 6529 0d0a 2020 0d0a 2020 2020 2020 2020  e)..  ..        
-00008830: 2020 2020 2020 2020 7365 6c66 2e73 746e          self.stn
-00008840: 5f69 6e74 6572 7661 6c3d 7365 6c66 2e73  _interval=self.s
-00008850: 746e 5f73 6570 6172 6174 696f 6e28 6561  tn_separation(ea
-00008860: 7374 696e 673d 2073 656c 662e 6561 7374  sting= self.east
-00008870: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00008880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088a0: 2020 2020 2020 2020 2020 6e6f 7274 6869            northi
-000088b0: 6e67 203d 7365 6c66 2e6e 6f72 7468 2c0d  ng =self.north,.
-000088c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000088d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088f0: 2020 2020 2020 2069 6e74 6572 706f 6c61         interpola
-00008900: 7465 3d54 7275 6529 5b30 5d0d 0a20 2020  te=True)[0]..   
-00008910: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00008920: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00008930: 656c 662e 6469 706f 6c65 5f6c 656e 6774  elf.dipole_lengt
-00008940: 6820 3d20 6366 756e 632e 726f 756e 645f  h = cfunc.round_
-00008950: 6469 706f 6c65 5f6c 656e 6774 6828 0d0a  dipole_length(..
+00008800: 2020 2020 2020 2020 2020 2020 206e 6f72               nor
+00008810: 7468 696e 6720 3d73 656c 662e 6e6f 7274  thing =self.nort
+00008820: 682c 0d0a 2020 2020 2020 2020 2020 2020  h,..            
+00008830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008850: 2020 2020 2020 2020 2020 696e 7465 7270            interp
+00008860: 6f6c 6174 653d 5472 7565 295b 305d 0d0a  olate=True)[0]..
+00008870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008880: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008890: 2020 7365 6c66 2e64 6970 6f6c 655f 6c65    self.dipole_le
+000088a0: 6e67 7468 203d 2063 6675 6e63 2e72 6f75  ngth = cfunc.rou
+000088b0: 6e64 5f64 6970 6f6c 655f 6c65 6e67 7468  nd_dipole_length
+000088c0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+000088d0: 2020 2020 2020 2073 656c 662e 7374 6e5f         self.stn_
+000088e0: 696e 7465 7276 616c 2e6d 6561 6e28 2929  interval.mean())
+000088f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008900: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00008910: 2020 2020 7472 7920 3a20 0d0a 2020 2020      try : ..    
+00008920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008930: 7365 6c66 2e4c 6f63 6174 696f 6e2e 636f  self.Location.co
+00008940: 6e76 6572 745f 6c6f 6361 7469 6f6e 5f32  nvert_location_2
+00008950: 5f6c 6174 6c6f 6e28 0d0a 2020 2020 2020  _latlon(..      
 00008960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008970: 2020 2020 7365 6c66 2e73 746e 5f69 6e74      self.stn_int
-00008980: 6572 7661 6c2e 6d65 616e 2829 290d 0a20  erval.mean()).. 
+00008970: 2020 7574 6d5f 7a6f 6e65 3d73 656c 662e    utm_zone=self.
+00008980: 7574 6d5f 7a6f 6e65 290d 0a20 2020 2020  utm_zone)..     
 00008990: 2020 2020 2020 2020 2020 2020 2020 200d                 .
 000089a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000089b0: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
-000089c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000089d0: 662e 4c6f 6361 7469 6f6e 2e63 6f6e 7665  f.Location.conve
-000089e0: 7274 5f6c 6f63 6174 696f 6e5f 325f 6c61  rt_location_2_la
-000089f0: 746c 6f6e 280d 0a20 2020 2020 2020 2020  tlon(..         
-00008a00: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00008a10: 746d 5f7a 6f6e 653d 7365 6c66 2e75 746d  tm_zone=self.utm
-00008a20: 5f7a 6f6e 6529 0d0a 2020 2020 2020 2020  _zone)..        
-00008a30: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00008a40: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00008a50: 6365 7074 203a 200d 0a20 2020 2020 2020  cept : ..       
-00008a60: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00008a70: 662e 5f6c 6f67 6769 6e67 2e64 6562 7567  f._logging.debug
-00008a80: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00008a90: 2020 2020 2020 2020 2020 2027 436f 756c             'Coul
-00008aa0: 6420 6e6f 7420 636f 6e76 6572 7420 6561  d not convert ea
-00008ab0: 7374 696e 672f 6e6f 7274 6869 6e67 2074  sting/northing t
-00008ac0: 6f20 6c61 742f 6c6f 6e27 0d0a 2020 2020  o lat/lon'..    
+000089b0: 2065 7863 6570 7420 3a20 0d0a 2020 2020   except : ..    
+000089c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089d0: 7365 6c66 2e5f 6c6f 6767 696e 672e 6465  self._logging.de
+000089e0: 6275 6728 0d0a 2020 2020 2020 2020 2020  bug(..          
+000089f0: 2020 2020 2020 2020 2020 2020 2020 2743                'C
+00008a00: 6f75 6c64 206e 6f74 2063 6f6e 7665 7274  ould not convert
+00008a10: 2065 6173 7469 6e67 2f6e 6f72 7468 696e   easting/northin
+00008a20: 6720 746f 206c 6174 2f6c 6f6e 270d 0a20  g to lat/lon'.. 
+00008a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a40: 2020 2020 2020 2027 2077 6974 6820 7574         ' with ut
+00008a50: 6d5f 7a6f 6e65 203d 207b 7d2e 272e 666f  m_zone = {}.'.fo
+00008a60: 726d 6174 2873 656c 662e 7574 6d29 290d  rmat(self.utm)).
+00008a70: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00008a80: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00008a90: 2020 2020 2065 6c69 6620 2873 656c 662e       elif (self.
+00008aa0: 6c6f 6e20 6973 206e 6f74 204e 6f6e 6520  lon is not None 
+00008ab0: 2920 616e 6420 2873 656c 662e 6c61 7420  ) and (self.lat 
+00008ac0: 6973 206e 6f74 204e 6f6e 6529 3a20 0d0a  is not None): ..
 00008ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ae0: 2020 2020 2720 7769 7468 2075 746d 5f7a      ' with utm_z
-00008af0: 6f6e 6520 3d20 7b7d 2e27 2e66 6f72 6d61  one = {}.'.forma
-00008b00: 7428 7365 6c66 2e75 746d 2929 0d0a 2020  t(self.utm))..  
-00008b10: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00008b20: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-00008b30: 2020 656c 6966 2028 7365 6c66 2e6c 6f6e    elif (self.lon
-00008b40: 2069 7320 6e6f 7420 4e6f 6e65 2029 2061   is not None ) a
-00008b50: 6e64 2028 7365 6c66 2e6c 6174 2069 7320  nd (self.lat is 
-00008b60: 6e6f 7420 4e6f 6e65 293a 200d 0a20 2020  not None): ..   
-00008b70: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00008b80: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00008b90: 636f 6e76 6572 7420 6c61 7420 6c6f 6e20  convert lat lon 
-00008ba0: 746f 2075 746d 2061 6e64 2067 6574 2074  to utm and get t
-00008bb0: 6865 2061 7474 7269 6275 7465 2065 6173  he attribute eas
-00008bc0: 7469 6e67 2061 6e64 206e 6f72 7468 696e  ting and northin
-00008bd0: 6720 0d0a 2020 2020 2020 2020 2020 2020  g ..            
-00008be0: 2020 2020 7365 6c66 2e4c 6f63 6174 696f      self.Locatio
-00008bf0: 6e2e 636f 6e76 6572 745f 6c6f 6361 7469  n.convert_locati
-00008c00: 6f6e 5f32 5f75 746d 280d 0a20 2020 2020  on_2_utm(..     
-00008c10: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00008c20: 6f6e 6769 7475 6465 3d73 656c 662e 6c6f  ongitude=self.lo
-00008c30: 6e2c 6c61 7469 7475 6465 3d73 656c 662e  n,latitude=self.
-00008c40: 6c61 7429 0d0a 2020 2020 2020 2020 2020  lat)..          
-00008c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c70: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00008c80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00008c90: 662e 617a 696d 7574 6820 3d66 756e 632e  f.azimuth =func.
-00008ca0: 636f 6d70 7574 655f 617a 696d 7574 6828  compute_azimuth(
-00008cb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008cc0: 2020 2020 2020 6561 7374 696e 673d 7365        easting=se
-00008cd0: 6c66 2e65 6173 742c 6e6f 7274 6869 6e67  lf.east,northing
-00008ce0: 3d73 656c 662e 6e6f 7274 682c 2065 7874  =self.north, ext
-00008cf0: 7261 706f 6c61 7465 3d54 7275 6529 0d0a  rapolate=True)..
-00008d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d30: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00008d40: 2020 2020 2073 656c 662e 7374 6e5f 696e       self.stn_in
-00008d50: 7465 7276 616c 3d73 656c 662e 7374 6e5f  terval=self.stn_
-00008d60: 7365 7061 7261 7469 6f6e 280d 0a20 2020  separation(..   
-00008d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d80: 2065 6173 7469 6e67 3d20 7365 6c66 2e4c   easting= self.L
-00008d90: 6f63 6174 696f 6e2e 6561 7374 696e 672c  ocation.easting,
-00008da0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00008db0: 2020 2020 2020 206e 6f72 7468 696e 6720         northing 
-00008dc0: 3d73 656c 662e 4c6f 6361 7469 6f6e 2e6e  =self.Location.n
-00008dd0: 6f72 7468 696e 672c 200d 0a20 2020 2020  orthing, ..     
-00008de0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00008df0: 6e74 6572 706f 6c61 7465 3d54 7275 6520  nterpolate=True 
-00008e00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008e10: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00008e20: 2020 2020 2073 656c 662e 6469 706f 6c65       self.dipole
-00008e30: 5f6c 656e 6774 6820 3d20 6366 756e 632e  _length = cfunc.
-00008e40: 726f 756e 645f 6469 706f 6c65 5f6c 656e  round_dipole_len
-00008e50: 6774 6828 0d0a 2020 2020 2020 2020 2020  gth(..          
-00008e60: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00008e70: 746e 5f69 6e74 6572 7661 6c2e 6d65 616e  tn_interval.mean
-00008e80: 2829 290d 0a20 2020 0d0a 2020 2020 2020  ())..   ..      
-00008e90: 2020 656c 6966 205f 7066 6c61 6720 3d3d    elif _pflag ==
-00008ea0: 3220 6f72 205f 7066 6c61 6720 3d3d 3320  2 or _pflag ==3 
-00008eb0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00008ec0: 6966 205f 7066 6c61 6720 3d3d 2032 203a  if _pflag == 2 :
-00008ed0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00008ee0: 2020 2061 7373 6572 7420 6561 7374 696e     assert eastin
-00008ef0: 672e 7369 7a65 203d 3d20 6e6f 7274 6869  g.size == northi
-00008f00: 6e67 2e73 697a 6520 2c5c 0d0a 2020 2020  ng.size ,\..    
-00008f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008f20: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00008f30: 725f 7072 6f66 696c 6528 0d0a 2020 2020  r_profile(..    
-00008f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008f50: 2020 2020 2745 6173 7469 6e67 2061 6e64      'Easting and
-00008f60: 204e 6f72 7468 696e 6720 6d75 7374 2068   Northing must h
-00008f70: 6176 6520 7468 6520 7361 6d65 2073 697a  ave the same siz
-00008f80: 652e 270d 0a20 2020 2020 2020 2020 2020  e.'..           
-00008f90: 2020 2020 2020 2020 2027 2065 6173 7469           ' easti
-00008fa0: 6e67 7c6e 6f72 7468 696e 6720 7369 7a65  ng|northing size
-00008fb0: 2061 7265 2063 7572 7265 6e74 6c79 7369   are currentlysi
-00008fc0: 7a65 2069 7320 3c7b 307d 7c7b 317d 3e2e  ze is <{0}|{1}>.
-00008fd0: 272e 0d0a 2020 2020 2020 2020 2020 2020  '...            
-00008fe0: 2020 2020 2020 2020 2020 2020 666f 726d              form
-00008ff0: 6174 2865 6173 7469 6e67 2e73 697a 652c  at(easting.size,
-00009000: 206e 6f72 7468 696e 672e 7369 7a65 2929   northing.size))
-00009010: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009020: 2020 7365 6c66 2e65 6173 7420 3d65 6173    self.east =eas
-00009030: 7469 6e67 200d 0a20 2020 2020 2020 2020  ting ..         
-00009040: 2020 2020 2020 2073 656c 662e 6e6f 7274         self.nort
-00009050: 6820 3d6e 6f72 7468 696e 670d 0a20 2020  h =northing..   
-00009060: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00009070: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00009080: 656c 662e 4c6f 6361 7469 6f6e 2e63 6f6e  elf.Location.con
-00009090: 7665 7274 5f6c 6f63 6174 696f 6e5f 325f  vert_location_2_
-000090a0: 6c61 746c 6f6e 2875 746d 5f7a 6f6e 653d  latlon(utm_zone=
-000090b0: 7365 6c66 2e75 746d 5f7a 6f6e 6529 0d0a  self.utm_zone)..
+00008ae0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008af0: 2020 2363 6f6e 7665 7274 206c 6174 206c    #convert lat l
+00008b00: 6f6e 2074 6f20 7574 6d20 616e 6420 6765  on to utm and ge
+00008b10: 7420 7468 6520 6174 7472 6962 7574 6520  t the attribute 
+00008b20: 6561 7374 696e 6720 616e 6420 6e6f 7274  easting and nort
+00008b30: 6869 6e67 200d 0a20 2020 2020 2020 2020  hing ..         
+00008b40: 2020 2020 2020 2073 656c 662e 4c6f 6361         self.Loca
+00008b50: 7469 6f6e 2e63 6f6e 7665 7274 5f6c 6f63  tion.convert_loc
+00008b60: 6174 696f 6e5f 325f 7574 6d28 0d0a 2020  ation_2_utm(..  
+00008b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b80: 2020 6c6f 6e67 6974 7564 653d 7365 6c66    longitude=self
+00008b90: 2e6c 6f6e 2c6c 6174 6974 7564 653d 7365  .lon,latitude=se
+00008ba0: 6c66 2e6c 6174 290d 0a20 2020 2020 2020  lf.lat)..       
+00008bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008bd0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00008be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008bf0: 7365 6c66 2e61 7a69 6d75 7468 203d 6675  self.azimuth =fu
+00008c00: 6e63 2e63 6f6d 7075 7465 5f61 7a69 6d75  nc.compute_azimu
+00008c10: 7468 280d 0a20 2020 2020 2020 2020 2020  th(..           
+00008c20: 2020 2020 2020 2020 2065 6173 7469 6e67           easting
+00008c30: 3d73 656c 662e 6561 7374 2c6e 6f72 7468  =self.east,north
+00008c40: 696e 673d 7365 6c66 2e6e 6f72 7468 2c20  ing=self.north, 
+00008c50: 6578 7472 6170 6f6c 6174 653d 5472 7565  extrapolate=True
+00008c60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00008c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c90: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00008ca0: 2020 2020 2020 2020 7365 6c66 2e73 746e          self.stn
+00008cb0: 5f69 6e74 6572 7661 6c3d 7365 6c66 2e73  _interval=self.s
+00008cc0: 746e 5f73 6570 6172 6174 696f 6e28 0d0a  tn_separation(..
+00008cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ce0: 2020 2020 6561 7374 696e 673d 2073 656c      easting= sel
+00008cf0: 662e 4c6f 6361 7469 6f6e 2e65 6173 7469  f.Location.easti
+00008d00: 6e67 2c20 0d0a 2020 2020 2020 2020 2020  ng, ..          
+00008d10: 2020 2020 2020 2020 2020 6e6f 7274 6869            northi
+00008d20: 6e67 203d 7365 6c66 2e4c 6f63 6174 696f  ng =self.Locatio
+00008d30: 6e2e 6e6f 7274 6869 6e67 2c20 0d0a 2020  n.northing, ..  
+00008d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008d50: 2020 696e 7465 7270 6f6c 6174 653d 5472    interpolate=Tr
+00008d60: 7565 2029 0d0a 2020 2020 2020 2020 2020  ue )..          
+00008d70: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00008d80: 2020 2020 2020 2020 7365 6c66 2e64 6970          self.dip
+00008d90: 6f6c 655f 6c65 6e67 7468 203d 2063 6675  ole_length = cfu
+00008da0: 6e63 2e72 6f75 6e64 5f64 6970 6f6c 655f  nc.round_dipole_
+00008db0: 6c65 6e67 7468 280d 0a20 2020 2020 2020  length(..       
+00008dc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00008dd0: 662e 7374 6e5f 696e 7465 7276 616c 2e6d  f.stn_interval.m
+00008de0: 6561 6e28 2929 0d0a 2020 200d 0a20 2020  ean())..   ..   
+00008df0: 2020 2020 2065 6c69 6620 5f70 666c 6167       elif _pflag
+00008e00: 203d 3d32 206f 7220 5f70 666c 6167 203d   ==2 or _pflag =
+00008e10: 3d33 203a 200d 0a20 2020 2020 2020 2020  =3 : ..         
+00008e20: 2020 2069 6620 5f70 666c 6167 203d 3d20     if _pflag == 
+00008e30: 3220 3a20 0d0a 2020 2020 2020 2020 2020  2 : ..          
+00008e40: 2020 2020 2020 6173 7365 7274 2065 6173        assert eas
+00008e50: 7469 6e67 2e73 697a 6520 3d3d 206e 6f72  ting.size == nor
+00008e60: 7468 696e 672e 7369 7a65 202c 5c0d 0a20  thing.size ,\.. 
+00008e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e80: 2020 2050 726f 6669 6c65 4572 726f 7228     ProfileError(
+00008e90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008ea0: 2020 2020 2020 2020 2020 2745 6173 7469            'Easti
+00008eb0: 6e67 2061 6e64 204e 6f72 7468 696e 6720  ng and Northing 
+00008ec0: 6d75 7374 2068 6176 6520 7468 6520 7361  must have the sa
+00008ed0: 6d65 2073 697a 652e 270d 0a20 2020 2020  me size.'..     
+00008ee0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00008ef0: 2065 6173 7469 6e67 7c6e 6f72 7468 696e   easting|northin
+00008f00: 6720 7369 7a65 2061 7265 2063 7572 7265  g size are curre
+00008f10: 6e74 6c79 7369 7a65 2069 7320 3c7b 307d  ntlysize is <{0}
+00008f20: 7c7b 317d 3e2e 272e 0d0a 2020 2020 2020  |{1}>.'...      
+00008f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008f40: 2020 666f 726d 6174 2865 6173 7469 6e67    format(easting
+00008f50: 2e73 697a 652c 206e 6f72 7468 696e 672e  .size, northing.
+00008f60: 7369 7a65 2929 0d0a 2020 2020 2020 2020  size))..        
+00008f70: 2020 2020 2020 2020 7365 6c66 2e65 6173          self.eas
+00008f80: 7420 3d65 6173 7469 6e67 200d 0a20 2020  t =easting ..   
+00008f90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00008fa0: 662e 6e6f 7274 6820 3d6e 6f72 7468 696e  f.north =northin
+00008fb0: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
+00008fc0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00008fd0: 2020 2020 2073 656c 662e 4c6f 6361 7469       self.Locati
+00008fe0: 6f6e 2e63 6f6e 7665 7274 5f6c 6f63 6174  on.convert_locat
+00008ff0: 696f 6e5f 325f 6c61 746c 6f6e 2875 746d  ion_2_latlon(utm
+00009000: 5f7a 6f6e 653d 7365 6c66 2e75 746d 5f7a  _zone=self.utm_z
+00009010: 6f6e 6529 0d0a 2020 2020 2020 2020 2020  one)..          
+00009020: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00009030: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00009040: 617a 696d 7574 6820 6973 204e 6f6e 6520  azimuth is None 
+00009050: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00009060: 2020 2020 2020 2073 656c 662e 617a 696d         self.azim
+00009070: 7574 6820 3d20 6675 6e63 2e63 6f6d 7075  uth = func.compu
+00009080: 7465 5f61 7a69 6d75 7468 2865 6173 7469  te_azimuth(easti
+00009090: 6e67 3d73 656c 662e 6561 7374 2c20 0d0a  ng=self.east, ..
+000090a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000090b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000090c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000090d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000090e0: 2020 6966 2073 656c 662e 617a 696d 7574    if self.azimut
-000090f0: 6820 6973 204e 6f6e 6520 3a0d 0a20 2020  h is None :..   
-00009100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009110: 2073 656c 662e 617a 696d 7574 6820 3d20   self.azimuth = 
-00009120: 6675 6e63 2e63 6f6d 7075 7465 5f61 7a69  func.compute_azi
-00009130: 6d75 7468 2865 6173 7469 6e67 3d73 656c  muth(easting=sel
-00009140: 662e 6561 7374 2c20 0d0a 2020 2020 2020  f.east, ..      
-00009150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009180: 2020 6e6f 7274 6869 6e67 3d73 656c 662e    northing=self.
-00009190: 6e6f 7274 6829 0d0a 2020 2020 2020 2020  north)..        
-000091a0: 2020 2020 2020 2020 656c 7365 203a 7365          else :se
-000091b0: 6c66 2e61 7a69 6d75 7468 203d 617a 696d  lf.azimuth =azim
-000091c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000091d0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-000091e0: 2065 6c69 6620 5f70 666c 6167 203d 3d33   elif _pflag ==3
-000091f0: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-00009200: 2020 2020 6173 7365 7274 206c 6174 2e73      assert lat.s
-00009210: 697a 6520 3d3d 206c 6f6e 2e73 697a 6520  ize == lon.size 
-00009220: 2c5c 0d0a 2020 2020 2020 2020 2020 2020  ,\..            
-00009230: 2020 2020 2020 2020 4353 6578 2e70 7943          CSex.pyC
-00009240: 5341 4d54 4572 726f 725f 7072 6f66 696c  SAMTError_profil
-00009250: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
-00009260: 2020 2020 2020 2020 2020 2020 2745 6173              'Eas
-00009270: 7469 6e67 2061 6e64 204e 6f72 7468 696e  ting and Northin
-00009280: 6720 6d75 7374 2068 6176 6520 7468 6520  g must have the 
-00009290: 7361 6d65 2073 697a 652e 270d 0a20 2020  same size.'..   
-000092a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092b0: 2020 2020 2020 2027 206c 6174 7c6c 6f6e         ' lat|lon
-000092c0: 2073 697a 6520 6172 6520 6375 7272 656e   size are curren
-000092d0: 746c 7973 697a 6520 6973 203c 7b30 7d7c  tlysize is <{0}|
-000092e0: 7b31 7d3e 2e27 2e0d 0a20 2020 2020 2020  {1}>.'...       
-000092f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009300: 2020 2066 6f72 6d61 7428 6c61 742e 7369     format(lat.si
-00009310: 7a65 2c20 6c6f 6e2e 7369 7a65 2929 0d0a  ze, lon.size))..
-00009320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009330: 7365 6c66 2e4c 6f63 6174 696f 6e2e 636f  self.Location.co
-00009340: 6e76 6572 745f 6c6f 6361 7469 6f6e 5f32  nvert_location_2
-00009350: 5f75 746d 286c 6174 6974 7564 653d 6c61  _utm(latitude=la
-00009360: 7420 2c0d 0a20 2020 2020 2020 2020 2020  t ,..           
-00009370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009390: 2020 2020 2020 2020 2020 6c6f 6e67 6974            longit
-000093a0: 7564 653d 206c 6f6e 2029 0d0a 2020 2020  ude= lon )..    
-000093b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000093c0: 2e65 6173 7469 6e67 203d 7365 6c66 2e4c  .easting =self.L
-000093d0: 6f63 6174 696f 6e2e 6561 7374 696e 6720  ocation.easting 
-000093e0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000093f0: 2020 2073 656c 662e 6e6f 7274 6869 6e67     self.northing
-00009400: 203d 7365 6c66 2e4c 6f63 6174 696f 6e2e   =self.Location.
-00009410: 6e6f 7274 6869 6e67 200d 0a20 2020 2020  northing ..     
-00009420: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00009430: 6c66 2e61 7a69 6d75 7468 2069 7320 4e6f  lf.azimuth is No
-00009440: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
-00009450: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009460: 617a 696d 7574 6820 3d20 6675 6e63 2e63  azimuth = func.c
-00009470: 6f6d 7075 7465 5f61 7a69 6d75 7468 2865  ompute_azimuth(e
-00009480: 6173 7469 6e67 3d73 656c 662e 6561 7374  asting=self.east
-00009490: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000094a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000094b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000094c0: 2020 2020 2020 2020 2020 206e 6f72 7468             north
-000094d0: 696e 673d 7365 6c66 2e6e 6f72 7468 2c0d  ing=self.north,.
-000094e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000094f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009510: 2020 2020 2020 2020 2069 6e74 6572 706f           interpo
-00009520: 6c61 7465 3d54 7275 6529 0d0a 2020 2020  late=True)..    
-00009530: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00009540: 2020 2020 2020 7365 6c66 2e64 6970 6f6c        self.dipol
-00009550: 655f 6c65 6e67 7468 202c 2073 656c 662e  e_length , self.
-00009560: 7374 6e5f 706f 7369 7469 6f6e 203d 5c0d  stn_position =\.
-00009570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009580: 2050 726f 6669 6c65 2e63 6f6d 7075 7465   Profile.compute
-00009590: 5f64 6970 6f6c 656c 656e 6774 685f 6672  _dipolelength_fr
-000095a0: 6f6d 5f63 6f6f 7264 7328 6561 7374 696e  om_coords(eastin
-000095b0: 6720 3d73 656c 662e 6561 7374 2c20 0d0a  g =self.east, ..
+000090d0: 2020 2020 2020 2020 6e6f 7274 6869 6e67          northing
+000090e0: 3d73 656c 662e 6e6f 7274 6829 0d0a 2020  =self.north)..  
+000090f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00009100: 7365 203a 7365 6c66 2e61 7a69 6d75 7468  se :self.azimuth
+00009110: 203d 617a 696d 200d 0a20 2020 2020 2020   =azim ..       
+00009120: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00009130: 2020 2020 2020 2065 6c69 6620 5f70 666c         elif _pfl
+00009140: 6167 203d 3d33 203a 0d0a 2020 2020 2020  ag ==3 :..      
+00009150: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00009160: 206c 6174 2e73 697a 6520 3d3d 206c 6f6e   lat.size == lon
+00009170: 2e73 697a 6520 2c5c 0d0a 2020 2020 2020  .size ,\..      
+00009180: 2020 2020 2020 2020 2020 2020 2020 5072                Pr
+00009190: 6f66 696c 6545 7272 6f72 280d 0a20 2020  ofileError(..   
+000091a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000091b0: 2020 2020 2027 4561 7374 696e 6720 616e       'Easting an
+000091c0: 6420 4e6f 7274 6869 6e67 206d 7573 7420  d Northing must 
+000091d0: 6861 7665 2074 6865 2073 616d 6520 7369  have the same si
+000091e0: 7a65 2e27 0d0a 2020 2020 2020 2020 2020  ze.'..          
+000091f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009200: 2720 6c61 747c 6c6f 6e20 7369 7a65 2061  ' lat|lon size a
+00009210: 7265 2063 7572 7265 6e74 6c79 7369 7a65  re currentlysize
+00009220: 2069 7320 3c7b 307d 7c7b 317d 3e2e 272e   is <{0}|{1}>.'.
+00009230: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009240: 2020 2020 2020 2020 2020 2020 666f 726d              form
+00009250: 6174 286c 6174 2e73 697a 652c 206c 6f6e  at(lat.size, lon
+00009260: 2e73 697a 6529 290d 0a20 2020 2020 2020  .size))..       
+00009270: 2020 2020 2020 2020 2073 656c 662e 4c6f           self.Lo
+00009280: 6361 7469 6f6e 2e63 6f6e 7665 7274 5f6c  cation.convert_l
+00009290: 6f63 6174 696f 6e5f 325f 7574 6d28 6c61  ocation_2_utm(la
+000092a0: 7469 7475 6465 3d6c 6174 202c 0d0a 2020  titude=lat ,..  
+000092b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092e0: 2020 206c 6f6e 6769 7475 6465 3d20 6c6f     longitude= lo
+000092f0: 6e20 290d 0a20 2020 2020 2020 2020 2020  n )..           
+00009300: 2020 2020 2073 656c 662e 6561 7374 696e       self.eastin
+00009310: 6720 3d73 656c 662e 4c6f 6361 7469 6f6e  g =self.Location
+00009320: 2e65 6173 7469 6e67 2020 0d0a 2020 2020  .easting  ..    
+00009330: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009340: 2e6e 6f72 7468 696e 6720 3d73 656c 662e  .northing =self.
+00009350: 4c6f 6361 7469 6f6e 2e6e 6f72 7468 696e  Location.northin
+00009360: 6720 0d0a 2020 2020 2020 2020 2020 2020  g ..            
+00009370: 2020 2020 6966 2073 656c 662e 617a 696d      if self.azim
+00009380: 7574 6820 6973 204e 6f6e 6520 3a20 0d0a  uth is None : ..
+00009390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000093a0: 2020 2020 7365 6c66 2e61 7a69 6d75 7468      self.azimuth
+000093b0: 203d 2066 756e 632e 636f 6d70 7574 655f   = func.compute_
+000093c0: 617a 696d 7574 6828 6561 7374 696e 673d  azimuth(easting=
+000093d0: 7365 6c66 2e65 6173 742c 0d0a 2020 2020  self.east,..    
+000093e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000093f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009410: 2020 2020 6e6f 7274 6869 6e67 3d73 656c      northing=sel
+00009420: 662e 6e6f 7274 682c 0d0a 2020 2020 2020  f.north,..      
+00009430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009460: 2020 696e 7465 7270 6f6c 6174 653d 5472    interpolate=Tr
+00009470: 7565 290d 0a20 2020 2020 2020 2020 2020  ue)..           
+00009480: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+00009490: 656c 662e 6469 706f 6c65 5f6c 656e 6774  elf.dipole_lengt
+000094a0: 6820 2c20 7365 6c66 2e73 746e 5f70 6f73  h , self.stn_pos
+000094b0: 6974 696f 6e20 3d5c 0d0a 2020 2020 2020  ition =\..      
+000094c0: 2020 2020 2020 2020 2020 5072 6f66 696c            Profil
+000094d0: 652e 636f 6d70 7574 655f 6469 706f 6c65  e.compute_dipole
+000094e0: 6c65 6e67 7468 5f66 726f 6d5f 636f 6f72  length_from_coor
+000094f0: 6473 2865 6173 7469 6e67 203d 7365 6c66  ds(easting =self
+00009500: 2e65 6173 742c 200d 0a20 2020 2020 2020  .east, ..       
+00009510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009540: 2020 6e6f 7274 6869 6e67 203d 7365 6c66    northing =self
+00009550: 2e6e 6f72 7468 2029 0d0a 2020 2020 2020  .north )..      
+00009560: 2020 2020 2020 7365 6c66 2e73 746e 5f69        self.stn_i
+00009570: 6e74 6572 7661 6c3d 7365 6c66 2e73 746e  nterval=self.stn
+00009580: 5f73 6570 6172 6174 696f 6e28 6561 7374  _separation(east
+00009590: 696e 673d 2073 656c 662e 6561 7374 2c20  ing= self.east, 
+000095a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000095b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000095c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095f0: 2020 2020 2020 2020 206e 6f72 7468 696e           northin
-00009600: 6720 3d73 656c 662e 6e6f 7274 6820 290d  g =self.north ).
-00009610: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00009620: 662e 7374 6e5f 696e 7465 7276 616c 3d73  f.stn_interval=s
-00009630: 656c 662e 7374 6e5f 7365 7061 7261 7469  elf.stn_separati
-00009640: 6f6e 2865 6173 7469 6e67 3d20 7365 6c66  on(easting= self
-00009650: 2e65 6173 742c 200d 0a20 2020 2020 2020  .east, ..       
-00009660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009680: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00009690: 6f72 7468 696e 6720 3d73 656c 662e 6e6f  orthing =self.no
-000096a0: 7274 682c 0d0a 2020 2020 2020 2020 2020  rth,..          
-000096b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000095d0: 2020 2020 2020 2020 6e6f 7274 6869 6e67          northing
+000095e0: 203d 7365 6c66 2e6e 6f72 7468 2c0d 0a20   =self.north,.. 
+000095f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009620: 2020 2020 2069 6e74 6572 706f 6c61 7465       interpolate
+00009630: 3d54 7275 6520 290d 0a20 2020 2020 2020  =True )..       
+00009640: 2020 2020 2069 6620 656c 6576 6174 696f       if elevatio
+00009650: 6e20 6973 204e 6f6e 6520 3a20 7365 6c66  n is None : self
+00009660: 2e65 6c65 763d 206e 702e 6675 6c6c 2828  .elev= np.full((
+00009670: 7365 6c66 2e65 6173 742e 7369 7a65 2c29  self.east.size,)
+00009680: 2c20 2e30 2029 200d 0a20 2020 2020 2020  , .0 ) ..       
+00009690: 2020 2020 2065 6c73 6520 3a20 7365 6c66       else : self
+000096a0: 2e65 6c65 7620 3d20 656c 6576 6174 696f  .elev = elevatio
+000096b0: 6e20 0d0a 0d0a 2020 2020 2020 2020 2020  n ....          
 000096c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000096d0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-000096e0: 7270 6f6c 6174 653d 5472 7565 2029 0d0a  rpolate=True )..
-000096f0: 2020 2020 2020 2020 2020 2020 6966 2065              if e
-00009700: 6c65 7661 7469 6f6e 2069 7320 4e6f 6e65  levation is None
-00009710: 203a 2073 656c 662e 656c 6576 3d20 6e70   : self.elev= np
-00009720: 2e66 756c 6c28 2873 656c 662e 6561 7374  .full((self.east
-00009730: 2e73 697a 652c 292c 202e 3020 2920 0d0a  .size,), .0 ) ..
-00009740: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00009750: 203a 2073 656c 662e 656c 6576 203d 2065   : self.elev = e
-00009760: 6c65 7661 7469 6f6e 200d 0a0d 0a20 2020  levation ....   
-00009770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000097a0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-000097b0: 2020 200d 0a20 2020 2064 6566 2067 6574     ..    def get
-000097c0: 5f70 726f 6669 6c65 5f61 6e67 6c65 2873  _profile_angle(s
-000097d0: 656c 662c 2065 6173 7469 6e67 203d 4e6f  elf, easting =No
-000097e0: 6e65 2c20 6e6f 7274 6869 6e67 203d 4e6f  ne, northing =No
-000097f0: 6e65 2029 3a0d 0a20 2020 2020 2020 2022  ne ):..        "
-00009800: 2222 0d0a 2020 2020 2020 2020 4d65 7468  ""..        Meth
-00009810: 6f64 2074 6f20 636f 6d70 7574 6520 7072  od to compute pr
-00009820: 6f66 696c 6520 616e 676c 6520 2e20 0d0a  ofile angle . ..
-00009830: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00009840: 2020 3a70 6172 616d 2065 6173 7469 6e67    :param easting
-00009850: 3a20 2065 6173 7469 6e67 2063 6f72 7264  :  easting corrd
-00009860: 696e 6174 6520 6f66 2074 6865 2073 7461  inate of the sta
-00009870: 7469 6f6e 2070 6f69 6e74 200d 0a20 2020  tion point ..   
-00009880: 2020 2020 203a 7479 7065 2065 6173 7469       :type easti
-00009890: 6e67 3a20 6172 7261 795f 6c69 6b65 200d  ng: array_like .
-000098a0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000098b0: 2020 203a 7061 7261 6d20 6e6f 7274 6869     :param northi
-000098c0: 6e67 3a20 6e6f 7274 6869 6e67 2063 6f6f  ng: northing coo
-000098d0: 7264 696e 6174 6520 6f66 2073 7461 7469  rdinate of stati
-000098e0: 6f6e 2070 6f69 6e74 2e0d 0a20 2020 2020  on point...     
-000098f0: 2020 203a 7479 7065 206e 6f72 7468 696e     :type northin
-00009900: 673a 6172 7261 792d 6c69 6b65 200d 0a20  g:array-like .. 
-00009910: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00009920: 203a 7265 7475 726e 733a 2070 726f 6669   :returns: profi
-00009930: 6c65 2061 6e67 6c65 2069 6e20 6465 6772  le angle in degr
-00009940: 6565 732e 200d 0a20 2020 2020 2020 203a  ees. ..        :
-00009950: 7274 7970 653a 2066 6c6f 6174 0d0a 2020  rtype: float..  
-00009960: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00009970: 2020 2073 656c 662e 5f6c 6f67 6769 6e67     self._logging
-00009980: 2e69 6e66 6f20 280d 0a20 2020 2020 2020  .info (..       
-00009990: 2020 2020 2027 436f 6d70 7574 696e 6720       'Computing 
-000099a0: 5f20 7072 6f66 696c 6520 616e 676c 6520  _ profile angle 
-000099b0: 6f66 2067 656f 656c 6563 7472 6963 2073  of geoelectric s
-000099c0: 7472 696b 652e 2729 0d0a 2020 2020 2020  trike.')..      
-000099d0: 2020 0d0a 2020 2020 2020 2020 6966 2065    ..        if e
-000099e0: 6173 7469 6e67 2069 7320 6e6f 7420 4e6f  asting is not No
-000099f0: 6e65 203a 2073 656c 662e 6561 7374 203d  ne : self.east =
-00009a00: 2065 6173 7469 6e67 200d 0a20 2020 2020   easting ..     
-00009a10: 2020 2069 6620 7365 6c66 2e65 6173 7420     if self.east 
-00009a20: 6973 204e 6f6e 6520 3a0d 0a20 2020 2020  is None :..     
-00009a30: 2020 2020 2020 2072 6169 7365 2043 5365         raise CSe
-00009a40: 782e 7079 4353 414d 5445 7272 6f72 5f6c  x.pyCSAMTError_l
-00009a50: 6f63 6174 696f 6e28 0d0a 2020 2020 2020  ocation(..      
-00009a60: 2020 2020 2020 2020 2020 2745 6173 7469            'Easti
-00009a70: 6e67 2063 6f6f 7264 696e 6174 6573 206d  ng coordinates m
-00009a80: 7573 7420 6265 2070 726f 7669 6465 6420  ust be provided 
-00009a90: 2e20 2729 0d0a 2020 2020 2020 2020 6966  . ')..        if
-00009aa0: 206e 6f72 7468 696e 6720 6973 206e 6f74   northing is not
-00009ab0: 204e 6f6e 6520 3a20 7365 6c66 2e6e 6f72   None : self.nor
-00009ac0: 7468 3d6e 6f72 7468 696e 6720 0d0a 2020  th=northing ..  
-00009ad0: 2020 2020 2020 6966 2073 656c 662e 6e6f        if self.no
-00009ae0: 7274 6820 6973 204e 6f6e 6520 3a20 0d0a  rth is None : ..
-00009af0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00009b00: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-00009b10: 726f 725f 6c6f 6361 7469 6f6e 280d 0a20  ror_location(.. 
-00009b20: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00009b30: 4e6f 7274 6869 6e67 2063 6f6f 7264 696e  Northing coordin
-00009b40: 6174 6520 6d75 7374 2062 6520 7072 6f76  ate must be prov
-00009b50: 6964 6564 2e27 290d 0a20 2020 2020 2020  ided.')..       
-00009b60: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
-00009b70: 6c66 2e65 6173 7420 6973 206e 6f74 204e  lf.east is not N
-00009b80: 6f6e 6520 616e 6420 7365 6c66 2e6e 6f72  one and self.nor
-00009b90: 7468 2069 7320 6e6f 7420 4e6f 6e65 203a  th is not None :
-00009ba0: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
-00009bb0: 7920 3a20 0d0a 2020 2020 2020 2020 2020  y : ..          
-00009bc0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00009bd0: 2020 2020 2020 7365 6c66 2e65 6173 7420        self.east 
-00009be0: 3d73 656c 662e 6561 7374 2e61 7374 7970  =self.east.astyp
-00009bf0: 6528 2766 6c6f 6174 2729 0d0a 2020 2020  e('float')..    
-00009c00: 2020 2020 2020 2020 2020 7365 6c66 2e6e            self.n
-00009c10: 6f72 7468 203d 2073 656c 662e 6e6f 7274  orth = self.nort
-00009c20: 682e 6173 7479 7065 2827 666c 6f61 7427  h.astype('float'
-00009c30: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00009c40: 7863 6570 7420 3a20 0d0a 2020 2020 2020  xcept : ..      
-00009c50: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00009c60: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00009c70: 725f 666c 6f61 7428 0d0a 2020 2020 2020  r_float(..      
-00009c80: 2020 2020 2020 2020 2020 2020 2020 2743                'C
-00009c90: 6f75 6c64 206e 6f74 2063 6f6e 7665 7274  ould not convert
-00009ca0: 2065 6173 7469 6e67 2f6e 6f72 7468 696e   easting/northin
-00009cb0: 6720 746f 2066 6c6f 6174 2e27 290d 0a20  g to float.').. 
-00009cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009cd0: 2020 0d0a 2020 2020 2020 2020 2320 7573    ..        # us
-00009ce0: 6520 7468 6520 6f6e 6520 7769 7468 2074  e the one with t
-00009cf0: 6865 206c 6f77 6572 2073 7461 6e64 6172  he lower standar
-00009d00: 6420 6465 7669 6174 696f 6e0d 0a20 2020  d deviation..   
-00009d10: 2020 2020 2069 6620 7374 6174 735f 696d       if stats_im
-00009d20: 706f 7274 2069 7320 5472 7565 203a 200d  port is True : .
-00009d30: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-00009d40: 6669 6c65 3120 3d73 7053 5441 5453 2e6c  file1 =spSTATS.l
-00009d50: 696e 7265 6772 6573 7328 7365 6c66 2e65  inregress(self.e
-00009d60: 6173 742c 2073 656c 662e 6e6f 7274 6829  ast, self.north)
-00009d70: 0d0a 2020 200d 0a20 2020 2020 2020 2020  ..   ..         
-00009d80: 2020 2070 726f 6669 6c65 3220 3d73 7053     profile2 =spS
-00009d90: 5441 5453 2e6c 696e 7265 6772 6573 7328  TATS.linregress(
-00009da0: 7365 6c66 2e6e 6f72 7468 2c20 7365 6c66  self.north, self
-00009db0: 2e65 6173 7429 0d0a 2020 2020 2020 2020  .east)..        
-00009dc0: 656c 7365 203a 0d0a 2020 2020 2020 2020  else :..        
-00009dd0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00009de0: 6e28 0d0a 2020 2020 2020 2020 2020 2020  n(..            
-00009df0: 2020 2020 2743 6f75 6c64 206e 6f74 2066      'Could not f
-00009e00: 696e 6420 7363 6970 792e 7374 6174 732c  ind scipy.stats,
-00009e10: 2063 616e 6e6f 7420 7573 6520 6d65 7468   cannot use meth
-00009e20: 6f64 206c 696e 6561 7252 6567 7265 7373  od linearRegress
-00009e30: 696f 6e20 270d 0a20 2020 2020 2020 2020  ion '..         
-00009e40: 2020 2020 2020 2020 2027 6368 6563 6b20           'check 
-00009e50: 696e 7374 616c 6c61 7469 6f6e 2079 6f75  installation you
-00009e60: 2063 616e 2067 6574 2073 6369 7079 2066   can get scipy f
-00009e70: 726f 6d20 7363 6970 792e 6f72 672e 2729  rom scipy.org.')
-00009e80: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00009e90: 6c66 2e5f 6c6f 6767 696e 672e 7761 726e  lf._logging.warn
-00009ea0: 696e 6728 0d0a 2020 2020 2020 2020 2020  ing(..          
-00009eb0: 2020 2020 2020 2743 6f75 6c64 206e 6f74        'Could not
-00009ec0: 2066 696e 6420 7363 6970 792e 7374 6174   find scipy.stat
-00009ed0: 732c 2063 616e 6e6f 7420 7573 6520 6d65  s, cannot use me
-00009ee0: 7468 6f64 206c 696e 6561 5265 6772 6573  thod lineaRegres
-00009ef0: 7320 270d 0a20 2020 2020 2020 2020 2020  s '..           
-00009f00: 2020 2020 2020 2020 2027 6368 6563 6b20           'check 
-00009f10: 696e 7374 616c 6c61 7469 6f6e 2079 6f75  installation you
-00009f20: 2063 616e 2067 6574 2073 6369 7079 2066   can get scipy f
-00009f30: 726f 6d20 7363 6970 792e 6f72 672e 2729  rom scipy.org.')
-00009f40: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00009f50: 6973 6520 496d 706f 7274 4572 726f 7228  ise ImportError(
-00009f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009f70: 2020 2743 6f75 6c64 206e 6f74 2066 696e    'Could not fin
-00009f80: 6420 7363 6970 792e 7374 6174 732c 2063  d scipy.stats, c
-00009f90: 616e 6e6f 7420 7573 6520 6d65 7468 6f64  annot use method
-00009fa0: 206c 696e 6561 5265 6772 6573 7320 270d   lineaRegress '.
-00009fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009fc0: 2020 2020 2027 6368 6563 6b20 696e 7374       'check inst
-00009fd0: 616c 6c61 7469 6f6e 2079 6f75 2063 616e  allation you can
-00009fe0: 2067 6574 2073 6369 7079 2066 726f 6d20   get scipy from 
-00009ff0: 7363 6970 792e 6f72 672e 2729 0d0a 2020  scipy.org.')..  
-0000a000: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000a010: 2020 2020 0d0a 2020 2020 2020 2020 7072      ..        pr
-0000a020: 6f66 696c 655f 6c69 6e65 203d 2070 726f  ofile_line = pro
-0000a030: 6669 6c65 315b 3a32 5d0d 0a20 2020 2020  file1[:2]..     
-0000a040: 2020 2023 2069 6620 7468 6520 7072 6f66     # if the prof
-0000a050: 696c 6520 6973 2072 6174 6865 7220 453d  ile is rather E=
-0000a060: 4528 4e29 2c0d 0a20 2020 2020 2020 2023  E(N),..        #
-0000a070: 2074 6865 2070 6172 616d 6574 6572 7320   the parameters 
-0000a080: 6861 7665 2074 6f20 636f 6e76 6572 7465  have to converte
-0000a090: 6420 2069 6e74 6f20 4e3d 4e28 4529 2066  d  into N=N(E) f
-0000a0a0: 6f72 6d3a 0d0a 2020 2020 2020 2020 0d0a  orm:..        ..
-0000a0b0: 2020 2020 2020 2020 6966 2070 726f 6669          if profi
-0000a0c0: 6c65 325b 345d 203c 2070 726f 6669 6c65  le2[4] < profile
-0000a0d0: 315b 345d 3a0d 0a20 2020 2020 2020 2020  1[4]:..         
-0000a0e0: 2020 2070 726f 6669 6c65 5f6c 696e 6520     profile_line 
-0000a0f0: 3d20 2831 2e20 2f20 7072 6f66 696c 6532  = (1. / profile2
-0000a100: 5b30 5d2c 202d 7072 6f66 696c 6532 5b31  [0], -profile2[1
-0000a110: 5d20 2f20 7072 6f66 696c 6532 5b30 5d29  ] / profile2[0])
-0000a120: 0d0a 0d0a 2020 2020 2020 2020 2320 6966  ....        # if
-0000a130: 2073 656c 662e 7072 6f66 696c 655f 616e   self.profile_an
-0000a140: 676c 6520 6973 204e 6f6e 653a 0d0a 2020  gle is None:..  
-0000a150: 2020 2020 2020 7365 6c66 2e70 726f 6669        self.profi
-0000a160: 6c65 5f61 6e67 6c65 203d 2028 3930 202d  le_angle = (90 -
-0000a170: 2028 6e70 2e61 7263 7461 6e28 7072 6f66   (np.arctan(prof
-0000a180: 696c 655f 6c69 6e65 5b30 5d29 202a 2031  ile_line[0]) * 1
-0000a190: 3830 202f 206e 702e 7069 290d 0a20 2020  80 / np.pi)..   
-0000a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1b0: 2020 2020 2020 2020 2020 2029 2025 2031             ) % 1
-0000a1c0: 3830 0d0a 0d0a 2020 2020 2020 2020 2320  80....        # 
-0000a1d0: 6f74 6865 7277 6973 653a 2023 2068 6176  otherwise: # hav
-0000a1e0: 6520 3930 2064 6567 7265 6520 616d 6269  e 90 degree ambi
-0000a1f0: 6775 6974 7920 696e 2073 7472 696b 6520  guity in strike 
-0000a200: 6465 7465 726d 696e 6174 696f 6e0d 0a20  determination.. 
-0000a210: 2020 2020 2020 2023 2063 686f 6f73 6520         # choose 
-0000a220: 7374 7269 6b65 2077 6869 6368 206f 6666  strike which off
-0000a230: 6572 7320 6c61 7267 6572 2061 6e67 6c65  ers larger angle
-0000a240: 2077 6974 6820 7072 6f66 696c 650d 0a20   with profile.. 
-0000a250: 2020 2020 2020 2023 2069 6620 7072 6f66         # if prof
-0000a260: 696c 6520 617a 696d 7574 6820 6973 2069  ile azimuth is i
-0000a270: 6e20 5b30 2c39 305d 2e0d 0a20 2020 200d  n [0,90]...    .
-0000a280: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
-0000a290: 6f66 696c 655f 616e 676c 653d 6e70 2e61  ofile_angle=np.a
-0000a2a0: 726f 756e 6428 7365 6c66 2e70 726f 6669  round(self.profi
-0000a2b0: 6c65 5f61 6e67 6c65 2c32 290d 0a20 2020  le_angle,2)..   
-0000a2c0: 2020 2020 200d 0a20 2020 2020 2020 2070       ..        p
-0000a2d0: 7269 6e74 2827 2d2d 2d2d 3e20 7072 6f66  rint('----> prof
-0000a2e0: 696c 6520 616e 676c 6520 3d20 7b7d 2064  ile angle = {} d
-0000a2f0: 6567 7265 6573 204e 2e45 272e 0d0a 2020  egrees N.E'...  
-0000a300: 2020 2020 2020 2020 2020 2020 666f 726d              form
-0000a310: 6174 2873 656c 662e 7072 6f66 696c 655f  at(self.profile_
-0000a320: 616e 676c 6529 290d 0a0d 0a20 2020 2020  angle))....     
-0000a330: 2020 2023 2063 6f6d 7075 7465 2070 7365     # compute pse
-0000a340: 7564 6f5f 656c 6563 740d 0a20 2020 2020  udo_elect..     
-0000a350: 2020 2023 2069 6620 7365 6c66 2e67 656f     # if self.geo
-0000a360: 656c 6563 7472 6963 5f73 7472 696b 6520  electric_strike 
-0000a370: 6973 204e 6f6e 6520 3a0d 0a20 2020 2020  is None :..     
-0000a380: 2020 2069 6620 2030 3c3d 2073 656c 662e     if  0<= self.
-0000a390: 7072 6f66 696c 655f 616e 676c 6520 3c20  profile_angle < 
-0000a3a0: 3930 203a 0d0a 2020 2020 2020 2020 2020  90 :..          
-0000a3b0: 2020 7365 6c66 2e67 656f 656c 6563 7472    self.geoelectr
-0000a3c0: 6963 5f73 7472 696b 6520 3d73 656c 662e  ic_strike =self.
-0000a3d0: 7072 6f66 696c 655f 616e 676c 6520 2b20  profile_angle + 
-0000a3e0: 3930 200d 0a20 2020 2020 2020 2065 6c69  90 ..        eli
-0000a3f0: 6620 3930 3c3d 2073 656c 662e 7072 6f66  f 90<= self.prof
-0000a400: 696c 655f 616e 676c 6520 3c20 3138 3020  ile_angle < 180 
-0000a410: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0000a420: 656c 662e 6765 6f65 6c65 6374 7269 635f  elf.geoelectric_
-0000a430: 7374 7269 6b65 203d 7365 6c66 2e70 726f  strike =self.pro
-0000a440: 6669 6c65 5f61 6e67 6c65 202d 3930 0d0a  file_angle -90..
-0000a450: 2020 2020 2020 2020 656c 6966 2031 3830          elif 180
-0000a460: 203c 3d20 7365 6c66 2e70 726f 6669 6c65   <= self.profile
-0000a470: 5f61 6e67 6c65 203c 3237 3020 3a0d 0a20  _angle <270 :.. 
-0000a480: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a490: 6765 6f65 6c65 6374 7269 635f 7374 7269  geoelectric_stri
-0000a4a0: 6b65 203d 202d 7365 6c66 2e70 726f 6669  ke = -self.profi
-0000a4b0: 6c65 5f61 6e67 6c65 202b 3930 200d 0a20  le_angle +90 .. 
-0000a4c0: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
-0000a4d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a4e0: 6765 6f65 6c65 6374 7269 635f 7374 7269  geoelectric_stri
-0000a4f0: 6b65 203d 202d 7365 6c66 2e70 726f 6669  ke = -self.profi
-0000a500: 6c65 5f61 6e67 6c65 202d 3930 200d 0a0d  le_angle -90 ...
-0000a510: 0a20 2020 2020 2020 2073 656c 662e 6765  .        self.ge
-0000a520: 6f65 6c65 6374 7269 635f 7374 7269 6b65  oelectric_strike
-0000a530: 203d 2073 656c 662e 6765 6f65 6c65 6374   = self.geoelect
-0000a540: 7269 635f 7374 7269 6b65 2025 2031 3830  ric_strike % 180
-0000a550: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-0000a560: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+000096d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096e0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+000096f0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00009700: 2020 6465 6620 6765 745f 7072 6f66 696c    def get_profil
+00009710: 655f 616e 676c 6528 7365 6c66 2c20 6561  e_angle(self, ea
+00009720: 7374 696e 6720 3d4e 6f6e 652c 206e 6f72  sting =None, nor
+00009730: 7468 696e 6720 3d4e 6f6e 6520 293a 0d0a  thing =None ):..
+00009740: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00009750: 2020 2020 204d 6574 686f 6420 746f 2063       Method to c
+00009760: 6f6d 7075 7465 2070 726f 6669 6c65 2061  ompute profile a
+00009770: 6e67 6c65 202e 200d 0a20 2020 2020 2020  ngle . ..       
+00009780: 200d 0a20 2020 2020 2020 203a 7061 7261   ..        :para
+00009790: 6d20 6561 7374 696e 673a 2020 6561 7374  m easting:  east
+000097a0: 696e 6720 636f 7272 6469 6e61 7465 206f  ing corrdinate o
+000097b0: 6620 7468 6520 7374 6174 696f 6e20 706f  f the station po
+000097c0: 696e 7420 0d0a 2020 2020 2020 2020 3a74  int ..        :t
+000097d0: 7970 6520 6561 7374 696e 673a 2061 7272  ype easting: arr
+000097e0: 6179 5f6c 696b 6520 0d0a 2020 2020 2020  ay_like ..      
+000097f0: 2020 0d0a 2020 2020 2020 2020 3a70 6172    ..        :par
+00009800: 616d 206e 6f72 7468 696e 673a 206e 6f72  am northing: nor
+00009810: 7468 696e 6720 636f 6f72 6469 6e61 7465  thing coordinate
+00009820: 206f 6620 7374 6174 696f 6e20 706f 696e   of station poin
+00009830: 742e 0d0a 2020 2020 2020 2020 3a74 7970  t...        :typ
+00009840: 6520 6e6f 7274 6869 6e67 3a61 7272 6179  e northing:array
+00009850: 2d6c 696b 6520 0d0a 2020 2020 2020 2020  -like ..        
+00009860: 0d0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00009870: 6e73 3a20 7072 6f66 696c 6520 616e 676c  ns: profile angl
+00009880: 6520 696e 2064 6567 7265 6573 2e20 0d0a  e in degrees. ..
+00009890: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+000098a0: 666c 6f61 740d 0a20 2020 2020 2020 2022  float..        "
+000098b0: 2222 0d0a 2020 2020 2020 2020 7365 6c66  ""..        self
+000098c0: 2e5f 6c6f 6767 696e 672e 696e 666f 2028  ._logging.info (
+000098d0: 0d0a 2020 2020 2020 2020 2020 2020 2743  ..            'C
+000098e0: 6f6d 7075 7469 6e67 205f 2070 726f 6669  omputing _ profi
+000098f0: 6c65 2061 6e67 6c65 206f 6620 6765 6f65  le angle of geoe
+00009900: 6c65 6374 7269 6320 7374 7269 6b65 2e27  lectric strike.'
+00009910: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00009920: 2020 2020 2069 6620 6561 7374 696e 6720       if easting 
+00009930: 6973 206e 6f74 204e 6f6e 6520 3a20 7365  is not None : se
+00009940: 6c66 2e65 6173 7420 3d20 6561 7374 696e  lf.east = eastin
+00009950: 6720 0d0a 2020 2020 2020 2020 6966 2073  g ..        if s
+00009960: 656c 662e 6561 7374 2069 7320 4e6f 6e65  elf.east is None
+00009970: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+00009980: 7261 6973 6520 4c6f 6361 7469 6f6e 4572  raise LocationEr
+00009990: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+000099a0: 2020 2020 2020 2745 6173 7469 6e67 2063        'Easting c
+000099b0: 6f6f 7264 696e 6174 6573 206d 7573 7420  oordinates must 
+000099c0: 6265 2070 726f 7669 6465 6420 2e20 2729  be provided . ')
+000099d0: 0d0a 2020 2020 2020 2020 6966 206e 6f72  ..        if nor
+000099e0: 7468 696e 6720 6973 206e 6f74 204e 6f6e  thing is not Non
+000099f0: 6520 3a20 7365 6c66 2e6e 6f72 7468 3d6e  e : self.north=n
+00009a00: 6f72 7468 696e 6720 0d0a 2020 2020 2020  orthing ..      
+00009a10: 2020 6966 2073 656c 662e 6e6f 7274 6820    if self.north 
+00009a20: 6973 204e 6f6e 6520 3a20 0d0a 2020 2020  is None : ..    
+00009a30: 2020 2020 2020 2020 7261 6973 6520 4c6f          raise Lo
+00009a40: 6361 7469 6f6e 4572 726f 7228 0d0a 2020  cationError(..  
+00009a50: 2020 2020 2020 2020 2020 2020 2020 274e                'N
+00009a60: 6f72 7468 696e 6720 636f 6f72 6469 6e61  orthing coordina
+00009a70: 7465 206d 7573 7420 6265 2070 726f 7669  te must be provi
+00009a80: 6465 642e 2729 0d0a 2020 2020 2020 2020  ded.')..        
+00009a90: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00009aa0: 662e 6561 7374 2069 7320 6e6f 7420 4e6f  f.east is not No
+00009ab0: 6e65 2061 6e64 2073 656c 662e 6e6f 7274  ne and self.nort
+00009ac0: 6820 6973 206e 6f74 204e 6f6e 6520 3a0d  h is not None :.
+00009ad0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+00009ae0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00009af0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00009b00: 2020 2020 2073 656c 662e 6561 7374 203d       self.east =
+00009b10: 7365 6c66 2e65 6173 742e 6173 7479 7065  self.east.astype
+00009b20: 2827 666c 6f61 7427 290d 0a20 2020 2020  ('float')..     
+00009b30: 2020 2020 2020 2020 2073 656c 662e 6e6f           self.no
+00009b40: 7274 6820 3d20 7365 6c66 2e6e 6f72 7468  rth = self.north
+00009b50: 2e61 7374 7970 6528 2766 6c6f 6174 2729  .astype('float')
+00009b60: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+00009b70: 6365 7074 203a 200d 0a20 2020 2020 2020  cept : ..       
+00009b80: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00009b90: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
+00009ba0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00009bb0: 436f 756c 6420 6e6f 7420 636f 6e76 6572  Could not conver
+00009bc0: 7420 6561 7374 696e 672f 6e6f 7274 6869  t easting/northi
+00009bd0: 6e67 2074 6f20 666c 6f61 742e 2729 0d0a  ng to float.')..
+00009be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009bf0: 2020 200d 0a20 2020 2020 2020 2023 2075     ..        # u
+00009c00: 7365 2074 6865 206f 6e65 2077 6974 6820  se the one with 
+00009c10: 7468 6520 6c6f 7765 7220 7374 616e 6461  the lower standa
+00009c20: 7264 2064 6576 6961 7469 6f6e 0d0a 2020  rd deviation..  
+00009c30: 2020 2020 2020 6966 2073 7461 7473 5f69        if stats_i
+00009c40: 6d70 6f72 7420 6973 2054 7275 6520 3a20  mport is True : 
+00009c50: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00009c60: 6f66 696c 6531 203d 7370 5354 4154 532e  ofile1 =spSTATS.
+00009c70: 6c69 6e72 6567 7265 7373 2873 656c 662e  linregress(self.
+00009c80: 6561 7374 2c20 7365 6c66 2e6e 6f72 7468  east, self.north
+00009c90: 290d 0a20 2020 0d0a 2020 2020 2020 2020  )..   ..        
+00009ca0: 2020 2020 7072 6f66 696c 6532 203d 7370      profile2 =sp
+00009cb0: 5354 4154 532e 6c69 6e72 6567 7265 7373  STATS.linregress
+00009cc0: 2873 656c 662e 6e6f 7274 682c 2073 656c  (self.north, sel
+00009cd0: 662e 6561 7374 290d 0a20 2020 2020 2020  f.east)..       
+00009ce0: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
+00009cf0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00009d00: 726e 280d 0a20 2020 2020 2020 2020 2020  rn(..           
+00009d10: 2020 2020 2027 436f 756c 6420 6e6f 7420       'Could not 
+00009d20: 6669 6e64 2073 6369 7079 2e73 7461 7473  find scipy.stats
+00009d30: 2c20 6361 6e6e 6f74 2075 7365 206d 6574  , cannot use met
+00009d40: 686f 6420 6c69 6e65 6172 5265 6772 6573  hod linearRegres
+00009d50: 7369 6f6e 2027 0d0a 2020 2020 2020 2020  sion '..        
+00009d60: 2020 2020 2020 2020 2020 2763 6865 636b            'check
+00009d70: 2069 6e73 7461 6c6c 6174 696f 6e20 796f   installation yo
+00009d80: 7520 6361 6e20 6765 7420 7363 6970 7920  u can get scipy 
+00009d90: 6672 6f6d 2073 6369 7079 2e6f 7267 2e27  from scipy.org.'
+00009da0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00009db0: 656c 662e 5f6c 6f67 6769 6e67 2e77 6172  elf._logging.war
+00009dc0: 6e69 6e67 280d 0a20 2020 2020 2020 2020  ning(..         
+00009dd0: 2020 2020 2020 2027 436f 756c 6420 6e6f         'Could no
+00009de0: 7420 6669 6e64 2073 6369 7079 2e73 7461  t find scipy.sta
+00009df0: 7473 2c20 6361 6e6e 6f74 2075 7365 206d  ts, cannot use m
+00009e00: 6574 686f 6420 6c69 6e65 6152 6567 7265  ethod lineaRegre
+00009e10: 7373 2027 0d0a 2020 2020 2020 2020 2020  ss '..          
+00009e20: 2020 2020 2020 2020 2020 2763 6865 636b            'check
+00009e30: 2069 6e73 7461 6c6c 6174 696f 6e20 796f   installation yo
+00009e40: 7520 6361 6e20 6765 7420 7363 6970 7920  u can get scipy 
+00009e50: 6672 6f6d 2073 6369 7079 2e6f 7267 2e27  from scipy.org.'
+00009e60: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00009e70: 6169 7365 2049 6d70 6f72 7445 7272 6f72  aise ImportError
+00009e80: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00009e90: 2020 2027 436f 756c 6420 6e6f 7420 6669     'Could not fi
+00009ea0: 6e64 2073 6369 7079 2e73 7461 7473 2c20  nd scipy.stats, 
+00009eb0: 6361 6e6e 6f74 2075 7365 206d 6574 686f  cannot use metho
+00009ec0: 6420 6c69 6e65 6152 6567 7265 7373 2027  d lineaRegress '
+00009ed0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009ee0: 2020 2020 2020 2763 6865 636b 2069 6e73        'check ins
+00009ef0: 7461 6c6c 6174 696f 6e20 796f 7520 6361  tallation you ca
+00009f00: 6e20 6765 7420 7363 6970 7920 6672 6f6d  n get scipy from
+00009f10: 2073 6369 7079 2e6f 7267 2e27 290d 0a20   scipy.org.').. 
+00009f20: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00009f30: 2020 2020 200d 0a20 2020 2020 2020 2070       ..        p
+00009f40: 726f 6669 6c65 5f6c 696e 6520 3d20 7072  rofile_line = pr
+00009f50: 6f66 696c 6531 5b3a 325d 0d0a 2020 2020  ofile1[:2]..    
+00009f60: 2020 2020 2320 6966 2074 6865 2070 726f      # if the pro
+00009f70: 6669 6c65 2069 7320 7261 7468 6572 2045  file is rather E
+00009f80: 3d45 284e 292c 0d0a 2020 2020 2020 2020  =E(N),..        
+00009f90: 2320 7468 6520 7061 7261 6d65 7465 7273  # the parameters
+00009fa0: 2068 6176 6520 746f 2063 6f6e 7665 7274   have to convert
+00009fb0: 6564 2020 696e 746f 204e 3d4e 2845 2920  ed  into N=N(E) 
+00009fc0: 666f 726d 3a0d 0a20 2020 2020 2020 200d  form:..        .
+00009fd0: 0a20 2020 2020 2020 2069 6620 7072 6f66  .        if prof
+00009fe0: 696c 6532 5b34 5d20 3c20 7072 6f66 696c  ile2[4] < profil
+00009ff0: 6531 5b34 5d3a 0d0a 2020 2020 2020 2020  e1[4]:..        
+0000a000: 2020 2020 7072 6f66 696c 655f 6c69 6e65      profile_line
+0000a010: 203d 2028 312e 202f 2070 726f 6669 6c65   = (1. / profile
+0000a020: 325b 305d 2c20 2d70 726f 6669 6c65 325b  2[0], -profile2[
+0000a030: 315d 202f 2070 726f 6669 6c65 325b 305d  1] / profile2[0]
+0000a040: 290d 0a0d 0a20 2020 2020 2020 2023 2069  )....        # i
+0000a050: 6620 7365 6c66 2e70 726f 6669 6c65 5f61  f self.profile_a
+0000a060: 6e67 6c65 2069 7320 4e6f 6e65 3a0d 0a20  ngle is None:.. 
+0000a070: 2020 2020 2020 2073 656c 662e 7072 6f66         self.prof
+0000a080: 696c 655f 616e 676c 6520 3d20 2839 3020  ile_angle = (90 
+0000a090: 2d20 286e 702e 6172 6374 616e 2870 726f  - (np.arctan(pro
+0000a0a0: 6669 6c65 5f6c 696e 655b 305d 2920 2a20  file_line[0]) * 
+0000a0b0: 3138 3020 2f20 6e70 2e70 6929 0d0a 2020  180 / np.pi)..  
+0000a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a0d0: 2020 2020 2020 2020 2020 2020 2920 2520              ) % 
+0000a0e0: 3138 300d 0a0d 0a20 2020 2020 2020 2023  180....        #
+0000a0f0: 206f 7468 6572 7769 7365 3a20 2320 6861   otherwise: # ha
+0000a100: 7665 2039 3020 6465 6772 6565 2061 6d62  ve 90 degree amb
+0000a110: 6967 7569 7479 2069 6e20 7374 7269 6b65  iguity in strike
+0000a120: 2064 6574 6572 6d69 6e61 7469 6f6e 0d0a   determination..
+0000a130: 2020 2020 2020 2020 2320 6368 6f6f 7365          # choose
+0000a140: 2073 7472 696b 6520 7768 6963 6820 6f66   strike which of
+0000a150: 6665 7273 206c 6172 6765 7220 616e 676c  fers larger angl
+0000a160: 6520 7769 7468 2070 726f 6669 6c65 0d0a  e with profile..
+0000a170: 2020 2020 2020 2020 2320 6966 2070 726f          # if pro
+0000a180: 6669 6c65 2061 7a69 6d75 7468 2069 7320  file azimuth is 
+0000a190: 696e 205b 302c 3930 5d2e 0d0a 2020 2020  in [0,90]...    
+0000a1a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
+0000a1b0: 726f 6669 6c65 5f61 6e67 6c65 3d6e 702e  rofile_angle=np.
+0000a1c0: 6172 6f75 6e64 2873 656c 662e 7072 6f66  around(self.prof
+0000a1d0: 696c 655f 616e 676c 652c 3229 0d0a 2020  ile_angle,2)..  
+0000a1e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000a1f0: 7072 696e 7428 272d 2d2d 2d3e 2070 726f  print('----> pro
+0000a200: 6669 6c65 2061 6e67 6c65 203d 207b 7d20  file angle = {} 
+0000a210: 6465 6772 6565 7320 4e2e 4527 2e0d 0a20  degrees N.E'... 
+0000a220: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0000a230: 6d61 7428 7365 6c66 2e70 726f 6669 6c65  mat(self.profile
+0000a240: 5f61 6e67 6c65 2929 0d0a 0d0a 2020 2020  _angle))....    
+0000a250: 2020 2020 2320 636f 6d70 7574 6520 7073      # compute ps
+0000a260: 6575 646f 5f65 6c65 6374 0d0a 2020 2020  eudo_elect..    
+0000a270: 2020 2020 2320 6966 2073 656c 662e 6765      # if self.ge
+0000a280: 6f65 6c65 6374 7269 635f 7374 7269 6b65  oelectric_strike
+0000a290: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
+0000a2a0: 2020 2020 6966 2020 303c 3d20 7365 6c66      if  0<= self
+0000a2b0: 2e70 726f 6669 6c65 5f61 6e67 6c65 203c  .profile_angle <
+0000a2c0: 2039 3020 3a0d 0a20 2020 2020 2020 2020   90 :..         
+0000a2d0: 2020 2073 656c 662e 6765 6f65 6c65 6374     self.geoelect
+0000a2e0: 7269 635f 7374 7269 6b65 203d 7365 6c66  ric_strike =self
+0000a2f0: 2e70 726f 6669 6c65 5f61 6e67 6c65 202b  .profile_angle +
+0000a300: 2039 3020 0d0a 2020 2020 2020 2020 656c   90 ..        el
+0000a310: 6966 2039 303c 3d20 7365 6c66 2e70 726f  if 90<= self.pro
+0000a320: 6669 6c65 5f61 6e67 6c65 203c 2031 3830  file_angle < 180
+0000a330: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0000a340: 7365 6c66 2e67 656f 656c 6563 7472 6963  self.geoelectric
+0000a350: 5f73 7472 696b 6520 3d73 656c 662e 7072  _strike =self.pr
+0000a360: 6f66 696c 655f 616e 676c 6520 2d39 300d  ofile_angle -90.
+0000a370: 0a20 2020 2020 2020 2065 6c69 6620 3138  .        elif 18
+0000a380: 3020 3c3d 2073 656c 662e 7072 6f66 696c  0 <= self.profil
+0000a390: 655f 616e 676c 6520 3c32 3730 203a 0d0a  e_angle <270 :..
+0000a3a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a3b0: 2e67 656f 656c 6563 7472 6963 5f73 7472  .geoelectric_str
+0000a3c0: 696b 6520 3d20 2d73 656c 662e 7072 6f66  ike = -self.prof
+0000a3d0: 696c 655f 616e 676c 6520 2b39 3020 0d0a  ile_angle +90 ..
+0000a3e0: 2020 2020 2020 2020 656c 7365 203a 0d0a          else :..
+0000a3f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a400: 2e67 656f 656c 6563 7472 6963 5f73 7472  .geoelectric_str
+0000a410: 696b 6520 3d20 2d73 656c 662e 7072 6f66  ike = -self.prof
+0000a420: 696c 655f 616e 676c 6520 2d39 3020 0d0a  ile_angle -90 ..
+0000a430: 0d0a 2020 2020 2020 2020 7365 6c66 2e67  ..        self.g
+0000a440: 656f 656c 6563 7472 6963 5f73 7472 696b  eoelectric_strik
+0000a450: 6520 3d20 7365 6c66 2e67 656f 656c 6563  e = self.geoelec
+0000a460: 7472 6963 5f73 7472 696b 6520 2520 3138  tric_strike % 18
+0000a470: 3020 0d0a 2020 2020 2020 2020 2020 2020  0 ..            
+0000a480: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
+0000a490: 2e67 656f 656c 6563 7472 6963 5f73 7472  .geoelectric_str
+0000a4a0: 696b 6520 3d6e 702e 666c 6f6f 7228 7365  ike =np.floor(se
+0000a4b0: 6c66 2e67 656f 656c 6563 7472 6963 5f73  lf.geoelectric_s
+0000a4c0: 7472 696b 6529 0d0a 2020 2020 2020 2020  trike)..        
+0000a4d0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0000a4e0: 272d 2d2d 2d3e 2067 656f 656c 6563 7472  '----> geoelectr
+0000a4f0: 696b 6520 2073 7472 696b 6520 3d20 7b7d  ike  strike = {}
+0000a500: 2064 6567 7265 6573 204e 2e45 272e 666f   degrees N.E'.fo
+0000a510: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
+0000a520: 2020 2073 656c 662e 6765 6f65 6c65 6374     self.geoelect
+0000a530: 7269 635f 7374 7269 6b65 2929 0d0a 2020  ric_strike))..  
+0000a540: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000a550: 7265 7475 726e 2073 656c 662e 7072 6f66  return self.prof
+0000a560: 696c 655f 616e 676c 652c 2073 656c 662e  ile_angle, self.
 0000a570: 6765 6f65 6c65 6374 7269 635f 7374 7269  geoelectric_stri
-0000a580: 6b65 203d 6e70 2e66 6c6f 6f72 2873 656c  ke =np.floor(sel
-0000a590: 662e 6765 6f65 6c65 6374 7269 635f 7374  f.geoelectric_st
-0000a5a0: 7269 6b65 290d 0a20 2020 2020 2020 200d  rike)..        .
-0000a5b0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0000a5c0: 2d2d 2d2d 3e20 6765 6f65 6c65 6374 7269  ----> geoelectri
-0000a5d0: 6b65 2020 7374 7269 6b65 203d 207b 7d20  ke  strike = {} 
-0000a5e0: 6465 6772 6565 7320 4e2e 4527 2e66 6f72  degrees N.E'.for
-0000a5f0: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
-0000a600: 2020 7365 6c66 2e67 656f 656c 6563 7472    self.geoelectr
-0000a610: 6963 5f73 7472 696b 6529 290d 0a20 2020  ic_strike))..   
-0000a620: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-0000a630: 6574 7572 6e20 7365 6c66 2e70 726f 6669  eturn self.profi
-0000a640: 6c65 5f61 6e67 6c65 2c20 7365 6c66 2e67  le_angle, self.g
-0000a650: 656f 656c 6563 7472 6963 5f73 7472 696b  eoelectric_strik
-0000a660: 650d 0a20 2020 200d 0a20 2020 2040 7374  e..    ..    @st
-0000a670: 6174 6963 6d65 7468 6f64 2020 2020 2020  aticmethod      
-0000a680: 2020 2020 2020 2020 0d0a 2020 2020 6465          ..    de
-0000a690: 6620 7265 616a 7573 745f 636f 6f72 6469  f reajust_coordi
-0000a6a0: 6e61 7465 735f 7661 6c75 6573 2028 2078  nates_values ( x
-0000a6b0: 3d4e 6f6e 652c 2079 3d4e 6f6e 652c 0d0a  =None, y=None,..
-0000a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a6e0: 2020 2020 7374 6e5f 666e 3d4e 6f6e 652c      stn_fn=None,
-0000a6f0: 2020 7265 7772 6974 653d 4661 6c73 652c    rewrite=False,
-0000a700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a720: 2020 2020 2020 7361 7665 7061 7468 3d4e        savepath=N
-0000a730: 6f6e 652c 2020 2a2a 6b77 6172 6773 293a  one,  **kwargs):
-0000a740: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
-0000a750: 2020 2020 2020 2020 5369 6d70 6c65 2073          Simple s
-0000a760: 7461 7469 636d 6574 686f 6420 746f 2072  taticmethod to r
-0000a770: 6561 646a 7574 2020 636f 6f72 6469 6e61  eadjut  coordina
-0000a780: 7465 7320 7661 6c75 6573 2061 6e64 0d0a  tes values and..
-0000a790: 2020 2020 2020 2020 7772 6974 6520 6e65          write ne
-0000a7a0: 7720 7374 6174 696f 6e20 6669 6c65 2e20  w station file. 
-0000a7b0: 0d0a 2020 2020 2020 2020 6279 2064 6566  ..        by def
-0000a7c0: 6175 6c74 202c 2074 6865 2072 6561 6a75  ault , the reaju
-0000a7d0: 7374 6d65 6e74 2073 7562 7374 7261 6374  stment substract
-0000a7e0: 2076 616c 7565 2e20 0d0a 2020 2020 2020   value. ..      
-0000a7f0: 2020 746f 2061 6464 2076 616c 7565 2074    to add value t
-0000a800: 6f20 796f 7520 6f6c 6420 636f 6f72 6469  o you old coordi
-0000a810: 616e 7465 7320 2c20 7573 6520 6e65 6761  antes , use nega
-0000a820: 7469 7665 0d0a 2020 2020 2020 2020 5820  tive..        X 
-0000a830: 616e 6420 5920 6d65 7468 6f64 206f 6666  and Y method off
-0000a840: 6572 2070 6f73 7369 6269 6c69 7479 206f  er possibility o
-0000a850: 6620 6f75 7470 7574 206e 6577 0d0a 2020  f output new..  
-0000a860: 2020 2020 2020 6669 6c65 2062 7920 7365        file by se
-0000a870: 7474 696e 6720 7772 6974 6520 746f 2054  tting write to T
-0000a880: 7275 652e 0d0a 2020 2020 2020 2020 4279  rue...        By
-0000a890: 2063 6f6e 7665 6e74 696f 6e20 7765 2075   convention we u
-0000a8a0: 7365 2058 2061 7320 4541 5354 494e 4720  se X as EASTING 
-0000a8b0: 636f 7272 6563 7469 6f6e 2061 6e64 2059  correction and Y
-0000a8c0: 200d 0a20 2020 2020 2020 2066 6f72 204e   ..        for N
-0000a8d0: 4f52 5448 494e 4720 636f 7272 6563 7469  ORTHING correcti
-0000a8e0: 6f6e 2e0d 0a20 2020 2020 2020 200d 0a20  on...        .. 
-0000a8f0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000a900: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
-0000a910: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0000a920: 2020 2020 2a20 783a 2066 6c6f 6174 200d      * x: float .
-0000a930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a940: 2076 616c 7565 2066 6f72 2061 6a75 7374   value for ajust
-0000a950: 696e 6720 5820 636f 6f72 6469 6e61 7465  ing X coordinate
-0000a960: 7320 5f45 4153 5449 4e47 200d 0a20 2020  s _EASTING ..   
-0000a970: 2020 2020 2020 2020 202a 2079 3a20 666c           * y: fl
-0000a980: 6f61 7420 0d0a 2020 2020 2020 2020 2020  oat ..          
-0000a990: 2020 2020 2020 7661 6c75 6520 666f 7220        value for 
-0000a9a0: 616a 7573 7469 6720 5920 636f 6f72 6469  ajustig Y coordi
-0000a9b0: 6e61 7465 7320 2e5f 4e4f 5254 4849 4e47  nates ._NORTHING
-0000a9c0: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-0000a9d0: 7374 6e5f 6669 6c65 3a20 7374 7220 0d0a  stn_file: str ..
-0000a9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a9f0: 2020 2020 7374 6174 696f 6e20 7072 6f66      station prof
-0000aa00: 696c 6520 6669 6c65 202e 2069 7420 6d61  ile file . it ma
-0000aa10: 7920 6265 2061 2053 544e 2066 696c 6520  y be a STN file 
-0000aa20: 2e20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
-0000aa30: 2a20 7265 7772 6974 653a 2062 6f6f 6c20  * rewrite: bool 
-0000aa40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000aa50: 2020 2020 2020 7265 7772 6974 6520 6120        rewrite a 
-0000aa60: 6e65 7720 7374 6174 696f 6e20 6669 6c65  new station file
-0000aa70: 2061 6674 6572 2072 6561 6a75 7374 2063   after reajust c
-0000aa80: 6f6f 7264 696e 6174 6573 2e20 0d0a 2020  oordinates. ..  
-0000aa90: 2020 2020 2020 2020 2020 2a20 7361 7665            * save
-0000aaa0: 7061 7468 203a 2073 7472 200d 0a20 2020  path : str ..   
-0000aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aac0: 206f 7574 6469 7220 7061 7468 4c69 6b65   outdir pathLike
-0000aad0: 2074 6f20 7361 7665 2079 6f75 7220 6e65   to save your ne
-0000aae0: 7720 7072 6f66 696c 6520 6669 6c65 2e20  w profile file. 
-0000aaf0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000ab00: 2020 2020 5265 7475 726e 7320 0d0a 2020      Returns ..  
-0000ab10: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d        ---------.
-0000ab20: 0a20 2020 2020 2020 2020 2020 202a 2061  .            * a
-0000ab30: 7272 6179 5f6c 696b 6520 200d 0a20 2020  rray_like  ..   
-0000ab40: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-0000ab50: 7469 6f6e 735f 706b 202c 2073 7461 7469  tions_pk , stati
-0000ab60: 6f6e 2070 726f 6669 6c65 2070 6b61 2076  on profile pka v
-0000ab70: 616c 7565 286d 2920 2e0d 0a20 2020 2020  alue(m) ...     
-0000ab80: 2020 2020 2020 2020 2020 2045 6c65 6374             Elect
-0000ab90: 726f 6465 2066 6978 6564 2070 6f69 6e74  rode fixed point
-0000aba0: 2076 616c 7565 2e0d 0a20 2020 2020 2020   value...       
-0000abb0: 2020 2020 202a 2061 7272 6179 5f6c 696b       * array_lik
-0000abc0: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-0000abd0: 2020 2020 6561 7374 696e 6720 636f 6f72      easting coor
-0000abe0: 6469 6e61 7465 2076 616c 7565 2028 6d29  dinate value (m)
-0000abf0: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-0000ac00: 6172 7261 795f 6c69 6b65 200d 0a20 2020  array_like ..   
-0000ac10: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-0000ac20: 7274 6869 6e67 2063 6f6f 7264 696e 6174  rthing coordinat
-0000ac30: 6520 7661 6c75 6520 286d 290d 0a20 2020  e value (m)..   
-0000ac40: 2020 2020 2020 2020 202a 2065 6c65 7661           * eleva
-0000ac50: 7469 6f6e 203a 2061 7272 6179 5f6c 696b  tion : array_lik
-0000ac60: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-0000ac70: 2020 2020 6576 656c 6174 696f 6e20 706f      evelation po
-0000ac80: 696e 7420 2061 7420 6561 6368 2073 7461  int  at each sta
-0000ac90: 7469 6f6e 2028 6d29 0d0a 2020 2020 2020  tion (m)..      
-0000aca0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0000acb0: 2020 2020 2020 2020 3a45 7861 6d70 6c65          :Example
-0000acc0: 203a 2020 0d0a 2020 2020 2020 2020 2020   :  ..          
-0000acd0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000ace0: 3e3e 3e20 6672 6f6d 2070 7963 7361 6d74  >>> from pycsamt
-0000acf0: 2e66 662e 7369 7465 2069 6d70 6f72 7420  .ff.site import 
-0000ad00: 5072 6f66 696c 6520 0d0a 2020 2020 2020  Profile ..      
-0000ad10: 2020 2020 2020 3e3e 3e20 7374 6e5f 6669        >>> stn_fi
-0000ad20: 6c65 203d 4b31 2e73 746e 0d0a 2020 2020  le =K1.stn..    
-0000ad30: 2020 2020 2020 2020 3e3e 3e20 7061 7468          >>> path
-0000ad40: 203d 2020 6f73 2e70 6174 682e 6a6f 696e   =  os.path.join
-0000ad50: 286f 732e 656e 7669 726f 6e5b 2270 7943  (os.environ["pyC
-0000ad60: 5341 4d54 225d 2c0d 0a20 2020 2020 2020  SAMT"],..       
-0000ad70: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0000a580: 6b65 0d0a 2020 2020 0d0a 2020 2020 4073  ke..    ..    @s
+0000a590: 7461 7469 636d 6574 686f 6420 2020 2020  taticmethod     
+0000a5a0: 2020 2020 2020 2020 200d 0a20 2020 2064           ..    d
+0000a5b0: 6566 2072 6561 6a75 7374 5f63 6f6f 7264  ef reajust_coord
+0000a5c0: 696e 6174 6573 5f76 616c 7565 7320 2820  inates_values ( 
+0000a5d0: 783d 4e6f 6e65 2c20 793d 4e6f 6e65 2c0d  x=None, y=None,.
+0000a5e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a600: 2020 2020 2073 746e 5f66 6e3d 4e6f 6e65       stn_fn=None
+0000a610: 2c20 2072 6577 7269 7465 3d46 616c 7365  ,  rewrite=False
+0000a620: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000a630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a640: 2020 2020 2020 2073 6176 6570 6174 683d         savepath=
+0000a650: 4e6f 6e65 2c20 202a 2a6b 7761 7267 7329  None,  **kwargs)
+0000a660: 3a20 0d0a 2020 2020 2020 2020 2222 220d  : ..        """.
+0000a670: 0a20 2020 2020 2020 2053 696d 706c 6520  .        Simple 
+0000a680: 7374 6174 6963 6d65 7468 6f64 2074 6f20  staticmethod to 
+0000a690: 7265 6164 6a75 7420 2063 6f6f 7264 696e  readjut  coordin
+0000a6a0: 6174 6573 2076 616c 7565 7320 616e 640d  ates values and.
+0000a6b0: 0a20 2020 2020 2020 2077 7269 7465 206e  .        write n
+0000a6c0: 6577 2073 7461 7469 6f6e 2066 696c 652e  ew station file.
+0000a6d0: 200d 0a20 2020 2020 2020 2062 7920 6465   ..        by de
+0000a6e0: 6661 756c 7420 2c20 7468 6520 7265 616a  fault , the reaj
+0000a6f0: 7573 746d 656e 7420 7375 6273 7472 6163  ustment substrac
+0000a700: 7420 7661 6c75 652e 200d 0a20 2020 2020  t value. ..     
+0000a710: 2020 2074 6f20 6164 6420 7661 6c75 6520     to add value 
+0000a720: 746f 2079 6f75 206f 6c64 2063 6f6f 7264  to you old coord
+0000a730: 6961 6e74 6573 202c 2075 7365 206e 6567  iantes , use neg
+0000a740: 6174 6976 650d 0a20 2020 2020 2020 2058  ative..        X
+0000a750: 2061 6e64 2059 206d 6574 686f 6420 6f66   and Y method of
+0000a760: 6665 7220 706f 7373 6962 696c 6974 7920  fer possibility 
+0000a770: 6f66 206f 7574 7075 7420 6e65 770d 0a20  of output new.. 
+0000a780: 2020 2020 2020 2066 696c 6520 6279 2073         file by s
+0000a790: 6574 7469 6e67 2077 7269 7465 2074 6f20  etting write to 
+0000a7a0: 5472 7565 2e0d 0a20 2020 2020 2020 2042  True...        B
+0000a7b0: 7920 636f 6e76 656e 7469 6f6e 2077 6520  y convention we 
+0000a7c0: 7573 6520 5820 6173 2045 4153 5449 4e47  use X as EASTING
+0000a7d0: 2063 6f72 7265 6374 696f 6e20 616e 6420   correction and 
+0000a7e0: 5920 0d0a 2020 2020 2020 2020 666f 7220  Y ..        for 
+0000a7f0: 4e4f 5254 4849 4e47 2063 6f72 7265 6374  NORTHING correct
+0000a800: 696f 6e2e 0d0a 2020 2020 2020 2020 0d0a  ion...        ..
+0000a810: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000a820: 7273 200d 0a20 2020 2020 2020 202d 2d2d  rs ..        ---
+0000a830: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0000a840: 2020 2020 202a 2078 3a20 666c 6f61 7420       * x: float 
+0000a850: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a860: 2020 7661 6c75 6520 666f 7220 616a 7573    value for ajus
+0000a870: 7469 6e67 2058 2063 6f6f 7264 696e 6174  ting X coordinat
+0000a880: 6573 205f 4541 5354 494e 4720 0d0a 2020  es _EASTING ..  
+0000a890: 2020 2020 2020 2020 2020 2a20 793a 2066            * y: f
+0000a8a0: 6c6f 6174 200d 0a20 2020 2020 2020 2020  loat ..         
+0000a8b0: 2020 2020 2020 2076 616c 7565 2066 6f72         value for
+0000a8c0: 2061 6a75 7374 6967 2059 2063 6f6f 7264   ajustig Y coord
+0000a8d0: 696e 6174 6573 202e 5f4e 4f52 5448 494e  inates ._NORTHIN
+0000a8e0: 470d 0a20 2020 2020 2020 2020 2020 202a  G..            *
+0000a8f0: 2073 746e 5f66 696c 653a 2073 7472 200d   stn_file: str .
+0000a900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a910: 2020 2020 2073 7461 7469 6f6e 2070 726f       station pro
+0000a920: 6669 6c65 2066 696c 6520 2e20 6974 206d  file file . it m
+0000a930: 6179 2062 6520 6120 5354 4e20 6669 6c65  ay be a STN file
+0000a940: 202e 200d 0a20 2020 2020 2020 2020 2020   . ..           
+0000a950: 202a 2072 6577 7269 7465 3a20 626f 6f6c   * rewrite: bool
+0000a960: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000a970: 2020 2020 2020 2072 6577 7269 7465 2061         rewrite a
+0000a980: 206e 6577 2073 7461 7469 6f6e 2066 696c   new station fil
+0000a990: 6520 6166 7465 7220 7265 616a 7573 7420  e after reajust 
+0000a9a0: 636f 6f72 6469 6e61 7465 732e 200d 0a20  coordinates. .. 
+0000a9b0: 2020 2020 2020 2020 2020 202a 2073 6176             * sav
+0000a9c0: 6570 6174 6820 3a20 7374 7220 0d0a 2020  epath : str ..  
+0000a9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a9e0: 2020 6f75 7464 6972 2070 6174 684c 696b    outdir pathLik
+0000a9f0: 6520 746f 2073 6176 6520 796f 7572 206e  e to save your n
+0000aa00: 6577 2070 726f 6669 6c65 2066 696c 652e  ew profile file.
+0000aa10: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000aa20: 2020 2020 2052 6574 7572 6e73 200d 0a20       Returns .. 
+0000aa30: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000aa40: 0d0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+0000aa50: 6172 7261 795f 6c69 6b65 2020 0d0a 2020  array_like  ..  
+0000aa60: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0000aa70: 6174 696f 6e73 5f70 6b20 2c20 7374 6174  ations_pk , stat
+0000aa80: 696f 6e20 7072 6f66 696c 6520 706b 6120  ion profile pka 
+0000aa90: 7661 6c75 6528 6d29 202e 0d0a 2020 2020  value(m) ...    
+0000aaa0: 2020 2020 2020 2020 2020 2020 456c 6563              Elec
+0000aab0: 7472 6f64 6520 6669 7865 6420 706f 696e  trode fixed poin
+0000aac0: 7420 7661 6c75 652e 0d0a 2020 2020 2020  t value...      
+0000aad0: 2020 2020 2020 2a20 6172 7261 795f 6c69        * array_li
+0000aae0: 6b65 200d 0a20 2020 2020 2020 2020 2020  ke ..           
+0000aaf0: 2020 2020 2065 6173 7469 6e67 2063 6f6f       easting coo
+0000ab00: 7264 696e 6174 6520 7661 6c75 6520 286d  rdinate value (m
+0000ab10: 290d 0a20 2020 2020 2020 2020 2020 202a  )..            *
+0000ab20: 2061 7272 6179 5f6c 696b 6520 0d0a 2020   array_like ..  
+0000ab30: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000ab40: 6f72 7468 696e 6720 636f 6f72 6469 6e61  orthing coordina
+0000ab50: 7465 2076 616c 7565 2028 6d29 0d0a 2020  te value (m)..  
+0000ab60: 2020 2020 2020 2020 2020 2a20 656c 6576            * elev
+0000ab70: 6174 696f 6e20 3a20 6172 7261 795f 6c69  ation : array_li
+0000ab80: 6b65 200d 0a20 2020 2020 2020 2020 2020  ke ..           
+0000ab90: 2020 2020 2065 7665 6c61 7469 6f6e 2070       evelation p
+0000aba0: 6f69 6e74 2020 6174 2065 6163 6820 7374  oint  at each st
+0000abb0: 6174 696f 6e20 286d 290d 0a20 2020 2020  ation (m)..     
+0000abc0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+0000abd0: 0a20 2020 2020 2020 203a 4578 616d 706c  .        :Exampl
+0000abe0: 6520 3a20 200d 0a20 2020 2020 2020 2020  e :  ..         
+0000abf0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000ac00: 203e 3e3e 2066 726f 6d20 7079 6373 616d   >>> from pycsam
+0000ac10: 742e 6666 2e73 6974 6520 696d 706f 7274  t.ff.site import
+0000ac20: 2050 726f 6669 6c65 200d 0a20 2020 2020   Profile ..     
+0000ac30: 2020 2020 2020 203e 3e3e 2073 746e 5f66         >>> stn_f
+0000ac40: 696c 6520 3d4b 312e 7374 6e0d 0a20 2020  ile =K1.stn..   
+0000ac50: 2020 2020 2020 2020 203e 3e3e 2070 6174           >>> pat
+0000ac60: 6820 3d20 206f 732e 7061 7468 2e6a 6f69  h =  os.path.joi
+0000ac70: 6e28 6f73 2e65 6e76 6972 6f6e 5b22 7079  n(os.environ["py
+0000ac80: 4353 414d 5422 5d2c 0d0a 2020 2020 2020  CSAMT"],..      
+0000ac90: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0000aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000acb0: 2020 2770 7963 7361 6d74 272c 2764 6174    'pycsamt','dat
+0000acc0: 6127 2c0d 0a20 2020 2020 2020 2020 2020  a',..           
+0000acd0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+0000ace0: 2020 2020 2020 2020 2020 2020 2073 746e               stn
+0000acf0: 5f66 696c 6529 0d0a 2020 2020 2020 2020  _file)..        
+0000ad00: 2020 2020 3e3e 3e20 7072 6f66 696c 6520      >>> profile 
+0000ad10: 3d50 726f 6669 6c65 2e72 6561 6a75 7374  =Profile.reajust
+0000ad20: 5f63 6f6f 7264 696e 6174 6573 5f76 616c  _coordinates_val
+0000ad30: 7565 7328 0d0a 2020 2020 2020 2020 2020  ues(..          
+0000ad40: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+0000ad50: 783d 2d33 3030 3233 382e 3730 3220 2c79  x=-300238.702 ,y
+0000ad60: 3d2d 3233 3639 2e32 3532 2020 2920 2020  =-2369.252  )   
+0000ad70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad90: 2027 7079 6373 616d 7427 2c27 6461 7461   'pycsamt','data
-0000ada0: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
-0000adb0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0000adc0: 2020 2020 2020 2020 2020 2020 7374 6e5f              stn_
-0000add0: 6669 6c65 290d 0a20 2020 2020 2020 2020  file)..         
-0000ade0: 2020 203e 3e3e 2070 726f 6669 6c65 203d     >>> profile =
-0000adf0: 5072 6f66 696c 652e 7265 616a 7573 745f  Profile.reajust_
-0000ae00: 636f 6f72 6469 6e61 7465 735f 7661 6c75  coordinates_valu
-0000ae10: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
-0000ae20: 202e 2e2e 2020 2020 2020 2020 2020 2078   ...           x
-0000ae30: 3d2d 3330 3032 3338 2e37 3032 202c 793d  =-300238.702 ,y=
-0000ae40: 2d32 3336 392e 3235 3220 2029 2020 2020  -2369.252  )    
-0000ae50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae90: 2020 2020 0d0a 2020 2020 2020 2020 2222      ..        ""
-0000aea0: 220d 0a20 2020 2020 2020 200d 0a20 2020  "..        ..   
-0000aeb0: 2020 2020 2065 6c65 7620 3d6b 7761 7267       elev =kwarg
-0000aec0: 732e 706f 7028 2765 6c65 7661 7469 6f6e  s.pop('elevation
-0000aed0: 272c 204e 6f6e 6529 0d0a 2020 2020 2020  ', None)..      
-0000aee0: 2020 646f 743d 6b77 6172 6773 2e70 6f70    dot=kwargs.pop
-0000aef0: 2827 7374 6174 696f 6e5f 706b 272c 204e  ('station_pk', N
-0000af00: 6f6e 6529 200d 0a20 2020 2020 2020 2065  one) ..        e
-0000af10: 6173 7420 3d6b 7761 7267 732e 706f 7028  ast =kwargs.pop(
-0000af20: 2765 6173 7469 6e67 272c 204e 6f6e 6529  'easting', None)
-0000af30: 0d0a 2020 2020 2020 2020 6e6f 7274 683d  ..        north=
-0000af40: 6b77 6172 6773 2e70 6f70 2827 6e6f 7274  kwargs.pop('nort
-0000af50: 6869 6e67 272c 204e 6f6e 6529 0d0a 2020  hing', None)..  
-0000af60: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000af70: 6966 2069 7369 6e73 7461 6e63 6528 782c  if isinstance(x,
-0000af80: 2073 7472 2920 6f72 2069 7369 6e73 7461   str) or isinsta
-0000af90: 6e63 6528 792c 7374 7229 203a 200d 0a20  nce(y,str) : .. 
-0000afa0: 2020 2020 2020 2020 2020 2074 7279 203a             try :
-0000afb0: 2066 6c6f 6174 2878 292c 2066 6c6f 6174   float(x), float
-0000afc0: 2879 290d 0a20 2020 2020 2020 2020 2020  (y)..           
-0000afd0: 2065 7863 6570 7420 3a0d 0a20 2020 2020   except :..     
-0000afe0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000aff0: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-0000b000: 6f72 5f70 726f 6669 6c65 280d 0a20 2020  or_profile(..   
+0000ad90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ada0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000adb0: 2020 2020 200d 0a20 2020 2020 2020 2022       ..        "
+0000adc0: 2222 0d0a 2020 2020 2020 2020 0d0a 2020  ""..        ..  
+0000add0: 2020 2020 2020 656c 6576 203d 6b77 6172        elev =kwar
+0000ade0: 6773 2e70 6f70 2827 656c 6576 6174 696f  gs.pop('elevatio
+0000adf0: 6e27 2c20 4e6f 6e65 290d 0a20 2020 2020  n', None)..     
+0000ae00: 2020 2064 6f74 3d6b 7761 7267 732e 706f     dot=kwargs.po
+0000ae10: 7028 2773 7461 7469 6f6e 5f70 6b27 2c20  p('station_pk', 
+0000ae20: 4e6f 6e65 2920 0d0a 2020 2020 2020 2020  None) ..        
+0000ae30: 6561 7374 203d 6b77 6172 6773 2e70 6f70  east =kwargs.pop
+0000ae40: 2827 6561 7374 696e 6727 2c20 4e6f 6e65  ('easting', None
+0000ae50: 290d 0a20 2020 2020 2020 206e 6f72 7468  )..        north
+0000ae60: 3d6b 7761 7267 732e 706f 7028 276e 6f72  =kwargs.pop('nor
+0000ae70: 7468 696e 6727 2c20 4e6f 6e65 290d 0a20  thing', None).. 
+0000ae80: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000ae90: 2069 6620 6973 696e 7374 616e 6365 2878   if isinstance(x
+0000aea0: 2c20 7374 7229 206f 7220 6973 696e 7374  , str) or isinst
+0000aeb0: 616e 6365 2879 2c73 7472 2920 3a20 0d0a  ance(y,str) : ..
+0000aec0: 2020 2020 2020 2020 2020 2020 7472 7920              try 
+0000aed0: 3a20 666c 6f61 7428 7829 2c20 666c 6f61  : float(x), floa
+0000aee0: 7428 7929 0d0a 2020 2020 2020 2020 2020  t(y)..          
+0000aef0: 2020 6578 6365 7074 203a 0d0a 2020 2020    except :..    
+0000af00: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000af10: 6520 5072 6f66 696c 6545 7272 6f72 280d  e ProfileError(.
+0000af20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000af30: 2020 2020 2027 5265 6164 6a75 7374 6d65       'Readjustme
+0000af40: 6e74 206e 6f74 2070 6f73 7369 626c 6520  nt not possible 
+0000af50: 7769 7468 2073 7472 206e 756d 6265 722e  with str number.
+0000af60: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+0000af70: 2020 2020 2020 2027 2050 6c65 6173 6520         ' Please 
+0000af80: 7072 6f76 6964 6520 7468 6520 7269 6768  provide the righ
+0000af90: 7420 7661 6c75 6573 206f 6620 7820 616e  t values of x an
+0000afa0: 6420 7920 2e27 290d 0a20 2020 2020 2020  d y .')..       
+0000afb0: 2069 6620 7820 6973 204e 6f6e 6520 3a20   if x is None : 
+0000afc0: 0d0a 2020 2020 2020 2020 2020 2020 7761  ..            wa
+0000afd0: 726e 696e 6773 2e77 6172 6e28 2749 6e20  rnings.warn('In 
+0000afe0: 7072 696e 6369 706c 652c 2072 6561 646a  principle, readj
+0000aff0: 7573 746d 656e 7420 6973 206e 6f74 2070  ustment is not p
+0000b000: 6f73 7369 626c 6520 7769 7468 2027 0d0a  ossible with '..
 0000b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b020: 2027 5265 6164 6a75 7374 6d65 6e74 206e   'Readjustment n
-0000b030: 6f74 2070 6f73 7369 626c 6520 7769 7468  ot possible with
-0000b040: 2073 7472 206e 756d 6265 722e 270d 0a20   str number.'.. 
-0000b050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b060: 2020 2027 2050 6c65 6173 6520 7072 6f76     ' Please prov
-0000b070: 6964 6520 7468 6520 7269 6768 7420 7661  ide the right va
-0000b080: 6c75 6573 206f 6620 7820 616e 6420 7920  lues of x and y 
-0000b090: 2e27 290d 0a20 2020 2020 2020 2069 6620  .')..        if 
-0000b0a0: 7820 6973 204e 6f6e 6520 3a20 0d0a 2020  x is None : ..  
-0000b0b0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-0000b0c0: 6773 2e77 6172 6e28 2749 6e20 7072 696e  gs.warn('In prin
-0000b0d0: 6369 706c 652c 2072 6561 646a 7573 746d  ciple, readjustm
-0000b0e0: 656e 7420 6973 206e 6f74 2070 6f73 7369  ent is not possi
-0000b0f0: 626c 6520 7769 7468 2027 0d0a 2020 2020  ble with '..    
-0000b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b110: 2020 2020 2020 274e 6f6e 6554 7970 6520        'NoneType 
-0000b120: 6e75 6d62 6572 202e 2048 6f77 6576 6572  number . However
-0000b130: 202c 2077 6520 676f 6e6e 6120 7365 7420   , we gonna set 
-0000b140: 5820 746f 2030 2e27 290d 0a20 2020 2020  X to 0.')..     
-0000b150: 2020 2020 2020 2078 3d30 2e20 0d0a 2020         x=0. ..  
-0000b160: 2020 2020 2020 6966 2079 2069 7320 4e6f        if y is No
-0000b170: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
-0000b180: 2020 793d 302e 0d0a 2020 2020 2020 2020    y=0...        
-0000b190: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-0000b1a0: 6e28 2749 6e20 7072 696e 6369 706c 652c  n('In principle,
-0000b1b0: 2072 6561 646a 7573 746d 656e 7420 6973   readjustment is
-0000b1c0: 206e 6f74 2070 6f73 7369 626c 6520 7769   not possible wi
-0000b1d0: 7468 270d 0a20 2020 2020 2020 2020 2020  th'..           
-0000b1e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000b1f0: 204e 6f6e 6554 7970 6520 6e75 6d62 6572   NoneType number
-0000b200: 202e 2048 6f77 6576 6572 202c 2077 6520   . However , we 
-0000b210: 676f 6e6e 6120 7365 7420 5920 746f 2030  gonna set Y to 0
-0000b220: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
-0000b230: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-0000b240: 6620 7374 6e5f 666e 2069 7320 4e6f 6e65  f stn_fn is None
-0000b250: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
-0000b260: 6966 2065 6173 7420 6973 204e 6f6e 6520  if east is None 
-0000b270: 616e 6420 6e6f 7274 6820 6973 204e 6f6e  and north is Non
-0000b280: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-0000b290: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-0000b2a0: 6172 6e20 280d 0a20 2020 2020 2020 2020  arn (..         
-0000b2b0: 2020 2020 2020 2020 2020 2027 4e6f 7420             'Not 
-0000b2c0: 706f 7373 6962 6c65 2074 6f20 7265 616a  possible to reaj
-0000b2d0: 7573 7420 636f 6f72 6469 6e61 7465 732e  ust coordinates.
-0000b2e0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-0000b2f0: 2020 2020 2020 2027 2050 726f 7669 6465         ' Provide
-0000b300: 2061 7420 6c65 6173 7420 6561 7374 696e   at least eastin
-0000b310: 6720 616e 6420 6e6f 7274 6869 6e67 2076  g and northing v
-0000b320: 616c 7565 732e 2729 0d0a 2020 2020 2020  alues.')..      
-0000b330: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000b340: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000b350: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-0000b360: 726f 725f 7374 6174 696f 6e28 0d0a 2020  ror_station(..  
-0000b370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b380: 2020 2743 6f75 6c64 206e 6f74 2066 696e    'Could not fin
-0000b390: 6420 7374 6174 696f 6e20 6669 6c65 2027  d station file '
-0000b3a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b3b0: 2020 2020 2020 2774 6f20 7265 6164 2e20        'to read. 
-0000b3c0: 4361 6e20 6e6f 7420 7265 6164 6a75 7374  Can not readjust
-0000b3d0: 2070 726f 6669 6c65 2063 6f6f 7264 696e   profile coordin
-0000b3e0: 6174 6573 2e27 290d 0a20 2020 2020 2020  ates.')..       
-0000b3f0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000b400: 2020 2069 6620 656c 6576 2069 7320 4e6f     if elev is No
-0000b410: 6e65 203a 2065 6c65 763d 2030 2e20 0d0a  ne : elev= 0. ..
-0000b420: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-0000b430: 6f74 2069 7320 4e6f 6e65 203a 2064 6f74  ot is None : dot
-0000b440: 203d 302e 200d 0a20 2020 2020 2020 200d   =0. ..        .
-0000b450: 0a20 2020 2020 2020 2069 6620 7374 6e5f  .        if stn_
-0000b460: 666e 2069 7320 6e6f 7420 4e6f 6e65 203a  fn is not None :
-0000b470: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000b480: 2069 6e46 4f2e 5f73 656e 7369 7469 7665   inFO._sensitive
-0000b490: 2829 2e77 6869 6368 5f66 696c 6528 6669  ().which_file(fi
-0000b4a0: 6c65 6e61 6d65 3d73 746e 5f66 6e20 2c0d  lename=stn_fn ,.
-0000b4b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b4d0: 2020 2020 2020 2020 2020 2020 2064 6565               dee
-0000b4e0: 703d 4661 6c73 6520 293d 3d27 7374 6e27  p=False )=='stn'
-0000b4f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000b500: 2020 2069 6620 696e 464f 2e5f 7365 6e73     if inFO._sens
-0000b510: 6974 6976 652e 7768 6963 685f 6669 6c65  itive.which_file
-0000b520: 2866 696c 656e 616d 653d 7374 6e5f 666e  (filename=stn_fn
-0000b530: 2029 2021 3d27 7374 6e27 3a20 0d0a 2020   ) !='stn': ..  
-0000b540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b550: 2020 7261 6973 6520 4353 6578 2e70 7943    raise CSex.pyC
-0000b560: 5341 4d54 4572 726f 725f 7072 6f66 696c  SAMTError_profil
-0000b570: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
-0000b580: 2020 2020 2020 2020 2020 2020 2746 696c              'Fil
-0000b590: 6520 7072 6f76 6964 6564 203c 7b30 7d3e  e provided <{0}>
-0000b5a0: 6973 2075 6e61 6363 6570 7461 626c 652e  is unacceptable.
-0000b5b0: 2027 0d0a 2020 2020 2020 2020 2020 2020   '..            
-0000b5c0: 2020 2020 2020 2020 2020 2020 2750 6c65              'Ple
-0000b5d0: 6173 6520 7072 6f76 6964 6520 796f 7572  ase provide your
-0000b5e0: 2072 6967 6874 2073 746e 2066 696c 652e   right stn file.
-0000b5f0: 272e 0d0a 2020 2020 2020 2020 2020 2020  '...            
-0000b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b610: 666f 726d 6174 2873 746e 5f66 6e29 290d  format(stn_fn)).
-0000b620: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0000b630: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-0000b640: 6f70 656e 2873 746e 5f66 6e2c 2027 7227  open(stn_fn, 'r'
-0000b650: 2c20 656e 636f 6469 6e67 3d27 7574 6638  , encoding='utf8
-0000b660: 2729 2061 7320 666e 203a 0d0a 2020 2020  ') as fn :..    
-0000b670: 2020 2020 2020 2020 2020 2020 6673 746e              fstn
-0000b680: 3d20 666e 2e72 6561 646c 696e 6573 2829  = fn.readlines()
-0000b690: 0d0a 2020 2020 2020 2020 2020 2020 2373  ..            #s
-0000b6a0: 7562 7374 7261 6374 2074 6865 2069 6e66  ubstract the inf
-0000b6b0: 6f20 6c69 6e65 2067 656e 6572 6174 650d  o line generate.
-0000b6c0: 0a20 2020 2020 2020 2020 2020 2023 6279  .            #by
-0000b6d0: 2070 7943 5341 4d54 2077 6865 6e20 6372   pyCSAMT when cr
-0000b6e0: 6561 7465 2061 206e 6577 2053 544e 2066  eate a new STN f
-0000b6f0: 696c 6520 0d0a 2020 2020 2020 2020 2020  ile ..          
-0000b700: 2020 666f 7220 7373 202c 2069 6e66 6f6c    for ss , infol
-0000b710: 696e 6573 2069 6e20 656e 756d 6572 6174  ines in enumerat
-0000b720: 6528 6673 746e 293a 200d 0a20 2020 2020  e(fstn): ..     
-0000b730: 2020 2020 2020 2020 2020 2069 6620 7265             if re
-0000b740: 2e6d 6174 6368 2872 275e 3e27 2c20 696e  .match(r'^>', in
-0000b750: 666f 6c69 6e65 7329 2069 7320 204e 6f6e  folines) is  Non
-0000b760: 6520 6f72 5c0d 0a20 2020 2020 2020 2020  e or\..         
-0000b770: 2020 2020 2020 2020 2020 2072 652e 6d61             re.ma
-0000b780: 7463 6828 7227 5e21 272c 2069 6e66 6f6c  tch(r'^!', infol
-0000b790: 696e 6573 2920 6973 2020 4e6f 6e65 203a  ines) is  None :
-0000b7a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000b7b0: 2020 2020 2020 2066 7374 6e20 3d66 7374         fstn =fst
-0000b7c0: 6e5b 7373 3a5d 2023 2074 6861 7420 6d65  n[ss:] # that me
-0000b7d0: 616e 206e 6f20 696e 666f 2069 7320 6f6e  an no info is on
-0000b7e0: 2074 6865 2066 696c 650d 0a20 2020 2020   the file..     
-0000b7f0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000b800: 7265 616b 0d0a 2020 2020 2020 2020 2020  reak..          
-0000b810: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000b820: 2020 2020 7370 5420 3d20 6675 6e63 2e73      spT = func.s
-0000b830: 746e 5f63 6865 636b 5f73 706c 6974 5f74  tn_check_split_t
-0000b840: 7970 6528 6461 7461 5f6c 696e 6573 3d20  ype(data_lines= 
-0000b850: 6673 746e 290d 0a20 2020 2020 2020 2020  fstn)..         
-0000b860: 2020 2069 6620 7370 5420 6973 204e 6f6e     if spT is Non
-0000b870: 6520 3a73 7054 3d27 2027 0d0a 2020 2020  e :spT=' '..    
-0000b880: 2020 2020 2020 2020 6865 6164 6320 3d20          headc = 
-0000b890: 6673 746e 5b30 5d2e 7374 7269 7028 292e  fstn[0].strip().
-0000b8a0: 7370 6c69 7428 7370 5429 0d0a 2020 2020  split(spT)..    
-0000b8b0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000b8c0: 2020 2020 2020 6561 7374 696e 6465 782c        eastindex,
-0000b8d0: 646f 7469 6e64 6578 202c 6e6f 7274 6869  dotindex ,northi
-0000b8e0: 6e64 6578 2c20 5c0d 0a20 2020 2020 2020  ndex, \..       
-0000b8f0: 2020 2020 2020 2020 2065 6c65 7669 6e64           elevind
-0000b900: 6578 203d 205b 3020 666f 7220 6969 2069  ex = [0 for ii i
-0000b910: 6e20 7261 6e67 6520 2834 295d 2020 200d  n range (4)]   .
-0000b920: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0000b930: 2069 6920 2c69 7465 6d20 696e 2065 6e75   ii ,item in enu
-0000b940: 6d65 7261 7465 2868 6561 6463 293a 200d  merate(headc): .
-0000b950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b960: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000b970: 2020 2069 6620 6974 656d 2e66 696e 6428     if item.find(
-0000b980: 2722 6527 293e 3d30 206f 7220 6974 656d  '"e')>=0 or item
-0000b990: 2e6c 6f77 6572 2829 2e66 696e 6428 2765  .lower().find('e
-0000b9a0: 6173 2729 203e 3d30 3a20 0d0a 2020 2020  as') >=0: ..    
-0000b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b9c0: 6561 7374 696e 6465 783d 2069 690d 0a20  eastindex= ii.. 
-0000b9d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000b9e0: 6c69 6620 6974 656d 2e66 696e 6428 2722  lif item.find('"
-0000b9f0: 646f 7427 2920 3e3d 3020 6f72 2069 7465  dot') >=0 or ite
-0000ba00: 6d2e 6c6f 7765 7228 292e 6669 6e64 2827  m.lower().find('
-0000ba10: 7374 6127 293e 3d30 3a0d 0a20 2020 2020  sta')>=0:..     
-0000ba20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000ba30: 6f74 696e 6465 7820 3d69 6920 0d0a 2020  otindex =ii ..  
-0000ba40: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0000ba50: 6966 2069 7465 6d2e 6669 6e64 2827 226e  if item.find('"n
-0000ba60: 2729 203e 3d20 3020 6f72 2069 7465 6d2e  ') >= 0 or item.
-0000ba70: 6c6f 7765 7228 292e 6669 6e64 2827 6e6f  lower().find('no
-0000ba80: 7227 293e 3d30 3a0d 0a20 2020 2020 2020  r')>=0:..       
-0000ba90: 2020 2020 2020 2020 2020 2020 206e 6f72               nor
-0000baa0: 7468 696e 6465 7820 3d20 6969 200d 0a20  thindex = ii .. 
-0000bab0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000bac0: 6c69 6620 6974 656d 2e66 696e 6428 2722  lif item.find('"
-0000bad0: 6827 2920 3e3d 2030 2020 6f72 2069 7465  h') >= 0  or ite
-0000bae0: 6d2e 6c6f 7765 7228 292e 6669 6e64 2827  m.lower().find('
-0000baf0: 656c 6576 2729 3e3d 303a 200d 0a20 2020  elev')>=0: ..   
-0000bb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb10: 2065 6c65 7669 6e64 6578 203d 2069 690d   elevindex = ii.
-0000bb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bb30: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
-0000bb40: 2020 2020 2020 2020 2020 2020 2077 6172               war
-0000bb50: 6e69 6e67 732e 7761 726e 280d 0a20 2020  nings.warn(..   
+0000b020: 2020 2020 2020 2020 2020 274e 6f6e 6554            'NoneT
+0000b030: 7970 6520 6e75 6d62 6572 202e 2048 6f77  ype number . How
+0000b040: 6576 6572 202c 2077 6520 676f 6e6e 6120  ever , we gonna 
+0000b050: 7365 7420 5820 746f 2030 2e27 290d 0a20  set X to 0.').. 
+0000b060: 2020 2020 2020 2020 2020 2078 3d30 2e20             x=0. 
+0000b070: 0d0a 2020 2020 2020 2020 6966 2079 2069  ..        if y i
+0000b080: 7320 4e6f 6e65 203a 0d0a 2020 2020 2020  s None :..      
+0000b090: 2020 2020 2020 793d 302e 0d0a 2020 2020        y=0...    
+0000b0a0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0000b0b0: 2e77 6172 6e28 2749 6e20 7072 696e 6369  .warn('In princi
+0000b0c0: 706c 652c 2072 6561 646a 7573 746d 656e  ple, readjustmen
+0000b0d0: 7420 6973 206e 6f74 2070 6f73 7369 626c  t is not possibl
+0000b0e0: 6520 7769 7468 270d 0a20 2020 2020 2020  e with'..       
+0000b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b100: 2020 2027 204e 6f6e 6554 7970 6520 6e75     ' NoneType nu
+0000b110: 6d62 6572 202e 2048 6f77 6576 6572 202c  mber . However ,
+0000b120: 2077 6520 676f 6e6e 6120 7365 7420 5920   we gonna set Y 
+0000b130: 746f 2030 2e27 290d 0a20 2020 2020 2020  to 0.')..       
+0000b140: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0000b150: 2020 2069 6620 7374 6e5f 666e 2069 7320     if stn_fn is 
+0000b160: 4e6f 6e65 203a 0d0a 2020 2020 2020 2020  None :..        
+0000b170: 2020 2020 6966 2065 6173 7420 6973 204e      if east is N
+0000b180: 6f6e 6520 616e 6420 6e6f 7274 6820 6973  one and north is
+0000b190: 204e 6f6e 6520 3a20 0d0a 2020 2020 2020   None : ..      
+0000b1a0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+0000b1b0: 6773 2e77 6172 6e20 280d 0a20 2020 2020  gs.warn (..     
+0000b1c0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0000b1d0: 4e6f 7420 706f 7373 6962 6c65 2074 6f20  Not possible to 
+0000b1e0: 7265 616a 7573 7420 636f 6f72 6469 6e61  reajust coordina
+0000b1f0: 7465 732e 270d 0a20 2020 2020 2020 2020  tes.'..         
+0000b200: 2020 2020 2020 2020 2020 2027 2050 726f             ' Pro
+0000b210: 7669 6465 2061 7420 6c65 6173 7420 6561  vide at least ea
+0000b220: 7374 696e 6720 616e 6420 6e6f 7274 6869  sting and northi
+0000b230: 6e67 2076 616c 7565 732e 2729 0d0a 2020  ng values.')..  
+0000b240: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+0000b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b260: 7261 6973 6520 5374 6174 696f 6e45 7272  raise StationErr
+0000b270: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
+0000b280: 2020 2020 2020 2020 2027 436f 756c 6420           'Could 
+0000b290: 6e6f 7420 6669 6e64 2073 7461 7469 6f6e  not find station
+0000b2a0: 2066 696c 6520 270d 0a20 2020 2020 2020   file '..       
+0000b2b0: 2020 2020 2020 2020 2020 2020 2027 746f               'to
+0000b2c0: 2072 6561 642e 2043 616e 206e 6f74 2072   read. Can not r
+0000b2d0: 6561 646a 7573 7420 7072 6f66 696c 6520  eadjust profile 
+0000b2e0: 636f 6f72 6469 6e61 7465 732e 2729 0d0a  coordinates.')..
+0000b2f0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0000b300: 2020 2020 2020 2020 2020 6966 2065 6c65            if ele
+0000b310: 7620 6973 204e 6f6e 6520 3a20 656c 6576  v is None : elev
+0000b320: 3d20 302e 200d 0a20 2020 2020 2020 2020  = 0. ..         
+0000b330: 2020 2069 6620 646f 7420 6973 204e 6f6e     if dot is Non
+0000b340: 6520 3a20 646f 7420 3d30 2e20 0d0a 2020  e : dot =0. ..  
+0000b350: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000b360: 6966 2073 746e 5f66 6e20 6973 206e 6f74  if stn_fn is not
+0000b370: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
+0000b380: 2020 2020 2069 6620 696e 464f 2e5f 7365       if inFO._se
+0000b390: 6e73 6974 6976 6528 292e 7768 6963 685f  nsitive().which_
+0000b3a0: 6669 6c65 2866 696c 656e 616d 653d 7374  file(filename=st
+0000b3b0: 6e5f 666e 202c 0d0a 2020 2020 2020 2020  n_fn ,..        
+0000b3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b3e0: 2020 2020 6465 6570 3d46 616c 7365 2029      deep=False )
+0000b3f0: 3d3d 2773 746e 273a 0d0a 2020 2020 2020  =='stn':..      
+0000b400: 2020 2020 2020 2020 2020 6966 2069 6e46            if inF
+0000b410: 4f2e 5f73 656e 7369 7469 7665 2e77 6869  O._sensitive.whi
+0000b420: 6368 5f66 696c 6528 6669 6c65 6e61 6d65  ch_file(filename
+0000b430: 3d73 746e 5f66 6e20 2920 213d 2773 746e  =stn_fn ) !='stn
+0000b440: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
+0000b450: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
+0000b460: 726f 6669 6c65 4572 726f 7228 0d0a 2020  rofileError(..  
+0000b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b480: 2020 2020 2020 2746 696c 6520 7072 6f76        'File prov
+0000b490: 6964 6564 203c 7b30 7d3e 6973 2075 6e61  ided <{0}>is una
+0000b4a0: 6363 6570 7461 626c 652e 2027 0d0a 2020  cceptable. '..  
+0000b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b4c0: 2020 2020 2020 2750 6c65 6173 6520 7072        'Please pr
+0000b4d0: 6f76 6964 6520 796f 7572 2072 6967 6874  ovide your right
+0000b4e0: 2073 746e 2066 696c 652e 272e 0d0a 2020   stn file.'...  
+0000b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b500: 2020 2020 2020 2020 2020 666f 726d 6174            format
+0000b510: 2873 746e 5f66 6e29 290d 0a20 2020 2020  (stn_fn))..     
+0000b520: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000b530: 2020 2020 2077 6974 6820 6f70 656e 2873       with open(s
+0000b540: 746e 5f66 6e2c 2027 7227 2c20 656e 636f  tn_fn, 'r', enco
+0000b550: 6469 6e67 3d27 7574 6638 2729 2061 7320  ding='utf8') as 
+0000b560: 666e 203a 0d0a 2020 2020 2020 2020 2020  fn :..          
+0000b570: 2020 2020 2020 6673 746e 3d20 666e 2e72        fstn= fn.r
+0000b580: 6561 646c 696e 6573 2829 0d0a 2020 2020  eadlines()..    
+0000b590: 2020 2020 2020 2020 2373 7562 7374 7261          #substra
+0000b5a0: 6374 2074 6865 2069 6e66 6f20 6c69 6e65  ct the info line
+0000b5b0: 2067 656e 6572 6174 650d 0a20 2020 2020   generate..     
+0000b5c0: 2020 2020 2020 2023 6279 2070 7943 5341         #by pyCSA
+0000b5d0: 4d54 2077 6865 6e20 6372 6561 7465 2061  MT when create a
+0000b5e0: 206e 6577 2053 544e 2066 696c 6520 0d0a   new STN file ..
+0000b5f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000b600: 7373 202c 2069 6e66 6f6c 696e 6573 2069  ss , infolines i
+0000b610: 6e20 656e 756d 6572 6174 6528 6673 746e  n enumerate(fstn
+0000b620: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+0000b630: 2020 2020 2069 6620 7265 2e6d 6174 6368       if re.match
+0000b640: 2872 275e 3e27 2c20 696e 666f 6c69 6e65  (r'^>', infoline
+0000b650: 7329 2069 7320 204e 6f6e 6520 6f72 5c0d  s) is  None or\.
+0000b660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b670: 2020 2020 2072 652e 6d61 7463 6828 7227       re.match(r'
+0000b680: 5e21 272c 2069 6e66 6f6c 696e 6573 2920  ^!', infolines) 
+0000b690: 6973 2020 4e6f 6e65 203a 200d 0a20 2020  is  None : ..   
+0000b6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b6b0: 2066 7374 6e20 3d66 7374 6e5b 7373 3a5d   fstn =fstn[ss:]
+0000b6c0: 2023 2074 6861 7420 6d65 616e 206e 6f20   # that mean no 
+0000b6d0: 696e 666f 2069 7320 6f6e 2074 6865 2066  info is on the f
+0000b6e0: 696c 650d 0a20 2020 2020 2020 2020 2020  ile..           
+0000b6f0: 2020 2020 2020 2020 2062 7265 616b 0d0a           break..
+0000b700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b710: 0d0a 2020 2020 2020 2020 2020 2020 7370  ..            sp
+0000b720: 5420 3d20 6675 6e63 2e73 746e 5f63 6865  T = func.stn_che
+0000b730: 636b 5f73 706c 6974 5f74 7970 6528 6461  ck_split_type(da
+0000b740: 7461 5f6c 696e 6573 3d20 6673 746e 290d  ta_lines= fstn).
+0000b750: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000b760: 7370 5420 6973 204e 6f6e 6520 3a73 7054  spT is None :spT
+0000b770: 3d27 2027 0d0a 2020 2020 2020 2020 2020  =' '..          
+0000b780: 2020 6865 6164 6320 3d20 6673 746e 5b30    headc = fstn[0
+0000b790: 5d2e 7374 7269 7028 292e 7370 6c69 7428  ].strip().split(
+0000b7a0: 7370 5429 0d0a 2020 2020 2020 2020 2020  spT)..          
+0000b7b0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000b7c0: 6561 7374 696e 6465 782c 646f 7469 6e64  eastindex,dotind
+0000b7d0: 6578 202c 6e6f 7274 6869 6e64 6578 2c20  ex ,northindex, 
+0000b7e0: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
+0000b7f0: 2020 2065 6c65 7669 6e64 6578 203d 205b     elevindex = [
+0000b800: 3020 666f 7220 6969 2069 6e20 7261 6e67  0 for ii in rang
+0000b810: 6520 2834 295d 2020 200d 0a20 2020 2020  e (4)]   ..     
+0000b820: 2020 2020 2020 2066 6f72 2069 6920 2c69         for ii ,i
+0000b830: 7465 6d20 696e 2065 6e75 6d65 7261 7465  tem in enumerate
+0000b840: 2868 6561 6463 293a 200d 0a20 2020 2020  (headc): ..     
+0000b850: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000b860: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000b870: 6974 656d 2e66 696e 6428 2722 6527 293e  item.find('"e')>
+0000b880: 3d30 206f 7220 6974 656d 2e6c 6f77 6572  =0 or item.lower
+0000b890: 2829 2e66 696e 6428 2765 6173 2729 203e  ().find('eas') >
+0000b8a0: 3d30 3a20 0d0a 2020 2020 2020 2020 2020  =0: ..          
+0000b8b0: 2020 2020 2020 2020 2020 6561 7374 696e            eastin
+0000b8c0: 6465 783d 2069 690d 0a20 2020 2020 2020  dex= ii..       
+0000b8d0: 2020 2020 2020 2020 2065 6c69 6620 6974           elif it
+0000b8e0: 656d 2e66 696e 6428 2722 646f 7427 2920  em.find('"dot') 
+0000b8f0: 3e3d 3020 6f72 2069 7465 6d2e 6c6f 7765  >=0 or item.lowe
+0000b900: 7228 292e 6669 6e64 2827 7374 6127 293e  r().find('sta')>
+0000b910: 3d30 3a0d 0a20 2020 2020 2020 2020 2020  =0:..           
+0000b920: 2020 2020 2020 2020 2064 6f74 696e 6465           dotinde
+0000b930: 7820 3d69 6920 0d0a 2020 2020 2020 2020  x =ii ..        
+0000b940: 2020 2020 2020 2020 656c 6966 2069 7465          elif ite
+0000b950: 6d2e 6669 6e64 2827 226e 2729 203e 3d20  m.find('"n') >= 
+0000b960: 3020 6f72 2069 7465 6d2e 6c6f 7765 7228  0 or item.lower(
+0000b970: 292e 6669 6e64 2827 6e6f 7227 293e 3d30  ).find('nor')>=0
+0000b980: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000b990: 2020 2020 2020 206e 6f72 7468 696e 6465         northinde
+0000b9a0: 7820 3d20 6969 200d 0a20 2020 2020 2020  x = ii ..       
+0000b9b0: 2020 2020 2020 2020 2065 6c69 6620 6974           elif it
+0000b9c0: 656d 2e66 696e 6428 2722 6827 2920 3e3d  em.find('"h') >=
+0000b9d0: 2030 2020 6f72 2069 7465 6d2e 6c6f 7765   0  or item.lowe
+0000b9e0: 7228 292e 6669 6e64 2827 656c 6576 2729  r().find('elev')
+0000b9f0: 3e3d 303a 200d 0a20 2020 2020 2020 2020  >=0: ..         
+0000ba00: 2020 2020 2020 2020 2020 2065 6c65 7669             elevi
+0000ba10: 6e64 6578 203d 2069 690d 0a20 2020 2020  ndex = ii..     
+0000ba20: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+0000ba30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000ba40: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+0000ba50: 7761 726e 280d 0a20 2020 2020 2020 2020  warn(..         
+0000ba60: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0000ba70: 5072 696f 7220 746f 2070 726f 7669 6465  Prior to provide
+0000ba80: 2074 6865 2072 6967 6874 2073 7461 7469   the right stati
+0000ba90: 6f6e 270d 0a20 2020 2020 2020 2020 2020  on'..           
+0000baa0: 2020 2020 2020 2020 2020 2020 2027 2070               ' p
+0000bab0: 726f 6669 6c65 2066 696c 652e 2054 6865  rofile file. The
+0000bac0: 2073 7461 7469 6f6e 2066 696c 6520 6d75   station file mu
+0000bad0: 7374 2068 6176 6520 6173 2027 0d0a 2020  st have as '..  
+0000bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000baf0: 2020 2020 2020 2768 6561 646c 696e 6573        'headlines
+0000bb00: 202c 2061 7420 6c65 6173 7420 3a27 0d0a   , at least :'..
+0000bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bb20: 2020 2020 2020 2020 2720 5b22 646f 747c          ' ["dot|
+0000bb30: 7374 612c 2022 657c 6561 7374 696e 672c  sta, "e|easting,
+0000bb40: 2022 6e7c 6e6f 7274 6869 6e67 2c20 2268   "n|northing, "h
+0000bb50: 7c65 6c65 765d 2e27 0d0a 2020 2020 2020  |elev].'..      
 0000bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb70: 2020 2020 2027 5072 696f 7220 746f 2070       'Prior to p
-0000bb80: 726f 7669 6465 2074 6865 2072 6967 6874  rovide the right
-0000bb90: 2073 7461 7469 6f6e 270d 0a20 2020 2020   station'..     
-0000bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bbb0: 2020 2027 2070 726f 6669 6c65 2066 696c     ' profile fil
-0000bbc0: 652e 2054 6865 2073 7461 7469 6f6e 2066  e. The station f
-0000bbd0: 696c 6520 6d75 7374 2068 6176 6520 6173  ile must have as
-0000bbe0: 2027 0d0a 2020 2020 2020 2020 2020 2020   '..            
-0000bbf0: 2020 2020 2020 2020 2020 2020 2768 6561              'hea
-0000bc00: 646c 696e 6573 202c 2061 7420 6c65 6173  dlines , at leas
-0000bc10: 7420 3a27 0d0a 2020 2020 2020 2020 2020  t :'..          
-0000bc20: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
-0000bc30: 5b22 646f 747c 7374 612c 2022 657c 6561  ["dot|sta, "e|ea
-0000bc40: 7374 696e 672c 2022 6e7c 6e6f 7274 6869  sting, "n|northi
-0000bc50: 6e67 2c20 2268 7c65 6c65 765d 2e27 0d0a  ng, "h|elev].'..
-0000bc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc70: 2020 2020 2020 2020 2720 4f6e 6c79 2074          ' Only t
-0000bc80: 6869 7320 6865 6164 2063 616e 2062 6520  his head can be 
-0000bc90: 7061 7273 6564 2e27 290d 0a20 2020 2020  parsed.')..     
-0000bca0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-0000bcb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bcc0: 2020 2020 2072 6169 7365 2043 5365 782e       raise CSex.
-0000bcd0: 7079 4353 414d 5445 7272 6f72 5f70 726f  pyCSAMTError_pro
-0000bce0: 6669 6c65 280d 0a20 2020 2020 2020 2020  file(..         
-0000bcf0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000bd00: 596f 7572 2073 7461 7469 6f6e 2066 696c  Your station fil
-0000bd10: 6520 7072 6f66 6964 6564 2069 7320 7772  e profided is wr
-0000bd20: 6f6e 672e 2027 0d0a 2020 2020 2020 2020  ong. '..        
-0000bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd40: 274f 6e6c 7920 3c22 646f 747c 7374 612c  'Only <"dot|sta,
-0000bd50: 2022 657c 6561 7374 696e 672c 2027 0d0a   "e|easting, '..
-0000bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd70: 2020 2020 2020 2020 2722 6e7c 6e6f 7274          '"n|nort
-0000bd80: 6869 6e67 2c20 2268 7c65 6c65 7661 7469  hing, "h|elevati
-0000bd90: 6f6e 3e20 6361 6e20 6265 2070 6172 7365  on> can be parse
-0000bda0: 642e 2027 290d 0a0d 0a20 2020 2020 2020  d. ')....       
-0000bdb0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000bdc0: 2020 2020 2020 2064 6f74 2c20 6561 7374         dot, east
-0000bdd0: 2c20 6e6f 7274 6820 2c20 656c 6576 203d  , north , elev =
-0000bde0: 5b5b 5d20 666f 7220 6a6a 2069 6e20 7261  [[] for jj in ra
-0000bdf0: 6e67 6528 3429 5d0d 0a20 2020 2020 2020  nge(4)]..       
-0000be00: 2020 2020 2066 6f72 2069 692c 2069 7465       for ii, ite
-0000be10: 6d20 696e 2065 6e75 6d65 7261 7465 2866  m in enumerate(f
-0000be20: 7374 6e29 3a0d 0a20 2020 2020 2020 2020  stn):..         
-0000be30: 2020 2020 2020 2069 7465 6d3d 6974 656d         item=item
-0000be40: 2e73 7472 6970 2829 2e73 706c 6974 2873  .strip().split(s
-0000be50: 7054 290d 0a20 2020 2020 2020 2020 2020  pT)..           
-0000be60: 2020 2020 2066 6f72 206a 6a2c 2076 616c       for jj, val
-0000be70: 7565 2069 6e20 656e 756d 6572 6174 6528  ue in enumerate(
-0000be80: 6974 656d 293a 200d 0a20 2020 2020 2020  item): ..       
-0000be90: 2020 2020 2020 2020 2020 2020 2074 7279               try
-0000bea0: 203a 2076 616c 7565 203d 2066 6c6f 6174   : value = float
-0000beb0: 2876 616c 7565 290d 0a20 2020 2020 2020  (value)..       
-0000bec0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-0000bed0: 6570 7420 3a70 6173 7320 0d0a 2020 2020  ept :pass ..    
-0000bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bef0: 656c 7365 203a 200d 0a20 2020 2020 2020  else : ..       
-0000bf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf10: 2069 6620 6a6a 203d 3d20 6561 7374 696e   if jj == eastin
-0000bf20: 6465 7820 3a20 6561 7374 2e61 7070 656e  dex : east.appen
-0000bf30: 6428 7661 6c75 6529 0d0a 2020 2020 2020  d(value)..      
-0000bf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf50: 2020 6966 206a 6a20 3d3d 206e 6f72 7468    if jj == north
-0000bf60: 696e 6465 7820 3a6e 6f72 7468 2e61 7070  index :north.app
-0000bf70: 656e 6428 7661 6c75 6529 0d0a 2020 2020  end(value)..    
-0000bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf90: 2020 2020 6966 206a 6a20 3d3d 2065 6c65      if jj == ele
-0000bfa0: 7669 6e64 6578 203a 2065 6c65 762e 6170  vindex : elev.ap
-0000bfb0: 7065 6e64 2876 616c 7565 290d 0a20 2020  pend(value)..   
-0000bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bfd0: 2020 2020 2069 6620 6a6a 203d 3d20 646f       if jj == do
-0000bfe0: 7469 6e64 6578 203a 2064 6f74 2e61 7070  tindex : dot.app
-0000bff0: 656e 6428 7661 6c75 6529 0d0a 2020 2020  end(value)..    
-0000c000: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
-0000c010: 2020 2020 2020 2020 6561 7374 696e 672c          easting,
-0000c020: 206e 6f72 7468 696e 6720 2c73 7461 7469   northing ,stati
-0000c030: 6f6e 5f70 6b20 2c20 656c 6576 6174 696f  on_pk , elevatio
-0000c040: 6e20 203d 6e70 2e61 7272 6179 2865 6173  n  =np.array(eas
-0000c050: 7429 2c20 5c0d 0a20 2020 2020 2020 2020  t), \..         
-0000c060: 2020 206e 702e 6172 7261 7928 6e6f 7274     np.array(nort
-0000c070: 6829 2c20 6e70 2e61 7272 6179 2864 6f74  h), np.array(dot
-0000c080: 292c 206e 702e 6172 7261 7928 656c 6576  ), np.array(elev
-0000c090: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0000c0a0: 2020 2020 2069 6620 656c 6576 6174 696f       if elevatio
-0000c0b0: 6e2e 7369 7a65 2020 3c32 203a 2065 6c65  n.size  <2 : ele
-0000c0c0: 7661 7469 6f6e 203d 206e 702e 7265 7065  vation = np.repe
-0000c0d0: 6174 2830 2e2c 6561 7374 2e73 697a 6529  at(0.,east.size)
-0000c0e0: 0d0a 2020 2020 2020 2020 6966 2073 7461  ..        if sta
-0000c0f0: 7469 6f6e 5f70 6b2e 7369 7a65 203c 3220  tion_pk.size <2 
-0000c100: 3a20 7374 6174 696f 6e5f 706b 203d 206e  : station_pk = n
-0000c110: 702e 7265 7065 6174 2830 2e2c 2065 6173  p.repeat(0., eas
-0000c120: 742e 7369 7a65 2029 0d0a 2020 2020 2020  t.size )..      
-0000c130: 2020 0d0a 2020 2020 2020 2020 2320 6561    ..        # ea
-0000c140: 7374 696e 6720 2b3d 2078 0d0a 2020 2020  sting += x..    
-0000c150: 2020 2020 2320 6e6f 7274 6869 6e67 202b      # northing +
-0000c160: 3d79 0d0a 2020 2020 2020 2020 6561 7374  =y..        east
-0000c170: 696e 6720 3d20 6e70 2e61 7070 6c79 5f61  ing = np.apply_a
-0000c180: 6c6f 6e67 5f61 7869 7328 6c61 6d62 6461  long_axis(lambda
-0000c190: 2078 783a 2078 7820 2b20 7820 2c30 2c20   xx: xx + x ,0, 
-0000c1a0: 6561 7374 696e 6720 290d 0a20 2020 2020  easting )..     
-0000c1b0: 2020 206e 6f72 7468 696e 6720 3d6e 702e     northing =np.
-0000c1c0: 6170 706c 795f 616c 6f6e 675f 6178 6973  apply_along_axis
-0000c1d0: 286c 616d 6264 6120 7979 3a20 7979 202b  (lambda yy: yy +
-0000c1e0: 2079 202c 302c 206e 6f72 7468 696e 6729   y ,0, northing)
-0000c1f0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0000c200: 2020 2020 2069 6620 2072 6577 7269 7465       if  rewrite
-0000c210: 2069 7320 2054 7275 6520 3a20 0d0a 2020   is  True : ..  
-0000c220: 2020 2020 2020 2020 2020 6966 2073 746e            if stn
-0000c230: 5f66 6e20 6973 204e 6f6e 6520 3a20 0d0a  _fn is None : ..
-0000c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c250: 7370 5420 3d20 272c 270d 0a20 2020 2020  spT = ','..     
-0000c260: 2020 2020 2020 2020 2020 2072 756e 5f66             run_f
-0000c270: 7374 6e20 3d20 6561 7374 696e 672e 7369  stn = easting.si
-0000c280: 7a65 0d0a 2020 2020 2020 2020 2020 2020  ze..            
-0000c290: 656c 7365 203a 7275 6e5f 6673 746e 203d  else :run_fstn =
-0000c2a0: 206c 656e 2866 7374 6e29 2d31 0d0a 2020   len(fstn)-1..  
-0000c2b0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0000c2c0: 2020 2020 2020 2020 2020 2020 7374 6e5f              stn_
-0000c2d0: 7772 6974 655f 6c69 6e65 7320 3d5b 5d0d  write_lines =[].
-0000c2e0: 0a20 2020 2020 2020 2020 2020 2073 746e  .            stn
-0000c2f0: 5f77 7269 7465 5f6c 696e 6573 2e61 7070  _write_lines.app
-0000c300: 656e 6428 2727 2e6a 6f69 6e28 0d0a 2020  end(''.join(..  
-0000c310: 2020 2020 2020 2020 2020 2020 2020 5b27                ['
-0000c320: 7b30 3a3c 3130 7d7b 317d 272e 666f 726d  {0:<10}{1}'.form
-0000c330: 6174 2827 2222 2264 6f74 2222 2227 2c73  at('"""dot"""',s
-0000c340: 7054 292c 200d 0a20 2020 2020 2020 2020  pT), ..         
-0000c350: 2020 2020 2020 2027 7b30 3a3e 3130 7d7b         '{0:>10}{
-0000c360: 317d 272e 666f 726d 6174 2827 2222 2265  1}'.format('"""e
-0000c370: 2222 2227 2c20 7370 5429 2c20 0d0a 2020  """', spT), ..  
-0000c380: 2020 2020 2020 2020 2020 2020 2020 277b                '{
-0000c390: 303a 3e31 307d 7b31 7d27 2e66 6f72 6d61  0:>10}{1}'.forma
-0000c3a0: 7428 2722 2222 6e22 2222 272c 7370 5429  t('"""n"""',spT)
-0000c3b0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0000c3c0: 2020 2020 277b 303a 3e31 307d 272e 666f      '{0:>10}'.fo
-0000c3d0: 726d 6174 2827 2222 2268 2222 2227 295d  rmat('"""h"""')]
-0000c3e0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-0000c3f0: 7374 6e5f 7772 6974 655f 6c69 6e65 732e  stn_write_lines.
-0000c400: 6170 7065 6e64 2827 5c6e 2729 0d0a 0d0a  append('\n')....
-0000c410: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000c420: 6969 2069 6e20 7261 6e67 6520 2872 756e  ii in range (run
-0000c430: 5f66 7374 6e20 293a 2020 2320 736b 6970  _fstn ):  # skip
-0000c440: 2074 6865 2068 6561 646c 696e 652e 0d0a   the headline...
-0000c450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c460: 7374 6e5f 7772 6974 655f 6c69 6e65 732e  stn_write_lines.
-0000c470: 6170 7065 6e64 2827 272e 6a6f 696e 280d  append(''.join(.
-0000c480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c490: 2020 2020 205b 277b 303a 3c37 7d7b 317d       ['{0:<7}{1}
-0000c4a0: 272e 666f 726d 6174 2873 7461 7469 6f6e  '.format(station
-0000c4b0: 5f70 6b5b 6969 5d2c 2073 7054 292c 200d  _pk[ii], spT), .
-0000c4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c4d0: 2020 2020 2027 7b3a 3e31 322e 3366 7d7b       '{:>12.3f}{
-0000c4e0: 7d27 2e66 6f72 6d61 7428 6561 7374 696e  }'.format(eastin
-0000c4f0: 675b 6969 5d2c 2073 7054 292c 200d 0a20  g[ii], spT), .. 
-0000c500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c510: 2020 2020 277b 3a3e 3132 2e33 667d 7b7d      '{:>12.3f}{}
-0000c520: 272e 666f 726d 6174 286e 6f72 7468 696e  '.format(northin
-0000c530: 675b 6969 5d2c 2073 7054 292c 200d 0a20  g[ii], spT), .. 
-0000c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c550: 2020 2020 277b 3a3e 387d 272e 666f 726d      '{:>8}'.form
-0000c560: 6174 2865 6c65 7661 7469 6f6e 5b69 695d  at(elevation[ii]
-0000c570: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5a0: 2020 205d 2929 0d0a 2020 2020 2020 2020     ]))..        
-0000c5b0: 2020 2020 2020 2020 7374 6e5f 7772 6974          stn_writ
-0000c5c0: 655f 6c69 6e65 732e 6170 7065 6e64 2827  e_lines.append('
-0000c5d0: 5c6e 2729 0d0a 2020 2020 2020 2020 2020  \n')..          
-0000c5e0: 2020 6966 2073 746e 5f66 6e20 6973 204e    if stn_fn is N
-0000c5f0: 6f6e 6520 3a20 666e 6577 5f3d 2753 544e  one : fnew_='STN
-0000c600: 7b30 7d5f 7265 616a 272e 666f 726d 6174  {0}_reaj'.format
-0000c610: 2874 696d 652e 7469 6d65 7a6f 6e65 2920  (time.timezone) 
-0000c620: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000c630: 2065 6c73 6520 3a20 0d0a 2020 2020 2020   else : ..      
-0000c640: 2020 2020 2020 2020 2020 666e 6577 5f3d            fnew_=
-0000c650: 206f 732e 7061 7468 2e62 6173 656e 616d   os.path.basenam
-0000c660: 6528 7374 6e5f 666e 292e 7370 6c69 7428  e(stn_fn).split(
-0000c670: 272e 2729 5b30 5d20 2b20 275f 7265 616a  '.')[0] + '_reaj
-0000c680: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-0000c690: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000c6a0: 2077 6974 6820 6f70 656e 2827 272e 6a6f   with open(''.jo
-0000c6b0: 696e 285b 666e 6577 5f2c 2027 2e73 746e  in([fnew_, '.stn
-0000c6c0: 275d 292c 2027 7727 2c20 656e 636f 6469  ']), 'w', encodi
-0000c6d0: 6e67 3d27 7574 6638 2729 2061 7320 6669  ng='utf8') as fi
-0000c6e0: 6420 3a20 0d0a 2020 2020 2020 2020 2020  d : ..          
-0000c6f0: 2020 2020 2020 6669 642e 7772 6974 656c        fid.writel
-0000c700: 696e 6573 2873 746e 5f77 7269 7465 5f6c  ines(stn_write_l
-0000c710: 696e 6573 290d 0a20 2020 2020 2020 2020  ines)..         
-0000c720: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000c730: 2020 2020 2073 6176 6570 6174 6820 3d20       savepath = 
-0000c740: 6675 6e63 2e63 7061 7468 2028 7361 7665  func.cpath (save
-0000c750: 7061 7468 2c0d 0a20 2020 2020 2020 2020  path,..         
-0000c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c770: 2020 2020 2020 2020 2020 6627 5f7b 5072            f'_{Pr
-0000c780: 6f66 696c 652e 5f5f 6e61 6d65 5f5f 2e6c  ofile.__name__.l
-0000c790: 6f77 6572 2829 7d5f 2729 0d0a 2020 2020  ower()}_')..    
-0000c7a0: 2020 2020 2020 2020 6966 2073 6176 6570          if savep
-0000c7b0: 6174 6820 6973 206e 6f74 204e 6f6e 6520  ath is not None 
-0000c7c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000c7d0: 2020 2073 6875 7469 6c2e 6d6f 7665 2820     shutil.move( 
-0000c7e0: 6f73 2e70 6174 682e 6a6f 696e 286f 732e  os.path.join(os.
-0000c7f0: 6765 7463 7764 2829 2c0d 0a20 2020 2020  getcwd(),..     
-0000c800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c820: 2020 2020 2027 272e 6a6f 696e 285b 666e       ''.join([fn
-0000c830: 6577 5f2c 2027 2e73 746e 275d 2929 2c0d  ew_, '.stn'])),.
-0000c840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c860: 2020 2020 2020 2020 2020 2073 6176 6570             savep
-0000c870: 6174 6820 290d 0a20 2020 200d 0a20 2020  ath )..    ..   
-0000c880: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0000c890: 2d27 2a37 3729 0d0a 2020 2020 2020 2020  -'*77)..        
-0000c8a0: 2020 2020 7072 696e 7428 272d 2d2d 3e20      print('---> 
-0000c8b0: 4e65 7720 3c7b 307d 3e20 7374 6174 696f  New <{0}> statio
-0000c8c0: 6e20 6669 6c65 2068 6173 2062 6565 6e20  n file has been 
-0000c8d0: 7265 7772 6974 7465 6e2e 272e 5c0d 0a20  rewritten.'.\.. 
-0000c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8f0: 2066 6f72 6d61 7428 2727 2e6a 6f69 6e28   format(''.join(
-0000c900: 5b66 6e65 775f 2c20 272e 7374 6e27 5d29  [fnew_, '.stn'])
-0000c910: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-0000c920: 7072 696e 7428 272d 2d2d 3e20 7361 7665  print('---> save
-0000c930: 7061 7468 203a 203c 7b30 7d3e 272e 666f  path : <{0}>'.fo
-0000c940: 726d 6174 2873 6176 6570 6174 6829 2029  rmat(savepath) )
-0000c950: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-0000c960: 696e 7428 272d 272a 3737 290d 0a20 2020  int('-'*77)..   
-0000c970: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-0000c980: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000c990: 2020 2020 2072 6574 7572 6e20 7374 6174       return stat
-0000c9a0: 696f 6e5f 706b 2c20 6561 7374 696e 6720  ion_pk, easting 
-0000c9b0: 2c20 6e6f 7274 6869 6e67 202c 2065 6c65  , northing , ele
-0000c9c0: 7661 7469 6f6e 2020 2020 2020 0d0a 2020  vation      ..  
-0000c9d0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000c9e0: 6465 6620 7374 7261 6967 6874 656e 5f70  def straighten_p
-0000c9f0: 726f 6669 6c65 6c69 6e65 2028 7365 6c66  rofileline (self
-0000ca00: 2c20 583d 4e6f 6e65 2c20 593d 4e6f 6e65  , X=None, Y=None
-0000ca10: 202c 0d0a 2020 2020 2020 2020 2020 2020   ,..            
-0000ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca30: 2020 2020 7374 7261 6967 6874 5f74 7970      straight_typ
-0000ca40: 6520 3d27 636c 6173 7369 6327 2c20 0d0a  e ='classic', ..
-0000ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca70: 7265 616a 7573 743d 2830 2c30 292c 206f  reajust=(0,0), o
-0000ca80: 7574 7075 7420 3d46 616c 7365 2c0d 0a20  utput =False,.. 
-0000ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000caa0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0000cab0: 2a6b 7761 7267 7329 3a0d 0a20 2020 2020  *kwargs):..     
-0000cac0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-0000cad0: 4d65 7468 6f64 2074 6f20 7374 7261 6967  Method to straig
-0000cae0: 6874 656e 2070 726f 6669 6c65 206c 696e  hten profile lin
-0000caf0: 6520 616e 642f 6f72 2072 6573 6361 6c65  e and/or rescale
-0000cb00: 6420 0d0a 2020 2020 2020 2020 636f 6f72  d ..        coor
-0000cb10: 6469 6e61 7465 732e 2020 5573 6572 2063  dinates.  User c
-0000cb20: 616e 2072 6561 646a 7573 7420 636f 6f72  an readjust coor
-0000cb30: 6469 6e61 7465 7120 0d0a 2020 2020 2020  dinateq ..      
-0000cb40: 2020 6f66 2070 726f 6669 6c65 2062 7920    of profile by 
-0000cb50: 6164 6469 6e67 2063 6f6f 7264 696e 6174  adding coordinat
-0000cb60: 6520 6f66 2072 6561 646a 7573 7461 7469  e of readjustati
-0000cb70: 6f6e 2020 0d0a 2020 2020 2020 2020 4d65  on  ..        Me
-0000cb80: 7468 6f64 2070 726f 7669 6465 7320 3320  thod provides 3 
-0000cb90: 7479 7065 206f 6620 7374 7261 6967 6874  type of straight
-0000cba0: 656e 2070 726f 6669 6c65 2e0d 0a20 2020  en profile...   
-0000cbb0: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-0000cbc0: 2263 6c61 7373 6963 222c 2069 7420 636f  "classic", it co
-0000cbd0: 756c 6420 6265 200d 0a20 2020 2020 2020  uld be ..       
-0000cbe0: 2022 276e 6174 7572 616c 206f 7220 6469   "'natural or di
-0000cbf0: 7374 6f72 6465 6427 2c20 6571 7569 6469  storded', equidi
-0000cc00: 7374 616e 7422 202e 200d 0a20 2020 2020  stant" . ..     
-0000cc10: 2020 2022 6e61 7475 7261 6c20 6f72 2064     "natural or d
-0000cc20: 6973 746f 7264 6564 2054 7970 6522 2069  istorded Type" i
-0000cc30: 7320 6e6f 7420 746f 2073 7472 6169 6768  s not to straigh
-0000cc40: 7420 6120 0d0a 2020 2020 2020 2020 7072  t a ..        pr
-0000cc50: 6f66 696c 6520 6c69 6b65 2061 2073 7472  ofile like a str
-0000cc60: 6169 6768 7420 6c69 6e65 2062 7574 202c  aight line but ,
-0000cc70: 2069 7420 6b65 6570 7320 7468 650d 0a20   it keeps the.. 
-0000cc80: 2020 2020 2020 2065 7175 6964 6973 7461         equidista
-0000cc90: 6e74 2070 6f69 6e74 206f 6620 7468 6520  nt point of the 
-0000cca0: 7374 6174 696f 6e20 6174 206e 6f72 6d61  station at norma
-0000ccb0: 6c20 706c 6163 650d 0a20 2020 2020 2020  l place..       
-0000ccc0: 2074 6861 7420 7468 6520 7375 7276 6579   that the survey
-0000ccd0: 206d 7573 7420 6265 2e20 736f 6d65 7469   must be. someti
-0000cce0: 6d65 7320 6f6e 2074 6865 2066 6965 6c64  mes on the field
-0000ccf0: 202c 0d0a 2020 2020 2020 2020 6372 6577   ,..        crew
-0000cd00: 206d 6179 2067 6574 2061 726f 756e 6420   may get around 
-0000cd10: 736f 6d65 206f 6273 7461 636c 6520 616e  some obstacle an
-0000cd20: 6420 6465 7370 6974 6520 7468 650d 0a20  d despite the.. 
-0000cd30: 2020 2020 2020 206c 696e 6520 6973 206e         line is n
-0000cd40: 6f74 2073 7472 6169 6768 7420 2c20 7468  ot straight , th
-0000cd50: 6520 6469 7374 616e 6365 2020 6265 7477  e distance  betw
-0000cd60: 6565 6e20 7374 6174 696f 6e20 0d0a 2020  een station ..  
-0000cd70: 2020 2020 2020 6973 2064 6973 746f 7264        is distord
-0000cd80: 6564 2e20 5573 696e 6720 2764 6973 746f  ed. Using 'disto
-0000cd90: 7264 206f 7220 6e61 7475 7261 6c20 7479  rd or natural ty
-0000cda0: 7065 2027 202c 0d0a 2020 2020 2020 2020  pe ' ,..        
-0000cdb0: 6974 2077 696c 6c20 7368 6f77 2074 6865  it will show the
-0000cdc0: 2072 6967 6874 2070 6c61 6365 2073 7461   right place sta
-0000cdd0: 7469 6f6e 206d 7573 7420 6265 2e0d 0a20  tion must be... 
-0000cde0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000cdf0: 202e 2e20 6e6f 7465 3a3a 2020 666f 7220   .. note::  for 
-0000ce00: 6561 7369 6572 2061 7070 726f 6368 2077  easier approch w
-0000ce10: 6520 7573 6520 580d 0a20 2020 2020 2020  e use X..       
-0000ce20: 2020 2020 2020 2020 2020 6173 2065 6173            as eas
-0000ce30: 7469 6e67 2061 6e64 2059 2061 7320 6e6f  ting and Y as no
-0000ce40: 7274 6869 6e67 2e20 0d0a 0d0a 2020 2020  rthing. ....    
-0000ce50: 2020 2020 3a70 6172 616d 2058 3a20 6561      :param X: ea
-0000ce60: 7374 696e 6720 636f 6f72 6469 6e61 7465  sting coordinate
-0000ce70: 7320 6172 7261 792e 200d 0a20 2020 2020  s array. ..     
-0000ce80: 2020 203a 7479 7065 2058 3a20 6172 7261     :type X: arra
-0000ce90: 795f 6c69 6b65 2028 6e64 6172 7279 2c20  y_like (ndarry, 
-0000cea0: 6172 7261 792c 3129 0d0a 2020 2020 2020  array,1)..      
-0000ceb0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000cec0: 3a70 6172 616d 2059 3a20 6e6f 7274 6869  :param Y: northi
-0000ced0: 6e67 2063 6f6f 7264 696e 6174 6573 2061  ng coordinates a
-0000cee0: 7272 6179 200d 0a20 2020 2020 2020 203a  rray ..        :
-0000cef0: 7479 7065 2059 3a20 6172 7261 795f 6c69  type Y: array_li
-0000cf00: 6b65 2028 6e64 6172 7261 792c 3129 0d0a  ke (ndarray,1)..
-0000cf10: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000cf20: 2020 3a70 6172 616d 2073 7472 6169 6768    :param straigh
-0000cf30: 745f 7479 7065 3a20 7479 7065 206f 6620  t_type: type of 
-0000cf40: 7374 7261 6967 6874 656e 202c 6974 2063  straighten ,it c
-0000cf50: 6f75 6c64 200d 0a20 2020 2020 2020 2020  ould ..         
-0000cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf70: 2020 2062 6520 2265 7175 6973 7461 6e74     be "equistant
-0000cf80: 206f 7220 6567 616c 2c20 6e61 7475 7261   or egal, natura
-0000cf90: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-0000cfa0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0000cfb0: 7220 6469 7374 6f72 6422 2e20 2a64 6566  r distord". *def
-0000cfc0: 6175 6c74 2a20 6973 2022 636c 6173 7369  ault* is "classi
-0000cfd0: 6322 0d0a 2020 2020 2020 2020 3a74 7970  c"..        :typ
-0000cfe0: 6520 7374 7261 6967 6874 5f74 7970 653a  e straight_type:
-0000cff0: 2073 7472 200d 0a0d 0a20 2020 2020 2020   str ....       
-0000d000: 203a 7061 7261 6d20 7265 616a 7573 743a   :param reajust:
-0000d010: 2020 636f 6f72 6469 6e61 7465 7320 666f    coordinates fo
-0000d020: 7220 7265 616a 7573 746d 656e 7420 280d  r reajustment (.
-0000d030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d040: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-0000d050: 6578 2030 203a 7820 696e 6465 7820 3120  ex 0 :x index 1 
-0000d060: 3a20 7920 2920 200d 0a20 2020 2020 2020  : y )  ..       
-0000d070: 203a 7479 7065 2072 6561 6a75 7374 3a20   :type reajust: 
-0000d080: 7475 706c 650d 0a20 2020 2020 2020 2022  tuple..        "
-0000d090: 2222 0d0a 2020 2020 2020 2020 7365 6c66  ""..        self
-0000d0a0: 2e5f 6c6f 6767 696e 672e 696e 666f 2028  ._logging.info (
-0000d0b0: 2750 726f 6669 6c65 2063 6f6f 7264 696e  'Profile coordin
-0000d0c0: 6174 6573 2058 2061 6e64 2020 5920 270d  ates X and  Y '.
-0000d0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d0e0: 2020 2020 2020 2020 2020 2020 2027 6172               'ar
-0000d0f0: 6520 7363 616c 6c69 6e67 2e20 5363 616c  e scalling. Scal
-0000d100: 6520 4d65 7468 6f64 2069 7320 3c7b 307d  e Method is <{0}
-0000d110: 3e27 2e0d 0a20 2020 2020 2020 2020 2020  >'...           
-0000d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d130: 2020 2020 2066 6f72 6d61 7428 2073 7472       format( str
-0000d140: 6169 6768 745f 7479 7065 2929 0d0a 2020  aight_type))..  
-0000d150: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000d160: 7361 7665 7061 7468 203d 6b77 6172 6773  savepath =kwargs
-0000d170: 2e70 6f70 2827 7361 7665 7061 7468 272c  .pop('savepath',
-0000d180: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
-0000d190: 6966 2073 6176 6570 6174 6820 6973 206e  if savepath is n
-0000d1a0: 6f74 204e 6f6e 653a 200d 0a20 2020 2020  ot None: ..     
-0000d1b0: 2020 2020 2020 2073 656c 662e 7361 7665         self.save
-0000d1c0: 7061 7468 203d 2073 6176 6570 6174 680d  path = savepath.
-0000d1d0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000d1e0: 2020 2052 4557 3d46 616c 7365 2020 2020     REW=False    
-0000d1f0: 2020 2020 2020 2020 2020 2023 2063 6f6f             # coo
-0000d200: 7264 696e 6174 6573 2073 6361 6c69 6e67  rdinates scaling
-0000d210: 2066 6c61 6720 616e 6420 636f 6e74 726f   flag and contro
-0000d220: 6c20 6e65 7720 6f75 7470 7574 730d 0a20  l new outputs.. 
-0000d230: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000d240: 2069 6620 5820 6973 206e 6f74 204e 6f6e   if X is not Non
-0000d250: 6520 3a20 7365 6c66 2e65 6173 7420 3d20  e : self.east = 
-0000d260: 5820 0d0a 2020 2020 2020 2020 6966 2059  X ..        if Y
-0000d270: 2069 7320 6e6f 7420 4e6f 6e65 203a 2073   is not None : s
-0000d280: 656c 662e 6e6f 7274 6820 3d20 590d 0a20  elf.north = Y.. 
-0000d290: 2020 2020 2020 2069 6620 7365 6c66 2e65         if self.e
-0000d2a0: 6173 7420 6973 204e 6f6e 6520 6f72 2073  ast is None or s
-0000d2b0: 656c 662e 6e6f 7274 6820 6973 204e 6f6e  elf.north is Non
-0000d2c0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-0000d2d0: 2072 6169 7365 2043 5365 782e 7079 4353   raise CSex.pyCS
-0000d2e0: 414d 5445 7272 6f72 5f70 726f 6669 6c65  AMTError_profile
-0000d2f0: 2827 4e6f 2070 6f73 7369 626c 6520 7761  ('No possible wa
-0000d300: 7920 746f 2073 7472 6169 6768 7465 6e20  y to straighten 
-0000d310: 6f75 7420 270d 0a20 2020 2020 2020 2020  out '..         
-0000d320: 2020 2020 2020 2027 7468 6520 7072 6f66         'the prof
-0000d330: 696c 6520 6c69 6e65 202e 2050 6c65 6173  ile line . Pleas
-0000d340: 6520 7072 6f76 6964 6520 7468 6520 7269  e provide the ri
-0000d350: 6768 7420 636f 6f72 6469 6e61 7465 732e  ght coordinates.
-0000d360: 2027 290d 0a20 2020 2020 2020 200d 0a20   ')..        .. 
-0000d370: 2020 2020 2020 2069 6620 7365 6c66 2e65         if self.e
-0000d380: 6173 742e 7369 7a65 2021 3d20 7365 6c66  ast.size != self
-0000d390: 2e6e 6f72 7468 2e73 697a 6520 3a20 0d0a  .north.size : ..
-0000d3a0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000d3b0: 6520 4353 6578 2e70 7943 5341 4d54 4572  e CSex.pyCSAMTEr
-0000d3c0: 726f 725f 7072 6f66 696c 6528 2758 2061  ror_profile('X a
-0000d3d0: 6e64 2059 206d 7573 7420 6265 2074 6865  nd Y must be the
-0000d3e0: 2073 616d 6520 7369 7a65 2e20 270d 0a20   same size. '.. 
-0000d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d400: 2020 2020 2020 2758 2068 6173 2061 2073        'X has a s
-0000d410: 697a 6520 3c7b 307d 3e20 7768 696c 6520  ize <{0}> while 
-0000d420: 5920 6861 7320 7468 6520 7369 7a65 203c  Y has the size <
-0000d430: 7b31 7d3e 2e20 270d 0a20 2020 2020 2020  {1}>. '..       
-0000d440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d450: 274c 696e 6520 6361 6e6e 6f74 2062 6520  'Line cannot be 
-0000d460: 7374 7261 6967 6874 656e 6564 2e20 270d  straightened. '.
-0000d470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d480: 2020 2020 2020 2020 2020 2750 6c65 6173            'Pleas
-0000d490: 6520 7072 6f76 6964 6520 7468 6520 7361  e provide the sa
-0000d4a0: 6d65 2073 697a 6520 6f66 2062 6f74 6820  me size of both 
-0000d4b0: 6172 7261 7973 272e 5c0d 0a20 2020 2020  arrays'.\..     
-0000d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4d0: 2020 2020 2020 2020 666f 726d 6174 2873          format(s
-0000d4e0: 656c 662e 6561 7374 2e73 697a 652c 2073  elf.east.size, s
-0000d4f0: 656c 662e 6e6f 7274 682e 7369 7a65 2929  elf.north.size))
-0000d500: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d510: 2020 0d0a 2020 2020 2020 2020 2320 7265    ..        # re
-0000d520: 7363 616c 6c65 6420 7468 6520 636f 6f72  scalled the coor
-0000d530: 6469 6e61 7465 7320 0d0a 2020 2020 2020  dinates ..      
-0000d540: 2020 6966 2072 6561 6a75 7374 2069 7320    if reajust is 
-0000d550: 6e6f 7420 4e6f 6e65 203a 0d0a 2020 2020  not None :..    
-0000d560: 2020 2020 2020 2020 6966 206c 656e 2872          if len(r
-0000d570: 6561 6a75 7374 2920 213d 3220 3a20 0d0a  eajust) !=2 : ..
-0000d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d590: 7261 6973 6520 4353 6578 2e70 7943 5341  raise CSex.pyCSA
-0000d5a0: 4d54 4572 726f 725f 7072 6f66 696c 6528  MTError_profile(
-0000d5b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d5c0: 2020 2020 2020 2243 6f75 6c64 206e 6f74        "Could not
-0000d5d0: 2072 6561 6a75 7374 2063 6f6f 7264 696e   reajust coordin
-0000d5e0: 6174 6573 2062 6579 6f6e 6420 7468 7265  ates beyond thre
-0000d5f0: 6520 7661 6c75 6573 2e22 0d0a 2020 2020  e values."..    
-0000d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d610: 224f 6e6c 7920 7820 3d72 6561 6a75 7374  "Only x =reajust
-0000d620: 5b30 5d20 616e 6420 793d 7265 616a 7573  [0] and y=reajus
-0000d630: 745b 315d 2063 616e 2062 6520 6163 6365  t[1] can be acce
-0000d640: 7074 6564 2e20 2229 0d0a 2020 2020 2020  pted. ")..      
-0000d650: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000d660: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000d670: 6469 706f 6c65 5f6c 656e 6774 6820 6973  dipole_length is
-0000d680: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
-0000d690: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0000d6a0: 2d2d 3e20 4469 706f 6c65 6c65 6e67 7468  --> Dipolelength
-0000d6b0: 2020 6973 2063 6f6d 7075 7469 6e67 2027    is computing '
-0000d6c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d6d0: 2020 2020 2020 2020 2774 6f20 7374 7261          'to stra
-0000d6e0: 6967 6874 656e 206f 7574 2020 7072 6f66  ighten out  prof
-0000d6f0: 696c 652e 2729 0d0a 2020 2020 2020 2020  ile.')..        
-0000d700: 2020 2020 2020 2020 7365 6c66 2e5f 6c6f          self._lo
-0000d710: 6767 696e 672e 696e 666f 2028 0d0a 2020  gging.info (..  
-0000d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d730: 2020 2757 6520 6172 6520 636f 6d70 7574    'We are comput
-0000d740: 696e 6720 6469 706f 6c65 6c65 6e67 7468  ing dipolelength
-0000d750: 2020 746f 2073 7472 6169 6768 7420 2070    to straight  p
-0000d760: 726f 6669 6c65 2e27 290d 0a20 2020 2020  rofile.')..     
-0000d770: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000d780: 2020 2020 2020 2020 2020 2020 2064 6970               dip
-0000d790: 6f6c 4c65 6e67 202c 2073 746e 5f70 6b20  olLeng , stn_pk 
-0000d7a0: 3d20 7365 6c66 2e63 6f6d 7075 7465 5f64  = self.compute_d
-0000d7b0: 6970 6f6c 656c 656e 6774 685f 6672 6f6d  ipolelength_from
-0000d7c0: 5f63 6f6f 7264 7328 0d0a 2020 2020 2020  _coords(..      
-0000d7d0: 2020 2020 2020 2020 2020 2020 2020 6561                ea
-0000d7e0: 7374 696e 673d 7365 6c66 2e65 6173 742c  sting=self.east,
-0000d7f0: 206e 6f72 7468 696e 6720 3d73 656c 662e   northing =self.
-0000d800: 6e6f 7274 6869 6e67 290d 0a20 2020 2020  northing)..     
-0000d810: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-0000d820: 6e67 732e 7761 726e 280d 0a20 2020 2020  ngs.warn(..     
-0000d830: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000d840: 5765 2061 7265 2063 6f6d 7075 7469 6e67  We are computing
-0000d850: 2064 6970 6f6c 6520 6c65 6e67 7468 2061   dipole length a
-0000d860: 6e64 2077 6520 6173 7375 6d65 2027 0d0a  nd we assume '..
-0000d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d880: 2020 2020 2774 6865 2073 7461 7469 6f6e      'the station
-0000d890: 7320 636f 6f72 6469 6e61 7465 7320 6172  s coordinates ar
-0000d8a0: 6520 696e 2074 6865 2063 656e 7465 7220  e in the center 
-0000d8b0: 6f66 2065 6163 6820 6469 706f 6c65 2e27  of each dipole.'
-0000d8c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d8d0: 2020 2020 2020 2720 4469 706f 6c65 204c        ' Dipole L
-0000d8e0: 656e 6774 6820 6973 203d 207b 307d 206d  ength is = {0} m
-0000d8f0: 2061 6e64 2074 6865 2074 6f74 616c 2027   and the total '
-0000d900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d910: 2020 2020 2020 276c 656e 6774 6820 6973        'length is
-0000d920: 203d 207b 317d 206d 2e27 2e66 6f72 6d61   = {1} m.'.forma
-0000d930: 7428 6469 706f 6c4c 656e 672c 200d 0a20  t(dipolLeng, .. 
+0000bb70: 2020 2720 4f6e 6c79 2074 6869 7320 6865    ' Only this he
+0000bb80: 6164 2063 616e 2062 6520 7061 7273 6564  ad can be parsed
+0000bb90: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+0000bba0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0000bbb0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000bbc0: 6169 7365 2050 726f 6669 6c65 4572 726f  aise ProfileErro
+0000bbd0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+0000bbe0: 2020 2020 2020 2020 2020 2020 2759 6f75              'You
+0000bbf0: 7220 7374 6174 696f 6e20 6669 6c65 2070  r station file p
+0000bc00: 726f 6669 6465 6420 6973 2077 726f 6e67  rofided is wrong
+0000bc10: 2e20 270d 0a20 2020 2020 2020 2020 2020  . '..           
+0000bc20: 2020 2020 2020 2020 2020 2020 2027 4f6e               'On
+0000bc30: 6c79 203c 2264 6f74 7c73 7461 2c20 2265  ly <"dot|sta, "e
+0000bc40: 7c65 6173 7469 6e67 2c20 270d 0a20 2020  |easting, '..   
+0000bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bc60: 2020 2020 2027 226e 7c6e 6f72 7468 696e       '"n|northin
+0000bc70: 672c 2022 687c 656c 6576 6174 696f 6e3e  g, "h|elevation>
+0000bc80: 2063 616e 2062 6520 7061 7273 6564 2e20   can be parsed. 
+0000bc90: 2729 0d0a 0d0a 2020 2020 2020 2020 2020  ')....          
+0000bca0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000bcb0: 2020 2020 646f 742c 2065 6173 742c 206e      dot, east, n
+0000bcc0: 6f72 7468 202c 2065 6c65 7620 3d5b 5b5d  orth , elev =[[]
+0000bcd0: 2066 6f72 206a 6a20 696e 2072 616e 6765   for jj in range
+0000bce0: 2834 295d 0d0a 2020 2020 2020 2020 2020  (4)]..          
+0000bcf0: 2020 666f 7220 6969 2c20 6974 656d 2069    for ii, item i
+0000bd00: 6e20 656e 756d 6572 6174 6528 6673 746e  n enumerate(fstn
+0000bd10: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000bd20: 2020 2020 6974 656d 3d69 7465 6d2e 7374      item=item.st
+0000bd30: 7269 7028 292e 7370 6c69 7428 7370 5429  rip().split(spT)
+0000bd40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000bd50: 2020 666f 7220 6a6a 2c20 7661 6c75 6520    for jj, value 
+0000bd60: 696e 2065 6e75 6d65 7261 7465 2869 7465  in enumerate(ite
+0000bd70: 6d29 3a20 0d0a 2020 2020 2020 2020 2020  m): ..          
+0000bd80: 2020 2020 2020 2020 2020 7472 7920 3a20            try : 
+0000bd90: 7661 6c75 6520 3d20 666c 6f61 7428 7661  value = float(va
+0000bda0: 6c75 6529 0d0a 2020 2020 2020 2020 2020  lue)..          
+0000bdb0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0000bdc0: 203a 7061 7373 200d 0a20 2020 2020 2020   :pass ..       
+0000bdd0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0000bde0: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+0000bdf0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000be00: 206a 6a20 3d3d 2065 6173 7469 6e64 6578   jj == eastindex
+0000be10: 203a 2065 6173 742e 6170 7065 6e64 2876   : east.append(v
+0000be20: 616c 7565 290d 0a20 2020 2020 2020 2020  alue)..         
+0000be30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000be40: 6620 6a6a 203d 3d20 6e6f 7274 6869 6e64  f jj == northind
+0000be50: 6578 203a 6e6f 7274 682e 6170 7065 6e64  ex :north.append
+0000be60: 2876 616c 7565 290d 0a20 2020 2020 2020  (value)..       
+0000be70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000be80: 2069 6620 6a6a 203d 3d20 656c 6576 696e   if jj == elevin
+0000be90: 6465 7820 3a20 656c 6576 2e61 7070 656e  dex : elev.appen
+0000bea0: 6428 7661 6c75 6529 0d0a 2020 2020 2020  d(value)..      
+0000beb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bec0: 2020 6966 206a 6a20 3d3d 2064 6f74 696e    if jj == dotin
+0000bed0: 6465 7820 3a20 646f 742e 6170 7065 6e64  dex : dot.append
+0000bee0: 2876 616c 7565 290d 0a20 2020 2020 2020  (value)..       
+0000bef0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000bf00: 2020 2020 2065 6173 7469 6e67 2c20 6e6f       easting, no
+0000bf10: 7274 6869 6e67 202c 7374 6174 696f 6e5f  rthing ,station_
+0000bf20: 706b 202c 2065 6c65 7661 7469 6f6e 2020  pk , elevation  
+0000bf30: 3d6e 702e 6172 7261 7928 6561 7374 292c  =np.array(east),
+0000bf40: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+0000bf50: 6e70 2e61 7272 6179 286e 6f72 7468 292c  np.array(north),
+0000bf60: 206e 702e 6172 7261 7928 646f 7429 2c20   np.array(dot), 
+0000bf70: 6e70 2e61 7272 6179 2865 6c65 7629 0d0a  np.array(elev)..
+0000bf80: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000bf90: 2020 6966 2065 6c65 7661 7469 6f6e 2e73    if elevation.s
+0000bfa0: 697a 6520 203c 3220 3a20 656c 6576 6174  ize  <2 : elevat
+0000bfb0: 696f 6e20 3d20 6e70 2e72 6570 6561 7428  ion = np.repeat(
+0000bfc0: 302e 2c65 6173 742e 7369 7a65 290d 0a20  0.,east.size).. 
+0000bfd0: 2020 2020 2020 2069 6620 7374 6174 696f         if statio
+0000bfe0: 6e5f 706b 2e73 697a 6520 3c32 203a 2073  n_pk.size <2 : s
+0000bff0: 7461 7469 6f6e 5f70 6b20 3d20 6e70 2e72  tation_pk = np.r
+0000c000: 6570 6561 7428 302e 2c20 6561 7374 2e73  epeat(0., east.s
+0000c010: 697a 6520 290d 0a20 2020 2020 2020 200d  ize )..        .
+0000c020: 0a20 2020 2020 2020 2023 2065 6173 7469  .        # easti
+0000c030: 6e67 202b 3d20 780d 0a20 2020 2020 2020  ng += x..       
+0000c040: 2023 206e 6f72 7468 696e 6720 2b3d 790d   # northing +=y.
+0000c050: 0a20 2020 2020 2020 2065 6173 7469 6e67  .        easting
+0000c060: 203d 206e 702e 6170 706c 795f 616c 6f6e   = np.apply_alon
+0000c070: 675f 6178 6973 286c 616d 6264 6120 7878  g_axis(lambda xx
+0000c080: 3a20 7878 202b 2078 202c 302c 2065 6173  : xx + x ,0, eas
+0000c090: 7469 6e67 2029 0d0a 2020 2020 2020 2020  ting )..        
+0000c0a0: 6e6f 7274 6869 6e67 203d 6e70 2e61 7070  northing =np.app
+0000c0b0: 6c79 5f61 6c6f 6e67 5f61 7869 7328 6c61  ly_along_axis(la
+0000c0c0: 6d62 6461 2079 793a 2079 7920 2b20 7920  mbda yy: yy + y 
+0000c0d0: 2c30 2c20 6e6f 7274 6869 6e67 2920 0d0a  ,0, northing) ..
+0000c0e0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000c0f0: 2020 6966 2020 7265 7772 6974 6520 6973    if  rewrite is
+0000c100: 2020 5472 7565 203a 200d 0a20 2020 2020    True : ..     
+0000c110: 2020 2020 2020 2069 6620 7374 6e5f 666e         if stn_fn
+0000c120: 2069 7320 4e6f 6e65 203a 200d 0a20 2020   is None : ..   
+0000c130: 2020 2020 2020 2020 2020 2020 2073 7054               spT
+0000c140: 203d 2027 2c27 0d0a 2020 2020 2020 2020   = ','..        
+0000c150: 2020 2020 2020 2020 7275 6e5f 6673 746e          run_fstn
+0000c160: 203d 2065 6173 7469 6e67 2e73 697a 650d   = easting.size.
+0000c170: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0000c180: 6520 3a72 756e 5f66 7374 6e20 3d20 6c65  e :run_fstn = le
+0000c190: 6e28 6673 746e 292d 310d 0a20 2020 2020  n(fstn)-1..     
+0000c1a0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000c1b0: 2020 2020 2020 2020 2073 746e 5f77 7269           stn_wri
+0000c1c0: 7465 5f6c 696e 6573 203d 5b5d 0d0a 2020  te_lines =[]..  
+0000c1d0: 2020 2020 2020 2020 2020 7374 6e5f 7772            stn_wr
+0000c1e0: 6974 655f 6c69 6e65 732e 6170 7065 6e64  ite_lines.append
+0000c1f0: 2827 272e 6a6f 696e 280d 0a20 2020 2020  (''.join(..     
+0000c200: 2020 2020 2020 2020 2020 205b 277b 303a             ['{0:
+0000c210: 3c31 307d 7b31 7d27 2e66 6f72 6d61 7428  <10}{1}'.format(
+0000c220: 2722 2222 646f 7422 2222 272c 7370 5429  '"""dot"""',spT)
+0000c230: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0000c240: 2020 2020 277b 303a 3e31 307d 7b31 7d27      '{0:>10}{1}'
+0000c250: 2e66 6f72 6d61 7428 2722 2222 6522 2222  .format('"""e"""
+0000c260: 272c 2073 7054 292c 200d 0a20 2020 2020  ', spT), ..     
+0000c270: 2020 2020 2020 2020 2020 2027 7b30 3a3e             '{0:>
+0000c280: 3130 7d7b 317d 272e 666f 726d 6174 2827  10}{1}'.format('
+0000c290: 2222 226e 2222 2227 2c73 7054 292c 200d  """n"""',spT), .
+0000c2a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c2b0: 2027 7b30 3a3e 3130 7d27 2e66 6f72 6d61   '{0:>10}'.forma
+0000c2c0: 7428 2722 2222 6822 2222 2729 5d29 290d  t('"""h"""')])).
+0000c2d0: 0a20 2020 2020 2020 2020 2020 2073 746e  .            stn
+0000c2e0: 5f77 7269 7465 5f6c 696e 6573 2e61 7070  _write_lines.app
+0000c2f0: 656e 6428 275c 6e27 290d 0a0d 0a20 2020  end('\n')....   
+0000c300: 2020 2020 2020 2020 2066 6f72 2069 6920           for ii 
+0000c310: 696e 2072 616e 6765 2028 7275 6e5f 6673  in range (run_fs
+0000c320: 746e 2029 3a20 2023 2073 6b69 7020 7468  tn ):  # skip th
+0000c330: 6520 6865 6164 6c69 6e65 2e0d 0a20 2020  e headline...   
+0000c340: 2020 2020 2020 2020 2020 2020 2073 746e               stn
+0000c350: 5f77 7269 7465 5f6c 696e 6573 2e61 7070  _write_lines.app
+0000c360: 656e 6428 2727 2e6a 6f69 6e28 0d0a 2020  end(''.join(..  
+0000c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c380: 2020 5b27 7b30 3a3c 377d 7b31 7d27 2e66    ['{0:<7}{1}'.f
+0000c390: 6f72 6d61 7428 7374 6174 696f 6e5f 706b  ormat(station_pk
+0000c3a0: 5b69 695d 2c20 7370 5429 2c20 0d0a 2020  [ii], spT), ..  
+0000c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3c0: 2020 277b 3a3e 3132 2e33 667d 7b7d 272e    '{:>12.3f}{}'.
+0000c3d0: 666f 726d 6174 2865 6173 7469 6e67 5b69  format(easting[i
+0000c3e0: 695d 2c20 7370 5429 2c20 0d0a 2020 2020  i], spT), ..    
+0000c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c400: 2027 7b3a 3e31 322e 3366 7d7b 7d27 2e66   '{:>12.3f}{}'.f
+0000c410: 6f72 6d61 7428 6e6f 7274 6869 6e67 5b69  ormat(northing[i
+0000c420: 695d 2c20 7370 5429 2c20 0d0a 2020 2020  i], spT), ..    
+0000c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c440: 2027 7b3a 3e38 7d27 2e66 6f72 6d61 7428   '{:>8}'.format(
+0000c450: 656c 6576 6174 696f 6e5b 6969 5d29 0d0a  elevation[ii])..
+0000c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c490: 5d29 290d 0a20 2020 2020 2020 2020 2020  ]))..           
+0000c4a0: 2020 2020 2073 746e 5f77 7269 7465 5f6c       stn_write_l
+0000c4b0: 696e 6573 2e61 7070 656e 6428 275c 6e27  ines.append('\n'
+0000c4c0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0000c4d0: 6620 7374 6e5f 666e 2069 7320 4e6f 6e65  f stn_fn is None
+0000c4e0: 203a 2066 6e65 775f 3d27 5354 4e7b 307d   : fnew_='STN{0}
+0000c4f0: 5f72 6561 6a27 2e66 6f72 6d61 7428 7469  _reaj'.format(ti
+0000c500: 6d65 2e74 696d 657a 6f6e 6529 2020 2020  me.timezone)    
+0000c510: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0000c520: 7365 203a 200d 0a20 2020 2020 2020 2020  se : ..         
+0000c530: 2020 2020 2020 2066 6e65 775f 3d20 6f73         fnew_= os
+0000c540: 2e70 6174 682e 6261 7365 6e61 6d65 2873  .path.basename(s
+0000c550: 746e 5f66 6e29 2e73 706c 6974 2827 2e27  tn_fn).split('.'
+0000c560: 295b 305d 202b 2027 5f72 6561 6a27 0d0a  )[0] + '_reaj'..
+0000c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c580: 0d0a 2020 2020 2020 2020 2020 2020 7769  ..            wi
+0000c590: 7468 206f 7065 6e28 2727 2e6a 6f69 6e28  th open(''.join(
+0000c5a0: 5b66 6e65 775f 2c20 272e 7374 6e27 5d29  [fnew_, '.stn'])
+0000c5b0: 2c20 2777 272c 2065 6e63 6f64 696e 673d  , 'w', encoding=
+0000c5c0: 2775 7466 3827 2920 6173 2066 6964 203a  'utf8') as fid :
+0000c5d0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000c5e0: 2020 2066 6964 2e77 7269 7465 6c69 6e65     fid.writeline
+0000c5f0: 7328 7374 6e5f 7772 6974 655f 6c69 6e65  s(stn_write_line
+0000c600: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+0000c610: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000c620: 2020 7361 7665 7061 7468 203d 2066 756e    savepath = fun
+0000c630: 632e 6370 6174 6820 2873 6176 6570 6174  c.cpath (savepat
+0000c640: 682c 0d0a 2020 2020 2020 2020 2020 2020  h,..            
+0000c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c660: 2020 2020 2020 2066 275f 7b50 726f 6669         f'_{Profi
+0000c670: 6c65 2e5f 5f6e 616d 655f 5f2e 6c6f 7765  le.__name__.lowe
+0000c680: 7228 297d 5f27 290d 0a20 2020 2020 2020  r()}_')..       
+0000c690: 2020 2020 2069 6620 7361 7665 7061 7468       if savepath
+0000c6a0: 2069 7320 6e6f 7420 4e6f 6e65 203a 0d0a   is not None :..
+0000c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c6c0: 7368 7574 696c 2e6d 6f76 6528 206f 732e  shutil.move( os.
+0000c6d0: 7061 7468 2e6a 6f69 6e28 6f73 2e67 6574  path.join(os.get
+0000c6e0: 6377 6428 292c 0d0a 2020 2020 2020 2020  cwd(),..        
+0000c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c710: 2020 2727 2e6a 6f69 6e28 5b66 6e65 775f    ''.join([fnew_
+0000c720: 2c20 272e 7374 6e27 5d29 292c 0d0a 2020  , '.stn'])),..  
+0000c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c750: 2020 2020 2020 2020 7361 7665 7061 7468          savepath
+0000c760: 2029 0d0a 2020 2020 0d0a 2020 2020 2020   )..    ..      
+0000c770: 2020 2020 2020 7072 696e 7428 272d 272a        print('-'*
+0000c780: 3737 290d 0a20 2020 2020 2020 2020 2020  77)..           
+0000c790: 2070 7269 6e74 2827 2d2d 2d3e 204e 6577   print('---> New
+0000c7a0: 203c 7b30 7d3e 2073 7461 7469 6f6e 2066   <{0}> station f
+0000c7b0: 696c 6520 6861 7320 6265 656e 2072 6577  ile has been rew
+0000c7c0: 7269 7474 656e 2e27 2e5c 0d0a 2020 2020  ritten.'.\..    
+0000c7d0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000c7e0: 726d 6174 2827 272e 6a6f 696e 285b 666e  rmat(''.join([fn
+0000c7f0: 6577 5f2c 2027 2e73 746e 275d 2929 290d  ew_, '.stn']))).
+0000c800: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0000c810: 6e74 2827 2d2d 2d3e 2073 6176 6570 6174  nt('---> savepat
+0000c820: 6820 3a20 3c7b 307d 3e27 2e66 6f72 6d61  h : <{0}>'.forma
+0000c830: 7428 7361 7665 7061 7468 2920 290d 0a20  t(savepath) ).. 
+0000c840: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0000c850: 2827 2d27 2a37 3729 0d0a 2020 2020 2020  ('-'*77)..      
+0000c860: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000c870: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000c880: 2020 7265 7475 726e 2073 7461 7469 6f6e    return station
+0000c890: 5f70 6b2c 2065 6173 7469 6e67 202c 206e  _pk, easting , n
+0000c8a0: 6f72 7468 696e 6720 2c20 656c 6576 6174  orthing , elevat
+0000c8b0: 696f 6e20 2020 2020 200d 0a20 200d 0a20  ion      ..  .. 
+0000c8c0: 2020 2020 2020 200d 0a20 2020 2064 6566         ..    def
+0000c8d0: 2073 7472 6169 6768 7465 6e5f 7072 6f66   straighten_prof
+0000c8e0: 696c 656c 696e 6520 2873 656c 662c 2058  ileline (self, X
+0000c8f0: 3d4e 6f6e 652c 2059 3d4e 6f6e 6520 2c0d  =None, Y=None ,.
+0000c900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c920: 2073 7472 6169 6768 745f 7479 7065 203d   straight_type =
+0000c930: 2763 6c61 7373 6963 272c 200d 0a20 2020  'classic', ..   
+0000c940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c950: 2020 2020 2020 2020 2020 2020 2072 6561               rea
+0000c960: 6a75 7374 3d28 302c 3029 2c20 6f75 7470  just=(0,0), outp
+0000c970: 7574 203d 4661 6c73 652c 0d0a 2020 2020  ut =False,..    
+0000c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c990: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+0000c9a0: 6172 6773 293a 0d0a 2020 2020 2020 2020  args):..        
+0000c9b0: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
+0000c9c0: 686f 6420 746f 2073 7472 6169 6768 7465  hod to straighte
+0000c9d0: 6e20 7072 6f66 696c 6520 6c69 6e65 2061  n profile line a
+0000c9e0: 6e64 2f6f 7220 7265 7363 616c 6564 200d  nd/or rescaled .
+0000c9f0: 0a20 2020 2020 2020 2063 6f6f 7264 696e  .        coordin
+0000ca00: 6174 6573 2e20 2055 7365 7220 6361 6e20  ates.  User can 
+0000ca10: 7265 6164 6a75 7374 2063 6f6f 7264 696e  readjust coordin
+0000ca20: 6174 6571 200d 0a20 2020 2020 2020 206f  ateq ..        o
+0000ca30: 6620 7072 6f66 696c 6520 6279 2061 6464  f profile by add
+0000ca40: 696e 6720 636f 6f72 6469 6e61 7465 206f  ing coordinate o
+0000ca50: 6620 7265 6164 6a75 7374 6174 696f 6e20  f readjustation 
+0000ca60: 200d 0a20 2020 2020 2020 204d 6574 686f   ..        Metho
+0000ca70: 6420 7072 6f76 6964 6573 2033 2074 7970  d provides 3 typ
+0000ca80: 6520 6f66 2073 7472 6169 6768 7465 6e20  e of straighten 
+0000ca90: 7072 6f66 696c 652e 0d0a 2020 2020 2020  profile...      
+0000caa0: 2020 4465 6661 756c 7420 6973 2022 636c    Default is "cl
+0000cab0: 6173 7369 6322 2c20 6974 2063 6f75 6c64  assic", it could
+0000cac0: 2062 6520 0d0a 2020 2020 2020 2020 2227   be ..        "'
+0000cad0: 6e61 7475 7261 6c20 6f72 2064 6973 746f  natural or disto
+0000cae0: 7264 6564 272c 2065 7175 6964 6973 7461  rded', equidista
+0000caf0: 6e74 2220 2e20 0d0a 2020 2020 2020 2020  nt" . ..        
+0000cb00: 226e 6174 7572 616c 206f 7220 6469 7374  "natural or dist
+0000cb10: 6f72 6465 6420 5479 7065 2220 6973 206e  orded Type" is n
+0000cb20: 6f74 2074 6f20 7374 7261 6967 6874 2061  ot to straight a
+0000cb30: 200d 0a20 2020 2020 2020 2070 726f 6669   ..        profi
+0000cb40: 6c65 206c 696b 6520 6120 7374 7261 6967  le like a straig
+0000cb50: 6874 206c 696e 6520 6275 7420 2c20 6974  ht line but , it
+0000cb60: 206b 6565 7073 2074 6865 0d0a 2020 2020   keeps the..    
+0000cb70: 2020 2020 6571 7569 6469 7374 616e 7420      equidistant 
+0000cb80: 706f 696e 7420 6f66 2074 6865 2073 7461  point of the sta
+0000cb90: 7469 6f6e 2061 7420 6e6f 726d 616c 2070  tion at normal p
+0000cba0: 6c61 6365 0d0a 2020 2020 2020 2020 7468  lace..        th
+0000cbb0: 6174 2074 6865 2073 7572 7665 7920 6d75  at the survey mu
+0000cbc0: 7374 2062 652e 2073 6f6d 6574 696d 6573  st be. sometimes
+0000cbd0: 206f 6e20 7468 6520 6669 656c 6420 2c0d   on the field ,.
+0000cbe0: 0a20 2020 2020 2020 2063 7265 7720 6d61  .        crew ma
+0000cbf0: 7920 6765 7420 6172 6f75 6e64 2073 6f6d  y get around som
+0000cc00: 6520 6f62 7374 6163 6c65 2061 6e64 2064  e obstacle and d
+0000cc10: 6573 7069 7465 2074 6865 0d0a 2020 2020  espite the..    
+0000cc20: 2020 2020 6c69 6e65 2069 7320 6e6f 7420      line is not 
+0000cc30: 7374 7261 6967 6874 202c 2074 6865 2064  straight , the d
+0000cc40: 6973 7461 6e63 6520 2062 6574 7765 656e  istance  between
+0000cc50: 2073 7461 7469 6f6e 200d 0a20 2020 2020   station ..     
+0000cc60: 2020 2069 7320 6469 7374 6f72 6465 642e     is distorded.
+0000cc70: 2055 7369 6e67 2027 6469 7374 6f72 6420   Using 'distord 
+0000cc80: 6f72 206e 6174 7572 616c 2074 7970 6520  or natural type 
+0000cc90: 2720 2c0d 0a20 2020 2020 2020 2069 7420  ' ,..        it 
+0000cca0: 7769 6c6c 2073 686f 7720 7468 6520 7269  will show the ri
+0000ccb0: 6768 7420 706c 6163 6520 7374 6174 696f  ght place statio
+0000ccc0: 6e20 6d75 7374 2062 652e 0d0a 2020 2020  n must be...    
+0000ccd0: 2020 2020 0d0a 2020 2020 2020 2020 2e2e      ..        ..
+0000cce0: 206e 6f74 653a 3a20 2066 6f72 2065 6173   note::  for eas
+0000ccf0: 6965 7220 6170 7072 6f63 6820 7765 2075  ier approch we u
+0000cd00: 7365 2058 0d0a 2020 2020 2020 2020 2020  se X..          
+0000cd10: 2020 2020 2020 2061 7320 6561 7374 696e         as eastin
+0000cd20: 6720 616e 6420 5920 6173 206e 6f72 7468  g and Y as north
+0000cd30: 696e 672e 200d 0a0d 0a20 2020 2020 2020  ing. ....       
+0000cd40: 203a 7061 7261 6d20 583a 2065 6173 7469   :param X: easti
+0000cd50: 6e67 2063 6f6f 7264 696e 6174 6573 2061  ng coordinates a
+0000cd60: 7272 6179 2e20 0d0a 2020 2020 2020 2020  rray. ..        
+0000cd70: 3a74 7970 6520 583a 2061 7272 6179 5f6c  :type X: array_l
+0000cd80: 696b 6520 286e 6461 7272 792c 2061 7272  ike (ndarry, arr
+0000cd90: 6179 2c31 290d 0a20 2020 2020 2020 2020  ay,1)..         
+0000cda0: 2020 200d 0a20 2020 2020 2020 203a 7061     ..        :pa
+0000cdb0: 7261 6d20 593a 206e 6f72 7468 696e 6720  ram Y: northing 
+0000cdc0: 636f 6f72 6469 6e61 7465 7320 6172 7261  coordinates arra
+0000cdd0: 7920 0d0a 2020 2020 2020 2020 3a74 7970  y ..        :typ
+0000cde0: 6520 593a 2061 7272 6179 5f6c 696b 6520  e Y: array_like 
+0000cdf0: 286e 6461 7272 6179 2c31 290d 0a20 2020  (ndarray,1)..   
+0000ce00: 2020 2020 200d 0a20 2020 2020 2020 203a       ..        :
+0000ce10: 7061 7261 6d20 7374 7261 6967 6874 5f74  param straight_t
+0000ce20: 7970 653a 2074 7970 6520 6f66 2073 7472  ype: type of str
+0000ce30: 6169 6768 7465 6e20 2c69 7420 636f 756c  aighten ,it coul
+0000ce40: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
+0000ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce60: 6265 2022 6571 7569 7374 616e 7420 6f72  be "equistant or
+0000ce70: 2065 6761 6c2c 206e 6174 7572 616c 0d0a   egal, natural..
+0000ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce90: 2020 2020 2020 2020 2020 2020 6f72 2064              or d
+0000cea0: 6973 746f 7264 222e 202a 6465 6661 756c  istord". *defaul
+0000ceb0: 742a 2069 7320 2263 6c61 7373 6963 220d  t* is "classic".
+0000cec0: 0a20 2020 2020 2020 203a 7479 7065 2073  .        :type s
+0000ced0: 7472 6169 6768 745f 7479 7065 3a20 7374  traight_type: st
+0000cee0: 7220 0d0a 0d0a 2020 2020 2020 2020 3a70  r ....        :p
+0000cef0: 6172 616d 2072 6561 6a75 7374 3a20 2063  aram reajust:  c
+0000cf00: 6f6f 7264 696e 6174 6573 2066 6f72 2072  oordinates for r
+0000cf10: 6561 6a75 7374 6d65 6e74 2028 0d0a 2020  eajustment (..  
+0000cf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf30: 2020 2020 2020 2020 2020 696e 6465 7820            index 
+0000cf40: 3020 3a78 2069 6e64 6578 2031 203a 2079  0 :x index 1 : y
+0000cf50: 2029 2020 0d0a 2020 2020 2020 2020 3a74   )  ..        :t
+0000cf60: 7970 6520 7265 616a 7573 743a 2074 7570  ype reajust: tup
+0000cf70: 6c65 0d0a 2020 2020 2020 2020 2222 220d  le..        """.
+0000cf80: 0a20 2020 2020 2020 2073 656c 662e 5f6c  .        self._l
+0000cf90: 6f67 6769 6e67 2e69 6e66 6f20 2827 5072  ogging.info ('Pr
+0000cfa0: 6f66 696c 6520 636f 6f72 6469 6e61 7465  ofile coordinate
+0000cfb0: 7320 5820 616e 6420 2059 2027 0d0a 2020  s X and  Y '..  
+0000cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cfd0: 2020 2020 2020 2020 2020 2761 7265 2073            'are s
+0000cfe0: 6361 6c6c 696e 672e 2053 6361 6c65 204d  calling. Scale M
+0000cff0: 6574 686f 6420 6973 203c 7b30 7d3e 272e  ethod is <{0}>'.
+0000d000: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d020: 2020 666f 726d 6174 2820 7374 7261 6967    format( straig
+0000d030: 6874 5f74 7970 6529 290d 0a20 2020 2020  ht_type))..     
+0000d040: 2020 200d 0a20 2020 2020 2020 2073 6176     ..        sav
+0000d050: 6570 6174 6820 3d6b 7761 7267 732e 706f  epath =kwargs.po
+0000d060: 7028 2773 6176 6570 6174 6827 2c20 4e6f  p('savepath', No
+0000d070: 6e65 290d 0a20 2020 2020 2020 2069 6620  ne)..        if 
+0000d080: 7361 7665 7061 7468 2069 7320 6e6f 7420  savepath is not 
+0000d090: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2020  None: ..        
+0000d0a0: 2020 2020 7365 6c66 2e73 6176 6570 6174      self.savepat
+0000d0b0: 6820 3d20 7361 7665 7061 7468 0d0a 2020  h = savepath..  
+0000d0c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000d0d0: 5245 573d 4661 6c73 6520 2020 2020 2020  REW=False       
+0000d0e0: 2020 2020 2020 2020 2320 636f 6f72 6469          # coordi
+0000d0f0: 6e61 7465 7320 7363 616c 696e 6720 666c  nates scaling fl
+0000d100: 6167 2061 6e64 2063 6f6e 7472 6f6c 206e  ag and control n
+0000d110: 6577 206f 7574 7075 7473 0d0a 2020 2020  ew outputs..    
+0000d120: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+0000d130: 2058 2069 7320 6e6f 7420 4e6f 6e65 203a   X is not None :
+0000d140: 2073 656c 662e 6561 7374 203d 2058 200d   self.east = X .
+0000d150: 0a20 2020 2020 2020 2069 6620 5920 6973  .        if Y is
+0000d160: 206e 6f74 204e 6f6e 6520 3a20 7365 6c66   not None : self
+0000d170: 2e6e 6f72 7468 203d 2059 0d0a 2020 2020  .north = Y..    
+0000d180: 2020 2020 6966 2073 656c 662e 6561 7374      if self.east
+0000d190: 2069 7320 4e6f 6e65 206f 7220 7365 6c66   is None or self
+0000d1a0: 2e6e 6f72 7468 2069 7320 4e6f 6e65 203a  .north is None :
+0000d1b0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+0000d1c0: 6973 6520 5072 6f66 696c 6545 7272 6f72  ise ProfileError
+0000d1d0: 2827 4e6f 2070 6f73 7369 626c 6520 7761  ('No possible wa
+0000d1e0: 7920 746f 2073 7472 6169 6768 7465 6e20  y to straighten 
+0000d1f0: 6f75 7420 270d 0a20 2020 2020 2020 2020  out '..         
+0000d200: 2020 2020 2020 2027 7468 6520 7072 6f66         'the prof
+0000d210: 696c 6520 6c69 6e65 202e 2050 6c65 6173  ile line . Pleas
+0000d220: 6520 7072 6f76 6964 6520 7468 6520 7269  e provide the ri
+0000d230: 6768 7420 636f 6f72 6469 6e61 7465 732e  ght coordinates.
+0000d240: 2027 290d 0a20 2020 2020 2020 200d 0a20   ')..        .. 
+0000d250: 2020 2020 2020 2069 6620 7365 6c66 2e65         if self.e
+0000d260: 6173 742e 7369 7a65 2021 3d20 7365 6c66  ast.size != self
+0000d270: 2e6e 6f72 7468 2e73 697a 6520 3a20 0d0a  .north.size : ..
+0000d280: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000d290: 6520 5072 6f66 696c 6545 7272 6f72 2827  e ProfileError('
+0000d2a0: 5820 616e 6420 5920 6d75 7374 2062 6520  X and Y must be 
+0000d2b0: 7468 6520 7361 6d65 2073 697a 652e 2027  the same size. '
+0000d2c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d2d0: 2020 2020 2020 2020 2027 5820 6861 7320           'X has 
+0000d2e0: 6120 7369 7a65 203c 7b30 7d3e 2077 6869  a size <{0}> whi
+0000d2f0: 6c65 2059 2068 6173 2074 6865 2073 697a  le Y has the siz
+0000d300: 6520 3c7b 317d 3e2e 2027 0d0a 2020 2020  e <{1}>. '..    
+0000d310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d320: 2020 2027 4c69 6e65 2063 616e 6e6f 7420     'Line cannot 
+0000d330: 6265 2073 7472 6169 6768 7465 6e65 642e  be straightened.
+0000d340: 2027 0d0a 2020 2020 2020 2020 2020 2020   '..            
+0000d350: 2020 2020 2020 2020 2020 2020 2027 506c               'Pl
+0000d360: 6561 7365 2070 726f 7669 6465 2074 6865  ease provide the
+0000d370: 2073 616d 6520 7369 7a65 206f 6620 626f   same size of bo
+0000d380: 7468 2061 7272 6179 7327 2e5c 0d0a 2020  th arrays'.\..  
+0000d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d3a0: 2020 2020 2020 2020 2020 2066 6f72 6d61             forma
+0000d3b0: 7428 7365 6c66 2e65 6173 742e 7369 7a65  t(self.east.size
+0000d3c0: 2c20 7365 6c66 2e6e 6f72 7468 2e73 697a  , self.north.siz
+0000d3d0: 6529 290d 0a20 2020 2020 2020 2020 2020  e))..           
+0000d3e0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+0000d3f0: 2072 6573 6361 6c6c 6564 2074 6865 2063   rescalled the c
+0000d400: 6f6f 7264 696e 6174 6573 200d 0a20 2020  oordinates ..   
+0000d410: 2020 2020 2069 6620 7265 616a 7573 7420       if reajust 
+0000d420: 6973 206e 6f74 204e 6f6e 6520 3a0d 0a20  is not None :.. 
+0000d430: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0000d440: 6e28 7265 616a 7573 7429 2021 3d32 203a  n(reajust) !=2 :
+0000d450: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000d460: 2020 2072 6169 7365 2050 726f 6669 6c65     raise Profile
+0000d470: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+0000d480: 2020 2020 2020 2020 2020 2020 2243 6f75              "Cou
+0000d490: 6c64 206e 6f74 2072 6561 6a75 7374 2063  ld not reajust c
+0000d4a0: 6f6f 7264 696e 6174 6573 2062 6579 6f6e  oordinates beyon
+0000d4b0: 6420 7468 7265 6520 7661 6c75 6573 2e22  d three values."
+0000d4c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d4d0: 2020 2020 2020 224f 6e6c 7920 7820 3d72        "Only x =r
+0000d4e0: 6561 6a75 7374 5b30 5d20 616e 6420 793d  eajust[0] and y=
+0000d4f0: 7265 616a 7573 745b 315d 2063 616e 2062  reajust[1] can b
+0000d500: 6520 6163 6365 7074 6564 2e20 2229 0d0a  e accepted. ")..
+0000d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d520: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0000d530: 2073 656c 662e 6469 706f 6c65 5f6c 656e   self.dipole_len
+0000d540: 6774 6820 6973 204e 6f6e 653a 200d 0a20  gth is None: .. 
+0000d550: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000d560: 7269 6e74 2827 2d2d 3e20 4469 706f 6c65  rint('--> Dipole
+0000d570: 6c65 6e67 7468 2020 6973 2063 6f6d 7075  length  is compu
+0000d580: 7469 6e67 2027 0d0a 2020 2020 2020 2020  ting '..        
+0000d590: 2020 2020 2020 2020 2020 2020 2020 2774                't
+0000d5a0: 6f20 7374 7261 6967 6874 656e 206f 7574  o straighten out
+0000d5b0: 2020 7072 6f66 696c 652e 2729 0d0a 2020    profile.')..  
+0000d5c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000d5d0: 6c66 2e5f 6c6f 6767 696e 672e 696e 666f  lf._logging.info
+0000d5e0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+0000d5f0: 2020 2020 2020 2020 2757 6520 6172 6520          'We are 
+0000d600: 636f 6d70 7574 696e 6720 6469 706f 6c65  computing dipole
+0000d610: 6c65 6e67 7468 2020 746f 2073 7472 6169  length  to strai
+0000d620: 6768 7420 2070 726f 6669 6c65 2e27 290d  ght  profile.').
+0000d630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d640: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000d650: 2020 2064 6970 6f6c 4c65 6e67 202c 2073     dipolLeng , s
+0000d660: 746e 5f70 6b20 3d20 7365 6c66 2e63 6f6d  tn_pk = self.com
+0000d670: 7075 7465 5f64 6970 6f6c 656c 656e 6774  pute_dipolelengt
+0000d680: 685f 6672 6f6d 5f63 6f6f 7264 7328 0d0a  h_from_coords(..
+0000d690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d6a0: 2020 2020 6561 7374 696e 673d 7365 6c66      easting=self
+0000d6b0: 2e65 6173 742c 206e 6f72 7468 696e 6720  .east, northing 
+0000d6c0: 3d73 656c 662e 6e6f 7274 6869 6e67 290d  =self.northing).
+0000d6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d6e0: 2077 6172 6e69 6e67 732e 7761 726e 280d   warnings.warn(.
+0000d6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d700: 2020 2020 2027 5765 2061 7265 2063 6f6d       'We are com
+0000d710: 7075 7469 6e67 2064 6970 6f6c 6520 6c65  puting dipole le
+0000d720: 6e67 7468 2061 6e64 2077 6520 6173 7375  ngth and we assu
+0000d730: 6d65 2027 0d0a 2020 2020 2020 2020 2020  me '..          
+0000d740: 2020 2020 2020 2020 2020 2774 6865 2073            'the s
+0000d750: 7461 7469 6f6e 7320 636f 6f72 6469 6e61  tations coordina
+0000d760: 7465 7320 6172 6520 696e 2074 6865 2063  tes are in the c
+0000d770: 656e 7465 7220 6f66 2065 6163 6820 6469  enter of each di
+0000d780: 706f 6c65 2e27 0d0a 2020 2020 2020 2020  pole.'..        
+0000d790: 2020 2020 2020 2020 2020 2020 2720 4469              ' Di
+0000d7a0: 706f 6c65 204c 656e 6774 6820 6973 203d  pole Length is =
+0000d7b0: 207b 307d 206d 2061 6e64 2074 6865 2074   {0} m and the t
+0000d7c0: 6f74 616c 2027 0d0a 2020 2020 2020 2020  otal '..        
+0000d7d0: 2020 2020 2020 2020 2020 2020 276c 656e              'len
+0000d7e0: 6774 6820 6973 203d 207b 317d 206d 2e27  gth is = {1} m.'
+0000d7f0: 2e66 6f72 6d61 7428 6469 706f 6c4c 656e  .format(dipolLen
+0000d800: 672c 200d 0a20 2020 2020 2020 2020 2020  g, ..           
+0000d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d830: 2020 2020 2028 7365 6c66 2e65 6173 742e       (self.east.
+0000d840: 7369 7a65 202d 3129 202a 5c0d 0a20 2020  size -1) *\..   
+0000d850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d870: 2020 2020 2020 2020 2020 2020 2064 6970               dip
+0000d880: 6f6c 4c65 6e67 2029 290d 0a20 2020 2020  olLeng ))..     
+0000d890: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000d8a0: 2020 2020 2020 2020 2065 6c73 6520 3a20           else : 
+0000d8b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d8c0: 2020 7374 6e5f 706b 203d 206e 702e 6172    stn_pk = np.ar
+0000d8d0: 616e 6765 2869 6e74 2873 656c 662e 6469  ange(int(self.di
+0000d8e0: 706f 6c65 5f6c 656e 6774 682f 3229 2c20  pole_length/2), 
+0000d8f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d910: 2020 2020 2020 7365 6c66 2e65 6173 742e        self.east.
+0000d920: 7369 7a65 202a 2073 656c 662e 6469 706f  size * self.dipo
+0000d930: 6c65 5f6c 656e 6774 682c 0d0a 2020 2020  le_length,..    
 0000d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d960: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0000d970: 7365 6c66 2e65 6173 742e 7369 7a65 202d  self.east.size -
-0000d980: 3129 202a 5c0d 0a20 2020 2020 2020 2020  1) *\..         
-0000d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d9b0: 2020 2020 2020 2064 6970 6f6c 4c65 6e67         dipolLeng
-0000d9c0: 2029 290d 0a20 2020 2020 2020 2020 2020   ))..           
-0000d9d0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000d9e0: 2020 2065 6c73 6520 3a20 0d0a 2020 2020     else : ..    
-0000d9f0: 2020 2020 2020 2020 2020 2020 7374 6e5f              stn_
-0000da00: 706b 203d 206e 702e 6172 616e 6765 2869  pk = np.arange(i
-0000da10: 6e74 2873 656c 662e 6469 706f 6c65 5f6c  nt(self.dipole_l
-0000da20: 656e 6774 682f 3229 2c20 0d0a 2020 2020  ength/2), ..    
-0000da30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da50: 7365 6c66 2e65 6173 742e 7369 7a65 202a  self.east.size *
-0000da60: 2073 656c 662e 6469 706f 6c65 5f6c 656e   self.dipole_len
-0000da70: 6774 682c 0d0a 2020 2020 2020 2020 2020  gth,..          
+0000d960: 7365 6c66 2e64 6970 6f6c 655f 6c65 6e67  self.dipole_leng
+0000d970: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
+0000d980: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+0000d990: 726e 2827 4469 706f 6c65 206c 656e 6774  rn('Dipole lengt
+0000d9a0: 6820 6973 203d 207b 307d 206d 2e20 5374  h is = {0} m. St
+0000d9b0: 6174 696f 6e73 206c 6f63 6174 696f 6e27  ations location'
+0000d9c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d9e0: 276d 6f76 6564 2074 6f20 7468 6520 6365  'moved to the ce
+0000d9f0: 6e74 6572 206f 6620 6561 6368 2064 6970  nter of each dip
+0000da00: 6f6c 652e 270d 0a20 2020 2020 2020 2020  ole.'..         
+0000da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da20: 2020 2020 2027 2054 6f74 616c 206c 656e       ' Total len
+0000da30: 6774 6820 6973 203d 207b 317d 206d 272e  gth is = {1} m'.
+0000da40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da60: 2020 666f 726d 6174 2873 656c 662e 6469    format(self.di
+0000da70: 706f 6c65 5f6c 656e 6774 682c 0d0a 2020  pole_length,..  
 0000da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da90: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-0000daa0: 6970 6f6c 655f 6c65 6e67 7468 290d 0a20  ipole_length).. 
-0000dab0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000dac0: 6172 6e69 6e67 732e 7761 726e 2827 4469  arnings.warn('Di
-0000dad0: 706f 6c65 206c 656e 6774 6820 6973 203d  pole length is =
-0000dae0: 207b 307d 206d 2e20 5374 6174 696f 6e73   {0} m. Stations
-0000daf0: 206c 6f63 6174 696f 6e27 0d0a 2020 2020   location'..    
-0000db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db10: 2020 2020 2020 2020 2020 276d 6f76 6564            'moved
-0000db20: 2074 6f20 7468 6520 6365 6e74 6572 206f   to the center o
-0000db30: 6620 6561 6368 2064 6970 6f6c 652e 270d  f each dipole.'.
-0000db40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000db50: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000db60: 2054 6f74 616c 206c 656e 6774 6820 6973   Total length is
-0000db70: 203d 207b 317d 206d 272e 0d0a 2020 2020   = {1} m'...    
-0000db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db90: 2020 2020 2020 2020 2020 2020 666f 726d              form
-0000dba0: 6174 2873 656c 662e 6469 706f 6c65 5f6c  at(self.dipole_l
-0000dbb0: 656e 6774 682c 0d0a 2020 2020 2020 2020  ength,..        
-0000dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dbd0: 2020 2020 2020 2020 2020 2020 2873 656c              (sel
-0000dbe0: 662e 6561 7374 2e73 697a 6520 2d20 3129  f.east.size - 1)
-0000dbf0: 202a 2073 656c 662e 6469 706f 6c65 5f6c   * self.dipole_l
-0000dc00: 656e 6774 6820 2929 0d0a 2020 2020 2020  ength ))..      
-0000dc10: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000dc20: 6966 2073 656c 662e 656c 6576 2069 7320  if self.elev is 
-0000dc30: 6e6f 7420 4e6f 6e65 203a 2065 6c65 7620  not None : elev 
-0000dc40: 3d6e 702e 6172 6f75 6e64 2873 656c 662e  =np.around(self.
-0000dc50: 656c 6576 2c32 2920 0d0a 2020 2020 2020  elev,2) ..      
-0000dc60: 2020 2020 2020 656c 7365 203a 2065 6c65        else : ele
-0000dc70: 7620 3d20 6e70 2e72 6570 6561 7428 302e  v = np.repeat(0.
-0000dc80: 2c20 7365 6c66 2e65 6173 742e 7369 7a65  , self.east.size
-0000dc90: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
-0000dca0: 2069 6620 6f75 7470 7574 2069 7320 5472   if output is Tr
-0000dcb0: 7565 203a 2052 4557 203d 4661 6c73 6520  ue : REW =False 
-0000dcc0: 2320 6669 7274 6c79 202c 0d0a 2020 2020  # firtly ,..    
-0000dcd0: 2020 2020 2020 2020 2361 646a 7573 7420          #adjust 
-0000dce0: 636f 6f72 6469 6e61 7465 7320 7769 7468  coordinates with
-0000dcf0: 6f75 7420 6f75 7470 7574 2066 696c 6520  out output file 
-0000dd00: 2073 6574 2052 4557 2074 6f20 4661 6c73   set REW to Fals
-0000dd10: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-0000dd20: 5f2c 2073 656c 662e 6561 7374 2c20 7365  _, self.east, se
-0000dd30: 6c66 2e6e 6f72 7468 202c 2a5f 3d20 7365  lf.north ,*_= se
-0000dd40: 6c66 2e72 6561 6a75 7374 5f63 6f6f 7264  lf.reajust_coord
-0000dd50: 696e 6174 6573 5f76 616c 7565 7328 0d0a  inates_values(..
-0000dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd80: 2020 2020 2020 2020 6561 7374 696e 673d          easting=
-0000dd90: 2073 656c 662e 6561 7374 2c0d 0a20 2020   self.east,..   
-0000dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ddc0: 2020 2020 206e 6f72 7468 696e 6720 3d73       northing =s
-0000ddd0: 656c 662e 6e6f 7274 6820 2c20 0d0a 2020  elf.north , ..  
-0000dde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ddf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de00: 2020 2020 2020 783d 7265 616a 7573 745b        x=reajust[
-0000de10: 305d 2c20 793d 7265 616a 7573 745b 315d  0], y=reajust[1]
-0000de20: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000de30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de40: 2020 2020 2020 2020 2020 2073 7461 7469             stati
-0000de50: 6f6e 5f70 6b3d 7374 6e5f 706b 2c20 0d0a  on_pk=stn_pk, ..
-0000de60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de80: 2020 2020 2020 2020 7265 7772 6974 653d          rewrite=
-0000de90: 5245 572c 2065 6c65 7661 7469 6f6e 3d20  REW, elevation= 
-0000dea0: 656c 6576 290d 0a20 2020 2020 2020 2020  elev)..         
-0000deb0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000dec0: 2070 7269 6e74 2822 2d2d 2d3e 204c 6f63   print("---> Loc
-0000ded0: 6174 696f 6e73 2063 6f6f 7264 696e 6174  ations coordinat
-0000dee0: 6573 2061 7265 2073 6361 6c65 6420 220d  es are scaled ".
-0000def0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000df00: 2020 2022 616e 6420 656c 6576 6174 696f     "and elevatio
-0000df10: 6e20 6973 2061 6464 6564 2e22 290d 0a20  n is added.").. 
-0000df20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000df30: 5f6c 6f67 6769 6e67 2e69 6e66 6f20 280d  _logging.info (.
-0000df40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000df50: 2022 4c6f 6361 7469 6f6e 7320 636f 6f72   "Locations coor
-0000df60: 6469 6e61 7465 7320 6172 6520 7363 616c  dinates are scal
-0000df70: 6564 2074 6f22 0d0a 2020 2020 2020 2020  ed to"..        
-0000df80: 2020 2020 2020 2020 2220 616e 6420 656c          " and el
-0000df90: 7665 7661 7469 6f6e 2073 686f 756c 6420  vevation should 
-0000dfa0: 6265 2074 6f70 7065 642e 2229 0d0a 2020  be topped.")..  
-0000dfb0: 2020 2020 2020 2020 2020 5245 5720 3d54            REW =T
-0000dfc0: 7275 6520 0d0a 2020 2020 2020 2020 0d0a  rue ..        ..
-0000dfd0: 2020 2020 2020 2020 2374 6865 6e20 7265          #then re
-0000dfe0: 6173 6361 6c65 6420 0d0a 2020 2020 2020  ascaled ..      
-0000dff0: 2020 2320 206b 6565 7020 7468 6520 6164    #  keep the ad
-0000e000: 6a75 7374 6d65 6e74 7320 7661 6c75 6573  justments values
-0000e010: 2066 6f72 206f 7468 6572 7320 7075 7270   for others purp
-0000e020: 6f73 6573 2e0d 0a20 2020 2020 2020 2073  oses...        s
-0000e030: 656c 662e 5f5f 7365 7461 7474 725f 5f28  elf.__setattr__(
-0000e040: 2765 5f65 6173 7427 2c20 7365 6c66 2e65  'e_east', self.e
-0000e050: 6173 7429 0d0a 2020 2020 2020 2020 7365  ast)..        se
-0000e060: 6c66 2e5f 5f73 6574 6174 7472 5f5f 2827  lf.__setattr__('
-0000e070: 6e5f 6e6f 7274 6827 2c20 7365 6c66 2e6e  n_north', self.n
-0000e080: 6f72 7468 290d 0a20 2020 2020 2020 200d  orth)..        .
-0000e090: 0a20 2020 2020 2020 2069 6620 7265 2e6d  .        if re.m
-0000e0a0: 6174 6368 2872 275e 636c 6173 2b27 2c20  atch(r'^clas+', 
-0000e0b0: 7374 7261 6967 6874 5f74 7970 6529 2069  straight_type) i
-0000e0c0: 7320 6e6f 7420 4e6f 6e65 203a 0d0a 2020  s not None :..  
-0000e0d0: 2020 2020 2020 2020 2020 2320 726a 5f66            # rj_f
-0000e0e0: 6163 746f 7220 3d20 2873 656c 662e 6561  actor = (self.ea
-0000e0f0: 7374 205b 2d31 5d20 2d73 656c 662e 6561  st [-1] -self.ea
-0000e100: 7374 5b30 5d29 202f 2873 656c 662e 6561  st[0]) /(self.ea
-0000e110: 7374 2e73 697a 6520 2d31 2920 0d0a 2020  st.size -1) ..  
-0000e120: 2020 2020 2020 2020 2020 2320 725f 6561            # r_ea
-0000e130: 7374 203d 6e70 2e6f 6e65 735f 6c69 6b65  st =np.ones_like
-0000e140: 2873 656c 662e 6561 7374 292a 206e 702e  (self.east)* np.
-0000e150: 6172 616e 6765 2873 656c 662e 6561 7374  arange(self.east
-0000e160: 2e73 697a 6529 0d0a 2020 2020 2020 2020  .size)..        
-0000e170: 2020 2020 7365 6c66 2e65 6173 7420 3d20      self.east = 
-0000e180: 6e70 2e61 7070 6c79 5f61 6c6f 6e67 5f61  np.apply_along_a
-0000e190: 7869 7328 6c61 6d62 6461 2072 723a 2072  xis(lambda rr: r
-0000e1a0: 7220 2a20 280d 0a20 2020 2020 2020 2020  r * (..         
-0000e1b0: 2020 2020 2020 2028 7365 6c66 2e65 6173         (self.eas
-0000e1c0: 7420 5b2d 315d 202d 7365 6c66 2e65 6173  t [-1] -self.eas
-0000e1d0: 745b 305d 2920 2f28 0d0a 2020 2020 2020  t[0]) /(..      
-0000e1e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000e1f0: 6c66 2e65 6173 742e 7369 7a65 202d 3129  lf.east.size -1)
-0000e200: 2920 2b20 7365 6c66 2e65 6173 745b 305d  ) + self.east[0]
-0000e210: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0000e220: 2020 2020 2020 2020 2020 302c 206e 702e            0, np.
-0000e230: 6f6e 6573 5f6c 696b 6528 7365 6c66 2e65  ones_like(self.e
-0000e240: 6173 7429 2a20 6e70 2e61 7261 6e67 6528  ast)* np.arange(
-0000e250: 7365 6c66 2e65 6173 742e 7369 7a65 2929  self.east.size))
-0000e260: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-0000e270: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000e280: 2e6e 6f72 7468 203d 206e 702e 6170 706c  .north = np.appl
-0000e290: 795f 616c 6f6e 675f 6178 6973 286c 616d  y_along_axis(lam
-0000e2a0: 6264 6120 7272 3a20 7272 202a 2028 0d0a  bda rr: rr * (..
-0000e2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2c0: 2873 656c 662e 6e6f 7274 6820 5b2d 315d  (self.north [-1]
-0000e2d0: 202d 7365 6c66 2e6e 6f72 7468 5b30 5d29   -self.north[0])
-0000e2e0: 202f 280d 0a20 2020 2020 2020 2020 2020   /(..           
-0000e2f0: 2020 2020 2020 2020 2073 656c 662e 6e6f           self.no
-0000e300: 7274 682e 7369 7a65 202d 3120 2929 202b  rth.size -1 )) +
-0000e310: 2073 656c 662e 6e6f 7274 685b 305d 2c0d   self.north[0],.
-0000e320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e330: 2020 2020 2020 2030 2c20 6e70 2e6f 6e65         0, np.one
-0000e340: 735f 6c69 6b65 2873 656c 662e 6e6f 7274  s_like(self.nort
-0000e350: 6829 2a20 6e70 2e61 7261 6e67 6528 7365  h)* np.arange(se
-0000e360: 6c66 2e6e 6f72 7468 2e73 697a 6529 290d  lf.north.size)).
-0000e370: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0000e380: 2020 2020 2020 2069 6620 7265 2e6d 6174         if re.mat
-0000e390: 6368 2872 275e 6571 2b27 2c20 7374 7261  ch(r'^eq+', stra
-0000e3a0: 6967 6874 5f74 7970 6529 2069 7320 6e6f  ight_type) is no
-0000e3b0: 7420 4e6f 6e65 203a 200d 0a20 2020 2020  t None : ..     
-0000e3c0: 2020 2020 2020 2073 656c 662e 6561 7374         self.east
-0000e3d0: 203d 6e70 2e6c 696e 7370 6163 6528 7365   =np.linspace(se
-0000e3e0: 6c66 2e65 6173 745b 305d 2c20 7365 6c66  lf.east[0], self
-0000e3f0: 2e65 6173 745b 2d31 5d2c 0d0a 2020 2020  .east[-1],..    
-0000e400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e410: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000e420: 656c 662e 6561 7374 2e73 697a 6520 290d  elf.east.size ).
-0000e430: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000e440: 662e 6e6f 7274 6820 3d6e 702e 6c69 6e73  f.north =np.lins
-0000e450: 7061 6365 2873 656c 662e 6e6f 7274 685b  pace(self.north[
-0000e460: 305d 2c20 7365 6c66 2e65 6173 745b 2d31  0], self.east[-1
-0000e470: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-0000e480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e490: 2020 2020 2020 2020 7365 6c66 2e6e 6f72          self.nor
-0000e4a0: 7468 2e73 697a 6520 290d 0a20 2020 2020  th.size )..     
-0000e4b0: 2020 2065 6c69 6620 2872 652e 6d61 7463     elif (re.matc
-0000e4c0: 6828 7227 5e6e 6174 2b27 2c20 7374 7261  h(r'^nat+', stra
-0000e4d0: 6967 6874 5f74 7970 6529 2069 7320 6e6f  ight_type) is no
-0000e4e0: 7420 4e6f 6e65 2920 6f72 2028 0d0a 2020  t None) or (..  
-0000e4f0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000e500: 2e6d 6174 6368 2872 275e 6469 732b 272c  .match(r'^dis+',
-0000e510: 2073 7472 6169 6768 745f 7479 7065 2920   straight_type) 
-0000e520: 6973 206e 6f74 204e 6f6e 6529 203a 0d0a  is not None) :..
-0000e530: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0000e540: 2020 2020 2020 2020 2020 2361 206b 696e            #a kin
-0000e550: 6420 6f66 2073 7472 6169 6768 7468 656e  d of straighthen
-0000e560: 2077 6974 6820 6571 7569 7364 6973 7461   with equisdista
-0000e570: 6e74 2076 616c 7565 2062 6574 7765 656e  nt value between
-0000e580: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-0000e590: 7374 6174 696f 6e20 6275 7420 6e6f 7420  station but not 
-0000e5a0: 7374 7261 6967 6874 202c 6b69 6e67 206f  straight ,king o
-0000e5b0: 7220 6e61 7475 7261 6c20 6173 7065 6374  r natural aspect
-0000e5c0: 206f 6e20 7468 6520 7369 7465 202e 200d   on the site . .
-0000e5d0: 0a20 2020 2020 2020 2020 2020 2072 665f  .            rf_
-0000e5e0: 5820 3d20 6e70 2e61 7272 6179 285b 7661  X = np.array([va
-0000e5f0: 6c75 6520 2d20 7365 6c66 2e65 6173 745b  lue - self.east[
-0000e600: 6969 2b31 5d0d 0a20 2020 2020 2020 2020  ii+1]..         
-0000e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e620: 2020 2020 666f 7220 6969 202c 2076 616c      for ii , val
-0000e630: 7565 2069 6e20 656e 756d 6572 6174 6528  ue in enumerate(
-0000e640: 7365 6c66 2e65 6173 7429 200d 0a20 2020  self.east) ..   
-0000e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e660: 2020 2020 2020 2020 2020 2069 6620 6969             if ii
-0000e670: 203c 3d20 7365 6c66 2e65 6173 742e 7369   <= self.east.si
-0000e680: 7a65 202d 2032 205d 292e 6d65 616e 2829  ze - 2 ]).mean()
-0000e690: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0000e6a0: 7266 5f59 203d 206e 702e 6172 7261 7928  rf_Y = np.array(
-0000e6b0: 5b76 616c 7565 202d 2073 656c 662e 6e6f  [value - self.no
-0000e6c0: 7274 685b 6969 2b31 5d20 0d0a 2020 2020  rth[ii+1] ..    
-0000e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6e0: 2020 2020 2020 2020 2066 6f72 2069 6920           for ii 
-0000e6f0: 2c20 7661 6c75 6520 696e 2065 6e75 6d65  , value in enume
-0000e700: 7261 7465 2873 656c 662e 6e6f 7274 6829  rate(self.north)
-0000e710: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e730: 2069 6620 6969 203c 3d20 7365 6c66 2e6e   if ii <= self.n
-0000e740: 6f72 7468 2e73 697a 6520 2d20 3220 5d29  orth.size - 2 ])
-0000e750: 2e6d 6561 6e28 290d 0a20 2020 2020 2020  .mean()..       
-0000e760: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000e770: 2020 2074 656d 705f 6565 203d 206e 702e     temp_ee = np.
-0000e780: 7a65 726f 735f 6c69 6b65 2873 656c 662e  zeros_like(self.
-0000e790: 6561 7374 2920 0d0a 2020 2020 2020 2020  east) ..        
-0000e7a0: 2020 2020 7465 6d70 5f6e 6e20 3d20 6e70      temp_nn = np
-0000e7b0: 2e7a 6572 6f73 5f6c 696b 6528 7365 6c66  .zeros_like(self
-0000e7c0: 2e6e 6f72 7468 2920 0d0a 2020 2020 2020  .north) ..      
-0000e7d0: 2020 2020 2020 7465 6d70 5f65 6520 5b30        temp_ee [0
-0000e7e0: 5d2c 2074 656d 705f 6e6e 5b30 5d20 3d20  ], temp_nn[0] = 
-0000e7f0: 7365 6c66 2e65 6173 745b 305d 202c 2073  self.east[0] , s
-0000e800: 656c 662e 6e6f 7274 685b 305d 0d0a 2020  elf.north[0]..  
-0000e810: 2020 2020 2020 2020 2020 666f 7220 206a            for  j
-0000e820: 6a20 2c20 7661 6c75 6520 696e 2065 6e75  j , value in enu
-0000e830: 6d65 7261 7465 2874 656d 705f 6565 293a  merate(temp_ee):
-0000e840: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000e850: 2020 2069 6620 206a 6a20 3e20 3020 3a20     if  jj > 0 : 
-0000e860: 7465 6d70 5f65 6520 5b6a 6a5d 3d73 656c  temp_ee [jj]=sel
-0000e870: 662e 6561 7374 5b6a 6a2d 315d 2d20 7266  f.east[jj-1]- rf
-0000e880: 5f58 0d0a 2020 2020 2020 2020 2020 2020  _X..            
-0000e890: 666f 7220 206a 6a20 2c20 7661 6c75 6520  for  jj , value 
-0000e8a0: 696e 2065 6e75 6d65 7261 7465 2874 656d  in enumerate(tem
-0000e8b0: 705f 6e6e 293a 200d 0a20 2020 2020 2020  p_nn): ..       
-0000e8c0: 2020 2020 2020 2020 2069 6620 206a 6a20           if  jj 
-0000e8d0: 3e20 3020 3a20 7465 6d70 5f6e 6e20 5b6a  > 0 : temp_nn [j
-0000e8e0: 6a5d 3d73 656c 662e 6e6f 7274 685b 6a6a  j]=self.north[jj
-0000e8f0: 2d31 5d2d 2072 665f 590d 0a20 2020 2020  -1]- rf_Y..     
-0000e900: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000e910: 2020 2020 2073 656c 662e 6561 7374 202c       self.east ,
-0000e920: 2073 656c 662e 6e6f 7274 6820 3d20 7465   self.north = te
-0000e930: 6d70 5f65 6520 2c20 7465 6d70 5f6e 6e20  mp_ee , temp_nn 
-0000e940: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000e950: 2020 2020 6966 206f 7574 7075 7420 6973      if output is
-0000e960: 2054 7275 6520 3a20 2320 6578 706f 7274   True : # export
-0000e970: 2074 6865 2066 696c 6520 7769 7468 6f75   the file withou
-0000e980: 7420 7363 616c 696e 6720 2c20 7365 7420  t scaling , set 
-0000e990: 582c 2059 2074 6f20 302e 200d 0a20 2020  X, Y to 0. ..   
-0000e9a0: 2020 2020 2023 2061 6e64 206b 6565 7020       # and keep 
-0000e9b0: 7468 6520 6e65 7720 6561 7374 696e 6720  the new easting 
-0000e9c0: 616e 6420 4e6f 7274 6869 6e67 2063 6f6f  and Northing coo
-0000e9d0: 7264 696e 6174 6573 200d 0a20 2020 2020  rdinates ..     
-0000e9e0: 2020 2020 2020 205f 2c73 656c 662e 6561         _,self.ea
-0000e9f0: 7374 2c20 7365 6c66 2e6e 6f72 7468 2c2a  st, self.north,*
-0000ea00: 5f3d 2073 656c 662e 7265 616a 7573 745f  _= self.reajust_
-0000ea10: 636f 6f72 6469 6e61 7465 735f 7661 6c75  coordinates_valu
-0000ea20: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
-0000ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea40: 2020 2020 2020 2020 2020 2020 2065 6173               eas
-0000ea50: 7469 6e67 3d20 7365 6c66 2e65 6173 742c  ting= self.east,
-0000ea60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea80: 2020 2020 2020 2020 2020 6e6f 7274 6869            northi
-0000ea90: 6e67 203d 7365 6c66 2e6e 6f72 7468 202c  ng =self.north ,
-0000eaa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eac0: 2020 2020 2020 2020 2020 783d 302e 2c20            x=0., 
-0000ead0: 793d 302e 2c20 7374 6174 696f 6e5f 706b  y=0., station_pk
-0000eae0: 3d73 746e 5f70 6b2c 200d 0a20 2020 2020  =stn_pk, ..     
-0000eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb10: 2020 2072 6577 7269 7465 3d52 4557 2c20     rewrite=REW, 
-0000eb20: 656c 6576 6174 696f 6e3d 2065 6c65 762c  elevation= elev,
-0000eb30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb50: 2020 2020 2020 2020 2020 2073 6176 6570             savep
-0000eb60: 6174 6820 3d73 656c 662e 7361 7665 7061  ath =self.savepa
-0000eb70: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
-0000eb80: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-0000eb90: 656c 662e 5f6c 6f67 6769 6e67 2e69 6e66  elf._logging.inf
-0000eba0: 6f20 280d 0a20 2020 2020 2020 2020 2020  o (..           
-0000ebb0: 2020 2020 2022 4c6f 6361 7469 6f6e 7320       "Locations 
-0000ebc0: 636f 6f72 6469 6e61 7465 7320 6172 6520  coordinates are 
-0000ebd0: 7265 616a 7573 7465 6420 616e 6420 220d  reajusted and ".
-0000ebe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ebf0: 2022 2073 7472 6169 6768 7465 6e65 6420   " straightened 
-0000ec00: 6f75 7420 7072 6f66 696c 6520 616e 6420  out profile and 
-0000ec10: 7765 276c 6c20 746f 7020 656c 6576 6174  we'll top elevat
-0000ec20: 696f 6e2e 2229 0d0a 2020 2020 2020 2020  ion.")..        
-0000ec30: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-0000ec40: 2020 7072 696e 7428 222d 2d2d 3e20 4c6f    print("---> Lo
-0000ec50: 6361 7469 6f6e 7320 636f 6f72 6469 6e61  cations coordina
-0000ec60: 7465 7320 6172 6522 0d0a 2020 2020 2020  tes are"..      
-0000ec70: 2020 2020 2020 2020 2020 2020 2220 7265              " re
-0000ec80: 616a 7573 7465 6420 616e 6420 7374 7261  ajusted and stra
-0000ec90: 6967 6874 656e 6564 206f 7574 220d 0a20  ightened out".. 
-0000eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ecb0: 2022 2070 726f 6669 6c65 2e20 456c 6576   " profile. Elev
-0000ecc0: 6174 696f 6e20 6973 2061 6464 6564 2e22  ation is added."
-0000ecd0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0000ece0: 2064 6566 2072 6577 7269 7465 5f73 7461   def rewrite_sta
-0000ecf0: 7469 6f6e 5f70 726f 6669 6c65 2028 7365  tion_profile (se
-0000ed00: 6c66 2c20 6561 7374 696e 6720 3d4e 6f6e  lf, easting =Non
-0000ed10: 6520 2c20 0d0a 2020 2020 2020 2020 2020  e , ..          
-0000ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed30: 2020 2020 2020 206e 6f72 7468 696e 673d         northing=
-0000ed40: 4e6f 6e65 202c 0d0a 2020 2020 2020 2020  None ,..        
-0000ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed60: 2020 2020 2020 2020 2065 6c65 7661 7469           elevati
-0000ed70: 6f6e 203d 4e6f 6e65 202c 200d 0a20 2020  on =None , ..   
-0000ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed90: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-0000eda0: 6561 5f6e 616d 6520 3d4e 6f6e 652c 0d0a  ea_name =None,..
-0000edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000edd0: 2075 7365 726e 616d 6520 3d4e 6f6e 652c   username =None,
-0000ede0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000edf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee00: 2020 2020 6164 645f 617a 696d 7574 6820      add_azimuth 
-0000ee10: 3d46 616c 7365 2c0d 0a20 2020 2020 2020  =False,..       
-0000ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee30: 2020 2020 2020 2020 2020 2a2a 6b77 6172            **kwar
-0000ee40: 6773 293a 200d 0a20 2020 2020 2020 2022  gs): ..        "
-0000ee50: 2222 0d0a 2020 2020 2020 2020 4d74 686f  ""..        Mtho
-0000ee60: 6420 746f 2072 6577 7269 7465 2073 7461  d to rewrite sta
-0000ee70: 7469 6f6e 5f70 726f 6669 6c65 206f 7220  tion_profile or 
-0000ee80: 6f75 7470 7574 206e 6577 2070 726f 6669  output new profi
-0000ee90: 6c65 200d 0a20 2020 2020 2020 2062 7920  le ..        by 
-0000eea0: 7374 7261 6967 6874 656e 696e 6720 7072  straightening pr
-0000eeb0: 6f66 696c 6520 7468 726f 7567 6874 2072  ofile throught r
-0000eec0: 6561 6a75 7374 696e 6720 6c6f 6361 7469  eajusting locati
-0000eed0: 6f6e 200d 0a20 2020 2020 2020 2063 6f6f  on ..        coo
-0000eee0: 7264 696e 6174 6573 2076 616c 7565 732e  rdinates values.
-0000eef0: 5573 6572 2063 616e 2075 7365 2074 6869  User can use thi
-0000ef00: 7320 6d65 7468 6f64 2074 6f20 6372 6561  s method to crea
-0000ef10: 7465 207a 6f6e 6765 0d0a 2020 2020 2020  te zonge..      
-0000ef20: 2020 202a 7374 6e2a 2066 696c 6520 6966     *stn* file if
-0000ef30: 2063 6f6f 7264 696e 6174 6573 2061 7265   coordinates are
-0000ef40: 206b 6e6f 776e 2e0d 0a20 2020 2020 2020   known...       
-0000ef50: 2020 0d0a 2020 2020 2020 2020 3a70 6172    ..        :par
-0000ef60: 616d 2065 6173 7469 6e67 3a20 2065 6173  am easting:  eas
-0000ef70: 7469 6e67 2063 6f6f 7264 696e 6174 6573  ting coordinates
-0000ef80: 2028 6d29 0d0a 2020 2020 2020 2020 3a74   (m)..        :t
-0000ef90: 7970 6520 6561 7374 696e 673a 2061 7272  ype easting: arr
-0000efa0: 6179 5f6c 696b 6520 0d0a 2020 2020 2020  ay_like ..      
-0000efb0: 2020 0d0a 2020 2020 2020 2020 3a70 6172    ..        :par
-0000efc0: 616d 206e 6f72 7468 696e 673a 206e 6f72  am northing: nor
-0000efd0: 7468 696e 6720 636f 6f72 6469 6e61 7465  thing coordinate
-0000efe0: 7320 286d 2920 0d0a 2020 2020 2020 2020  s (m) ..        
-0000eff0: 3a74 7970 6520 6e6f 7274 6869 6e67 3a20  :type northing: 
-0000f000: 6172 7261 795f 6c69 6b65 200d 0a20 2020  array_like ..   
-0000f010: 2020 2020 200d 0a20 2020 2020 2020 203a       ..        :
-0000f020: 7061 7261 6d20 656c 6576 6174 696f 6e3a  param elevation:
-0000f030: 2065 6c65 7661 7469 6f6e 2076 616c 7565   elevation value
-0000f040: 7320 286d 290d 0a20 2020 2020 2020 203a  s (m)..        :
-0000f050: 7479 7065 2065 6c65 7661 7469 6f6e 3a20  type elevation: 
-0000f060: 6172 7261 795f 6c69 6b65 200d 0a20 2020  array_like ..   
-0000f070: 2020 2020 200d 0a20 2020 2020 2020 203a       ..        :
-0000f080: 7061 7261 6d20 7573 6572 6e61 6d65 3a20  param username: 
-0000f090: 6e61 6d65 2020 6f66 2075 7365 7220 0d0a  name  of user ..
-0000f0a0: 2020 2020 2020 2020 3a74 7970 6520 7573          :type us
-0000f0b0: 6572 6e61 6d65 3a20 7374 7220 0d0a 2020  ername: str ..  
-0000f0c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000f0d0: 3a70 6172 616d 2061 6464 5f61 7a69 6d75  :param add_azimu
-0000f0e0: 7468 3a20 636f 6d70 7574 6520 617a 696d  th: compute azim
-0000f0f0: 7574 6820 200d 0a20 2020 2020 2020 2020  uth  ..         
-0000f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f110: 2020 2070 6f73 6974 6976 6520 646f 776e     positive down
-0000f120: 2863 6c6f 636b 7769 7365 290d 0a20 2020  (clockwise)..   
-0000f130: 2020 2020 203a 7479 7065 2061 6464 5f61       :type add_a
-0000f140: 7a69 6d75 7468 3a20 626f 6f6c 2020 200d  zimuth: bool   .
-0000f150: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0000f160: 2020 2020 2020 0d0a 2020 2020 0d0a 2020        ..    ..  
-0000f170: 2020 2020 2020 7574 6d5f 7a6f 6e65 203d        utm_zone =
-0000f180: 206b 7761 7267 732e 706f 7028 2755 544d   kwargs.pop('UTM
-0000f190: 5f5a 6f6e 6527 2c20 4e6f 6e65 290d 0a20  _Zone', None).. 
-0000f1a0: 2020 2020 2020 2064 6970 6f6c 655f 6c65         dipole_le
-0000f1b0: 6e67 7468 203d 6b77 6172 6773 2e70 6f70  ngth =kwargs.pop
-0000f1c0: 2827 6469 706f 6c65 5f6c 656e 6774 6827  ('dipole_length'
-0000f1d0: 2c20 4e6f 6e65 290d 0a20 2020 2020 2020  , None)..       
-0000f1e0: 206f 7574 7075 745f 6e61 6d65 203d 6b77   output_name =kw
-0000f1f0: 6172 6773 2e70 6f70 2827 6f75 7470 7574  args.pop('output
-0000f200: 5f6e 616d 6527 2c20 4e6f 6e65 290d 0a20  _name', None).. 
-0000f210: 2020 2020 2020 2073 6176 6570 6174 6820         savepath 
-0000f220: 3d6b 7761 7267 732e 706f 7028 2773 6176  =kwargs.pop('sav
-0000f230: 6570 6174 6827 2c20 4e6f 6e65 290d 0a20  epath', None).. 
-0000f240: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0000f250: 2069 6620 7361 7665 7061 7468 2069 7320   if savepath is 
-0000f260: 6e6f 7420 4e6f 6e65 3a20 0d0a 2020 2020  not None: ..    
-0000f270: 2020 2020 2020 2020 7365 6c66 2e73 6176          self.sav
-0000f280: 6570 6174 6820 3d20 7361 7665 7061 7468  epath = savepath
-0000f290: 200d 0a20 2020 2020 2020 2069 6620 6f75   ..        if ou
-0000f2a0: 7470 7574 5f6e 616d 6520 6973 204e 6f6e  tput_name is Non
-0000f2b0: 6520 3a0d 0a20 2020 2020 2020 2020 2020  e :..           
-0000f2c0: 206f 7574 7075 745f 6e61 6d65 3d27 6e65   output_name='ne
-0000f2d0: 775f 7072 6f66 696c 6527 0d0a 2020 2020  w_profile'..    
-0000f2e0: 2020 2020 6966 2075 746d 5f7a 6f6e 6520      if utm_zone 
-0000f2f0: 6973 206e 6f74 204e 6f6e 6520 3a20 0d0a  is not None : ..
-0000f300: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000f310: 2e75 746d 5f7a 6f6e 6520 3d20 7574 6d5f  .utm_zone = utm_
-0000f320: 7a6f 6e65 0d0a 2020 2020 2020 2020 6966  zone..        if
-0000f330: 2061 7265 615f 6e61 6d65 2069 7320 4e6f   area_name is No
-0000f340: 6e65 203a 0d0a 2020 2020 2020 2020 2020  ne :..          
-0000f350: 2020 6172 6561 5f6e 616d 6520 3d27 2720    area_name ='' 
-0000f360: 0d0a 2020 2020 2020 2020 6966 2075 7365  ..        if use
-0000f370: 726e 616d 6520 6973 204e 6f6e 6520 3a0d  rname is None :.
-0000f380: 0a20 2020 2020 2020 2020 2020 2075 7365  .            use
-0000f390: 726e 616d 6520 3d27 270d 0a20 2020 2020  rname =''..     
-0000f3a0: 2020 2069 6620 6561 7374 696e 6720 6973     if easting is
-0000f3b0: 206e 6f74 204e 6f6e 6520 3a0d 0a20 2020   not None :..   
-0000f3c0: 2020 2020 2020 2020 2073 656c 662e 6561           self.ea
-0000f3d0: 7374 203d 6e70 2e61 7272 6179 2865 6173  st =np.array(eas
-0000f3e0: 7469 6e67 2029 0d0a 2020 2020 2020 2020  ting )..        
-0000f3f0: 6966 206e 6f72 7468 696e 6720 6973 206e  if northing is n
-0000f400: 6f74 204e 6f6e 6520 3a0d 0a20 2020 2020  ot None :..     
-0000f410: 2020 2020 2020 2073 656c 662e 6e6f 7274         self.nort
-0000f420: 6820 3d20 6e70 2e61 7272 6179 286e 6f72  h = np.array(nor
-0000f430: 7468 696e 6729 200d 0a20 2020 2020 2020  thing) ..       
-0000f440: 2069 6620 656c 6576 6174 696f 6e20 6973   if elevation is
-0000f450: 206e 6f74 204e 6f6e 6520 3a0d 0a20 2020   not None :..   
-0000f460: 2020 2020 2020 2020 2073 656c 662e 656c           self.el
-0000f470: 6576 203d 206e 702e 6172 7261 7928 656c  ev = np.array(el
-0000f480: 6576 6174 696f 6e29 0d0a 2020 2020 2020  evation)..      
-0000f490: 2020 6966 2073 656c 662e 6561 7374 2069    if self.east i
-0000f4a0: 7320 4e6f 6e65 206f 7220 7365 6c66 2e6e  s None or self.n
-0000f4b0: 6f72 7468 2069 7320 4e6f 6e65 203a 200d  orth is None : .
-0000f4c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f4d0: 662e 5f6c 6f67 6769 6e67 2e77 6172 6e69  f._logging.warni
-0000f4e0: 6e67 280d 0a20 2020 2020 2020 2020 2020  ng(..           
-0000f4f0: 2020 2020 2022 4974 2073 6565 6d73 2079       "It seems y
-0000f500: 6f75 2064 6964 206e 6f74 2070 726f 7669  ou did not provi
-0000f510: 6465 2061 6e79 2065 6173 7469 6e67 220d  de any easting".
-0000f520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f530: 2020 2020 2020 2020 2020 2020 2022 2076               " v
-0000f540: 616c 7565 7320 6e6f 7220 6e6f 7274 6869  alues nor northi
-0000f550: 6e67 2076 616c 7565 2e22 290d 0a20 2020  ng value.")..   
-0000f560: 2020 2020 2020 2020 2072 6169 7365 2043           raise C
-0000f570: 5365 782e 7079 4353 414d 5445 7272 6f72  Sex.pyCSAMTError
-0000f580: 5f70 726f 6669 6c65 280d 0a20 2020 2020  _profile(..     
-0000f590: 2020 2020 2020 2020 2020 2022 596f 7520             "You 
-0000f5a0: 6d61 7920 7072 6f76 6964 6520 6561 7374  may provide east
-0000f5b0: 696e 6720 616e 6420 6e6f 7274 6869 6e67  ing and northing
-0000f5c0: 2076 616c 7565 7320 6265 666f 7265 220d   values before".
-0000f5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f5e0: 2022 2077 7269 7474 696e 6720 6120 6e65   " writting a ne
-0000f5f0: 7720 7374 6174 696f 6e20 7072 6f66 696c  w station profil
-0000f600: 6520 3c2a 2e73 746e 3e20 2229 0d0a 2020  e <*.stn> ")..  
-0000f610: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000f620: 2020 2020 7772 6974 655f 7072 6f66 696c      write_profil
-0000f630: 655f 6c69 6e65 7320 3d5b 5d0d 0a20 2020  e_lines =[]..   
-0000f640: 2020 2020 2077 7269 7465 5f70 726f 6669       write_profi
-0000f650: 6c65 5f6c 696e 6573 2e61 7070 656e 6428  le_lines.append(
-0000f660: 2727 2e6a 6f69 6e28 5b27 7b30 3a3c 3137  ''.join(['{0:<17
-0000f670: 7d27 2e66 6f72 6d61 7428 0d0a 2020 2020  }'.format(..    
-0000f680: 2020 2020 2020 2020 273e 4c4f 4341 5449          '>LOCATI
-0000f690: 4f4e 2729 2c27 3a27 2c22 207b 303a 3c35  ON'),':'," {0:<5
-0000f6a0: 357d 222e 666f 726d 6174 2861 7265 615f  5}".format(area_
-0000f6b0: 6e61 6d65 2920 5d29 2b27 5c6e 2729 0d0a  name) ])+'\n')..
-0000f6c0: 2020 2020 2020 2020 7772 6974 655f 7072          write_pr
-0000f6d0: 6f66 696c 655f 6c69 6e65 732e 6170 7065  ofile_lines.appe
-0000f6e0: 6e64 2827 272e 6a6f 696e 285b 277b 303a  nd(''.join(['{0:
-0000f6f0: 3c31 377d 272e 666f 726d 6174 280d 0a20  <17}'.format(.. 
-0000f700: 2020 2020 2020 2020 2020 2027 3e55 5345             '>USE
-0000f710: 524e 414d 4527 292c 273a 272c 2220 7b30  RNAME'),':'," {0
-0000f720: 3a3c 3535 7d22 2e66 6f72 6d61 7428 7573  :<55}".format(us
-0000f730: 6572 6e61 6d65 2920 5d29 2b27 5c6e 2729  ername) ])+'\n')
-0000f740: 0d0a 2020 2020 2020 2020 7772 6974 655f  ..        write_
-0000f750: 7072 6f66 696c 655f 6c69 6e65 732e 6170  profile_lines.ap
-0000f760: 7065 6e64 280d 0a20 2020 2020 2020 2020  pend(..         
-0000f770: 2020 2027 272e 6a6f 696e 285b 277b 303a     ''.join(['{0:
-0000f780: 3c31 377d 272e 666f 726d 6174 2827 3e44  <17}'.format('>D
-0000f790: 4154 4527 292c 273a 272c 2220 7b30 3a3c  ATE'),':'," {0:<
-0000f7a0: 3730 7d22 2e5c 0d0a 2020 2020 2020 2020  70}".\..        
-0000f7b0: 2020 2020 2020 2020 666f 726d 6174 2874          format(t
-0000f7c0: 696d 652e 7374 7266 7469 6d65 2827 2559  ime.strftime('%Y
-0000f7d0: 2d25 6d2d 2564 2025 483a 254d 3a25 5327  -%m-%d %H:%M:%S'
-0000f7e0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0000f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f800: 2020 2020 2020 2020 2074 696d 652e 676d           time.gm
-0000f810: 7469 6d65 2829 2929 205d 292b 275c 6e27  time())) ])+'\n'
-0000f820: 290d 0a20 2020 2020 2020 2077 7269 7465  )..        write
-0000f830: 5f70 726f 6669 6c65 5f6c 696e 6573 2e61  _profile_lines.a
-0000f840: 7070 656e 6428 2727 2e6a 6f69 6e28 5b27  ppend(''.join(['
-0000f850: 7b30 3a3c 3137 7d27 2e66 6f72 6d61 7428  {0:<17}'.format(
-0000f860: 0d0a 2020 2020 2020 2020 2020 2020 273e  ..            '>
-0000f870: 5554 4d5f 5a4f 4e45 2729 2c27 3a27 2c22  UTM_ZONE'),':',"
-0000f880: 207b 303a 3c35 7d2d 7b31 3a3c 377d 222e   {0:<5}-{1:<7}".
-0000f890: 666f 726d 6174 2827 5747 5338 3427 2c0d  format('WGS84',.
-0000f8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8d0: 2020 2020 2020 7365 6c66 2e75 746d 5f7a        self.utm_z
-0000f8e0: 6f6e 6529 205d 292b 275c 6e27 2920 2020  one) ])+'\n')   
-0000f8f0: 200d 0a20 2020 2020 2020 2077 7269 7465   ..        write
-0000f900: 5f70 726f 6669 6c65 5f6c 696e 6573 2e61  _profile_lines.a
-0000f910: 7070 656e 6428 2727 2e6a 6f69 6e28 5b27  ppend(''.join(['
-0000f920: 7b30 3a3c 3137 7d27 2e66 6f72 6d61 7428  {0:<17}'.format(
-0000f930: 0d0a 2020 2020 2020 2020 2020 2020 273e  ..            '>
-0000f940: 534f 4654 5741 5245 2729 2c27 3a27 2c22  SOFTWARE'),':',"
-0000f950: 207b 303a 3535 7d22 2e66 6f72 6d61 7428   {0:55}".format(
-0000f960: 2770 7943 5341 4d54 2729 205d 292b 275c  'pyCSAMT') ])+'\
-0000f970: 6e27 290d 0a20 2020 2020 2020 200d 0a20  n')..        .. 
-0000f980: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
-0000f990: 6174 2069 7320 4e6f 6e65 2020 6f72 2073  at is None  or s
-0000f9a0: 656c 662e 6c6f 6e20 6973 204e 6f6e 6520  elf.lon is None 
-0000f9b0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000f9c0: 7365 6c66 2e4c 6f63 6174 696f 6e2e 636f  self.Location.co
-0000f9d0: 6e76 6572 745f 6c6f 6361 7469 6f6e 5f32  nvert_location_2
-0000f9e0: 5f6c 6174 6c6f 6e28 7574 6d5f 7a6f 6e65  _latlon(utm_zone
-0000f9f0: 3d73 656c 662e 7574 6d5f 7a6f 6e65 290d  =self.utm_zone).
-0000fa00: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000fa10: 2020 2069 6620 7365 6c66 2e65 6173 7420     if self.east 
-0000fa20: 6973 204e 6f6e 6520 6f72 2073 656c 662e  is None or self.
-0000fa30: 6e6f 7274 6820 6973 204e 6f6e 6520 3a20  north is None : 
-0000fa40: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0000fa50: 6c66 2e4c 6f63 6174 696f 6e2e 636f 6e76  lf.Location.conv
-0000fa60: 6572 745f 6c6f 6361 7469 6f6e 5f32 5f75  ert_location_2_u
-0000fa70: 746d 286c 6174 6974 7564 653d 7365 6c66  tm(latitude=self
-0000fa80: 2e6c 6174 2c0d 0a20 2020 2020 2020 2020  .lat,..         
+0000da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000daa0: 2020 2873 656c 662e 6561 7374 2e73 697a    (self.east.siz
+0000dab0: 6520 2d20 3129 202a 2073 656c 662e 6469  e - 1) * self.di
+0000dac0: 706f 6c65 5f6c 656e 6774 6820 2929 0d0a  pole_length ))..
+0000dad0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000dae0: 2020 2020 2020 6966 2073 656c 662e 656c        if self.el
+0000daf0: 6576 2069 7320 6e6f 7420 4e6f 6e65 203a  ev is not None :
+0000db00: 2065 6c65 7620 3d6e 702e 6172 6f75 6e64   elev =np.around
+0000db10: 2873 656c 662e 656c 6576 2c32 2920 0d0a  (self.elev,2) ..
+0000db20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000db30: 203a 2065 6c65 7620 3d20 6e70 2e72 6570   : elev = np.rep
+0000db40: 6561 7428 302e 2c20 7365 6c66 2e65 6173  eat(0., self.eas
+0000db50: 742e 7369 7a65 290d 0a20 2020 2020 2020  t.size)..       
+0000db60: 2020 2020 2023 2069 6620 6f75 7470 7574       # if output
+0000db70: 2069 7320 5472 7565 203a 2052 4557 203d   is True : REW =
+0000db80: 4661 6c73 6520 2320 6669 7274 6c79 202c  False # firtly ,
+0000db90: 0d0a 2020 2020 2020 2020 2020 2020 2361  ..            #a
+0000dba0: 646a 7573 7420 636f 6f72 6469 6e61 7465  djust coordinate
+0000dbb0: 7320 7769 7468 6f75 7420 6f75 7470 7574  s without output
+0000dbc0: 2066 696c 6520 2073 6574 2052 4557 2074   file  set REW t
+0000dbd0: 6f20 4661 6c73 6520 0d0a 2020 2020 2020  o False ..      
+0000dbe0: 2020 2020 2020 5f2c 2073 656c 662e 6561        _, self.ea
+0000dbf0: 7374 2c20 7365 6c66 2e6e 6f72 7468 202c  st, self.north ,
+0000dc00: 2a5f 3d20 7365 6c66 2e72 6561 6a75 7374  *_= self.reajust
+0000dc10: 5f63 6f6f 7264 696e 6174 6573 5f76 616c  _coordinates_val
+0000dc20: 7565 7328 0d0a 2020 2020 2020 2020 2020  ues(..          
+0000dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dc40: 2020 2020 2020 2020 2020 2020 2020 6561                ea
+0000dc50: 7374 696e 673d 2073 656c 662e 6561 7374  sting= self.east
+0000dc60: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000dc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dc80: 2020 2020 2020 2020 2020 206e 6f72 7468             north
+0000dc90: 696e 6720 3d73 656c 662e 6e6f 7274 6820  ing =self.north 
+0000dca0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0000dcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dcc0: 2020 2020 2020 2020 2020 2020 783d 7265              x=re
+0000dcd0: 616a 7573 745b 305d 2c20 793d 7265 616a  ajust[0], y=reaj
+0000dce0: 7573 745b 315d 2c0d 0a20 2020 2020 2020  ust[1],..       
+0000dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd10: 2073 7461 7469 6f6e 5f70 6b3d 7374 6e5f   station_pk=stn_
+0000dd20: 706b 2c20 0d0a 2020 2020 2020 2020 2020  pk, ..          
+0000dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd40: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000dd50: 7772 6974 653d 5245 572c 2065 6c65 7661  write=REW, eleva
+0000dd60: 7469 6f6e 3d20 656c 6576 290d 0a20 2020  tion= elev)..   
+0000dd70: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0000dd80: 2020 2020 2020 2070 7269 6e74 2822 2d2d         print("--
+0000dd90: 2d3e 204c 6f63 6174 696f 6e73 2063 6f6f  -> Locations coo
+0000dda0: 7264 696e 6174 6573 2061 7265 2073 6361  rdinates are sca
+0000ddb0: 6c65 6420 220d 0a20 2020 2020 2020 2020  led "..         
+0000ddc0: 2020 2020 2020 2020 2022 616e 6420 656c           "and el
+0000ddd0: 6576 6174 696f 6e20 6973 2061 6464 6564  evation is added
+0000dde0: 2e22 290d 0a20 2020 2020 2020 2020 2020  .")..           
+0000ddf0: 2073 656c 662e 5f6c 6f67 6769 6e67 2e69   self._logging.i
+0000de00: 6e66 6f20 280d 0a20 2020 2020 2020 2020  nfo (..         
+0000de10: 2020 2020 2020 2022 4c6f 6361 7469 6f6e         "Location
+0000de20: 7320 636f 6f72 6469 6e61 7465 7320 6172  s coordinates ar
+0000de30: 6520 7363 616c 6564 2074 6f22 0d0a 2020  e scaled to"..  
+0000de40: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+0000de50: 616e 6420 656c 7665 7661 7469 6f6e 2073  and elvevation s
+0000de60: 686f 756c 6420 6265 2074 6f70 7065 642e  hould be topped.
+0000de70: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0000de80: 5245 5720 3d54 7275 6520 0d0a 2020 2020  REW =True ..    
+0000de90: 2020 2020 0d0a 2020 2020 2020 2020 2374      ..        #t
+0000dea0: 6865 6e20 7265 6173 6361 6c65 6420 0d0a  hen reascaled ..
+0000deb0: 2020 2020 2020 2020 2320 206b 6565 7020          #  keep 
+0000dec0: 7468 6520 6164 6a75 7374 6d65 6e74 7320  the adjustments 
+0000ded0: 7661 6c75 6573 2066 6f72 206f 7468 6572  values for other
+0000dee0: 7320 7075 7270 6f73 6573 2e0d 0a20 2020  s purposes...   
+0000def0: 2020 2020 2073 656c 662e 5f5f 7365 7461       self.__seta
+0000df00: 7474 725f 5f28 2765 5f65 6173 7427 2c20  ttr__('e_east', 
+0000df10: 7365 6c66 2e65 6173 7429 0d0a 2020 2020  self.east)..    
+0000df20: 2020 2020 7365 6c66 2e5f 5f73 6574 6174      self.__setat
+0000df30: 7472 5f5f 2827 6e5f 6e6f 7274 6827 2c20  tr__('n_north', 
+0000df40: 7365 6c66 2e6e 6f72 7468 290d 0a20 2020  self.north)..   
+0000df50: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+0000df60: 6620 7265 2e6d 6174 6368 2872 275e 636c  f re.match(r'^cl
+0000df70: 6173 2b27 2c20 7374 7261 6967 6874 5f74  as+', straight_t
+0000df80: 7970 6529 2069 7320 6e6f 7420 4e6f 6e65  ype) is not None
+0000df90: 203a 0d0a 2020 2020 2020 2020 2020 2020   :..            
+0000dfa0: 2320 726a 5f66 6163 746f 7220 3d20 2873  # rj_factor = (s
+0000dfb0: 656c 662e 6561 7374 205b 2d31 5d20 2d73  elf.east [-1] -s
+0000dfc0: 656c 662e 6561 7374 5b30 5d29 202f 2873  elf.east[0]) /(s
+0000dfd0: 656c 662e 6561 7374 2e73 697a 6520 2d31  elf.east.size -1
+0000dfe0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+0000dff0: 2320 725f 6561 7374 203d 6e70 2e6f 6e65  # r_east =np.one
+0000e000: 735f 6c69 6b65 2873 656c 662e 6561 7374  s_like(self.east
+0000e010: 292a 206e 702e 6172 616e 6765 2873 656c  )* np.arange(sel
+0000e020: 662e 6561 7374 2e73 697a 6529 0d0a 2020  f.east.size)..  
+0000e030: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+0000e040: 6173 7420 3d20 6e70 2e61 7070 6c79 5f61  ast = np.apply_a
+0000e050: 6c6f 6e67 5f61 7869 7328 6c61 6d62 6461  long_axis(lambda
+0000e060: 2072 723a 2072 7220 2a20 280d 0a20 2020   rr: rr * (..   
+0000e070: 2020 2020 2020 2020 2020 2020 2028 7365               (se
+0000e080: 6c66 2e65 6173 7420 5b2d 315d 202d 7365  lf.east [-1] -se
+0000e090: 6c66 2e65 6173 745b 305d 2920 2f28 0d0a  lf.east[0]) /(..
+0000e0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e0b0: 2020 2020 7365 6c66 2e65 6173 742e 7369      self.east.si
+0000e0c0: 7a65 202d 3129 2920 2b20 7365 6c66 2e65  ze -1)) + self.e
+0000e0d0: 6173 745b 305d 2c20 0d0a 2020 2020 2020  ast[0], ..      
+0000e0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e0f0: 302c 206e 702e 6f6e 6573 5f6c 696b 6528  0, np.ones_like(
+0000e100: 7365 6c66 2e65 6173 7429 2a20 6e70 2e61  self.east)* np.a
+0000e110: 7261 6e67 6528 7365 6c66 2e65 6173 742e  range(self.east.
+0000e120: 7369 7a65 2929 0d0a 2020 2020 2020 2020  size))..        
+0000e130: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000e140: 2020 7365 6c66 2e6e 6f72 7468 203d 206e    self.north = n
+0000e150: 702e 6170 706c 795f 616c 6f6e 675f 6178  p.apply_along_ax
+0000e160: 6973 286c 616d 6264 6120 7272 3a20 7272  is(lambda rr: rr
+0000e170: 202a 2028 0d0a 2020 2020 2020 2020 2020   * (..          
+0000e180: 2020 2020 2020 2873 656c 662e 6e6f 7274        (self.nort
+0000e190: 6820 5b2d 315d 202d 7365 6c66 2e6e 6f72  h [-1] -self.nor
+0000e1a0: 7468 5b30 5d29 202f 280d 0a20 2020 2020  th[0]) /(..     
+0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000e1c0: 656c 662e 6e6f 7274 682e 7369 7a65 202d  elf.north.size -
+0000e1d0: 3120 2929 202b 2073 656c 662e 6e6f 7274  1 )) + self.nort
+0000e1e0: 685b 305d 2c0d 0a20 2020 2020 2020 2020  h[0],..         
+0000e1f0: 2020 2020 2020 2020 2020 2020 2030 2c20               0, 
+0000e200: 6e70 2e6f 6e65 735f 6c69 6b65 2873 656c  np.ones_like(sel
+0000e210: 662e 6e6f 7274 6829 2a20 6e70 2e61 7261  f.north)* np.ara
+0000e220: 6e67 6528 7365 6c66 2e6e 6f72 7468 2e73  nge(self.north.s
+0000e230: 697a 6529 290d 0a20 2020 2020 2020 2020  ize))..         
+0000e240: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+0000e250: 7265 2e6d 6174 6368 2872 275e 6571 2b27  re.match(r'^eq+'
+0000e260: 2c20 7374 7261 6967 6874 5f74 7970 6529  , straight_type)
+0000e270: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
+0000e280: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000e290: 662e 6561 7374 203d 6e70 2e6c 696e 7370  f.east =np.linsp
+0000e2a0: 6163 6528 7365 6c66 2e65 6173 745b 305d  ace(self.east[0]
+0000e2b0: 2c20 7365 6c66 2e65 6173 745b 2d31 5d2c  , self.east[-1],
+0000e2c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e2e0: 2020 2020 2073 656c 662e 6561 7374 2e73       self.east.s
+0000e2f0: 697a 6520 290d 0a20 2020 2020 2020 2020  ize )..         
+0000e300: 2020 2073 656c 662e 6e6f 7274 6820 3d6e     self.north =n
+0000e310: 702e 6c69 6e73 7061 6365 2873 656c 662e  p.linspace(self.
+0000e320: 6e6f 7274 685b 305d 2c20 7365 6c66 2e65  north[0], self.e
+0000e330: 6173 745b 2d31 5d2c 0d0a 2020 2020 2020  ast[-1],..      
+0000e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e350: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000e360: 6c66 2e6e 6f72 7468 2e73 697a 6520 290d  lf.north.size ).
+0000e370: 0a20 2020 2020 2020 2065 6c69 6620 2872  .        elif (r
+0000e380: 652e 6d61 7463 6828 7227 5e6e 6174 2b27  e.match(r'^nat+'
+0000e390: 2c20 7374 7261 6967 6874 5f74 7970 6529  , straight_type)
+0000e3a0: 2069 7320 6e6f 7420 4e6f 6e65 2920 6f72   is not None) or
+0000e3b0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+0000e3c0: 2020 2020 7265 2e6d 6174 6368 2872 275e      re.match(r'^
+0000e3d0: 6469 732b 272c 2073 7472 6169 6768 745f  dis+', straight_
+0000e3e0: 7479 7065 2920 6973 206e 6f74 204e 6f6e  type) is not Non
+0000e3f0: 6529 203a 0d0a 2020 2020 2020 2020 2020  e) :..          
+0000e400: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0000e410: 2361 206b 696e 6420 6f66 2073 7472 6169  #a kind of strai
+0000e420: 6768 7468 656e 2077 6974 6820 6571 7569  ghthen with equi
+0000e430: 7364 6973 7461 6e74 2076 616c 7565 2062  sdistant value b
+0000e440: 6574 7765 656e 200d 0a20 2020 2020 2020  etween ..       
+0000e450: 2020 2020 2023 7374 6174 696f 6e20 6275       #station bu
+0000e460: 7420 6e6f 7420 7374 7261 6967 6874 202c  t not straight ,
+0000e470: 6b69 6e67 206f 7220 6e61 7475 7261 6c20  king or natural 
+0000e480: 6173 7065 6374 206f 6e20 7468 6520 7369  aspect on the si
+0000e490: 7465 202e 200d 0a20 2020 2020 2020 2020  te . ..         
+0000e4a0: 2020 2072 665f 5820 3d20 6e70 2e61 7272     rf_X = np.arr
+0000e4b0: 6179 285b 7661 6c75 6520 2d20 7365 6c66  ay([value - self
+0000e4c0: 2e65 6173 745b 6969 2b31 5d0d 0a20 2020  .east[ii+1]..   
+0000e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e4e0: 2020 2020 2020 2020 2020 666f 7220 6969            for ii
+0000e4f0: 202c 2076 616c 7565 2069 6e20 656e 756d   , value in enum
+0000e500: 6572 6174 6528 7365 6c66 2e65 6173 7429  erate(self.east)
+0000e510: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000e520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e530: 2069 6620 6969 203c 3d20 7365 6c66 2e65   if ii <= self.e
+0000e540: 6173 742e 7369 7a65 202d 2032 205d 292e  ast.size - 2 ]).
+0000e550: 6d65 616e 2829 0d0a 0d0a 2020 2020 2020  mean()....      
+0000e560: 2020 2020 2020 7266 5f59 203d 206e 702e        rf_Y = np.
+0000e570: 6172 7261 7928 5b76 616c 7565 202d 2073  array([value - s
+0000e580: 656c 662e 6e6f 7274 685b 6969 2b31 5d20  elf.north[ii+1] 
+0000e590: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e5a0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000e5b0: 6f72 2069 6920 2c20 7661 6c75 6520 696e  or ii , value in
+0000e5c0: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
+0000e5d0: 6e6f 7274 6829 200d 0a20 2020 2020 2020  north) ..       
+0000e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5f0: 2020 2020 2020 2069 6620 6969 203c 3d20         if ii <= 
+0000e600: 7365 6c66 2e6e 6f72 7468 2e73 697a 6520  self.north.size 
+0000e610: 2d20 3220 5d29 2e6d 6561 6e28 290d 0a20  - 2 ]).mean().. 
+0000e620: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000e630: 2020 2020 2020 2020 2074 656d 705f 6565           temp_ee
+0000e640: 203d 206e 702e 7a65 726f 735f 6c69 6b65   = np.zeros_like
+0000e650: 2873 656c 662e 6561 7374 2920 0d0a 2020  (self.east) ..  
+0000e660: 2020 2020 2020 2020 2020 7465 6d70 5f6e            temp_n
+0000e670: 6e20 3d20 6e70 2e7a 6572 6f73 5f6c 696b  n = np.zeros_lik
+0000e680: 6528 7365 6c66 2e6e 6f72 7468 2920 0d0a  e(self.north) ..
+0000e690: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
+0000e6a0: 5f65 6520 5b30 5d2c 2074 656d 705f 6e6e  _ee [0], temp_nn
+0000e6b0: 5b30 5d20 3d20 7365 6c66 2e65 6173 745b  [0] = self.east[
+0000e6c0: 305d 202c 2073 656c 662e 6e6f 7274 685b  0] , self.north[
+0000e6d0: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+0000e6e0: 666f 7220 206a 6a20 2c20 7661 6c75 6520  for  jj , value 
+0000e6f0: 696e 2065 6e75 6d65 7261 7465 2874 656d  in enumerate(tem
+0000e700: 705f 6565 293a 200d 0a20 2020 2020 2020  p_ee): ..       
+0000e710: 2020 2020 2020 2020 2069 6620 206a 6a20           if  jj 
+0000e720: 3e20 3020 3a20 7465 6d70 5f65 6520 5b6a  > 0 : temp_ee [j
+0000e730: 6a5d 3d73 656c 662e 6561 7374 5b6a 6a2d  j]=self.east[jj-
+0000e740: 315d 2d20 7266 5f58 0d0a 2020 2020 2020  1]- rf_X..      
+0000e750: 2020 2020 2020 666f 7220 206a 6a20 2c20        for  jj , 
+0000e760: 7661 6c75 6520 696e 2065 6e75 6d65 7261  value in enumera
+0000e770: 7465 2874 656d 705f 6e6e 293a 200d 0a20  te(temp_nn): .. 
+0000e780: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000e790: 6620 206a 6a20 3e20 3020 3a20 7465 6d70  f  jj > 0 : temp
+0000e7a0: 5f6e 6e20 5b6a 6a5d 3d73 656c 662e 6e6f  _nn [jj]=self.no
+0000e7b0: 7274 685b 6a6a 2d31 5d2d 2072 665f 590d  rth[jj-1]- rf_Y.
+0000e7c0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0000e7d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000e7e0: 6561 7374 202c 2073 656c 662e 6e6f 7274  east , self.nort
+0000e7f0: 6820 3d20 7465 6d70 5f65 6520 2c20 7465  h = temp_ee , te
+0000e800: 6d70 5f6e 6e20 0d0a 2020 2020 2020 2020  mp_nn ..        
+0000e810: 0d0a 2020 2020 2020 2020 6966 206f 7574  ..        if out
+0000e820: 7075 7420 6973 2054 7275 6520 3a20 2320  put is True : # 
+0000e830: 6578 706f 7274 2074 6865 2066 696c 6520  export the file 
+0000e840: 7769 7468 6f75 7420 7363 616c 696e 6720  without scaling 
+0000e850: 2c20 7365 7420 582c 2059 2074 6f20 302e  , set X, Y to 0.
+0000e860: 200d 0a20 2020 2020 2020 2023 2061 6e64   ..        # and
+0000e870: 206b 6565 7020 7468 6520 6e65 7720 6561   keep the new ea
+0000e880: 7374 696e 6720 616e 6420 4e6f 7274 6869  sting and Northi
+0000e890: 6e67 2063 6f6f 7264 696e 6174 6573 200d  ng coordinates .
+0000e8a0: 0a20 2020 2020 2020 2020 2020 205f 2c73  .            _,s
+0000e8b0: 656c 662e 6561 7374 2c20 7365 6c66 2e6e  elf.east, self.n
+0000e8c0: 6f72 7468 2c2a 5f3d 2073 656c 662e 7265  orth,*_= self.re
+0000e8d0: 616a 7573 745f 636f 6f72 6469 6e61 7465  ajust_coordinate
+0000e8e0: 735f 7661 6c75 6573 280d 0a20 2020 2020  s_values(..     
+0000e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e910: 2020 2065 6173 7469 6e67 3d20 7365 6c66     easting= self
+0000e920: 2e65 6173 742c 0d0a 2020 2020 2020 2020  .east,..        
+0000e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e950: 6e6f 7274 6869 6e67 203d 7365 6c66 2e6e  northing =self.n
+0000e960: 6f72 7468 202c 0d0a 2020 2020 2020 2020  orth ,..        
+0000e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e990: 783d 302e 2c20 793d 302e 2c20 7374 6174  x=0., y=0., stat
+0000e9a0: 696f 6e5f 706b 3d73 746e 5f70 6b2c 200d  ion_pk=stn_pk, .
+0000e9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e9d0: 2020 2020 2020 2020 2072 6577 7269 7465           rewrite
+0000e9e0: 3d52 4557 2c20 656c 6576 6174 696f 6e3d  =REW, elevation=
+0000e9f0: 2065 6c65 762c 200d 0a20 2020 2020 2020   elev, ..       
+0000ea00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea20: 2073 6176 6570 6174 6820 3d73 656c 662e   savepath =self.
+0000ea30: 7361 7665 7061 7468 290d 0a20 2020 2020  savepath)..     
+0000ea40: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000ea50: 2020 2020 2073 656c 662e 5f6c 6f67 6769       self._loggi
+0000ea60: 6e67 2e69 6e66 6f20 280d 0a20 2020 2020  ng.info (..     
+0000ea70: 2020 2020 2020 2020 2020 2022 4c6f 6361             "Loca
+0000ea80: 7469 6f6e 7320 636f 6f72 6469 6e61 7465  tions coordinate
+0000ea90: 7320 6172 6520 7265 616a 7573 7465 6420  s are reajusted 
+0000eaa0: 616e 6420 220d 0a20 2020 2020 2020 2020  and "..         
+0000eab0: 2020 2020 2020 2022 2073 7472 6169 6768         " straigh
+0000eac0: 7465 6e65 6420 6f75 7420 7072 6f66 696c  tened out profil
+0000ead0: 6520 616e 6420 7765 276c 6c20 746f 7020  e and we'll top 
+0000eae0: 656c 6576 6174 696f 6e2e 2229 0d0a 2020  elevation.")..  
+0000eaf0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000eb00: 2020 2020 2020 2020 7072 696e 7428 222d          print("-
+0000eb10: 2d2d 3e20 4c6f 6361 7469 6f6e 7320 636f  --> Locations co
+0000eb20: 6f72 6469 6e61 7465 7320 6172 6522 0d0a  ordinates are"..
+0000eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb40: 2020 2220 7265 616a 7573 7465 6420 616e    " reajusted an
+0000eb50: 6420 7374 7261 6967 6874 656e 6564 206f  d straightened o
+0000eb60: 7574 220d 0a20 2020 2020 2020 2020 2020  ut"..           
+0000eb70: 2020 2020 2020 2022 2070 726f 6669 6c65         " profile
+0000eb80: 2e20 456c 6576 6174 696f 6e20 6973 2061  . Elevation is a
+0000eb90: 6464 6564 2e22 290d 0a20 2020 2020 2020  dded.")..       
+0000eba0: 200d 0a20 2020 2064 6566 2072 6577 7269   ..    def rewri
+0000ebb0: 7465 5f73 7461 7469 6f6e 5f70 726f 6669  te_station_profi
+0000ebc0: 6c65 2028 7365 6c66 2c20 6561 7374 696e  le (self, eastin
+0000ebd0: 6720 3d4e 6f6e 6520 2c20 0d0a 2020 2020  g =None , ..    
+0000ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ebf0: 2020 2020 2020 2020 2020 2020 206e 6f72               nor
+0000ec00: 7468 696e 673d 4e6f 6e65 202c 0d0a 2020  thing=None ,..  
+0000ec10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000ec30: 6c65 7661 7469 6f6e 203d 4e6f 6e65 202c  levation =None ,
+0000ec40: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec60: 2020 2020 6172 6561 5f6e 616d 6520 3d4e      area_name =N
+0000ec70: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+0000ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec90: 2020 2020 2020 2075 7365 726e 616d 6520         username 
+0000eca0: 3d4e 6f6e 652c 200d 0a20 2020 2020 2020  =None, ..       
+0000ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ecc0: 2020 2020 2020 2020 2020 6164 645f 617a            add_az
+0000ecd0: 696d 7574 6820 3d46 616c 7365 2c0d 0a20  imuth =False,.. 
+0000ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed00: 2a2a 6b77 6172 6773 293a 200d 0a20 2020  **kwargs): ..   
+0000ed10: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0000ed20: 2020 4d74 686f 6420 746f 2072 6577 7269    Mthod to rewri
+0000ed30: 7465 2073 7461 7469 6f6e 5f70 726f 6669  te station_profi
+0000ed40: 6c65 206f 7220 6f75 7470 7574 206e 6577  le or output new
+0000ed50: 2070 726f 6669 6c65 200d 0a20 2020 2020   profile ..     
+0000ed60: 2020 2062 7920 7374 7261 6967 6874 656e     by straighten
+0000ed70: 696e 6720 7072 6f66 696c 6520 7468 726f  ing profile thro
+0000ed80: 7567 6874 2072 6561 6a75 7374 696e 6720  ught reajusting 
+0000ed90: 6c6f 6361 7469 6f6e 200d 0a20 2020 2020  location ..     
+0000eda0: 2020 2063 6f6f 7264 696e 6174 6573 2076     coordinates v
+0000edb0: 616c 7565 732e 5573 6572 2063 616e 2075  alues.User can u
+0000edc0: 7365 2074 6869 7320 6d65 7468 6f64 2074  se this method t
+0000edd0: 6f20 6372 6561 7465 207a 6f6e 6765 0d0a  o create zonge..
+0000ede0: 2020 2020 2020 2020 202a 7374 6e2a 2066           *stn* f
+0000edf0: 696c 6520 6966 2063 6f6f 7264 696e 6174  ile if coordinat
+0000ee00: 6573 2061 7265 206b 6e6f 776e 2e0d 0a20  es are known... 
+0000ee10: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000ee20: 2020 3a70 6172 616d 2065 6173 7469 6e67    :param easting
+0000ee30: 3a20 2065 6173 7469 6e67 2063 6f6f 7264  :  easting coord
+0000ee40: 696e 6174 6573 2028 6d29 0d0a 2020 2020  inates (m)..    
+0000ee50: 2020 2020 3a74 7970 6520 6561 7374 696e      :type eastin
+0000ee60: 673a 2061 7272 6179 5f6c 696b 6520 0d0a  g: array_like ..
+0000ee70: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000ee80: 2020 3a70 6172 616d 206e 6f72 7468 696e    :param northin
+0000ee90: 673a 206e 6f72 7468 696e 6720 636f 6f72  g: northing coor
+0000eea0: 6469 6e61 7465 7320 286d 2920 0d0a 2020  dinates (m) ..  
+0000eeb0: 2020 2020 2020 3a74 7970 6520 6e6f 7274        :type nort
+0000eec0: 6869 6e67 3a20 6172 7261 795f 6c69 6b65  hing: array_like
+0000eed0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000eee0: 2020 2020 203a 7061 7261 6d20 656c 6576       :param elev
+0000eef0: 6174 696f 6e3a 2065 6c65 7661 7469 6f6e  ation: elevation
+0000ef00: 2076 616c 7565 7320 286d 290d 0a20 2020   values (m)..   
+0000ef10: 2020 2020 203a 7479 7065 2065 6c65 7661       :type eleva
+0000ef20: 7469 6f6e 3a20 6172 7261 795f 6c69 6b65  tion: array_like
+0000ef30: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000ef40: 2020 2020 203a 7061 7261 6d20 7573 6572       :param user
+0000ef50: 6e61 6d65 3a20 6e61 6d65 2020 6f66 2075  name: name  of u
+0000ef60: 7365 7220 0d0a 2020 2020 2020 2020 3a74  ser ..        :t
+0000ef70: 7970 6520 7573 6572 6e61 6d65 3a20 7374  ype username: st
+0000ef80: 7220 0d0a 2020 2020 2020 2020 0d0a 2020  r ..        ..  
+0000ef90: 2020 2020 2020 3a70 6172 616d 2061 6464        :param add
+0000efa0: 5f61 7a69 6d75 7468 3a20 636f 6d70 7574  _azimuth: comput
+0000efb0: 6520 617a 696d 7574 6820 200d 0a20 2020  e azimuth  ..   
+0000efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efd0: 2020 2020 2020 2020 2070 6f73 6974 6976           positiv
+0000efe0: 6520 646f 776e 2863 6c6f 636b 7769 7365  e down(clockwise
+0000eff0: 290d 0a20 2020 2020 2020 203a 7479 7065  )..        :type
+0000f000: 2061 6464 5f61 7a69 6d75 7468 3a20 626f   add_azimuth: bo
+0000f010: 6f6c 2020 200d 0a20 2020 2020 2020 2022  ol   ..        "
+0000f020: 2222 0d0a 2020 2020 2020 2020 0d0a 2020  ""..        ..  
+0000f030: 2020 0d0a 2020 2020 2020 2020 7574 6d5f    ..        utm_
+0000f040: 7a6f 6e65 203d 206b 7761 7267 732e 706f  zone = kwargs.po
+0000f050: 7028 2755 544d 5f5a 6f6e 6527 2c20 4e6f  p('UTM_Zone', No
+0000f060: 6e65 290d 0a20 2020 2020 2020 2064 6970  ne)..        dip
+0000f070: 6f6c 655f 6c65 6e67 7468 203d 6b77 6172  ole_length =kwar
+0000f080: 6773 2e70 6f70 2827 6469 706f 6c65 5f6c  gs.pop('dipole_l
+0000f090: 656e 6774 6827 2c20 4e6f 6e65 290d 0a20  ength', None).. 
+0000f0a0: 2020 2020 2020 206f 7574 7075 745f 6e61         output_na
+0000f0b0: 6d65 203d 6b77 6172 6773 2e70 6f70 2827  me =kwargs.pop('
+0000f0c0: 6f75 7470 7574 5f6e 616d 6527 2c20 4e6f  output_name', No
+0000f0d0: 6e65 290d 0a20 2020 2020 2020 2073 6176  ne)..        sav
+0000f0e0: 6570 6174 6820 3d6b 7761 7267 732e 706f  epath =kwargs.po
+0000f0f0: 7028 2773 6176 6570 6174 6827 2c20 4e6f  p('savepath', No
+0000f100: 6e65 290d 0a20 2020 2020 2020 200d 0a20  ne)..        .. 
+0000f110: 2020 2020 2020 2069 6620 7361 7665 7061         if savepa
+0000f120: 7468 2069 7320 6e6f 7420 4e6f 6e65 3a20  th is not None: 
+0000f130: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0000f140: 6c66 2e73 6176 6570 6174 6820 3d20 7361  lf.savepath = sa
+0000f150: 7665 7061 7468 200d 0a20 2020 2020 2020  vepath ..       
+0000f160: 2069 6620 6f75 7470 7574 5f6e 616d 6520   if output_name 
+0000f170: 6973 204e 6f6e 6520 3a0d 0a20 2020 2020  is None :..     
+0000f180: 2020 2020 2020 206f 7574 7075 745f 6e61         output_na
+0000f190: 6d65 3d27 6e65 775f 7072 6f66 696c 6527  me='new_profile'
+0000f1a0: 0d0a 2020 2020 2020 2020 6966 2075 746d  ..        if utm
+0000f1b0: 5f7a 6f6e 6520 6973 206e 6f74 204e 6f6e  _zone is not Non
+0000f1c0: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+0000f1d0: 2020 7365 6c66 2e75 746d 5f7a 6f6e 6520    self.utm_zone 
+0000f1e0: 3d20 7574 6d5f 7a6f 6e65 0d0a 2020 2020  = utm_zone..    
+0000f1f0: 2020 2020 6966 2061 7265 615f 6e61 6d65      if area_name
+0000f200: 2069 7320 4e6f 6e65 203a 0d0a 2020 2020   is None :..    
+0000f210: 2020 2020 2020 2020 6172 6561 5f6e 616d          area_nam
+0000f220: 6520 3d27 2720 0d0a 2020 2020 2020 2020  e ='' ..        
+0000f230: 6966 2075 7365 726e 616d 6520 6973 204e  if username is N
+0000f240: 6f6e 6520 3a0d 0a20 2020 2020 2020 2020  one :..         
+0000f250: 2020 2075 7365 726e 616d 6520 3d27 270d     username =''.
+0000f260: 0a20 2020 2020 2020 2069 6620 6561 7374  .        if east
+0000f270: 696e 6720 6973 206e 6f74 204e 6f6e 6520  ing is not None 
+0000f280: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+0000f290: 656c 662e 6561 7374 203d 6e70 2e61 7272  elf.east =np.arr
+0000f2a0: 6179 2865 6173 7469 6e67 2029 0d0a 2020  ay(easting )..  
+0000f2b0: 2020 2020 2020 6966 206e 6f72 7468 696e        if northin
+0000f2c0: 6720 6973 206e 6f74 204e 6f6e 6520 3a0d  g is not None :.
+0000f2d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000f2e0: 662e 6e6f 7274 6820 3d20 6e70 2e61 7272  f.north = np.arr
+0000f2f0: 6179 286e 6f72 7468 696e 6729 200d 0a20  ay(northing) .. 
+0000f300: 2020 2020 2020 2069 6620 656c 6576 6174         if elevat
+0000f310: 696f 6e20 6973 206e 6f74 204e 6f6e 6520  ion is not None 
+0000f320: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+0000f330: 656c 662e 656c 6576 203d 206e 702e 6172  elf.elev = np.ar
+0000f340: 7261 7928 656c 6576 6174 696f 6e29 0d0a  ray(elevation)..
+0000f350: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000f360: 6561 7374 2069 7320 4e6f 6e65 206f 7220  east is None or 
+0000f370: 7365 6c66 2e6e 6f72 7468 2069 7320 4e6f  self.north is No
+0000f380: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
+0000f390: 2020 2073 656c 662e 5f6c 6f67 6769 6e67     self._logging
+0000f3a0: 2e77 6172 6e69 6e67 280d 0a20 2020 2020  .warning(..     
+0000f3b0: 2020 2020 2020 2020 2020 2022 4974 2073             "It s
+0000f3c0: 6565 6d73 2079 6f75 2064 6964 206e 6f74  eems you did not
+0000f3d0: 2070 726f 7669 6465 2061 6e79 2065 6173   provide any eas
+0000f3e0: 7469 6e67 220d 0a20 2020 2020 2020 2020  ting"..         
+0000f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f400: 2020 2022 2076 616c 7565 7320 6e6f 7220     " values nor 
+0000f410: 6e6f 7274 6869 6e67 2076 616c 7565 2e22  northing value."
+0000f420: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
+0000f430: 6169 7365 2050 726f 6669 6c65 4572 726f  aise ProfileErro
+0000f440: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+0000f450: 2020 2020 2259 6f75 206d 6179 2070 726f      "You may pro
+0000f460: 7669 6465 2065 6173 7469 6e67 2061 6e64  vide easting and
+0000f470: 206e 6f72 7468 696e 6720 7661 6c75 6573   northing values
+0000f480: 2062 6566 6f72 6522 0d0a 2020 2020 2020   before"..      
+0000f490: 2020 2020 2020 2020 2020 2220 7772 6974            " writ
+0000f4a0: 7469 6e67 2061 206e 6577 2073 7461 7469  ting a new stati
+0000f4b0: 6f6e 2070 726f 6669 6c65 203c 2a2e 7374  on profile <*.st
+0000f4c0: 6e3e 2022 290d 0a20 2020 2020 2020 2020  n> ")..         
+0000f4d0: 2020 200d 0a20 2020 2020 2020 2077 7269     ..        wri
+0000f4e0: 7465 5f70 726f 6669 6c65 5f6c 696e 6573  te_profile_lines
+0000f4f0: 203d 5b5d 0d0a 2020 2020 2020 2020 7772   =[]..        wr
+0000f500: 6974 655f 7072 6f66 696c 655f 6c69 6e65  ite_profile_line
+0000f510: 732e 6170 7065 6e64 2827 272e 6a6f 696e  s.append(''.join
+0000f520: 285b 277b 303a 3c31 377d 272e 666f 726d  (['{0:<17}'.form
+0000f530: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
+0000f540: 2027 3e4c 4f43 4154 494f 4e27 292c 273a   '>LOCATION'),':
+0000f550: 272c 2220 7b30 3a3c 3535 7d22 2e66 6f72  '," {0:<55}".for
+0000f560: 6d61 7428 6172 6561 5f6e 616d 6529 205d  mat(area_name) ]
+0000f570: 292b 275c 6e27 290d 0a20 2020 2020 2020  )+'\n')..       
+0000f580: 2077 7269 7465 5f70 726f 6669 6c65 5f6c   write_profile_l
+0000f590: 696e 6573 2e61 7070 656e 6428 2727 2e6a  ines.append(''.j
+0000f5a0: 6f69 6e28 5b27 7b30 3a3c 3137 7d27 2e66  oin(['{0:<17}'.f
+0000f5b0: 6f72 6d61 7428 0d0a 2020 2020 2020 2020  ormat(..        
+0000f5c0: 2020 2020 273e 5553 4552 4e41 4d45 2729      '>USERNAME')
+0000f5d0: 2c27 3a27 2c22 207b 303a 3c35 357d 222e  ,':'," {0:<55}".
+0000f5e0: 666f 726d 6174 2875 7365 726e 616d 6529  format(username)
+0000f5f0: 205d 292b 275c 6e27 290d 0a20 2020 2020   ])+'\n')..     
+0000f600: 2020 2077 7269 7465 5f70 726f 6669 6c65     write_profile
+0000f610: 5f6c 696e 6573 2e61 7070 656e 6428 0d0a  _lines.append(..
+0000f620: 2020 2020 2020 2020 2020 2020 2727 2e6a              ''.j
+0000f630: 6f69 6e28 5b27 7b30 3a3c 3137 7d27 2e66  oin(['{0:<17}'.f
+0000f640: 6f72 6d61 7428 273e 4441 5445 2729 2c27  ormat('>DATE'),'
+0000f650: 3a27 2c22 207b 303a 3c37 307d 222e 5c0d  :'," {0:<70}".\.
+0000f660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f670: 2066 6f72 6d61 7428 7469 6d65 2e73 7472   format(time.str
+0000f680: 6674 696d 6528 2725 592d 256d 2d25 6420  ftime('%Y-%m-%d 
+0000f690: 2548 3a25 4d3a 2553 272c 200d 0a20 2020  %H:%M:%S', ..   
+0000f6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f6c0: 2020 7469 6d65 2e67 6d74 696d 6528 2929    time.gmtime())
+0000f6d0: 2920 5d29 2b27 5c6e 2729 0d0a 2020 2020  ) ])+'\n')..    
+0000f6e0: 2020 2020 7772 6974 655f 7072 6f66 696c      write_profil
+0000f6f0: 655f 6c69 6e65 732e 6170 7065 6e64 2827  e_lines.append('
+0000f700: 272e 6a6f 696e 285b 277b 303a 3c31 377d  '.join(['{0:<17}
+0000f710: 272e 666f 726d 6174 280d 0a20 2020 2020  '.format(..     
+0000f720: 2020 2020 2020 2027 3e55 544d 5f5a 4f4e         '>UTM_ZON
+0000f730: 4527 292c 273a 272c 2220 7b30 3a3c 357d  E'),':'," {0:<5}
+0000f740: 2d7b 313a 3c37 7d22 2e66 6f72 6d61 7428  -{1:<7}".format(
+0000f750: 2757 4753 3834 272c 0d0a 2020 2020 2020  'WGS84',..      
+0000f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f780: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000f790: 656c 662e 7574 6d5f 7a6f 6e65 2920 5d29  elf.utm_zone) ])
+0000f7a0: 2b27 5c6e 2729 2020 2020 0d0a 2020 2020  +'\n')    ..    
+0000f7b0: 2020 2020 7772 6974 655f 7072 6f66 696c      write_profil
+0000f7c0: 655f 6c69 6e65 732e 6170 7065 6e64 2827  e_lines.append('
+0000f7d0: 272e 6a6f 696e 285b 277b 303a 3c31 377d  '.join(['{0:<17}
+0000f7e0: 272e 666f 726d 6174 280d 0a20 2020 2020  '.format(..     
+0000f7f0: 2020 2020 2020 2027 3e53 4f46 5457 4152         '>SOFTWAR
+0000f800: 4527 292c 273a 272c 2220 7b30 3a35 357d  E'),':'," {0:55}
+0000f810: 222e 666f 726d 6174 2827 7079 4353 414d  ".format('pyCSAM
+0000f820: 5427 2920 5d29 2b27 5c6e 2729 0d0a 2020  T') ])+'\n')..  
+0000f830: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000f840: 6966 2073 656c 662e 6c61 7420 6973 204e  if self.lat is N
+0000f850: 6f6e 6520 206f 7220 7365 6c66 2e6c 6f6e  one  or self.lon
+0000f860: 2069 7320 4e6f 6e65 203a 200d 0a20 2020   is None : ..   
+0000f870: 2020 2020 2020 2020 2073 656c 662e 4c6f           self.Lo
+0000f880: 6361 7469 6f6e 2e63 6f6e 7665 7274 5f6c  cation.convert_l
+0000f890: 6f63 6174 696f 6e5f 325f 6c61 746c 6f6e  ocation_2_latlon
+0000f8a0: 2875 746d 5f7a 6f6e 653d 7365 6c66 2e75  (utm_zone=self.u
+0000f8b0: 746d 5f7a 6f6e 6529 0d0a 2020 2020 2020  tm_zone)..      
+0000f8c0: 2020 0d0a 2020 2020 2020 2020 6966 2073    ..        if s
+0000f8d0: 656c 662e 6561 7374 2069 7320 4e6f 6e65  elf.east is None
+0000f8e0: 206f 7220 7365 6c66 2e6e 6f72 7468 2069   or self.north i
+0000f8f0: 7320 4e6f 6e65 203a 200d 0a20 2020 2020  s None : ..     
+0000f900: 2020 2020 2020 2073 656c 662e 4c6f 6361         self.Loca
+0000f910: 7469 6f6e 2e63 6f6e 7665 7274 5f6c 6f63  tion.convert_loc
+0000f920: 6174 696f 6e5f 325f 7574 6d28 6c61 7469  ation_2_utm(lati
+0000f930: 7475 6465 3d73 656c 662e 6c61 742c 0d0a  tude=self.lat,..
+0000f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f970: 206c 6f6e 6769 7475 6465 3d73 656c 662e   longitude=self.
+0000f980: 6c6f 6e29 0d0a 2020 2020 2020 2020 6966  lon)..        if
+0000f990: 2061 6464 5f61 7a69 6d75 7468 2069 7320   add_azimuth is 
+0000f9a0: 5472 7565 203a 0d0a 2020 2020 2020 2020  True :..        
+0000f9b0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000f9c0: 2020 6966 2073 656c 662e 617a 696d 7574    if self.azimut
+0000f9d0: 6820 6973 206e 6f74 204e 6f6e 6520 3a20  h is not None : 
+0000f9e0: 617a 696d 203d 2073 656c 662e 617a 696d  azim = self.azim
+0000f9f0: 7574 680d 0a20 2020 2020 2020 2020 2020  uth..           
+0000fa00: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
+0000fa10: 2020 2020 2020 2020 2073 656c 662e 5f6c           self._l
+0000fa20: 6f67 6769 6e67 2e69 6e66 6f28 2743 6f6d  ogging.info('Com
+0000fa30: 7075 7469 6e67 2061 7a69 6d75 7468 2076  puting azimuth v
+0000fa40: 616c 7565 2e27 290d 0a20 2020 2020 2020  alue.')..       
+0000fa50: 2020 2020 2020 2020 2061 7a69 6d20 3d20           azim = 
+0000fa60: 6675 6e63 2e63 6f6d 7075 7465 5f61 7a69  func.compute_azi
+0000fa70: 6d75 7468 2865 6173 7469 6e67 3d73 656c  muth(easting=sel
+0000fa80: 662e 6561 7374 2c0d 0a20 2020 2020 2020  f.east,..       
 0000fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fab0: 2020 2020 2020 2020 6c6f 6e67 6974 7564          longitud
-0000fac0: 653d 7365 6c66 2e6c 6f6e 290d 0a20 2020  e=self.lon)..   
-0000fad0: 2020 2020 2069 6620 6164 645f 617a 696d       if add_azim
-0000fae0: 7574 6820 6973 2054 7275 6520 3a0d 0a20  uth is True :.. 
-0000faf0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000fb00: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0000fb10: 2e61 7a69 6d75 7468 2069 7320 6e6f 7420  .azimuth is not 
-0000fb20: 4e6f 6e65 203a 2061 7a69 6d20 3d20 7365  None : azim = se
-0000fb30: 6c66 2e61 7a69 6d75 7468 0d0a 2020 2020  lf.azimuth..    
-0000fb40: 2020 2020 2020 2020 656c 7365 203a 0d0a          else :..
-0000fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb60: 7365 6c66 2e5f 6c6f 6767 696e 672e 696e  self._logging.in
-0000fb70: 666f 2827 436f 6d70 7574 696e 6720 617a  fo('Computing az
-0000fb80: 696d 7574 6820 7661 6c75 652e 2729 0d0a  imuth value.')..
-0000fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fba0: 617a 696d 203d 2066 756e 632e 636f 6d70  azim = func.comp
-0000fbb0: 7574 655f 617a 696d 7574 6828 6561 7374  ute_azimuth(east
-0000fbc0: 696e 673d 7365 6c66 2e65 6173 742c 0d0a  ing=self.east,..
-0000fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fab0: 2020 2020 206e 6f72 7468 696e 673d 7365       northing=se
+0000fac0: 6c66 2e6e 6f72 7468 290d 0a20 2020 2020  lf.north)..     
+0000fad0: 2020 2020 2020 2020 2020 2069 6620 617a             if az
+0000fae0: 696d 2e73 697a 6520 213d 2073 656c 662e  im.size != self.
+0000faf0: 6561 7374 2e73 697a 6520 6f72 2061 7a69  east.size or azi
+0000fb00: 6d2e 7369 7a65 2021 3d20 7365 6c66 2e6e  m.size != self.n
+0000fb10: 6f72 7468 2e73 697a 653a 0d0a 2020 2020  orth.size:..    
+0000fb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb30: 2320 7265 636f 6d70 7574 6520 617a 696d  # recompute azim
+0000fb40: 7574 6820 7573 696e 6720 6578 7472 6170  uth using extrap
+0000fb50: 6f6c 6174 696f 6e20 0d0a 2020 2020 2020  olation ..      
+0000fb60: 2020 2020 2020 2020 2020 2020 2020 617a                az
+0000fb70: 696d 203d 2066 756e 632e 636f 6d70 7574  im = func.comput
+0000fb80: 655f 617a 696d 7574 6828 6561 7374 696e  e_azimuth(eastin
+0000fb90: 673d 7365 6c66 2e65 6173 742c 0d0a 2020  g=self.east,..  
+0000fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fbc0: 2020 2020 2020 2020 2020 6e6f 7274 6869            northi
+0000fbd0: 6e67 3d73 656c 662e 6e6f 7274 682c 0d0a  ng=self.north,..
 0000fbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbf0: 2020 2020 2020 2020 2020 2020 6e6f 7274              nort
-0000fc00: 6869 6e67 3d73 656c 662e 6e6f 7274 6829  hing=self.north)
-0000fc10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000fc20: 2020 6966 2061 7a69 6d2e 7369 7a65 2021    if azim.size !
-0000fc30: 3d20 7365 6c66 2e65 6173 742e 7369 7a65  = self.east.size
-0000fc40: 206f 7220 617a 696d 2e73 697a 6520 213d   or azim.size !=
-0000fc50: 2073 656c 662e 6e6f 7274 682e 7369 7a65   self.north.size
-0000fc60: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000fc70: 2020 2020 2020 2023 2072 6563 6f6d 7075         # recompu
-0000fc80: 7465 2061 7a69 6d75 7468 2075 7369 6e67  te azimuth using
-0000fc90: 2065 7874 7261 706f 6c61 7469 6f6e 200d   extrapolation .
-0000fca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fcb0: 2020 2020 2061 7a69 6d20 3d20 6675 6e63       azim = func
-0000fcc0: 2e63 6f6d 7075 7465 5f61 7a69 6d75 7468  .compute_azimuth
-0000fcd0: 2865 6173 7469 6e67 3d73 656c 662e 6561  (easting=self.ea
-0000fce0: 7374 2c0d 0a20 2020 2020 2020 2020 2020  st,..           
-0000fcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd10: 206e 6f72 7468 696e 673d 7365 6c66 2e6e   northing=self.n
-0000fd20: 6f72 7468 2c0d 0a20 2020 2020 2020 2020  orth,..         
-0000fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd50: 2020 2065 7874 7261 706f 6c61 7465 3d54     extrapolate=T
-0000fd60: 7275 6529 0d0a 2020 2020 2020 2020 2020  rue)..          
-0000fd70: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000fd80: 2020 2020 6966 2064 6970 6f6c 655f 6c65      if dipole_le
-0000fd90: 6e67 7468 2069 7320 4e6f 6e65 203a 0d0a  ngth is None :..
-0000fda0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000fdb0: 2e5f 6c6f 6767 696e 672e 696e 666f 2827  ._logging.info('
-0000fdc0: 4175 746f 6d61 7469 6320 6469 706f 6c65  Automatic dipole
-0000fdd0: 206c 656e 6774 6820 6361 6c63 756c 6174   length calculat
-0000fde0: 696f 6e20 616e 6420 270d 0a20 2020 2020  ion and '..     
-0000fdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fe00: 2020 2020 2020 2020 2020 2773 7461 7469            'stati
-0000fe10: 6f6e 7320 706f 7369 7469 6f6e 2076 616c  ons position val
-0000fe20: 7565 7320 6172 6520 7365 7420 7769 7468  ues are set with
-0000fe30: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
-0000fe40: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
-0000fe50: 656c 662e 6469 706f 6c65 5f6c 656e 6774  elf.dipole_lengt
-0000fe60: 682c 2073 656c 662e 7374 6e5f 706f 7369  h, self.stn_posi
-0000fe70: 7469 6f6e 203d 205c 0d0a 2020 2020 2020  tion = \..      
-0000fe80: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0000fe90: 6f6d 7075 7465 5f64 6970 6f6c 656c 656e  ompute_dipolelen
-0000fea0: 6774 685f 6672 6f6d 5f63 6f6f 7264 7328  gth_from_coords(
-0000feb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000fec0: 2020 6561 7374 696e 6720 3d73 656c 662e    easting =self.
-0000fed0: 6561 7374 2c20 6e6f 7274 6869 6e67 203d  east, northing =
-0000fee0: 2073 656c 662e 6e6f 7274 6829 0d0a 2020   self.north)..  
-0000fef0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-0000ff00: 6773 2e77 6172 6e28 0d0a 2020 2020 2020  gs.warn(..      
-0000ff10: 2020 2020 2020 2020 2020 2244 6970 6f6c            "Dipol
-0000ff20: 6520 6c65 6e67 7468 2069 7320 636f 6d70  e length is comp
-0000ff30: 7574 696e 6720 6175 746f 6d61 7469 6361  uting automatica
-0000ff40: 6c6c 7920 616e 6420 7365 7422 0d0a 2020  lly and set"..  
-0000ff50: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-0000ff60: 7374 6174 696f 6e20 706f 7369 7469 6f6e  station position
-0000ff70: 2077 6974 6820 6279 2064 6566 6175 6c74   with by default
-0000ff80: 2e20 4469 706f 6c65 206c 656e 6774 6820  . Dipole length 
-0000ff90: 6973 203d 7b30 7d20 6d22 0d0a 2020 2020  is ={0} m"..    
-0000ffa0: 2020 2020 2020 2020 2020 2020 2261 6e64              "and
-0000ffb0: 206c 656e 6774 6820 616c 6f6e 6720 7468   length along th
-0000ffc0: 6520 6c69 6e65 2069 7320 3d7b 317d 206d  e line is ={1} m
-0000ffd0: 202e 222e 5c0d 0a20 2020 2020 2020 2020   .".\..         
-0000ffe0: 2020 2020 2020 2020 2020 2066 6f72 6d61             forma
-0000fff0: 7428 7365 6c66 2e64 6970 6f6c 655f 6c65  t(self.dipole_le
-00010000: 6e67 7468 2c0d 0a20 2020 2020 2020 2020  ngth,..         
-00010010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010020: 2020 2873 656c 662e 6561 7374 2e73 697a    (self.east.siz
-00010030: 6520 2d31 292a 2073 656c 662e 6469 706f  e -1)* self.dipo
-00010040: 6c65 5f6c 656e 6774 6829 290d 0a20 2020  le_length))..   
-00010050: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00010060: 2020 2065 6c69 6620 6469 706f 6c65 5f6c     elif dipole_l
-00010070: 656e 6774 6820 6973 206e 6f74 204e 6f6e  ength is not Non
-00010080: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-00010090: 2020 7365 6c66 2e64 6970 6f6c 655f 6c65    self.dipole_le
-000100a0: 6e67 7468 203d 6469 706f 6c65 5f6c 656e  ngth =dipole_len
-000100b0: 6774 6820 0d0a 0d0a 2020 2020 2020 2020  gth ....        
-000100c0: 2020 2020 7365 6c66 2e5f 6c6f 6767 696e      self._loggin
-000100d0: 672e 696e 666f 7328 0d0a 2020 2020 2020  g.infos(..      
-000100e0: 2020 2020 2020 2020 2020 2757 6520 7769            'We wi
-000100f0: 6c6c 2073 6574 2063 6f6d 7075 7465 2073  ll set compute s
-00010100: 7461 7469 6f6e 2070 6f73 6974 696f 6e20  tation position 
-00010110: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00010120: 2020 2027 636f 6e73 6964 6572 696e 6720     'considering 
-00010130: 796f 7572 2064 6970 6f6c 655f 6c65 6e67  your dipole_leng
-00010140: 7468 2076 616c 7565 2070 726f 7669 6465  th value provide
-00010150: 642e 2027 290d 0a20 2020 2020 2020 2020  d. ')..         
-00010160: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00010170: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00010180: 2020 2027 5765 2077 696c 6c20 636f 6d70     'We will comp
-00010190: 7574 6520 7374 6174 696f 6e20 706f 7369  ute station posi
-000101a0: 7469 6f6e 2027 0d0a 2020 2020 2020 2020  tion '..        
-000101b0: 2020 2020 2020 2020 2775 7369 6e67 2079          'using y
-000101c0: 6f75 7220 6465 6661 756c 7420 6469 706f  our default dipo
-000101d0: 6c65 206c 656e 6774 6820 2e27 0d0a 2020  le length .'..  
-000101e0: 2020 2020 2020 2020 2020 2020 2020 2757                'W
-000101f0: 6520 7769 6c6c 2074 6865 206e 6577 2073  e will the new s
-00010200: 7461 7469 6f6e 2073 7465 7020 746f 203c  tation step to <
-00010210: 7b30 7d3e 2e27 2e0d 0a20 2020 2020 2020  {0}>.'...       
-00010220: 2020 2020 2020 2020 2066 6f72 6d61 7428           format(
-00010230: 7365 6c66 2e64 6970 6f6c 655f 6c65 6e67  self.dipole_leng
-00010240: 7468 2929 0d0a 2020 2020 2020 2020 2020  th))..          
-00010250: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00010260: 7374 6e5f 706f 7369 7469 6f6e 203d 6e70  stn_position =np
-00010270: 2e61 7261 6e67 6528 302c 7365 6c66 2e65  .arange(0,self.e
-00010280: 6173 742e 7369 7a65 202a 2073 656c 662e  ast.size * self.
-00010290: 6469 706f 6c65 5f6c 656e 6774 682c 200d  dipole_length, .
-000102a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000102b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000102c0: 2020 2020 2073 656c 662e 6469 706f 6c65       self.dipole
-000102d0: 5f6c 656e 6774 6820 290d 0a0d 0a20 2020  _length )....   
-000102e0: 2020 2020 2020 2020 2073 656c 662e 7374           self.st
-000102f0: 6e5f 706f 7369 7469 6f6e 3d20 7374 6e5f  n_position= stn_
-00010300: 706f 7369 7469 6f6e 0d0a 2020 2020 2020  position..      
-00010310: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00010320: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00010330: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00010340: 2020 2020 6e6f 726d 616c 697a 655f 6469      normalize_di
-00010350: 7374 616e 6365 203d 206e 702e 6170 706c  stance = np.appl
-00010360: 795f 616c 6f6e 675f 6178 6973 280d 0a20  y_along_axis(.. 
-00010370: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
-00010380: 6120 6464 3a20 6464 202d 2073 656c 662e  a dd: dd - self.
-00010390: 7374 6e5f 706f 7369 7469 6f6e 5b30 5d2c  stn_position[0],
-000103a0: 2030 2c20 7365 6c66 2e73 746e 5f70 6f73   0, self.stn_pos
-000103b0: 6974 696f 6e29 0d0a 2020 2020 2020 2020  ition)..        
-000103c0: 7374 6e4e 616d 6573 203d 5b27 537b 303a  stnNames =['S{0:
-000103d0: 3032 7d27 2e66 6f72 6d61 7428 6969 2920  02}'.format(ii) 
-000103e0: 666f 7220 6969 2069 6e20 7261 6e67 6528  for ii in range(
-000103f0: 7365 6c66 2e65 6173 742e 7369 7a65 295d  self.east.size)]
-00010400: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00010410: 2020 2020 2373 6574 2065 6c65 7661 7469      #set elevati
-00010420: 6f6e 2069 7320 6e6f 7420 7072 6f76 6964  on is not provid
-00010430: 6564 202e 7365 7420 656c 6576 6174 696f  ed .set elevatio
-00010440: 6e20 746f 2030 2e20 0d0a 2020 2020 2020  n to 0. ..      
-00010450: 2020 6966 2073 656c 662e 656c 6576 2069    if self.elev i
-00010460: 7320 4e6f 6e65 203a 2073 656c 662e 656c  s None : self.el
-00010470: 6576 203d 206e 702e 6675 6c6c 2828 7365  ev = np.full((se
-00010480: 6c66 2e65 6173 742e 7369 7a65 2c29 2c30  lf.east.size,),0
-00010490: 2e29 0d0a 2020 2020 2020 2020 2377 7269  .)..        #wri
-000104a0: 7465 5f64 6174 6120 0d0a 0d0a 2020 2020  te_data ....    
-000104b0: 2020 2020 7772 6974 655f 7072 6f66 696c      write_profil
-000104c0: 655f 6c69 6e65 732e 6170 7065 6e64 2827  e_lines.append('
-000104d0: 272e 6a6f 696e 285b 227b 303a 5e35 7d22  '.join(["{0:^5}"
-000104e0: 2e66 6f72 6d61 7428 2722 2273 7461 2729  .format('""sta')
-000104f0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00010500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010520: 227b 303a 5e39 7d22 2e66 6f72 6d61 7428  "{0:^9}".format(
-00010530: 2722 226c 656e 286d 2927 295d 2929 0d0a  '""len(m)')]))..
-00010540: 2020 2020 2020 2020 7772 6974 655f 7072          write_pr
-00010550: 6f66 696c 655f 6c69 6e65 732e 6170 7065  ofile_lines.appe
-00010560: 6e64 2827 272e 6a6f 696e 285b 2022 7b30  nd(''.join([ "{0
-00010570: 3a5e 3132 7d22 2e66 6f72 6d61 7428 6a6a  :^12}".format(jj
-00010580: 2920 666f 7220 6a6a 200d 0a20 2020 2020  ) for jj ..     
-00010590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105b0: 2020 2020 2020 2069 6e20 5b27 2222 6561         in ['""ea
-000105c0: 7374 286d 2927 2c27 2222 6e6f 7274 6828  st(m)','""north(
-000105d0: 6d29 272c 0d0a 2020 2020 2020 2020 2020  m)',..          
-000105e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010600: 2020 2020 2020 2722 226c 6174 28c2 b029        '""lat(..)
-00010610: 272c 2027 2222 6c6f 6e67 28c2 b029 272c  ', '""long(..)',
-00010620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010650: 2020 2020 2027 2222 656c 6576 286d 2927       '""elev(m)'
-00010660: 5d5d 2929 0d0a 2020 2020 2020 2020 6966  ]]))..        if
-00010670: 2061 6464 5f61 7a69 6d75 7468 2020 3a20   add_azimuth  : 
-00010680: 0d0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
-00010690: 6974 655f 7072 6f66 696c 655f 6c69 6e65  ite_profile_line
-000106a0: 732e 6170 7065 6e64 2827 7b30 3a5e 3132  s.append('{0:^12
-000106b0: 7d27 2e66 6f72 6d61 7428 2722 2261 7a69  }'.format('""azi
-000106c0: 6d28 c2b0 2927 2929 0d0a 2020 2020 2020  m(..)'))..      
-000106d0: 2020 2020 2020 7772 6974 655f 7072 6f66        write_prof
-000106e0: 696c 655f 6c69 6e65 732e 6170 7065 6e64  ile_lines.append
-000106f0: 2827 272e 6a6f 696e 285b 275c 6e27 2c20  (''.join(['\n', 
-00010700: 272b 272a 2831 322a 362b 3134 2920 2c27  '+'*(12*6+14) ,'
-00010710: 5c6e 275d 2929 0d0a 2020 2020 2020 2020  \n']))..        
-00010720: 656c 7365 203a 7772 6974 655f 7072 6f66  else :write_prof
-00010730: 696c 655f 6c69 6e65 732e 6170 7065 6e64  ile_lines.append
-00010740: 2827 272e 6a6f 696e 285b 275c 6e27 2c20  (''.join(['\n', 
-00010750: 272b 272a 2831 322a 352b 3134 292c 275c  '+'*(12*5+14),'\
-00010760: 6e27 5d29 290d 0a20 2020 2020 2020 200d  n']))..        .
-00010770: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00010780: 2020 2066 6f72 2069 6920 2069 6e20 7261     for ii  in ra
-00010790: 6e67 6528 7365 6c66 2e65 6173 742e 7369  nge(self.east.si
-000107a0: 7a65 293a 200d 0a20 2020 2020 2020 2020  ze): ..         
-000107b0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-000107c0: 2077 7269 7465 5f70 726f 6669 6c65 5f6c   write_profile_l
-000107d0: 696e 6573 2e61 7070 656e 6428 2727 2e6a  ines.append(''.j
-000107e0: 6f69 6e28 0d0a 2020 2020 2020 2020 2020  oin(..          
-000107f0: 2020 2020 2020 5b27 7b3a 3c35 7d27 2e66        ['{:<5}'.f
-00010800: 6f72 6d61 7428 7374 6e4e 616d 6573 5b69  ormat(stnNames[i
-00010810: 695d 292c 200d 0a20 2020 2020 2020 2020  i]), ..         
-00010820: 2020 2020 2020 2027 7b3a 3c37 7d27 2e66         '{:<7}'.f
-00010830: 6f72 6d61 7428 6e6f 726d 616c 697a 655f  ormat(normalize_
-00010840: 6469 7374 616e 6365 5b69 695d 292c 0d0a  distance[ii]),..
-00010850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010860: 277b 3a3c 3131 2e32 667d 272e 666f 726d  '{:<11.2f}'.form
-00010870: 6174 2873 656c 662e 6561 7374 5b69 695d  at(self.east[ii]
-00010880: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00010890: 2020 2020 277b 3a3c 3133 2e32 667d 272e      '{:<13.2f}'.
-000108a0: 666f 726d 6174 2873 656c 662e 6e6f 7274  format(self.nort
-000108b0: 685b 6969 5d29 2c20 0d0a 2020 2020 2020  h[ii]), ..      
-000108c0: 2020 2020 2020 2020 2020 277b 3a3c 3135            '{:<15
-000108d0: 2e31 3066 7d27 2e66 6f72 6d61 7428 7365  .10f}'.format(se
-000108e0: 6c66 2e6c 6174 5b69 695d 292c 200d 0a20  lf.lat[ii]), .. 
-000108f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00010900: 7b3a 3c31 372e 3130 667d 272e 666f 726d  {:<17.10f}'.form
-00010910: 6174 2873 656c 662e 6c6f 6e5b 6969 5d29  at(self.lon[ii])
-00010920: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00010930: 2020 2020 277b 3a3c 3130 2e32 667d 272e      '{:<10.2f}'.
-00010940: 666f 726d 6174 2873 656c 662e 656c 6576  format(self.elev
-00010950: 5b69 695d 290d 0a20 2020 2020 2020 2020  [ii])..         
-00010960: 2020 205d 2929 0d0a 2020 2020 2020 2020     ]))..        
-00010970: 2020 2020 6966 2061 6464 5f61 7a69 6d75      if add_azimu
-00010980: 7468 2069 7320 5472 7565 203a 200d 0a20  th is True : .. 
-00010990: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-000109a0: 7269 7465 5f70 726f 6669 6c65 5f6c 696e  rite_profile_lin
-000109b0: 6573 2e61 7070 656e 6428 277b 303a 3c37  es.append('{0:<7
-000109c0: 2e33 667d 272e 666f 726d 6174 2861 7a69  .3f}'.format(azi
-000109d0: 6d5b 6969 5d29 290d 0a20 2020 2020 2020  m[ii]))..       
-000109e0: 2020 2020 2077 7269 7465 5f70 726f 6669       write_profi
-000109f0: 6c65 5f6c 696e 6573 2e61 7070 656e 6428  le_lines.append(
-00010a00: 275c 6e27 290d 0a20 2020 2020 2020 200d  '\n')..        .
-00010a10: 0a20 2020 2020 2020 2077 6974 6820 6f70  .        with op
-00010a20: 656e 2028 2727 2e6a 6f69 6e28 5b6f 7574  en (''.join([out
-00010a30: 7075 745f 6e61 6d65 2c27 2e73 746e 275d  put_name,'.stn']
-00010a40: 292c 2777 272c 2065 6e63 6f64 696e 673d  ),'w', encoding=
-00010a50: 2775 7466 3827 2920 6173 2066 6964 3a20  'utf8') as fid: 
-00010a60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010a70: 2020 6669 642e 7772 6974 656c 696e 6573    fid.writelines
-00010a80: 2877 7269 7465 5f70 726f 6669 6c65 5f6c  (write_profile_l
-00010a90: 696e 6573 290d 0a20 2020 2020 2020 2020  ines)..         
-00010aa0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00010ab0: 2073 656c 662e 7361 7665 7061 7468 203d   self.savepath =
-00010ac0: 2066 756e 632e 6370 6174 6820 2873 656c   func.cpath (sel
-00010ad0: 662e 7361 7665 7061 7468 2c20 0d0a 2020  f.savepath, ..  
-00010ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b00: 2020 6627 5f7b 7365 6c66 2e5f 5f63 6c61    f'_{self.__cla
-00010b10: 7373 5f5f 2e5f 5f6e 616d 655f 5f2e 6c6f  ss__.__name__.lo
-00010b20: 7765 7228 297d 5f27 290d 0a20 2020 2020  wer()}_')..     
-00010b30: 2020 2069 6620 7365 6c66 2e73 6176 6570     if self.savep
-00010b40: 6174 6820 6973 206e 6f74 204e 6f6e 6520  ath is not None 
-00010b50: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00010b60: 6875 7469 6c2e 6d6f 7665 2028 6f73 2e70  hutil.move (os.p
-00010b70: 6174 682e 6a6f 696e 286f 732e 6765 7463  ath.join(os.getc
-00010b80: 7764 2829 2c0d 0a20 2020 2020 2020 2020  wd(),..         
-00010b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ba0: 2020 2020 2020 2020 2020 2020 2027 272e               ''.
-00010bb0: 6a6f 696e 285b 6f75 7470 7574 5f6e 616d  join([output_nam
-00010bc0: 652c 272e 7374 6e27 5d29 292c 0d0a 2020  e,'.stn'])),..  
-00010bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010be0: 2020 2020 2020 2073 656c 662e 7361 7665         self.save
-00010bf0: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
-00010c00: 2020 200d 0a20 2020 2064 6566 2073 746e     ..    def stn
-00010c10: 5f73 6570 6172 6174 696f 6e28 7365 6c66  _separation(self
-00010c20: 2c20 6561 7374 696e 6720 203d 4e6f 6e65  , easting  =None
-00010c30: 202c 206e 6f72 7468 696e 6720 3d4e 6f6e   , northing =Non
-00010c40: 6520 2c0d 0a20 2020 2020 2020 2020 2020  e ,..           
-00010c50: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-00010c60: 7270 6f6c 6174 6520 3d46 616c 7365 293a  rpolate =False):
-00010c70: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
-00010c80: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
-00010c90: 7468 6520 7374 6174 696f 6e20 7365 7061  the station sepa
-00010ca0: 7261 7469 6f6e 200d 0a20 2020 2020 2020  ration ..       
-00010cb0: 2044 6973 7461 6e63 6520 6265 7477 6565   Distance betwee
-00010cc0: 6e20 6576 6572 7920 7477 6f20 7374 6174  n every two stat
-00010cd0: 696f 6e73 200d 0a20 2020 2020 2020 200d  ions ..        .
-00010ce0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00010cf0: 6572 7320 0d0a 2020 2020 2020 2020 2d2d  ers ..        --
-00010d00: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00010d10: 2020 2020 2020 2a20 6561 7374 696e 6720        * easting 
-00010d20: 3a20 6172 7261 795f 6c69 6b65 2028 6e64  : array_like (nd
-00010d30: 6172 7261 792c 2031 290d 0a20 2020 2020  array, 1)..     
-00010d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d50: 2020 2065 6173 7469 6e67 2063 6f6f 7264     easting coord
-00010d60: 696e 6174 6573 2020 0d0a 2020 2020 2020  inates  ..      
-00010d70: 2020 2020 2020 2a20 6e6f 7274 6869 6e67        * northing
-00010d80: 203a 2061 7272 6179 5f6c 696b 6520 286e   : array_like (n
-00010d90: 6461 7272 6179 2c31 2920 0d0a 2020 2020  darray,1) ..    
-00010da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010db0: 2020 2020 6e6f 7274 6869 6e67 2063 6f6f      northing coo
-00010dc0: 7264 696e 6174 6573 200d 0a20 2020 2020  rdinates ..     
-00010dd0: 2020 2020 2020 202a 2069 6e74 6572 706f         * interpo
-00010de0: 6c61 7465 203a 2062 6f6f 6c20 0d0a 2020  late : bool ..  
-00010df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e00: 2020 2020 2020 6966 2069 6e74 6572 706f        if interpo
-00010e10: 6c61 7465 2069 7320 5472 7565 2020 7769  late is True  wi
-00010e20: 6c6c 2065 7874 656e 6420 746f 204e 2b31  ll extend to N+1
-00010e30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00010e40: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-00010e50: 7220 746f 206d 7563 680d 0a20 2020 2020  r to much..     
-00010e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e70: 2020 2065 7863 6174 6c79 2074 6865 206e     excatly the n
-00010e80: 756d 6265 7220 206f 6620 656c 6563 7472  umber  of electr
-00010e90: 6f64 652e 2049 6620 6661 6c73 6520 2c0d  ode. If false ,.
-00010ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010eb0: 2020 2020 2020 2020 2069 7420 6d61 7463           it matc
-00010ec0: 6820 7468 6520 6e75 6d62 6572 206f 6620  h the number of 
-00010ed0: 6469 706f 6c65 204e 2e0d 0a20 2020 2020  dipole N...     
-00010ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ef0: 2020 202a 4465 6661 756c 742a 2069 7320     *Default* is 
-00010f00: 4661 6c73 652e 0d0a 2020 2020 2020 2020  False...        
-00010f10: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00010f20: 2020 5265 7475 726e 7320 200d 0a20 2020    Returns  ..   
-00010f30: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
-00010f40: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00010f50: 795f 6c69 6b65 200d 0a20 2020 2020 2020  y_like ..       
-00010f60: 2020 2020 2020 2020 2020 7365 7061 7261            separa
-00010f70: 7469 6f6e 2076 616c 7565 2061 7272 6179  tion value array
-00010f80: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00010f90: 2066 6c6f 6174 200d 0a20 2020 2020 2020   float ..       
-00010fa0: 2020 2020 2020 2020 2073 6570 6172 6174           separat
-00010fb0: 696f 6e20 6d65 616e 2020 6f72 2061 7665  ion mean  or ave
-00010fc0: 7261 6765 2073 6570 6172 6174 696f 6e20  rage separation 
-00010fd0: 7661 6c75 6520 200d 0a20 2020 2020 2020  value  ..       
-00010fe0: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
-00010ff0: 2028 6561 7374 696e 672e 6474 7970 6520   (easting.dtype 
-00011000: 213d 2766 6c6f 6174 2729 206f 7220 286e  !='float') or (n
-00011010: 6f72 7468 696e 672e 6474 7970 6520 213d  orthing.dtype !=
-00011020: 2766 6c6f 6174 2729 3a20 0d0a 2020 2020  'float'): ..    
-00011030: 2020 2020 2020 2020 7472 7920 3a0d 0a20          try :.. 
-00011040: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00011050: 6173 7469 6e67 203d 206e 702e 6172 7261  asting = np.arra
-00011060: 7928 5b66 6c6f 6174 2873 7329 2066 6f72  y([float(ss) for
-00011070: 2073 7320 696e 2065 6173 7469 6e67 5d29   ss in easting])
-00011080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011090: 2020 6e6f 7274 6869 6e67 203d 6e70 2e61    northing =np.a
-000110a0: 7272 6179 285b 666c 6f61 7428 7373 2920  rray([float(ss) 
-000110b0: 666f 7220 7373 2069 6e20 6e6f 7274 6869  for ss in northi
-000110c0: 6e67 5d29 0d0a 2020 2020 2020 2020 2020  ng])..          
-000110d0: 2020 6578 6365 7074 203a 2072 6169 7365    except : raise
-000110e0: 2043 5365 782e 7079 4353 414d 5445 7272   CSex.pyCSAMTErr
-000110f0: 6f72 5f70 726f 6669 6c65 280d 0a20 2020  or_profile(..   
-00011100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011110: 2022 4e6f 6e65 5479 7065 2063 616e 206e   "NoneType can n
-00011120: 6f74 2062 6520 636f 6d70 7574 6564 2e22  ot be computed."
-00011130: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011140: 2020 2020 2020 2250 6c65 6173 6520 7072        "Please pr
-00011150: 6f76 6964 6520 7468 6520 7269 6768 7420  ovide the right 
-00011160: 636f 6f72 6469 6e61 7465 7321 2e22 290d  coordinates!.").
-00011170: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00011180: 2020 2069 6620 6561 7374 696e 672e 7369     if easting.si
-00011190: 7a65 2021 3d20 6e6f 7274 6869 6e67 2e73  ze != northing.s
-000111a0: 697a 6520 3a0d 0a20 2020 2020 2020 2020  ize :..         
-000111b0: 2020 2072 6169 7365 2043 5365 782e 7079     raise CSex.py
-000111c0: 4353 414d 5445 7272 6f72 5f70 726f 6669  CSAMTError_profi
-000111d0: 6c65 280d 0a20 2020 2020 2020 2020 2020  le(..           
-000111e0: 2022 426f 7468 2063 6f6f 7264 696e 6174   "Both coordinat
-000111f0: 6573 2061 7272 6179 206d 7573 7420 6861  es array must ha
-00011200: 7665 2074 6865 2073 616d 6520 7369 7a65  ve the same size
-00011210: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
-00011220: 2022 5468 6520 6669 7273 7420 6172 6775   "The first argu
-00011230: 6d65 6e74 2073 697a 6520 6973 203c 7b30  ment size is <{0
-00011240: 7d3e 2c20 7768 696c 6520 7468 6520 7365  }>, while the se
-00011250: 636f 6e64 2069 7320 3c7b 317d 3e2e 222e  cond is <{1}>.".
-00011260: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011270: 2020 2066 6f72 6d61 7428 6561 7374 696e     format(eastin
-00011280: 672e 7369 7a65 2c20 6e6f 7274 6869 6e67  g.size, northing
-00011290: 2e73 697a 6529 290d 0a20 2020 2020 2020  .size))..       
-000112a0: 2023 2066 6f72 206b 6b20 696e 2072 616e   # for kk in ran
-000112b0: 6765 2873 656c 662e 6561 7374 2e73 697a  ge(self.east.siz
-000112c0: 6529 3a20 0d0a 2020 2020 2020 2020 2320  e): ..        # 
-000112d0: 2020 2020 6966 206b 6b20 3c3d 7365 6c66      if kk <=self
-000112e0: 2e65 6173 742e 7369 7a65 202d 3220 3a20  .east.size -2 : 
-000112f0: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
-00011300: 2020 2020 6e70 2e73 7172 7428 2873 656c      np.sqrt((sel
-00011310: 662e 6561 7374 5b6b 6b2b 315d 2d73 656c  f.east[kk+1]-sel
-00011320: 662e 6561 7374 5b6b 6b2d 315d 292a 2a32  f.east[kk-1])**2
-00011330: 202b 0d0a 2020 2020 2020 2020 2320 2873   +..        # (s
-00011340: 656c 662e 6e6f 7274 685b 6b6b 2b31 5d2d  elf.north[kk+1]-
-00011350: 7365 6c66 2e6e 6f72 7468 5b6b 6b2d 315d  self.north[kk-1]
-00011360: 292a 2a32 290d 0a20 2020 2020 2020 2073  )**2)..        s
-00011370: 746e 5f73 6570 203d 6e70 2e61 7272 6179  tn_sep =np.array
-00011380: 285b 6e70 2e73 7172 7428 2865 6173 7469  ([np.sqrt((easti
-00011390: 6e67 5b6b 6b2b 315d 2d65 6173 7469 6e67  ng[kk+1]-easting
-000113a0: 5b6b 6b5d 292a 2a32 202b 2028 0d0a 2020  [kk])**2 + (..  
-000113b0: 2020 2020 2020 2020 2020 6e6f 7274 6869            northi
-000113c0: 6e67 5b6b 6b2b 315d 2d6e 6f72 7468 696e  ng[kk+1]-northin
-000113d0: 675b 6b6b 5d29 2a2a 3229 2066 6f72 200d  g[kk])**2) for .
-000113e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000113f0: 2020 2020 2020 2020 2020 2020 6b6b 2069              kk i
-00011400: 6e20 7261 6e67 6520 286e 6f72 7468 696e  n range (northin
-00011410: 672e 7369 7a65 2920 6966 0d0a 2020 2020  g.size) if..    
-00011420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011430: 2020 2020 2020 206b 6b20 3c3d 6e6f 7274         kk <=nort
-00011440: 6869 6e67 2e73 697a 6520 2d32 5d29 0d0a  hing.size -2])..
-00011450: 0d0a 2020 2020 2020 2020 6966 2069 6e74  ..        if int
-00011460: 6572 706f 6c61 7465 2069 7320 5472 7565  erpolate is True
-00011470: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00011480: 2078 7820 2c20 7878 5f6e 6577 203d 206e   xx , xx_new = n
-00011490: 702e 6172 616e 6765 2873 746e 5f73 6570  p.arange(stn_sep
-000114a0: 2e73 697a 6529 2c6e 702e 6172 616e 6765  .size),np.arange
-000114b0: 2873 746e 5f73 6570 2e73 697a 6520 2b31  (stn_sep.size +1
-000114c0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
-000114d0: 6666 203d 2073 702e 696e 7465 7270 6f6c  ff = sp.interpol
-000114e0: 6174 652e 696e 7465 7270 3164 2878 782c  ate.interp1d(xx,
-000114f0: 2073 746e 5f73 6570 2c20 6669 6c6c 5f76   stn_sep, fill_v
-00011500: 616c 7565 3d27 6578 7472 6170 6f6c 6174  alue='extrapolat
-00011510: 6527 290d 0a20 2020 2020 2020 2020 2020  e')..           
-00011520: 2073 746e 5f73 6570 3d20 6666 2878 785f   stn_sep= ff(xx_
-00011530: 6e65 7729 0d0a 0d0a 2020 2020 2020 2020  new)....        
-00011540: 7265 7475 726e 2073 746e 5f73 6570 202c  return stn_sep ,
-00011550: 2073 746e 5f73 6570 2e6d 6561 6e28 290d   stn_sep.mean().
-00011560: 0a20 2020 200d 0a20 2020 2040 7374 6174  .    ..    @stat
-00011570: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
-00011580: 6620 636f 6d70 7574 655f 6469 706f 6c65  f compute_dipole
-00011590: 6c65 6e67 7468 5f66 726f 6d5f 636f 6f72  length_from_coor
-000115a0: 6473 2865 6173 7469 6e67 3d4e 6f6e 652c  ds(easting=None,
-000115b0: 206e 6f72 7468 696e 673d 4e6f 6e65 2c0d   northing=None,.
-000115c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000115d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000115e0: 2020 2020 2020 2020 2020 2a2a 6b77 6172            **kwar
-000115f0: 6773 293a 200d 0a20 2020 2020 2020 2022  gs): ..        "
-00011600: 2222 0d0a 2020 2020 2020 2020 466f 6e63  ""..        Fonc
-00011610: 7469 6f6e 2074 6f20 636f 6d70 7574 6520  tion to compute 
-00011620: 6469 706f 6c65 206c 656e 6774 6820 6672  dipole length fr
-00011630: 6f6d 2063 6f6f 7264 696e 6174 6573 2065  om coordinates e
-00011640: 6173 7469 6e67 200d 0a20 2020 2020 2020  asting ..       
-00011650: 2061 6e64 206e 6f72 7468 696e 6720 7661   and northing va
-00011660: 6c75 6573 2e0d 0a20 2020 2020 2020 200d  lues...        .
-00011670: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00011680: 6561 7374 696e 673a 2061 7272 6179 206f  easting: array o
-00011690: 6620 6561 7374 696e 6720 636f 6f72 6469  f easting coordi
-000116a0: 6e61 7465 2069 6e20 6d65 7465 7273 0d0a  nate in meters..
-000116b0: 2020 2020 2020 2020 3a74 7970 6520 6561          :type ea
-000116c0: 7374 696e 673a 2061 7272 6179 5f6c 696b  sting: array_lik
-000116d0: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-000116e0: 2020 2020 0d0a 2020 2020 2020 2020 3a70      ..        :p
-000116f0: 6172 616d 206e 6f72 7468 696e 673a 2061  aram northing: a
-00011700: 7272 6179 206f 6620 6e6f 7274 6869 6e67  rray of northing
-00011710: 2063 6f6f 7264 696e 6174 6520 696e 206d   coordinate in m
-00011720: 6574 6572 730d 0a20 2020 2020 2020 203a  eters..        :
-00011730: 7479 7065 206e 6f72 7468 696e 673a 2020  type northing:  
-00011740: 6172 7261 795f 6c69 6b65 200d 0a20 2020  array_like ..   
-00011750: 2020 2020 200d 0a20 2020 2020 2020 203a       ..        :
-00011760: 7061 7261 6d20 6c61 743a 2020 6c61 7469  param lat:  lati
-00011770: 7475 6465 2063 6f6f 7264 696e 6174 6520  tude coordinate 
-00011780: 2069 6e20 6465 6772 6565 200d 0a20 2020   in degree ..   
-00011790: 2020 2020 203a 7479 7065 206c 6174 3a20       :type lat: 
-000117a0: 6172 7261 795f 6c69 6b65 2028 6e64 6172  array_like (ndar
-000117b0: 7261 792c 3129 200d 0a20 2020 2020 2020  ray,1) ..       
-000117c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000117d0: 2020 3a70 6172 616d 206c 6f6e 3a20 6c6f    :param lon: lo
-000117e0: 6e67 6974 7564 6520 636f 6f72 6469 6e61  ngitude coordina
-000117f0: 7465 2020 696e 2064 6567 7265 6520 0d0a  te  in degree ..
-00011800: 2020 2020 2020 2020 3a74 7970 6520 6c6f          :type lo
-00011810: 6e3a 2061 7272 6179 5f6c 696b 6520 286e  n: array_like (n
-00011820: 6461 7272 6179 2c31 2920 0d0a 2020 2020  darray,1) ..    
-00011830: 2020 2020 0d0a 2020 2020 2020 2020 3a70      ..        :p
-00011840: 6172 616d 2072 6566 6572 656e 6365 5f65  aram reference_e
-00011850: 6c6c 6970 736f 6964 3a20 6964 2c20 456c  llipsoid: id, El
-00011860: 6c69 7073 6f69 6420 6e61 6d65 2c0d 0a20  lipsoid name,.. 
-00011870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011880: 2020 2020 2020 2020 2020 2020 2020 2045                 E
-00011890: 7175 6174 6f72 6961 6c20 5261 6469 7573  quatorial Radius
-000118a0: 2c20 7371 7561 7265 206f 6620 0d0a 2020  , square of ..  
-000118b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118c0: 2020 2020 2020 2020 2020 2020 2020 6563                ec
-000118d0: 6365 6e74 7269 6369 7479 202c 6465 6661  centricity ,defa
-000118e0: 756c 7420 6973 2032 3320 0d0a 2020 2020  ult is 23 ..    
-000118f0: 2020 2020 3a74 7970 6520 7265 6665 7265      :type refere
-00011900: 6e63 655f 656c 6c69 7073 6f69 643a 2069  nce_ellipsoid: i
-00011910: 6e74 200d 0a20 2020 2020 2020 200d 0a20  nt ..        .. 
-00011920: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-00011930: 206c 656e 6774 6820 6f66 2064 6970 6f6c   length of dipol
-00011940: 6520 6475 7269 6e67 2073 7572 7665 7920  e during survey 
-00011950: 6170 7072 6f78 696d 6174 6564 202e 200d  approximated . .
-00011960: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-00011970: 2066 6c6f 6174 200d 0a20 2020 2020 2020   float ..       
-00011980: 2020 0d0a 2020 2020 2020 2020 3a72 6574    ..        :ret
-00011990: 7572 6e73 3a20 2070 6f73 6974 696f 6e20  urns:  position 
-000119a0: 6f66 2064 6970 6f6c 6520 6672 6f6d 2072  of dipole from r
-000119b0: 6566 6572 656e 6365 2073 7461 7469 6f6e  eference station
-000119c0: 2020 0d0a 2020 2020 2020 2020 3a72 7479    ..        :rty
-000119d0: 7065 3a20 6172 7261 795f 6c69 6b65 286e  pe: array_like(n
-000119e0: 6461 7272 6179 2c31 290d 0a20 2020 2020  darray,1)..     
-000119f0: 2020 200d 0a20 2020 2020 2020 202e 2e20     ..        .. 
-00011a00: 6e6f 7465 3a3a 2074 6865 2066 6972 7374  note:: the first
-00011a10: 2065 6c65 6374 726f 6465 2069 7320 6c6f   electrode is lo
-00011a20: 6361 7465 6420 6174 2030 2061 6e64 2073  cated at 0 and s
-00011a30: 6563 6f6e 6420 656c 6563 7472 6f64 6520  econd electrode 
-00011a40: 746f 200d 0a20 2020 2020 2020 2020 2020  to ..           
-00011a50: 2020 2020 2020 6469 706f 6c65 206c 656e        dipole len
-00011a60: 6774 6820 692e 6520 5b30 2c20 3530 202c  gth i.e [0, 50 ,
-00011a70: 202e 2e2e 2c20 6e6e 2a35 305d 2077 6865   ..., nn*50] whe
-00011a80: 7265 206e 6e20 6e75 6d62 6572 200d 0a20  re nn number .. 
-00011a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011aa0: 6f66 2070 6f69 6e74 202d 312e 2044 6174  of point -1. Dat
-00011ab0: 6120 6172 6520 7265 6c6f 6361 7465 6420  a are relocated 
-00011ac0: 696e 2063 656e 7465 7220 706f 7369 7469  in center positi
-00011ad0: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
-00011ae0: 2020 2020 206f 6620 6469 706f 6c65 2e0d       of dipole..
-00011af0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00011b00: 2020 2020 2020 6c61 7469 7475 6465 203d        latitude =
-00011b10: 6b77 6172 6773 2e70 6f70 2827 6c61 7469  kwargs.pop('lati
-00011b20: 7475 6465 272c 204e 6f6e 6520 290d 0a20  tude', None ).. 
-00011b30: 2020 2020 2020 206c 6f6e 6769 7475 6465         longitude
-00011b40: 203d 6b77 6172 6773 2e70 6f70 2827 6c6f   =kwargs.pop('lo
-00011b50: 6e67 6974 7564 6527 2c20 4e6f 6e65 290d  ngitude', None).
-00011b60: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00011b70: 2020 2072 6566 6572 656e 6365 5f65 6c6c     reference_ell
-00011b80: 6970 736f 6964 203d 6b77 6172 6773 2e70  ipsoid =kwargs.p
-00011b90: 6f70 2827 7265 6665 7265 6e63 655f 656c  op('reference_el
-00011ba0: 6c69 7073 6f69 6427 2c20 3233 290d 0a20  lipsoid', 23).. 
-00011bb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00011bc0: 2069 6620 6561 7374 696e 6720 6973 206e   if easting is n
-00011bd0: 6f74 2020 4e6f 6e65 2020 616e 6420 6e6f  ot  None  and no
-00011be0: 7274 6869 6e67 2069 7320 6e6f 7420 4e6f  rthing is not No
-00011bf0: 6e65 203a 200d 0a20 2020 2020 2020 2020  ne : ..         
-00011c00: 2020 2061 7373 6572 7420 6561 7374 696e     assert eastin
-00011c10: 672e 7369 7a65 203d 3d20 6e6f 7274 6869  g.size == northi
-00011c20: 6e67 2e73 697a 6520 2c20 4353 6578 2e70  ng.size , CSex.p
-00011c30: 7943 5341 4d54 4572 726f 725f 7072 6f66  yCSAMTError_prof
-00011c40: 696c 6528 0d0a 2020 2020 2020 2020 2020  ile(..          
-00011c50: 2020 2020 2020 2745 6173 7469 6e67 2061        'Easting a
-00011c60: 6e64 204e 6f72 7468 696e 6720 6d75 7374  nd Northing must
-00011c70: 2068 6176 6520 7468 6520 7361 6d65 2073   have the same s
-00011c80: 697a 652e 270d 0a20 2020 2020 2020 2020  ize.'..         
-00011c90: 2020 2020 2020 2027 2045 6173 7469 6e67         ' Easting
-00011ca0: 7c6e 6f72 7468 696e 6720 7369 7a65 2061  |northing size a
-00011cb0: 7265 2063 7572 7265 6e74 6c79 7369 7a65  re currentlysize
-00011cc0: 2069 7320 3c7b 307d 7c7b 317d 3e2e 272e   is <{0}|{1}>.'.
-00011cd0: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
-00011ce0: 2020 2020 2020 2066 6f72 6d61 7428 6561         format(ea
-00011cf0: 7374 696e 672e 7369 7a65 2c20 6e6f 7274  sting.size, nort
-00011d00: 6869 6e67 2e73 697a 6529 290d 0a0d 0a20  hing.size)).... 
-00011d10: 2020 2020 2020 2065 6c69 6620 6c61 7469         elif lati
-00011d20: 7475 6465 2069 7320 6e6f 7420 4e6f 6e65  tude is not None
-00011d30: 2061 6e64 206c 6f6e 6769 7475 6465 2069   and longitude i
-00011d40: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
-00011d50: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-00011d60: 7420 6c61 7469 7475 6465 2e73 697a 6520  t latitude.size 
-00011d70: 3d3d 206c 6f6e 6769 7475 6465 2e73 697a  == longitude.siz
-00011d80: 6520 2c20 5c0d 0a20 2020 2020 2020 2020  e , \..         
-00011d90: 2020 2020 2020 2043 5365 782e 7079 4353         CSex.pyCS
-00011da0: 414d 5445 7272 6f72 5f70 726f 6669 6c65  AMTError_profile
-00011db0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00011dc0: 2020 2020 2020 2027 4c61 7469 7475 6465         'Latitude
-00011dd0: 2061 6e64 206c 6f6e 6769 7475 6465 206d   and longitude m
-00011de0: 7573 7420 6861 7665 2074 6865 2073 616d  ust have the sam
-00011df0: 6520 7369 7a65 2e27 0d0a 2020 2020 2020  e size.'..      
-00011e00: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
-00011e10: 4561 7374 696e 677c 6e6f 7274 6869 6e67  Easting|northing
-00011e20: 2073 697a 6520 6172 6520 6375 7272 656e   size are curren
-00011e30: 746c 7973 697a 6527 0d0a 2020 2020 2020  tlysize'..      
-00011e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e50: 2020 2720 6973 203c 7b30 7d7c 7b31 7d3e    ' is <{0}|{1}>
-00011e60: 2e27 2e66 6f72 6d61 7428 6561 7374 696e  .'.format(eastin
-00011e70: 672e 7369 7a65 2c20 0d0a 2020 2020 2020  g.size, ..      
+0000fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc00: 2020 2020 2020 2020 2020 2020 6578 7472              extr
+0000fc10: 6170 6f6c 6174 653d 5472 7565 290d 0a20  apolate=True).. 
+0000fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc30: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+0000fc40: 6469 706f 6c65 5f6c 656e 6774 6820 6973  dipole_length is
+0000fc50: 204e 6f6e 6520 3a0d 0a20 2020 2020 2020   None :..       
+0000fc60: 2020 2020 2073 656c 662e 5f6c 6f67 6769       self._loggi
+0000fc70: 6e67 2e69 6e66 6f28 2741 7574 6f6d 6174  ng.info('Automat
+0000fc80: 6963 2064 6970 6f6c 6520 6c65 6e67 7468  ic dipole length
+0000fc90: 2063 616c 6375 6c61 7469 6f6e 2061 6e64   calculation and
+0000fca0: 2027 0d0a 2020 2020 2020 2020 2020 2020   '..            
+0000fcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fcc0: 2020 2027 7374 6174 696f 6e73 2070 6f73     'stations pos
+0000fcd0: 6974 696f 6e20 7661 6c75 6573 2061 7265  ition values are
+0000fce0: 2073 6574 2077 6974 682e 2729 0d0a 2020   set with.')..  
+0000fcf0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000fd00: 2020 2020 2020 2020 7365 6c66 2e64 6970          self.dip
+0000fd10: 6f6c 655f 6c65 6e67 7468 2c20 7365 6c66  ole_length, self
+0000fd20: 2e73 746e 5f70 6f73 6974 696f 6e20 3d20  .stn_position = 
+0000fd30: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
+0000fd40: 2020 2073 656c 662e 636f 6d70 7574 655f     self.compute_
+0000fd50: 6469 706f 6c65 6c65 6e67 7468 5f66 726f  dipolelength_fro
+0000fd60: 6d5f 636f 6f72 6473 280d 0a20 2020 2020  m_coords(..     
+0000fd70: 2020 2020 2020 2020 2020 2065 6173 7469             easti
+0000fd80: 6e67 203d 7365 6c66 2e65 6173 742c 206e  ng =self.east, n
+0000fd90: 6f72 7468 696e 6720 3d20 7365 6c66 2e6e  orthing = self.n
+0000fda0: 6f72 7468 290d 0a20 2020 2020 2020 2020  orth)..         
+0000fdb0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0000fdc0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0000fdd0: 2020 2022 4469 706f 6c65 206c 656e 6774     "Dipole lengt
+0000fde0: 6820 6973 2063 6f6d 7075 7469 6e67 2061  h is computing a
+0000fdf0: 7574 6f6d 6174 6963 616c 6c79 2061 6e64  utomatically and
+0000fe00: 2073 6574 220d 0a20 2020 2020 2020 2020   set"..         
+0000fe10: 2020 2020 2020 2022 2073 7461 7469 6f6e         " station
+0000fe20: 2070 6f73 6974 696f 6e20 7769 7468 2062   position with b
+0000fe30: 7920 6465 6661 756c 742e 2044 6970 6f6c  y default. Dipol
+0000fe40: 6520 6c65 6e67 7468 2069 7320 3d7b 307d  e length is ={0}
+0000fe50: 206d 220d 0a20 2020 2020 2020 2020 2020   m"..           
+0000fe60: 2020 2020 2022 616e 6420 6c65 6e67 7468       "and length
+0000fe70: 2061 6c6f 6e67 2074 6865 206c 696e 6520   along the line 
+0000fe80: 6973 203d 7b31 7d20 6d20 2e22 2e5c 0d0a  is ={1} m .".\..
+0000fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fea0: 2020 2020 666f 726d 6174 2873 656c 662e      format(self.
+0000feb0: 6469 706f 6c65 5f6c 656e 6774 682c 0d0a  dipole_length,..
+0000fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fed0: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
+0000fee0: 2e65 6173 742e 7369 7a65 202d 3129 2a20  .east.size -1)* 
+0000fef0: 7365 6c66 2e64 6970 6f6c 655f 6c65 6e67  self.dipole_leng
+0000ff00: 7468 2929 0d0a 2020 2020 2020 2020 2020  th))..          
+0000ff10: 2020 0d0a 2020 2020 2020 2020 656c 6966    ..        elif
+0000ff20: 2064 6970 6f6c 655f 6c65 6e67 7468 2069   dipole_length i
+0000ff30: 7320 6e6f 7420 4e6f 6e65 203a 200d 0a20  s not None : .. 
+0000ff40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ff50: 6469 706f 6c65 5f6c 656e 6774 6820 3d64  dipole_length =d
+0000ff60: 6970 6f6c 655f 6c65 6e67 7468 200d 0a0d  ipole_length ...
+0000ff70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000ff80: 662e 5f6c 6f67 6769 6e67 2e69 6e66 6f73  f._logging.infos
+0000ff90: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+0000ffa0: 2020 2027 5765 2077 696c 6c20 7365 7420     'We will set 
+0000ffb0: 636f 6d70 7574 6520 7374 6174 696f 6e20  compute station 
+0000ffc0: 706f 7369 7469 6f6e 2027 0d0a 2020 2020  position '..    
+0000ffd0: 2020 2020 2020 2020 2020 2020 2763 6f6e              'con
+0000ffe0: 7369 6465 7269 6e67 2079 6f75 7220 6469  sidering your di
+0000fff0: 706f 6c65 5f6c 656e 6774 6820 7661 6c75  pole_length valu
+00010000: 6520 7072 6f76 6964 6564 2e20 2729 0d0a  e provided. ')..
+00010010: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00010020: 696e 6773 2e77 6172 6e28 0d0a 2020 2020  ings.warn(..    
+00010030: 2020 2020 2020 2020 2020 2020 2757 6520              'We 
+00010040: 7769 6c6c 2063 6f6d 7075 7465 2073 7461  will compute sta
+00010050: 7469 6f6e 2070 6f73 6974 696f 6e20 270d  tion position '.
+00010060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010070: 2027 7573 696e 6720 796f 7572 2064 6566   'using your def
+00010080: 6175 6c74 2064 6970 6f6c 6520 6c65 6e67  ault dipole leng
+00010090: 7468 202e 270d 0a20 2020 2020 2020 2020  th .'..         
+000100a0: 2020 2020 2020 2027 5765 2077 696c 6c20         'We will 
+000100b0: 7468 6520 6e65 7720 7374 6174 696f 6e20  the new station 
+000100c0: 7374 6570 2074 6f20 3c7b 307d 3e2e 272e  step to <{0}>.'.
+000100d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000100e0: 2020 666f 726d 6174 2873 656c 662e 6469    format(self.di
+000100f0: 706f 6c65 5f6c 656e 6774 6829 290d 0a20  pole_length)).. 
+00010100: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00010110: 2020 2020 2020 2020 2073 746e 5f70 6f73           stn_pos
+00010120: 6974 696f 6e20 3d6e 702e 6172 616e 6765  ition =np.arange
+00010130: 2830 2c73 656c 662e 6561 7374 2e73 697a  (0,self.east.siz
+00010140: 6520 2a20 7365 6c66 2e64 6970 6f6c 655f  e * self.dipole_
+00010150: 6c65 6e67 7468 2c20 0d0a 2020 2020 2020  length, ..      
+00010160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010170: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00010180: 6c66 2e64 6970 6f6c 655f 6c65 6e67 7468  lf.dipole_length
+00010190: 2029 0d0a 0d0a 2020 2020 2020 2020 2020   )....          
+000101a0: 2020 7365 6c66 2e73 746e 5f70 6f73 6974    self.stn_posit
+000101b0: 696f 6e3d 2073 746e 5f70 6f73 6974 696f  ion= stn_positio
+000101c0: 6e0d 0a20 2020 2020 2020 2020 2020 200d  n..            .
+000101d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000101e0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000101f0: 2020 200d 0a20 2020 2020 2020 206e 6f72     ..        nor
+00010200: 6d61 6c69 7a65 5f64 6973 7461 6e63 6520  malize_distance 
+00010210: 3d20 6e70 2e61 7070 6c79 5f61 6c6f 6e67  = np.apply_along
+00010220: 5f61 7869 7328 0d0a 2020 2020 2020 2020  _axis(..        
+00010230: 2020 2020 6c61 6d62 6461 2064 643a 2064      lambda dd: d
+00010240: 6420 2d20 7365 6c66 2e73 746e 5f70 6f73  d - self.stn_pos
+00010250: 6974 696f 6e5b 305d 2c20 302c 2073 656c  ition[0], 0, sel
+00010260: 662e 7374 6e5f 706f 7369 7469 6f6e 290d  f.stn_position).
+00010270: 0a20 2020 2020 2020 2073 746e 4e61 6d65  .        stnName
+00010280: 7320 3d5b 2753 7b30 3a30 327d 272e 666f  s =['S{0:02}'.fo
+00010290: 726d 6174 2869 6929 2066 6f72 2069 6920  rmat(ii) for ii 
+000102a0: 696e 2072 616e 6765 2873 656c 662e 6561  in range(self.ea
+000102b0: 7374 2e73 697a 6529 5d0d 0a20 2020 2020  st.size)]..     
+000102c0: 2020 200d 0a20 2020 2020 2020 2023 7365     ..        #se
+000102d0: 7420 656c 6576 6174 696f 6e20 6973 206e  t elevation is n
+000102e0: 6f74 2070 726f 7669 6465 6420 2e73 6574  ot provided .set
+000102f0: 2065 6c65 7661 7469 6f6e 2074 6f20 302e   elevation to 0.
+00010300: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
+00010310: 6c66 2e65 6c65 7620 6973 204e 6f6e 6520  lf.elev is None 
+00010320: 3a20 7365 6c66 2e65 6c65 7620 3d20 6e70  : self.elev = np
+00010330: 2e66 756c 6c28 2873 656c 662e 6561 7374  .full((self.east
+00010340: 2e73 697a 652c 292c 302e 290d 0a20 2020  .size,),0.)..   
+00010350: 2020 2020 2023 7772 6974 655f 6461 7461       #write_data
+00010360: 200d 0a0d 0a20 2020 2020 2020 2077 7269   ....        wri
+00010370: 7465 5f70 726f 6669 6c65 5f6c 696e 6573  te_profile_lines
+00010380: 2e61 7070 656e 6428 2727 2e6a 6f69 6e28  .append(''.join(
+00010390: 5b22 7b30 3a5e 357d 222e 666f 726d 6174  ["{0:^5}".format
+000103a0: 2827 2222 7374 6127 292c 200d 0a20 2020  ('""sta'), ..   
+000103b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103d0: 2020 2020 2020 2020 2022 7b30 3a5e 397d           "{0:^9}
+000103e0: 222e 666f 726d 6174 2827 2222 6c65 6e28  ".format('""len(
+000103f0: 6d29 2729 5d29 290d 0a20 2020 2020 2020  m)')]))..       
+00010400: 2077 7269 7465 5f70 726f 6669 6c65 5f6c   write_profile_l
+00010410: 696e 6573 2e61 7070 656e 6428 2727 2e6a  ines.append(''.j
+00010420: 6f69 6e28 5b20 227b 303a 5e31 327d 222e  oin([ "{0:^12}".
+00010430: 666f 726d 6174 286a 6a29 2066 6f72 206a  format(jj) for j
+00010440: 6a20 0d0a 2020 2020 2020 2020 2020 2020  j ..            
+00010450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010470: 696e 205b 2722 2265 6173 7428 6d29 272c  in ['""east(m)',
+00010480: 2722 226e 6f72 7468 286d 2927 2c0d 0a20  '""north(m)',.. 
+00010490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000104c0: 2222 6c61 7428 c2b0 2927 2c20 2722 226c  ""lat(..)', '""l
+000104d0: 6f6e 6728 c2b0 2927 2c0d 0a20 2020 2020  ong(..)',..     
+000104e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010500: 2020 2020 2020 2020 2020 2020 2020 2722                '"
+00010510: 2265 6c65 7628 6d29 275d 5d29 290d 0a20  "elev(m)']])).. 
+00010520: 2020 2020 2020 2069 6620 6164 645f 617a         if add_az
+00010530: 696d 7574 6820 203a 200d 0a20 2020 2020  imuth  : ..     
+00010540: 2020 2020 2020 2077 7269 7465 5f70 726f         write_pro
+00010550: 6669 6c65 5f6c 696e 6573 2e61 7070 656e  file_lines.appen
+00010560: 6428 277b 303a 5e31 327d 272e 666f 726d  d('{0:^12}'.form
+00010570: 6174 2827 2222 617a 696d 28c2 b029 2729  at('""azim(..)')
+00010580: 290d 0a20 2020 2020 2020 2020 2020 2077  )..            w
+00010590: 7269 7465 5f70 726f 6669 6c65 5f6c 696e  rite_profile_lin
+000105a0: 6573 2e61 7070 656e 6428 2727 2e6a 6f69  es.append(''.joi
+000105b0: 6e28 5b27 5c6e 272c 2027 2b27 2a28 3132  n(['\n', '+'*(12
+000105c0: 2a36 2b31 3429 202c 275c 6e27 5d29 290d  *6+14) ,'\n'])).
+000105d0: 0a20 2020 2020 2020 2065 6c73 6520 3a77  .        else :w
+000105e0: 7269 7465 5f70 726f 6669 6c65 5f6c 696e  rite_profile_lin
+000105f0: 6573 2e61 7070 656e 6428 2727 2e6a 6f69  es.append(''.joi
+00010600: 6e28 5b27 5c6e 272c 2027 2b27 2a28 3132  n(['\n', '+'*(12
+00010610: 2a35 2b31 3429 2c27 5c6e 275d 2929 0d0a  *5+14),'\n']))..
+00010620: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00010630: 2020 0d0a 2020 2020 2020 2020 666f 7220    ..        for 
+00010640: 6969 2020 696e 2072 616e 6765 2873 656c  ii  in range(sel
+00010650: 662e 6561 7374 2e73 697a 6529 3a20 0d0a  f.east.size): ..
+00010660: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00010670: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+00010680: 7072 6f66 696c 655f 6c69 6e65 732e 6170  profile_lines.ap
+00010690: 7065 6e64 2827 272e 6a6f 696e 280d 0a20  pend(''.join(.. 
+000106a0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+000106b0: 277b 3a3c 357d 272e 666f 726d 6174 2873  '{:<5}'.format(s
+000106c0: 746e 4e61 6d65 735b 6969 5d29 2c20 0d0a  tnNames[ii]), ..
+000106d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000106e0: 277b 3a3c 377d 272e 666f 726d 6174 286e  '{:<7}'.format(n
+000106f0: 6f72 6d61 6c69 7a65 5f64 6973 7461 6e63  ormalize_distanc
+00010700: 655b 6969 5d29 2c0d 0a20 2020 2020 2020  e[ii]),..       
+00010710: 2020 2020 2020 2020 2027 7b3a 3c31 312e           '{:<11.
+00010720: 3266 7d27 2e66 6f72 6d61 7428 7365 6c66  2f}'.format(self
+00010730: 2e65 6173 745b 6969 5d29 2c0d 0a20 2020  .east[ii]),..   
+00010740: 2020 2020 2020 2020 2020 2020 2027 7b3a               '{:
+00010750: 3c31 332e 3266 7d27 2e66 6f72 6d61 7428  <13.2f}'.format(
+00010760: 7365 6c66 2e6e 6f72 7468 5b69 695d 292c  self.north[ii]),
+00010770: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00010780: 2020 2027 7b3a 3c31 352e 3130 667d 272e     '{:<15.10f}'.
+00010790: 666f 726d 6174 2873 656c 662e 6c61 745b  format(self.lat[
+000107a0: 6969 5d29 2c20 0d0a 2020 2020 2020 2020  ii]), ..        
+000107b0: 2020 2020 2020 2020 277b 3a3c 3137 2e31          '{:<17.1
+000107c0: 3066 7d27 2e66 6f72 6d61 7428 7365 6c66  0f}'.format(self
+000107d0: 2e6c 6f6e 5b69 695d 292c 200d 0a20 2020  .lon[ii]), ..   
+000107e0: 2020 2020 2020 2020 2020 2020 2027 7b3a               '{:
+000107f0: 3c31 302e 3266 7d27 2e66 6f72 6d61 7428  <10.2f}'.format(
+00010800: 7365 6c66 2e65 6c65 765b 6969 5d29 0d0a  self.elev[ii])..
+00010810: 2020 2020 2020 2020 2020 2020 5d29 290d              ])).
+00010820: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00010830: 6164 645f 617a 696d 7574 6820 6973 2054  add_azimuth is T
+00010840: 7275 6520 3a20 0d0a 2020 2020 2020 2020  rue : ..        
+00010850: 2020 2020 2020 2020 7772 6974 655f 7072          write_pr
+00010860: 6f66 696c 655f 6c69 6e65 732e 6170 7065  ofile_lines.appe
+00010870: 6e64 2827 7b30 3a3c 372e 3366 7d27 2e66  nd('{0:<7.3f}'.f
+00010880: 6f72 6d61 7428 617a 696d 5b69 695d 2929  ormat(azim[ii]))
+00010890: 0d0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
+000108a0: 6974 655f 7072 6f66 696c 655f 6c69 6e65  ite_profile_line
+000108b0: 732e 6170 7065 6e64 2827 5c6e 2729 0d0a  s.append('\n')..
+000108c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000108d0: 2020 7769 7468 206f 7065 6e20 2827 272e    with open (''.
+000108e0: 6a6f 696e 285b 6f75 7470 7574 5f6e 616d  join([output_nam
+000108f0: 652c 272e 7374 6e27 5d29 2c27 7727 2c20  e,'.stn']),'w', 
+00010900: 656e 636f 6469 6e67 3d27 7574 6638 2729  encoding='utf8')
+00010910: 2061 7320 6669 643a 200d 0a20 2020 2020   as fid: ..     
+00010920: 2020 2020 2020 2020 2020 2066 6964 2e77             fid.w
+00010930: 7269 7465 6c69 6e65 7328 7772 6974 655f  ritelines(write_
+00010940: 7072 6f66 696c 655f 6c69 6e65 7329 0d0a  profile_lines)..
+00010950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010960: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
+00010970: 6176 6570 6174 6820 3d20 6675 6e63 2e63  avepath = func.c
+00010980: 7061 7468 2028 7365 6c66 2e73 6176 6570  path (self.savep
+00010990: 6174 682c 200d 0a20 2020 2020 2020 2020  ath, ..         
+000109a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000109b0: 2020 2020 2020 2020 2020 2066 275f 7b73             f'_{s
+000109c0: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+000109d0: 6e61 6d65 5f5f 2e6c 6f77 6572 2829 7d5f  name__.lower()}_
+000109e0: 2729 0d0a 2020 2020 2020 2020 6966 2073  ')..        if s
+000109f0: 656c 662e 7361 7665 7061 7468 2069 7320  elf.savepath is 
+00010a00: 6e6f 7420 4e6f 6e65 203a 0d0a 2020 2020  not None :..    
+00010a10: 2020 2020 2020 2020 7368 7574 696c 2e6d          shutil.m
+00010a20: 6f76 6520 286f 732e 7061 7468 2e6a 6f69  ove (os.path.joi
+00010a30: 6e28 6f73 2e67 6574 6377 6428 292c 0d0a  n(os.getcwd(),..
+00010a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a60: 2020 2020 2020 2727 2e6a 6f69 6e28 5b6f        ''.join([o
+00010a70: 7574 7075 745f 6e61 6d65 2c27 2e73 746e  utput_name,'.stn
+00010a80: 275d 2929 2c0d 0a20 2020 2020 2020 2020  '])),..         
+00010a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010aa0: 7365 6c66 2e73 6176 6570 6174 6829 0d0a  self.savepath)..
+00010ab0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00010ac0: 2020 6465 6620 7374 6e5f 7365 7061 7261    def stn_separa
+00010ad0: 7469 6f6e 2873 656c 662c 2065 6173 7469  tion(self, easti
+00010ae0: 6e67 2020 3d4e 6f6e 6520 2c20 6e6f 7274  ng  =None , nort
+00010af0: 6869 6e67 203d 4e6f 6e65 202c 0d0a 2020  hing =None ,..  
+00010b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b10: 2020 2020 2069 6e74 6572 706f 6c61 7465       interpolate
+00010b20: 203d 4661 6c73 6529 3a20 0d0a 2020 2020   =False): ..    
+00010b30: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00010b40: 2043 6f6d 7075 7465 2074 6865 2073 7461   Compute the sta
+00010b50: 7469 6f6e 2073 6570 6172 6174 696f 6e20  tion separation 
+00010b60: 0d0a 2020 2020 2020 2020 4469 7374 616e  ..        Distan
+00010b70: 6365 2062 6574 7765 656e 2065 7665 7279  ce between every
+00010b80: 2074 776f 2073 7461 7469 6f6e 7320 0d0a   two stations ..
+00010b90: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00010ba0: 2020 5061 7261 6d65 7465 7273 200d 0a20    Parameters .. 
+00010bb0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00010bc0: 2d0d 0a20 2020 2020 2020 2020 2020 202a  -..            *
+00010bd0: 2065 6173 7469 6e67 203a 2061 7272 6179   easting : array
+00010be0: 5f6c 696b 6520 286e 6461 7272 6179 2c20  _like (ndarray, 
+00010bf0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+00010c00: 2020 2020 2020 2020 2020 2020 6561 7374              east
+00010c10: 696e 6720 636f 6f72 6469 6e61 7465 7320  ing coordinates 
+00010c20: 200d 0a20 2020 2020 2020 2020 2020 202a   ..            *
+00010c30: 206e 6f72 7468 696e 6720 3a20 6172 7261   northing : arra
+00010c40: 795f 6c69 6b65 2028 6e64 6172 7261 792c  y_like (ndarray,
+00010c50: 3129 200d 0a20 2020 2020 2020 2020 2020  1) ..           
+00010c60: 2020 2020 2020 2020 2020 2020 206e 6f72               nor
+00010c70: 7468 696e 6720 636f 6f72 6469 6e61 7465  thing coordinate
+00010c80: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
+00010c90: 2a20 696e 7465 7270 6f6c 6174 6520 3a20  * interpolate : 
+00010ca0: 626f 6f6c 200d 0a20 2020 2020 2020 2020  bool ..         
+00010cb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00010cc0: 6620 696e 7465 7270 6f6c 6174 6520 6973  f interpolate is
+00010cd0: 2054 7275 6520 2077 696c 6c20 6578 7465   True  will exte
+00010ce0: 6e64 2074 6f20 4e2b 3120 0d0a 2020 2020  nd to N+1 ..    
+00010cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d00: 2020 2020 6e75 6d62 6572 2074 6f20 6d75      number to mu
+00010d10: 6368 0d0a 2020 2020 2020 2020 2020 2020  ch..            
+00010d20: 2020 2020 2020 2020 2020 2020 6578 6361              exca
+00010d30: 746c 7920 7468 6520 6e75 6d62 6572 2020  tly the number  
+00010d40: 6f66 2065 6c65 6374 726f 6465 2e20 4966  of electrode. If
+00010d50: 2066 616c 7365 202c 0d0a 2020 2020 2020   false ,..      
+00010d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d70: 2020 6974 206d 6174 6368 2074 6865 206e    it match the n
+00010d80: 756d 6265 7220 6f66 2064 6970 6f6c 6520  umber of dipole 
+00010d90: 4e2e 0d0a 2020 2020 2020 2020 2020 2020  N...            
+00010da0: 2020 2020 2020 2020 2020 2020 2a44 6566              *Def
+00010db0: 6175 6c74 2a20 6973 2046 616c 7365 2e0d  ault* is False..
+00010dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010dd0: 200d 0a20 2020 2020 2020 2052 6574 7572   ..        Retur
+00010de0: 6e73 2020 0d0a 2020 2020 2020 2020 2d2d  ns  ..        --
+00010df0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00010e00: 2020 2020 2061 7272 6179 5f6c 696b 6520       array_like 
+00010e10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010e20: 2020 2073 6570 6172 6174 696f 6e20 7661     separation va
+00010e30: 6c75 6520 6172 7261 7920 200d 0a20 2020  lue array  ..   
+00010e40: 2020 2020 2020 2020 2020 666c 6f61 7420            float 
+00010e50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010e60: 2020 7365 7061 7261 7469 6f6e 206d 6561    separation mea
+00010e70: 6e20 206f 7220 6176 6572 6167 6520 7365  n  or average se
+00010e80: 7061 7261 7469 6f6e 2076 616c 7565 2020  paration value  
+00010e90: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00010ea0: 2020 2020 2020 2069 6620 2865 6173 7469         if (easti
+00010eb0: 6e67 2e64 7479 7065 2021 3d27 666c 6f61  ng.dtype !='floa
+00010ec0: 7427 2920 6f72 2028 6e6f 7274 6869 6e67  t') or (northing
+00010ed0: 2e64 7479 7065 2021 3d27 666c 6f61 7427  .dtype !='float'
+00010ee0: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+00010ef0: 2074 7279 203a 0d0a 2020 2020 2020 2020   try :..        
+00010f00: 2020 2020 2020 2020 6561 7374 696e 6720          easting 
+00010f10: 3d20 6e70 2e61 7272 6179 285b 666c 6f61  = np.array([floa
+00010f20: 7428 7373 2920 666f 7220 7373 2069 6e20  t(ss) for ss in 
+00010f30: 6561 7374 696e 675d 290d 0a20 2020 2020  easting])..     
+00010f40: 2020 2020 2020 2020 2020 206e 6f72 7468             north
+00010f50: 696e 6720 3d6e 702e 6172 7261 7928 5b66  ing =np.array([f
+00010f60: 6c6f 6174 2873 7329 2066 6f72 2073 7320  loat(ss) for ss 
+00010f70: 696e 206e 6f72 7468 696e 675d 290d 0a20  in northing]).. 
+00010f80: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00010f90: 7420 3a20 7261 6973 6520 5072 6f66 696c  t : raise Profil
+00010fa0: 6545 7272 6f72 280d 0a20 2020 2020 2020  eError(..       
+00010fb0: 2020 2020 2020 2020 2020 2020 2022 4e6f               "No
+00010fc0: 6e65 5479 7065 2063 616e 206e 6f74 2062  neType can not b
+00010fd0: 6520 636f 6d70 7574 6564 2e22 0d0a 2020  e computed."..  
+00010fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ff0: 2020 2250 6c65 6173 6520 7072 6f76 6964    "Please provid
+00011000: 6520 7468 6520 7269 6768 7420 636f 6f72  e the right coor
+00011010: 6469 6e61 7465 7321 2e22 290d 0a20 2020  dinates!.")..   
+00011020: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
+00011030: 6620 6561 7374 696e 672e 7369 7a65 2021  f easting.size !
+00011040: 3d20 6e6f 7274 6869 6e67 2e73 697a 6520  = northing.size 
+00011050: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00011060: 6169 7365 2050 726f 6669 6c65 4572 726f  aise ProfileErro
+00011070: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00011080: 2242 6f74 6820 636f 6f72 6469 6e61 7465  "Both coordinate
+00011090: 7320 6172 7261 7920 6d75 7374 2068 6176  s array must hav
+000110a0: 6520 7468 6520 7361 6d65 2073 697a 652e  e the same size.
+000110b0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+000110c0: 2254 6865 2066 6972 7374 2061 7267 756d  "The first argum
+000110d0: 656e 7420 7369 7a65 2069 7320 3c7b 307d  ent size is <{0}
+000110e0: 3e2c 2077 6869 6c65 2074 6865 2073 6563  >, while the sec
+000110f0: 6f6e 6420 6973 203c 7b31 7d3e 2e22 2e0d  ond is <{1}>."..
+00011100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011110: 2020 666f 726d 6174 2865 6173 7469 6e67    format(easting
+00011120: 2e73 697a 652c 206e 6f72 7468 696e 672e  .size, northing.
+00011130: 7369 7a65 2929 0d0a 2020 2020 2020 2020  size))..        
+00011140: 2320 666f 7220 6b6b 2069 6e20 7261 6e67  # for kk in rang
+00011150: 6528 7365 6c66 2e65 6173 742e 7369 7a65  e(self.east.size
+00011160: 293a 200d 0a20 2020 2020 2020 2023 2020  ): ..        #  
+00011170: 2020 2069 6620 6b6b 203c 3d73 656c 662e     if kk <=self.
+00011180: 6561 7374 2e73 697a 6520 2d32 203a 200d  east.size -2 : .
+00011190: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
+000111a0: 2020 206e 702e 7371 7274 2828 7365 6c66     np.sqrt((self
+000111b0: 2e65 6173 745b 6b6b 2b31 5d2d 7365 6c66  .east[kk+1]-self
+000111c0: 2e65 6173 745b 6b6b 2d31 5d29 2a2a 3220  .east[kk-1])**2 
+000111d0: 2b0d 0a20 2020 2020 2020 2023 2028 7365  +..        # (se
+000111e0: 6c66 2e6e 6f72 7468 5b6b 6b2b 315d 2d73  lf.north[kk+1]-s
+000111f0: 656c 662e 6e6f 7274 685b 6b6b 2d31 5d29  elf.north[kk-1])
+00011200: 2a2a 3229 0d0a 2020 2020 2020 2020 7374  **2)..        st
+00011210: 6e5f 7365 7020 3d6e 702e 6172 7261 7928  n_sep =np.array(
+00011220: 5b6e 702e 7371 7274 2828 6561 7374 696e  [np.sqrt((eastin
+00011230: 675b 6b6b 2b31 5d2d 6561 7374 696e 675b  g[kk+1]-easting[
+00011240: 6b6b 5d29 2a2a 3220 2b20 280d 0a20 2020  kk])**2 + (..   
+00011250: 2020 2020 2020 2020 206e 6f72 7468 696e           northin
+00011260: 675b 6b6b 2b31 5d2d 6e6f 7274 6869 6e67  g[kk+1]-northing
+00011270: 5b6b 6b5d 292a 2a32 2920 666f 7220 0d0a  [kk])**2) for ..
+00011280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011290: 2020 2020 2020 2020 2020 206b 6b20 696e             kk in
+000112a0: 2072 616e 6765 2028 6e6f 7274 6869 6e67   range (northing
+000112b0: 2e73 697a 6529 2069 660d 0a20 2020 2020  .size) if..     
+000112c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000112d0: 2020 2020 2020 6b6b 203c 3d6e 6f72 7468        kk <=north
+000112e0: 696e 672e 7369 7a65 202d 325d 290d 0a0d  ing.size -2])...
+000112f0: 0a20 2020 2020 2020 2069 6620 696e 7465  .        if inte
+00011300: 7270 6f6c 6174 6520 6973 2054 7275 6520  rpolate is True 
+00011310: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00011320: 7878 202c 2078 785f 6e65 7720 3d20 6e70  xx , xx_new = np
+00011330: 2e61 7261 6e67 6528 7374 6e5f 7365 702e  .arange(stn_sep.
+00011340: 7369 7a65 292c 6e70 2e61 7261 6e67 6528  size),np.arange(
+00011350: 7374 6e5f 7365 702e 7369 7a65 202b 3129  stn_sep.size +1)
+00011360: 200d 0a20 2020 2020 2020 2020 2020 2066   ..            f
+00011370: 6620 3d20 7370 2e69 6e74 6572 706f 6c61  f = sp.interpola
+00011380: 7465 2e69 6e74 6572 7031 6428 7878 2c20  te.interp1d(xx, 
+00011390: 7374 6e5f 7365 702c 2066 696c 6c5f 7661  stn_sep, fill_va
+000113a0: 6c75 653d 2765 7874 7261 706f 6c61 7465  lue='extrapolate
+000113b0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+000113c0: 7374 6e5f 7365 703d 2066 6628 7878 5f6e  stn_sep= ff(xx_n
+000113d0: 6577 290d 0a0d 0a20 2020 2020 2020 2072  ew)....        r
+000113e0: 6574 7572 6e20 7374 6e5f 7365 7020 2c20  eturn stn_sep , 
+000113f0: 7374 6e5f 7365 702e 6d65 616e 2829 0d0a  stn_sep.mean()..
+00011400: 2020 2020 0d0a 2020 2020 4073 7461 7469      ..    @stati
+00011410: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
+00011420: 2063 6f6d 7075 7465 5f64 6970 6f6c 656c   compute_dipolel
+00011430: 656e 6774 685f 6672 6f6d 5f63 6f6f 7264  ength_from_coord
+00011440: 7328 6561 7374 696e 673d 4e6f 6e65 2c20  s(easting=None, 
+00011450: 6e6f 7274 6869 6e67 3d4e 6f6e 652c 0d0a  northing=None,..
+00011460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011480: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+00011490: 7329 3a20 0d0a 2020 2020 2020 2020 2222  s): ..        ""
+000114a0: 220d 0a20 2020 2020 2020 2046 6f6e 6374  "..        Fonct
+000114b0: 696f 6e20 746f 2063 6f6d 7075 7465 2064  ion to compute d
+000114c0: 6970 6f6c 6520 6c65 6e67 7468 2066 726f  ipole length fro
+000114d0: 6d20 636f 6f72 6469 6e61 7465 7320 6561  m coordinates ea
+000114e0: 7374 696e 6720 0d0a 2020 2020 2020 2020  sting ..        
+000114f0: 616e 6420 6e6f 7274 6869 6e67 2076 616c  and northing val
+00011500: 7565 732e 0d0a 2020 2020 2020 2020 0d0a  ues...        ..
+00011510: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
+00011520: 6173 7469 6e67 3a20 6172 7261 7920 6f66  asting: array of
+00011530: 2065 6173 7469 6e67 2063 6f6f 7264 696e   easting coordin
+00011540: 6174 6520 696e 206d 6574 6572 730d 0a20  ate in meters.. 
+00011550: 2020 2020 2020 203a 7479 7065 2065 6173         :type eas
+00011560: 7469 6e67 3a20 6172 7261 795f 6c69 6b65  ting: array_like
+00011570: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00011580: 2020 200d 0a20 2020 2020 2020 203a 7061     ..        :pa
+00011590: 7261 6d20 6e6f 7274 6869 6e67 3a20 6172  ram northing: ar
+000115a0: 7261 7920 6f66 206e 6f72 7468 696e 6720  ray of northing 
+000115b0: 636f 6f72 6469 6e61 7465 2069 6e20 6d65  coordinate in me
+000115c0: 7465 7273 0d0a 2020 2020 2020 2020 3a74  ters..        :t
+000115d0: 7970 6520 6e6f 7274 6869 6e67 3a20 2061  ype northing:  a
+000115e0: 7272 6179 5f6c 696b 6520 0d0a 2020 2020  rray_like ..    
+000115f0: 2020 2020 0d0a 2020 2020 2020 2020 3a70      ..        :p
+00011600: 6172 616d 206c 6174 3a20 206c 6174 6974  aram lat:  latit
+00011610: 7564 6520 636f 6f72 6469 6e61 7465 2020  ude coordinate  
+00011620: 696e 2064 6567 7265 6520 0d0a 2020 2020  in degree ..    
+00011630: 2020 2020 3a74 7970 6520 6c61 743a 2061      :type lat: a
+00011640: 7272 6179 5f6c 696b 6520 286e 6461 7272  rray_like (ndarr
+00011650: 6179 2c31 2920 0d0a 2020 2020 2020 2020  ay,1) ..        
+00011660: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00011670: 203a 7061 7261 6d20 6c6f 6e3a 206c 6f6e   :param lon: lon
+00011680: 6769 7475 6465 2063 6f6f 7264 696e 6174  gitude coordinat
+00011690: 6520 2069 6e20 6465 6772 6565 200d 0a20  e  in degree .. 
+000116a0: 2020 2020 2020 203a 7479 7065 206c 6f6e         :type lon
+000116b0: 3a20 6172 7261 795f 6c69 6b65 2028 6e64  : array_like (nd
+000116c0: 6172 7261 792c 3129 200d 0a20 2020 2020  array,1) ..     
+000116d0: 2020 200d 0a20 2020 2020 2020 203a 7061     ..        :pa
+000116e0: 7261 6d20 7265 6665 7265 6e63 655f 656c  ram reference_el
+000116f0: 6c69 7073 6f69 643a 2069 642c 2045 6c6c  lipsoid: id, Ell
+00011700: 6970 736f 6964 206e 616d 652c 0d0a 2020  ipsoid name,..  
+00011710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011720: 2020 2020 2020 2020 2020 2020 2020 4571                Eq
+00011730: 7561 746f 7269 616c 2052 6164 6975 732c  uatorial Radius,
+00011740: 2073 7175 6172 6520 6f66 200d 0a20 2020   square of ..   
+00011750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011760: 2020 2020 2020 2020 2020 2020 2065 6363               ecc
+00011770: 656e 7472 6963 6974 7920 2c64 6566 6175  entricity ,defau
+00011780: 6c74 2069 7320 3233 200d 0a20 2020 2020  lt is 23 ..     
+00011790: 2020 203a 7479 7065 2072 6566 6572 656e     :type referen
+000117a0: 6365 5f65 6c6c 6970 736f 6964 3a20 696e  ce_ellipsoid: in
+000117b0: 7420 0d0a 2020 2020 2020 2020 0d0a 2020  t ..        ..  
+000117c0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+000117d0: 6c65 6e67 7468 206f 6620 6469 706f 6c65  length of dipole
+000117e0: 2064 7572 696e 6720 7375 7276 6579 2061   during survey a
+000117f0: 7070 726f 7869 6d61 7465 6420 2e20 0d0a  pproximated . ..
+00011800: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
+00011810: 666c 6f61 7420 0d0a 2020 2020 2020 2020  float ..        
+00011820: 200d 0a20 2020 2020 2020 203a 7265 7475   ..        :retu
+00011830: 726e 733a 2020 706f 7369 7469 6f6e 206f  rns:  position o
+00011840: 6620 6469 706f 6c65 2066 726f 6d20 7265  f dipole from re
+00011850: 6665 7265 6e63 6520 7374 6174 696f 6e20  ference station 
+00011860: 200d 0a20 2020 2020 2020 203a 7274 7970   ..        :rtyp
+00011870: 653a 2061 7272 6179 5f6c 696b 6528 6e64  e: array_like(nd
+00011880: 6172 7261 792c 3129 0d0a 2020 2020 2020  array,1)..      
+00011890: 2020 0d0a 2020 2020 2020 2020 2e2e 206e    ..        .. n
+000118a0: 6f74 653a 3a20 7468 6520 6669 7273 7420  ote:: the first 
+000118b0: 656c 6563 7472 6f64 6520 6973 206c 6f63  electrode is loc
+000118c0: 6174 6564 2061 7420 3020 616e 6420 7365  ated at 0 and se
+000118d0: 636f 6e64 2065 6c65 6374 726f 6465 2074  cond electrode t
+000118e0: 6f20 0d0a 2020 2020 2020 2020 2020 2020  o ..            
+000118f0: 2020 2020 2064 6970 6f6c 6520 6c65 6e67       dipole leng
+00011900: 7468 2069 2e65 205b 302c 2035 3020 2c20  th i.e [0, 50 , 
+00011910: 2e2e 2e2c 206e 6e2a 3530 5d20 7768 6572  ..., nn*50] wher
+00011920: 6520 6e6e 206e 756d 6265 7220 0d0a 2020  e nn number ..  
+00011930: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00011940: 6620 706f 696e 7420 2d31 2e20 4461 7461  f point -1. Data
+00011950: 2061 7265 2072 656c 6f63 6174 6564 2069   are relocated i
+00011960: 6e20 6365 6e74 6572 2070 6f73 6974 696f  n center positio
+00011970: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+00011980: 2020 2020 6f66 2064 6970 6f6c 652e 0d0a      of dipole...
+00011990: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+000119a0: 2020 2020 206c 6174 6974 7564 6520 3d6b       latitude =k
+000119b0: 7761 7267 732e 706f 7028 276c 6174 6974  wargs.pop('latit
+000119c0: 7564 6527 2c20 4e6f 6e65 2029 0d0a 2020  ude', None )..  
+000119d0: 2020 2020 2020 6c6f 6e67 6974 7564 6520        longitude 
+000119e0: 3d6b 7761 7267 732e 706f 7028 276c 6f6e  =kwargs.pop('lon
+000119f0: 6769 7475 6465 272c 204e 6f6e 6529 0d0a  gitude', None)..
+00011a00: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00011a10: 2020 7265 6665 7265 6e63 655f 656c 6c69    reference_elli
+00011a20: 7073 6f69 6420 3d6b 7761 7267 732e 706f  psoid =kwargs.po
+00011a30: 7028 2772 6566 6572 656e 6365 5f65 6c6c  p('reference_ell
+00011a40: 6970 736f 6964 272c 2032 3329 0d0a 2020  ipsoid', 23)..  
+00011a50: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00011a60: 6966 2065 6173 7469 6e67 2069 7320 6e6f  if easting is no
+00011a70: 7420 204e 6f6e 6520 2061 6e64 206e 6f72  t  None  and nor
+00011a80: 7468 696e 6720 6973 206e 6f74 204e 6f6e  thing is not Non
+00011a90: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
+00011aa0: 2020 6173 7365 7274 2065 6173 7469 6e67    assert easting
+00011ab0: 2e73 697a 6520 3d3d 206e 6f72 7468 696e  .size == northin
+00011ac0: 672e 7369 7a65 202c 2050 726f 6669 6c65  g.size , Profile
+00011ad0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00011ae0: 2020 2020 2020 2020 2745 6173 7469 6e67          'Easting
+00011af0: 2061 6e64 204e 6f72 7468 696e 6720 6d75   and Northing mu
+00011b00: 7374 2068 6176 6520 7468 6520 7361 6d65  st have the same
+00011b10: 2073 697a 652e 270d 0a20 2020 2020 2020   size.'..       
+00011b20: 2020 2020 2020 2020 2027 2045 6173 7469           ' Easti
+00011b30: 6e67 7c6e 6f72 7468 696e 6720 7369 7a65  ng|northing size
+00011b40: 2061 7265 2063 7572 7265 6e74 6c79 7369   are currentlysi
+00011b50: 7a65 2069 7320 3c7b 307d 7c7b 317d 3e2e  ze is <{0}|{1}>.
+00011b60: 272e 5c0d 0a20 2020 2020 2020 2020 2020  '.\..           
+00011b70: 2020 2020 2020 2020 2066 6f72 6d61 7428           format(
+00011b80: 6561 7374 696e 672e 7369 7a65 2c20 6e6f  easting.size, no
+00011b90: 7274 6869 6e67 2e73 697a 6529 290d 0a0d  rthing.size))...
+00011ba0: 0a20 2020 2020 2020 2065 6c69 6620 6c61  .        elif la
+00011bb0: 7469 7475 6465 2069 7320 6e6f 7420 4e6f  titude is not No
+00011bc0: 6e65 2061 6e64 206c 6f6e 6769 7475 6465  ne and longitude
+00011bd0: 2069 7320 6e6f 7420 4e6f 6e65 203a 200d   is not None : .
+00011be0: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+00011bf0: 6572 7420 6c61 7469 7475 6465 2e73 697a  ert latitude.siz
+00011c00: 6520 3d3d 206c 6f6e 6769 7475 6465 2e73  e == longitude.s
+00011c10: 697a 6520 2c20 5c0d 0a20 2020 2020 2020  ize , \..       
+00011c20: 2020 2020 2020 2020 2050 726f 6669 6c65           Profile
+00011c30: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00011c40: 2020 2020 2020 2020 2020 2020 274c 6174              'Lat
+00011c50: 6974 7564 6520 616e 6420 6c6f 6e67 6974  itude and longit
+00011c60: 7564 6520 6d75 7374 2068 6176 6520 7468  ude must have th
+00011c70: 6520 7361 6d65 2073 697a 652e 270d 0a20  e same size.'.. 
+00011c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c90: 2020 2027 2045 6173 7469 6e67 7c6e 6f72     ' Easting|nor
+00011ca0: 7468 696e 6720 7369 7a65 2061 7265 2063  thing size are c
+00011cb0: 7572 7265 6e74 6c79 7369 7a65 270d 0a20  urrentlysize'.. 
+00011cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011cd0: 2020 2020 2020 2027 2069 7320 3c7b 307d         ' is <{0}
+00011ce0: 7c7b 317d 3e2e 272e 666f 726d 6174 2865  |{1}>.'.format(e
+00011cf0: 6173 7469 6e67 2e73 697a 652c 200d 0a20  asting.size, .. 
+00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d20: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00011d30: 6f72 7468 696e 672e 7369 7a65 2929 0d0a  orthing.size))..
+00011d40: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00011d50: 2020 2020 2020 2020 2020 232d 2d20 636f            #-- co
+00011d60: 6e76 6572 7420 6c61 7420 6c6f 6e20 746f  nvert lat lon to
+00011d70: 2065 6173 7469 6e67 206e 6f72 7468 696e   easting northin
+00011d80: 6720 0d0a 2020 2020 2020 2020 2020 2020  g ..            
+00011d90: 7574 6d5f 7a6f 6e65 202c 2065 6173 7469  utm_zone , easti
+00011da0: 6e67 2c20 6e6f 7274 6869 6e67 203d 2067  ng, northing = g
+00011db0: 6973 2e6c 6c5f 746f 5f75 746d 2872 6566  is.ll_to_utm(ref
+00011dc0: 6572 656e 6365 5f65 6c6c 6970 736f 6964  erence_ellipsoid
+00011dd0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00011de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e00: 2020 2020 2020 2020 2020 2020 6c61 7469              lati
+00011e10: 7475 6465 2c20 6c6f 6e67 6974 7564 6529  tude, longitude)
+00011e20: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+00011e30: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+00011e40: 6169 7365 2050 726f 6669 6c65 4572 726f  aise ProfileErro
+00011e50: 7228 274d 6179 2069 6e70 7574 2061 7420  r('May input at 
+00011e60: 6c65 6173 7420 6561 7374 696e 6720 616e  least easting an
+00011e70: 6420 270d 0a20 2020 2020 2020 2020 2020  d '..           
 00011e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00011e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ea0: 2020 2020 2020 2020 2020 6e6f 7274 6869            northi
-00011eb0: 6e67 2e73 697a 6529 290d 0a20 2020 2020  ng.size))..     
-00011ec0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00011ed0: 2020 2020 2023 2d2d 2063 6f6e 7665 7274       #-- convert
-00011ee0: 206c 6174 206c 6f6e 2074 6f20 6561 7374   lat lon to east
-00011ef0: 696e 6720 6e6f 7274 6869 6e67 200d 0a20  ing northing .. 
-00011f00: 2020 2020 2020 2020 2020 2075 746d 5f7a             utm_z
-00011f10: 6f6e 6520 2c20 6561 7374 696e 672c 206e  one , easting, n
-00011f20: 6f72 7468 696e 6720 3d20 6769 732e 6c6c  orthing = gis.ll
-00011f30: 5f74 6f5f 7574 6d28 7265 6665 7265 6e63  _to_utm(referenc
-00011f40: 655f 656c 6c69 7073 6f69 642c 0d0a 2020  e_ellipsoid,..  
-00011f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ea0: 2027 6e6f 7274 6869 6e67 2063 6f6f 7264   'northing coord
+00011eb0: 696e 6174 6573 2076 616c 7565 7320 6f72  inates values or
+00011ec0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+00011ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ee0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00011ef0: 206c 6174 6974 7564 6520 616e 6420 6c6f   latitude and lo
+00011f00: 6e67 6974 7564 6520 7661 6c75 6573 2e27  ngitude values.'
+00011f10: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+00011f20: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00011f30: 2020 2020 2020 2064 6973 7461 6e63 655f         distance_
+00011f40: 6561 7374 203d 206e 702e 6172 7261 7928  east = np.array(
+00011f50: 5b65 6173 7469 6e67 5b6b 6b2b 315d 2d65  [easting[kk+1]-e
+00011f60: 6173 7469 6e67 5b6b 6b5d 200d 0a20 2020  asting[kk] ..   
 00011f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f80: 2020 2020 2020 206c 6174 6974 7564 652c         latitude,
-00011f90: 206c 6f6e 6769 7475 6465 290d 0a20 2020   longitude)..   
-00011fa0: 2020 2020 2065 6c73 6520 3a20 0d0a 2020       else : ..  
-00011fb0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00011fc0: 4353 6578 2e70 7943 5341 4d54 4572 726f  CSex.pyCSAMTErro
-00011fd0: 725f 7072 6f66 696c 6528 274d 6179 2069  r_profile('May i
-00011fe0: 6e70 7574 2061 7420 6c65 6173 7420 6561  nput at least ea
-00011ff0: 7374 696e 6720 616e 6420 270d 0a20 2020  sting and '..   
+00011f80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00011f90: 6f72 206b 6b20 696e 2072 616e 6765 2028  or kk in range (
+00011fa0: 6561 7374 696e 672e 7369 7a65 202d 3129  easting.size -1)
+00011fb0: 5d29 0d0a 2020 2020 2020 2020 6469 7374  ])..        dist
+00011fc0: 616e 6365 5f6e 6f72 7468 203d 206e 702e  ance_north = np.
+00011fd0: 6172 7261 7928 5b6e 6f72 7468 696e 675b  array([northing[
+00011fe0: 6b6b 2b31 5d2d 6e6f 7274 6869 6e67 5b6b  kk+1]-northing[k
+00011ff0: 6b5d 200d 0a20 2020 2020 2020 2020 2020  k] ..           
 00012000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012020: 2020 2020 2020 2020 2027 6e6f 7274 6869           'northi
-00012030: 6e67 2063 6f6f 7264 696e 6174 6573 2076  ng coordinates v
-00012040: 616c 7565 7320 6f72 270d 0a20 2020 2020  alues or'..     
-00012050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012070: 2020 2020 2020 2027 206c 6174 6974 7564         ' latitud
-00012080: 6520 616e 6420 6c6f 6e67 6974 7564 6520  e and longitude 
-00012090: 7661 6c75 6573 2e27 290d 0a20 2020 2020  values.')..     
-000120a0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000120b0: 2020 2020 200d 0a20 2020 2020 2020 2064       ..        d
-000120c0: 6973 7461 6e63 655f 6561 7374 203d 206e  istance_east = n
-000120d0: 702e 6172 7261 7928 5b65 6173 7469 6e67  p.array([easting
-000120e0: 5b6b 6b2b 315d 2d65 6173 7469 6e67 5b6b  [kk+1]-easting[k
-000120f0: 6b5d 200d 0a20 2020 2020 2020 2020 2020  k] ..           
-00012100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012110: 2020 2020 2020 2066 6f72 206b 6b20 696e         for kk in
-00012120: 2072 616e 6765 2028 6561 7374 696e 672e   range (easting.
-00012130: 7369 7a65 202d 3129 5d29 0d0a 2020 2020  size -1)])..    
-00012140: 2020 2020 6469 7374 616e 6365 5f6e 6f72      distance_nor
-00012150: 7468 203d 206e 702e 6172 7261 7928 5b6e  th = np.array([n
-00012160: 6f72 7468 696e 675b 6b6b 2b31 5d2d 6e6f  orthing[kk+1]-no
-00012170: 7274 6869 6e67 5b6b 6b5d 200d 0a20 2020  rthing[kk] ..   
-00012180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121a0: 666f 7220 6b6b 2069 6e20 7261 6e67 6520  for kk in range 
-000121b0: 286e 6f72 7468 696e 672e 7369 7a65 202d  (northing.size -
-000121c0: 3129 5d29 0d0a 2020 2020 2020 2020 0d0a  1)])..        ..
-000121d0: 2020 2020 2020 2020 6469 7374 616e 6365          distance
-000121e0: 203d 206e 702e 6172 7261 7928 5b6e 702e   = np.array([np.
-000121f0: 7371 7274 280d 0a20 2020 2020 2020 2020  sqrt(..         
-00012200: 2020 2064 6973 7461 6e63 655f 6561 7374     distance_east
-00012210: 5b6b 6b5d 2a2a 3220 2b20 6469 7374 616e  [kk]**2 + distan
-00012220: 6365 5f6e 6f72 7468 5b6b 6b5d 2a2a 3229  ce_north[kk]**2)
-00012230: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012240: 2066 6f72 206b 6b20 696e 2072 616e 6765   for kk in range
-00012250: 2864 6973 7461 6e63 655f 6561 7374 2e73  (distance_east.s
-00012260: 697a 6529 205d 290d 0a20 2020 2020 2020  ize) ])..       
-00012270: 2064 6970 6f6c 655f 6c65 6e67 7468 203d   dipole_length =
-00012280: 6366 756e 632e 726f 756e 645f 6469 706f  cfunc.round_dipo
-00012290: 6c65 5f6c 656e 6774 6828 6469 7374 616e  le_length(distan
-000122a0: 6365 2e6d 6561 6e28 2929 200d 0a20 2020  ce.mean()) ..   
-000122b0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
-000122c0: 6275 696c 6420 7374 6e5f 706b 5f70 6f73  build stn_pk_pos
-000122d0: 6974 696f 6e20 3a20 0d0a 2020 2020 2020  ition : ..      
-000122e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000122f0: 7374 6e5f 706b 203d 206e 702e 6172 7261  stn_pk = np.arra
-00012300: 7928 5b20 6969 2a20 6e70 2e66 756c 6c28  y([ ii* np.full(
-00012310: 2865 6173 7469 6e67 2e73 697a 6529 2c0d  (easting.size),.
-00012320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012340: 2020 2020 2020 2020 2064 6970 6f6c 655f           dipole_
-00012350: 6c65 6e67 7468 295b 6969 5d0d 0a20 2020  length)[ii]..   
-00012360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012370: 2020 2020 2020 2020 666f 7220 6969 2069          for ii i
-00012380: 6e20 7261 6e67 6528 6e70 2e66 756c 6c28  n range(np.full(
-00012390: 2865 6173 7469 6e67 2e73 697a 6529 2c0d  (easting.size),.
-000123a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000123b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123d0: 2020 2020 6469 706f 6c65 5f6c 656e 6774      dipole_lengt
-000123e0: 6829 2e73 697a 6529 5d29 0d0a 0d0a 2020  h).size)])....  
-000123f0: 2020 2020 2020 7265 7475 726e 2064 6970        return dip
-00012400: 6f6c 655f 6c65 6e67 7468 202c 2073 746e  ole_length , stn
-00012410: 5f70 6b20 2020 200d 0a                   _pk    ..
+00012010: 2020 2020 2020 2020 666f 7220 6b6b 2069          for kk i
+00012020: 6e20 7261 6e67 6520 286e 6f72 7468 696e  n range (northin
+00012030: 672e 7369 7a65 202d 3129 5d29 0d0a 2020  g.size -1)])..  
+00012040: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00012050: 6469 7374 616e 6365 203d 206e 702e 6172  distance = np.ar
+00012060: 7261 7928 5b6e 702e 7371 7274 280d 0a20  ray([np.sqrt(.. 
+00012070: 2020 2020 2020 2020 2020 2064 6973 7461             dista
+00012080: 6e63 655f 6561 7374 5b6b 6b5d 2a2a 3220  nce_east[kk]**2 
+00012090: 2b20 6469 7374 616e 6365 5f6e 6f72 7468  + distance_north
+000120a0: 5b6b 6b5d 2a2a 3229 0d0a 2020 2020 2020  [kk]**2)..      
+000120b0: 2020 2020 2020 2020 2066 6f72 206b 6b20           for kk 
+000120c0: 696e 2072 616e 6765 2864 6973 7461 6e63  in range(distanc
+000120d0: 655f 6561 7374 2e73 697a 6529 205d 290d  e_east.size) ]).
+000120e0: 0a20 2020 2020 2020 2064 6970 6f6c 655f  .        dipole_
+000120f0: 6c65 6e67 7468 203d 6366 756e 632e 726f  length =cfunc.ro
+00012100: 756e 645f 6469 706f 6c65 5f6c 656e 6774  und_dipole_lengt
+00012110: 6828 6469 7374 616e 6365 2e6d 6561 6e28  h(distance.mean(
+00012120: 2929 200d 0a20 2020 2020 2020 200d 0a20  )) ..        .. 
+00012130: 2020 2020 2020 2023 6275 696c 6420 7374         #build st
+00012140: 6e5f 706b 5f70 6f73 6974 696f 6e20 3a20  n_pk_position : 
+00012150: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00012160: 2020 2020 2020 2020 7374 6e5f 706b 203d          stn_pk =
+00012170: 206e 702e 6172 7261 7928 5b20 6969 2a20   np.array([ ii* 
+00012180: 6e70 2e66 756c 6c28 2865 6173 7469 6e67  np.full((easting
+00012190: 2e73 697a 6529 2c0d 0a20 2020 2020 2020  .size),..       
+000121a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121c0: 2064 6970 6f6c 655f 6c65 6e67 7468 295b   dipole_length)[
+000121d0: 6969 5d0d 0a20 2020 2020 2020 2020 2020  ii]..           
+000121e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121f0: 666f 7220 6969 2069 6e20 7261 6e67 6528  for ii in range(
+00012200: 6e70 2e66 756c 6c28 2865 6173 7469 6e67  np.full((easting
+00012210: 2e73 697a 6529 2c0d 0a20 2020 2020 2020  .size),..       
+00012220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012240: 2020 2020 2020 2020 2020 2020 6469 706f              dipo
+00012250: 6c65 5f6c 656e 6774 6829 2e73 697a 6529  le_length).size)
+00012260: 5d29 0d0a 0d0a 2020 2020 2020 2020 7265  ])....        re
+00012270: 7475 726e 2064 6970 6f6c 655f 6c65 6e67  turn dipole_leng
+00012280: 7468 202c 2073 746e 5f70 6b20 2020 200d  th , stn_pk    .
+00012290: 0a                                       .
```

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/_dictapp.py` & `pycsamt-1.2.1/pycsamt/geodrill/_dictapp.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/_geocodes/AGSO.csv` & `pycsamt-1.2.1/pycsamt/geodrill/_geocodes/AGSO.csv`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/_geocodes/__memory.pkl` & `pycsamt-1.2.1/pycsamt/geodrill/_geocodes/__memory.pkl`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/_geomemo/__m.sq3` & `pycsamt-1.2.1/pycsamt/geodrill/_geomemo/__m.sq3`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/_geomemo/memory.sq3` & `pycsamt-1.2.1/pycsamt/geodrill/_geomemo/memory.sq3`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/geocore.py` & `pycsamt-1.2.1/pycsamt/geodrill/geocore.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,45 +1,49 @@
 # -*- coding: utf-8 -*-
 #       Create:on Sat Sep 19 12:37:42 2020
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
 #       Licence: LGPL
 """  
-.. _module-geocore::`pycsamt.geodrill.geocore`
-    
-:synopsis:  Module deals with Occam2D inversion files, the geological data, 
-            the geological structural infos and borehole data. Can plot the 
-            stratigraphy model and pseudostratigraphic logs under each station.
-            Module can also build borehole data from drillings data collected 
-            in exploration area or to create a report of survey location 
-            with strata in oder to includes them combined with a conventional
-            geological codes < USGS(US Geological Survey ), pattern and colors
-            for plotting purposes or else.
+Module Geocore 
+===============
+Module deals with Occam2D inversion files, the geological data, the geological 
+structural infos and borehole data. Can plot the stratigraphy model and 
+pseudostratigraphic logs under each station. Module can also build borehole
+data collected in exploration area. It also generates a report of each geological 
+structure colllected on survey area and compare it with its corresponding 
+into a conventional geological codes < USGS(US Geological Survey ), pattern and colors
+for plotting purposes or else. This is usefull for module `GeoStratigraphic_`
+for topping 'fake' or 'unknow' structures into a pseudostratigraphic model.
+  
             ...
 """
 from __future__ import division 
 import os 
 import copy 
 import warnings
 import datetime
 import numpy as np 
 import pandas as pd 
 
 import pycsamt.bases as BS
-import pycsamt.utils.exceptions as CSex
 import pycsamt.utils.geo_utils as GU
 import pycsamt.geodrill.structural as STRL
+from pycsamt.geodrill.geodatabase import GeoDataBase 
 from pycsamt.modeling import occam2d
-from pycsamt.ff.site import Profile
+from pycsamt.site import Profile
 from pycsamt.utils import func_utils as func
 from pycsamt.utils import plot_utils as punc
-from pycsamt.utils.plotdecorator  import geoplot2d
-from pycsamt.geodrill.geodatabase import GeoDataBase 
-
+from pycsamt.utils.plotdecorator import geoplot2d
+from  pycsamt.utils.exceptions import ( 
+	GeoError, 
+	FileHanglingError, 
+	GeoMemoryError
+) 
 try : 
-    from pycsamt.utils._csamtpylog import csamtpylog
+    from pycsamt._csamtpylog import csamtpylog
     _logger=csamtpylog.get_csamtpy_logger(__name__)
 except :
     pass
 
 try : 
       import scipy 
       import scipy.stats as spSTAT
@@ -384,20 +388,20 @@
             if self.bln_fn is None : 
                 mess =''.join(['No (*bln) station file found. Need sites',
                                ' names and sites locations.',
                                ' Use mode "Iter2Dat"  :',
                                '<from pycsamt.modeling.occam2d import Iter2Dat>',
                                ' : to write a *bln file ', 
                                ' use a Profile module :',
-                               ' < from pycsamt.ff.core.cs import Profile > .', 
+                               ' < from pycsamt.core.cs import Profile > .', 
                                ' You can also use occam2D output files ',
                                'like model, mesh, data, and iteration files.'])
                 warnings.warn('! Error reading *.bln flile !' + mess)
                 self._logging.error(mess)
-                raise CSex.pyCSAMTError_geodrill_inputarguments(
+                raise GeoError(
                     '! Error reading *.bln flile ! No (*bln) station file found.'
                      ' Need sites names and sites locations.')
             i2d_obj = occam2d.Iter2Dat(iter2dat_fn=self.iter2dat_fn,
                                        bln_fn = self.bln_fn)
 
             self.model_x_nodes= i2d_obj.model_x_nodes
             self.model_z_nodes = i2d_obj.model_z_nodes
@@ -413,15 +417,15 @@
                     'model_fn', 'iter_fn', 'data_fn', 'mesh_fn'],
                     [self.model_fn, self.iter_fn, self.data_fn, self.mesh_fn]): 
                 if ins ==None : 
                     msg =' !No {0} file found ! Please provide the Occam 2D {0} file'.\
                         format(str(attr).replace('_fn', ''))
                     self._logging.error(msg)
                     warnings.warn(msg)
-                    raise CSex.pyCSAMTError_plot_geoinputargument(msg)
+                    raise GeoError(msg)
                 
             # Recreate object and get ncessaries attributes 
             model_obj= occam2d.Model(model_fn =self.model_fn,
                                      iter_fn =self.iter_fn, 
                                     mesh_fn =self.mesh_fn )
             data_obj =occam2d.Data(data_fn= self.data_fn)
             
@@ -570,15 +574,15 @@
                 array_like 
                       rowlines , new data range                    
             """
             # for consistency convert to float value 
             try : 
                 value_range= np.array([float(ss) for ss in value_range])
             except : 
-                raise CSex.pyCSAMTError_geodrill_inputarguments(
+                raise GeoError(
                     'Value provided as resistivity '
                     'range must be an array of float number.')
                                                                 
             tem=[]                   # loop the value range 
             for mm in value_range :   # substract rowlines from 
                 op = rowlines-mm        #value range to seek the minimum close
                 op=np.array([abs(aj) for aj in op]) # keep absolute value for difference 
@@ -678,15 +682,15 @@
         if isinstance (self.input_resistivities  , (tuple, list)): 
             self.input_resistivities  = np.array(self.input_resistivities )
 
         elif isinstance(self.input_resistivities , (float, int, str)): 
             try : 
                 self.input_resistivities = float(self.input_resistivities )
             except : 
-                raise CSex.pyCSAMTError_plot_geoinputargument(
+                raise GeoError(
                     'Can not converted value <%s> into float number.'\
                     ' Please provide a float number.'%self.input_resistivities )
                 
         # Display infos
         if self.verbose >0 :
             print('**{0:<37} {1} {2}'.format('{0} Layers sliced'.format(
                 auto_mess ), '=' , len(self.input_resistivities  )))
@@ -747,24 +751,24 @@
         
         """
         # only single value provided than put on list.
         if isinstance(resistivities_range, (float, str, int)): 
             try : 
                 resistivities_range=[float(resistivities_range)]
             except : 
-                raise CSex.pyCSAMTError_geodrill_inputarguments(
+                raise GeoError(
                     'Can not convert <%s> to float number !Input resistivity '
                      'must be a float number not <%s>!'% (resistivities_range,
                                                           type(resistivities_range)))
          # for consistency , check again input values 
         if isinstance(resistivities_range, (tuple, list, np.ndarray)): 
             try :  resistivities_range =np.array(
                 [float(ss) for ss in resistivities_range])
             except : 
-                raise CSex.pyCSAMTError_geodrill_inputarguments(
+                raise GeoError(
                     'Input argument provided is wrong. '
                     'Please check your resistivities '
                     ' range, values must be a float number.')
           # in fact append the idde of resistivities values located  
         # so to be sure that the resistivities will match exactly the
         # layer found in geo_electricl_property of rocks   
         geo_structures=[]                  
@@ -800,15 +804,15 @@
         """
         if data_array.dtype not in ['float', 'int']:  
             try :
                 data_array= data_array.astype('float64')
             except : 
                 warnings.warn("It seems somethings wrong"
                               " happened during data conversion to float values.")
-                raise CSex.pyCSAMTError_inputarguments(
+                raise GeoError(
                     'Could not convert value'
                     ' to float numbers , Please check your data!')
             
       
         if transpose is True :  
             data_array =data_array.T
         
@@ -930,25 +934,25 @@
             
             v,r , dm, rm=[[] for i in range(4)]
             
             if isinstance(step_in_deep, (str, int)): 
                 try : 
                     step_in_deep =float(step_in_deep)
                 except : 
-                    raise CSex.pyCSAMTError_plot_geoinputargument(
+                    raise GeoError(
                         'Could not convert depth value ={} to float.'
                         ' Please check your value.'.format(step_in_deep))
 
             if step_in_deep< dep_array.min(): 
-                raise CSex.pyCSAMTError_plot_geoinputargument(
+                raise GeoError(
                     'Value provided ={0} m is less than the minimum'
                     ' depth ={1} m.'.format(step_in_deep, dep_array.min()))
             
             if step_in_deep > dep_array.max(): 
-                raise CSex.pyCSAMTError_plot_geoinputargument(
+                raise GeoError(
                     'Value provided is = {0} m is greater than '
                     'maximum depth ={1}m.'.format(step_in_deep, dep_array.max()))
                 
             _init_depth =step_in_deep
             
             for index , depth in enumerate(dep_array):
                 if depth <= step_in_deep :      # value less than step descent 
@@ -1462,15 +1466,15 @@
                            " Input resistivities MUST provided in order"
                            " to take data as reference resistivities.", 
                            " please provided a least",
                            " a truth resitivities of one layer."])
             
             warnings.warn(mess)
             self._logging.error(mess)
-            raise CSex.pyCSAMTError_plot_geoinputargument(
+            raise GeoError(
                 "Can not write details sequences log files "
                 "! Please provided at least one"
                 " truth layer resistivity.")
         
         matrix_rhoaver ,matrix_rhorr,\
             matrix_rho_stepdescent =[[]for i in range(3)]
         for site in self.station_names : 
@@ -1573,15 +1577,14 @@
                          iter_fn=None,
                          profile_fn =None, 
                          mesh_fn=None,
                          data_fn=None,
                          filename=None,
                          savepath =None,
                          **kwargs) : 
-        
         """
         write output to oasis montaj when station loocation and profile 
         coordinates are provided . We assune before using this method , you are
         already the coordinates files at disposal(*stn), if not  use the method 
         `to_golden_software`.Coordinated files are Easting Northing value  
         not in degree decimals . It uses occam 2D outputfiles or Bo Yang 
         iter2Dat file also add profile XY coordinates (utm_zone ).
@@ -1969,15 +1972,15 @@
 
                     
         else :
             mess = 'The type you provide is wrong.'\
                 ' Support only *.xlsx and *.csv format'
             self._logging.error (mess)
             warnings.warn (mess)
-            raise CSex.pyCSAMTError_geodrill_inputarguments(
+            raise GeoError(
                 'wrong format ={0} !'\
                 ' Could not write geo file to oasis.'\
                     ' Support only *.xlsx or *.csv format ')
 
         # export to savepath  
         self.savepath = func.cpath(self.savepath , '_output2Oasis_')
 
@@ -2147,29 +2150,29 @@
                 
                 # print(self.oasis_data)
                 if self.oasis_data is None or len(self.oasis_data)==0 : 
                     mess ='No files detected!. Please provided'\
                         ' right path to oasis models files.'
                     warnings.warn(mess)
                     self._logging.error(mess)
-                    raise CSex.pyCSAMTError_inputarguments(mess)
+                    raise GeoError(mess)
       
         elif self.path is None :
-            raise CSex.pyCSAMTError_inputarguments(
+            raise GeoError(
                 'No path found ! Please provided a right path.')
         
         # get extension file 
         extension_files =[os.path.splitext(pathfile)[1] 
                           for pathfile in self.oasis_data]
         self.extension_file =extension_files
         if self.extension_file.replace('.','') not in self.geo_surface_format : 
             mess = 'Unacceptable format = {0}. Could read format ={1}'.\
                 format(self.extension_file, tuple(self.geo_surface_format))
             self._logging.warning(mess)
-            raise CSex.pyCSAMTError_file_handling(mess)
+            raise FileHanglingError(mess)
         
         
     @property 
     def extension_file (self):
         return self._extension_file
     
     @extension_file.setter 
@@ -2341,31 +2344,31 @@
         if path is not None : 
             self.path = path 
         if self.path is not None : self.read_oasis_files()
         
         if depth_values is not None : self.depth_values= depth_values    
 
         if self.depth_values is None : 
-            raise CSex.pyCSAMTError_plot_geoinputargument(
+            raise GeoError(
                 'NoneType could not be computed. Please provided'
                 '  right values !')
         
         if isinstance(self.depth_values, (float, str)): 
             try : 
                 self.depth_values = float(self.depth_values)
             except : 
-                raise CSex.pyCSAMTError_float('Could not convert {0} to float'.\
+                raise TypeError('Could not convert {0} to float'.\
                                               format(self.depth_values))
             else : self.depth_values =np.array([self.depth_values])
   
         elif isinstance(self.depth_values , (list, tuple, np.ndarray)): 
             self.depth_values = np.array(self.depth_values)
             try : 
                 self.depth_values = self.depth_values.astype('float')
-            except : raise CSex.pyCSAMTError_float(
+            except : raise TypeError(
                     'Could not convert values to float!')
 
         def get_single_surface_from_one_line(site_name , depth_value)  : 
             """
             Fonction to get single surface from depth value fron one line .
             
             :param depth value: depth value to image
@@ -2461,33 +2464,33 @@
         else : 
             mess=''.join([
                 '-->Sorry! Depth map actually does not support the {0} ',
                     'format provided. Only support `xlsx` or `csv` format.', 
                     ' Please provide the rigth format !'])
             self._logging.error(mess.format(self.export_format))
             warnings.warn(mess.format(self.export_format))
-            raise CSex.pyCSAMTError_file_handling(
+            raise FileHanglingError(
                 'Format provided = {0} is wrong ! '
                 'Could output only `csv` or `xlsx`.'.
                     format(self.export_format))
             
         
         if self.depth_values is None : 
             warnings.warn(
                 'Need to specify the value of depth for imaging !')
             self._logging.warn(
                 'Need to specify the value of depth for imaging !')
-            raise CSex.pyCSAMTError_inputarguments(
+            raise GeoError(
                 'Need to specify the depth value for imaging.')
         if self.path is None : 
             warnings.warn(
                 'Need to provide the rigth path `geodrill` model output files.')
             self._logging.warning(
                 'Need to provide the rigth path `geodrill` model output files.')
-            raise CSex.pyCSAMTError_inputarguments(
+            raise GeoError(
                 'No path detected! Please provide a right path to `geodrill`\
                     oasis montaj outputfiles ')
   
         self.get_depth_surfaces() # call methods to create 
         
         # get values from dictionnary and write file 
         #make output filename 
@@ -2571,23 +2574,23 @@
                 geo_electric_strike 
             str 
                 message of return 
         """
         _logger.info(
             'Computing  profile angle from Easting and Nothing coordinates.')
         if easting is None or northing is None : 
-            raise CSex.pyCSAMTError_inputarguments(
+            raise GeoError(
                 'NoneType can not be computed !')
             
             # use the one with the lower standard deviation
         try :
             easting = easting.astype('float')
             northing = northing.astype('float')
         except : 
-            raise CSex.pyCSAMTError_float(
+            raise TypeError(
                 'Could not convert input argument to float!')
         
         if stats_import is True : 
             profile1 = spSTAT.linregress(easting, northing)
     
             profile2 =spSTAT.linregress(northing, easting)
         else :
@@ -2656,15 +2659,15 @@
                            ' northing. NoneType can not be computed', 
                            ' will check whether geostrike is provided .'])
             _logger.debug(mess)
             if gstrike is None :
                 
                 _logger.warning(
                     'NoneType found.Could not compute geo-electrike strike!')
-                raise CSex.pyCSAMTError_inputarguments(
+                raise GeoError(
                     'NoneType found. Could not compute geo-electrike strike!')
         
         if profile_angle is None : 
             if easting is not None and northing is not None : 
                 profile_angle ,_ = geostrike.compute_profile_angle(
                                     easting, northing)
         
@@ -4632,18 +4635,17 @@
         
         return obj 
     
 def _ps_memory_management(obj=None, option='set'): 
     """ Manage the running times for stratigraphic model construction.
     
     The script allows to avoid running several times the GeoStratigraphy model
-    construction to retrieve the pseudostratigraphic log at each station.  
-    It memories the model data for the first run and used it when calling it
-    to  visualize the pseudostratigrahic log at each station. Be aware to edit 
-    this script.
+    construction to retrieve the pseudostratigraphic (PS) log at each station.  
+    It memorizes the model data for the first run and used it when calling it
+    to  visualize the PS log at each station. Be aware to edit this script.
     """
     memory, memorypath='__memory.pkl', 'pycsamt/geodrill/_geocodes'
     mkeys= ('set', 'get', 'recover', 'fetch', set)
     if option not in mkeys: 
         raise ValueError('Wrong `option` argument. Acceptable '
                          f'values are  {func.smart_format(mkeys[:-1])}.')
         
@@ -4659,15 +4661,15 @@
     elif option in ('get', 'recover', 'fetch'): 
         memory_exists =  os.path.isfile(os.path.join(memorypath, memory))
         if not memory_exists: 
             _logger.error('No memory found. Run the GeoStratigraphy class '
                           'beforehand to create your first model.')
             warnings.warn("No memory found. You need to build your "
                           " GeoStratigraphy model by running the class first.")
-            raise CSex.pyCSAMTError_memory(
+            raise GeoMemoryError(
                 "Memory not found. Use the GeoStratigraphy class to "
                 "create your model first.")
         psobj_token, data_ = BS.load_serialized_data(
             os.path.join(memorypath, memory))
         data = dict(data_)
         # create PseudoStratigraphicObj from metaclass and inherits from 
         # dictattributes of GeoStratigraphy class
```

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/geodatabase.py` & `pycsamt-1.2.1/pycsamt/geodrill/geodatabase.py`

 * *Files 6% similar despite different names*

```diff
@@ -16,20 +16,20 @@
 import os
 import sys
 import numpy as np  
 import pandas as pd 
 import warnings
 import datetime
 
-import  pycsamt.utils.exceptions as CSex 
 from pycsamt.geodrill.structural import Geo_formation 
 from pycsamt.geodrill._dictapp import Glob
 from pycsamt.geodrill.requestmanager import ManageDB
 from  pycsamt.utils.decorator import deprecated_to
-from pycsamt.utils._csamtpylog import csamtpylog 
+from pycsamt._csamtpylog import csamtpylog 
+from pycsamt.utils.exceptions  import DataBaseError, SQLError  
 #set LogInfos
 try :
     _logger=csamtpylog.get_csamtpy_logger(__name__)
     # _logger.setLevel(logging.DEBUG)
     filename=os.path.basename(__file__)
     # lineno=__file__.__code__.co_firstlineno + 1
 except Exception as error :
@@ -204,15 +204,15 @@
         """
         if structure_name is not None :
             self.geo_structure_name = structure_name.lower() 
         
         if self.geo_structure_name is None : 
             warnings.warn('No name is inputted as geological formation. Sorry ,'
                           ' your request is aborted !')
-            raise CSex.pyCSAMTError_SQL_manager(
+            raise SQLError(
                 'No name is given as geological formation. Sorry ,'\
                  ' your request is aborted !')
                 
         if self.geo_structure_name is not None :
             self._avoid_injection()
             
         if self.geo_structure_exists : 
@@ -297,19 +297,19 @@
         # find geological rocks name if is in keywords dict
         if geo_formation_name is None : 
             if '__description' in list(kws.keys()) : 
                 geo_formation_name=str(kws['__description'])
             elif 'name' in list(kws.keys()) : 
                 geo_formation_name=str(kws['name'])
             else : 
-                raise CSex.pyCSAMTError_SQL_update_geoinformation(
+                raise SQLError(
                     ' Unable to find a new geological structure name.')
     
         if not isinstance(geo_formation_name, str) : 
-            raise CSex.pyCSAMTError_SQL_update_geoinformation(
+            raise SQLError(
                 'Unacceptable rock/layer name ={0}.'\
                     ' Please provide a right rock/layer name.')
         geo_formation_name=str(geo_formation_name) # for consistency 
         
         if geo_formation_name is not None :
             self.geo_structure_name = geo_formation_name.lower() 
         
@@ -325,42 +325,42 @@
                 ' Actually geological formation name =  <{0}> can '.format(
                     self.geo_structure_name),
                  'not be updated because', 
                 ' it doesnt  exist in our DataBase. To set new geological ',
                 'formation with their corresponding values ', 
                 ' see { _add_geo_structure } method .'])
             self._logging.warn(mess)
-            raise CSex.pyCSAMTError_SQL_update_geoinformation(
+            raise SQLError(
                 'Update name= {0}  failed ! it doesnt not exist in '
                 'geoDataBase'.format(self.geo_structure_name))
                     
             
         elif self.geo_structure_exists : # even the geostructure exists ,
         #let check wether the key provided 
             for geo_key in list (tem_geodict.keys()) : # is among the geocodes keys
                 if geo_key not in self.codef : #if key provided not in geodatable keys 
                     
                     mess =''.join([
                         "Sorry the key = {0} is wrong! key doesnt".format(geo_key),
                         " exist in geoDataBase.Please provide a right ", 
                         " keys among = {0}". format(tuple(self.codef[2:]))])
                     self._logging.error(mess)
-                    raise CSex.pyCSAMTError_SQL_manager(mess)
+                    raise SQLError(mess)
         
                 elif geo_key in self.codef :
                     if geo_key.find('pat') >= 0 : 
                         try : # keep value to real
                             update_geo_values = float(kws[geo_key]) 
                         except : 
                             msg =''.join([
                                 'update failed ! Could not convert',
                                 ' value = {0} to float.'.format(kws[geo_key]), 
                                 'Please try again later.'])
                             self._logging.error(msg)
-                            raise CSex.pyCSAMTError_SQL_update_geoinformation(msg)
+                            raise SQLError(msg)
                             
                     # let get the formatage of all values  (properties values )  
                     elif geo_key.find('colorMPL') >=0 : 
                         self.colorMPL = kws[geo_key] 
                         update_geo_values = self.colorMPL
                     # let fill automatically the "rgb" and the colorMPL                
                     elif geo_key.find('rgb')>=0 :  
@@ -550,19 +550,19 @@
         # find geological rocks name if is in keywords dict
         if new_geological_rock_name is None : 
             if '__description' in list(kws.keys()) : 
                 new_geological_rock_name=str(kws['__description'])
             elif 'name' in list(kws.keys()) : 
                 new_geological_rock_name=str(kws['name'])
             else : 
-                raise CSex.pyCSAMTError_SQL_update_geoinformation(
+                raise SQLError(
                     ' ! Unable to find a new geo_logical structure name.')
     
         if not isinstance(new_geological_rock_name, str) : 
-            raise CSex.pyCSAMTError_SQL_update_geoinformation(
+            raise SQLError(
                 'Unacceptable rocks names ={0}.'
                  ' Please provide a right rock name.')
         new_geological_rock_name=str(new_geological_rock_name) # 
         
         
         # ---------------------------call Geodatabse --------------------------
         
@@ -571,26 +571,26 @@
         # initialise to 'none' value 
         mmgeo={geokey : 'none' for geokey in geoDataBase_obj.codef } 
         
         if geoDataBase_obj.success ==1 :  geoDataBase_obj._avoid_injection()
         elif geoDataBase_obj.success  ==0:
             mess = "Connection to SQL geoDataBase failed ! Try again later." 
             warnings.warn(mess)
-            raise CSex.pyCSAMTError_SQL_geoDataBase(mess)
+            raise DataBaseError(mess)
             
         #----------------------------------------------------------------------
        
         if geoDataBase_obj.geo_structure_exists : 
             mess ='! Name {0} already exists in our GeoDataBase. Could not add '\
                 'again as new geostructure. Use "_update_geo_geostructure method"'\
                     ' to update infos if you need !'.format(
                         geoDataBase_obj.geo_structure_name)
             warnings.warn(mess)
             _logger.error(mess)
-            raise CSex.pyCSAMTError_SQL_update_geoinformation(mess)
+            raise SQLError(mess)
             
         if geoDataBase_obj.geo_structure_exists is False : 
   
             # make an copy of codef useful in the case where 
             # user provided "name" as key instead of "__description" 
             import copy 
             new_codef = copy.deepcopy(geoDataBase_obj.codef)
@@ -606,15 +606,15 @@
             __geocode =[codegeo[0] for codegeo in  
                         list(geoDataBase_obj.manage_geoDataBase.curs)]
             
             
             for key in list(kws.keys()) : 
 
                 if key not in new_codef  : 
-                    raise CSex.pyCSAMTError_SQL_update_geoinformation(
+                    raise SQLError(
                         'Process aborted ! wrong <{0}> key!'
                          ' could not add new informations. '
                          'Please check your key !'.format(key))
                 #  set code and labels from geo_description name 
                 elif key  in new_codef:  
                 
                     try : # check if name is provided intead of  __description 
@@ -682,15 +682,15 @@
                 
             except : 
                 mess='Process to set {0} infos failed!  Try again '\
                     'later! '.format(new_geological_rock_name)
                 warnings.warn (mess)
                 _logger.error(mess)
                 
-                raise CSex.pyCSAMTError_SQL_update_geoinformation(mess)
+                raise SQLError(mess)
                 
             else :
    
                 geoDataBase_obj.manage_geoDataBase.commit()     
                 print('---> new data ={} was successfully set into'
                       ' GeoataBase ! '.format(new_geological_rock_name)) 
             
@@ -707,15 +707,15 @@
         "configure geopattern"
         try : 
              float(pattern_value)
         except : 
             mes ='Process aborted ! Could not convert'\
                 f' {pattern_value} to float number.'
             self._logging.warning(mes)
-            raise CSex.pyCSAMTError_SQL_update_geoinformation(mes)
+            raise SQLError(mes)
 
         else : 
             self._pattern = float(pattern_value)
     
     @property 
     def colorMPL(self): 
         "return geocolorMPL"
@@ -745,15 +745,15 @@
                 self._mplcolor =  'none' # keep the value on the dataBase 
             else : 
                 import matplotlib as mpl 
                 try : # try to convert color to rgba
                 
                     self._mplcolor = mpl.colors.to_rgb(str ( mpl_color))
                 except : 
-                    raise  CSex.pyCSAMTError_SQL_manager(
+                    raise  SQLError(
                         ' Unsupported {0} color!'.format(mpl_color))  
                 else :  # keep only R, G, B and abandon alpha . 
                         #Matplotlib give tuple of 4 values 
                         # as (R, G, B, alpha)
                     self._mplcolor =self._mplcolor[:3] 
                     
              # set value to database way 
@@ -761,40 +761,40 @@
             if 3 <len(mpl_color) < 3 : 
                 msg =''.join(['update failed ! value = {0} '.format(mpl_color),
                               'must be a tuple of 3 values= (Red, Green, Blue)',
                              'values. Please provided a right number', 
                              '  again later.'])
                 
                 self._logging.error(msg)
-                raise CSex.pyCSAMTError_SQL_update_geoinformation(msg)
+                raise SQLError(msg)
             # let check whether the value provided can be converted to float    
             if len(mpl_color)==3 :  
                 try : 
                      self._mplcolor= tuple( [float(ss) for
                                              ss in list( mpl_color)])
                 except : 
                      msg =''.join(['update failed ! Could not convert value ',
                                    '= {0} to float.'.format(mpl_color), 
                                    'Please try again later.'])
                      self._logging.error(msg)
-                     raise CSex.pyCSAMTError_SQL_update_geoinformation(msg)
+                     raise SQLError(msg)
                 else : 
                     # try to check if value is under 1.
                     # because color is encoding to 1 to 255 bits 
                     for ival in  self._mplcolor: 
                         if 1 < ival <0  : 
                             if ival > 1 : fmt ='greater than 1' 
                             elif  ival <0 :
                                 fmt= 'less than 0'
                             msg = ''.join([
                                 'update failed ! Value provided  =',
                                 f' `{ival}` is UNacceptable value ! Input ',
                                 f' value is {fmt}. It must be encoding from ',
                                 '1 to 255 bits as MPL colors.'])
-                            raise CSex.pyCSAMTError_SQL_update_geoinformation(msg)
+                            raise SQLError(msg)
                             
                 self._mplcolor=str( self._mplcolor) # put on str for consistency 
                 
     @property 
     def rgb(self):
         "return georgb"
         return self._rgb 
@@ -838,15 +838,15 @@
                 
         elif isinstance(range_of_rocks_resvalues,(list,tuple, np.ndarray)): 
             if len(range_of_rocks_resvalues) ==2  : 
                 try : 
                     self._electrical_props =[float(res) 
                                        for res in range_of_rocks_resvalues]
                 except : 
-                    raise CSex.pyCSAMTError_SQL_update_geoinformation(
+                    raise SQLError(
                         ' !Could not convert input values to float.')
                 else :# range the values to min to max 
                     self._electrical_props =sorted(self._electrical_props) 
                     self._electrical_props = str(tuple(self._electrical_props))
             else : 
                 # force program to format value to 0. float 
                 self._electrical_props = .0   
@@ -864,15 +864,15 @@
                     'Unable to set electrical property of rocks.', 
                     ' We need only minimum and maximum resistivities',
                     ' bounds. {0} {1} given'.format(
                         len(range_of_rocks_resvalues), fmt)])
                         
                 self._logging.error(mess)
                 warnings.warn(mess)
-                raise CSex.pyCSAMTError_SQL_update_geoinformation(mess)
+                raise SQLError(mess)
             else : 
                 
                 self._electrical_props = .0 #mean value  initialised 
                 
 
     @property
     def _setGeoDatabase(self): 
@@ -949,15 +949,15 @@
         # create Table
         
         try : 
             self.manage_geoDataBase.executeReq(query=req ) 
             
         except : 
             warnings.warn('Could not create {AGS0} Table !')
-            raise CSex.pyCSAMTError_SQL_geoDataBase(
+            raise DataBaseError(
                 'Table AGS0 already exists !')
 
         if self.manage_geoDataBase.success ==1: 
             # enter the record 
             for ii, row_geoDataBase in enumerate(GDB_DATA ): 
                 row_geoDataBase =tuple(row_geoDataBase)
                 self.manage_geoDataBase.executeReq(
```

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/ml.py` & `pycsamt-1.2.1/pycsamt/geodrill/ml.py`

 * *Files 2% similar despite different names*

```diff
@@ -4,15 +4,15 @@
 
 import os
 import  numpy as np
 import pandas as pd
 
 from pycsamt.utils.ml_utils import neuron
 from pycsamt.geodrill.requestmanager import ManageDB
-from pycsamt.utils._csamtpylog import csamtpylog 
+from pycsamt._csamtpylog import csamtpylog 
 _logger =csamtpylog().get_csamtpy_logger(__name__)
 
 
 class ML: 
     """
     Implement ANN to predict layer name from the SQL database. Each database 
     columns is a database properties
```

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/requestmanager.py` & `pycsamt-1.2.1/pycsamt/geodrill/requestmanager.py`

 * *Files 0% similar despite different names*

```diff
@@ -11,15 +11,15 @@
 import shutil 
 import warnings
 import pandas as pd 
 # from pg8000 import DBAPI
 import sqlite3 as sq3 
 
 try : 
-    from pycsamt.utils._csamtpylog import csamtpylog
+    from pycsamt._csamtpylog import csamtpylog
     _logger=csamtpylog.get_csamtpy_logger(__name__)
 except :
     pass
 
 
 class ManageDB(object) : 
     """
```

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/strata.py` & `pycsamt-1.2.1/pycsamt/geodrill/strata.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,19 +1,21 @@
 # -*- coding: utf-8 -*-
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
-#       Licence: LGPL
+#       Licence: GPL
 """
-.. _module-Strata::
-    
-    :synopsis:Metaclasses of geostrata . Takes conventional strata geocodes 
-            look in _geocodes folder . will be deprecated soon
+Strata
+==========
+
+Metaclasses of geostrata .Takes conventional strata geocodes 
+look in _geocodes folder . will be deprecated soon
+
 """
 from pycsamt.utils.geo_utils import mapping_stratum as setdico
 try : 
-    from pycsamt.utils._csamtpylog import csamtpylog
+    from pycsamt._csamtpylog import csamtpylog
     _logger=csamtpylog.get_csamtpy_logger(__name__)
 except :
     pass
 
 
 traces_classes={}
```

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/structural.py` & `pycsamt-1.2.1/pycsamt/geodrill/structural.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,16 +10,18 @@
 """
 
 import os
 import warnings
 import numpy as np 
 
 from pycsamt.utils.geo_utils import mapping_stratum as strato
-from pycsamt.utils  import exceptions as CSex
-from pycsamt.utils._csamtpylog import csamtpylog
+from pycsamt.utils.exceptions  import ( 
+    StructuralError, ParamNumberError
+    )
+from pycsamt._csamtpylog import csamtpylog
 _logger=csamtpylog.get_csamtpy_logger(__name__)
 
 
 class geo_pattern: 
     """
     Singleton class to deal with geopattern  with other modules. It 
     is and exhaustive pattern dict, can be add and change. This pattern
@@ -621,23 +623,23 @@
                     _secags0 = agso_lines[0].strip().split(',')
                     _secags0 =[_code.lower() for _code in _secags0]
                     self._AGS0_DATA =agso_lines[1:]
                     
                     if _secags0 != self.codef :
                         warnings.warn(
                             ' !Trouble occurs while decoding the geostructures!')
-                        raise CSex.pyCSAMTError_structural(
+                        raise StructuralError(
                             'Geostructures files provided is wrong !')
             else : 
                 
                 warnings.warn(
                     'No Geostructure file detected.It seems the file'
                     ' is moved or deleted from its home folder'
                     ' <pycsamt/geodrill/_geocodes>')
-                raise CSex.pyCSAMTError_structural(
+                raise StructuralError(
                     'pyCSAMT inner geocodes not found '
                     'in <pycsamt/geodrill/_geocodes> folder.'
                      ' Please provide the right structures codes.')
             return self._AGS0_DATA 
     
     def _set_geo_formation(self, agso_fn =None): 
         """
@@ -722,38 +724,40 @@
         >>> from pycsamt.geodrill.geoCore.structural import get_color_palette 
         >>> get_color_palette (RGB_color_palette ='R128B128')
     """   
     def ascertain_cp (cp): 
         if cp >255. : 
             warnings.warn(' !RGB value is range 0 to 255 pixels , '
                           'not beyond !. Your input values is = {0}.'.format(cp))
-            raise CSex.pyCSAMTError_parameter_number('Error color RGBA value ! '
-                                                     'RGB value  provided is = {0}.'
-                                                     ' It is larger than 255 pixels.'.format(cp))
+            raise ParamNumberError(
+                'Error color RGBA value ! RGB value  provided is = {0}.'
+                 ' It is larger than 255 pixels.'.format(cp))
         return cp
     if isinstance(RGB_color_palette,(float, int, str)): 
         try : 
             float(RGB_color_palette)
         except : 
               RGB_color_palette= RGB_color_palette.lower()
              
         else : return ascertain_cp(float(RGB_color_palette))/255.
     
     rgba = np.zeros((3,))
     
     if 'r' in RGB_color_palette : 
-        knae = RGB_color_palette .replace('r', '').replace('g', '/').replace('b', '/').split('/')
+        knae = RGB_color_palette .replace('r', '').replace(
+            'g', '/').replace('b', '/').split('/')
         try :
             _knae = ascertain_cp(float(knae[0]))
         except : 
             rgba[0]=1.
         else : rgba [0] = _knae /255.
         
     if 'g' in RGB_color_palette : 
-        knae = RGB_color_palette .replace('g', '/').replace('b', '/').split('/')
+        knae = RGB_color_palette .replace('g', '/').replace(
+            'b', '/').split('/')
         try : 
             _knae =ascertain_cp(float(knae[1]))
         except : 
             rgba [1]=1.
             
         else :rgba[1]= _knae /255.
     if 'b' in RGB_color_palette :
```

### Comparing `pycsamt-1.1.2/pycsamt/geodrill/update_upgrade_geoDataBase.py` & `pycsamt-1.2.1/pycsamt/geodrill/update_upgrade_geoDataBase.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/cmake_dh.py` & `pycsamt-1.2.1/pycsamt/gui/cmake_dh.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/corrected_edi.py` & `pycsamt-1.2.1/pycsamt/gui/corrected_edi.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/gs2f.py` & `pycsamt-1.2.1/pycsamt/gui/gs2f.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/gui_avgapp.py` & `pycsamt-1.2.1/pycsamt/gui/gui_avgapp.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/gui_frames.py` & `pycsamt-1.2.1/pycsamt/gui/gui_frames.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/maingui.py` & `pycsamt-1.2.1/pycsamt/gui/maingui.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/oas2f.py` & `pycsamt-1.2.1/pycsamt/gui/oas2f.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/oc2d_bdin.py` & `pycsamt-1.2.1/pycsamt/gui/oc2d_bdin.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/p2log.py` & `pycsamt-1.2.1/pycsamt/gui/p2log.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/p_moc2d.py` & `pycsamt-1.2.1/pycsamt/gui/p_moc2d.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/personal_frames.py` & `pycsamt-1.2.1/pycsamt/gui/personal_frames.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/wa2edi.py` & `pycsamt-1.2.1/pycsamt/gui/wa2edi.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/wa2j.py` & `pycsamt-1.2.1/pycsamt/gui/wa2j.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/wi2d.py` & `pycsamt-1.2.1/pycsamt/gui/wi2d.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/wrap_console_scripts.py` & `pycsamt-1.2.1/pycsamt/gui/wrap_console_scripts.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/gui/write_avg2j.py` & `pycsamt-1.2.1/pycsamt/gui/write_avg2j.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/modeling/occam2d.py` & `pycsamt-1.2.1/pycsamt/modeling/occam2d.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,60 +1,59 @@
 # -*- coding: utf-8 -*-
 #       Created on Fri Jan 22 20:31:14 2021
 """
-.. _module-Occam2D :: `pycsamt.modeling.occam2d`
-    :synopsis:: The Occam 2D MT inversion code (v3.0) presented here is an
-                implementation of the general Occam procedure of  Constable, 
-                et al. (1987)extended to  2D by deGroot-Hedlin and Constable (1990).
-                The 2D MT forward  calculations are carried out with codeprovided
-                 by Wannamaker, et al (1987)  using reciprocity to calculate the
-                Jacobian (de Lugao and Wannamaker, 1996).
-                ...
+Module Occam2D 
+================
+
+The Occam 2D MT inversion code (v3.0) presented here is an implementation of 
+the general Occam procedure of  Constable, et al. (1987)extended to  2D by 
+deGroot-Hedlin and Constable (1990). The 2D MT forward  calculations are 
+carried out with codeprovided by Wannamaker, et al (1987)  using reciprocity
+to calculate the Jacobian (de Lugao and Wannamaker, 1996).
 
 .. seealso::
-        - http://marineemlab.ucsd.edu/Projects/Occam/sharp/index.html 
-        - https://marineemlab.ucsd.edu/~kkey/Software.php
-        - https://github.com/MTgeophysics/mtpy.git>`
-        ...
+    - http://marineemlab.ucsd.edu/Projects/Occam/sharp/index.html 
+    - https://marineemlab.ucsd.edu/~kkey/Software.php
+    - https://github.com/MTgeophysics/mtpy.git>`
+    ...
 
 """
 import os
 import warnings
 import datetime
 import numpy as np 
 
-import pycsamt.utils.exceptions as CSex
-from pycsamt.modeling.__init__ import  SUCCESS_IMPORT_MTPY
+from pycsamt.__init__ import  imtpy 
 from pycsamt.utils import func_utils as func
 from pycsamt.utils import plot_utils as punc
 from pycsamt.utils import  plotdecorator  as mdeco
 from pycsamt.utils._p import _sensitive as SB 
-from pycsamt.utils._csamtpylog import csamtpylog 
+from pycsamt._csamtpylog import csamtpylog 
+from pycsamt.utils.exceptions import ( 
+    OccamError, I2datError, AVGError
+    )
 
 _logger =csamtpylog.get_csamtpy_logger(__name__)
 
-if  SUCCESS_IMPORT_MTPY :
-
+if imtpy:
     _logger.info('`MTpy` successfull loaded!')
     try : 
         from mtpy.modeling import occam2d as MToccam2d
         _logger.info('`occam2d` module sucessfully imported  from `MTpy`.')
-        
     except :
-        _logger.info('loading  `occam2d` module from '
-                     '`MTpy`packages  failed')
+        _logger.info('loading  `occam2d` module from `MTpy`packages  failed')
         warnings.warn('Loading occam2d module from "MTpy" '
                       'package failed! Please try again')
         
-        SUCCESS_IMPORT_MTPY  =False 
+        imtpy=False 
     
-if not SUCCESS_IMPORT_MTPY:
+if not imtpy:
     _logger.info('Unable to import `MTpy`packages. Loading failed!')
-    warnings.warn('Try to import `MTpy` module failed! You can get "MTPY"'
-                  ' from <https://github.com/MTgeophysics/mtpy.git>`.')
+    warnings.warn("Import MTpy failted! You can get MTPY from "
+                  " <https://github.com/MTgeophysics/mtpy.git>`.")
      
 
 class occamLog (object) : 
     """
     Class to deal with occcam 2d logfile . output File  after inverted data.
     most likely called `logFile.logfile`.
     
@@ -99,15 +98,15 @@
         """
         self._logging.info ('Asserting <%s> occam2d logfile.'% logpath)
         
         if SB.which_file(filename=logpath) =='logfile':
             self._fn = logpath
         else :
             warnings.warn('No occam 2d logfile detected. Please check your path.')
-            raise CSex.pyCSAMTError_occam2d(
+            raise OccamError(
                 'Doesnt not recognize the Logfile <{0}>'\
                 ' provided.'.format(os.path.basename(logpath)))
             
     def read_occam2d_logfile(self, fn =None ) : 
         """
         Read occam file and populate attributes. 
         
@@ -125,15 +124,15 @@
         """
         
         if fn is not None : self.fn = fn 
         self._logging.info (
             'Reading and setting OccamLog  attributes'
             ' from logfiles <%s>.'% self.fn )
         if self.fn is None : 
-            raise CSex.pyCSAMTError_occam2d(
+            raise OccamError(
                 'None occam2dlog file detected. Please check your right path .')
 
         with open(self.fn , 'r', encoding ='utf8') as focc: 
             occamlog_lines =focc.readlines()
         for oc ,  occam  in enumerate(occamlog_lines) : 
             
             if occam.find(
@@ -280,18 +279,18 @@
         self.fn = data_fn
         self.data_format = kwargs.pop('format', 'OCCAM2MTDATA_1.0')
         self.data_title =kwargs.pop('title', 'Forward model response from Occam2D')
         self.data_sites =kwargs.pop('sites', None)
         self.data_offsets =kwargs.pop('offsets', None)
         self.data_frequencies =kwargs.pop('frequencies', None)
         self.data_nblocks = kwargs.pop('data_blocks', None)
+        self.verbose = kwargs.pop('verbose', 0)
         
         self.occam_data =None
- 
-        
+
         for key in list(kwargs.keys()): 
             self.__setattr__(key, kwargs[key])
         
         if self.fn is not None : 
             self.read_occam2d_datafile ()
             
             
@@ -342,15 +341,15 @@
                 self.data_nblocks= float(dataparams.strip().split(':')[-1])
     
             if dataparams.lower().find('type') >=0 and dataparams.lower(
                     ).find('error')>=0 : 
                 indextemp.append(ii)
                 
                 break
-        #--> now get each specials arrays and eliminate (the firsst tiles )
+        #--> now get each specials arrays and eliminate (the first tiles )
         self.data_sites=[site.strip() 
                          for site in occam_data_lines[
                                  indextemp[0]+1:indextemp[1]]]
         self.data_offsets = [float(off.strip()) 
                              for off in occam_data_lines[
                                      indextemp[1]+1 : indextemp[2]]]
         self.data_frequencies =[float(freq.strip())
@@ -363,98 +362,99 @@
         if self.data_frequencies [0] <self.data_frequencies[-1]: 
             self.data_frequencies= self.data_frequencies[::-1]
             self.data_flip_freq =True 
             
         temp=[]
         for data in occam_data_lines[indextemp[-1]+1:]:
             temp.append(np.array(data.strip().split()))
-            
+        
         self.data = func.concat_array_from_list(list_of_array=temp)
-
+        
         # set datablocks attributes  
         self.parse_block_data()
         
+       #XXXFIXME
         # for ikey, key in enumerate(self.data_titles ) : 
         occam_data_dict ={key :self.data[:, ikey] 
                           for ikey, key in enumerate(
                                   self.data_blocks_header)}
-
+        
         self.__setattr__('occam_data_blocks', DataBlock(**occam_data_dict))
         #straighten out offset  and get the step 
         # graduate to min to max for consistency
         if self.data_offsets[0]> self.data_offsets[-1] :  
             self.data_offsets =self.data_offsets[::-1]
             
         step=  func.round_dipole_length( (
-            self.data_offsets[-1] - self.data_offsets[0])/ len(
-                self.data_offsets) -1)
+            self.data_offsets[-1] - self.data_offsets[0])/ (len(
+                self.data_offsets) -1))
         
-        #regraduate offset 
+        #regraduate offset
         self.data_offsets= np.arange(0, step* len(self.data_offsets), step)
         self.data_frequencies = np.array(self.data_frequencies )
         
-        print('{0:-^77}'.format('Occam 2D Data infos'))
-        print('** {0:<27} {1} {2}'.format('Sites num.', 
-                                          '=', len(self.data_offsets)))
-        print('** {0:<27} {1} {2}'.format('Frequencies num.',
-                                          '=', len(self.data_frequencies)))
-        print('** {0:<27} {1} {2}'.format('Highest frequency (Hz)',
-                                          '=', self.data_frequencies.max()))
-        print('** {0:<27} {1} {2}'.format('Lowest frequency (Hz)', '=',
-                                          self.data_frequencies.min()))
-        
-        print('** {0:<27} {1} {2}'.format('Minimum offset (m)', '=',
-                                          self.data_offsets.min()))
-        print('** {0:<27} {1} {2}'.format('Maximum offset (m)', '=',
-                                          self.data_offsets.max()))
-        print('-'*77)
-        
+        if self.verbose >0: 
+            
+            print('{0:-^77}'.format('Occam 2D Data infos'))
+            print('** {0:<27} {1} {2}'.format('Sites num.', 
+                                              '=', len(self.data_offsets)))
+            print('** {0:<27} {1} {2}'.format('Frequencies num.',
+                                              '=', len(self.data_frequencies)))
+            print('** {0:<27} {1} {2}'.format('Highest frequency (Hz)',
+                                              '=', self.data_frequencies.max()))
+            print('** {0:<27} {1} {2}'.format('Lowest frequency (Hz)', '=',
+                                              self.data_frequencies.min()))
+            
+            print('** {0:<27} {1} {2}'.format('Minimum offset (m)', '=',
+                                              self.data_offsets.min()))
+            print('** {0:<27} {1} {2}'.format('Maximum offset (m)', '=',
+                                              self.data_offsets.max()))
+            print('-'*77)
         
         
     def parse_block_data(self, datablocks=None):
         """
         From block data, retreive the value of each blocks 
-        each blocks is ndaray(nfrea, nstations)
+        each blocks is ndarray(nfreq, nstations)
         Attributes are : 
             - `self.appRho` for apparent resistivity blocks
             - `self.phase` for phase  values 
             - `self.error_appRho` for error in resistivity  (block )
             - `self.error_phase` for error in phase 9blocks
         
         """    
         # got frequency array  and site array which uniques values 
         if datablocks is not None: 
             self.data = datablocks 
 
         # self.data.astype(np.float)  # for consistency 
-        self.data = np.asarray(self.data,
-                               dtype = np.float64, order= 'K')
+        self.data = np.asarray(self.data,dtype = np.float64, order= 'K')
+        
         sites, *_= np.unique(self.data[:, 0], 
                              return_counts =True)
         freq , *_=np.unique(self.data[:, 1], 
                             return_counts= True)
         datum , *_= np.unique(self.data[:, 2],
                               return_counts= True)
         sites.astype('int32')
         freq.astype('int32')
-    
-
+ 
         # get mode and create model array 
         k_=None 
         m_= [int(s) for s in datum]
     
         self.occam_dtype_value = m_
         for key, values in self.occam_modes.items(): 
             if values ==m_: 
                 k_= key 
                 self.occam_dtype_ =k_
                 self.occam_dtype_value = values
                 break 
-            
         cf =False 
+    
         if self.occam_dtype_ =='log_te_tm': 
             self.te_appRho =np.zeros((len(freq), len(sites)))
             self.te_phase = np.zeros((len(freq), len(sites)))
             self.tm_appRho =np.zeros((len(freq), len(sites)))
             self.tm_phase = np.zeros((len(freq), len(sites)))
             self.te_error_appRho = np.zeros((len(freq), len(sites)))
             self.te_error_phase = np.zeros((len(freq), len(sites))) 
@@ -468,15 +468,19 @@
             self.te_error_phase = np.zeros((len(freq), len(sites))) 
             
         elif self.occam_dtype_=='log_tm': 
             self.tm_appRho =np.zeros((len(freq), len(sites)))
             self.tm_phase = np.zeros((len(freq), len(sites)))
             self.tm_error_appRho = np.zeros((len(freq), len(sites)))
             self.tm_error_phase = np.zeros((len(freq), len(sites))) 
-       
+        else: 
+            raise CSex.pyCSAMTError_occam2d(
+                "Three dimensional and Tipper are not implemented yet."
+                " Please use MTpy (https://github.com/MTgeophysics/mtpy.git)"
+                " or ModEM (http://www.coas.oregonstate.edu) instead.")
         # create for each mode id datablocks 
   
         for kk, rowlines in enumerate(self.data): 
             index_site = np.where(sites ==rowlines[0])[0]
             index_freq = np.where(freq ==rowlines[1])[0]
             if int(rowlines[2]) ==1: 
                 self.te_appRho[int(index_freq),
@@ -498,26 +502,27 @@
                 self.tm_phase[int(index_freq),
                            int(index_site)] = rowlines[3]
                 self.tm_error_phase[int(index_freq),
                            int(index_site)] = rowlines[4]
                 
         # flip data so of frequency in decrease order   
         if self.data_flip_freq is True : 
+            
             if cf is True or self.occam_dtype_=='log_te': 
                 self.te_appRho=self.te_appRho[::-1]
                 self.te_phase = self.te_phase[::-1]
                 self.te_error_appRho= self.te_error_appRho[::-1]
                 self.te_error_phase= self.te_error_phase[::-1]
             if cf is True or self.occam_dtype_=='log_tm': 
                 self.tm_appRho=self.tm_appRho[::-1]
                 self.tm_phase = self.tm_phase[::-1]
                 self.tm_error_appRho=self.tm_error_appRho[::-1]
                 self.tm_error_phase=self.tm_error_phase[::-1]
                     
-                    
+        
 class DataBlock (object): 
     """
     Read OccamDataBlock aand set corresponding attributes 
      
     ======================  ===================================================
     Attributes              Description (Restriction)
     ======================  ===================================================
@@ -566,19 +571,18 @@
                     if items ==[int(ii) for ii in list(type_value)]: 
                         self.__setattr__('data_mode', key)
         
         for ikey in ['site', 'freq', 'error']: # 
             if hasattr(self, ikey):
                 if getattr(self, ikey) is not None : 
                     if ikey =='error' : 
-                        setattr(self, ikey, np.array([float(err) 
-                                                      for err in getattr(
-                                                              self, ikey)]))
-                    else : setattr(self, ikey, [int(sf) 
-                                                for sf in getattr(self, ikey)])
+                        setattr(self, ikey, np.array(
+                            [float(err)for err in getattr(self, ikey)]))
+                    else : setattr(self, ikey, 
+                                   [int(sf) for sf in getattr(self, ikey)])
   
         # check if all attribute are set from data  
         self._logging.info ('Ckeck dataBlocks and share corresponding'
                             ' data params.')
         
         _dbk= np.array([1 for attr in Data.data_blocks_header 
                         if getattr(self, attr) is not None ])
@@ -594,34 +598,36 @@
         
         for instance:
              site (1=site number 1=S00), freq(1: freq numb1),
                    dataType(5: logTM, 6:phaseTM) 
         like:
             dict_mode ={ '6': }
         """
-   
-        #create data mode dict and put all value inside 
-        if self.data_mode is not None : 
-            # self.dict_mode ={str(key): 
-                #[] for key in Data.occam_modes[self.data_mode]}
-            self.dict_mode ={self.data_mode:[]}
-
-        for kmode, vmode in self.dict_mode.items() : 
-            for itype , occamtype in enumerate(self.type)  : 
-                if str(int(occamtype)) == kmode : 
-    
-                    self.dict_mode[kmode].append(np.array([self.site[itype],
-                                                     self.freq[itype], 
-                                                     self.datum[itype], 
-                                                     self.error[itype]]))       
-        # put all value on array of [site, freq , datum , error] 
-        for key, values in self.dict_mode.items (): 
-            self.dict_mode [key] =func.concat_array_from_list(
-                list_of_array=values)
-     
+        def fill_mode_data (d, mode, keep_otype =False):
+            """ Build each occam data from logtem res/phase values. 
+            :param d: ndarray data of np.ndarray(nsites, 5)
+            :param mode: Occam mode from :attar:`Data.occam_modes`
+            :param keep_otype: Keep occam type inside the data. if ``True`` 
+                type column should be remove in the data. 
+            :return: dict of occam_mode values as dictkeys and their 
+                corresponding  data. 
+            """
+            mvalues = Data.occam_modes[mode]
+            m = {str(vk):d [d[:, 0] ==int(vk)] for ii, vk in enumerate(mvalues)} 
+            return m if keep_otype else {k: v[:, 1:] for k , v in m.items()}
+            
+        ar = func.concat_array_from_list(
+            [self.type, self.site, self.freq, self.datum, self.error], 
+            concat_axis=1 )
+        
+        self.dict_mode= fill_mode_data(ar, mode =self.data_mode)
+        
+        return self 
+    
+        
     @staticmethod
     def decode_each_site_data (data_blocks, data_type_index)  : 
         """
         Decode each site data and get differents values array 
         :param datablocks:  datafrom differents blocks
         :type datablocks: ndarray 
         
@@ -724,17 +730,16 @@
         self.model_mesh_type =kwargs.pop('mesh_type', 'PW2D')
         
         self.model_statics_file =kwargs.pop('prejudice_file', None) 
         self.model_prejudice_file =kwargs.pop('prejudice_file', None )
         self.model_binding_offset =kwargs.pop('binding_offset', None )
         self.model_num_layers =kwargs.pop('num_layers', None )
         self.model_exceptions = kwargs.pop('numbers_exceptions', None)
-        
-
-        
+        self.verbose = kwargs.pop('verbose', 0)
+   
         for key in list(kwargs.keys()):
             self.__setattr__(key, kwargs[key])
             
         if self.model_fn  is not None : 
             self.read_occam2d_modelfile ()
             
     def read_occam2d_modelfile(self, model_fn=None, mesh_fn=None , iter_fn=None):
@@ -774,19 +779,19 @@
             
             mess='Error Input file ! No {0} file found.'\
                 ' Please input {0} file.'.format(fname)
              
             if ifile is None : 
                 self._logging.error(mess)
                 warnings.warn(mess)
-                raise CSex.pyCSAMTError_occam2d(mess)
+                raise OccamError(mess)
                 
                 
         if self.iter_fn is None :
-            raise CSex.py
+            raise I2datError("NoneType can not be read ")
         
         if SB.which_file(filename =self.model_fn )=='model':
             with open(self.model_fn , 'r', encoding='utf8')as fmod : 
                 occam_model_datalines =fmod.readlines ()
     
         #initialise empty list for model columns and rows and populates attributes
         for ii, modelitem in enumerate(occam_model_datalines): 
@@ -840,15 +845,15 @@
                                len(self.model_columns), len(self.model_rows)), 
                            'Please check your <{0}> modelfile.'.format(
                                os.path.basename(self.model_fn) )
                            ])
                                                                           
             warnings.warn (mess)
             self._logging.error(mess)
-            raise CSex.pyCSAMTError_occam2d(mess)
+            raise OccamError(mess)
         
         #---> loop the model rows suppose the number of models layer 
         occm=0
         for mindex  in range(len(self.model_rows)): 
             #get the first inthe first in the pair of lines 
             #that describes a layer of model blocks.
             # sum to get the number of model layer at the end
@@ -883,57 +888,52 @@
         
         # make some arrays for plotting the model
         self.model_station_offsets = np.array([occam_mesh_x_nodes[:ii + 1].sum()
                                 for ii in range(len(occam_mesh_x_nodes))])
         self.model_depth_offsets = np.array([occam_mesh_z_nodes[:ii + 1].sum(
             )for ii in range(len(occam_mesh_z_nodes))])
                                 
-
         # center the grid onto the station coordinates
         x0 = self.model_binding_offset - self.model_station_offsets[
             self.model_columns[0][0]]
         self.model_station_offsets += x0
         
-        # rescalle the model offset to to have the top elevation to zero  
+        # rescal the model offset to to have the top elevation to zero  
         self.model_depth_offsets = self.model_depth_offsets -\
             self.model_depth_offsets[0]
         
         # self.model_plot_z = self.model_plot_z[::-1]  #--> flipping depth 
-
-
-        print('{0:-^37}'.format('Boundaries X (Horizontal nodes)'))
-        print('**{0:<27} {1} {2}'.format(' Minimum offset (m)','=' ,
-                                         self.model_station_offsets.min()))
-        print('**{0:<27} {1} {2}'.format(' Maximum offset (m)','=',
-                                         self.model_station_offsets.max()))
-        print('{0:-^37}'.format('Boundaries Z (Vertical nodes)'))
-        print('** {0:<20} {1} {2}'.format('Minimum depth (m)', '=',
-                                          self.model_depth_offsets.min()))
-        print('** {0:<20} {1} {2}'.format('Maximum depth (m)', '=',
-                                          self.model_depth_offsets.max()))
-        
-        print('{0:-^77}'.format('Occam 2D Models params'))
-        print('** {0:<27} {1} {2}'.format('Model layer num.', '=',
-                                          len(self.model_rows)))
-        print('** {0:<27} {1} {2}'.format('Model param count', '=',
-                                          occam_iter_obj.iter_param_count))
-
-        print('** {0:<27} {1} {2}'.format('Iteration num.', '=', 
-                                          occam_iter_obj.iter_iteration))
-        print('** {0:<27} {1} {2}'.format('Occam Misfit value', '=',
-                                          occam_iter_obj.iter_misfit_value))
-        print('** {0:<27} {1} {2}'.format('Occam Misfit reached', '=',
-                                          occam_iter_obj.iter_misfit_reached))
-        print('** {0:<27} {1} {2}'.format('Occam Misfit target', '=',
-                                          occam_iter_obj.iter_target_misfit))
-        print('** {0:<27} {1} {2}'.format('Occam Roughness params', '=',
-                                          self.model_roughness))
-
-        
-
+        if self.verbose > 0: 
+            print('{0:-^37}'.format('Boundaries X (Horizontal nodes)'))
+            print('**{0:<27} {1} {2}'.format(' Minimum offset (m)','=' ,
+                                             self.model_station_offsets.min()))
+            print('**{0:<27} {1} {2}'.format(' Maximum offset (m)','=',
+                                             self.model_station_offsets.max()))
+            print('{0:-^37}'.format('Boundaries Z (Vertical nodes)'))
+            print('** {0:<20} {1} {2}'.format('Minimum depth (m)', '=',
+                                              self.model_depth_offsets.min()))
+            print('** {0:<20} {1} {2}'.format('Maximum depth (m)', '=',
+                                              self.model_depth_offsets.max()))
+            
+            print('{0:-^77}'.format('Occam 2D Models params'))
+            print('** {0:<27} {1} {2}'.format('Model layer num.', '=',
+                                              len(self.model_rows)))
+            print('** {0:<27} {1} {2}'.format('Model param count', '=',
+                                              occam_iter_obj.iter_param_count))
+    
+            print('** {0:<27} {1} {2}'.format('Iteration num.', '=', 
+                                              occam_iter_obj.iter_iteration))
+            print('** {0:<27} {1} {2}'.format('Occam Misfit value', '=',
+                                              occam_iter_obj.iter_misfit_value))
+            print('** {0:<27} {1} {2}'.format('Occam Misfit reached', '=',
+                                              occam_iter_obj.iter_misfit_reached))
+            print('** {0:<27} {1} {2}'.format('Occam Misfit target', '=',
+                                              occam_iter_obj.iter_target_misfit))
+            print('** {0:<27} {1} {2}'.format('Occam Roughness params', '=',
+                                              self.model_roughness))
 
 class Startup(object): 
     """
     Occam startup file  Actually read startup file.
     for more detail:
     
     .. seealso:: http://marineemlab.ucsd.edu/Projects/Occam/sharp/index.html
@@ -1368,19 +1368,21 @@
                                 np.zeros((len(self.data_frequencies
                                               )-1, len(self.data_sites)))) 
                     
         #set attribute occam mode and occam _data type get from response file  
         self.__setattr__('occam_mode', occam_mode)
         self.__setattr__('occam_dtype', keymode)
 
-        print('{0:-^77}'.format('Occam 2D Response  infos'))
-        print('** {0:<27} {1} {2}'.format('Occam data type', '=',
-                                          tuple(self.occam_dtype)))
-        print('** {0:<27} {1} {2}'.format('Occam data mode', '=', 
-                                          tuple(self.occam_mode)))
+        if self.verbose > 0: 
+                
+            print('{0:-^77}'.format('Occam 2D Response  infos'))
+            print('** {0:<27} {1} {2}'.format('Occam data type', '=',
+                                              tuple(self.occam_dtype)))
+            print('** {0:<27} {1} {2}'.format('Occam data mode', '=', 
+                                              tuple(self.occam_mode)))
         
        
         # 
         if len(self.occam_mode)> 2 :
             mess ="".join(["Your data seems a Magnetotelluric (MT) data.",
                            " pyCSAMT works only with Controlled Source",
                            " Audio-frequency Magnetotelluric (CSAMT).", 
@@ -1555,16 +1557,14 @@
                 print('** {0:<27} {1} {2}'.format(
                     fwo+ ' shape:' + occ.split('_')[0].upper(
                         ) + " "+ occ.split('_')[1],
                                                   '=', 
                     getattr(self, 'resp_{0}_{1}'.format(
                         occ, fwo.lower())).shape))
     
-    
-          
 class Mesh(object): 
     """
     Read Occam read mesh file 
     
     Arguments
     -----------
         **mesh_fn** : str 
@@ -1607,17 +1607,18 @@
             self.mesh_fn= mesh_fn 
         if self.mesh_fn is not None :
             self._logging.info('read Occam2d meshfiles <%s>'% self.mesh_fn)
             if SB.which_file(filename =self.mesh_fn )=='mesh': 
                  with open(self.mesh_fn, 'r') as fmesh : 
                     occam_mesh_lines = fmesh.readlines()
             else : 
-                mess ='No Mesh file detected. Please provide the right occam2d mesh files.'
+                mess ='No Mesh file detected. Please provide the'\
+                    ' right occam2d mesh files.'
                 warnings.warn(mess), self._logging.error(mess)
-                raise CSex.pyCSAMTError_occam2d(mess)
+                raise OccamError(mess)
          # characteristic of the mesh (nblocks +1)
         mesh_char = occam_mesh_lines[1].strip().split()  
         # horizontal nodes , verticales nodes (nlayers+1)
         num_h_nodes ,num_v_nodes = int(mesh_char[1]), int(mesh_char[2]) 
 
         #initialise attribute x nodes and z nodes 
         self.mesh_x_nodes =np.zeros(num_h_nodes)
@@ -1716,38 +1717,42 @@
             
         if self.mesh_z_nodes.shape[0] != num_v_nodes:
             new_v_nodes = self.mesh_z_nodes.shape[0]
             #self.mesh_values.resize(new_h_nodes, num_v_nodes, 4)
             self.mesh_values =np.resize(self.mesh_values,
                                         (new_h_nodes , num_v_nodes, 4))
 
-    
-        print('{0:-^77}'.format('Occam 2D Mesh params '))
-        for im , nodes  in zip (['Horizontal', 'Vertical'],
-                                [[new_h_nodes,num_h_nodes ], 
-                                 [new_v_nodes,num_v_nodes]]) : 
-            mess='*** {0} nodes read = {1} instead of {2} in '\
-                'mesh files.'.format(im, nodes[0], nodes[1])
-            print(mess), self._logging.info(mess)
+        if self.verbose> 0: 
+            print('{0:-^77}'.format('Occam 2D Mesh params '))
+            
+            for im , nodes  in zip (['Horizontal', 'Vertical'],
+                                    [[new_h_nodes,num_h_nodes ], 
+                                     [new_v_nodes,num_v_nodes]]) : 
+                mess='*** {0} nodes read = {1} instead of {2} in '\
+                    'mesh files.'.format(im, nodes[0], nodes[1])
+                    
+                print(mess) 
+                self._logging.info(mess)
       
         # generate mesh x_grid and z_grid
 
         self.mesh_x_grid = self.mesh_x_nodes.copy()
         self.mesh_x_grid = np.append(self.mesh_x_grid, self.mesh_x_grid[-1])
        
         self.mesh_x_grid = np.array([self.mesh_x_grid[:ii].sum()
                                 for ii in range(self.mesh_x_grid.shape[0])])
         self.mesh_x_grid -= self.mesh_x_grid.mean()
         self.mesh_z_grid = np.array([self.mesh_z_nodes[:ii].sum()
                                 for ii in range(self.mesh_z_nodes.shape[0])])
         
-        print('---> {0:<20} {1} {2}'.format('Horizontal nodes',
-                                            '=',self.mesh_x_nodes.shape[0]))
-        print('---> {0:<20} {1} {2}'.format('Vertical nodes',
-                                            '=',self.mesh_z_nodes.shape[0]))
+        if self.verbose >0 : 
+            print('---> {0:<20} {1} {2}'.format('Horizontal nodes',
+                                                '=',self.mesh_x_nodes.shape[0]))
+            print('---> {0:<20} {1} {2}'.format('Vertical nodes',
+                                                '=',self.mesh_z_nodes.shape[0]))
         
   
 class Iter2Dat (object): 
     """
     Iter2Dat is a format converter which convert *.iter file and related mesh
     files to so called 'x,y,z' *.data file for post-processing.
     The class was inpired from the Bo Yang matlab script . reading functions come
@@ -1814,14 +1819,15 @@
         self.data_fn =data_fn
         self.iter_fn = iter_fn 
         self.mesh_fn =mesh_fn 
         
         self.bln_fn =kwargs.pop('bln_fn', None)
         self.savepath =kwargs.pop('savepath', None)
         self.OccamModel=kwargs.pop('occam_model_obj', None)
+        self.verbose  = kwargs.pop('verbose', 0)
         
         for keys in list(kwargs.keys()):
             self.__setattr__(keys, kwargs[keys])
             
         # initialise the main attributes
         for key in self.iter2d_params :self.__setattr__(key, None )  
        
@@ -1995,26 +2001,28 @@
             else : 
                 filename ='iter{0}.{1}{2}'.format(
                     int(self.iter_num), self.iter_roughness,
                     datetime.datetime.now().month)
             
         #-
         if self.elevation is None : 
-            mess='!Elevation is not provided. We gonna set to 0.'
-            print('-->'+mess)
+            if self.verbse :
+                mess='!Elevation is not provided. Set to 0.'
+                print('-->'+mess)
+                
             self._logging.debug(mess)
             
             if self.station_location is not None :  # assume station location exist
                 self.elevation  = np.repeat(0., len(self.station_location))
             
         else : 
             if isinstance(self.elevation , (list, tuple)) :
                 self.elevation  = np.array(self.elevation )
             assert len(self.elevation) == len(self.station_location) ,\
-                CSex.pyCSAMTError_occam2d(
+                OccamError(
                     'Elevation provided must be the same with offsets :'\
                       ' length|size ={0}.'.format(self.station_location.size))
         
         
         self._logging.info('Now write an associate file call *bln include'
                            ' :offset+elev+station name: Can be used'
                            ' straiforwardly for Golden software plot.')
@@ -2092,18 +2100,20 @@
                            'station names and station location.'])
             
             mess=mess.format(filename)
             
             warnings.warn('---> !'+mess)
             self._logging.debug(mess)
  
-        else : print('---> files {0}.dat & {0}.bln have been '
+        else : 
+          
+            print('---> files {0}.dat & {0}.bln have been '
                      'successfully written to  <{1}>.'.format(
                          filename, self.savepath))
-    
+        
     
     def read_iter2dat(self, iter2dat_fn =None, bln_fn =None, scale ='km',
                       model_fn=None, iter_fn=None , mesh_fn=None , doi='1km',
                       data_fn=None , occam_model_obj=None, **kws): 
         """
         Read YangBo iter2data file or provided  Occam 2D specific files .
 
@@ -2142,15 +2152,15 @@
             dz= 1000.
         elif scale.lower()in ['m', 'meter'] : 
             dz=1.
         else : 
             warnings.warn('---> Iter2Dat file is generally converted into km.'
                   ' so provided the specify unit of yourf file.')
                 
-            raise CSex.pyCSAMTError_occam2d_iter2dat(
+            raise I2datError(
                 'Wrong scale ! . Might be "m" or "km".')
             
         elev =kws.pop('elevation', None)
         if elev is not None :self.elevation  =elev 
 
         def validate_iter2dat_file (iter2dat_fn) : 
             """
@@ -2159,27 +2169,27 @@
             newf =[]
             if  os.path.isfile(iter2dat_fn) is False:
                 mess ='<%s> is not a file. Please check'\
                     ' your right path.' % iter2dat_fn
                 self._logging.error(mess)
                 warnings.warn(mess)
                 
-                raise CSex.pyCSAMTError_occam2d_iter2dat(mess)
+                raise I2datError(mess)
             else : 
                 with open(iter2dat_fn, 'r') as fi2d: 
                     iter2dat_readlines =fi2d.readlines()
                 for ii, item in enumerate(iter2dat_readlines) :
                     try : 
                         item =[float(i2d) for i2d in item.strip().split()] 
                     except : 
                         mess ='<{0}> is not Bo Yang data file.'\
                             ' Please provide the right iterartion file.'
                         warnings.warn(mess)
                         self._logging.error(mess)
-                        raise CSex.pyCSAMTError_occam2d_iter2dat(mess)
+                        raise I2datError(mess)
                     else :    
                         newf.append(item)
             return func.concat_array_from_list(list_of_array=newf)
         
          # statement , which file |data should be read 
         if iter2dat_fn is not None : 
             self.iter2dat_fn =iter2dat_fn 
@@ -2208,42 +2218,42 @@
                     None and self.data_fn is None : 
                      mess =''.join([
                          'Can not read iter2data files !None object is detected.', 
                     ',  Must supply at least mesh_file, iteration file ',
                     'and data file  or provided model obj.'])
                      warnings.warn(mess)
                      self._logging.error(mess)
-                     raise CSex.pyCSAMTError_occam2d_iter2dat(mess)
+                     raise I2datError(mess)
                     
                 self.OccamModel = Model(model_fn = self.model_fn ,
                                         iter_fn =self.iter_fn , 
                                         mesh_fn = self.mesh_fn )
                 
             elif self.model_fn is None and self.OccamModel is\
                 None  and self.data_fn is None : 
                 mess =''.join([
                     'Can not read iter2data files !None object is detected.', 
                     'Please provide modelfile, mesh file,',
                     ' data file or occam model obj .'])
                 warnings.warn(mess)
                 self._logging.error(mess)
-                raise CSex.pyCSAMTError_occam2d_iter2dat(mess)
+                raise I2datError(mess)
             elif self.OccamModel is not None :
                 # try to get an spacific attribute from Model 
                 try : 
                     getattr(self, 'model_station_offsets')
                 except : 
                     mess=''.join([
                         'Object provided is not an Python Model class object.',
                     ' Please provide a model object from occam2d module. e.g', 
                     '--> from pycsamt.modeling.occam2d import Model .'])
                     
                     warnings.warn(mess)
                     self._logging.error(mess)
-                    raise CSex.pyCSAMTError_occam2d_iter2dat(
+                    raise I2datError(
                         'Object provided is not a Model class object.'\
                         ' Please provide a right model obj. ')
             # thin now everything is fine then :    
             #----Get model_attribute from model_obj ------- 
 
             # get data offset _obj 
             occam_data_obj =Data(data_fn = self.data_fn)
@@ -2275,20 +2285,20 @@
             self.doi =punc.depth_of_investigation(doi=doi)
             # check the doi and the max z_nodes depth 
             #if user change the default doi value 
             
             if self.doi > model_plot_z.max() : 
                 mess ='doi provided = {0} m is much larger '\
                     'than maximum investigation depth ={1}.'\
-                    'We reset new doi = {1} m.'.format(doi, model_plot_z.max())
+                    'Set new doi = {1} m.'.format(doi, model_plot_z.max())
                 
                 warnings.warn(mess)
                 self._logging.debug(mess)
                 print('---> ! Input doi ={0} m was '
-                      'resetting to maxdepth ={1} m.'.format(
+                      'set to maxdepth ={1} m.'.format(
                           doi,model_plot_z.max() ))
                 
                 doi = model_plot_z.max()
             # slice matrix and get range 
             new_station_offsets,  new_depth_offsets, new_model_res_matrix= \
                 punc.slice_csamt_matrix(block_matrix =model_res ,
                                    offset_MinMax=(offs[0], offs[-1]),
@@ -2340,34 +2350,35 @@
                                               self.model_x_nodes.shape[0])) 
             mm=0
             for ii in range(len(self.model_z_nodes)) : 
                 for jj in range(len(self.model_x_nodes)): 
                     self.model_res[ii, jj] = iter2dat_data[:, 2][mm] 
                     mm +=1 
                     
-            print('{0:-^77}'.format('Iter2Dat *Data* info'))
-            
-            print('**{0:<37} {1} {2}'.format(
-                ' Mininum Limit vertical nodes (m)','=' ,
-                self.model_z_nodes.min() +1 ))
-            print('**{0:<37} {1} {2}'.format(
-                ' Maximum limit vertical nodes (m)','=' , 
-                self.model_z_nodes.max() +1 ))
-            print('**{0:<37} {1} {2}'.format(
-                ' Minimum limit Horizontal nodes (m) ',
-                '=' , self.model_x_nodes.min()+1))
-            print('**{0:<37} {1} {2}'.format(
-                ' Maximum limit Horizontal nodes(m)',
-                '=' , self.model_x_nodes.max()+1))
-            print('**{0:<37} {1} {2}'.format(
-                ' Horizontal nodes get from file ',
-                '=' , self.model_res.shape[1] +1))
-            print('**{0:<37} {1} {2}'.format(
-                ' Vertical nodes get from file ',
-                '=' , self.model_res.shape[0] +1))
+            if self.verbose >0: 
+                print('{0:-^77}'.format('Iter2Dat *Data* info'))
+                
+                print('**{0:<37} {1} {2}'.format(
+                    ' Mininum Limit vertical nodes (m)','=' ,
+                    self.model_z_nodes.min() +1 ))
+                print('**{0:<37} {1} {2}'.format(
+                    ' Maximum limit vertical nodes (m)','=' , 
+                    self.model_z_nodes.max() +1 ))
+                print('**{0:<37} {1} {2}'.format(
+                    ' Minimum limit Horizontal nodes (m) ',
+                    '=' , self.model_x_nodes.min()+1))
+                print('**{0:<37} {1} {2}'.format(
+                    ' Maximum limit Horizontal nodes(m)',
+                    '=' , self.model_x_nodes.max()+1))
+                print('**{0:<37} {1} {2}'.format(
+                    ' Horizontal nodes get from file ',
+                    '=' , self.model_res.shape[1] +1))
+                print('**{0:<37} {1} {2}'.format(
+                    ' Vertical nodes get from file ',
+                    '=' , self.model_res.shape[0] +1))
     
             if bln_fn is not None :
                 self.bln_fn = bln_fn 
                 
             if self.bln_fn is None or os.path.isfile(self.bln_fn) is False : 
                 mess=''.join([
                     ' ! Site file is not provided. Need  a Bo',
@@ -2395,44 +2406,45 @@
                                 #(lambda off : float(off) * dz, 0 , temb[:, ii] ))
                                 self.__setattr__(ss, np.array([
                                     float(off) for off in temb[:,ii]]) * dz)
                             except : 
                                 mess =" It seem all data from station and elevation "\
                                     "can not be convert into float value."\
                                         " Please check your data."
-                                raise CSex.pyCSAMTError_occam2d_iter2dat(mess)
+                                raise I2datError(mess)
             
-            print('{0:-^77}'.format('Iter2Dat *Station* info'))  
-            try : 
-                for ffmt, fmtvalue in zip ([
-                        ' Stations num.',' Minimum offset (m)',
-                        ' Maximum offset (m)' ], 
-                        [len(self.station_names),
-                         self.station_location.min(),
-                         self.station_location.max() ]):
-                    print('**{0:<27} {1} {2}'.format(ffmt,'=' , fmtvalue))
-            except : 
-                for ffmt in ([' Stations num.',' Minimum offset (m)',
-                              ' Maximum offset (m)' ]):
-                    print('**{0:<27} {1} {2}'.format(ffmt,'=' , None))
-                pass 
-
-                
-            if np.all(self.elevation == 0.) or self.elevation is None: 
-                print('*** ! Elevation not provided.')
-            else : 
-                print('**{0:<27} {1} {2}'.format(' Minimum elevation (m)',
-                                                 '=' , self.elevation.min()))
-                print('**{0:<27} {1} {2}'.format(' Maximum elevation (m)',
-                                                 '=' , self.elevation.max()))
+            if self.verbose > 0:
+                print('{0:-^77}'.format('Iter2Dat *Station* info'))  
+                try : 
+                    for ffmt, fmtvalue in zip ([
+                            ' Stations num.',' Minimum offset (m)',
+                            ' Maximum offset (m)' ], 
+                            [len(self.station_names),
+                             self.station_location.min(),
+                             self.station_location.max() ]):
+                        print('**{0:<27} {1} {2}'.format(ffmt,'=' , fmtvalue))
+                except : 
+                    for ffmt in ([' Stations num.',' Minimum offset (m)',
+                                  ' Maximum offset (m)' ]):
+                        print('**{0:<27} {1} {2}'.format(ffmt,'=' , None))
+                    pass 
+    
+                    
+                if np.all(self.elevation == 0.) or self.elevation is None: 
+                    print('*** ! Elevation not provided.')
+                else : 
+                    print('**{0:<27} {1} {2}'.format(' Minimum elevation (m)',
+                                                     '=' , self.elevation.min()))
+                    print('**{0:<27} {1} {2}'.format(' Maximum elevation (m)',
+                                                     '=' , self.elevation.max()))
                 
                 
 class occam2d_write(object):
     """
-    Special class to build occam2d imput files with :ref:`MTpy` module .
+    Special class to build occam2d imput files with `MTpy` module .
     
     Arguments
     --------
         **edi_fn**: str 
             full path to edifiles locations
         **freq_num** :float 
             number of frequencies to use in inversion
@@ -2501,30 +2513,28 @@
         >>>  occam2d_write.buildingInputfiles(os.path.join(os.environ['pyCSAMT'], 
         ...                                              'data', 'edi'), 
         ...                        savepath =os.path.join(os.environ['pyCSAMT'],
         ...                                               'data', 'tesocc2' ),
         ...                        geolectricke_strike=34.)
   
     """
+    verbose = 0 
+    if not imtpy :
+        mess = ''.join(['!!! Failed to import MTpy module ! You can get MTpy ', 
+                        'at <https://github.com/MTgeophysics/mtpy.git>`.!'])
+        print('---> '+ mess)
     
-    if SUCCESS_IMPORT_MTPY is False :
-        
-            mess = ''.join([
-                'Failed to import MTpy module ! '
-                'Could not build inputOccam2D files.', 
-                            ' Please try to install :ref:`MTpy` manually !'])
-            print('---> '+ mess)
-    
+   
     @staticmethod 
     def buildingInputfiles(edi_fn, freq_num =None , savepath =None ,
                                interpolate_freq =False, 
                                geoelectric_strike =None , **kwargs): 
         """
-        Method to build Occam2D inputfiles. Deal with :ref:`MTpy` module. 
-        Try to install :ref:`MTpy` is not installed yet.
+        Method to build Occam2D inputfiles. Deal with `MTpy`_ module. 
+        Try to install `MTpy`_ is not installed yet.
         
         :param edi_fn: full path to edifiles 
         :type edi_fn: str 
         
         :param freq_num:  number of frequencies to use in inversion
         :type freq_num: float
         
@@ -2536,15 +2546,15 @@
         :type geoelectric_strike: float
         
         :return: outfiles building occam2d inputfiles 
         :rtype: str , sys.stdout
    
         """
         
-        if SUCCESS_IMPORT_MTPY is False : return 
+        if not imtpy: return 
            
         freq_logspace =kwargs.pop('intp_freq_logspace', None)
         startup_basename =kwargs.pop('startup_basename', 'Startup')
         
         res_tm_error_floor =kwargs.pop('res_tm_err', 10.)
         phase_tm_error_floor =kwargs.pop('phase_tm_err', 20.)
         
@@ -2572,63 +2582,73 @@
         # collected the list of stations from edifile object 
         
         slst=[edi[0:-4] for edi in
               os.listdir(edi_fn) if edi.find('.edi')>0]
         
     
         # create an occam data object
-        
+         # if not specified will calculate from the data
+        if freq_logspace is not None: 
+            #freq_logspace= (-1,4,17 )
+            freq_logspace = np.logspace( *freq_logspace)  
         _logger.info('Read occam2d Data,'
                      ' write data and build regularization mesh ')
         
         ocd = MToccam2d.Data(edi_path=edi_fn,
                            station_list=slst,
-                           interpolate_freq=True,
-                           freq=np.logspace(*freq_logspace)
+                           interpolate_freq=interpolate_freq,
+                           freq= freq_logspace 
                            )
         ocd.save_path = savepath
         ocd.freq_num = freq_num# number of frequencies to invert
         
         #### make data file
         # geoelectric strike for rotation
-        # if not specified will calculate from the data
-        if freq_logspace is None: 
-            freq_logspace= (-1,4,17 )
+       
         ocd.geoelectric_strike = geoelectric_strike
-        print('---> geoelectric strike added !')
+        
+        if occam2d_write.verbose >0: 
+            print('---> geoelectric strike added !')
         
        
         if occam_model_mode not in ['{}'.format(mm) 
                                     for mm in list(Data.occam_dataType.keys())]: 
             msg=''.join(['Occam model mode provided is wrong !', 
                          ' Please select the convenient mode between',
                         '  the following list modes: {0}'])
                 
             _logger.error('occam model value given is out'
                           ' of the model mode range . ')
-            
             print('-- > '+ msg.format([
                 '{}'.format(mm) for mm in list(Data.occam_dataType.keys())]))
             return 
         
          # added error floors
         if occam_model_mode in ['5','6']: 
             ocd.model_mode= "6"
             ocd.res_tm_err = res_tm_error_floor
             ocd.phase_tm_err = phase_tm_error_floor
         elif occam_model_mode in ['1', '2']: 
             ocd.res_te_err = res_te_error_floor 
             ocd.phase_te_err = phase_te_error_floor 
             
-        print('---> Errors floors successfully  added !')
+        elif occam_model_mode =='4': 
+            ocd.model_mode ="4"
+            ocd.res_tm_err = res_tm_error_floor
+            ocd.phase_tm_err = phase_tm_error_floor
+            ocd.res_te_err = res_te_error_floor 
+            ocd.phase_te_err = phase_te_error_floor 
+            
+        if occam2d_write.verbose >0:     
+            print('---> Errors floors successfully  added !')
         
         # now write occam_data_file 
         ocd.write_data_file()
-        
-        print('---> Read occam2D data and write occam Data done !')
+        if occam2d_write.verbose >0: 
+            print('---> Read occam2D data and write occam Data done !')
         # make model and mesh files
   
         ocr = MToccam2d.Regularization(ocd.station_locations, 
                                        n_layers =number_of_layers, 
                                        cell_width = cell_width, 
                                        x_pad_multiplier = x_pad_multiplier, 
                                        trigger= trigger, 
@@ -2639,77 +2659,79 @@
                                         )
     
         ocr.build_mesh()
         ocr.build_regularization()
         ocr.write_mesh_file()
         ocr.write_regularization_file()
         ocr.plot_mesh()
-        
-        print('---> Build occam2d Regularization mesh  done !')
+        if occam2d_write.verbose >0: 
+            print('---> Build occam2d Regularization mesh  done !')
         # make startup file
         ocs=MToccam2d.Startup(iterations_to_run=iterations_to_run, 
                               startup_basename=startup_basename, 
                               data_fn=os.path.join(ocd.save_path,
                                                    OccamDataFile), 
                               resistivity_start=resistivity_start)
         ocr.get_num_free_params()
         ocs.param_count=ocr.num_free_param
         ocs.save_path=ocd.save_path
         ocs.model_fn=ocr.reg_fn
         ocs.write_startup_file()
-    
-        print('---> Build write occam2D startup file done !')
         
-        print('{0:-^77}'.format('Summary *occam2d input params* infos'))  
-        
-        print('**{0:<27} {1} {2}'.format(' Given frequency number',
-                                         '=' , freq_num))
-        print('**{0:<27} {1} {2}'.format(' Interpolate frequencies range',
-                                         '=' , freq_logspace))
-        
-        print('**{0:<27} {1} {2}'.format(' Occam model mode',
-                                         '=' , occam_model_mode))
-        
-        if occam_model_mode in ['6', '5']:
-            print('**{0:<27} {1} {2} %.'.format(' TM rho error floors',
-                                                '=' , res_tm_error_floor))
-            print('**{0:<27} {1} {2} %.'.format(' TM phase error floors',
-                                                '=' , phase_tm_error_floor))
-        elif occam_model_mode in ['1', '2']:
-            print('**{0:<27} {1} {2} %.'.format(' TE rho error floors',
-                                                '=' , res_te_error_floor))
-            print('**{0:<27} {1} {2} %.'.format(' TE phase error floors',
-                                                '=' , phase_te_error_floor))
-            
-        print('**{0:<27} {1} {2}'.format(' Model cell width',
-                                         '=' , cell_width ))
-        print('**{0:<27} {1} {2}'.format(' model horizontal pad',
-                                         '=' , x_pad_multiplier ))
-        print('**{0:<27} {1} {2}'.format(' Model bricks trigger',
-                                         '=' , trigger ))
-        
-        print('**{0:<27} {1} {2}'.format(' Number of model layers',
-                                         '=' , int(number_of_layers) ))
-        print('**{0:<27} {1} {2} m.'.format(' Top layer thickness',
-                                            '=' , z1_layer ))
-        print('**{0:<27} {1} {2} m.'.format(' Expected image depth',
-                                            '=' , z_target_depth))
-        print('**{0:<27} {1} {2} m.'.format(' Model bottom',
-                                            '=' , z_bottom ))
-        
-        print('**{0:<27} {1} {2}'.format(' Expected iteration to run',
-                                         '=' , iterations_to_run ))
-        print('**{0:<27} {1} {2} ohm.m'.format(' starting model resistivity',
-                                               '=' , np.power(10,
-                                                    resistivity_start) ))
-        
-        print('**{0:<27} {1} +{2} degrees E of N'.format(' Geoelectric strike',
-                                                    '=' ,geoelectric_strike))
-        
-        print('-'*77)  
+        if occam2d_write.verbose >0: 
+            print('---> Build write occam2D startup file done !')
+            
+            print('{0:-^77}'.format('Summary *occam2d input params* infos'))  
+            
+            print('**{0:<27} {1} {2}'.format(' Given frequency number',
+                                             '=' , freq_num))
+            print('**{0:<27} {1} {2}'.format(' Interpolate frequencies range',
+                                             '=' , (freq_logspace[0], freq_logspace[1])
+                                             ))
+            
+            print('**{0:<27} {1} {2}'.format(' Occam model mode',
+                                             '=' , occam_model_mode))
+            
+            if occam_model_mode in ['6', '5']:
+                print('**{0:<27} {1} {2} %.'.format(' TM rho error floors',
+                                                    '=' , res_tm_error_floor))
+                print('**{0:<27} {1} {2} %.'.format(' TM phase error floors',
+                                                    '=' , phase_tm_error_floor))
+            elif occam_model_mode in ['1', '2']:
+                print('**{0:<27} {1} {2} %.'.format(' TE rho error floors',
+                                                    '=' , res_te_error_floor))
+                print('**{0:<27} {1} {2} %.'.format(' TE phase error floors',
+                                                    '=' , phase_te_error_floor))
+                
+            print('**{0:<27} {1} {2}'.format(' Model cell width',
+                                             '=' , cell_width ))
+            print('**{0:<27} {1} {2}'.format(' model horizontal pad',
+                                             '=' , x_pad_multiplier ))
+            print('**{0:<27} {1} {2}'.format(' Model bricks trigger',
+                                             '=' , trigger ))
+            
+            print('**{0:<27} {1} {2}'.format(' Number of model layers',
+                                             '=' , int(number_of_layers) ))
+            print('**{0:<27} {1} {2} m.'.format(' Top layer thickness',
+                                                '=' , z1_layer ))
+            print('**{0:<27} {1} {2} m.'.format(' Expected image depth',
+                                                '=' , z_target_depth))
+            print('**{0:<27} {1} {2} m.'.format(' Model bottom',
+                                                '=' , z_bottom ))
+            
+            print('**{0:<27} {1} {2}'.format(' Expected iteration to run',
+                                             '=' , iterations_to_run ))
+            print('**{0:<27} {1} {2} ohm.m'.format(' starting model resistivity',
+                                                   '=' , np.power(10,
+                                                        resistivity_start) ))
+            
+            print('**{0:<27} {1} +{2} degrees E of N'.format(' Geoelectric strike',
+                                                        '=' ,geoelectric_strike))
+            
+            print('-'*77)  
 
         print('---> Building occamInputfiles  successfully done. ')  
  
          
 @mdeco.geoplot2d(reason='misfit', cmap ='bwr', climits=(-2,2), show_grid=False)
 def getMisfit(resp_fn =None, data_fn =None, kind='rho', **kwargs) : 
     """
@@ -2745,21 +2767,23 @@
     """
     
     # call reponse Object 
     mode =kwargs.pop('mode', None)
     oclogfile =kwargs.pop('logfile', None)
     
     useResiValue= kwargs.pop('residual', False)
+    verbose = kwargs.pop('verbose', 0)
+    
     if kind.lower().find('rho')>=0 or \
         kind.lower().find('res')>=0  or kind==1: 
         kind='rho'
     elif kind.lower().find('ph')>=0 or kind==2: 
         kind = 'phase'
     else :
-        raise CSex.pyCSAMTError_occam2d(
+        raise OccamError(
             f'Wrong argument kind {kind!r}.'
             'Should be `rho` or `phase`')
 
     resp_obj  =Response(response_fn =resp_fn , data_fn =data_fn)
     
     # get response values 
     #------------------------STATEMENT RESPONSE OBJECT ----------------------
@@ -2779,18 +2803,18 @@
         if mode not in  make_mode  : 
             mess =''.join([
                 'Occam mode provided ={0} is wrong !. Occam2D data mode is ={1}'.
                            format(mode, make_mode ),
                            'Please select the right mode.'])
             warnings.warn(mess)
             _logger().error (mess)                     
-            raise CSex.pyCSAMTError_occam2d(f' Mode `{mode}` is wrong!'
+            raise OccamError(f' Mode `{mode}` is wrong!'
                          'Do you mean {0}{1}?'.format(*resp_occam_dtype_obj))
         elif mode not in resp_occam_dtype_obj: 
-            raise CSex.pyCSAMTError_occam2d(f' Mode `{mode}` is wrong!'
+            raise OccamError(f' Mode `{mode}` is wrong!'
                          'Do you mean {0}{1}?'.format(*resp_occam_dtype_obj))
 
     # check the mode provided , can be str 
     for im , imode in enumerate(resp_obj.occam_mode) :
         if imode ==mode : 
             resp_occam_dtype_obj  =  resp_occam_dtype_obj [im]
             
@@ -2848,21 +2872,22 @@
             phase_data= resp_obj.tm_phase 
         else : phase_data = resp_obj.te_phase  
         
         fw_phase = getattr(resp_obj, 'resp_{}_forward_phase'.format(mode))
         # resp_misfit =phase_resi
         resp_misfit = ((phase_data - fw_phase)/phase_resi)%90/100
         
-    print('{0:=^77}'.format('Misfit Infos : Kind = {}'.format(kind.upper()))) 
-
-    print('** {0:<37} {1} {2} {3}'.format('Misfit max ','=',
-                                          resp_misfit.max(), '%' ))
-    print('** {0:<37} {1} {2} {3}'.format('Misfit min','=',
-                                          resp_misfit.min(), '%' ))
-    print('-'*77)
+    if verbose > 0: 
+        print('{0:=^77}'.format('Misfit Infos : Kind = {}'.format(kind.upper()))) 
+    
+        print('** {0:<37} {1} {2} {3}'.format('Misfit max ','=',
+                                              resp_misfit.max(), '%' ))
+        print('** {0:<37} {1} {2} {3}'.format('Misfit min','=',
+                                              resp_misfit.min(), '%' ))
+        print('-'*77)
     
     return (resp_misfit, resp_sites_names,
             resp_sites_offsets, resp_freq, model_rms, 
             model_roughness)  
   
 
 @mdeco.geoplot1d(reason = 'resp', color_mode='color', font_size=3.,
@@ -2943,30 +2968,30 @@
                      for file in os.listdir(resPath) 
                      if file.find('.dat')>=0]
         resp_fn = [os.path.join(resPath, file)  
                      for file in os.listdir(resPath) 
                      if file.find('.resp')>=0]
         
     if data_fn is None: 
-        raise CSex.pyCSAMTError_AVG(
+        raise AVGError(
             'No `Data` file detected. Please provide an occam data file.')
     elif isinstance(data_fn, str): 
         data_fn = [data_fn]
         
     if resp_fn is None: 
-        raise CSex.pyCSAMTError_occam2d(
+        raise OccamError(
             'No OccamResponse file detected.'
             ' Please provided an occcam Response file')
         
     elif isinstance(resp_fn, str): 
         resp_fn = [resp_fn]
     
     if len(data_fn) != len(resp_fn):
         a_, b_= len(data_fn) , len(resp_fn) 
-        raise CSex.pyCSAMTError_inputarguments('Number of Occam datafiles and'
+        raise ValueError('Number of Occam datafiles and'
                         'responses files must be the same length.'
                         f' `{a_}` and `{b_}` are given respectively.')
     
     if stations is None : 
         _logger.debug ( 'None sation found can not be plotted.'
                        'Should be considered the default value =`S00`.')
         stations =['S00']
@@ -2991,130 +3016,20 @@
                 " Note that each station must fit a given line. "
                 f"{'A single' if len(data_fn) ==1 else len(data_fn)}"
                 f" line{'s are' if len(data_fn)>1 else' is'} detected. Only "
                 f"{len(data_fn)} can be plotted. Data are shrunked to match"
                 f" the number of line ={len(data_fn)}.")
             station_list =station_list [:len(data_fn)]
         else:
-            raise CSex.pyCSAMTError_value(
+            raise ValueError(
                 "Data and stations to visualize must have the same "
                 f"length. But {len(data_fn)} and {len(station_list)} "
                 "were given respectively.")
             
-    def read_singleDataResponse( stn_INDEX, dfn , respfn): 
-        """ Read single occam response file and datafile 
-        Collect attribute for plots. Note `Response` inherits 
-        of `Data` class.  
-            
-        :param stn_INDEX: station index for plotting 
-        :param dfn: Data file to get data properties 
-        :param resp_fn: Response file to retrieve main properties 
-        
-        :returns:
-            - line: line name 
-            - stn: station to plot 
-            - frequencies 
-            - raw tm/te data and phase te/tm  on tuple 
-            - forward te/tm data and phase te/tm data on tuple 
-            - error te/tm 
-            -error phase 
-        """
-         
-        # line name id from response file
-        ln_id = os.path.basename(os.path.splitext(respfn)[0])
     
-        respObj = Response(response_fn = respfn , data_fn =dfn )
-        # get the name of site data
-        try : 
-            stnN = respObj.data_sites[stn_INDEX]
-        except: 
-            len_stnobj =len(respObj.data_sites) 
-            _logger.debug(
-            f" Too {'large' if stnN >len_stnobj else 'small'}."
-            "values. Default station should be `S00`.")
-            stnN  = 'S00'
-        
-        #--> Get occam mode and main response properties # tm_log10, tm_phase
-        oc_mode, oc_phs_mode = respObj.occam_dtype [0], respObj.occam_dtype[1]
-        # Get frequency in decrease order and remove the last freq 
-        freq = respObj.data_frequencies  # array 
-        if freq [0] > freq[-1]:  # frequeny ranged in decrease order
-            freq = freq [:-1]
-            # 
-        else : freq =freq [1:]
-        
-        #--- for resistivity tm data and forward 
-
-        # flag to read occamtype 'log_te_tm'
-        cflag=False
-    
-        if respObj.occam_dtype_ =='log_te_tm': 
-            cflag=True 
-            
-        if cflag is True or respObj.occam_dtype_ =='log_te': 
-            tm_data = respObj.te_appRho
-            te_error_appRho =respObj.te_error_appRho 
-            te_error_phase =respObj.te_error_phase 
-    
-        if cflag is True or respObj.occam_dtype_ =='log_tm': 
-            # Plot as default TM mode when `occam_dtype` is 'log_te_tm
-            tm_error_appRho =respObj.tm_error_appRho 
-            tm_error_phase =respObj.tm_error_phase 
-            tm_data =respObj.tm_appRho 
-        # errors from forward
-    
-        fw_data = getattr(respObj, 'resp_{}_forward'.format(oc_mode ))
-        
-        # --for phase data tm_phase and forward phase 
-        phase_data = getattr(respObj, 'resp_{}'.format(oc_phs_mode ))
-        fw_phase = getattr(respObj, 'resp_{}_forward_phase'.format(oc_mode ))
-        # 
-         # get residual errors  (input data - foward data)/ RESI 
-        fw_residual_rho = getattr(respObj,
-                                  'resp_{0}_residual'.format(oc_mode) )
-        c_= getattr(respObj, 'resp_{0}_residual'.format(oc_phs_mode) )
-        fw_phase_residual =c_
-        
-        # Raw error from occam data 
-        if error_type ==1 : 
-            misfit_rho = .01 * np.sqrt((tm_data -fw_data)**2/(tm_data**2) )
-            misfit_rho *= 100 # we plot in percentage 
-            misfit_phase = .01 * np.sqrt(
-                (phase_data -fw_phase)**2/(phase_data**2) )
-            misfit_phase = (misfit_phase*100)%90 # we plot in percentage 
-        elif error_type ==2: 
-            if cflag is True or respObj.occam_dtype_ =='log_tm': 
-                misfit_rho = tm_error_appRho
-                misfit_phase = tm_error_phase
-                
-            elif respObj.occam_dtype_ =='log_te': 
-                misfit_rho = te_error_appRho
-                misfit_phase = te_error_phase
-
-        elif error_type ==3: 
-            misfit_rho = (tm_data - fw_data)/fw_residual_rho
-            misfit_phase = np.abs((phase_data - fw_phase)/fw_phase_residual)%90
-            
-        elif error_type ==4: # plot only residual 
-        
-            misfit_rho = fw_residual_rho
-            misfit_phase=fw_phase_residual 
-            
-        # replace all nan value by 0 if exists. 
-        misfit_rho[np.isnan(misfit_rho)]=0.
-        misfit_phase[np.isnan(misfit_phase)]=0.
-        # put frequency on ohm.m not in log 10 
-        tm_data = np.power(10, tm_data)
-        fw_data = np.power(10, fw_data)
-        
-        return (ln_id, stnN, freq , (tm_data[:,stn_INDEX ], 
-                                     fw_data[:, stn_INDEX]),
-            (phase_data[:, stn_INDEX],fw_phase[:, stn_INDEX] ),\
-                misfit_rho[:, stn_INDEX], misfit_phase[:, stn_INDEX])
-
     # Initialise list # read the data and collect data 
     resp_lines, resp_stations, resp_freq, resp_appRHO, resp_phase,\
         resp_appRho_err, resp_phase_err=[[]for i in range(7)]
         
     # Get the index from stations list 
     # return tuple of index stations 
     stnIndex_lst = punc.station_id(station_list) 
@@ -3134,15 +3049,124 @@
         resp_appRho_err.append(r_appRho_err)        # misfit rho
         resp_phase_err.append(r_phase_err)          # misfit phase
             
     return (resp_lines, resp_stations, resp_freq, resp_appRHO, resp_phase,\
         resp_appRho_err, resp_phase_err, model_rms)
         
 
+def read_singleDataResponse( stn_INDEX, dfn , respfn, error_type): 
+    """ Read single occam response file and datafile 
+    Collect attribute for plots. Note `Response` inherits 
+    of `Data` class.  
+        
+    :param stn_INDEX: station index for plotting 
+    :param dfn: Data file to get data properties 
+    :param resp_fn: Response file to retrieve main properties 
+    
+    :returns:
+        - line: line name 
+        - stn: station to plot 
+        - frequencies 
+        - raw tm/te data and phase te/tm  on tuple 
+        - forward te/tm data and phase te/tm data on tuple 
+        - error te/tm 
+        -error phase 
+    """
+     
+    # line name id from response file
+    ln_id = os.path.basename(os.path.splitext(respfn)[0])
 
+    respObj = Response(response_fn = respfn , data_fn =dfn )
+    # get the name of site data
+    try : 
+        stnN = respObj.data_sites[stn_INDEX]
+    except: 
+        len_stnobj =len(respObj.data_sites) 
+        _logger.debug(
+        f" Too {'large' if stnN >len_stnobj else 'small'}."
+        "values. Default station should be `S00`.")
+        stnN  = 'S00'
+    
+    #--> Get occam mode and main response properties # tm_log10, tm_phase
+    oc_mode, oc_phs_mode = respObj.occam_dtype [0], respObj.occam_dtype[1]
+    # Get frequency in decrease order and remove the last freq 
+    freq = respObj.data_frequencies  # array 
+    if freq [0] > freq[-1]:  # frequeny ranged in decrease order
+        freq = freq [:-1]
+        # 
+    else : freq =freq [1:]
+    
+    #--- for resistivity tm data and forward 
+
+    # flag to read occamtype 'log_te_tm'
+    cflag=False
+
+    if respObj.occam_dtype_ =='log_te_tm': 
+        cflag=True 
+        
+    if cflag is True or respObj.occam_dtype_ =='log_te': 
+        tm_data = respObj.te_appRho
+        te_error_appRho =respObj.te_error_appRho 
+        te_error_phase =respObj.te_error_phase 
+
+    if cflag is True or respObj.occam_dtype_ =='log_tm': 
+        # Plot as default TM mode when `occam_dtype` is 'log_te_tm
+        tm_error_appRho =respObj.tm_error_appRho 
+        tm_error_phase =respObj.tm_error_phase 
+        tm_data =respObj.tm_appRho 
+    # errors from forward
+
+    fw_data = getattr(respObj, 'resp_{}_forward'.format(oc_mode ))
+    
+    # --for phase data tm_phase and forward phase 
+    phase_data = getattr(respObj, 'resp_{}'.format(oc_phs_mode ))
+    fw_phase = getattr(respObj, 'resp_{}_forward_phase'.format(oc_mode ))
+    # 
+     # get residual errors  (input data - foward data)/ RESI 
+    fw_residual_rho = getattr(respObj,
+                              'resp_{0}_residual'.format(oc_mode) )
+    c_= getattr(respObj, 'resp_{0}_residual'.format(oc_phs_mode) )
+    fw_phase_residual =c_
+    
+    # Raw error from occam data 
+    if error_type ==1 : 
+        misfit_rho = .01 * np.sqrt((tm_data -fw_data)**2/(tm_data**2) )
+        misfit_rho *= 100 # we plot in percentage 
+        misfit_phase = .01 * np.sqrt(
+            (phase_data -fw_phase)**2/(phase_data**2) )
+        misfit_phase = (misfit_phase*100)%90 # we plot in percentage 
+    elif error_type ==2: 
+        if cflag is True or respObj.occam_dtype_ =='log_tm': 
+            misfit_rho = tm_error_appRho
+            misfit_phase = tm_error_phase
+            
+        elif respObj.occam_dtype_ =='log_te': 
+            misfit_rho = te_error_appRho
+            misfit_phase = te_error_phase
+
+    elif error_type ==3: 
+        misfit_rho = (tm_data - fw_data)/fw_residual_rho
+        misfit_phase = np.abs((phase_data - fw_phase)/fw_phase_residual)%90
+        
+    elif error_type ==4: # plot only residual 
+    
+        misfit_rho = fw_residual_rho
+        misfit_phase=fw_phase_residual 
+        
+    # replace all nan value by 0 if exists. 
+    misfit_rho[np.isnan(misfit_rho)]=0.
+    misfit_phase[np.isnan(misfit_phase)]=0.
+    # put frequency on ohm.m not in log 10 
+    tm_data = np.power(10, tm_data)
+    fw_data = np.power(10, fw_data)
+    
+    return (ln_id, stnN, freq , (tm_data[:,stn_INDEX ], 
+                                 fw_data[:, stn_INDEX]),
+        (phase_data[:, stn_INDEX],fw_phase[:, stn_INDEX] ),\
+            misfit_rho[:, stn_INDEX], misfit_phase[:, stn_INDEX])
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/__init__.py` & `pycsamt-1.2.1/pycsamt/utils/_set_gdal.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,59 +1,73 @@
-#       Authors: Lars Krieger, Jared R. Peacock & Alison Louise Kirkby
-#       contact: < https://github.com/MTgeophysics/mtpy.git>
-#       Licence: GPL
-
-# Check for gdal availability at module level so we don't have to
-# do this every time a function in gis_tools is being called.
-from .decorator import gdal_data_check
-import os, re, sys
+#!/usr/bin/env python3
+# -*- coding: utf-8 -*-
+"""
+Created on Sun Dec 11 15:02:44 2022
+
+@author: daniel
+"""
+import os
+import re
+import sys
 import numpy as np
 
-HAS_GDAL = gdal_data_check(None)._gdal_data_found
+from pycsamt.utils.decorator import gdal_data_check
 
-if (not HAS_GDAL):
+def set_GDAL () : 
+    # Check for gdal availability at module level so we don't have to
+    # do this every time a function in gis_tools is being called.        
+    HAS_GDAL = gdal_data_check(None)._gdal_data_found
+    
+    is_pyproj = False 
+    if (not HAS_GDAL):
+        try:
+            import pyproj
+        except ImportError:
+            raise RuntimeError("Either GDAL or PyProj must be installed")
+        else: 
+            is_pyproj =True 
+        
+    EPSG_DICT = {}
+   
     try:
-        import pyproj
-    except ImportError:
-        raise RuntimeError("Either GDAL or PyProj must be installed")
-        # end try
-# end if
-
-EPSG_DICT = {}
-try:
-    import pyproj
-
-    epsgfn = os.path.join(pyproj.pyproj_datadir, 'epsg')
-
-    f = open(epsgfn, 'r')
-    lines = f.readlines()
-
-    for line in lines:
-        if ('#' in line): continue
-
-        epsg_code_val = re.compile('<(\d+)>').findall(line)
-
-        # print( "epsg_code_val", epsg_code_val)
-
-        if epsg_code_val is not None and len(epsg_code_val) > 0 and epsg_code_val[0].isdigit():
-            epsg_code = int(epsg_code_val[0])
-            epsg_string = re.compile('>(.*)<').findall(line)[0].strip()
-
-            EPSG_DICT[epsg_code] = epsg_string
-        else:
-            pass  #print("epsg_code_val NOT found for this line ", line, epsg_code_val)
-    #end for
-except Exception as e:
-    # Failed to load EPSG codes and corresponding proj4 projections strings from pyproj.
-    # Since version 1.9.5 the epsg file stored in pyproj_datadir has been removed and
-    # replaced by 'proj.db', which is stored in a different folder.
-    # Since the underlying proj4 projection strings haven't changed, we simply load a
-    # local copy of these mappings to ensure backward compatibility.
+        if is_pyproj: 
+            epsgfn = os.path.join(pyproj.pyproj_datadir, 'epsg')
+        
+            f = open(epsgfn, 'r')
+            lines = f.readlines()
+        
+            for line in lines:
+                if ('#' in line): continue
+                epsg_code_val = re.compile('<(\d+)>').findall(line)
+        
+                # print( "epsg_code_val", epsg_code_val)
+        
+                if epsg_code_val is not None and len(epsg_code_val) > 0 and epsg_code_val[0].isdigit():
+                    epsg_code = int(epsg_code_val[0])
+                    epsg_string = re.compile('>(.*)<').findall(line)[0].strip()
+        
+                    EPSG_DICT[epsg_code] = epsg_string
+                else:
+                    pass  
+                #print("epsg_code_val NOT found for this line ", line, epsg_code_val)
+            #end for
+        else :
+            # force set espsg.locally 
+            raise 
+        
+    except:
+        # Failed to load EPSG codes and corresponding proj4 projections strings from pyproj.
+        # Since version 1.9.5 the epsg file stored in pyproj_datadir has been removed and
+        # replaced by 'proj.db', which is stored in a different folder.
+        # Since the underlying proj4 projection strings haven't changed, we simply load a
+        # local copy of these mappings to ensure backward compatibility.
+    
+        path = os.path.dirname(os.path.abspath(__file__))
+        try:
+            epsg_dict_fn = os.path.join(path, 'epsg.npy')
+            EPSG_DICT = np.load(epsg_dict_fn, allow_pickle=True).item()
+        except: 
+            sys.stdout.write(f'Do not find `epsg.npy` in {epsg_dict_fn}')
 
-    path = os.path.dirname(os.path.abspath(__file__))
-    try:
-        epsg_dict_fn = os.path.join(path, 'epsg.npy')
-        EPSG_DICT = np.load(epsg_dict_fn, allow_pickle=True).item()
-    except: 
-        sys.stdout.write(f'Do not find `epsg.npy` in {epsg_dict_fn}')
 
-# end try
+    return HAS_GDAL , EPSG_DICT 
+
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/_csamtpylog.py` & `pycsamt-1.2.1/pycsamt/_csamtpylog.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/utils/_p.py` & `pycsamt-1.2.1/pycsamt/utils/_p.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,30 +1,24 @@
 # -*- coding: utf-8 -*-
 #       Created on Sat Dec 12 16:21:10 2020
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
-#       Licence: LGPL
+#       Licence: GPL
 """
+Module Infos 
+============== 
+Module contains various parameters  of files handling and the definition of 
+some technical words. It parses , asserts and controls  the  different inputs formats 
+recognized  by the software.
  
-.. _module-Infos::`csamtpy.etc.infos`
-
-    :synopsis: Module contains various parameters  of files handling and 
-        the definition of some technical words.
-
-.. warnings:: `_sensible` class is parser class. It parses and controls  the  
-                different inputs formats recognized  by the software.
-                class could affect how the software could run.
-                However, improving the code to become less expensive 
-                is welcome.
-                ...
 """
 import os
 import warnings
 import numpy as np 
 
-from pycsamt.utils._csamtpylog import csamtpylog 
+from pycsamt._csamtpylog import csamtpylog 
 from pycsamt.utils.exceptions import pyCSAMTError_file_handling
 
 class notion :
     """
     Definition singular class to explain CSAMT technical words. 
     Also usefull for user to have info  about any scientific context 
     the sofware introduces. Each warnings refering to any context
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/avg_utils.py` & `pycsamt-1.2.1/pycsamt/utils/avg_utils.py`

 * *Files 0% similar despite different names*

```diff
@@ -31,17 +31,18 @@
         return  a specified pd.Series :df[columns]
 """
 #==============================================================================
 import os 
 import numpy as np 
 import pandas as pd 
 
+from pycsamt._csamtpylog import csamtpylog
+
 from pycsamt.utils import gis_tools as gis 
 from pycsamt.utils import exceptions as CSex
-from pycsamt.utils._csamtpylog import csamtpylog
 from pycsamt.utils import func_utils as func
 from scipy.interpolate import interp1d
 _logger=csamtpylog.get_csamtpy_logger(__name__)
 #==============================================================================
 #--------------- special functions -----------------
 
 def _validate_stnprofile(profile_lines, spliting=None):
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/decorator.py` & `pycsamt-1.2.1/pycsamt/utils/decorator.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,25 +1,36 @@
 import functools
 import inspect
 import os
 import warnings 
-from pycsamt.utils._csamtpylog import csamtpylog
-
+from pycsamt._csamtpylog import csamtpylog
 
+class donothing : 
+    """ Decorator to do nothing. Just return the func as it was. 
+    The `param` reason is just used to specify the skipping reason. """
+    def __init__(self, reason = None ):
+        self.reason = reason 
+        
+    def __call__(self, cls_or_func) :
+        @functools.wraps (cls_or_func)
+        def new_func (*args, **kwargs): 
+            return cls_or_func (*args, **kwargs)
+        return new_func 
+    
 class deprecated(object):
     """
-        Description:
-            used to mark functions, methods and classes deprecated,
-            and prints warning message when it called
-            decorators based on https://stackoverflow.com/a/40301488
+    Description:
+        used to mark functions, methods and classes deprecated,
+        and prints warning message when it called
+        decorators based on https://stackoverflow.com/a/40301488
 
-        Usage:
-            todo: write usage
+    Usage:
+        todo: write usage
 
-        Date: 20/06/2017
+    Date: 20/06/2017
     """
     def __init__(self, reason):  # pragma: no cover
         if inspect.isclass(reason) or inspect.isfunction(reason):
             raise TypeError("Reason for deprecation must be supplied")
         self.reason = reason
 
     def __call__(self, cls_or_func):  # pragma: no cover
@@ -75,16 +86,16 @@
         self._func = func
         if not self._has_checked:
             self._gdal_data_found = self._check_gdal_data()
             self._has_checked = True
         if not self._gdal_data_found:
             if(raise_error):
                 raise ImportError("GDAL  is NOT installed correctly")
-            else:
-                self._logger.debug("Ignore GDAL as it is not working. Will use pyproj")
+            # else:
+            #     self._logger.debug("Ignore GDAL as it is not working. Will use pyproj")
 
     def __call__(self, *args, **kwargs):  # pragma: no cover
         return self._func(*args, **kwargs)
 
     def _check_gdal_data(self):
         if 'GDAL_DATA' not in os.environ:
             # gdal data not defined, try to define
@@ -133,25 +144,25 @@
             else:
                 self._logger.error("GDAL_DATA is set to: {}, but the path "
                                    "does not exist.".format(os.environ['GDAL_DATA']))
                 return False
 
 class deprecated_to(object) :
     """
-        Description:
-            used to replace deprecated functions or classes. 
-            Deprecated functions or class 
-            should be called others functions or classes.
-            
-        Usage:
-            .. todo:: use new function or class 
-            to replace old function method or class
-                with multiple parameters.
+    Description:
+        used to replace deprecated functions or classes. 
+        Deprecated functions or class 
+        should be called others functions or classes.
+        
+    Usage:
+        .. todo:: use new function or class 
+        to replace old function method or class
+            with multiple parameters.
 
-        Date: 18/10/2020
+    Date: 18/10/2020
     """
     
     _logger = csamtpylog.get_csamtpy_logger(__name__)
     
     def __init__(self, *args, **kwargs) :
         """
         self.new_func_or_cls is just a message of deprecating
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/func_utils.py` & `pycsamt-1.2.1/pycsamt/utils/func_utils.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,70 +1,84 @@
 # -*- coding: utf-8 -*-
 #       Created on Sun Sep 13 09:24:00 2020
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
-#       Licence: LGPL
+#       Licence: GPL
 
 """
+Module Utils 
+============= 
+Utilities and helpers functions: 
+    * check_dimensionality
+    * subprocess_module_installation
+    * cpath
+    * smart_format
+    * make_introspection
+    * show_quick_edi_stats
+    * sPath
+    * averageData 
+    * concat_array_from_list 
+    * sort_array_data 
+    * transfer_array_ (deprecated)
+    * interpol_scipy 
+    * _set_depth_to_coeff 
+    * broke_array_to_ 
+    * _search_ToFill_Data 
+    * straighten_out_list  
+    * take_firstValue_offDepth 
+    * dump_comma 
+    * build_wellData 
+    * compute_azimuth 
+    * build_geochemistry_sample 
+    * _nonelist_checker 
+    * _order_well 
+    * intell_index 
+    * _nonevalue_checker 
+    * _clean_space 
+    *_cross_eraser 
+    * _remove_str_word 
+    * stn_check_split_type
+    * minimum_parser_to_write_edi
+    * round_dipole_length
+    * keepmin  
+    * get_closest_value
+    * geo_length_checker
+    * fr_en_parser
+    * convert_csvdata_from_fr_to_en
+    * make_ids
+    * make_ll_coordinates 
+    * resize_resphase_values 
+    * _assert_all_types 
+    * scale_position 
+    * get_interpolate_freqs 
+    * fit_by_ll 
+    * build_array_from_objattr
+    * reshape_array 
+    * fillNaN
+    * ismissing 
+    * load2array
 
-.. _module-Func-utils::`pycsamt.utils.func_utils`  
-    :synopsis: helpers functions 
-        * check_dimensionality
-        * subprocess_module_installation
-        * cpath
-        * smart_format
-        * make_introspection
-        * show_quick_edi_stats
-        * sPath
-        * averageData 
-        * concat_array_from_list 
-        * sort_array_data 
-        * transfer_array_ (deprecated)
-        * interpol_scipy 
-        * _set_depth_to_coeff 
-        * broke_array_to_ 
-        *  _OlDFUNCNOUSEsearch_fill_data (deprecated)
-        * _search_ToFill_Data 
-        * straighten_out_list  
-        * take_firstValue_offDepth 
-        * dump_comma 
-        * build_wellData 
-        * compute_azimuth 
-        * build_geochemistry_sample 
-        * _nonelist_checker 
-        * _order_well 
-        * intell_index 
-        * _nonevalue_checker 
-        * _clean_space 
-        *_cross_eraser 
-        * _remove_str_word 
-        * stn_check_split_type
-        * minimum_parser_to_write_edi
-        * round_dipole_length
-        * keepmin  
-        * get_closest_value
-        * geo_length_checker
-        * fr_en_parser
-        * convert_csvdata_from_fr_to_en
 """
 
 import os 
 import sys 
 import subprocess 
 import shutil 
 import warnings
 import inspect
 import csv
+from copy import deepcopy
 import numpy as np 
+import pandas as pd 
 import matplotlib.pyplot as plt
-from copy import deepcopy
 
-import  pycsamt.utils.gis_tools as gis
+from . import HAS_GDAL 
+import pycsamt.utils.gis_tools as gis
 import pycsamt.utils.exceptions as CSex
 from pycsamt.utils.decorator import deprecated 
-from pycsamt.utils._csamtpylog import csamtpylog
+from pycsamt._csamtpylog import csamtpylog
 
 _logger = csamtpylog.get_csamtpy_logger(__name__)
 
 _msg= ''.join([
     'Note: need scipy version 0.14.0 or higher or interpolation,',
     ' might not work.']
 )
@@ -78,25 +92,692 @@
     scipy_version = [int(ss) for ss in scipy.__version__.split('.')]
     if scipy_version[0] == 0:
         if scipy_version[1] < 14:
             warnings.warn(_msg, ImportWarning)
             _logger.warning(_msg)
             
     import scipy.interpolate as spi
+    from scipy.optimize import curve_fit
+    from scipy.signal import argrelextrema 
 
     interp_import = True
  # pragma: no cover
 except ImportError: 
     
     warnings.warn(_msg0)
     _logger.warning(_msg0)
     
     interp_import = False
+
+
+def load2array(file, comments='#', delimiter=None,
+              converters=None, skiprows=0, **kws): 
+    """ Load data to array. 
     
+    Parameters
+    -----------
+    file: str, pathlib.Path, list of str, generator
+        File, filename, list, or generator to read. If the filename extension 
+        is .gz or .bz2, the file is first decompressed. Note that generators 
+        must return bytes or strings. The strings in a list or produced by
+        a generator are treated as lines.
+    
+    comments: str or sequence of str or None, optional
+        The characters or list of characters used to indicate the start of a 
+        comment. None implies no comments. For backwards compatibility, 
+        byte strings will be decoded as `latin1`. The default is ``#``.
+    
+    delimiters: tr, optional
+        The string used to separate values. For backwards compatibility, byte 
+        strings will be decoded as ``latin1``. The default is whitespace.
+    
+    converters: dict or callable, optional
+        A function to parse all columns strings into the desired value, or a
+        dictionary mapping column number to a parser function. E.g. if column
+        0 is a date string: converters = {0: datestr2num}. Converters can 
+        also be used to provide a default value for missing data, e.g. 
+        converters = lambda s: float(s.strip() or 0) will convert empty fields
+        to 0. Default: None.
+    
+    skiprows: int, optional
+        Skip the first skiprows lines, including comments; default: 0.
+    
+    kws: dict 
+        Additional keywords argument from :func:`np.load`. Refer to 
+        <https://numpy.org/doc/stable/reference/generated/numpy.load.html> 
+
+    """
+    return np.loadtxt(file, comments=comments, delimiter=delimiter, 
+                       converters=converters, skiprows=skiprows
+                       ) if os.path.splitext(file)[1]  =='.txt' else np.load(
+                           file, **kws)
+
+def scale_values(y, x=None, deg= None,  func =None): 
+    """ Scaling value using a fitting curve. 
+    
+    Create polyfit function from a specifc data points `x` to correct `y` 
+    values.  
+    
+    :param y: array-like of y-axis. Is the array of value to be scaled. 
+    
+    :param x: array-like of x-axis. If `x` is given, it should be the same 
+        length as `y`, otherwise and error will occurs. Default is ``None``. 
+    
+    :param func: callable - The model function, ``f(x, ...)``. It must take 
+        the independent variable as the first argument and the parameters
+        to fit as separate remaining arguments.  `func` can be a ``linear``
+        function i.e  for ``f(x)= ax +b`` where `a` is slope and `b` is the 
+        intercept value. It is recommended according to the `y` value 
+        distribution to set up  a custom function for better fitting. If `func`
+        is given, the `deg` is not needed.   
+        
+    :param deg: polynomial degree. If  value is ``None``, it should  be 
+        computed using the length of extrema (local and/or global) values.
  
+    :returns: 
+        - y: array scaled - projected sample values got from `f`.
+        - x: new x-axis - new axis  `x_new` generated from the samples.
+        - linear of polynomial function `f` 
+        
+    :references: 
+        Wikipedia, Curve fitting, https://en.wikipedia.org/wiki/Curve_fitting
+        Wikipedia, Polynomial interpolation, https://en.wikipedia.org/wiki/Polynomial_interpolation
+    :Example: 
+        >>> import numpy as np 
+        >>> import matplotlib.pyplot as plt 
+        >>> from pycsamt.utils.func_utils import scale_values 
+        >>> rdn = np.random.RandomState(42) 
+        >>> x0 =10 * rdn.rand(50)
+        >>> y = 2 * x0  +  rnd.randn(50) -1
+        >>> plt.scatter(x0, y)
+        >>> yc, x , f = scale_values(y) 
+        >>> plt.plot(x, y, x, yc) 
+        
+    """   
+
+    if str(func).lower() != 'none': 
+        if not hasattr(func, '__call__') or not inspect.isfunction (func): 
+            raise TypeError(
+                f'`func` argument is a callable not {type(func).__name__!r}')
+
+    # get the number of local minimum to approximate degree. 
+    minl, = argrelextrema(y, np.less) 
+    # get the number of degrees
+    degree = len(minl) + 1
+    if x is None: 
+        x = np.arange(len(y)) # np.linspace(0, 4, len(y))
+    if len(x) != len(y): 
+        raise ValueError(" `x` and `y` arrays must have the same length."
+                        f"'{len(x)}' and '{len(y)}' are given.")
+        
+    coeff = np.polyfit(x, y, int(deg) if deg is not None else degree)
+    f = np.poly1d(coeff) if func is  None else func 
+    yc = f (x ) # corrected value of y 
+
+    return  yc, x ,  f  
+
+def reshape(arr , axis = None) :
+    """ Detect the array shape and reshape it accordingly, back to the given axis. 
+    
+    :param array: array_like with number of dimension equals to 1 or 2 
+    :param axis: axis to reshape back array. If 'axis' is None and 
+        the number of dimension is greater than 1, it reshapes back array 
+        to array-like 
+    
+    :returns: New reshaped array 
+    
+    :Example: 
+        >>> import numpy as np 
+        >>> from pycsamt.utils.func_utils import reshape 
+        >>> array = np.random.randn(50 )
+        >>> array.shape
+        ... (50,)
+        >>> ar1 = reshape(array, 1) 
+        >>> ar1.shape 
+        ... (1, 50)
+        >>> ar2 =reshape(ar1 , 0) 
+        >>> ar2.shape 
+        ... (50, 1)
+        >>> ar3 = reshape(ar2, axis = None)
+        >>> ar3.shape # goes back to the original array  
+        >>> ar3.shape 
+        ... (50,)
+        
+    """
+    arr = np.array(arr)
+    if arr.ndim > 2 : 
+        raise ValueError('Expect an array with max dimension equals to 2' 
+                         f' but {str(arr.ndim)!r} were given.')
+        
+    if axis  not in (0 , 1, -1, None): 
+        raise ValueError(f'Wrong axis value: {str(axis)!r}')
+        
+    if axis ==-1:
+        axis =None 
+    if arr.ndim ==1 : 
+        # ie , axis is None , array is an array-like object
+        s0, s1= arr.shape [0], None 
+    else : 
+        s0, s1 = arr.shape 
+    if s1 is None: 
+        return  arr.reshape ((1, s0)) if axis == 1 else (arr.reshape (
+            (s0, 1)) if axis ==0 else arr )
+    try : 
+        arr = arr.reshape ((s0 if s1==1 else s1, )) if axis is None else (
+            arr.reshape ((1, s0)) if axis==1  else arr.reshape ((s1, 1 ))
+            )
+    except ValueError: 
+        # error raises when user mistakes to input the right axis. 
+        # (ValueError: cannot reshape array of size 54 into shape (1,1)) 
+        # then return to him the original array 
+        pass 
+
+    return arr    
+
+def make_ll_coordinates(reflong, reflat, nsites,  *,  r=45., utm_zone =None,   
+                        step='1km', order= '+', todms=False, is_utm =False,
+                        **kws): 
+    """ Generate multiples stations coordinates (longitudes, latitudes)
+    from a reference station/site.
+    
+    One degree of latitude equals approximately 364,000 feet (69 miles), 
+    one minute equals 6,068 feet (1.15 miles), and one-second equals 101 feet.
+    One-degree of longitude equals 288,200 feet (54.6 miles), one minute equals
+    4,800 feet (0.91 mile) , and one second equals 80 feet. Illustration showing
+    longitude convergence. (1 feet ~=0.3048 meter)
+    
+    Parameters 
+    ----------
+    reflong: float or string or list of [start, stop]
+        Reference longitude  in degree decimal or in DD:MM:SS for the first 
+        site considered as the origin of the landmark.
+        
+    reflat: float or string or list of [start, stop]
+        Reference latitude in degree decimal or in DD:MM:SS for the reference  
+        site considered as the landmark origin. If value is given in a list, 
+        it can containt the start point and the stop point. 
+        
+    nsites: int or float 
+        Number of site to generate the coordinates onto. 
+        
+    r: float or int 
+        The rotate angle in degrees. Rotate the angle features the direction
+        of the projection line. Default value is ``45`` degrees. 
+        
+    step: float or str 
+        Offset or the distance of seperation between different sites in meters. 
+        If the value is given as string type, except the ``km``, it should be 
+        considered as a ``m`` value. Only meters and kilometers are accepables.
+        
+    order: str 
+        Direction of the projection line. By default the projected line is 
+        in ascending order i.e. from SW to NE with angle `r` set to ``45``
+        degrees. Could be ``-`` for descending order. Any other value should 
+        be in ascending order. 
+    
+    is_utm: bool, 
+        Consider the first two positional arguments as UTM coordinate values. 
+        This is an alternative way to assume `reflong` and `reflat` are UTM 
+        coordinates 'easting'and 'northing` by default. If `utm2deg` is ``False``, 
+        any value greater than 180 degrees for longitude and 90 degrees for 
+        latitude will raise an error. Default is ``False``.
+        
+    utm_zone: string (##N or ##S)
+        utm zone in the form of number and North or South hemisphere, 10S or 03N
+        Must be given if `utm2deg` is set to ``True``. 
+                      
+    todms: bool 
+        Convert the degree decimal values into the DD:MM:SS. Default is ``False``. 
+        
+    kws: dict, 
+        Additional keywords of :func:`.gis_tools.gis.project_point_utm2ll`. 
+        
+    Returns 
+    -------
+        Tuple of  generated projected coordinates longitudes and latitudes
+        either in degree decimals or DD:MM:SS
+        
+    Notes 
+    ------
+    The distances vary. A degree, minute, or second of latitude remains 
+    fairly constant from the equator to the poles; however a degree, minute,
+    or second of longitude can vary greatly as one approaches the poles
+    and the meridians converge.
+        
+    References 
+    ----------
+    https://math.answers.com/Q/How_do_you_convert_degrees_to_meters
+    
+    Examples 
+    --------
+    >>> from pycsamt.utils.func_utils import make_ll_coordinates 
+    >>> rlons, rlats = make_ll_coordinates('110:29:09.00', '26:03:05.00', 
+    ...                                     nsites = 7, todms=True)
+    >>> rlons
+    ... array(['110:29:09.00', '110:29:35.77', '110:30:02.54', '110:30:29.30',
+           '110:30:56.07', '110:31:22.84', '110:31:49.61'], dtype='<U12')
+    >>> rlats 
+    ... array(['26:03:05.00', '26:03:38.81', '26:04:12.62', '26:04:46.43',
+           '26:05:20.23', '26:05:54.04', '26:06:27.85'], dtype='<U11')
+    >>> rlons, rlats = make_ll_coordinates ((116.7, 119.90) , (44.2 , 40.95),
+                                            nsites = 238, step =20. ,
+                                            order = '-', r= 125)
+    >>> rlons 
+    ... array(['119:54:00.00', '119:53:11.39', '119:52:22.78', '119:51:34.18',
+           '119:50:45.57', '119:49:56.96', '119:49:08.35', '119:48:19.75',
+           ...
+           '116:46:03.04', '116:45:14.43', '116:44:25.82', '116:43:37.22',
+           '116:42:48.61', '116:42:00.00'], dtype='<U12')
+    >>> rlats 
+    ... array(['40:57:00.00', '40:57:49.37', '40:58:38.73', '40:59:28.10',
+           '41:00:17.47', '41:01:06.84', '41:01:56.20', '41:02:45.57',
+           ...
+       '44:07:53.16', '44:08:42.53', '44:09:31.90', '44:10:21.27',
+       '44:11:10.63', '44:12:00.00'], dtype='<U11')
+    
+    """  
+    def assert_ll(coord):
+        """ Assert coordinate when the type of the value is string."""
+        try: coord= float(coord)
+        except ValueError: 
+            if ':' not in coord: 
+                raise ValueError(f'Could not convert value to float: {coord!r}')
+            else : 
+                coord = gis.convert_position_str2float(coord)
+        return coord
+    
+    xinf, yinf = None, None 
+    
+    nsites = int(_assert_all_types(nsites,int, float)) 
+    if isinstance (reflong, (list, tuple, np.ndarray)): 
+        reflong , xinf, *_ = reflong 
+    if isinstance (reflat, (list, tuple, np.ndarray)): 
+        reflat , yinf, *_ = reflat 
+    step=str(step).lower() 
+    if step.find('km')>=0: # convert to meter 
+        step = float(step.replace('km', '')) *1e3 
+    elif step.find('m')>=0: step = float(step.replace('m', '')) 
+    step = float(step) # for consistency 
+    
+    if str(order).lower() in ('descending', 'down', '-'): order = '-'
+    else: order ='+'
+    # compute length of line using the reflong and reflat
+    # the origin of the landmark is x0, y0= reflong, reflat
+    x0= assert_ll(reflong) if is_utm else assert_ll(
+        gis.assert_lon_value(reflong))
+    y0= assert_ll(reflat) if is_utm else assert_ll(
+        gis.assert_lat_value(reflat))
+    
+    xinf = xinf or x0  + (np.sin(np.deg2rad(r)) * step * nsites
+                          ) / (364e3 *.3048) 
+    yinf = yinf or y0 + (np.cos(np.deg2rad(r)) * step * nsites
+                         ) /(2882e2 *.3048)
+    
+    reflon_ar = np.linspace(x0 , xinf, nsites ) 
+    reflat_ar = np.linspace(y0, yinf, nsites)
+    #--------------------------------------------------------------------------
+    # r0 = np.sqrt(((x0-xinf)*364e3 *.3048)**2 + ((y0 -yinf)*2882e2 *.3048)**2)
+    # print('recover distance = ', r0/nsites )
+    #--------------------------------------------------------------------------
+    if is_utm : 
+        if utm_zone is None: 
+            raise TypeError("Please provide your UTM zone e.g.'10S' or '03N' !")
+        lon = np.zeros_like(reflon_ar) 
+        lat = lon.copy() 
+        
+        for kk , (lo, la) in enumerate (zip(reflat_ar, reflon_ar)): 
+            try : 
+                with warnings.catch_warnings(): # ignore multiple warnings 
+                    warnings.simplefilter('ignore')
+                    lat[kk], lon[kk] = gis.project_point_utm2ll(
+                        easting= lo, northing=la, utm_zone=utm_zone, **kws)
+            except : 
+                lat[kk], lon[kk] = gis.utm_to_ll(
+                    23, northing=la, easting=lo, zone=utm_zone)
+                
+        if not HAS_GDAL : 
+            warnings.warn("It seems GDAL is not set! will use the equations"
+                          "from USGS Bulletin 1532. Be aware, the positionning" 
+                          " is less accurate than using GDAL.")
+            
+        warnings.warn("By default 'easting' and 'northing' are presumed to match"
+                      " the first and second argument respectively.") 
+        
+        reflat_ar, reflon_ar = lat , lon 
+    
+    if todms:
+       reflat_ar = np.array(list(
+           map(lambda l: gis.convert_position_float2str(float(l)), reflat_ar)))
+       reflon_ar = np.array(list(
+           map(lambda l: gis.convert_position_float2str(float(l)), reflon_ar)))
+       
+    return (reflon_ar , reflat_ar ) if order =='+' else (
+        reflon_ar[::-1] , reflat_ar[::-1] )
+
+
+def build_array_from_objattr(obj, attr): 
+    """ Quick build array of object attributes value from collections object.
+    
+    :param obj: Iterable collections objects. 
+    :type obj: list, tuple or np.ndarray 
+    
+    :param attr: attribute value to retrieve from each collection object  
+    :type attr: str 
+    
+    :Example: 
+        >>> from pycsamt.core.edi import Edi_Collection
+        >>> from pycsamt.utils.func_utils import 
+        >>> edipath = r'/Users/Daniel/Desktop/ediout'
+        >>> cObjs = Edi_collection (edipath)
+        >>> # retrieve the latitude data and make array 
+        >>> qar = array_from_obj(cobjb1.ediObjs, 'lat')
+        ... array([0.        , 0.        , 0.00027778, 0.00027778, 0.00055556,
+               0.00083333, 0.00083333])
+    
+    """
+    if not isinstance( obj, (list, tuple, np.ndarray)): 
+        if not hasattr (obj, '__dict__'): 
+            raise ValueError ('Object should be an instance or a class'
+                              f' not: {type(obj).__name__!r}')
+        obj =[obj]
+        
+    if not hasattr(obj[0], attr): 
+        raise AttributeError (f'Object has no attribute {attr!r}')
+    
+    return np.array(list(map(lambda r: getattr(r, attr), obj )))
+
+
+def _assert_all_types (
+        obj: object , 
+        *expected_objtype: type 
+ ) -> object: 
+    """ Quick assertion of object type. Raise an `TypeError` if 
+    wrong type is given."""
+    # if np.issubdtype(a1.dtype, np.integer): 
+    if not isinstance( obj, expected_objtype): 
+        raise TypeError (
+            f'Expected type{"s" if len(expected_objtype)>1 else ""} '
+            f'{smart_format(tuple (o.__name__ for o in expected_objtype))}'
+            f' but {type(obj).__name__!r} is given.'
+            )
+            
+    return obj 
+
+def scale_position(ydata , xdata= None, func = None ,c_order= 0,
+        show: bool =False, todms=False,**kws): 
+
+    """ Correct data location or position and return new corrected location
+    or data. 
+    
+    Parameters 
+    ----------
+    ydata: array_like, series or dataframe
+        The dependent data, a length M array - nominally ``f(xdata, ...)``.
+        
+    xdata: array_like or object
+        The independent variable where the data is measured. Should usually 
+        be an M-length sequence or an (k,M)-shaped array for functions with
+        k predictors, but can actually be any object. If ``None``, `xdata` is 
+        generated by default using the length of the given `ydata`.
+        
+    func: callable 
+        The model function, ``f(x, ...)``. It must take the independent variable 
+        as the first argument and the parameters to fit as separate remaining
+        arguments. The default `func` is ``linear`` function i.e  for ``f(x)= ax +b``. 
+        where `a` is slope and `b` is the intercept value. Setting your own 
+        function for better fitting is recommended. 
+        
+    c_order: int or str
+        The index or the column name if ``ydata`` is given as a dataframe to 
+        select the right column for scaling.
+        
+    todms: bool 
+        Convert the decimal long/lat to DD:MM:SS. Default is ``False``. 
+        
+    show: bool 
+        Quick visualization of data distribution.
+
+    kws: dict 
+        Additional keyword argument from  `scipy.optimize_curvefit` parameters. 
+        Refer to `scipy.optimize.curve_fit`_.  
+        
+    Returns 
+    --------
+    - ydata - array -like - Data scaled 
+    - popt - array-like Optimal values for the parameters so that the sum of 
+        the squared residuals of ``f(xdata, *popt) - ydata`` is minimized.
+    - pcov - array like The estimated covariance of popt. The diagonals provide
+        the variance of the parameter estimate. To compute one standard deviation 
+        errors on the parameters use ``perr = np.sqrt(np.diag(pcov))``. How the
+        sigma parameter affects the estimated covariance depends on absolute_sigma 
+        argument, as described above. If the Jacobian matrix at the solution
+        doesn’t have a full rank, then ‘lm’ method returns a matrix filled with
+        np.inf, on the other hand 'trf' and 'dogbox' methods use Moore-Penrose
+        pseudoinverse to compute the covariance matrix.
+        
+    Examples
+    --------
+    >>> from pycsamt.utils.func_utils  import scale_position 
+    >>> from pycsamt.core.edi import Edi_collection 
+    >>> edipath = r'/Users/Daniel/Desktop/ediout'
+    >>> cObjs = Edi_collection (edipath)
+    >>> # correcting northing coordinates from latitude data 
+    >>> # corrected latitude coordinates using the default x.
+    >>> lat_corrected, *_= scale_position(ydata =cObjs.lat[:12])
+    >>> cObjs.lat[:12]
+    ... array([0.        , 0.        , 0.00027778, 0.00027778, 0.00055556,
+    ...       0.00083333, 0.00083333, 0.00111111, 0.00138889, 0.00138889,
+    ...       0.00166667, 0.00194444])
+    >>> lat_corrected
+    ... array([-1.31766381e-04,  4.79150482e-05,  2.27596478e-04,  4.07277908e-04,
+    ...        5.86959337e-04,  7.66640767e-04,  9.46322196e-04,  1.12600363e-03,
+    ...        1.30568506e-03,  1.48536649e-03,  1.66504792e-03,  1.84472934e-03])
+    >>> lat_corrected_dms, *_= scale_position(ydata =cObjs.lat[:12], todms=True)
+    ... array(['0:00:00.47', '0:00:00.17', '0:00:00.82', '0:00:01.47',
+    ...       '0:00:02.11', '0:00:02.76', '0:00:03.41', '0:00:04.05',
+    ...       '0:00:04.70', '0:00:05.35', '0:00:05.99', '0:00:06.64'],
+          dtype='<U10')
+    """
+    
+    def linfunc (x, a, b): 
+        """ Set the simple linear function"""
+        return a * x + b 
+        
+    if str(func).lower() in ('none' , 'linear'): 
+        func = linfunc 
+    elif not hasattr(func, '__call__') or not inspect.isfunction (func): 
+        raise TypeError(
+            f'`func` argument is a callable not {type(func).__name__!r}')
+        
+    ydata = _assert_all_types(ydata, list, tuple, np.ndarray,
+                              pd.Series, pd.DataFrame  )
+    c_order = _assert_all_types(c_order, int, float, str)
+    try : c_order = int(c_order) 
+    except: pass 
+
+    if isinstance(ydata, pd.DataFrame): 
+        if c_order ==0: 
+            warnings.warn("The first column of the data should be considered"
+                          " as the `y` target.")
+        if c_order is None: 
+            raise TypeError('Dataframe is given. The `c_order` argument should '
+                            'be defined for column selection. Use column name'
+                            ' instead')
+        if isinstance(c_order, str): 
+            # check whether the value is on the column name
+            if c_order.lower() not in list(map( 
+                    lambda x :x.lower(), ydata.columns)): 
+                raise ValueError (
+                    f'c_order {c_order!r} not found in {list(ydata.columns)}'
+                    ' Use the index instead.')
+                # if c_order exists find the index and get the 
+                # right column name 
+            ix_c = list(map( lambda x :x.lower(), ydata.columns)
+                        ).index(c_order.lower())
+            ydata = ydata.iloc [:, ix_c] # series 
+        elif isinstance (c_order, (int, float)): 
+            c_order =int(c_order) 
+            if c_order >= len(ydata.columns): 
+                raise ValueError(
+                    f"`c_order`'{c_order}' should be less than the number of " 
+                    f"given columns '{len(ydata.columns)}'. Use column name instead.")
+            ydata= ydata.iloc[:, c_order]
+            
+    ydata = np.array(ydata)
+    if xdata is None: 
+        xdata = np.linspace(0, 4, len(ydata))
+    if len(xdata) != len(ydata): 
+        raise ValueError(" `x` and `y` arrays must have the same length."
+                        f"'{len(xdata)}' and '{len(ydata)}' are given.")
+
+    popt, pcov = curve_fit(func, xdata, ydata, **kws)
+    ydata_new = func(xdata, *popt)
+    
+    if show:
+        plt.plot(xdata, ydata, 'b-', label='data')
+        plt.plot(xdata, func(xdata, *popt), 'r-',
+             label='fit: a=%5.3f, b=%5.3f' % tuple(popt))
+        plt.xlabel('x')
+        plt.ylabel('y')
+        plt.legend()
+        plt.show()
+        
+    if todms: 
+        ydata_new= np.array(list(map(lambda l: gis.convert_position_float2str(
+            float(l)), ydata_new)))
+        
+    return ydata_new, popt, pcov 
+
+
+def make_ids(arr, prefix =None, how ='py'): 
+    """ Generate auto Id according to the number of given sites. 
+    
+    :param arr: Iterable object to generate an id site . For instance it can be 
+        the array-like or list of EDI object that composed a collection of 
+        pycsamt.core.edi.Edi object. 
+    :type ediObjs: array-like, list or tuple 
+
+    :param prefix: string value to add as prefix of given id. Prefix can be 
+        the site name.
+    :type prefix: str 
+    
+    :param how: Mode to index the station. Default is 'Python indexing' i.e. 
+        the counting starts by 0. Any other mode will start the counting by 1.
+    :type cmode: str 
+    
+    :return: ID number formated 
+    :rtype: list 
+    
+    :Example: 
+        >>> from pycsamt.utils.func_utils import make_ids 
+        >>> values = ['edi1', 'edi2', 'edi3'] 
+        >>> make_ids (values, 'ix')
+        ... ['ix0', 'ix1', 'ix2']
+        
+    """ 
+    fm='{:0' +'{}'.format(int(np.log10(len(arr))) + 1) +'}'
+    id_ =[str(prefix) + fm.format(i if how=='py'else i+ 1 ) if prefix is not 
+          None else fm.format(i if how=='py'else i+ 1) 
+          for i in range(len(arr))] 
+    return id_
+
+def fit_by_ll(ediObjs): 
+    """ Fit edi by location and reorganize EDI (sort EDI) according to the site  
+    longitude and latitude coordinates. 
+    
+    EDIs data are mostly reading in an alphabetically order, so the reoganization  
+
+    according to the location(longitude and latitude) is usefull for distance 
+    betwen site computing with a right position at each site.  
+    
+    :param ediObjs: list of EDI object , composed of a collection of 
+        pycsamt.core.edi.Edi object 
+    :type ediObjs: pycsamt.core.edi.Edi_Collection 
+
+    
+    :returns: array splitted into ediObjs and Edifiles basenames 
+    :rtyple: tuple 
+    
+    :Example: 
+        >>> import numpy as np 
+        >>> from pycsamt.core.edi import Edi_Collection 
+        >>> from pycsamt.utils.func_utils import fit_by_ll
+        >>> edipath ='data/edi_ss' 
+        >>> cediObjs = Edi_Collection (edipath) 
+        >>> ediObjs = np.random.permutation(cediObjs.ediObjs) # shuffle the  
+        ... # the collection of ediObjs 
+        >>> ediObjs, ediObjbname = fit_by_ll(ediObjs) 
+        ...
+    
+    """
+    #get the ediObjs+ names in ndarray(len(ediObjs), 2) 
+    objnames = np.c_[ediObjs, np.array(
+        list(map(lambda obj: os.path.basename(obj.edifile), ediObjs)))]
+    lataddlon = np.array (list(map(lambda obj: obj.lat + obj.lon , ediObjs)))
+    sort_ix = np.argsort(lataddlon) 
+    objnames = objnames[sort_ix ] 
+    #ediObjs , objbnames = np.hsplit(objnames, 2) 
+    return objnames[:, 0], objnames[:, -1]
+
+
+def get_interpolate_freqs (ediObjs, to_log10 =False): 
+    """ From EDI objects, collected thefrequencies Min, Max and find the 
+    frequency for interpolating. 
+    
+    This method is usefull when a collection of EDI-files have some missing 
+    frequency data. 
+    
+    :param ediObjs: list - Collections of EDI-objects 
+    :type ediobjs : pycsamt.core.edi.Edi 
+    
+    :param to_log10: Put the interpolated min-max frequency to log10 values
+    
+    :type to_log10: bool 
+    :returns: Array-like min max and auto-number of frequency for interpolating. 
+    :rtype: tuple
+    
+    :Example: 
+        >>> from pycsamt.core.edi import Edi_collection 
+        >>> from pycsamt.utils.func_utils import find_interpolate_freq
+        >>> edipath = r'/Users/Daniel/Desktop/edi'
+        >>> cObjs = Edi_collection (edipath)
+        >>> ifreqs, nfreq= get_interpolate_freq(cObjs.ediObjs) 
+        >>> ifreqs, nfreq
+        ... array([5.625e+00, 5.880e+04]), 56 # i.e minimum frequency 
+            for interpolation is 5.625e+00 while the max is 5.880e+04
+            and the number of frequency that can be interpolated is 56. 
+    """
+    # create a matrix of ndarray (nedifiles, [nfreq, minfreq, maxfreq])
+    if not isinstance(ediObjs, (list, tuple)): 
+        ediObjs =[ediObjs]
+
+    freqs= np.zeros((len(ediObjs), 3))
+    #edins = np.zeros_like(freqs , dtype ='>U20')
+    for ii, ediobj in enumerate (ediObjs) : 
+        freqs[ii] = [len(ediobj.Z._freq),ediobj.Z._freq.min(), 
+                     ediobj.Z._freq.max() ]
+        #edins [ii]= os.path.basename(ediobj.edifile).replace('.edi', '') 
+    # frequency for interpolate should be in the bound of frequency ranges 
+    # take all minimum in axis 0 and replace the 
+    # min ranges frequency by the higher to bound the frequency ranges 
+    freqi = freqs.min(0) 
+    freqi[1]= freqs[:, 1].max() 
+
+    # find  the index a  check the edifiles 
+    #ix = np.where (np.all (freqs ==freqs.max(0), axis = 1)) 
+    # get the number of frequency for max freq and in freq columns 
+    fmaxs = freqs[:, 0][freqs [:, -1]==freqi[-1]]
+    fmins = freqs[:, 0][freqs [:, -2]==freqi[-2]]
+    # for consistency if array are composed of repeated max |min values 
+    nfreq = max ( fmaxs.max(),  fmins.max()) 
+    ifreqs = freqi[1:] # exclude the number of freq of each edi (column 0)
+
+    return (np.log10(ifreqs), np.int(nfreq)) if to_log10 else (
+        ifreqs, np.int(nfreq))
+                     
 
 def check_dimensionality(obj, data, z, x):
     """ Check dimensionality of data and fix it.
     
     :param obj: Object, can be a class logged or else.
     :param data: 2D grid data of ndarray (z, x) dimensions
     :param z: array-like should be reduced along the row axis
@@ -201,17 +882,19 @@
     else : 
         if verbose > 0: 
             print(f"{action_msg.capitalize()} of `{module}` "
                       "and dependancies was successfully done!") 
         
     return MOD_IMP 
         
-def smart_format(iter_obj): 
+def smart_format(iter_obj, choice ='and'): 
     """ Smart format iterable obj 
     :param iter_obj: iterable obj 
+    :param choice: str - whether the element in `iter_obj` are  compulsory or 
+        not. If not ,`choice` can be set to ``or``. 
     
     :Example: 
         >>> from pycsamt.utils.func_utils import smart_format
         >>> smart_format(['model', 'iter', 'mesh', 'data'])
         ... 'model','iter','mesh' and 'data'
     """
     try: 
@@ -219,15 +902,15 @@
     except:  return f"{iter_obj}"
     
     iter_obj = [str(obj) for obj in iter_obj]
     if len(iter_obj) ==1: 
         str_litteral= ','.join([f"{i!r}" for i in iter_obj ])
     elif len(iter_obj)>1: 
         str_litteral = ','.join([f"{i!r}" for i in iter_obj[:-1]])
-        str_litteral += f" and {iter_obj[-1]!r}"
+        str_litteral += f" {choice} {iter_obj[-1]!r}"
     return str_litteral
 
 def make_introspection(Obj , subObj): 
     """ Make introspection by using the attributes of instance created to 
     populate the new classes created.
     :param Obj: callable 
         New object to fully inherits of `subObject` attributes 
@@ -239,28 +922,30 @@
     # Obj attributes get the priority.
     for key, value in  subObj.__dict__.items(): 
         if not hasattr(Obj, key) and key  != ''.join(['__', str(key), '__']):
             setattr(Obj, key, value)
             
 def cpath (savepath=None , dpath= None): 
     """ Control the existing path and create one of it does not exist.
+    
     :param savepath: Pathlike obj, str 
     :param dpath: str, default pathlike obj
     """
     if dpath is None:
         file, _= os.path.splitext(os.path.basename(__file__))
         dpath = ''.join(['_', file,
                          '_']) #.replace('.py', '')
     if savepath is None : 
         savepath  = os.path.join(os.getcwd(), dpath)
     if savepath is not None:
         try :
             if not os.path.isdir(savepath):
                 os.mkdir(savepath)#  mode =0o666)
-        except : pass 
+        except : pass
+    
     return savepath   
 
 def show_quick_edi_stats(nedic , nedir, fmtl='~', lenl=77): 
     """ Format the Edi files and ckeck the number of edifiles
     successfully read. 
     :param nedic: number of input or collected edifiles 
     :param nedir: number of edifiles read sucessfully 
@@ -277,15 +962,15 @@
     nedic = get_obj_len(nedic)
     nedir = get_obj_len(nedir)
     
     print(fmtl * lenl )
     mesg ='|'.join( ['|{0:<15}{1:^2} {2:<7}',
                      '{3:<15}{4:^2} {5:<7}',
                      '{6:<9}{7:^2} {8:<7}%|'])
-    print(mesg.format('EDI collected','=',  nedic, 'EDI success. read',
+    print(mesg.format('Data collected','=',  nedic, 'EDI success. read',
                       '=', nedir, 'Rate','=', round ((nedir/nedic) *100, 2),
                       2))
     print(fmtl * lenl )
 
 def sPath (name_of_path:str):
     """ Savepath func. Create a path  with `name_of_path` 
     if path not exists.
@@ -368,93 +1053,62 @@
     
     np_out_put=concat_array_from_list(list_of_array=global_list,
                                       concat_axis=axis_average) 
     np_out_put=np_out_put.astype(astype)       
 
     return np_out_put
 
-
-def concat_array_from_list(list_of_array, concat_axis=0):
-    """
-    Small function to concatenate a list with array contents 
+def concat_array_from_list (list_of_array , concat_axis = 0) :
+    """ Concat array from list and set the None value in the list as NaN.
+    
+    :param list_of_array: List of array elements 
+    :type list of array: list 
+    
+    :param concat_axis: axis for concatenation ``0`` or ``1``
+    :type concat_axis: int 
+    
+    :returns: Concatenated array with shape np.ndaarry(
+        len(list_of_array[0]), len(list_of_array))
+    :rtype: np.ndarray 
     
-    Parameters 
-    -----------
-        * list_of_array : list 
-                contains a list for array data. the concatenation is possible 
-                if an index array have the same size 
-        
-    Returns 
-    -------
-        array_like 
-            numpy concatenated data 
-        
     :Example: 
-        
-        >>> import numpy as np 
-        >>>  np.random.seed(0)
-        >>> ass=np.random.randn(10)
-        >>> ass2=np.linspace(0,15,12)
-        >>>  ass=ass.reshape((ass.shape[0],1))
-        >>>  ass2=ass2.reshape((ass2.shape[0],1))
-        >>> or_list=[ass,ass2]
-        >>> ss_check_error=concat_array_from_list(list_of_array=or_list,
-        ...                                          concat_axis=0)
-        >>>  secont test :
-        >>>  ass=np.linspace(0,15,14)
-        >>> ass2=np.random.randn(14)
-        >>> ass=ass.reshape((ass.shape[0],1))
-        >>> ass2=ass2.reshape((ass2.shape[0],1))
-        >>> or_list=[ass,ass2]
-        >>>  ss=concat_array_from_list(list_of_array=or_list, concat_axis=0)
-        >>> ss=concat_array_from_list(list_of_array=or_list, concat_axis=1)
-        >>> ss
-        >>> ss.shape 
+    >>> import numpy as np 
+    >>> from pycsamt.utils.func_utils import concat_array_from_list 
+    >>> np.random.seed(0)
+    >>> ass=np.random.randn(10)
+    >>> ass = ass2=np.linspace(0,15,10)
+    >>> concat_array_from_list ([ass, ass]) 
+    
     """
-    #first attemp when the len of list is ==1 :
+    concat_axis =int(_assert_all_types(concat_axis, int, float))
+    if concat_axis not in (0 , 1): 
+        raise ValueError(f'Unable to understand axis: {str(concat_axis)!r}')
     
+    list_of_array = list(map(lambda e: np.array([np.nan])
+                             if e is None else np.array(e), list_of_array))
+    # if the list is composed of one element of array, keep it outside
+    # reshape accordingly 
     if len(list_of_array)==1:
-        if type(list_of_array[0])==np.ndarray:
-            output_array=list_of_array[0]
-            if output_array.ndim==1:
-                if concat_axis==0 :
-                    output_array=output_array.reshape((1,output_array.shape[0]))
-                else :
-                    output_array=output_array.reshape((output_array.shape[0],1))
-            return output_array
-        
-        elif type(list_of_array[0])==list:
-            output_array=np.array(list_of_array[0])
-            if concat_axis==0 :
-                output_array=output_array.reshape((1,output_array.shape[0]))
-            else :
-                output_array=output_array.reshape((output_array.shape[0],1))
-            return output_array
-    
-    # check the size of array in the liste when the len of list is >=2
-    
-    for ii,elt in enumerate(list_of_array) :
-        if type(elt)==list:
-            elt=np.array(elt)
-        if elt is None :
-            pass
-        elif elt.ndim ==1 :
-            if concat_axis==0 :
-                elt=elt.reshape((1,elt.shape[0]))
-            else :
-                elt=elt.reshape((elt.shape[0],1))
-        list_of_array[ii]=elt
- 
-
-    output_array=list_of_array[0]
-    for ii in list_of_array[1:]:
-        output_array=np.concatenate((output_array,ii), axis=concat_axis)
-        
-    return output_array
-
+        ar = (list_of_array[0].reshape ((1,len(list_of_array[0]))
+                 ) if concat_axis==0 else list_of_array[0].reshape(
+                        (len(list_of_array[0]), 1)
+                 )
+             ) if list_of_array[0].ndim ==1 else list_of_array[0]
+                     
+        return ar 
+
+    #if concat_axis ==1: 
+    list_of_array = list(map(
+            lambda e:e.reshape(e.shape[0], 1) if e.ndim ==1 else e ,
+            list_of_array)
+        ) if concat_axis ==1 else list(map(
+            lambda e:e.reshape(1, e.shape[0]) if e.ndim ==1 else e ,
+            list_of_array))
+                
+    return np.concatenate(list_of_array, axis = concat_axis)
 
 def sort_array_data(data,  sort_order =0,
               concatenate=False, concat_axis_order=0 ):
     """
     Function to sort array data and concatenate 
     numpy.ndarray 
     
@@ -501,129 +1155,15 @@
             data=concat_array_from_list(list_of_array=temp_list,
                                     concat_axis=concat_axis_order)
     else : 
         data=data[data[:,sort_order].argsort(kind="mergesort")]
         
     return data 
         
-@deprecated ("Function replaced to another {_search_ToFill_Data}")
-def transfer_array_(data, index_key,start_value_depth, end_value_depth, 
-                    column_order_selection=0, axis=0): 
-    """
-    Parameters
-    ----------
-        * data : dict
-                Dictionnary of numpy ndarray .
-            
-        * index_key : float 
-                key of the dictionnary . 
-                Must be a number of the first column of offset .
-            
-        * start_value_depth : float 
-                If the depth is not reach must add depth of the closest point.
-                give the start value which match to the maxi depth of the data :
-                The *default* is -214.
-                
-        * end_value_depth : float
-                Maximum depth of the survey. The default is -904.
-            
-        * column_order_selection : int,
-                the index of depth column. The default is 0.
-                
-        * axis : int , optional
-                numpy.ndarray axis . The default is 0.
-
-    Returns
-    -------
-        numpy.ndarray
-            return the array data we want to top to .
-    
-    :Example: 
-        
-        >>> import numpy as np 
-        >>> sos=abs(np.random.randn(4,3)*4)
-        >>> sos2=abs(np.random.randn(4,3)*10.8)
-        >>>  print(sos2)
-        >>> sis1=sort_array_data(data=sos,sort_order =1,
-        ...                    concatenate=False, concat_axis_order=0)
-        >>> sis2=sort_array_data(data=sos2,sort_order =1,
-        ...                    concatenate=False, concat_axis_order=0)
-        >>> dico={"18.4":sis1,
-        ...      "21.4":sis2}
-        >>> test=transfer_array_(data=dico, index_key=11.4, 
-        ...                      start_value_depth=-14, end_value_depth=23,
-        ...                      column_order_selection=1)
-        >>> print("sis1:",sis1)
-        >>> print("sis2:",sis2)
-        >>> print("Finaltest", test)
-    """
-
-    start_value_depth=abs(start_value_depth)
-    end_value_depth=abs(end_value_depth)
-    comp, flag,iter_,translist_=0,-1,0,[]
-    
-   # chef the depth colum if negative before enter in loop :  
-
-    if type (data)==dict :
-        for key, value in data.items(): # scroll the dictionary 
-            if float(key)> float(index_key):   # check the key of dictionnary
-                                        #before using its value 
-                maxi_depth=abs(value[:,column_order_selection]).max() # if yes
-                    # calculate the max depth of the value :
-                comp=0
-                for rowline in value : # scroll the row of the array dict value
-                
-                    if abs(rowline[column_order_selection])>start_value_depth : # check its
-                        # print(abs(rowline[column_order_selection]))
 
-                        # value and compare it to section we must start extract (start)
-                        if end_value_depth > maxi_depth:
-                            transData_=value[comp:,:] # if yes transfer data :
-                            # print(transData_)
-                            translist_.append(transData_)
-                            
-                            start_value_depth=abs(transData_[:,column_order_selection]).max()
-                            # start_value_depth=maxi_depth
-                            
-                            comp,iter_=0,iter_+1
-                            flag=1
-                            
-                        elif end_value_depth<=maxi_depth:
-                            indix =abs(value[:,column_order_selection]).tolist().index(end_value_depth)
-                            if iter_==0 : 
-                                transData_=value[comp:indix,::] 
-                                flag=0
-                                break 
-                            else :
-                                transData_=value[comp:indix,::]
-                                translist_.append(transData_)
-                                flag=1
-                                
-                        if start_value_depth >= end_value_depth:
-                            flag=1
-                            break
-                    else :
-                        comp +=1 
-                        
-    if flag ==0 : 
-        return transData_
-    if flag==1 : 
-        trans_array=concat_array_from_list(list_of_array=translist_, concat_axis=axis)
-        return trans_array 
-
-            
-    if type(data)==list: # create a dictionnary of array value 
-        dico={}
-        for ss, value  in enumerate( data) :
-            dico["{0}".format(value[0,0])]=value
-        # call recursive function 
-        transfer_array_(data=dico,index_key=index_key,start_value_depth=start_value_depth,
-                        end_value_depth=end_value_depth,column_order_selection=column_order_selection, axis=0)
-        
-            
 def interpol_scipy (x_value, y_value,x_new,
                     kind="linear",plot=False, fill="extrapolate"):
     
     """
     function to interpolate data 
     
     Parameters 
@@ -714,16 +1254,14 @@
     if depth_axis==0:
         data[:,depth_column_index]=data[:,depth_column_index]*coeff
     if depth_axis==1:
         data[depth_column_index,:]=data[depth_column_index,:]*coeff  
 
     return data
             
-
-
 def broke_array_to_(arrayData, keyIndex=0, broken_type="dict"):
     """
     broke data array into different value with their same key 
 
     Parameters
     ----------
         * arrayData :np.array
@@ -736,19 +1274,17 @@
     -------
         dict 
            dico_brok ,dictionnary of array.
     """
     
     # find the max_counts
     
-    vcounts_temp,counts_temp=np.unique(arrayData[:,keyIndex], return_counts=True)
+    vcounts_temp,counts_temp=np.unique(arrayData[:,keyIndex],
+                                       return_counts=True)
     vcounts_temp_max=vcounts_temp.max()
-    # print(vcounts_temp)
-    # print(vcounts_temp_max)
-    # print(vcounts_temp.min())
 
     dico_brok={}
     lis_brok=[]
     index=0
     deb=0
     for rowlines in arrayData :
         if rowlines[0] == vcounts_temp_max:
@@ -768,229 +1304,15 @@
             deb=index+1
         index=index+1
     if broken_type=="dict":
         return dico_brok
     elif broken_type=="list":
         return lis_brok
     
-
-@deprecated('this function is replaced by [_search_ToFill_Data] ')
-def _OlDFUNCNOUSEsearch_fill_data(dicoReal, arrayTemp , 
-                      max_value, index_of_depth,axis=0):
-    """
-    Deprecated function , very expensive.
-    
-    Parameters
-    ----------
-        * data : dict
-                Dictionnary of numpy ndarray .
-            
-        * dataReal : dict
-                 dictionnary . must be a dictionnary of real of offset .
-            
-        * arrayTemp : np.ndarray 
-                 must be a numpy array of reserve data , the one , we want to 
-                 extract the depth data to fill array 
-    
-        * max_value : float
-                Maximum depth of the survey. 
-            
-        * index_of_depth : int,
-                the index of depth column. The *default* is 0.
-                
-        * axis : int , optional
-            numpy.ndarray axis . The default is 0.
-    
-    Returns
-    -------
-        array_like 
-            the array data we want to top to .
-    
-    :Example: 
-        
-         >>> import numpy as np 
-         >>>  np.random.seed(0)
-         >>>  sos=abs(np.random.randn(4,3)*4)
-         >>>  sos2=abs(np.random.randn(4,3)*10.8)
-         >>>  sos3=abs(np.randon.rand(8,3)*12.4)
-         >>>  # print(sos2)
-         >>>  sis1=sort_array_data(data=sos,sort_order =1,
-         ...                    concatenate=False, concat_axis_order=0)
-         >>>  sis2=sort_array_data(data=sos2,sort_order =1,
-         ...                    concatenate=False, concat_axis_order=0)
-         >>>  sis3=sort_array_data(data=sos3,sort_order =1,
-         ...                    concatenate=False, concat_axis_order=0)
-         >>>  dico={"18.4":sis1,
-         ...      "21.4":sis2}
-         >>>  test=_search_fill_data(dicoReal=dico, index_key=11.4, 
-         ...                      start_value=10, max_value=23,
-         ...                      index_of_depth=1)
-         >>> print("sis1\n:",sis1)
-         >>> print("sis2\n:",sis2)
-         >>> print("Finaltest\n", test)
-    """
-    
-    # arange a dictionany : 
-    #from keys : for k in sorted(dico.keys()):
-    #   print(%s: %s",%(k,names[k]))
-    # from values : for k , v  in sorted(dico.items(),key=lambda x:x[1]):
-    #   print(%s: %s",%(k,v))
-    
-    _all_checker,keyToSkip=[],[]
-    litemp= broke_array_to_(arrayData=arrayTemp,keyIndex=0,
-                            broken_type="list")
-    itemp,real,realTem=[],[],[]
-    for ii in litemp:
-        temp=sort_array_data(data=ii,sort_order=1,
-                             concatenate=False)
-        itemp.append(temp)
-    # print(itemp)
-        
-    for key , value in sorted(dicoReal.items()):
-        # print(sorted(dicoReal.items()))
-        # for ii, rowline in enumerate(value)  :
-        rowmax=value[:,index_of_depth].max()
-        real.append((float(key),rowmax))
-        _all_checker.append(rowmax)
-        
-    
-    #chek if all elements are reach the depth max  
-    # if all(_all_checker)==True : # if one of the depth is the same 
-    #     return dicoReal
-    realTem=real.copy()
-    for ii , value in enumerate(realTem):
-        if value[1] == max_value:
-            del realTem[ii]
-            #real.pop(ii)
-            
-    if realTem ==[]:
-        return dicoReal
-    
-    
-    print("Real : \n",real)
-    idx,flag=0,0
-    comp,sp=0,-1
-    fin_list,endList=[],[]
-    
-    while idx < len(realTem):
-        
-        indexKey=realTem[idx][0] #11,4
-        maxKey=realTem[idx][1] #214        
-        # if real[idx][1]==max_value : # case where thedepth  value of realdico is get  
-        #     flag=3
-        # # elif real[idx][1]==max_value : # case where thedepth  value of realdico is get  
-        # #     flag=3
-        # else :
-        if idx==len(realTem)-1:
-            indic=real.index(realTem[idx])
-            # check whether there is data after a delete the offset with depth value reach 
-            if realTem[idx][0]==real[-1][0]:
-                nexIndex=itemp[-1][0][0]
-            else :
-                nexIndex=real[indic+1][0]
-        else :
-            nexIndex=realTem[idx+1][0]#61.4
-        # loop the reserve list :
-        for ii, array in enumerate (itemp): #itemp is the  list of reserve broken list
-        
-            # if array[0][0]> indexKey and array[0][0]> nexIndex:
-            #     keyToSkip.append(realTem[idx])
-            #     continue 
-            if array[0][0]> indexKey and array[0][0]<nexIndex : #check offset and next offset , if True :
-                
-                for index, rowline in enumerate(array) : # loop the array now 
-                    # tem_depth=rowline[1] # take the value of depth of reserve array for the first row 
-                    if rowline[1] > maxKey :# maxKey=214, rowline[1]= :# (max_value=904) if True :
-                        sp=sp+1
-                        if sp==0 :
-                            add_array=array[index:,:]
-                            # num=index
-                            # print("True:\n",add_array)
-                            flag=4
-                        else :
-                            sp=-1
-                            pass
-                        # print(maxtem)
-            if flag==4:
-                # maxtem=array[-1][1]       # take the maximum depth of the reserve array , last row
-                if array[-1][1]  < max_value : # if the maximum depth not reach 
-                    comp=comp+1
-                    if array[0][0]<nexIndex :
-                        endList.append(add_array)
-                    else :
-                        fin_list.append(add_array) # keep the array in temporary list 
-                    # maxKey = maxtem   # set up new maximum depth 
-                    # flag=1
-                    maxKey = array[-1][1] 
-                    # print("flag4,comp>1")
-                    # if maxKey < 
-                elif array[-1][1]  ==max_value : # the maximum depth is reached
-                    flag=5
-    
-            if flag==5 :
-                
-                if comp==0 : # first check is ok 
-                    # add_array=array[num:,:] # cut the array 
-                    endList.append(add_array)
-                    flag=0
-                    # print("flag5,comp=0")
-                else :
-                  add_array=array[index:,:] #  
-                  fin_list.append(add_array) # list to create one ar
-
-                  flag=1
-                      
-        # if flag==3 : # in that case is true , save the value of the offset 
-        #     # for key , value in dicoReal.items() :
-        #     #     if float(key) == real[idx][0]:
-        #     #         endList.append(value)
-        #     keyToSkip.append(array[0][0])
-            
-                    
-        if flag==1 :
-            arT=concat_array_from_list(list_of_array=fin_list,concat_axis=axis)
-            endList.append(arT)
-        if flag==0 :
-            endList=endList
-        
-        idx=idx+1
-            
-    print("keyToSkip\n:",keyToSkip)       
-        
-    
-    #delete the the offset which are full depth on the list 
-    # print(keyToSkip)
-    # print(real,"\n")
-    for ii , value in enumerate(realTem):
-        if value[0] in keyToSkip:
-            del realTem[ii]
-            #real.pop(ii)
-    
-    # now we are the list of recoverd depth 
-    # build dictionnary
-    print("Realtem\n",realTem,)
-
-    print("endlist : \n",endList)
-    # print(keyToSkip)
-    
-    for ii , tuple_ in enumerate (realTem) : #take the realkey from dico
-        realKey, maxValue=tuple_
-        print(realKey,maxValue)
-        
-        add_array=endList[ii]       # take the add_value generated
-        # print(endList)
-        for key , value in dicoReal.items(): # search in dictionnary the key
-            if float(key)==realKey: # and compare it to the key from tuple ...
-                        #... just to have certitude then concatenate 
-                val=np.concatenate((value,add_array),axis=0)
-                dicoReal[key]=val
-        # print(ii)
-    return dicoReal 
-
-
+@deprecated('Amateurism function. Should remove soon !')
 def _search_ToFill_Data (dicoReal, arrayTemp , 
                       max_value, index_of_depth,axis=0): 
     """
     Parameters 
     ------------
         * data : dict
                 Dictionnary of numpy ndarray .
@@ -1047,26 +1369,15 @@
         ...            temp.append(van)
         >>>  arrayTemp=concat_array_from_list(list_of_array=temp,
         ...                                 concat_axis=0)
         >>>  sis02=_search_ToFill_Data(dicoReal=dico, arrayTemp=arrayTemp , 
         ...              max_value=904, index_of_depth=1,axis=0)
         >>>  print(sis02)
     """ 
-    #Notes :
-    # arange a dictionany : 
-    #from keys : for k in sorted(dico.keys()):
-    #   print(%s: %s",%(k,names[k]))
-    # from values : for k , v  in sorted(dico.items(),key=lambda x:x[1]):
-    #   print(%s: %s",%(k,v)
-    # for ii , value in enumerate(realTem):
-    # if value[0] in keyToSkip:
-    #     del realTem[ii]
-    #     #real.pop(ii)
-    #------------------------------------
-    # _all_checker,keyToSkip=[],[]
+
     litemp= broke_array_to_(arrayData=arrayTemp,keyIndex=0,
                             broken_type="list")
     itemp,real=[],[],
     # flag=-1
     for ii in litemp:
         temp=sort_array_data(data=ii,sort_order=1,
                              concatenate=False)
@@ -1108,16 +1419,17 @@
                                 maxDepth=array[:,1].max() # caluclate nnex
                                 # print(add_array)
                             else :
                                 pass
                             if iter_==0 and maxDepth<=max_value :
                                 for key, value in dicoReal.items() :
                                     if float(key) ==offs :
-                                        new_value=concat_array_from_list(list_of_array=[value,add_array],
-                                                                     concat_axis=axis)
+                                        new_value=concat_array_from_list(
+                                            list_of_array=[value,add_array],
+                                            concat_axis=axis)
                                         dicoReal[key]=new_value
                                         iter_=-1
                                         # break
                 else :
                     pass
              
     return dicoReal
@@ -1186,40 +1498,22 @@
     tempi=[ii for ii in valuesIter]
     for ii in misoffs :
         tempi.append(ii)
 
     tempi=deepcopy(tempi)
 
     tempi.sort(reverse =False)
-    # print("mainlist:\n",main_list)
-    # print("tempiSorted:\n",tempi)
-    # print("missoff:\n",misoffs)
-    # print("lisofStraight_max:\n",max_X)
-    # # print(len(misoffs))
 
-    # sp=-1
     for jj, off in enumerate(tempi): #scroll the create temporary list
         for ss, ofi in enumerate(misoffs):  # scroll the miss offset list and compare it 
-                            # to the temportary list 
+        # to the temportary list 
             if off==ofi:
                 # print(off,ss)
-                indexof =main_list.index(off) # find the index of "off" value in the mainlist
-                        # in order to calculate the distance between the value to its next value 
-                        # or forward value ex :off=3 , backward =0.724 , forward =3.445
-                        
-                # if main_list[indexof]==main_list[-1]: # that's mean the "off" value reaches the end of mainlist
-                #     if tempi[-1]>main_list[indexof]: # 
-                #         deltaMain=main_list[indexof]-tempi[-1] # take the diff between
-                #         vamin.append(tempi[-1])
-                #     else :
-                #         deltaMain=main_list[indexof]-tempi[-2]
-                # else :
-                #     deltaMain=main_list[indexof]-main_list[indexof+1]
-                    
-                # if main_list[indexof+1] != tempi[jj+1] :
+                indexof =main_list.index(off)
+
                 if off==tempi[-1]:
                     # deltaOffneg=abs(off-tempi[jj-1])
                     vamin.append(tempi[jj-1])
                     # delta=deltaOffneg
                     
                 elif off==tempi[0]:
                     deltaOffpos=abs(off-tempi[jj+1])
@@ -1239,17 +1533,15 @@
 
     # print("vamin:\n",vamin)   
     # print(len(vamin))
     for ii, val in enumerate(list_to_straigh):
         for ss, of in enumerate(vamin):
             if val==of :
                 list_to_straigh[ii]=misoffs[ss]
-                
-    # if list_to_straigh[-1] !=max_X :
-        
+                   
     return list_to_straigh
 
 def take_firstValue_offDepth(data_array,
                              filter_order=1):
     """
     Parameters
     ----------
@@ -2290,15 +2582,61 @@
         if value_to_delete in list_of_value :
             [list_of_value.pop(ii) for  ii, elm in\
              enumerate (list_of_value) if elm==value_to_delete]
         elif value_to_delete not in list_of_value :
             start_point=0 # not necessary , just for secure the loop. 
             break           # be sure one case or onother , it will break
     return list_of_value 
+
+def resize_resphase_values (dictobj: dict , fill_value: float = np.nan,
+                            c =None,mask_nan:bool =True, return_array =True): 
+    """ Get the resistivity and phases values from dictof items 
+    and concatenate them. 
+    
+    Array must have the same length everywhere. Function get the max 
+    length and add `np.nan` values to reach the size of max array. 
+    if the given data is under the max array. 
+    
+    :param dictobj: dict - container of array-like values 
+    :param fill_value: float - value to append to the max array so 
+        to reach the reference array. Default is ``np.nan`.` 
+    :param c: array-like - Controler; the array value for reference. If given,  
+        its length should be used as the max array length. Default is ``None``.
+    :param mask_value: bool - Mask the appender value. Default is ``True``. 
+    :param return_array: bool - Return concatenated array otherwise return the 
+        dictobject with filled values. 
+        
+    :return: ndarray - array of `dictobj` values concatenated into two 
+        dimensional arrays; otherwise return the `dictobj` resized
+        
+    """
+    max_ = len(c) if c is not None else  max (
+        [len(v) for v in dictobj.values()]) 
+    for key,  aval in sorted (dictobj.items()) : 
+        s = max_-len(aval)
+        if s==0: 
+            continue 
+        elif s > 0: 
+            aval = np.append(aval, np.full(
+                (s,), fill_value ))
+        elif s < 0 : 
+            aval = aval [:s]
+         
+        dictobj[key] = aval
         
+    # if not return_array : 
+    #     return dictobj 
+    
+    ar = np.vstack([v for v in dictobj.values()]) 
+    
+    # masked the fill values
+    return dictobj if not return_array else np.ma.masked_array( ar, mask = np.isnan(ar) 
+                              ) if mask_nan else ar 
+   
+
 def _strip_item(item_to_clean, item=None, multi_space=12):
     """
     Function to strip item around string values.  if the item to clean is None or 
     item-to clean is "''", function will return None value
 
     Parameters
     ----------
@@ -2325,16 +2663,17 @@
     if item==None :item = ' '
     
     cleaner =[(''+ ii*'{0}'.format(item)) for ii in range(multi_space)]
     
     if type(item_to_clean ) != list :#or type(item_to_clean ) !=np.ndarray:
         if type(item_to_clean ) !=np.ndarray:
             item_to_clean=[item_to_clean]
+    
     if item_to_clean in cleaner or item_to_clean ==['']:
-        warnings.warn ('No data found in <item_to_clean :{}> We gonna return None.')
+        warnings.warn ('No data found for sanitization; returns None.')
         return None 
 
   
     try : 
         multi_space=int(multi_space)
     except : 
         raise TypeError('argument <multplier> must be'\
@@ -2820,40 +3159,189 @@
     savepath = cpath(savepath , '__pme')
     try :
         shutil.move (f'{destfile}.csv', savepath)
     except:pass 
     
     return new_csv_list
 
-# if __name__=="__main__" :
+def ismissing(refarr, arr, fill_value = np.nan, return_index =False): 
+    """ Get the missing values in array-like and fill it  to match the length
+    of the reference array. 
+    
+    The function makes sense especially for frequency interpollation in the 
+    'attenuation band' when using the audio-frequency magnetotelluric methods. 
+    
+    :param arr: array-like- Array to extended with fill value. It should be  
+        shorter than the `refarr`. Otherwise it returns the same array `arr` 
+    :param refarr: array-like- the reference array. It should have a greater 
+        length than the array 
+    :param fill_value: float - Value to fill the `arr` to match the length of 
+        the `refarr`. 
+    :param return_index: bool or str - array-like, index of the elements element 
+        in `arr`. Default is ``False``. Any other value should returns the 
+        mask of existing element in reference array
+        
+    :returns: array and values missings or indexes in reference array. 
+    
+    :Example: 
+        
+    >>> import numpy as np 
+    >>> from pycsamt.utils.func_utils import ismissing
+    >>> refreq = np.linspace(7e7, 1e0, 20) # 20 frequencies as reference
+    >>> # remove the value between index 7 to 12 and stack again
+    >>> freq = np.hstack ((refreq.copy()[:7], refreq.copy()[12:] ))  
+    >>> f, m  = ismissing (refreq, freq)
+    >>> f, m  
+    ...array([7.00000000e+07, 6.63157895e+07, 6.26315791e+07, 5.89473686e+07,
+           5.52631581e+07, 5.15789476e+07, 4.78947372e+07,            nan,
+                      nan,            nan,            nan,            nan,
+           2.57894743e+07, 2.21052638e+07, 1.84210534e+07, 1.47368429e+07,
+           1.10526324e+07, 7.36842195e+06, 3.68421147e+06, 1.00000000e+00])
+    >>> m # missing values 
+    ... array([44210526.68421052, 40526316.21052632, 36842105.73684211,
+           33157895.2631579 , 29473684.78947368])
+    >>>  _, m_ix  = ismissing (refreq, freq, return_index =True)
+    >>> m_ix 
+    ... array([ 7,  8,  9, 10, 11], dtype=int64)
+    >>> # assert the missing values from reference values 
+    >>> refreq[m_ix ] # is equal to m 
+    ... array([44210526.68421052, 40526316.21052632, 36842105.73684211,
+           33157895.2631579 , 29473684.78947368]) 
+        
+    """
+    return_index = str(return_index).lower() 
+    fill_value = _assert_all_types(fill_value, float, int)
+    if return_index in ('false', 'value', 'val') :
+        return_index ='values' 
+    elif return_index  in ('true', 'index', 'ix') :
+        return_index = 'index' 
+    else : 
+        return_index = 'mask'
+    
+    ref = refarr.copy() ; mask = np.isin(ref, arr)
+    miss_values = ref [~np.isin(ref, arr)] 
+    miss_val_or_ix  = (ref [:, None] == miss_values).argmax(axis=0
+                         ) if return_index =='index' else ref [~np.isin(ref, arr)] 
+    
+    miss_val_or_ix = mask if return_index =='mask' else miss_val_or_ix 
+    # if return_missing_values: 
+    ref [~np.isin(ref, arr)] = fill_value 
+    #arr= np.hstack ((arr , np.repeat(fill_value, 0 if m <=0 else m  ))) 
+    #refarr[refarr ==arr] if return_index else arr 
+    return  ref , miss_val_or_ix   
+
 
-    # parse_=parse_wellData(filename='shimenDH.csv',
-    # include_azimuth=True,utm_zone='49N')
+def fillNaN(arr, method ='ff'): 
+    """ Most efficient way to back/forward-fill NaN values in numpy array. 
     
-    # print("NameOflocation:\n",parse_[0])
-    # print("WellData:\n",parse_[1])
-    # print("GeoData:\n",parse_[2])
-    # print("Sample:\n",parse_[3])
-    # data =['Z.mwgt','Z.pwgt','Freq',' Tx.Amp','E.mag','   E.phz',
-    #         '   B.mag','   B.phz','   Z.mag', '   Zphz  ']
-    
-    # data2=[' B.phz',' Z.mag',]
-    # # cleaner =[(''+ ii*'*') for ii in range(7)]
-    # print(_cross_eraser(data=data2, to_del=data))
-    # print(_cross_eraser(data=data, to_del=data2))
-    # # print(_strip_item(item_to_clean=data, item=' '))
-    # # # print(cleaner)
-    # ts ='50.0'
-    # ch ='AMTAVG 7.76: "K1.fld", Dated 99-01-01,AMTAVG, Processed 11 Jul 17 AMTAVG'
-    # ss=_remove_str_word(char=ts, word_to_remove='m', deep_remove=False)
-            
+    Parameters 
+    ---------- 
+    arr : ndarray 
+        Array containing NaN values to be filled 
+    method: str 
+        Method for filling. Can be forward fill ``ff`` or backward fill `bf``. 
+        or ``both`` for the two methods. Default is `ff`. 
+        
+    Returns
+    -------
+    new array filled. 
+    
+    Notes 
+    -----
+    When NaN value is framed between two valid numbers, ``ff`` and `bf` performs 
+    well the filling operations. However, when the array is ended by multiple 
+    NaN values, the ``ff`` is recommended. At the opposite the ``bf`` is  the 
+    method suggested. The ``both``argument does the both tasks at the expense of 
+    the computation cost. 
+    
+    Examples 
+    --------- 
+        
+    >>> import numpy as np 
+    >>> from pycsamt.utils.func_utils import fillNaN 
+    >>> arr2d = np.random.randn(7, 3)
+    >>> # change some value into NaN 
+    >>> arr2d[[0, 2, 3, 3 ],[0, 2,1, 2]]= np.nan
+    >>> arr2d 
+    ... array([[        nan, -0.74636104,  1.12731613],
+           [ 0.48178017, -0.18593812, -0.67673698],
+           [ 0.17143421, -2.15184895,         nan],
+           [-0.6839212 ,         nan,         nan]])
+    >>> fillNaN (arr2d) 
+    ... array([[        nan, -0.74636104,  1.12731613],
+           [ 0.48178017, -0.18593812, -0.67673698],
+           [ 0.17143421, -2.15184895, -2.15184895],
+           [-0.6839212 , -0.6839212 , -0.6839212 ]])
+    >>> fillNaN(arr2d, 'bf')
+    ... array([[-0.74636104, -0.74636104,  1.12731613],
+           [ 0.48178017, -0.18593812, -0.67673698],
+           [ 0.17143421, -2.15184895,         nan],
+           [-0.6839212 ,         nan,         nan]])
+    >>> fillNaN (arr2d, 'both')
+    ... array([[-0.74636104, -0.74636104,  1.12731613],
+           [ 0.48178017, -0.18593812, -0.67673698],
+           [ 0.17143421, -2.15184895, -2.15184895],
+           [-0.6839212 , -0.6839212 , -0.6839212 ]])
+    
+    References 
+    ----------
+    Some function below are edited by the authors in pyQuestion.com website. 
+    There are other way more efficient to perform this task by calling the module 
+    `Numba` to accelerate the computation time. However, at the time this script 
+    is writen (August 17th, 2022) , `Numba` works with `Numpy` version 1.21. The
+    latter  is older than the one used in for writting this package (1.22.3 ). 
+    
+    For furher details, one can refer to the following link: 
+    https://pyquestions.com/most-efficient-way-to-forward-fill-nan-values-in-numpy-array
+    
+    """
+    def ffill (arr): 
+        """ Forward fill."""
+        idx = np.where (~mask, np.arange(mask.shape[1]), 0)
+        np.maximum.accumulate (idx, axis =1 , out =idx )
+        return arr[np.arange(idx.shape[0])[:, None], idx ]
+    
+    def bfill (arr): 
+        """ Backward fill """
+        idx = np.where (~mask, np.arange(mask.shape[1]) , mask.shape[1]-1)
+        idx = np.minimum.accumulate(idx[:, ::-1], axis =1)[:, ::-1]
+        return arr [np.arange(idx.shape [0])[:, None], idx ]
+    
+    method= str(method).lower().strip() 
+    
+    if arr.ndim ==1: 
+        arr = reshape(arr, axis=1)  
+        
+    if method  in ('backward', 'bf',  'bwd'):
+        method = 'bf' 
+    elif method in ('forward', 'ff', 'fwd'): 
+        method= 'ff' 
+    elif method in ('both', 'ffbf', 'fbwf', 'bff'): 
+        method ='both'
+    if method not in ('bf', 'ff', 'both'): 
+        raise ValueError ("Expect a backward <'bf'>, forward <'ff'> fill "
+                          f" or both <'bff'> not {method!r}")
+    mask = np.isnan (arr)  
+    if method =='both': 
+        arr = ffill(arr) ;
+        #mask = np.isnan (arr)  
+        arr = bfill(arr) 
+    
+    return (ffill(arr) if method =='ff' else bfill(arr)
+            ) if method in ('bf', 'ff') else arr 
 
 
     
 
+
+
+
+
+
+
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/geo_utils.py` & `pycsamt-1.2.1/pycsamt/utils/geo_utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -12,15 +12,17 @@
 import numpy as np
 import pandas as pd 
 import matplotlib.pyplot as plt
 import matplotlib.gridspec as GridSpec
 
 import pycsamt.utils.func_utils as FU
 import pycsamt.utils.plot_utils as PU
-import pycsamt.utils.exceptions as CSex
+from pycsamt.utils.exceptions import ( 
+    FileHanglingError, StrataError 
+    )
 from pycsamt.utils._csamtpylog import csamtpylog
 
 _logger=csamtpylog.get_csamtpy_logger(__name__)
        
 PATH = 'data/occam2D'
 k_ =['model', 'iter', 'mesh', 'data']
 
@@ -288,15 +290,15 @@
     if len(gitems[-1]) ==0: 
         gitems = gitems [1:]
         
     return gitems
 
 def fit_stratum_property (fittedrocks , z , site_tres):
     """ Separated whole blocks into different stratum and fit their
-    corresponding property like depth and values of resistivities
+    corresponding property like depth and value of resistivities
     
     :param fittedrocks: array_like of layers fitted from the TRES 
     :param z: array like of the depth 
     :param site_tres: array like of the station TRES 
     
     :returns: 
         - s_grouped: Each stratum grouped from s_tres 
@@ -866,15 +868,15 @@
             if not success:
                 msg_ = ''.join([ "Unable to retreive the geostructure ",
                       f"{os.path.basename(file_r)!r} property file from",
                       f" {__agso_properties['GIT_REPO']!r}."])
                 warnings.warn(f"Geological structure file {file_r} "
                               f"is missing. {msg_}") 
                 _logger.warn( msg_)
-                raise CSex.pyCSAMTError_file_handling(
+                raise FileHanglingError(
                     f"No property file {os.path.basename(file_r)!r}"
                     f" is found. {msg}.")
     for f in __agso:
         with open(f,'r' , encoding ='utf8') as fs: 
             yield([stratum.strip('\n').split(',')
                     for stratum in fs.readlines()])
             
@@ -1478,15 +1480,15 @@
     kind =str(kind)
     for v in [ 'nm', 'strata', 'geomodel', 'logS', 'rr','2']: 
         if kind.lower().find(v)>=0: 
             kind = 'nm'
     if kind  in ['crm', 'resmodel', 'occam', 'rawmodel', '1']: 
         kind= 'crm'
     if kind not in ('nm', 'crm'): 
-        raise CSex.pyCSAMTError_strata(
+        raise StrataError(
             f"Argument kind={kind!r} is wrong! Should be `nm`"
             "for stratigraphyic model and `crm` for occam2d model. ")
     return kind 
     
 ##############connection git error ##########################
 connect_reason ="""<ConnectionRefusedError><No connection could  '
             be made because the target machine actively refused it>.
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/gis_tools.py` & `pycsamt-1.2.1/pycsamt/utils/gis_tools.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,57 +1,80 @@
 # -*- coding: utf-8 -*-
-#       Authors: Lars Krieger, Jared R. Peacock & Alison Louise Kirkby
-#       contact: < https://github.com/MTgeophysics/mtpy.git>
-#       Licence: GPL
-"""
-   
-Created on Fri Apr 14 14:47:48 2017
 
 """
+GIS_TOOLS
+=========
 
-# ==============================================================================
-# Imports
-# ==============================================================================
+This module contains tools to help project between coordinate systems. The 
+module will first use GDAL if installed.  If GDAL is not installed then 
+pyproj is used. Main functions are:
+    
+    * project_point_ll2utm
+    * project_point_utm2ll
+    
+These can take in a point or an array or list of points to project.
 
+latitude and longitude can be input as:
+    * 'DD:mm:ss.ms'
+    * 'DD.decimal_degrees'
+    * float(DD.decimal_degrees)
+
+created on Fri Apr 14 14:47:48 2017 by  Jared R. Peacock 
+#       contact: < https://github.com/MTgeophysics/mtpy.git>  
+Revised: 5/2020 JP 
 
-from pycsamt.utils.decorator import  deprecated #gdal_data_check,
+Edited on Fri Apr 14 14:47:48 2019 by @Daniel 
+
+"""
 import numpy as np
-from pycsamt.utils._csamtpylog import csamtpylog
-try : 
-    
-    import HAS_GDAL, EPSG_DICT
-    if HAS_GDAL:
-        from osgeo import osr
-        from osgeo.ogr import OGRERR_NONE
-    else:
-        import pyproj
-# end if
-except : pass 
 
+from pycsamt.utils.decorator import  deprecated 
+from pycsamt._csamtpylog import csamtpylog
 
+from pycsamt.utils.__init__ import (
+    HAS_GDAL,
+    EPSG_DICT
+)
+    
+if HAS_GDAL:
+    from osgeo import osr
+    from osgeo.ogr import OGRERR_NONE
+else:
+    import pyproj
+ 
 _logger = csamtpylog.get_csamtpy_logger(__name__)
 
 
-class GIS_ERROR(Exception):
+class GISError(Exception):
     pass
-#==============================================================================
+#===============================================
 # Make sure lat and lon are in decimal degrees
-#==============================================================================
+#===============================================
 def _assert_minutes(minutes):
     assert 0 <= minutes < 60., \
         'minutes needs to be <60 and >0, currently {0:.0f}'.format(minutes)
 
     return minutes
 
 
 def _assert_seconds(seconds):
     assert 0 <= seconds < 60., \
         'seconds needs to be <60 and >0, currently {0:.3f}'.format(seconds)
     return seconds
 
+def _countdown_resume(deg_or_min, value):
+    """ resume the countdown and  add one if seconds or degree is equal to 60.  
+
+    Commonly seconds and minutes should not end by 60, otherwise one 
+    min or  hour is topped. Thus the second and minute restart counting. 
+    This is useful to skip the assertion error when second and minutes are 
+    equal to 60. Conversion is done instead. 
+    """
+    return ( deg_or_min + value//60, value%60 )  if float (value) >=60. else (
+        deg_or_min, value )  
 
 def convert_position_str2float(position_str):
     """
     Convert a position string in the format of DD:MM:SS to decimal degrees
     
     Arguments
     -------------
@@ -64,25 +87,28 @@
                        latitude or longitude in decimal degrees
                           
     Example
     -------------
         >>> import mtpy.utils.gis_tools as gis_tools
         >>> gis_tools.convert_position_str2float('-118:34:56.3')
     """
-
+    
     if position_str in [None, 'None']:
         return None
     
     p_list = position_str.split(':')
     if len(p_list) != 3:
         raise ValueError('{0} not correct format, should be DD:MM:SS'.format(position_str))
 
-    deg = float(p_list[0])
-    minutes = _assert_minutes(float(p_list[1]))
-    sec = _assert_seconds(float(p_list[2]))
+    deg = float(p_list[0]) 
+    minutes = float(p_list[1])
+    sec = float(p_list[2])
+    
+    minutes, sec = _countdown_resume(minutes, sec) 
+    deg, minutes =  _countdown_resume(deg, minutes) 
 
     # get the sign of the position so that when all are added together the
     # position is in the correct place
     sign = 1
     if deg < 0:
         sign = -1
 
@@ -91,49 +117,50 @@
     return position_value
 
 
 def assert_lat_value(latitude):
     """
     make sure latitude is in decimal degrees
     """
-    # if latitude in [None, 'None']:
-    #     return None
+    if latitude in [None, 'None']:
+        return None
     try:
         lat_value = float(latitude)
 
     except TypeError:
         return None
 
     except ValueError:
         lat_value = convert_position_str2float(latitude)
 
     if abs(lat_value) >= 90:
         print("==> The lat_value =", lat_value)
-        raise ValueError('|Latitude| > 90, unacceptable!')
+        raise ValueError(f'|Latitude| > 90, unacceptable!: {str(lat_value)!r}')
 
     return lat_value
 
 
 def assert_lon_value(longitude):
     """
     make sure longitude is in decimal degrees
     """
+    
     if longitude in [None, 'None']:
         return None
     try:
         lon_value = float(longitude)
 
     except TypeError:
         return None
 
     except ValueError:
         lon_value = convert_position_str2float(longitude)
 
     if abs(lon_value) >= 180:
-        raise ValueError('|Longitude| > 180, unacceptable!')
+        raise ValueError(f'|Longitude| > 180, unacceptable!: {str(lon_value)!r}')
 
     return lon_value
 
 
 def assert_elevation_value(elevation):
     """
     make sure elevation is a floating point number
@@ -298,42 +325,42 @@
 
     if HAS_GDAL:
         # set lat lon coordinate system
         ll_cs = osr.SpatialReference()
         if isinstance(datum, int):
             ogrerr = ll_cs.ImportFromEPSG(datum)
             if ogrerr != OGRERR_NONE:
-                raise GIS_ERROR("GDAL/osgeo ogr error code: {}".format(ogrerr))
+                raise GISError("GDAL/osgeo ogr error code: {}".format(ogrerr))
         elif isinstance(datum, str):
             ogrerr = ll_cs.SetWellKnownGeogCS(datum)
             if ogrerr != OGRERR_NONE:
-                raise GIS_ERROR("GDAL/osgeo ogr error code: {}".format(ogrerr))
+                raise GISError("GDAL/osgeo ogr error code: {}".format(ogrerr))
         else:
-            raise GIS_ERROR("""datum {0} not understood, needs to be EPSG as int
+            raise GISError("""datum {0} not understood, needs to be EPSG as int
                                or a well known datum as a string""".format(datum))
 
         # set utm coordinate system
         utm_cs = osr.SpatialReference()
     # end if
 
     # project point on to EPSG coordinate system if given
     if isinstance(epsg, int):
         if HAS_GDAL:
             ogrerr = utm_cs.ImportFromEPSG(epsg)
             if ogrerr != OGRERR_NONE:
-                raise GIS_ERROR("GDAL/osgeo ogr error code: {}".format(ogrerr))
+                raise GISError("GDAL/osgeo ogr error code: {}".format(ogrerr))
         else:
             pp = pyproj.Proj('+init=EPSG:%d'%(epsg))
         # end if
     # otherwise project onto given datum
     elif epsg is None:
         if HAS_GDAL:
             ogrerr = utm_cs.CopyGeogCSFrom(ll_cs)
             if ogrerr != OGRERR_NONE:
-                raise GIS_ERROR("GDAL/osgeo ogr error code: {}".format(ogrerr))
+                raise GISError("GDAL/osgeo ogr error code: {}".format(ogrerr))
         # end if
         if utm_zone is None or not isinstance(None, str) or utm_zone.lower() == 'none':
             # get the UTM zone in the datum coordinate system, otherwise
             zone_number, is_northern, utm_zone = get_utm_zone(lat.mean(),
                                                               lon.mean())
         else:
             # get zone number and is_northern from utm_zone string
@@ -404,19 +431,19 @@
                         projected point in lat and lon in Datum, as decimal
                         degrees.
                     
     """
     try:
         easting = float(easting)
     except ValueError:
-        raise GIS_ERROR("easting is not a float")
+        raise GISError("easting is not a float")
     try:
         northing = float(northing)
     except ValueError:
-        raise GIS_ERROR("northing is not a float")
+        raise GISError("northing is not a float")
 
     if HAS_GDAL:
         # set utm coordinate system
         utm_cs = osr.SpatialReference()
         utm_cs.SetWellKnownGeogCS(datum)
     # end if
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/ml_utils.py` & `pycsamt-1.2.1/pycsamt/utils/ml_utils.py`

 * *Files identical despite different names*

### Comparing `pycsamt-1.1.2/pycsamt/utils/mtcalculator.py` & `pycsamt-1.2.1/pycsamt/utils/mtcalculator.py`

 * *Files 4% similar despite different names*

```diff
@@ -11,30 +11,25 @@
 
 #=================================================================
 
 
 import numpy as np
 import math, cmath
 
-import pycsamt.utils.exceptions as MTex
+#from  pycsamt.utils.exceptions import 
 
 
 #=================================================================
-
 #define uncertainty for differences between time steps
 epsilon = 1e-9
 #magnetic permeability in free space in H/m (=Vs/Am)
 mu0 = 4e-7*math.pi
 
-
 #=================================================================
 
-
-
-
 def centre_point(xarray, yarray):
     """
     get the centre point of arrays of x and y values
     """
     return (xarray.max() + xarray.min())/2., (yarray.max() + yarray.min())/2.
 
 
@@ -61,51 +56,53 @@
         period_min = minimum period
         period_max = maximum period
         periods_per_decade = number of periods per decade
         include_outside_range = option whether to start and finish the period
                                 list just inside or just outside the bounds
                                 specified by period_min and period_max
                                 default True
-    
     """
     
     
     log_period_min = np.log10(period_min)
     log_period_max = np.log10(period_max)
     
     # check if log_period_min is a whole number
     if log_period_min % 1 > 0:
         # list of periods, around the minimum period, that will be present in specified 
         # periods per decade
-        aligned_logperiods_min = np.linspace(np.floor(log_period_min),np.ceil(log_period_min),periods_per_decade + 1)
+        aligned_logperiods_min = np.linspace(np.floor(log_period_min),
+                                             np.ceil(log_period_min),periods_per_decade + 1)
         lpmin_diff = log_period_min - aligned_logperiods_min
         # index of starting period, smallest value > 0
         if include_outside_range:
             spimin = np.where(lpmin_diff > 0)[0][-1]
         else:
             spimin = np.where(lpmin_diff < 0)[0][0]
         start_period = aligned_logperiods_min[spimin]
     else:
         start_period = log_period_min
     
     if log_period_max % 1 > 0:
         # list of periods, around the maximum period, that will be present in specified 
         # periods per decade
-        aligned_logperiods_max = np.linspace(np.floor(log_period_max),np.ceil(log_period_max),periods_per_decade + 1)
+        aligned_logperiods_max = np.linspace(np.floor(log_period_max),
+                                             np.ceil(log_period_max),periods_per_decade + 1)
         lpmax_diff = log_period_max - aligned_logperiods_max
         # index of starting period, smallest value > 0
         if include_outside_range:
             spimax = np.where(lpmax_diff < 0)[0][0]
         else:
             spimax = np.where(lpmax_diff > 0)[0][-1]
         stop_period = aligned_logperiods_max[spimax]
     else:
         stop_period = log_period_max        
         
-    return np.logspace(start_period,stop_period,int((stop_period-start_period)*periods_per_decade + 1))
+    return np.logspace(start_period,stop_period,
+                       int((stop_period-start_period)*periods_per_decade + 1))
 
 
 def nearest_index(val,array):
     """
     find the index of the nearest value in the array
     :param val: the value to search for
     :param array: the array to search in
@@ -144,39 +141,39 @@
 
     return log_z
 
 
 def invertmatrix_incl_errors(inmatrix, inmatrix_err=None):
 
     if inmatrix is None:
-        raise MTex.MTpyError_inputarguments('Matrix must be defined')
+        raise TypeError('Matrix must be defined')
 
     if (inmatrix_err is not None) and (inmatrix.shape != inmatrix_err.shape):
-        raise MTex.MTpyError_inputarguments('Matrix and err-matrix shapes do not match: %s - %s'%(str(inmatrix.shape), str(inmatrix_err.shape)))
+        raise TypeError('Matrix and err-matrix shapes do not match: %s - %s'%(str(inmatrix.shape), str(inmatrix_err.shape)))
 
     if (inmatrix.shape[-2] != inmatrix.shape[-1]):
-        raise MTex.MTpyError_inputarguments('Matrices must be square!')
+        raise TypeError('Matrices must be square!')
 
     if (inmatrix_err is not None) and (inmatrix_err.shape[-2] != inmatrix_err.shape[-1]) :
-        raise MTex.MTpyError_inputarguments('Matrices must be square!')
+        raise TypeError('Matrices must be square!')
 
     dim = inmatrix.shape[-1]
 
 
     det = np.linalg.det(inmatrix)
 
     if det == 0:
-        raise MTex.MTpyError_inputarguments('Matrix is singular - I cannot invert that!')
+        raise TypeError('Matrix is singular - I cannot invert that!')
 
     inv_matrix = np.zeros_like(inmatrix)
 
 
 
     if dim != 2:
-        raise MTex.MTpyError_inputarguments('Only 2D matrices supported yet')
+        raise TypeError('Only 2D matrices supported yet')
 
     inv_matrix = np.linalg.inv(inmatrix)
 
     inv_matrix_err = None
 
     if (inmatrix_err is not None):
         inmatrix_err = np.real(inmatrix_err)
@@ -214,15 +211,15 @@
     try:
         if rho.shape != (2,2) or phi.shape != (2,2):
             raise
         if not (rho.dtype in ['float', 'int'] and phi.dtype in ['float', 'int']):
             raise
 
     except: 
-        raise MTex.MTpyError_inputarguments('ERROR - arguments must be two 2x2 arrays (real)')
+        raise TypeError('ERROR - arguments must be two 2x2 arrays (real)')
 
     z = np.zeros((2,2),'complex')
     for i in range(2):
         for j in range(2):
             abs_z  = np.sqrt(5 * freq * rho[i,j])
             z[i,j] = cmath.rect(abs_z ,math.radians(phi[i,j]))
 
@@ -470,24 +467,24 @@
 # b) use propagation of errors on Z' to obtain the rotated Z'err
 # That is NOT the same as the rotated error matrix Zerr (although the result is similar)
 
 
 def rotatematrix_incl_errors(inmatrix, angle, inmatrix_err = None) :
    
     if inmatrix is None :
-        raise MTex.MTpyError_inputarguments('Matrix AND eror matrix must be defined')
+        raise TypeError('Matrix AND eror matrix must be defined')
 
     if (inmatrix_err is not None) and (inmatrix.shape != inmatrix_err.shape):
-        raise MTex.MTpyError_inputarguments('Matrix and err-matrix shapes do not match: %s - %s'%(str(inmatrix.shape), str(inmatrix_err.shape)))
+        raise TypeError('Matrix and err-matrix shapes do not match: %s - %s'%(str(inmatrix.shape), str(inmatrix_err.shape)))
 
 
     try:
         degreeangle = angle % 360
     except:
-        raise MTex.MTpyError_inputarguments('"Angle" must be a valid number (in degrees)')
+        raise TypeError('"Angle" must be a valid number (in degrees)')
 
     phi = math.radians(degreeangle)
 
     cphi = np.cos(phi)
     sphi = np.sin(phi)
 
     # JP: Changed the rotation matrix to be formulated to rotate
@@ -524,23 +521,23 @@
     return rotated_matrix, errmat
 
 
 def rotatevector_incl_errors(invector, angle, invector_err = None):
     #check for row or column vector 
     
     if invector is None :
-        raise MTex.MTpyError_inputarguments('Vector AND error-vector must be defined')
+        raise TypeError('Vector AND error-vector must be defined')
 
     if (invector_err is not None) and (invector.shape != invector_err.shape):
-        raise MTex.MTpyError_inputarguments('Vector and errror-vector shapes do not match: %s - %s'%(str(invector.shape), str(invector_err.shape)))
+        raise TypeError('Vector and errror-vector shapes do not match: %s - %s'%(str(invector.shape), str(invector_err.shape)))
 
     try:
         degreeangle = angle%360
     except:
-        raise MTex.MTpyError_inputarguments('"Angle" must be a valid number (in degrees)')
+        raise TypeError('"Angle" must be a valid number (in degrees)')
 
     phi = math.radians(degreeangle)
     
     cphi = np.cos(phi)
     sphi = np.sin(phi)
 
     # JP: Changed the rotation matrix to be formulated to rotate
@@ -569,18 +566,18 @@
     return rotated_vector, errvec
 
 
 
 def multiplymatrices_incl_errors(inmatrix1, inmatrix2, inmatrix1_err = None,inmatrix2_err = None ):
 
     if inmatrix1 is None or inmatrix2 is None:
-        raise MTex.MTpyError_inputarguments('ERROR - two 2x2 arrays needed as input')
+        raise TypeError('ERROR - two 2x2 arrays needed as input')
 
     if inmatrix1.shape != inmatrix2.shape:
-        raise MTex.MTpyError_inputarguments('ERROR - two 2x2 arrays with same dimensions needed as input')
+        raise TypeError('ERROR - two 2x2 arrays with same dimensions needed as input')
 
 
     prod = np.array(np.dot( np.matrix(inmatrix1), np.matrix(inmatrix2)))
 
     if (inmatrix1_err is None) or ( inmatrix1_err is None ):
         return prod, None
 
@@ -624,15 +621,15 @@
 
     try:
         if x_values.dtype not in ['complex', 'float', 'int']:
             raise
         if len(x_values) != len(y_values):
             raise
     except:
-        raise MTex.MTpyError_inputarguments('ERROR - both input arrays must be of same length')
+        raise TypeError('ERROR - both input arrays must be of same length')
 
     if len(x_values) != len(y_values):
         l = min(len(x_values) , len(y_values))
         x_values = x_values[:l]
         y_values = y_values[:l]
 
     in_array = np.zeros((len(x_values), 2), x_values.dtype)
@@ -640,20 +637,20 @@
     in_array[:,0] = x_values
     in_array[:,1] = y_values
 
     try:
         x_angle = math.radians(x_sensor_angle)
         y_angle = math.radians(y_sensor_angle)
     except:
-        raise MTex.MTpyError_inputarguments('ERROR - both angles must be of type int or float')
+        raise TypeError('ERROR - both angles must be of type int or float')
        
 
     T = np.matrix( [[ np.real(cmath.rect(1,x_angle)), np.imag(cmath.rect(1,x_angle))],[np.real(cmath.rect(1,y_angle)), np.imag(cmath.rect(1,y_angle))]])
 
     try:
         new_array = np.dot(in_array, T.I)
     except:
-        raise MTex.MTpyError_inputarguments('ERROR - angles must define independent axes to span 2D')
+        raise TypeError('ERROR - angles must define independent axes to span 2D')
 
     #print new_array.shape
 
     return new_array[:,0], new_array[:,1]
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/plot_utils.py` & `pycsamt-1.2.1/pycsamt/utils/plot_utils.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,28 +1,81 @@
 # -*- coding: utf-8 -*-
 #       Created on Tue Dec 29 19:18:44 2020
 #       This module is a part of pycsamt utils packages
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
 #       Licence: LGPL
 """
-.. _module-Plot_Utils:: `pycsamt.utils.plot_utils` 
-    :synopsis: helpers functions for visualization 
+Plot-Utils 
+===========
+
+Some utilities for plotting purpose. 
+Most functions should be deprecated in the next release. 
+
+
 """
 # import re
 import os
 import warnings
 import numpy as np
 # import matplotlib as mpl 
 # import matplotlib.cm as cm 
 # import matplotlib.pyplot as plt
 from pycsamt.utils._p import _sensitive as SB
-from pycsamt.utils import exceptions as CSex 
-from pycsamt.utils.decorator import (deprecated, deprecated_to)
-
+from pycsamt.utils.exceptions import ( 
+    PlotError , StationError, PlotTipError, 
+    FrequencyError, ParamNumberError
+    ) 
+from pycsamt.utils.decorator import (
+    deprecated, deprecated_to
+    )
+
+def control_delineate_curve(res_deline =None , phase_deline =None ): 
+    """
+    Fonction to controle delineate value given  and return value ceilling . 
 
+    :param res_deline: resistivity value  to delineate.
+    :type res_deline: float, int, list  
+    
+    :param phase_deline:  phase value to  delineate.s
+    :type phase_deline: float, int, list 
+    
+    """
+    fmt=['resistivity, phase']
+ 
+    for ii, xx_deline in enumerate([res_deline , phase_deline]): 
+        if xx_deline is  not None  : 
+            if isinstance(xx_deline, (float, int, str)):
+                try :xx_deline= float(xx_deline)
+                except : 
+                    raise PlotError(
+                        'Value <{0}> to delineate <{1}> is unacceptable.'\
+                         ' Please ckeck your value.'.format(
+                             xx_deline, fmt[ii]))
+                else :
+                    if ii ==0 : return [np.ceil(
+                            np.log10(xx_deline))]
+                    if ii ==1 : return [np.ceil(xx_deline)]
+  
+            if isinstance(xx_deline , (list, tuple, np.ndarray)):
+                xx_deline =list(xx_deline)
+                try :
+                    if ii == 0 :
+                        xx_deline = [np.ceil(np.log10(float(xx)))
+                                     for xx in xx_deline]
+                    elif  ii ==1 :
+                        xx_deline = [np.ceil(float(xx))
+                                     for xx in xx_deline]
+                        
+                except : 
+                    raise PlotError(
+                        'Value to delineate <{0}> is unacceptable.'\
+                         ' Please ckeck your value.'.format(fmt[ii]))
+                else : 
+                    return xx_deline
+                
 def share_props_for_each_plot(number_of_plot = 3 ,  **kwargs):
     """
     Function to set properties for each plot. Easy to customize line and 
     markers. Function can add other properties which are not in kwargs.keys(). 
     It will set according the number of subplotsplots 
     we assume subplot are define on one columns 
     
@@ -120,15 +173,15 @@
                     if none ,return None . less or equal to 1.
                     
     :type ptol: float 
     
     :returns: specific path 
     :rtype: str 
     """
-    if path is None : raise CSex.pyCSAMTError_plot_tip(
+    if path is None : raise PlotTipError(
             'Can not find path to read.please provided a datapath . ')
     if path is not None : 
         if os.path.isfile (path) is True : return 'isfile'
         elif os.path.isdir(path) is True :
             if os.listdir(path) is not None : 
                 ex = [file for file in os.listdir(path) 
                       if os.path.splitext(file)[1] =='.edi']
@@ -160,29 +213,29 @@
         except:
             if n_.lower().find('s')>=0 : 
                 if n_.lower().count('s')==1: 
                     n_=n_.lower().replace('s', '')
                     try : 
                         n_=int(n_) 
                     except: 
-                        raise CSex.pyCSAMTError_station(
+                        raise StationError(
                             f'Station `{n_}` is wrong! Please provided '
                             'the right id.')
         return n_
        
     if isinstance(id_, str): id_= _sid(id_)
     elif isinstance(id_, (float, int)):
         id_=int(id_)-1
         if id_<0:
             id_=1
     else: 
         try: 
             iter(id_)
         except: 
-            raise CSex.pyCSAMTError_station(
+            raise StationError(
                 f'No iterable station `{id_}` found.')
         else: 
             id_= tuple([_sid (iid ) for iid in id_])
         
     return id_
 
                 
@@ -213,15 +266,15 @@
         station_id =[station_id]
     for iid in station_id : 
         if isinstance (iid, str):
            for ss , stn in enumerate(stations ): 
                if iid.lower()  ==stn.lower() : sid.append(stn)
         if isinstance(iid, (int, float)): 
             if int(iid) > len(stations): 
-                raise CSex.pyCSAMTError_plot_tip(
+                raise PlotTipError(
                     'maximum station number is <{0}>.'
                 'Can not plot beyond this limit.'
                 ' Your stations go to <{1},...,{2}>'.\
                     format(len(stations), stations[0], stations[-1]))
                   
             sid.append(stations[int(iid) -1])
 
@@ -245,37 +298,37 @@
         freq_array=np.array(freq_array)
     if isinstance(frequency_id, (str, float, int)):
         frequency_id =[frequency_id]
     
     for freqid in frequency_id:
         if isinstance(freqid ,str) :
             try : freqid =np.float(freqid)
-            except : raise CSex.pyCSAMTError_plot_tip(
+            except : raise PlotTipError(
                     'Frequency value must be an integer of float not str ' )
         if freq_array.min() > freqid > freq_array.max() : 
             warnings.warn ('Can not find the id <{0}>. '
                            'ID provided is out of the range.Frequency trend'
                            ' to: <{1}|{2}Hz to {3}|{4}Hz>.'.\
                             format(freqid, np.where(
                                 freq_array==freq_array.min()),freq_array.min(),
                                    np.where(freq_array==freq_array.max()),
                                    freq_array.max()))
-            raise CSex.pyCSAMTError_plot_tip(
+            raise PlotTipError(
                 'frequency value <{0}Hz> is out of the range'.format(freqid))
         freqID.append(freqid)
         
     return freqID
 
 def getcloser_frequency(freq_array, frequency_id): 
     """ chek whether the frequency value given is in frequency range 
     if not found the closest value"""
     try : 
         frequency_id= float(frequency_id)
     except: 
-        raise CSex.pyCSAMTError_frequency(
+        raise FrequencyError(
             f'Frequency must be a float value not {frequency_id}.')
     else: 
         indexf = np.where(freq_array == frequency_id )[0]     
         if len(indexf)>1:
             indexf = indexf[0] # take the fist values 
         elif len(indexf) ==0: 
             sustract_freq = np.abs(freq_array - frequency_id)
@@ -312,15 +365,15 @@
                 fm=1
             elif doi.find('m')>=0 :ndoi = doi.replace('m','')
             try : doi =float(ndoi)
             except :
                 warnings.warn ('Can not convert <{0}> into float number. '\
                                'Depth of investigation value must'
                                ' be float number.'.format(doi))
-                raise CSex.pyCSAMTError_plot_tip(
+                raise PlotTipError(
                     'Value provided <{0}> must be float'
                     ' number not <{1}>'.format(doi, type(doi)))
             else :
                 if fm==1 : doi *= 1e3   # convert into m
         
     doi =float(doi) # for consistency , convert to float
     indexMatrix = np.where(base_matrix >= doi)[0][0] 
@@ -358,42 +411,42 @@
     """
 
     if isinstance(value, (str, int, float)): 
         try : value =float(value)
         except: 
             warnings.warn('Delineation value is float '
                           'number not <{0}>'.format(type(value)))
-            raise CSex.pyCSAMTError_plot_tip(
+            raise PlotTipError(
                 'Input delineation value is unacceptable.'
                 ' Please enter a float number.')
         else : value =[value]
         
     elif isinstance(value, (list, tuple())): 
         if type(value) ==tuple : value =list(value)
         try : 
             value =sorted([float(ss) for ss in value]) 
         except : 
             warnings.warn('Delineation value is'
                           ' float number not <{0}>'.format(type(value)))
-            raise CSex.pyCSAMTError_plot_tip(
+            raise PlotTipError(
                 'Input delineation value is '
                 'unacceptable. Please enter a float number.')
     try : 
         atol =float(atol)
         if atol > 1  or atol <0: 
             warnings.warn ('Tolerance value is <=1 (less or egal than 1). '
                            'Please enter again a new value.')
-            raise CSex.pyCSAMTError_plot_tip(
+            raise PlotTipError(
                 'Tolerance value is assumed to be'
                 ' 0<= atol <=1 .Please check your value.')
     except : 
         warnings.warn('Tolerance value <{0}> provided is wrong.'
                       ' Must be a float number 0<= atol <=1 '
                       ' not a <{1}>'.format(atol, type(value)))
-        raise CSex.pyCSAMTError_plot_tip(
+        raise PlotTipError(
             'Unacceptable type tolerance value.'
             ' Please enter a float number 0<= atol <=1.')
     
     # loop dictionnary an dkey value .
     delineate_dict ={}
 
     for value_to_find  in value :
@@ -465,15 +518,15 @@
     
     :returns: a new_list or ndarray 
     :rtype: list or array_like 
     """
     if not isinstance(get_xyticks, (list, np.ndarray) ): 
         warnings.warn ('Arguments get_xyticks must be a list'
                        ' not <{0}>.'.format(type(get_xyticks)))
-        raise CSex.pyCSAMTError_plot_tip(
+        raise PlotTipError(
             '<{0}> found. "get_xyticks" must be a list'
             ' or (nd.array,1).'.format(type(get_xyticks)))
     
     if number_of_ticks is None :
         if len(get_xyticks) > 2 : 
             number_of_ticks = int((len(get_xyticks)-1)/2)
         else : number_of_ticks  = len(get_xyticks)
@@ -481,15 +534,15 @@
     if not(number_of_ticks, (float, int)): 
         try : number_of_ticks=int(number_of_ticks) 
         except : 
             warnings.warn('"Number_of_ticks" arguments'
                           ' is the times to see the ticks on x|y axis.'\
                           ' Must be integer not <{0}>.'.format(
                               type(number_of_ticks)))
-            raise CSex.pyCSAMTError_plot_tip(
+            raise PlotTipError(
                 '<{0}> detected. Must be integer.')
         
     number_of_ticks=int(number_of_ticks)
     
     if len(get_xyticks) > 2 :
         if get_xyticks[1] %10 != 0 : 
             get_xyticks[1] =get_xyticks[1] + (10 - get_xyticks[1] %10)
@@ -537,15 +590,15 @@
     if not(number_of_ticks, (float, int)): 
         try : number_of_ticks=int(number_of_ticks) 
         except : 
             warnings.warn('"Number_of_ticks" arguments'
                           ' is the times to see the ticks on x|y axis.'\
                           ' Must be integer not <{0}>.'.format(
                               type(number_of_ticks)))
-            raise CSex.pyCSAMTError_plot_tip(
+            raise PlotTipError(
                 '<{0}> detected. Must be integer.')
         
     number_of_ticks=int(number_of_ticks)
     
     if logscale is True :  mod10 =np.log10(10)
     else :mod10 = 10 
        
@@ -615,15 +668,15 @@
                     fm=1
                 elif doi.find('m')>=0 :ndoi = doi.replace('m','')
                 try : doi =float(ndoi)
                 except :
                     warnings.warn ('Can not convert <{0}> into float number. '
                                    'Depth of investigation '
                                    'value must be float number.'.format(doi))
-                    raise CSex.pyCSAMTError_plot_tip(
+                    raise PlotTipError(
                         'Value provided <{0}> must be float'
                         ' number not <{1}>'.format(doi, type(doi)))
                 else :
                     if fm==1 : doi *= 1e3   # convert into m
             
         return float(doi) # for consistency , convert to float
     
@@ -642,29 +695,29 @@
     offset_start, offset_end = station_offsets.min(), station_offsets.max()    
     
     #check wheren the value provide is on the offset 
     if offset_min < offset_start : 
         warnings.warn ('Provide minimal offset is out of the range '
                        '!Offset minimal for plottig is ={0}'.format(
                            offset_start))
-        raise CSex.pyCSAMTError_plot_tip(
+        raise PlotTipError(
             'Povided minimal offset out'' of the range '
             '!Offset minimal for plottig is ={0}'.format(offset_start))
     if offset_max > offset_end  : 
         warnings.warn ('Povided maximal offset is out of the range '
                 '!Offset maximal for plottig is ={0}'.format(offset_end))
-        raise CSex.pyCSAMTError_plot_tip(
+        raise PlotTipError(
             'Povided maximal offset is out of the range !Offset'
             ' maximal for plottig is ={0}'.format(offset_end))
     
     if doi > depth_offsets.max() : 
         mess ='depth <{0}> is out of depth range. Maximum depth for'\
             '  is={1}.'.format(doi, depth_offsets.max())
         warnings.warn(mess)
-        raise CSex.pyCSAMTError_plot_tip(mess)
+        raise PlotTipError(mess)
     # make sure that station offset and and depth are not  in decrease oder
     sflip,dflip=0,0
     if depth_offsets[0] > depth_offsets[-1] : 
         depth_offsets =depth_offsets [::-1]
         sflip =1
     if station_offsets [0] > station_offsets [-1] : 
         station_offsets= station_offsets[::-1]
@@ -775,15 +828,15 @@
     """
     fmt=['resistivity, phase']
  
     for ii, xx_deline in enumerate([res_deline , phase_deline]): 
         if xx_deline is  not None  : 
             if isinstance(xx_deline, (float, int, str)):
                 try :xx_deline= float(xx_deline)
-                except : raise CSex.pyCSAMTError_plot_tip(
+                except : raise PlotTipError(
                         'Value <{0}> to delineate <{1}> is unacceptable.'
                          ' Please ckeck your value.'.format(xx_deline, 
                                                             fmt[ii]))
                 else :
                     if ii ==0 : return [np.ceil(np.log10(xx_deline))]
                     if ii ==1 : return [np.ceil(xx_deline)]
   
@@ -791,15 +844,15 @@
                 xx_deline =list(xx_deline)
                 try :
                     if ii == 0 : xx_deline = [np.ceil(np.log10(
                             float(xx))) for xx in xx_deline]
                     elif  ii ==1 : xx_deline = [np.ceil(float(xx))
                                                 for xx in xx_deline]
                         
-                except : raise CSex.pyCSAMTError_plot_tip(
+                except : raise PlotTipError(
                         'Value to delineate <{0}> is unacceptable.'
                          ' Please ckeck your value.'.format(fmt[ii]))
                 else : return xx_deline
 
 def depth_of_investigation(doi): 
     """
      Depth of investigation converter 
@@ -820,15 +873,15 @@
                 fm=1
             elif doi.find('m')>=0 :ndoi = doi.replace('m','')
             try : doi =float(ndoi)
             except :
                 warnings.warn ('Can not convert <{0}> into float number. '
                                'Depth of investigation value must be float'
                                ' number.'.format(doi))
-                raise CSex.pyCSAMTError_plot_tip(
+                raise PlotTipError(
                     'Value provided <{0}> must be float number'
                     ' not <{1}>'.format(doi, type(doi)))
             else :
                 if fm==1 : doi *= 1e3   # convert into m
         
     return float(doi) # for consistency , convert to float
 
@@ -1205,20 +1258,20 @@
     """  
     localmm, indexlmm=[[] for ii in range(2)]
     
     error_mess ='Can not convert value to float number. Arry to find locals'\
                 ' minmum and maximum must be an aray of float numbers.'
     if isinstance(array, (list, tuple)): # put on list 
         try :  array=np.array([float(ss) for ss in array])
-        except : raise CSex.pyCSAMTError_parameter_number(error_mess)
+        except : raise ParamNumberError(error_mess)
             
     if isinstance(array, (float, str, int)):
         try :
             array =np.array([float(array)])
-        except : CSex.pyCSAMTError_inputarguments(error_mess)
+        except : raise TypeError(error_mess)
     
     if len(array) == 1 : 
         return (np.array([0]), array )
     # get the initial value , use the initial at starting points        
     d0, f=array[0], 0        #... can be either local maximum or local minimum         
     localmm.append(d0)              
     indexlmm.append(0)       # append index of starting point d0
@@ -1408,26 +1461,26 @@
     tem, rm=[[] for i in range(2)]
     step_descent  =depth_of_investigation(step_descent)
     
     if isinstance(step_descent, (str, int)): 
         try : 
             step_descent =float(step_descent)
         except : 
-            raise CSex.pyCSAMTError_plot_geoinputargument(
+            raise TypeError(
                 'Could not convert depth value ={} to float.'
                 ' Please check your value.'.format(step_descent))
     
     
     if step_descent < dep_array.min(): 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             'Value provided ={0} m is less than the minimum depth'
             ' ={1} m.'.format(step_descent, dep_array.min()))
     
     if step_descent > dep_array.max(): 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             'Value provided is = {0} m is greater than maximum'
             ' depth ={1}m.'.format(step_descent, dep_array.max()))
         
     mm=0 
     _init_depth =step_descent
   
     for index, depth in enumerate(dep_array):  # index = 0
@@ -1477,32 +1530,32 @@
     :type number_of_layer: int 
     """
     if number_of_layer is None : number_of_layer =7.
     if isinstance(number_of_layer, (list, tuple, np.ndarray)): 
         try : 
             number_of_layer =int(number_of_layer[0])
         except : 
-            raise CSex.pyCSAMTError_plot_tip(
+            raise PlotTipError(
                 'Could not convert number of  layer ={0} value'
                 ' into integer.'.format(tuple(number_of_layer)))
             
     if isinstance(number_of_layer, (float, str)): 
         try : int(number_of_layer)
-        except : CSex.pyCSAMTError_plot_tip(
+        except : PlotTipError(
                 'Could not convert number of layer ={} '
                 'to integer.'.format(number_of_layer))
         else : number_of_layer=int(number_of_layer)
         
     if isinstance(station_rho_value, (list, tuple)): 
         try : 
             station_rho_value= np.array(station_rho_value)
             if station_rho_value.dtype not in ['float', 'int']: 
                 station_rho_value= station_rho_value.astype('float64')
                 
-        except : raise CSex.pyCSAMTError_plot_geoinputargument(
+        except : raise TypeError(
                 'Could not convert resistivities values '
                 'to float number. Please provide a right values.')
                   
                                                                
     
     # get maxrho and min rho 
     return np.linspace(station_rho_value.min(), station_rho_value.max(),
@@ -1533,15 +1586,15 @@
     """
     mess = "".join(["Depth and resistivity arrays have no the same Length .",
                     " Length Depth is ={0} and length depth is = {1}".format(
                         len(depth_values), len(res_values))
                     ])
     if len(depth_values) !=len(res_values) : 
         warnings.warn(mess)
-        raise CSex.pyCSAMTError_geodrill_inputarguments(
+        raise TypeError(
             'Error size. Depth and resistivity must have the same length.')
     
     # lop the resistivities array 
     v,r=[],[]
     # mm = res_values [0]
     for ii , res in enumerate(res_values):
         if res == res_values [-1] : 
@@ -1615,15 +1668,15 @@
     """
     if len(layer_thickness)==1 : 
         return layer_thickness, layer_names
     if len(layer_thickness)==0 : 
         mess = 'None value is provided, Please specify at least '\
             'the thickness of one truth layer.'
         warnings.warn(mess)
-        raise CSex.pyCSAMTError_plot_tip(mess)
+        raise PlotTipError(mess)
     
     top = layer_thickness[0]
     bottom = layer_thickness[1]
     ni=[layer_names[0]]
     v=[]
     for ii, thickvalues in enumerate(layer_thickness): 
         if ii != 0 :
@@ -1765,19 +1818,35 @@
 #              'Igneous rocks', 'Igneous rocks', 'Igneous rocks', 'Igneous rocks', 
 #              'Massive sulfide', 'Igneous rocks', 'Igneous rocks', 'Igneous rocks'] 
 
 #     resprops = [0.0, 49.0,69.0,89.0,109.0,129.0,149.0,179.0,249.0,699.0,799.0,899.0]
     
 #     thickness, lnames = annotate_tip(layer_thickness=resprops, layer_names=rocks)
 
+# ax[0].errorbar( x= res[jj], y=res[jj+1], yerr = res_err[ii],
+#               # markersize = self.ms, 
+#               marker='x',
+#               ms=2.,
+#               mfc='None',
+#               mew=1.,
+#               mec='k',
+#               ls=":",
+
+#               ecolor='k',
+#               color='k',
+#               picker=None,
+#               lw=1.,
+#               elinewidth=1.,
+#               capsize=.5,
+#               **errorbar_kw 
+#               )
 
-    
 
     
 
     
     
 
     
     
     
-    
+
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/plotdecorator.py` & `pycsamt-1.2.1/pycsamt/utils/plotdecorator.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,36 +1,41 @@
 # -*- coding: utf-8 -*-
 # This module is part of the pyCSAMT viewer package
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
 #       Licence: LGPL
 
 """
+Module PlotDecorator 
+=====================
+
+ Decorator module to plot 2d and 1d inversion of geostrata model. 
+``reason parameter specify the kind of plot and can be for::
+    - `model` : plot model inversion or geomodel 
+    - `misfit` :plot error between NM and occam inversion results. 
+    - `zonge` or `avg`: plot typical resistivity and phase values 
+    - `response`: plot fitting curves of inversion rho and phase
+    
+
 Created on Sat Aug 21 15:55:48 2021
 
-.. sypnosis:: Decorator module to plot 2d and 1d inversion of geostrata model. 
-            ``reason parameter specify the kind of plot and can be for::
-                - `model` : plot model inversion or geomodel 
-                - `misfit` :plot error between NM and occam inversion results. 
-                - `zonge` or `avg`: plot typical resistivity and phase values 
-                - `response`: plot fitting curves of inversion rho and phase
 """
 import warnings
 import functools 
 import numpy as np 
 
 import matplotlib as mpl 
 import  matplotlib.pyplot  as plt
 import matplotlib.cm as cm 
 import matplotlib.colorbar as mplcb
 import matplotlib.gridspec as gspec
 # from mpl_toolkits.axes_grid1 import make_axes_locatable
 # from matplotlib.ticker import MultipleLocator, NullLocator
 
 from pycsamt.utils import plot_utils as mplotus  
-from pycsamt.utils._csamtpylog import csamtpylog 
+from pycsamt._csamtpylog import csamtpylog 
 
 _logger=csamtpylog.get_csamtpy_logger(__name__)
 
 
 class geoplot1d : 
     """
```

### Comparing `pycsamt-1.1.2/pycsamt/utils/zcalculator.py` & `pycsamt-1.2.1/pycsamt/utils/zcalculator.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,26 +1,33 @@
 # -*- coding: utf-8 -*-
 #       Created on Thu Dec  3 16:44:29 2020
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
-#       Licence: LGPL
+#       Licence: GPL
 
 """
 .. _module-ZCalculator::`pycsamt.utils.zcalculator`
     :synopsis:  helper functions special calculator 
 """
 # import os
 import warnings 
 import numpy as np 
 
 import pycsamt.utils._p as infos
-from pycsamt.utils import exceptions as CSex
 from pycsamt.utils import func_utils as func
 from pycsamt.utils.decorator import (deprecated, deprecated_to)
-from pycsamt.utils._csamtpylog import csamtpylog 
-
+from pycsamt._csamtpylog import csamtpylog 
+from pycsamt.utils.exceptions import (
+	ZError , 
+	EmagError, 
+	FrequencyError, 
+	ProcessingError, 
+	ParamNumberError, 
+	AVGError, 
+	StationError
+	)
 _logger =csamtpylog.get_csamtpy_logger(__name__)
 try:
     import scipy
     scipy_version = [int(ss) for ss in scipy.__version__.split('.')]
     if scipy_version[0] == 0:
         if scipy_version[1] < 14:
             warnings.warn(func._msg, ImportWarning)
@@ -58,15 +65,15 @@
 
     
     if type(mag_array) is list : 
         mag_avg =np.array(mag_array) 
     try : 
         mag_avg =np.array([float(ii) for ii in mag_array])
     except : 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             "Input first arguments is wrong. must"
              "be a list of ndarray of numbers.")
         
     mag_avg =mag_array.mean()
     En =mag_avg /(A_spacing *  Txcur)
     
     return mag_avg, En 
@@ -85,15 +92,15 @@
     """
     if type (phz_array) is list : 
         phz_array =np.array(phz_array)
         
     try : 
         phz_array =[float(kk) for kk in phz_array ]
     except : 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             "input argument must be a number in array or list.")
     
     if to_degree :
         return (phz_array.mean()/1e3) *180/np.pi, (phz_array/1000) *180/np.pi
     
     return phz_array.mean()
     
@@ -104,15 +111,15 @@
     :param rho_array: array of resistivity values 
     :type rho_array: array_like 
     """
     if type(rho_array) is list : rho_array=np.array(rho_array)
     try : 
         phz_array =np.array([float(kk) for kk in rho_array ])
     except : 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             'Error inputs arguments . must be list or ndarray of numbers.')
     return  phz_array.mean()
 
 def param_phz (pphz_array, to_degree =False): 
     """
     PHZn are from each data block ,  units in  mrad 
        
@@ -122,15 +129,15 @@
     :param to_degree: ascertain convertion to degree 
     :type to_degree: bool 
     """
     if type(pphz_array) is list : pphz_array=np.array(pphz_array)
     try : 
         pphz_array =np.array([float(kk) for kk in pphz_array ])
     except : 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             'Error inputs arguments. must be list or ndarray of numbers.')
     if to_degree : 
         return (pphz_array.mean()/1000) *180/np.pi, (pphz_array/1000) *180/np.pi
     
     return  pphz_array.mean()
 
 def comp_rho (mag_E_field, mag_H_field, freq_array, A_spacing, Txcurr ):
@@ -160,20 +167,20 @@
     args =[mag_E_field, mag_H_field, freq_array, A_spacing, Txcurr]
     
     for a_args in args : 
         if type (a_args) is not np.ndarray :
             try :
                 a_args =np.array([ float(ss) for ss in a_args ])
             except : 
-                raise CSex.pyCSAMTError_inputarguments(
+                raise TypeError(
                     "Elemts composed of each array must be a number.")
         
     # if comp_rho.__code__.co_argcount ==5 : 
     #     if mag_E_field.ndim !=1 or  mag_H_field.ndim !=1 or freq_array.ndim !=1 : 
-    #         raise CSex.pyCSAMTError_inputarguments 
+    #         raise TypeError 
     #       ("dimension of Input arguments must me equal to 1.")
     
     Emag =mag_E_field /(A_spacing * Txcurr)
     Hmag =mag_H_field /Txcurr 
     comp_rho =(Emag/Hmag)**2 * (1/5*freq_array)*np.power(10,6)
     
     return comp_rho
@@ -200,21 +207,21 @@
         ...            'S00'], to_degree=True)
         ... print(value)
     """
     
     if type(comphz_array) is list : comphz_array=np.array(comphz_array)
     
     if comphz_array.dtype not in ["float", "int"] : 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             "Type provided is wrong ! number must be float")  
 
     try : 
         comphz_array=np.array([float(kk) for kk in comphz_array ])
     except : 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             'Error inputs arguments. must be list or ndarray of numbers.')
     
             
     if units =='deg' : 
         return comphz_array.mean() *180/np.pi, comphz_array *180/np.pi
     
     return  comphz_array.mean()
@@ -246,15 +253,15 @@
              Frequency at which data was measured(ndarray,1)in  Hz
              
         * kwargs : str 
              units conversion.
         
     Raises
     ------
-        CSex.pyCSAMTError_z(), 
+        ZError(), 
             Exceptions if units entered by the user doesnt match or are messy.
 
     Returns
     -------
         rho: ndarray 
             Cagnard resistivity calculation. ohm.m 
         phz: ndarray 
@@ -315,39 +322,39 @@
             }
     #check units 
     for keys ,values in units.items():
         if keys.lower() == units_E_field.lower():
             if keys.lower() in values.keys():
                 magn_E_field = magn_E_field * values[keys.lower()]
             else : 
-                raise CSex.pyCSAMTError_Emag(
+                raise EmagError(
                     "Input units is not valid. try : {0}".format(
                         list(values.keys())))
         if keys.lower() ==units_H_field.lower() : 
             if keys.lower() in values.keys():
                 magn_H_field= magn_H_field* values[keys.lower()]
             else : 
-                raise CSex.pyCSAMTError_Emag(
+                raise EmagError(
                     "Input units is not valid. try : {0}".format(
                         list(values.keys()))) 
                     
         if keys.lower() ==unit_phz.lower(): 
             if keys.lower() in values.keys():
                 
                 phz_E_field = phz_E_field* values[keys.lower()]
                 phz_H_field = phz_H_field  * values[keys.lower()]
             else : 
-                raise CSex.pyCSAMTError_Emag(
+                raise EmagError(
                     "Input units is not valid. try : {0}".format(
                         list(values.keys()))) 
         if keys.lower() ==unit_freq.lower(): 
             if keys.lower() in values.keys():
                 freq_value= freq_value * values[keys.lower()]
             else : 
-                raise CSex.pyCSAMTError_Emag(
+                raise EmagError(
                     "Input units is not valid. try : {0}".format(
                         list(values.keys()))) 
         
     #--> component real part and imag 
     Zij =magn_E_field /magn_H_field
     phz=phz_E_field - phz_H_field
     Zreal, Zimag  =Zij * np.cos(phz), Zij * np.sin(phz)
@@ -473,15 +480,15 @@
     :type freq_array: array_like 
     
     :param reffreq_value:  value of frequency at clean data 
     :type reffreq_value: float, int 
     """
     freq_array=np.array([float(ss) for ss in freq_array])
     if float(reffreq_value) not in freq_array : 
-        raise CSex.pyCSAMTError_frequency(
+        raise FrequencyError(
             'Reference frequency must be a value of frequency array.')
 
     for ii, freq in enumerate(freq_array): 
         if freq == reffreq_value:
             index_rf = ii
             break
     return index_rf
@@ -590,23 +597,23 @@
         try : freq_array=np.array([float(ff) for ff in freq_array])
         except :
             raise TypeError('Frequency data must be'
                             ' on (ndarray,1) of float value not str.')
     if type(reffreq_value) is not int or type(reffreq_value) is not float: 
         try : reffreq_value= np.int(reffreq_value)
         except: 
-            raise CSex.pyCSAMTError_frequency(
+            raise FrequencyError(
                 "Reference frequency must be either float value or integer.")
         
     if freq_array.min() > reffreq_value > freq_array.max():
         warnings.warn('Reference frequency is out of frequency '
                       'range. see more infos about reference'
                       ' frequency.|{0}|'.format(
                           infos.notion.reference_frequency))
-        raise CSex.pyCSAMTError_frequency (
+        raise FrequencyError (
             "Input reference frequency is out the frequency range. "
              "Please put value between the frequency range. "
              "Frequency range is [{0} Hz to {1} Hz].".format(
                  freq_array.min(), freq_array.max()))
     
     def force_interpolation (value_to_steep= None): 
         """ 
@@ -688,15 +695,15 @@
         ...                                      reffreq_value=1023.)
         ... Input reference frequency has been interpolated to < 1024.0 > Hz 
     """
     
     if type(reffreq_value) is str : 
         try: reffreq_value=np.float(reffreq_value)
         except:
-            raise CSex.pyCSAMTError_frequency(
+            raise FrequencyError(
                 "Reference value must be float or int value, not str!")
     #find the size of array loc : seem to be the size of stationsNames .
     stn_size =np.array(list(array_loc.keys())).size
     # # we sorted data for ensurity
     reffreq_array= np.array([values[np.where(freq_array==reffreq_value)[0]]
                              for keys, values in sorted(array_loc.items())])
 
@@ -713,15 +720,15 @@
     else :
 
         from pycsamt.processing.callffunc import get_array_from_reffreq  as gfreq
         reffreq_array=gfreq(array_loc=array_loc , freq_array=freq_array, 
                             reffreq_value=reffreq_value,
                             stnNames=sorted(array_loc.keys()))
         if reffreq_array is None :
-            raise CSex.pyCSAMTError_frequency(
+            raise FrequencyError(
                 'Something wrong happened during reference array computing.'
                  ' Please check the your inputs data size, and your station size.')
         return reffreq_array
 
 def perforce_reference_freq(dataset, frequency_array=None ):
     """ 
     Function to get automatically the reference frequency. If user
@@ -785,15 +792,15 @@
     
     if type(dipole_length) !=float or type(number_of_points) !=int: 
         
         try : 
             dipole_length = np.float(dipole_length)
             number_of_points = np.int(np.floor(number_of_points))
         except :
-            raise CSex.pyCSAMTError_processing('Dipole length and number of'\
+            raise ProcessingError('Dipole length and number of'\
                                            ' points must be a float number.')
         
     window_width = number_of_points * dipole_length
     xk , HAN = window_width / 2 , []                           # center point xk 
     X= np.linspace(-xk, xk, number_of_points)
     # X = np.arange(  -xk , xk, dipole_length)
     # xpos= np.arange(number_of_points+1)*xk 
@@ -845,15 +852,15 @@
     if window_width is None : window_width = number_of_points *  dipole_length
     if window_width is not None : 
         try : number_of_points = np.int(window_width / dipole_length ) 
         except : 
             warnings.warn('Please see more '
                           'info about coeff.Beta :<{0}>'.format(infos.notion.weighted_Beta))
 
-            raise CSex.pyCSAMTError_processing('Window width type must be float number.')
+            raise ProcessingError('Window width type must be float number.')
     
     xk = window_width / 2 
     num_pk =np.arange(dipole_length/2, window_width , dipole_length)
     beta_range= []
     for xp in num_pk : 
         if np.abs(xp - xk) <= window_width /2 : 
             beta_xp = ((1/window_width) * ((xp + dipole_length/2 - xk) +(window_width/ 2* np.pi)*\
@@ -873,24 +880,24 @@
                   dipole_length = None , number_of_points =None ):
     """
     .. note:: 
         see `compute_AMA` !
     """
      
     if z_array is None :
-        raise CSex.pyCSAMTError_Z('NoneType Impedance can not be computed.')
+        raise ZError('NoneType Impedance can not be computed.')
     if weighted_window is None : 
         if dipole_length is None or number_of_points is None :
-            raise CSex.pyCSAMTError_inputarguments('Please check '
+            raise TypeError('Please check '
                 'your Inputs values ! NoneType values of dipole length '
                 ' or number_of_stations can not be computed.!')
         try : 
             dipole_length , number_of_points  = np.float(dipole_length) , np.int(number_of_points)
         except : 
-            raise CSex.pyCSAMTError_float(
+            raise TypeError(
                 'Dipole length, number of points must be a float, and '
                  ' int  number respectively.!')
 
         weighted_window =weight_beta(dipole_length=dipole_length, 
                                       number_of_points=number_of_points)
 
     xc_pk , cFLAM , cut_off = np.int(np.floor(weighted_window.size / 2)), [], -1 
@@ -1011,15 +1018,15 @@
                         1/ window_width * ( (xv - dipole_length/2)  + (window_width/2*np.pi  * np.sin(2 * np.pi * (xv - dipole_length/2) /window_width))))
                 else :hann_xv=0 
                 hv.append(hann_xv)
                 
         return np.array(hv)
         
     if (x_point_value - dipole_length/2 < 0 or x_point_value +dipole_length/2 > window_width):
-        raise CSex.pyCSAMTError_processing('Hanning x point value is outside the window.')
+        raise ProcessingError('Hanning x point value is outside the window.')
     
     if bandwidth_values is True : 
         if on_half :return see_extraband(apply_on_half=True)
         if not on_half :return  see_extraband(apply_on_half=False)
     else :
         if x_point_value <= window_width/2:
             hann_xp= np.array( 1/ window_width * ( (x_point_value + dipole_length/2)  + (window_width/2*np.pi  * np.sin(2 * np.pi * (x_point_value + dipole_length/2) /window_width))) - \
@@ -1180,26 +1187,26 @@
         >>> flma= Zcc.compute_FLMA(z_array=z1, dipole_length=50. ,
                                number_of_points=4)
         >>> print(flma)
     """
     #reference_freq= kwargs.pop('reference_freq', 8192.)
     
     if z_array is None : 
-        raise CSex.pyCSAMTError_Z('NoneType Impedance can not be computed.')
+        raise ZError('NoneType Impedance can not be computed.')
     if weighted_window is None : 
         if dipole_length is None or number_of_points is None :
-            raise CSex.pyCSAMTError_inputarguments('Please check '
+            raise TypeError('Please check '
                 'your Inputs values ! NoneType values of dipole length '
                 ' or number_of_stations can not be computed.!')
         try : 
             dipole_length = np.float(dipole_length) 
             number_of_points= np.int(number_of_points)
             
         except :
-            raise CSex.pyCSAMTError_float(
+            raise TypeError(
                 'Dipole length, number of points must be a float, and '
                     ' int  number respectively.!')
 
         weighted_window = np.arange(0, dipole_length * number_of_points , 
                                     dipole_length)
        
     # compute weight factor Bj 
@@ -1283,27 +1290,27 @@
         >>> tma= Zcc.compute_TMA(data_array=z2,
         ...                     number_of_TMApoints= 7)
         ... print(tma)
 
     """
     
     if data_array is None :
-        raise CSex.pyCSAMTError_processing(
+        raise ProcessingError(
             'NoneType arguments can not be computed!.')
     
     if data_array.dtype not in ['float', 'int']: 
         try :data_array=np.array([float(dd) for dd in data_array])
         except : 
-            raise CSex.pyCSAMTError_float(
+            raise TypeError(
                 'Data must be on array_like float number.!')
     if type(number_of_TMApoints) is not int :
         try : 
             number_of_TMApoints=np.int(number_of_TMApoints)
         except : 
-            raise CSex.pyCSAMTError_parameter_number(
+            raise ParamNumberError(
                 'TMA filter point must be integer.')
     
     roll_TMA =[]
     # let compute TMA for one points, 1 poinst will return the data array
     # Ascertqin number of TMA point and Data _array
     
     if number_of_TMApoints > len(data_array) : 
@@ -1418,26 +1425,26 @@
         ...                                          number_of_TMApoints= 4)
         >>> print(tma)
         >>> print(z2.shape)
         >>> print(tma.shape)
     """
     
     if data_array is None or number_of_TMApoints is None :
-        raise CSex.pyCSAMTError_processing(
+        raise ProcessingError(
             'NoneType arguments can not be computed!.')
         
     if data_array.dtype not in ['float', 'int']: 
         try :data_array=np.array([float(dd) for dd in data_array])
         except :
-            raise CSex.pyCSAMTError_AvgData(
+            raise AVGError(
                 'Data must be on array_like float number.!')
     if type(number_of_TMApoints) is not int :
         try : number_of_TMApoints=np.int(number_of_TMApoints)
         except : 
-            raise CSex.pyCSAMTError_parameter_number(
+            raise ParamNumberError(
                 'TMA filter point must be integer.')
     
     roll_TMA,window  =[], np.int(np.trunc(number_of_TMApoints/2)),
 
     for ii, value in enumerate(data_array): 
         if ii < window:
             get_TMA_value =np.delete(data_array[ii:number_of_TMApoints+ii], 
@@ -1520,40 +1527,40 @@
         ...                   number_of_skin_depth= 1., dipole_length =50.,
         ...                   z_array=z1)
         ... print(znew)
     
     """
     
     if reference_freq is None : 
-        raise CSex.pyCSAMTError_frequency(
+        raise FrequencyError(
             'Please add your reference frequency!')
         
     mu0 = 4* np.pi * 1e-7 
     omega_reffreq  = 2* np.pi *  reference_freq  
     
     resistivities = kwargs.pop('app_rho', None)
     phase =kwargs.pop('phase', None)
     adaptative_value =kwargs.pop('scale', 10.)
 
     if resistivities is None : 
         if  z_array is None :
             warnings.warn('`Impedance` is None. could not compute'
                           ' `apparent resistivities`')
-            raise CSex.pyCSAMTError_processing('`Impedance`  is None.'
+            raise ProcessingError('`Impedance`  is None.'
                 'Could not compute `resistivities`.'
                 ' Please provided at least an `impedance array`.')
     
         resistivities = np.abs(z_array) ** 2 / (mu0 * omega_reffreq )
         
     elif resistivities is not None and z_array is None :
         
         if phase is None  and reference_freq is None:
             warnings.warn('Could not compute `impedance` without phase values'
                           ' and reference frequency!')
-            raise CSex.pyCSAMTError_processing(
+            raise ProcessingError(
                 'None Type could not be computed. '
                 'Please provided phase values |reference frequency')
             
         z_array = np.sqrt(resistivities * omega_reffreq * mu0 ) * (
             np.cos(phase)+  1j * np.sin( phase) ) 
     
     # compute skin depths base of uncorrected apparent resistivities
@@ -1739,15 +1746,15 @@
         array_like
             an array of all station with reffreq_value . 
             e.g reffreq_value =1024. it return all value of the array 
             at 1024Hz frequency . 
     
     """
     if stnNames is None : 
-        raise CSex.pyCSAMTError_station('You may at least specify '
+        raise StationError('You may at least specify '
                         'the array or list of stations-Names or station id.')
     
     arrayObj,freqObj=array_loc ,freq_array
     rfObj,stnObj = reffreq_value,stnNames
     def get_reffreq_index(freq_array, reffreq_value): 
         """ 
         get the index of reference index. From this index,
@@ -1787,21 +1794,21 @@
     :rtype: dict 
     
     """
         
     if station_names is not None : 
         if type(station_names) is list :
             assert len(station_names) == (data_array.size / number_of_frequency),\
-                CSex.pyCSAMTError_station(
+                StationError(
                     'Number of Station provided must be <{0}> not'
                     ' <{1}>'.format(np.int(data_array.size / number_of_frequency), 
                                             len(station_names)))
         else :
             assert station_names.size == data_array.size / number_of_frequency, \
-            CSex.pyCSAMTError_station(
+            StationError(
                 'Number of Station provided must be <{0}>'
                 ' not <{1}>'.format(np.int(data_array.size / number_of_frequency), 
                                             station_names.size))
             station_names =station_names.tolist()
             
         NUM_STN=sorted(station_names)
     elif station_names is None  :
@@ -1826,18 +1833,18 @@
     :type dipole_position: array_like 
     
     :returns: centered position value  array 
     :rtype: array_like 
     
     """
     if dipole_position is None : 
-        raise CSex.pyCSAMTError_inputarguments(
+        raise TypeError(
             'NoneType can not be compute. Please provide the right values.')
     try : dipole_position= np.array([float(pp) for pp in dipole_position])
-    except : raise CSex.pyCSAMTError_float(
+    except : raise TypeError(
             'Cannot convert position values. Position must be a'
             ' number not str.Please check your data!.')
     # temp_pospp =[(dipole_position[pp]+dipole_position[pp-1])/2 for \
     #              pp, pos in enumerate( dipole_position) if (
     # pp>0 and pp <= dipole_position.size) ] 
     return np.array([(dipole_position[pp]+dipole_position[pp-1])/2 for 
                  pp, pos in enumerate( dipole_position) 
@@ -1873,25 +1880,25 @@
     ndarray(len(stations,), len(frequency))
         matrix of dictionnary values 
     bool, 
         flip_freq, ascertain if frequency array is flipped or not. 
     """
     
     if not isinstance(dict_array, dict): 
-        raise CSex.pyCSAMTError_processing('Main argument `dict array`'
+        raise ProcessingError('Main argument `dict array`'
                                            ' should be dictionnary'
                                            ', not {0}'.type(dict_array))
         
     if freq_array is not None :
         if isinstance(freq_array, (list, tuple)):
             freq_array =np.array(freq_array)
             try :
                 freq_array=freq_array.astype('float')
             except :
-                raise CSex.pyCSAMTError_float(
+                raise TypeError(
                     'Could not convert array to value !')
         # now check the order 
         if freq_array[0] < freq_array[-1]: 
             freq_array = freq_array[::-1]
             flip_freq = True        # set flip to True to flip data values  
             
     tem= [values for stn , values in dict_array.items()]
@@ -2027,8 +2034,8 @@
     znew= compute_AMA(reference_freq=reference_frequency,
                        number_of_skin_depth= 1., dipole_length =50.,
                        z_array=z1)
     print(resistivities)
     new_resistivities = np.abs(znew) ** 2 / (4* np.pi*1e-7 * 2* np.pi * reference_frequency )
     print(new_resistivities)
   
-    
+
```

### Comparing `pycsamt-1.1.2/pycsamt/viewer/plot.py` & `pycsamt-1.2.1/pycsamt/view/plot.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,134 +1,785 @@
 # -*- coding: utf-8 -*-
 #       Created on Mon Dec 28 14:28:06 2020
 #       Author: Kouadio K.Laurent<etanoyau@gmail.com>
 #       Licence: LGPL
 """
-.. _module-Visualization:`pycsamt.viewer.plot`
- 
-.. synopsis:From `viewer` subpackage. `plot` module is the visualization module of
-   pyCSAMT software. All analyses , processings , corrections  are vusualized  
-   thoughoutthis module. We decided this option so to avoid importing several time 
-   matplotlib and its properties into differents subpackages . Import Matplotlib 
-   packages into a special module allow a good visibility of scripts  and let 
-   the editor to easy customize the plots without knowning deeply the module 
-   itself. Special plot 1d, 2d and 3D.
-        ... 
+Module View
+============
+
+Some templates for plotting purposes. It gives a quick alternative to 
+save time writting their own plot scripts. However to have full 
+control of the plot, it is recommended to write your own plot scripts. 
+
+Note that the package can not handle all the possible plots that offers the
+software. In the future, many plots should be removed and replaced by some  
+most efficient ones. 
+
 """
 
 import os 
 import re
-import  warnings 
+import copy
+import warnings 
 import numpy as np
- 
+
 import matplotlib as mpl 
-import  matplotlib.pyplot  as plt
+import matplotlib.pyplot  as plt
 import matplotlib.cm as cm 
 import matplotlib.colorbar as mplcb
 import matplotlib.gridspec as gspec
 
-import pycsamt.utils.exceptions as CSex
+from pycsamt.core import ( 
+    avg as CSMATavg , 
+    get_ediObjs 
+    )
 import pycsamt.utils.func_utils as func
 import pycsamt.utils.plot_utils as mplotus  
 import pycsamt.utils.zcalculator  as Zcc
-from pycsamt.ff.core import avg as CSMATavg 
-from pycsamt.ff.core.cs import CSAMT
-from pycsamt.ff.site import Profile
+from pycsamt.core.cs import CSAMT
+from pycsamt.site import Profile
 from pycsamt.modeling import occam2d
 from pycsamt.geodrill import geocore  as geoD
-import pycsamt.utils.plotdecorator  as mdeco
+from  pycsamt.utils.plotdecorator import geoplot1d 
 from pycsamt.utils._p import suit 
-from pycsamt.utils._csamtpylog import csamtpylog 
-from pycsamt.ff.processing.corr import shifting as Scor
+from pycsamt.processing import Processing 
+from pycsamt._csamtpylog import csamtpylog 
+from pycsamt.utils.exceptions import PlotError
+try : 
+    from pycsamt.__init__ import imtpy  
+    if imtpy : 
+        from mtpy.imaging.phase_tensor_pseudosection import (
+            PlotPhaseTensorPseudoSection ) 
+        from mtpy.modeling.modem import ( 
+            plot_response, 
+            plot_rms_maps, 
+            plot_slices, 
+            phase_tensor_maps
+            
+        )
+    else : warnings.warn("Module 'MTpy' is not detected! Install it mannualy.")
+except:
+    warnings.warn("Can't automatically setup 'MTpy'. You can get 'MTpy' at" 
+                  " `https://github.com/MTgeophysics/pycsamt.git`_ and "
+                  " install it manually!.")
+    imtpy = False 
 
 _logger=csamtpylog.get_csamtpy_logger(__name__)
 
-###############################################################################
- 
+warnings.warn("In the future, many plots of the module 'view' should be"
+              " removed and replaced by the fast and most efficient ones.", 
+              FutureWarning
+              )
+
+
 class Plot1d :
     """
-    plot 1d class
-    Deal with all 1D plots. 
+    Plot One-dimensional. It offers a quick visualisation of one-dimensional plot. 
+    
+    The methods functions are some templates for plotting puposes. They  are not 
+    exhaustive. Users can edit and customize each plot according its will.
+    
+    Hold other informations of attributes: 
 
     ==================  =======================================================
     Key Words           Description        
     ==================  =======================================================
     fig_dpi             dots-per-inch resolution of the figure
                         *default* is 300
     fig_num             number of the figure instance
                         *default* is 'Mesh'
     fig_size            size of figure in inches (width, height)
                         *default* is [5, 5]
     fs                  size of font of axis tick labels, axis labels are
                         fs+2. *default* is 6 
     ls                  [ '-' | '.' | ':' ] line style of mesh lines
                         *default* is '-'
-    marker              marker of stations 
-                        *default* is r"$\blacktriangledown$"
-    ms                  size of marker in points. *default* is 5
+    marker              marker. *default* is ``o``.
+    ms                  size of marker in points. *default* is 3.
+    x_minorticks        minorticks in x-abscissa. default is ``1``. 
+    y_minorticks        minortick in y-coordinates . *default* is ``1`` 
+    font_size           text font size. Default is ``3``
+    font_style          text font style. *default* is ``italic``
+    fs                  value for adjusting all `size`in plot. 
+                        *default* is ``2``
+    mplfont             matplotlib font for rcparameters. *default* is``cursive``
+    markerfacecolor     facecolor of the marker.*default* is ``k``. 
+    markeredgecolor     edge color of the marker point. *default* is ``k``. 
+    fontweight          weight type of the font. *default* is ``italic``.
+    lw                  width of the plot line. *default* is ``1.5``.
+    alpha               control the transparency of grid or line. 
+                        *default* is ``.5``.
+    xlim                Bound of x -coordinates (abscissa). Should be a tuple 
+                        of e.g.(0, 4 ) where 0 is the start and the end points 
+                        respectively. 
+    ylim                Bound of y -coordinates (up). Should be a tuple 
+                        of e.g.(0, 4 ) where 0 is the start and the end points 
+                        respectively.  
+    xlabel              label name along the x-coordinates. 
+    ylabel              label name along the x-coordinates.
+    savefig             figure name or path-like object for saving. 
     ==================  =======================================================
     
-    ==========================  ===============================================
-    Methods                     Description
-    ==========================  ===============================================
-    plot_topo_sep_azim          plot_topography , station separation and 
-                                azimuth  profile can plot individually or 
-                                grouped by.
-    penetrated1D                skindepth plot. penetration depth at different
-                                frequencies 
-    plot_static_correction      plot rho and rho corrected by different filter
-                                defalut filter is TMA.
-    plot_freqVSRhoPhase         Resistivity and phase plot. 
-    plot_curves                 plot data curves : specific for 
-                                Zonge Engineering AVG file. 
-    plot_RhoPhase errors        plot errors bar of resistivities in ohm.m and 
-                                phase in degree. 
-    ==========================  ===============================================
-    
     """
     
     def __init__(self,**kwargs):
         
         self._logging =csamtpylog.get_csamtpy_logger(self.__class__.__name__)
   
         self.fig_num= kwargs.pop('fig_num', 1)
         self.fig_size = kwargs.pop('fig_size', [12,8])
         self.fig_dpi =kwargs.pop('fig_dpi', 300)
         
-        self.fig_title =kwargs.pop('title', None)
+        self.fig_title =kwargs.pop('fig_title', None)
         
         self.x_minorticks=kwargs.pop('xminorticks', 1)
         self.y_minorticks =kwargs.pop('yminorticks', 1)
         
         self.font_size =kwargs.pop('font_size',3.)
         self.font_style=kwargs.pop('font_style', 'italic')
         self.fs =kwargs.pop('fs', 2.)
         
-        
-        self.mstyle =kwargs.pop('maker_style', 'o')
+        self.marker =kwargs.pop('maker', 'o')
         self.ms =kwargs.pop('ms', 3)
         self.mplfont =kwargs.pop('font','cursive')
-        self.markerfacecolor=kwargs.pop('markefacecolor', 'r')
-        self.markeredgecolor=kwargs.pop('markeredgecolor', 'gray')
+        self.markerfacecolor=kwargs.pop('markerfacecolor', 'k' )
+        self.markeredgecolor=kwargs.pop('markeredgecolor', 'k' )
         
         self.fontweight =kwargs.pop('font_weight', 'bold')
         self.ls= kwargs.pop('ls', '-')
         self.lw =kwargs.pop('lw', 1.5)
-        self.alpha = kwargs.pop('alpha', 0.5)
+        self.alpha = kwargs.pop('alpha', .5)
         
         self.xlim =None 
         self.ylim=None 
+        self.xlabel = kwargs.pop('xlabel', None) 
+        self.ylabel = kwargs.pop('ylabel', None) 
         
         self.subplot_wspace = kwargs.pop('subplot_wspace', .3)
         self.subplot_hspace = kwargs.pop('subplot_hspace', .0)
         self.subplot_right = kwargs.pop('subplot_right', .98)
         self.subplot_left = kwargs.pop('subplot_left', .08)
         self.subplot_top = kwargs.pop('subplot_top', .85)
         self.subplot_bottom = kwargs.pop('subplot_bottom', .1)
         
+        self.label_rotation = kwargs.pop('label_rotation', 90)
+        self.show_grid = kwargs.pop('show_grid', False)
+        self.grid_color = kwargs.pop('grid_color', 'k')
+        self.grid_alpha = kwargs.pop('grid_alpha', .8 )
+        self.grid_which = kwargs.pop('grid_which', 'both')
+        self.savefig = kwargs.pop('savefig', None)
+        
+    
+    def plotrecovery (self,*args,  fit_args = None, leg= None,  **kws ): 
+        """" Template to plot two station with signal recovery 
+        
+        Parameters 
+        -----------
+        *args : args : list 
+            Matplotlib logs funtions plot arguments 
+            
+        fit_args : list or tuple 
+            Matplotlib logs funtions plot arguments put on list. It used to 
+            visualize the fitting curve after apply anay correction to the data.
+            
+            X-coordinates. It should have the length M, the same of the ``arr2d``; 
+            the columns of the 2D dimensional array.  Note that if `x` is 
+            given, the `distance is not needed. 
+            
+        leg: list 
+            legend labels put into a list. It must fit the number of given 
+            plots. 
+             
+        kws : dict 
+            Additional keywords arguments of Matplotlib subsplots function  
+            :func:`plt.loglog` or :func:`plt.semilog`
+        
+        Returns 
+        ------- 
+        ax: Matplotlib.pyplot <AxesSubplot>  
+        
+        Examples
+        --------
+        >>> from pycsamt.view import Plot1d 
+        >>> from pycsamt.core import get_ediObjs 
+        >>> from pycsamt.processing import (restoreZ, moving_average , 
+                                            get_full_frequency, make2d )
+        >>> rawpath  = r'F:\\repositories\\edis' 
+        >>> ediobj_r = get_ediObjs (rawpath)
+        >>> res2d_r = make2d (ediobj_r, 'resxy') # read the component XY 
+        >>> z_xy_rest = restoreZ(ediobj_r) # no buffered data 
+        >>> # extracted the station at index 12, 27 for instance. 
+        >>> z12 = zobjs[12].resistivity[:, 0, 1]
+        >>> z27 = zobjs[27].resistivity[:, 0, 1]
+        >>> # generate a fiting curve with moving average 
+        >>> ma12 = moving_average (res2d_r[:, 12])
+        >>> ma27 = moving_average (res2d_r[:, 27])
+        >>> # get the complete frequency for the survey 
+        >>> f= get_full_frequency(ediobj_r)
+        >>> # ---> make a plot and color 
+        >>> #  make a fitting args 
+        >>> fitargs = [f, ma12, 'c-.', f,ma27, 'c-.']
+        >>> # make a legend 
+        >>> leg = ['restored data' , 'raw data ', 'recovery trend ']
+        >>> p1d=Plot1d (fig_size =(5, 3))
+        >>> p1d.plotrecovery(f, z12,  'ob--', f, res2d_r[:, 12], 'ok', 
+                             f, z27,  'ob--', f, res2d_r[:, 27], 'ok',
+                             fit_args = fitargs, leg =leg)
+        ... 
+        
+        """
+        fig, ax = plt.subplots(1,figsize = self.fig_size, num = self.fig_num,
+                                dpi = self.fig_dpi , 
+                    )
+        p1,*_ = ax.loglog(*args,  
+                  markersize = self.ms ,
+                  linewidth = self.lw ,
+                  **kws 
+                  )
+            
+        if fit_args  is not None: 
+            fit_args  = func._assert_all_types(fit_args , list, tuple)  
+            p2,*_ = ax.loglog(*fit_args,
+                      markersize = self.ms ,
+                      linewidth = self.lw 
+                      )
+
+
+        ax.set_xlabel (self.xlabel or '$Frequency [H_z]$',
+                    fontsize =1.5 * self.font_size ) 
+        ax.set_ylabel(self.ylabel or '$ App.resistivity \quad xy \quad [ \Omega.m]$',
+                   fontsize =1.5*self.font_size)
+        
+        ax.legend (handles = [p1, p1,  p2] ,
+                   labels= ['restored data' , 'raw data ', 'recovery trend '] 
+                   if leg is  None else leg,
+                   loc ='best', 
+                   ncol =len(args)//3 if fit_args  is None else (
+                        len(args)+len(fit_args ))//3  ,
+                    fontsize =self.font_size
+                    )
+        plt.title (self.fig_title or  'Recovered tensor $|Z_{xy}|$',
+                   fontsize =1.5*self.font_size)
+        
+        if self.show_grid :
+            ax.grid (visible =True , alpha =self.grid_alpha,
+                     which =self.grid_which, color =self.grid_color)
+            
+        if self.savefig is not None: 
+             plt.savefig(self.savefig , dpi = self.fig_dpi)
+             plt.close (fig =fig ) 
+
+        return ax  
+    
+    def plotoverlay1d (self, arr, freqs,  ns= 0, leg = None,
+                      show_grid =False, **kws ) : 
+        """ Plot the data at each station above to one to another. 
+        
+        This is useful to see the missing value in the data at each frequency. 
+        For |AMT| survey, the plot can show the weak frequency and also the 
+        dead band data. 
+        
+        Parameters 
+        -----------
+        arr : ndarray , shape (N, M) 
+            2D array for plotting. For instance, it can be a 2D resistivity 
+            collected at all stations (N) and all frequency (M) 
+        freqs: array-like 
+            Frequency values to designate the X-coordinates. It should have 
+            the length N, the same of the ``arr2d`` i.e. the rows of the 
+            ``arr``. Can be a frequency 
+        ns: list of int  
+            The list of indices of each stations. Start index at 0. 
+        leg: list 
+            legend labels put into a list. IOt must match the number of given 
+            resistivity values. 
+        show_grid: bool, 
+            Draw a grid space for the plot. User can customize the grid plot 
+            by him/herself.
+        kws : dict 
+            Matplotlib logs functions additional keywords arguments. 
+
+        Returns 
+        ------- 
+        ax: Matplotlib.pyplot <AxesSubplot> 
+        
+        Examples 
+        --------
+        >>> from pycsamt.processing import make2d, get_ediObjs 
+        >>> from pycsamt.processing import get_full_frequency 
+        >>> from pycsamt.view import Plot1d 
+        >>> edipath = 'data/3edis' 
+        >>> ediObjs = get_ediObjs(edipath)
+        >>> f =get_full_frequency(ediObjs) 
+        >>> zxy = make2d (ediObjs, 'zxy', kind ='modulus')
+        >>> p1d= Plot1d (fig_size =(5, 4), fig_title ='$Modulus |Z_{xy}|$')
+        >>> p1d.xlabel ='$Log_{10}Frequency [Hz]$'
+        >>> p1d.ylabel = '$|Z_{xy}|$'
+        >>> ns =[2, 16, 28, 40]
+        >>> leg =[f'S{int(ii):02}' for ii in ns]
+        >>> p1d.plotoverlay1d(zxy, freqs=f)
+       
+        """
+        
+        arr = np.array(arr) 
+        
+        if len(freqs) != len(arr) : 
+            raise ValueError ("Frequency and number of rows in array must have"
+                              f" the same length. {len(freqs)} and {len(arr)}" 
+                              " were given respectively.")
+        
+        if arr.ndim ==1: 
+           arr = arr[: , np.newaxis]
+           ns= [0]
+            
+        mask = np.isnan (arr) 
+        # replace each nan if exist by 0 before cumsum 
+        ar = arr.copy() 
+        ar[ mask] = 0. 
+        ar = np.cumsum(ar, axis =1 )
+        # now reverse input the NaN in the array 
+        ar [mask] = np.nan 
+
+        fig, ax = plt.subplots(1,figsize = self.fig_size, num = self.fig_num,
+                                dpi = self.fig_dpi , 
+                    )
+
+        if not isinstance(ns, (list, tuple, np.ndarray)):
+            ns =[ns]
+
+        try : 
+            ns = list(map(int, ns))
+        except : 
+            raise TypeError ("Could not convert station numbers to integer." 
+                             f" Got {type(ns).__name__!r}")
+            
+        if max(ns) >= len(ar): 
+            raise ValueError(f"Too many station numbers {max(ns)}. Expect a "
+                             f"maximum station indice equals to {len(ar)-1}")
+        for ii in ns: 
+            ax.loglog (freqs , ar[:, ii] , 
+                        ls = self.ls ,
+                        marker = self.marker, 
+                        markersize = self.ms ,
+                        markeredgecolor = self.markeredgecolor,
+                        markerfacecolor = self.markerfacecolor ,
+                       linewidth = self.lw, 
+                       **kws)
+        
+        ax.legend( list(map(str, ns)) if leg is None else leg , 
+                  loc ='best' , ncol = len(ns))
+        
+        ax.set_ylabel (self.ylabel  or '$ Rhoa [ \Omega.m]$', 
+                        ) 
+        ax.set_xlabel(self.xlabel or '$Log10Frequency[Hz]$', 
+                      )
+        if show_grid :
+            ax.grid (visible =True , alpha =self.grid_alpha,
+                     which =self.grid_which, color =self.grid_color)
+            
+        plt.tight_layout()   
+        
+        if self.savefig is not None: 
+             plt.savefig(self.savefig , dpi = self.fig_dpi)
+             plt.close (fig =fig ) 
+            
+        return ax
+    
+    def plotf1d (self, *args,  leg =None, kind ='semilogy', 
+                      show_grid =False, distance =50., 
+                     stnlist =None, prefix ='S', how='py',  **kws ):
+        """ Plot 1D filtered plot template  stations Vs Rhoa filtered. 
+        
+        User can edit the template to customize its plot. 
+        
+        Parameters 
+        -----------
+        *args : args : list 
+            Matplotlib logs funtions plot arguments 
+            
+        x: array-like 
+            X-coordinates. It should have the length M, the same of the ``arr2d``; 
+            the columns of the 2D dimensional array.  Note that if `x` is 
+            given, the `distance is not needed. 
+            
+        kind: str 
+             Type of log plot. Can be ``loglog``, ``semilogx``, semilogy`` or 
+             merely a base plot function. Default is ``semilogy``.
+
+        distance: float 
+            The step between two stations. If given, it creates an array of  
+            position for plotting purpose. Default value is ``50`` meters. 
+            
+        stnlist: list of str 
+            List of stations names. If given,  it should have the same length of 
+            the columns M, of `arr2d`` 
+       
+        prefix: str 
+            string value to add as prefix of given id. Prefix can be the site 
+            name. Default is ``S``. 
+            
+        show_grid: bool, 
+            Draw a grid space for the plot. User can customize the grid plot 
+            by him/herself. 
+            
+        how: str 
+            Mode to index the station. Default is 'Python indexing' i.e. 
+            the counting of stations would starts by 0. Any other mode will 
+            start the counting by 1.
+            
+        kws : dict 
+            Additional keywords arguments of Matplotlib subsplots function  
+            :func:`plt.loglog` or :func:`plt.semilog`
+        
+        Returns 
+        ------- 
+        ax: Matplotlib.pyplot <AxesSubplot> 
+            
+        Examples 
+        --------
+        >>> import matplotlib.pyplot as plt 
+        >>> from pycsamt.view import Plot1d 
+        >>> from pycsamt.processing import get_ediObjs, make2d, get_full_frequency 
+        >>> from pycsamt.processing import ama , interpolate2d
+        >>> edipath = 'data/3edis'
+        >>> ediObjs = get_ediObjs(edipath) 
+        >>> res2d_raw = make2d (ediObjs, 'resyx')
+        >>> res2d = interpolate2d (make2d (ediObjs, 'resyx')) 
+        >>> freqs = get_full_frequency(ediObjs)
+        >>> filtered =ama(res2d =res2d, phs2d =phs2d, freqs= freqs , window_size=5)
+        >>> #Plot the resistivy value of the third frequency  at all stations 
+        >>> figtitle = 'Data filtered with Adapative moving average'
+        >>> leg= ['dirty data', 'filtered data'] 
+        >>> p1d = Plot1d (fig_size =(5, 3), xlabel = 'Stations',
+                  ylabel='$ Resistivity [ \Omega.m]$', fig_title= figtitle )
+        >>> p1d.plotf1d (x, res2d_raw[3, :] , '+:', x, res2d[3, :], 
+                         'ok--',x, filtered[3, :], 'ob--', kind ='semilogy',
+                         show_grid =False, leg=leg)
+        """
+        x, y, *_ =  args 
+        
+        fig, ax = plt.subplots(1,figsize = self.fig_size, num = self.fig_num,
+                                dpi = self.fig_dpi , 
+                    )
+        
+    
+        axplot = ax.plot 
+        if kind =='loglog' : 
+            axplot = ax.loglog 
+        elif kind =='semilogx': 
+            axplot = ax.semilogx 
+        elif kind =='semilogy': 
+            axplot = ax.semilogy 
+            
+        axplot(*args, **kws, 
+               markersize = self.ms, 
+               lw = self.lw 
+               )
+        
+        ax.legend( [] if leg is None else leg , loc ='best' , ncol = 4 )
+        
+        d= distance or 1.
+        x= x if x is not None else np.arange(len(x))  * d 
+        
+        if stnlist is not None: 
+            stnlist = func._assert_all_types(stnlist, tuple, list, np.ndarray)
+            if len(stnlist)!= len(x):
+                raise ValueError("Expect  the length of the list of station names"
+                                 f" to be the same like to position {len(x)}")
+                
+        stn = stnlist or func.make_ids ( x , prefix , how = how) 
+        
+        ax.set_xticks(ticks= x, minor=False )
+        ax.set_xticklabels(stn, rotation=90., 
+                           fontdict ={'style': self.font_style, 
+                          'size':  1.5 * self.font_size ,
+                          'weight': self.fontweight},  
+                                )
+        ax.set_ylabel (self.ylabel  or '$ Rhoa [ \Omega.m]$') 
+        
+        ax.set_xlabel(self.xlabel or 'Stations', 
+                    #   fontdict ={'style': self.font_style, 
+                    # 'size': 1.5 * self.font_size ,
+                    # 'weight':  self.fontweight}, 
+                      )
+        
+        if show_grid :
+            ax.grid (visible =True ,
+                     alpha =self.grid_alpha, 
+                     which =self.grid_which,
+                     color =self.grid_color
+                     )
+            
+        plt.tight_layout()   
+        
+        if self.savefig is not None: 
+             plt.savefig(self.savefig , dpi = self.fig_dpi)
+             plt.close (fig =fig )
+             
+        return ax
+
+    def plottensors (self,  resargs , phsargs , res_err=None, phs_err =None, 
+                     sharex= False,  show_grid =True, errorbar_kw = None, 
+                     leg= None, **kws): 
+        """ 
+        
+        Parameters 
+        ----------
+        resargs : list of array-like 
+            List of resistivity values to plot. Each resistivity value is an 
+            array-like composed of collected data at each tensor component. 
+            
+        phsargs: list of array-like 
+            List of phases values  in degree to plot. Each phase value is an 
+            array-like composed of collected data at each tensor component.
+        res_err : list of array-like 
+            List of resistivity errors values to plot. Each resistivity error is 
+            an  array-like at each tensor component. 
+            
+        phs_err: list of array-like 
+            List of phase errors values in degrees to plot. Each phase error is 
+            an  array-like at each tensor component.
+            
+        kind: str 
+             Type of log plot. Can be ``loglog``, ``semilogx``, semilogy`` or 
+             merely a base plot function. Default is ``semilogy``.
+             
+        show_grid: bool, 
+            Will show a grid once triggered i.e set to ``True``. Note that some 
+            argument are fixed and can not match the purpose of the users. 
+            Edit the part of gridding plot to match your custom plot. Default 
+            is ``False``.
+        sharex, shareyAxes, optional
+            Share the x or y axis with sharex and/or sharey. The axis will
+            have the same limits, ticks, and scale as the axis of the shared axes. 
+            Default is ``False``. 
+            
+        show_grid: bool, 
+            Will show a grid once triggered i.e set to ``True``. Note that some 
+            argument are fixed and can not match the purpose of the users. 
+            Edit the part of gridding plot to match your custom plot. Default 
+            is ``False``.
+        errorbar_kw: dict 
+            Error bar additional keyword arguments. Refer to
+            :func:`pycsamt.utils.plot_utils.plot_errobar` function. 
+ 
+        leg: list 
+            legend labels put into a list. IOt must match the number of given 
+            resistivity values. 
+            
+        kws : dict 
+            Matplotlib logs functions additional keywords arguments. 
+            
+        plt.xlabel ('$Log_{10} frequency [H_z]$') ; plt.ylabel('$ Resistivity [ \Omega.m]$')
+        
+        Returns 
+        ------- 
+        ax: Matplotlib.pyplot <AxesSubplot> 
+        
+        Examples 
+        ---------
+        >>> from pycsamt.view.plot import Plot1d 
+        >>> from pycsamt.processing import flma # filter to correct resistivity 
+        >>> edipath = 'data/3edis'
+        >>> ediObjs = get_ediObjs(edipath) 
+        >>> res2d = make2d (ediObjs, 'resyx')
+        >>> phs2d = make2d (ediObjs, 'phaseyx')
+        >>> freqs = get_full_frequency(ediObjs)
+        >>> edipath = 'data/3edis'
+        >>> # -----XX-----
+        >>> rhoxx = interpolate2d (make2d (ediObjs, 'resxx')) 
+        >>> phsxx = interpolate2d (make2d (ediObjs, 'phasexx'))
+        >>> rhoxx_err = interpolate2d (make2d (ediObjs, 'resxx_err')) 
+        >>> phsxx_err = interpolate2d (make2d (ediObjs, 'phasexx_err'))
+        >>> # -----XY-----
+        >>> rhoxy = interpolate2d (make2d (ediObjs, 'resxy')) 
+        >>> phsxy = interpolate2d (make2d (ediObjs, 'phasexy'))
+        >>> rhoxy_err = interpolate2d (make2d (ediObjs, 'resxy_err')) 
+        >>> phsxy_err = interpolate2d (make2d (ediObjs, 'phasexy_err'))
+        >>> # -----YX-----
+        >>> rhoyx = interpolate2d (make2d (ediObjs, 'resyx')) 
+        >>> phsyx = interpolate2d (make2d (ediObjs, 'phaseyx'))
+        >>> rhoyx_err = interpolate2d (make2d (ediObjs, 'resyx_err')) 
+        >>> phsyx_err = interpolate2d (make2d (ediObjs, 'phaseyx_err'))
+        >>> # -----YY-----
+        >>> rhoyy = interpolate2d (make2d (ediObjs, 'resyy'))
+        >>> phsyy = interpolate2d (make2d (ediObjs, 'phaseyy'))
+        >>> rhoyy_err = interpolate2d (make2d (ediObjs, 'resyy_err')) 
+        >>> phsyy_err = interpolate2d (make2d (ediObjs, 'phaseyy_err'))
+        >>> # frame phase to between 0 and 90 degree 
+        >>> def frame_phs (arr) : 
+                return np.abs(arr)%90 
+        >>> phsxy= frame_phs(phsxy);
+        >>> phsyx= frame_phs(phsyx);
+        >>> phsyy= frame_phs(phsyy); 
+        >>> phsxx= frame_phs(phsxx) 
+        >>> leg =['XX', 'XY', 'YX', 'YY']
+        >>> res_err= [rhoxy_err[:, 3] , rhoyx_err[:, 3] ] 
+        >>> phs_err = [phsxy_err[:, 3] , phsyx_err[:, 3] ] 
+        >>> res_args = [f, rhoxx [:, 3], 'tab:pink', f, rhoxy [:, 3],
+                        'ob-', f, rhoyx [:, 3], 'or-', f, rhoyy [:, 3], 'tab:cyan'] 
+        >>> phs_args = [ f, phsxx [:, 3], 'tab:pink', f, phsxy [:, 3], 
+                        'ob-', f, phsyx [:, 3], 'or-', f, phsyy [:, 3], 'tab:cyan'] 
+        >>> p1d = Plot1d (fig_size =(5, 4), markeredgecolor ='k', markersize = 2 )
+        >>> p1d.xlabel ='$Log_{10}Frequency [HZ]$'; p1d.ylabel ='$Rhoa (\Omega.m)$'
+        >>> p1d.plottensors(resargs = res_args, phsargs =phs_args, leg=leg, 
+                            res_err =res_err, phs_err = phs_err)
+
+        References 
+        -----------
+        https://matplotlib.org/stable/gallery/color/named_colors.html
+        
+        """
+        errorbar_kw  = errorbar_kw or {}
+        res = func._assert_all_types(resargs, list, tuple)
+        phs = func._assert_all_types(phsargs, list, tuple)
+        
+        fig, ax = plt.subplots(2, sharex = sharex , figsize = self.fig_size, 
+                               num = self.fig_num, dpi = self.fig_dpi , 
+                    )
+        
+        ax[0].loglog( *res, 
+                     markersize = self.ms , 
+                     linewidth = self.lw, 
+                     **kws)
+        ax[1].semilogx( *phs,  
+                       markersize = self.ms, 
+                       linewidth = self.lw, 
+                       **kws)
+
+        if res_err is not None  : 
+            res_err = func._assert_all_types(res_err, list, tuple, np.ndarray)
+            jj=0
+            for ii in  range(len(res_err)) : 
+                mplotus.plot_errorbar(ax[0], res[jj], res[jj+1],
+                                              y_error = res_err[ii], 
+                                              **errorbar_kw 
+                                              )
+         
+                jj +=3  # to jump to next value if 
+                
+        if phs_err is not None: 
+            phs_err = func._assert_all_types(phs_err, list, tuple, np.ndarray)
+            jj=0
+            for ii in range(len(phs_err)) : 
+                mplotus.plot_errorbar(ax[1], phs[jj], phs[jj+1],
+                                              y_error=phs_err[ii], 
+                                              **errorbar_kw 
+                                              )
+                jj +=3
+                
+        ax[0].set_xlabel ( self.xlabel or '$Log_{10} frequency [H_z]$' 
+                          if not sharex else None )
+        ax[0].set_ylabel (self.ylabel  or '$ Rhoa [ \Omega.m]$') 
+        ax[1].set_xlabel ( self.xlabel or '$Log_{10} frequency [H_z]$')
+        ax[1].set_ylabel (self.ylabel  or '$ Phase[ deg^o]$') 
+        
+        ax[0].legend( [] if leg is None else leg , loc ='best' , ncol = 4 )
+        
+        if show_grid :
+            ax[0].grid (visible =True ,
+                     alpha =self.grid_alpha, 
+                     which =self.grid_which,
+                     color =self.grid_color
+                     )
+            ax[1].grid (visible =True ,
+                     alpha =self.grid_alpha, 
+                     which =self.grid_which,
+                     color =self.grid_color
+                     )
+ 
+        plt.tight_layout()   
+        
+        if self.savefig is not None: 
+             plt.savefig(self.savefig , dpi = self.fig_dpi)
+        
+        return ax
+    
+    def plotlogs (self, *args,  kind ='semilogy', leg=None, show_grid=False, 
+                  **kws): 
+        """ loglog or semilogs plots. 
+        
+        Template to quick visualize the 1D-log plots. 
+        
+        Parameters 
+        ----------
+        args : list 
+            Matplotlib logs funtions plot arguments 
+            
+        kind: str 
+             Type of log plot. Can be ``loglog``, ``semilogx``, semilogy`` or 
+             merely a base plot function. Default is ``semilogy``.
+             
+        show_grid: bool, 
+            Will show a grid once triggered i.e set to ``True``. Note that some 
+            argument are fixed and can not match the purpose of the users. 
+            Edit the part of gridding plot to match your custom plot. Default 
+            is ``False``.
+            
+        leg: list 
+            legend labels put into a list.
+        kws : dict 
+            Matplotlib logs functions additional keywords arguments. 
+        
+        Returns 
+        -------
+        pplot: logplot object 
+        
+        Examples 
+        ---------
+        >>> from pycsamt.view.plot import Plot1d 
+        >>> from pycsamt.processing import flma # filter to correct resistivity 
+        >>> edipath = 'data/3edis'
+        >>> ediObjs = get_ediObjs(edipath) 
+        >>> res2d = make2d (ediObjs, 'resyx')
+        >>> phs2d = make2d (ediObjs, 'phaseyx')
+        >>> freqs = get_full_frequency(ediObjs)
+        >>> resf =flma(res2d =res2d, phs2d =phs2d, freqs= freqs, window_size=5)
+        >>> x= np.arange (0 , res2d.shape[1]*50 , 50) # step between station is 50 m 
+        >>> leg= ['uncorrected data', 'filtered data'] # legend labels .
+        >>> figtitle = 'Data filtered with fixed length moving average' 
+        >>> p1d = Plot1d (fig_size =(10, 5), xlabel = 'Stations',
+                          ylabel='$ Resistivity [ \Omega.m]$', fig_title= figtitle )
+        >>> p1d.plotlogs (x, res2d[3, :], 'b--',x, resf[3, :], 'ok--',
+                          kind ='semilogy', show_grid =True, leg=leg )
+      
+        """
+        
+        plt.figure ( figsize = self.fig_size, num = self.fig_num,
+                    dpi = self.fig_dpi)
+        
+        pplot = plt.plot 
+        if kind =='loglog' : 
+            pplot = plt.loglog 
+        elif kind =='semilogx': 
+            pplot = plt.semilogx 
+        elif kind =='semilogy': 
+            pplot = plt.semilogy 
+            
+        pplot(*args, 
+              markersize = self.ms , 
+              linewidth = self.lw,
+              # if markerface and edge are uncommented, all maker 
+              # should hold the same view.
+              # markerfacecolor = self.markerfacecolor ,
+              # markeredgecolor=self.markeredgecolor, 
+                **kws
+                )
+        plt.xlabel(self.xlabel)
+        plt.ylabel(self.ylabel )
+        plt.legend ([] if leg is None else leg, ncol = len(args)//3)
+        plt.title (self.fig_title)
+        if show_grid :
+            plt.grid (visible =True , alpha =self.alpha, which ='both', color ='gray')
+            
+        plt.tight_layout()
+        
+        return pplot 
+        
+        
     def plot_topo_sep_azim(self,fn = None , profile_fn=None  , 
                            savefig =None ,  **kwargs):
         """
         Method to plot topographic , stations separation and azimuth profiles .
         User can add station_names and and set _it to let the program to plot 
         on the corresponding  figure. He can alse force the program to plot
         its dipole length otherwise the program will compute it automatically.
@@ -237,21 +888,21 @@
                     markeredgecolor= kwargs.pop('markeredgecolor',
                                                 ['w','r', 'gray']),
                     xtick_label_rotation=kwargs.pop('xtick_label_rotation',45.),
                     ytick_label_rotation=kwargs.pop('ytick_label_rotation',45.),
                     xtick_label_size= kwargs.pop('xtick_labelsize', 12), 
                     ytick_label_size= kwargs.pop('ytick_labelsize', 12)
                                           )
-        lw ,ls, color, alpha =kws['lw'],kws ['ls'], kws['color'], kws['alpha']
+        # lw ,ls, color, alpha =kws['lw'],kws ['ls'], kws['color'], kws['alpha']
+        lw ,ls, color=kws['lw'],kws ['ls'], kws['color']
         
-        x_ticklabel_rotation, x_ticks_labelsize ,\
-            y_ticks_labelsize = kws['xtick_label_rotation'], \
-                                    kws['xtick_label_size'],\
-                                    kws['ytick_label_size']
-            
+        x_ticklabel_rotation=kws['xtick_label_rotation']
+        x_ticks_labelsize= kws['xtick_label_size']
+        #y_ticks_labelsize=kws['ytick_label_size']
+
         marker_style, markerfacecolor, markeredgecolor =\
             kws['marker'], kws['markerfacecolor'], kws['markeredgecolor']
 
         #--------------- end of setting mpl properties -----------------------
         
 
         #  define profile object :
@@ -282,15 +933,15 @@
             lineazimuth, pmess= geoD.geostrike.compute_profile_angle(
                 easting= easting , 
                 northing =northing)
             print('---> ' + pmess)        # display profile angle message
             
                 
         elif profile_fn is None and fn is None  :
-            raise CSex.pyCSAMTError_plot(
+            raise PlotError(
                 'None path is found. Please spceify you data path.')
             
         
         #-----------------------------Build fonction --------------------------
         def plot_topography(axes=None, set_xlabel=True ): 
             """
             plot topography 
@@ -399,23 +1050,23 @@
         # --- works on exception to let function less expensive ---- 
         
         if isinstance (plot_type, str): 
             if suit.stn_separation[0].find(plot_type.lower()) < 0 :
                 if  suit.topography[0].find(plot_type.lower())< 0 : 
                     if suit.azimuth[0].find(plot_type.lower()) < 0 : 
                         if plot_type.lower() not in ['1','2','3','123','*']:
-                            raise CSex.pyCSAMTError_plot(
+                            raise PlotError(
                         'Argument provided for  plot_type is not acceptable.'
                             ' Please use  1,2,3 or the first '
                              'two letter of "Topography, Separation|Station '
                                  'or Azimuth " or "*|123" to plot the 3 profiles.')
             
         elif isinstance(plot_type, int):
             if plot_type not in [1,2,3,123]: 
-                raise CSex.pyCSAMTError_plot(
+                raise PlotError(
                     'Only 1|2|3 is need to plot. Try again !')
             plot_type=str(plot_type)
 
         # ----plot only single figures Topo/sep/azim  ------------------------
 
         if plot_type not in ['*','123']:
             
@@ -435,15 +1086,15 @@
                 # if dipole_length_curve is not True : 
                     #plot_stn_separation(axes=ax, dipole_length_curve=False)
                  plot_stn_separation(axes=ax)
 
             if set_stnnames ==True : 
                 if add_stnnames  is not None : 
                     if len (add_stnnames) != station_pk.size :
-                        raise CSex.pyCSAMTError_station(
+                        raise PlotError(
                             'Stations names provided must'
                               ' be the same length as survey points.'
                               ' Number of survey points are'
                                ' : <{0}>'.format(station_pk.size))
                     xticklabel =add_stnnames 
     
                 elif add_stnnames  is  None : 
@@ -485,15 +1136,15 @@
                 #plot_stn_separation(axes=axe3, dipole_length_curve=False)
             # else :
             plot_azimuth(axes=axe3, set_xlabel =False)
             
             if set_stnnames : 
                 if add_stnnames  is not None : 
                     if len (add_stnnames) != station_pk.size : 
-                        raise CSex.pyCSAMTError_station(
+                        raise PlotError(
                             'Stations names provided must'
                                 ' be the same length as survey points.'
                                 ' Number of survey points are'
                                   ' : <{0}>'.format(station_pk.size))
                     xticklabel =add_stnnames 
                 elif add_stnnames  is  None : 
                     xticklabel = ['S{0:02}'.format(ss) 
@@ -606,15 +1257,15 @@
             except : 
                 if isinstance( ADD_FILTER, str):
                     if ADD_FILTER.lower() not in FILTER:       
                         warnings.warn('Currently , filters availabale are '
                                       'trimming moving-average (TMA).'
                                       ' and  fixed-length-moving-average(FLMA)'
                                       'Please Try to use the availabe filters.')
-                        raise CSex.pyCSAMTError_plot(
+                        raise PlotError(
                             'Input filter <{0}> is not available.'
                               ' Please use `tma` or `flma` filters!')
                         
                 ADD_FILTER = ADD_FILTER.lower()  
             else : 
                 if ADD_FILTER ==1 or ADD_FILTER ==0: ADD_FILTER='tma'
                 elif ADD_FILTER ==2 : ADD_FILTER='flma'
@@ -623,15 +1274,15 @@
                 else :
                     ADD_FILTER ='tma' # block to default filter
 
         #if ADD_FILTER =='ama': ADD_FILTER='tma'
             
         #---> corrected data TMA , FLMA and AMA filters   ---------
         # if ADD_FILTER is not None : 
-        corr_obj = Scor(data_fn=data_fn , profile_fn=profile_fn,
+        corr_obj = Processing(data_fn=data_fn , profile_fn=profile_fn,
                         reference_freq=frequency_id )
         csamt_freq_obj=corr_obj.frequency
         csamt_res_obj= corr_obj.res_app_obj
         csamt_stn_num_obj = corr_obj.station_distance 
         stnnames =corr_obj.site_id 
         if frequency_id is None :
             frequency_id =corr_obj.referencefreq
@@ -687,15 +1338,15 @@
             RES_UNCOR = Zcc.get_data_from_reference_frequency(
                                                 array_loc=csamt_res_obj, 
                                                  freq_array=csamt_freq_obj, 
                                                   reffreq_value=referfreq )
             
             mark,  = axe.semilogy (csamt_stn_num_obj,RES_UNCOR ,
                                    c= 'white', 
-                                   marker =self.mstyle,
+                                   marker =self.marker,
                                   markersize = self.ms*2*self.fs ,
                                   markeredgecolor= self.markeredgecolor 
                                   )
             
             resPlots,= axe.semilogy(csamt_stn_num_obj,
                                     RES_UNCOR ,
                                     lw =self.lw*self.fs,
@@ -865,15 +1516,15 @@
                           bbox =dict(boxstyle='round',
                                      facecolor ='lightgrey'))
             if savefig is not None :
                 plt.savefig(savefig,
                             dpi=self.fig_dpi,
                             orientation =orient)
         plt.show()
-    @mdeco.geoplot1d(reason = 'staticshift', mtmm='s', ctmm=(.8, 0.2, .9),
+    @geoplot1d(reason = 'staticshift', mtmm='s', ctmm=(.8, 0.2, .9),
                       color_mode='color', ms_r=1.,lw_r=.7, 
                       )                   
     def plot_multiple_corrections(self,  data_fn, profile_fn =None , 
                                dipole_length =50., filter_type ='ama',
                                siteOrfreq='S00', refreq=None, 
                                **kws): 
         """
@@ -900,15 +1551,15 @@
             file or jfile is given, dont need  to provide `profile_fn`
         :type profile_fn: str 
         
         :param dipole_length: length of dipole in meters
         :type dipole_length: float, int
         
         :Example:
-            >>> from pycsamt.viewer.plot import Plot1d 
+            >>> from pycsamt.view.plot import Plot1d 
             >>> data='data/avg/K1.AVG'
             >>> viewfreq=[80, 1024,2000,  8192] # set `kind` to ``1``.
             >>> viewsite= ['S00', 's04', 's08', 'S12'] # set `kind` to ``2``
             >>> plotObj = Plot1d()
             >>> plotObj. plot_multiple_corrections(data_fn= data, kind=2, 
                                       filter_type ='ama',
                                        siteOrfreq=viewfreq
@@ -990,15 +1641,15 @@
         else: 
              if not filter_type [1, 2, 3]: 
                  filter_type =1 
         # get the first name of dict_filter value         
         ff = dict_filter[filter_type ][0] 
 
         # Read original data 
-        sshiftObj = Scor(data_fn=data_fn , profile_fn=profile_fn,
+        sshiftObj = Processing(data_fn=data_fn , profile_fn=profile_fn,
                         reference_freq=refreq)
         
         measured_rho = sshiftObj.app_res_
         measured_phase = sshiftObj.phase_
         sites = sshiftObj.site_id 
 
         if filter_type == 1: 
@@ -1046,15 +1697,15 @@
                     stnOrFreq=float(stnOrFreq)
                 except: 
                     warnings.warn(f'The kind of plot is = `{kindPlot}`.'
                         f' Coud not found `{stnOrFreq}` in '
                                   f'frequency range ={freq_array}.')
                     self._logging.debug(
                         f'{stnOrFreq} not found in frequency range.')
-                    raise CSex.pyCSAMTError_frequency(
+                    raise TypeError(
                         'frequency must be a float '
                         'number not `{}`.'.format(type(stnOrFreq)))
                 else: 
                     index_freq , freq_value = mplotus.getcloser_frequency(
                         freq_array, stnOrFreq)
                     
                 measured_rho_r = measured_rho[index_freq, :]
@@ -1151,31 +1802,31 @@
         fontstyle = kwargs.pop('font_style', 'italic')
         show_error_bar= kwargs.pop('show_error', False)
         
         # creat CSAMT Object : 
         csamt_obj = CSAMT(data_fn = fn , profile_fn = profile_fn   )
     
         if csamt_obj.freq is None :
-            raise CSex.pyCSAMTError_plot('Need absolutely frequency'
+            raise PlotError('Need absolutely frequency'
                                          ' value before plotting.'
                                          'Please add your frequency data.')
         if csamt_obj.resistivity  is None :
-            raise CSex.pyCSAMTError_plot(
+            raise PlotError(
                 'Error plotting.Provide your resistivity values.')
         
         #--- assert stations length ------ 
         stations = sorted(list(csamt_obj.resistivity.keys()))
         if rename_stations is not None : 
             if  len(stations )!= len(rename_stations): 
                 warnings.warn('Stations provided are the lenght = {0},'
                               ' The defalut stations length ={1}.'
                               ' Please provided new stations '
                               'list with the same length.'.format(
                                   len(rename_stations), len(stations)))
-                raise CSex.pyCSAMTError_station(
+                raise PlotError(
                     'New stations provided '
                     'must have the same length with default stations. ')
             stations = rename_stations
             
         #-- call function to specifier the user demand ---     
         stations_for_plot =mplotus.get_stationid(stations =stations,
                                                  station_id=station_id)
@@ -1206,15 +1857,15 @@
                                xlolims =True, xuplims=True, 
                                lw=0.7, marker = '.', 
                                 color='r',)
                 
             
             mark,  = axe1.loglog (csamt_freq_obj ,csamt_res_obj[stn], 
                                   c= 'white',
-                                  marker =self.mstyle,
+                                  marker =self.marker,
                                   markersize = self.ms* self.fs ,
                                   markeredgecolor= self.markeredgecolor)
             
             
             logfreqres= axe1.loglog(csamt_freq_obj ,
                                     csamt_res_obj[stn] ,
                                     lw =self.lw *self.fs, c='k',
@@ -1412,15 +2063,15 @@
                                     'size':self.x_minorticks *14, 
                                     'weight':'bold'})
         
         csamt_stn_num_obj=sorted(list(csamt_obj.skindepth.keys()))
         axis2.set_xticks(ticks= csamt_stndis_obj, minor=False )
         if rename_station is not None : 
             assert len(rename_station)==len(csamt_stn_num_obj),\
-                CSex.pyCSAMTError_plot("Error plot !rename_station and station"
+                PlotError("Error plot !rename_station and station"
                                        " name must have the same lenght.")
         
             csamt_stn_num_obj= rename_station 
             
         axis2.set_xticklabels(csamt_stn_num_obj, rotation=rotate_stn)
         # axis2.minorticks_on()# create legend ob for appending 
         hand_leg, leglabel, depmax, freqmax =[], [] , 0 ,0         
@@ -1851,15 +2502,15 @@
         for comp in [csamt_rms_obj, csamt_iteration_obj ]:
             if comp is None : 
                 warnings.warn (
                     'R.M.S and Iteration value are required for plotting.'
                         ' Can not plot "None" value.')
                 self._logging.warn(
                     'Error plotting R.M.S VS Iteration. Can not plot "None" value.')
-                raise CSex.pyCSAMTError_plot(
+                raise PlotError(
                     'Error Plot R.M.S . '
                     'Compulsory need R.M.S value and '
                         'Iteration value. Please check your value. ')
                 
         # append None to roughness value for last iteration if not exists
         if csamt_roughness_obj is not None :
             if csamt_roughness_obj.size != csamt_iteration_obj.size :
@@ -2169,15 +2820,15 @@
             if len(self.X) != len(self.Y):
                 mess= ''.join(['X and Y must have the same length.', 
                                'The first index has length = {0} and the second has', 
                                ' length = {1}'])
                 
                 warnings.warn(mess.format(len(self.Y),len(self.Y)))
                 self._logging.error(mess.format(len(self.Y),len(self.Y)))
-                raise CSex.pyCSAMTError_plot(mess.format(len(self.Y),
+                raise PlotError(mess.format(len(self.Y),
                                                          len(self.Y)))
             if isinstance(self.X, np.ndarray) and isinstance(self.Y, np.ndarray): 
                 #case where user profide only one line with easting and northings 
                 # coordinates. if X and Y not on list , then put on list. 
                 
                 self.X, self.Y =[self.X] , [self.Y] 
         
@@ -2201,15 +2852,15 @@
             # pfofiles are Stn files 
             if len(profiles_path) == 0 : 
                 msg =''.join([
                     'No `.stn` profiles found . Please check your right path !', 
                     'or provide  X and Y as lists of coordinates values.'])
                 self._logging.error(msg)
                 warnings.warn(msg)
-                raise CSex.pyCSAMTError_profile(msg)
+                raise PlotError(msg)
                 
             print('---> {0:02} *station profiles* detected !'.format(
                                             len(profiles_path)))
             for file in profiles_path : 
                 profile_obj  = Profile( profile_fn=file) 
                 if straigthen_out_profile is True : 
                     profile_obj.straighten_profileline() #straighen out profile 
@@ -2444,41 +3095,46 @@
     
     """
     
     def __init__(self, **kws): 
         
         self._logging= csamtpylog.get_csamtpy_logger(self.__class__.__name__)
         
+        self.plot_comp = kws.pop('plot_comp', 'xy')
+        
         self.fs =kws.pop('fs', 0.7)
         self.fig_num = kws.pop('fig_num', 1)
         self.fig_size = kws.pop('fig_size', [7,7])
         self.fig_aspect = kws.pop('fig_aspect','auto')
+        self.fig_title = kws.pop('fig_title', None)
         
         self.fig_dpi =kws.pop('fig_dpi', 300)
         self.font_size = kws.pop('font_size', 7)
         
         self.aspect = kws.pop('aspect', 'auto')
         self.font_style =kws.pop('font_style', 'italic')
         self.orient=kws.pop('orientation', 'landscape')
 
         self.plot_style = kws.pop('plot_style', 'imshow')
         self.imshow_interp = kws.pop('imshow_interp', 'bicubic')
 
         #--> set plot limits
         self.res_limits = kws.pop('res_limits', (0, 4))
         self.phase_limits = kws.pop('phase_limits', (0, 90))
+        
         for key in ['fig_title', 'xlimits', 'ylimits']:
             self.__setattr__(key, None )
         
         #--> set colorbar properties
         self.cb_pad = kws.pop('cb_pad', .0375)
         self.cb_orientation = kws.pop('cb_orientation', 'vertical')
         self.cb_shrink = kws.pop('cb_shrink', .75)
         self.cb_position = kws.pop('cb_position', None)
         self.climits = kws.pop('climits', (0, 4))
+        self.clabel = kws.pop('clabel', None)
 
         #--> set text box parameters
         self.text_location = kws.pop('text_location', None)
         self.text_xpad = kws.pop('text_xpad', .95)
         self.text_ypad = kws.pop('text_ypad', .95)
         self.text_size = kws.pop('text_size', self.font_size)
         self.text_weight = kws.pop('text_weight', 'bold')
@@ -2496,15 +3152,15 @@
         
         #------ticks parameters ------------------
         self.fw =kws.pop('font_weight', 'bold')
         self.depth_scale=kws.pop('depth_scale', 'm')
         
         # set some figure properties to make plot occam 
         self.station_offsets = None
-        self.station_names = None
+        self.station_names = kws.pop('station_names', None)
         self.station_id =kws.pop('station_id', None)
   
         self.station_font_size = kws.pop('station_font_size', 8)
         self.station_font_pad = kws.pop('station_font_pad', 1.0)
         self.station_font_weight = kws.pop('station_font_weight', 'bold')
   
         self.station_font_color = kws.pop('station_font_color', 'k')
@@ -2515,18 +3171,366 @@
         self.xpad = kws.pop('xpad', 1.0)
         self.ypad = kws.pop('ypad', 1.0)
 
         self.xminorticks = kws.pop('xminorticks', 5)
         self.yminorticks = kws.pop('yminorticks', 1)
 
         self.cmap = kws.pop('cmap', 'jet_r')
-
+        
+        self.xlabel = kws.pop('xlabel' , None) 
+        self.ylabel = kws.pop('ylabel', None) 
+        
+        self.savefig = kws.pop('savefig', None)
+        self.show = kws.pop('show', True) 
+        
         for keys in list(kws.keys()): 
             setattr(self, keys, kws[keys])
+               
+    def plotphasetensorpseudosection (
+        self,
+        ediObjs,
+        ellip_dict = None, 
+        stretch = (7000, 20 ),
+        mode ='frequency',
+        linedir ='ns',
+        **kws
+        ): 
+        """ Plot phase tensor pseudosection. 
+        
+        Method plots the phase tensor ellipses in a pseudo section format. Inherits
+        from :class:pycsamt.imaging.phase_tensor_pseudosection.PlotPhaseTensorPseudoSection`
+        
+        Parameters 
+        -----------
+        ediObjs: list  of  pycsamt.core.edi.Edi or pycsamt.core.edi.Edi objects 
+            Collections of EDI-objects from `pyCSAMT`_ and `MTpy`_ packages 
+
+        mode: str ['frequency' | 'period']
+              temporal scale of y-axis ('frequency' | 'period').
+              Default is ``frequency``. 
+              
+        stretch : float or tuple (xstretch, ystretch)
+            is a factor that scales the distance from one station to the next 
+            to make the plot readable. It determines (x,y) aspect ratio of plot.
+            *Default* is 200
+
+        linedir: str [ 'ns' | 'ew' ]
+            predominant direction of profile line
+            * 'ns' -> North-South Line or line is closer to north-south)
+            * 'ew' -> East-West line or line is closer to east-west
+            *Default* is 'ns'
+
+        station_id: tuple or list
+            start and stop of station name indicies. ex: for MT01dr 
+            station_id=(0,4) will be MT01.
+
+        ellipse_dict: dictionary
+                dictionary of parameters for the phase tensor ellipses with keys:
+                * 'size' -> size of ellipse in points
+                           *default* is 2
+
+                * 'colorby' : [ 'phimin' | 'phimax' | 'skew' |
+                                'skew_seg' | 'phidet' |
+                                'ellipticity' ]
+
+                          - 'phimin' -> colors by minimum phase
+                          - 'phimax' -> colors by maximum phase
+                          - 'skew' -> colors by skew
+                          - 'skew_seg' -> colors by skew in
+                                         discrete segments
+                                         defined by the range
+                          - 'normalized_skew' -> colors by skew
+                                  see [Booker, 2014]
+                          - 'normalized_skew_seg' -> colors by
+                                         normalized skew in
+                                         discrete segments
+                                         defined by the range
+                          - 'phidet' -> colors by determinant of
+                                       the phase tensor
+                          - 'ellipticity' -> colors by ellipticity
+                          *default* is 'phimin'
+
+                 * 'range' : tuple (min, max, step)
+                       Need to input at least the min and max
+                       and if using 'skew_seg' to plot
+                       discrete values input step as well
+                       *default* depends on 'colorby'
+
+            * 'cmap' : [ 'mt_yl2rd' | 'mt_bl2yl2rd' |
+                        'mt_wh2bl' | 'mt_rd2bl' |
+                        'mt_bl2wh2rd' | 'mt_seg_bl2wh2rd' |
+                        'mt_rd2gr2bl' ]
+
+                     - 'mt_yl2rd' -> yellow to red
+                     - 'mt_bl2yl2rd' -> blue to yellow to red
+                     - 'mt_wh2bl' -> white to blue
+                     - 'mt_rd2bl' -> red to blue
+                     - 'mt_bl2wh2rd' -> blue to white to red
+                     - 'mt_bl2gr2rd' -> blue to green to red
+                     - 'mt_rd2gr2bl' -> red to green to blue
+                     - 'mt_seg_bl2wh2rd' -> discrete blue to
+                                           white to red
+        kws: dict 
+            Additional keywords arguments from :class:`~.PlotPhaseTensorPseudoSection` 
+            of `MTpy`_ package. 
+                              
+        Returns 
+        --------
+        ptsection: `~.PlotPhaseTensorPseudoSection` object 
+        
+        Examples
+        ---------
+        >>> from pycsamt.utils import get_ediObjs 
+        >>> ediObjs = get_ediObjs('data/edis') 
+        >>> p2d= Plot2d (fig_size =(7, 7))
+        >>> p2d.plotphasetensorpseudosection(ediObjs) 
+        
+        """
+        if not imtpy: 
+            raise ImportError ("Can't plot Phase Tensor Pseudosection. Please "
+                               " install `mtpy` manually. ")
+             
+        ediObjs = get_ediObjs(ediObjs)
+        edi_list= np.array (list (map (lambda o: o.edifile , ediObjs)))
+        ellipse_dict = ellip_dict or  {
+            'ellipse_colorby':'phimin', # phimin, phimax, skew,
+            # skew_seg
+            'ellipse_range':[0,90], # Color limits. If plotting
+            'ellip_size': 2, 
+            'ellipse_cmap':'mt_bl2wh2rd'
+        } 
+        # skew_seg need to provide
+        # 3 numbers, the 3rd indicates
+        # interval, e.g. [-12,12,3]
+        # create a plot object
+        ptsection = PlotPhaseTensorPseudoSection(
+                        fn_list = edi_list,
+                        fig_size = self.fig_size, 
+                        tscale = mode, #'frequency', 
+                        plot_num = self.fig_num, 
+                        plot_title = self.fig_title, 
+                        xlimits = self.xlimits, 
+                        ylimits = self.ylimits,
+                        linedir= linedir ,  
+                        #(25, 10), # (17,8) determines (x,y) aspect ratio of plot
+                        stretch= stretch , #(7000, 20 ), for fig = (5, 5)#20 000, 10
+                        station_id=(0,len(ediObjs)), 
+                        font_size=self.font_size ,
+                        lw=self.lw,
+                        **ellipse_dict , 
+                        **kws,
+        )
+        if self.show :
+            ptsection.plot()
+        
+        if self.savefig is not None: 
+            ptsection.save_figure(save_fn =self.savefig, 
+                                  fig_dpi=self.fig_dpi)
+            ptsection.close() 
+            
+        return ptsection 
+    
+        
+    def plottemp2d (self, arr2d, y=None,  x =None, style ='pcolormesh', 
+                distance = 50., stnlist =None, prefix ='S', how= 'py',
+                **kws): 
+        """ 2D templates for quick visualization. 
+        
+        Parameters 
+        -----------
+        arr2d : ndarray , shape (N, M) 
+            2D array for plotting. For instance, it can be a 2D resistivity 
+            collected at all stations (N) and all frequency (M) 
+        y: array-like 
+            Y-coordinates. It should have the length N, the same of the ``arr2d``.
+            the rows of the ``arr2d``.
+        x: array-like 
+            X-coordinates. It should have the length M, the same of the ``arr2d``; 
+            the columns of the 2D dimensional array.  Note that if `x` is 
+            given, the `distance is not needed. 
+            
+        style: str 
+            matplotlib plot style.  It could be ``imshow`` or ``pcolormesh``. The 
+            default is ``pcolormesh``. 
+            
+        distance: float 
+            The step between two stations. If given, it creates an array of  
+            position for plotting purpose. Default value is ``50`` meters. 
+            
+        stnlist: list of str 
+            List of stations names. If given,  it should have the same length of 
+            the columns M, of `arr2d`` 
+       
+        prefix: str 
+            string value to add as prefix of given id. Prefix can be the site 
+            name. Default is ``S``. 
+            
+        how: str 
+            Mode to index the station. Default is 'Python indexing' i.e. 
+            the counting of stations would starts by 0. Any other mode will 
+            start the counting by 1.
+            
+        kws : dict 
+            Additional keywords arguments of Matplotlib subsplots function  
+            :func:`plt.subplots`
             
+        Returns 
+        -------
+        axe: <AxesSubplot> object 
+        
+        Examples 
+        -------- 
+        >>> import numpy as np
+        >>> from pycsamt.processing import make2d , get_ediObjs, interpolate2d 
+        >>> from pycsamt.processing import get_full_frequency 
+        >>> from pycsamt.view import Plot2d 
+        >>> # create a 2d grid of resistivity data from edipath 
+        >>> edipath = 'data/3edis'
+        >>> ediObjs = get_ediObjs (edipath)
+        >>> res2d_xy = make2d (ediObjs, 'resxy')
+        >>> # interpolate to fix the missing data 
+        >>> # get the full frequency of survey area in the whole collection data 
+        >>> freqs = get_full_frequency(ediObjs) # plot station vs frequency 
+        >>> res2d_xy = interpolate2d (res2d_xy )
+        >>> # create a 2D plot objects 
+        >>> p2d = Plot2d(figsize =(6, 3), xlabel= '$Distance(m)$',
+                       ylabel = '$Log_{10}Frequency [Hz]$', 
+                       clabel = '$Log_{10}Rhoa[\Omega.m$')
+        >>> # we want to plotlog10 and log10 resistivity 
+        >>> res2d_xy = np.log10(res2d_xy); freqs = np.log10(freqs)
+        >>> p2d.plottemp2d (res2d_xy, y = freqs, distance = 50 ) # distance =50 m
+        
+        """
+        
+        fig, axe = plt.subplots(1, figsize = self.fig_size, num = self.fig_num,
+                                dpi = self.fig_dpi , **kws 
+                    )
+         
+        style = style or 'pcolormesh' 
+        sc = copy.deepcopy(style)
+        style = str (style).lower().strip() 
+        if style not in ('pcolormesh', 'imshow'): 
+            raise ValueError("Plot can be either 'pcolormesh' or "
+                             f"'imshow' not {sc!r} ")
+        
+        try : 
+            distance = float(distance) 
+        except : 
+            raise TypeError (f'Expect a float value not {type(distance).__name__!r}')
+            
+        if y is not None: 
+            if len(y) != arr2d.shape [0]: 
+                raise ValueError (" 'y' array must have an identical number " 
+                                  f" of row of 2D array: {arr2d.shape[0]}")
+                
+        if x is not None: 
+            if len(x) != arr2d.shape[1]: 
+                raise ValueError (" 'x' array must have the same number " 
+                                  f" of columns of 2D array: {arr2d.shape[1]}")
+
+        d= distance or 1. 
+        y = np.arange(arr2d.shape [0]) if y is None else y 
+        x= x  or np.arange(arr2d.shape[1])  * d 
+        if stnlist is not None: 
+            stnlist = func._assert_all_types(stnlist, tuple, list, np.ndarray)
+            if len(stnlist)!= len(x):
+                raise ValueError("Expect  the length of the list of station names"
+                                 f" to be the same like to position {len(x)}")
+                
+        stn = stnlist or func.make_ids ( x , prefix , how = how) 
+        
+        cmap = plt.get_cmap( self.cmap)
+        
+        if style =='pcolormesh': 
+            
+            X, Y = np.meshgrid (x, y)
+            axr = axe.pcolormesh ( X, Y, arr2d,
+                            # for consistency check whether array does not 
+                            # contain any NaN values 
+                            vmax = arr2d[ ~np.isnan(arr2d)].max(), 
+                            vmin = arr2d[ ~np.isnan(arr2d)].min(), 
+                            shading= 'gouraud', 
+                            cmap =cmap, 
+                                  )
+
+        if style =='imshow': 
+
+            axr= axe.imshow (arr2d,
+                            interpolation = self.imshow_interp, 
+                            cmap =cmap,
+                            aspect = self.fig_aspect ,
+                            origin= 'upper', 
+                            extent=( x[~np.isnan(x)].min(),
+                                      x[~np.isnan(x)].max(), 
+                                      y[~np.isnan(y)].min(), 
+                                      y[~np.isnan(y)].max())
+                                              )
+            axe.set_ylim(y[~np.isnan(y)].min(), y[~np.isnan(y)].max())
+        
+
+        axe.set_xlabel(self.xlabel or 'Distance(m)', 
+                     fontdict ={
+   
+                      'size': 1.5* self.font_size ,
+                      'weight': self.fw}
+                                            )
+      
+        axe.set_ylabel(self.ylabel or 'log10(Frequency)[Hz]',
+                 fontdict ={
+                         #'style': self.font_style, 
+                                  'size': 1.5* self.font_size ,
+                                  'weight': self.fw})
+        if self.show_grid is True : 
+            axe.minorticks_on()
+            axe.grid(color='k', ls=':', lw =0.25, alpha=0.7, 
+                         which ='major')
+ 
+        labex , cf = self.clabel or '$log10(App.Res)[Ω.m]$', axr
+
+        cb = fig.colorbar(cf , ax= axe)
+        cb.ax.yaxis.tick_left()
+        cb.ax.tick_params(axis='y', direction='in', pad=2.)
+        
+        cb.set_label(labex,fontdict={'size': 1.5* self.font_size ,
+                                  'style':self.font_style})
+        #--> set second axis 
+        axe2 = axe.twiny() 
+        axe2.set_xticks(ticks= x,
+                    minor=False )
+        axe2.set_xticklabels(stn, 
+                         rotation=self.station_label_rotation)
+     
+        axe2.set_xlabel('Stations', 
+                        fontdict ={'style': self.font_style, 
+                                   'size': 1.5* self.font_size ,
+                                   'weight': self.fw}, )
+      
+
+        fig.suptitle(self.fig_title,
+                     ha='left',
+                     fontsize= 15* self.fs, 
+                     verticalalignment='center', 
+                    style =self.font_style,
+                    bbox =dict(boxstyle='round',
+                               facecolor ='moccasin'))
+   
+        #plt.tight_layout(h_pad =1.8, w_pad =2*1.08)
+
+        plt.tight_layout()  
+        
+        if self.savefig is not None :
+            fig.savefig(self.savefig, dpi = self.fig_dpi,
+                        orientation =self.orient)
+            #plt.close(fig =fig ) 
+        plt.show() if self.savefig is None else plt.close(fig=fig) 
+        
+        
+        return axe 
+
+        
     def penetration2D(self, fn=None , profile_fn =None, 
                       savefig =None, doi= '2km',  **kwargs): 
         """
         Plot penetration 2D. 
         
         Parameters
         -----------
@@ -2584,15 +3588,15 @@
         csamt_freq_obj =csamt_obj.freq 
         csamt_stnDis_obj =csamt_obj.station_distance
         csamt_stn_obj = sorted(list(csamt_obj.skindepth .keys()))      
 
             
         if stnnames is not None : 
             assert len(stnnames ) ==len(csamt_stn_obj),\
-                CSex.pyCSAMTError_station('Station provided must have the '
+                PlotError('Station provided must have the '
                                           'same lenght with default stations.')
             csamt_stn_obj = stnnames 
             
 
         def depth2D (dep_loc,  freq_obj, doi ): 
             """
             Build matrix freq at n-station from 1D skin depth and return 
@@ -2763,136 +3767,94 @@
                             is *AVG. 
         :type profile_fn: str
         
         :param savefig: path to save figure 
         :type savefig: str 
                 
         """
-        def controle_delineate_curve(res_deline =None , phase_deline =None ): 
-            """
-            Fonction to controle delineate value given  and return value ceilling . 
 
-            :param res_deline: resistivity value  to delineate.
-            :type res_deline: float, int, list  
-            
-            :param phase_deline:  phase value to  delineate.
-            :type phase_deline: float, int, list 
-            
-            """
-            fmt=['resistivity, phase']
- 
-            for ii, xx_deline in enumerate([res_deline , phase_deline]): 
-                if xx_deline is  not None  : 
-                    if isinstance(xx_deline, (float, int, str)):
-                        try :xx_deline= float(xx_deline)
-                        except : 
-                            raise CSex.pyCSAMTError_plot(
-                                'Value <{0}> to delineate <{1}> is unacceptable.'\
-                                 ' Please ckeck your value.'.format(
-                                     xx_deline, fmt[ii]))
-                        else :
-                            if ii ==0 : return [np.ceil(
-                                    np.log10(xx_deline))]
-                            if ii ==1 : return [np.ceil(xx_deline)]
-      
-                    if isinstance(xx_deline , (list, tuple, np.ndarray)):
-                        xx_deline =list(xx_deline)
-                        try :
-                            if ii == 0 :
-                                xx_deline = [np.ceil(np.log10(float(xx)))
-                                             for xx in xx_deline]
-                            elif  ii ==1 :
-                                xx_deline = [np.ceil(float(xx))
-                                             for xx in xx_deline]
-                                
-                        except : 
-                            raise CSex.pyCSAMTError_plot(
-                                'Value to delineate <{0}> is unacceptable.'\
-                                 ' Please ckeck your value.'.format(fmt[ii]))
-                        else : 
-                            return xx_deline
-        
         self._logging.info ('Construction of PseudocSection of Resistivity'\
                             ' and Phase from <{0}>'.format(os.path.basename(fn)))
         
         delineate_resistivity_curve =kws.pop('delineate_resistivity', None)
         #tolerance_value =kws.pop('atol', 0.2)
         delineate_phase_curve = kws.pop('delineate_phase', None)
-        mplcmap =kws.pop('cm', 'seismic')
         contourlines =kws.pop('contour_lines_style', '-')
         contourcolors =kws.pop('contour_lines_color', 'white')
-        
+
         #--create obj ----
-        csamt_obj =CSAMT(data_fn=fn , profile_fn=profile_fn)
+        csamt_obj =CSAMT(data_fn=fn , profile_fn=profile_fn, 
+                         component =self.plot_comp)
         csamt_phase_obj =csamt_obj.phase 
         csamt_res_obj =csamt_obj.resistivity 
         csamt_freq_obj =csamt_obj.freq
-        csamt_stnDis_obj =csamt_obj.station_distance
-        
+        csamt_stnDis_obj =csamt_obj.station_distance  #*1e3 if \
+            #distance =='km' else csamt_obj.station_distance
+            
         csamt_stn_obj = sorted(csamt_obj.station)
-        
-        #--- create matrix of Res and Phase 
-        csamt_RES_obj = func.concat_array_from_list(
-            list_of_array= [resvalues for keys ,
-                             resvalues  in sorted(
-                                 csamt_res_obj.items())], concat_axis=1)
-        csamt_PHS_obj = func.concat_array_from_list(
-            list_of_array = [phsvalues for 
-                             key, phsvalues in csamt_phase_obj.items() ], 
-                             concat_axis =1)
-        
-        
-        #convert Res and Phase values on logarithme scale .
-        
-        csamt_RES_obj ,csamt_freq_obj = np.log10( csamt_RES_obj),\
-            np.log10 (csamt_freq_obj ) 
+        if str(self.station_names).lower() =='edi': 
+            try : 
+                csamt_stn_obj = [
+                    e.replace('.edi', '') for e in csamt_obj.edinames]
+            except : 
+                pass
+         
+        ### Ignore the fact that arrays should have all the same 
+        # length and plot anyway. 
+        csamt_RES_obj = func.resize_resphase_values(
+            csamt_res_obj,c =csamt_freq_obj )
+        csamt_PHS_obj = func.resize_resphase_values(csamt_phase_obj,
+                                               c = csamt_freq_obj)
+        #convert Res and Phase values onto logarithm scale .
+        csamt_RES_obj  = np.log10( csamt_RES_obj)
+        csamt_freq_obj = np.log10 (csamt_freq_obj ) 
         
         #--> get delineate curve , if exist .
-    
         if delineate_phase_curve is not None : 
             delineate_phase_curve  = [ss%90 for ss in \
-                                      controle_delineate_curve(
+                                      mplotus.control_delineate_curve(
                                           phase_deline=delineate_phase_curve) ] 
         if delineate_resistivity_curve is not None : 
-            delineate_resistivity_curve = controle_delineate_curve(
+            delineate_resistivity_curve = mplotus.control_delineate_curve(
                 res_deline=delineate_resistivity_curve)
                                                       
         #-----------------------PLOT ---------------------------------------
-        if plot_style is None : plot_style = 'pcolormesh'
+        if plot_style is None : 
+            plot_style = 'pcolormesh'
         
         #--------------------figure params -----------
         
-        mpl.rcParams['figure.figsize']=[12,6]
+        mpl.rcParams['figure.figsize']=self.fig_size 
         fig =plt.figure()
         axe_res =plt.subplot2grid(shape=(2,1), loc=(0,0))
         axe_phase =plt.subplot2grid(shape=(2,1), loc=(1,0))
         
-        cmap = plt.get_cmap( mplcmap)
+        cmap = plt.get_cmap( self.cmap)
  
-
         if plot_style.lower() =='pcolormesh': 
-            xres_matrix , yres_matrix =np.meshgrid(
-                csamt_stnDis_obj, csamt_freq_obj) 
-            xphase_matrix , yphase_matrix = np.meshgrid(
-                csamt_stnDis_obj, csamt_freq_obj)
-            
+            yres_matrix, xres_matrix =np.meshgrid(
+                csamt_freq_obj, csamt_stnDis_obj ) 
+             
+            yphase_matrix , xphase_matrix = np.meshgrid(
+                 csamt_freq_obj, csamt_stnDis_obj) 
             #---res map 
             app_rho_axe = axe_res.pcolormesh (xres_matrix,
-                                              yres_matrix ,csamt_RES_obj,
-                                              vmax = csamt_RES_obj.max(), 
-                                              vmin = csamt_RES_obj.min(), 
-                                              shading= 'gouraud', 
-                                              cmap =cmap, 
+                                          yres_matrix ,
+                                          csamt_RES_obj,
+                                        vmax = csamt_RES_obj.max(), 
+                                        vmin = csamt_RES_obj.min(), 
+                                        shading= 'gouraud', 
+                                        cmap =cmap, 
                                               )
-         
             #---phase map 
             phase_axe = axe_phase.pcolormesh (xphase_matrix ,
-                                              yphase_matrix ,csamt_PHS_obj, 
-                                              vmax = csamt_PHS_obj .max(), 
-                                              vmin = csamt_PHS_obj .min(), 
+                                              yphase_matrix ,
+                                              csamt_PHS_obj, 
+                                               vmax = csamt_PHS_obj.max(), 
+                                               vmin = csamt_PHS_obj.min(), 
                                               shading= 'gouraud', 
                                               cmap =cmap, 
                                               )
             
             MAT = [[xres_matrix, yres_matrix ,csamt_RES_obj], 
                    [xphase_matrix , yphase_matrix ,csamt_PHS_obj]]
             for ii, (axe, deline)  in enumerate( zip ([axe_res, axe_phase], 
@@ -2934,59 +3896,56 @@
                         axe.clabel(contps, 
                                     inline=True,
                                     fmt='%1.1f',
                                     fontsize =self.font_size,
                                                   )
                     
         if plot_style.lower() =='imshow': 
-            xres_matrix , yres_matrix =np.meshgrid(csamt_stnDis_obj,
-                                                   csamt_freq_obj) 
-            xphase_matrix , yphase_matrix = np.meshgrid(csamt_stnDis_obj,
-                                                        csamt_freq_obj)
-            
+      
             #---res map 
-            app_rho_axe = axe_res.imshow (csamt_RES_obj,
-                                          vmax = csamt_RES_obj.max(), 
-                                          vmin = csamt_RES_obj.min(), 
+            app_rho_axe = axe_res.imshow (csamt_RES_obj.T,
+                                          # vmax = csamt_RES_obj.max(), 
+                                          # vmin = csamt_RES_obj.min(), 
                                           interpolation = self.imshow_interp, 
                                           cmap =cmap,
                                           aspect = self.fig_aspect ,
                                           origin= 'upper', 
                                           extent=(csamt_stnDis_obj.min(),
-                                                        csamt_stnDis_obj.max(), 
-                                                        csamt_freq_obj.min(), 
-                                                        csamt_freq_obj.max())
+                                                    csamt_stnDis_obj.max(), 
+                                                    csamt_freq_obj.min(), 
+                                                    csamt_freq_obj.max())
                                               )
             axe_res.set_ylim(csamt_freq_obj.min(), csamt_freq_obj.max())
  
             #---phase map 
-            phase_axe = axe_phase.imshow ( csamt_PHS_obj, 
-                                              vmax = csamt_PHS_obj.max(), 
-                                              vmin = csamt_PHS_obj.min(), 
+            phase_axe = axe_phase.imshow ( np.flipud(csamt_PHS_obj.T), 
+                                              # vmax = csamt_PHS_obj.max(), 
+                                              # vmin = csamt_PHS_obj.min(), 
                                               interpolation = self.imshow_interp, 
                                               aspect =self.fig_aspect ,
                                               cmap =cmap,
                                               origin= 'lower', 
                                                extent=(csamt_stnDis_obj.min(),
                                                        csamt_stnDis_obj.max(), 
                                                        csamt_freq_obj.min(), 
                                                         csamt_freq_obj.max(), 
+                                                        
                                                        ),
                                               )
    
             MAT = [csamt_RES_obj, csamt_PHS_obj]
             for ii, (axe, deline)  in enumerate( zip ([axe_res, axe_phase], 
                                       [delineate_resistivity_curve,
                                        delineate_phase_curve])) :
                 if  deline is not None :
                     if ii ==0 : origin ='upper'
                     else : origin ='lower'
                     contps = axe.contour(MAT[ii], colors =contourcolors, 
                                           vmax=MAT[ii].max(),
-                                            vmin = MAT[ii].min(), 
+                                          vmin = MAT[ii].min(), 
                                             linestyles=contourlines, 
                                             extent =(csamt_stnDis_obj.min(),
                                                     csamt_stnDis_obj.max(), 
                                                     csamt_freq_obj.min(), 
                                                    csamt_freq_obj.max()),
                                             extend ='both', origin= origin ,  
                                            )
@@ -2996,15 +3955,14 @@
                                     fontsize =self.font_size,
                                               )
                     axe.set_ylim (csamt_freq_obj.min(), 
                                   csamt_freq_obj.max())
             
         
         #for twin axes 
-        
         for ii, ax in enumerate([axe_res, axe_phase]):
             
              if ii ==1 :
                  ax.set_xlabel('Distance(m)', 
                                fontdict ={
                                    #'style': self.font_style, 
                                 'size': 1.5* self.font_size ,
@@ -3050,15 +4008,16 @@
                                             'weight': self.fw}, )
              if ii != 0:
                  plt.setp(axe2.get_xticklabels(), visible=False)
                  plt.setp(axe2.get_xlabel(), visible=False)
 
         fig.tight_layout()
 
-        fig.suptitle('Plot PseudocrossResistivity and Phase',
+        fig.suptitle(r'PseudocrossResistivity $\rho {0}$ '
+                     'and Phase $\phi {0}$'.format(csamt_obj.component),
                      ha='left',
                      fontsize= 15* self.fs, 
                      verticalalignment='center', 
                              style =self.font_style,
                              bbox =dict(boxstyle='round',
                                         facecolor ='moccasin'))
             
@@ -3120,26 +4079,25 @@
         if plot_style is None : plot_style = 'pcolormesh'
   
         show_contour =kwargs.pop('show_contour', False)
         contourlines =kwargs.pop('contour_lines_styles', '-')
         contourcolors =kwargs.pop('contour_lines_colors', 'white')
         delineate_resistivity_curve =kwargs.pop('delineate_rho', None)
         grid_alpha =kwargs.pop('alpha', 0.5)
-        show_report=kwargs.pop('show_report', False)
-        
+             
         set_station_label=kwargs.pop('show_station_id', True)
         
         for file , label in zip ( [iter_fn, mesh_fn , data_fn ], 
                                  ['iteration', 'mesh', 'data']): 
             if file is None : 
                 mess= 'No {0}-file found !Please input your {0} file.'.format(label)
                 warnings.warn(
                     'Iteration, mesh , data files are essential for plotting.'+ mess)
                 self._logging.error 
-                raise CSex.pyCSAMTError_occam2d_plot(mess) 
+                raise PlotError(mess) 
                 
         # scaled data and x values plots 
         if depth_scale is not None : self.depth_scale= str(depth_scale).lower() 
         if depth_scale not in ["km", "m"]: 
             self.depth_scale= "m"
             mess ="--> ! Depth scale provided ={} is '\
                 unrecognized. We reset to 'm'.".format(self.depth_scale)
@@ -3150,15 +4108,15 @@
             dz  = 1000.
 
         elif self.depth_scale == 'm': # for CSAMT , we use default as meter"m".
             dz = 1.
 
         #---> get delineate rho curve --- 
         if delineate_resistivity_curve is not None : 
-            delineate_resistivity_curve = mplotus.controle_delineate_curve(
+            delineate_resistivity_curve = mplotus.control_delineate_curve(
                 res_deline=delineate_resistivity_curve)
             #assert value to put on float rounded to 1 
             # note that value of resistivity for delineate MUST be
             #on OHM- M not log10 resistivity 
             try : 
                 # for consistency 
                 if not isinstance (delineate_resistivity_curve, list ): 
@@ -3166,15 +4124,14 @@
             except : 
                 # be sure to stay on the same output value if something wrong happen 
                 
                 delineate_resistivity_curve=delineate_resistivity_curve
                 pass 
                 
         # -------------FIND OBJECTS ----------------------------
-
         # Read occam 2d model object 
         occam_model_obj = occam2d.Model(iter_fn=iter_fn , 
                                         model_fn = model_fn , mesh_fn =mesh_fn)
         occam_data_obj = occam2d.Data(data_fn = data_fn)
         
         # get station names and station offsetS objs 
         
@@ -3182,49 +4139,44 @@
         # generally data from occam_station offset are 
         #normalized then get the dipole length to normalize 
         # xpad 
         dl = occam_data_station_offsets.max()/ (len(occam_data_station_offsets)-1)
         self.xpad = (dl/2)/dz 
 
         occam_data_station_names =occam_data_obj.data_sites
-        
+    
         if change_station_id is not None :  # call fonction to build a nu
             occam_data_station_names , mess= mplotus.build_new_station_id(
                 station_id =occam_data_station_names ,
                 new_station_name =change_station_id )
             self._logging.debug(mess)
 
                                                 
         
         # --> get plot objects for model class 
-        
         plot_x_axis  =  occam_model_obj.model_station_offsets
         plot_z_axis  =  occam_model_obj.model_depth_offsets
         occam_model_resistiviy_obj = occam_model_obj.model_resistivity
         
         #------END Objects statements ------------
         
         #-----handles depth of investigation or depth of imaging {doi}:-----
             
         # --> check doi value provided , and convert to default unit {meters}  
         doi =mplotus.depth_of_investigation(doi=doi)
         
-   
-                
         # set boundaries of stations offsets and depth 
         spec_f = -(doi/5)/dz  
-                              
-
+                             
         #-25 +0 : 1300 +25 (xpad = 25 )                              
         self.xlimits=(occam_data_station_offsets.min()/dz -self.xpad  , 
                       occam_data_station_offsets.max()/dz + self.xpad )
 
         
         #then new_sation offset becomes 
-        
         self.ylimits =(spec_f, doi/dz) 
 
         # plot ---------------figure and properties  ---------------------
 
         subplot_right = .99
         subplot_left = .085
         subplot_top = .92
@@ -3240,107 +4192,108 @@
         self.fig = plt.figure(self.fig_num, self.fig_size, dpi=self.fig_dpi)
         # plt.clf()
         
         # add a subplot to the figure with the specified aspect ratio
         self.fig_aspect ='auto'
         axm = self.fig.add_subplot(1, 1, 1, aspect=self.fig_aspect)
         
-        
         #-----PLOTS STATEMENTS -----------------------------
         
                 #fist option is "pcolormesh " 
         self._logging.info (
             'Ready to plot Model with matplotlib "{0}" style.'.format(plot_style))     
         if plot_style =='pcolormesh':
             
             # if you keep plot_x_axis and plot_z_axis in meter ,
-            #  be sure to divided py dz meshes respectively 
+            #  be sure to divided py dz meshes respectively
+            #-----------------------------------
+            plot_x_axis = np.linspace(occam_data_station_offsets.min(),
+                                      occam_data_station_offsets.max(), 
+                                      occam_model_resistiviy_obj.shape[1])
+            
+            #print(occam_model_resistiviy_obj.shape)
             mesh_x  , mesh_z= np.meshgrid(plot_x_axis,  plot_z_axis )
-            rho_axm = axm.pcolormesh (mesh_x/dz  , 
-                                    mesh_z/dz ,
-                                    occam_model_resistiviy_obj,
-                                        vmin = self.climits[0],
-                                        vmax = self.climits[1],  
-                                        shading= 'auto', 
-                                        cmap =self.cmap, 
-                                        alpha = None, 
-                                              
-                                              )
+            axm.pcolormesh (mesh_x/dz  , 
+                            mesh_z/dz ,
+                            occam_model_resistiviy_obj,
+                            # vmin =occam_data_station_offsets.min(),  #self.climits[0],
+                            # vmax = occam_data_station_offsets.max(), #self.climits[1],  
+                            shading= 'auto', 
+                            cmap =self.cmap, 
+                            alpha = None, 
+                                      
+                                      )
 
             if show_contour is True :
                 contps = axm.contour(mesh_x/dz  , mesh_z /dz ,
                                      occam_model_resistiviy_obj,
                                       colors =contourcolors,
                                       linestyles=contourlines)
                 if  delineate_resistivity_curve is not None : 
                     axm.clabel(contps,  delineate_resistivity_curve ,
                                     inline=True, fmt='%1.1f',
                                     fontsize =self.font_size,
                                       )
-
+            axm.set_xlim( [int(plot_x_axis.min()),  int(plot_x_axis.max())])
+            axm.set_ylim ([self.ylimits[1], self.ylimits[0]]) 
+            
         if plot_style.lower() =='imshow': 
 
-            mesh_x  , mesh_z= np.meshgrid(plot_x_axis  , plot_z_axis )
+            #mesh_x  , mesh_z= np.meshgrid(plot_x_axis  , plot_z_axis )
             # to get the origine =0 of the plot
             axm.imshow (occam_model_resistiviy_obj,
-                                vmax = self.climits[1], 
-                                vmin =self.climits[0], 
-                                interpolation = self.imshow_interp, 
-                                cmap =self.cmap,
-                                aspect = self.fig_aspect,
-                                origin= 'upper', 
-                                extent=( self.xlimits[0],
-                                        self.xlimits[1],
-                                        self.ylimits[1], 
-                                        self.ylimits[0] - spec_f),  
+                        vmax = self.climits[1], 
+                        vmin =self.climits[0], 
+                        interpolation = self.imshow_interp, 
+                        cmap =self.cmap,
+                        aspect = self.fig_aspect,
+                        origin= 'upper', 
+                        extent=( self.xlimits[0],
+                                self.xlimits[1],
+                                self.ylimits[1], 
+                                self.ylimits[0] - spec_f),  
 
                                     )
 
  
             if delineate_resistivity_curve is not None :
                 origin ='upper'
                 contps = axm.contour(occam_model_resistiviy_obj,
                                      colors =contourcolors, 
                                       vmax=self.climits[0],
                                       vmin = self.climits[1], 
-                                        linestyles=contourlines, 
-                                        extent =( self.xlimits[0],
-                                                  self.xlimits[1],
-                                                  self.ylimits[1], 
-                                                  self.ylimits[0]),
-                                        extend ='both',
-                                        origin= origin ,  
+                                    linestyles=contourlines, 
+                                    extent =( self.xlimits[0],
+                                              self.xlimits[1],
+                                              self.ylimits[1], 
+                                              self.ylimits[0]),
+                                    extend ='both',
+                                    origin= origin ,  
                                        )
                 axm.clabel(contps, delineate_resistivity_curve ,
                                 inline=True, 
                                 fmt='%1.1f',
                                 fontsize =self.font_size,
                                           )
         
-        
+            axm.set_xlim( [self.xlimits[0],  self.xlimits[1]])
+            axm.set_ylim ([self.ylimits[1], self.ylimits[0]]) 
         #-----------------------END PLOTS STATEMENTS---------------
             #set xlimits and y limits for model axes 
         # for making a color bar 
         if type(self.cmap) == str:
             self.cmap = cm.get_cmap(self.cmap)
-        
-        axm.set_xlim( [self.xlimits[0],  self.xlimits[1]])
-        axm.set_ylim ([self.ylimits[1], self.ylimits[0]]) 
-        
-       
-        
+     
         #-----SET TWIN axes for station ticks and labels ---------
-        
-        # create twin axis to set ticks to tehe top station
+        # create twin axis to set ticks to the top station
+        # let keep only the axe lines 
         axe2=axm.twiny()
-        axe2.xaxis.set_visible(False) # let keep only the axe lines 
-    
-
+        axe2.xaxis.set_visible(False) 
+  
         # show station maker points : 
-            
         for offset , names in zip (occam_data_station_offsets,
                                    occam_data_station_names):
             # plot the station marker ' black triangle down ' 
             # always plots at the surface.
             axm.text(offset/dz  ,
                     self.ylimits[0] - spec_f,  
                     s= self.station_marker,
@@ -3348,15 +4301,16 @@
                     verticalalignment='baseline',
                     fontdict={'size': self.ms*5, 
                               'color': self.station_color},
                     )
             
             if set_station_label is True :  # then plot label id 
                 axm.text(offset/dz ,
-                        self.ylimits[0]/5,  # get station name closest to station text.  
+                        # get station name closest to station text.
+                        self.ylimits[0]/5,    
                         s= names,
                         horizontalalignment='center',
                         verticalalignment='baseline',
                         fontdict={'size': self.ms*3, 
                                   'color': self.station_color},
                         rotation = self.station_label_rotation,
                             )
@@ -3370,15 +4324,14 @@
                         verticalalignment='baseline',
                         fontdict={'size': self.ms*5, 
                                   'color':'k', 
                                   'style': self.font_style,
                                   'weight': self.fw},
                         )
         
-       
         # put a grid on if set to True 
         if self.show_grid is True:
             # axm.grid(alpha=.3, which='major', lw=.35)
             axm.minorticks_on()
             axm.grid(color='k', ls=':', lw =0.5, alpha=grid_alpha, which ='major')
         
 
@@ -3401,34 +4354,15 @@
                                       int(self.climits[1]) + 1)])
        
         # set axes labels
         axm.set_xlabel('Distance ({0})'.format(self.depth_scale),
                       fontdict={'size': self.font_size + 2, 'weight': 'bold'})
         axm.set_ylabel('Depth ({0})'.format(self.depth_scale),
                       fontdict={'size': self.font_size + 2, 'weight': 'bold'})
-        if show_report is True : 
-            
-            # povided model offsets  slce matrix to keep the model value that we need 
-            occam_model_offsets = occam_model_obj.model_station_offsets
-            new_station_offsets,  new_depth_offsets,\
-                new_block_matrix= mplotus.slice_csamt_matrix(
-                             block_matrix =occam_model_resistiviy_obj  ,
-                            station_offsets = occam_model_offsets ,
-                            depth_offsets =occam_model_obj.model_depth_offsets,
-                            offset_MinMax=(occam_data_station_offsets[0], 
-                                           occam_data_station_offsets[-1]),
-                            doi='1km')
-            
-            # new_station_offsets,  new_depth_offsets, new_block_matrix
-            mplotus.get_conductive_and_resistive_zone (
-                data = new_block_matrix,
-                    site_names =occam_data_station_names, 
-                     model_offsets =  new_station_offsets, 
-                     site_offsets = occam_data_station_offsets)
-
+        
         self.fig.suptitle('Plot Resistivity Model :RMS={0}, Roughness={1}'.\
                           format(occam_model_obj.model_rms, 
                                 occam_model_obj.model_roughness),
                   ha='center',
           fontsize= 15* self.fs, 
           verticalalignment='center', 
           style =self.font_style,
@@ -3437,16 +4371,16 @@
         
 
         if savefig is not None : 
             plt.savefig(savefig, dpi = self.fig_dpi)
         
         plt.show()
 
-    def plot_Response(self, data_fn =None ,
-                      response_fn =None , mode =None,   **kws ): 
+    def plot_Response(self, data_fn =None ,response_fn =None ,
+                      mode =None,   **kws ): 
         """
         Function to plot forward value, and residual value from Occam 2D 
         
         list of params are below :
         
         =================  ===============  ===================================
         Params             Type             Description 
@@ -3491,15 +4425,14 @@
         # get occam data type  and build large list of possible mode 
         
         make_mode = resp_obj.occam_dtype + [
             str(mm)for mm in resp_obj.occam_mode]
         
         resp_occam_dtype_obj = resp_obj.occam_dtype
         
-        
         #---------MANAGE OCCAM PLOT MODE -------------------------
         # if mode is not provided , then take the first occam mode 
 
         if mode is None : 
             mode = resp_occam_dtype_obj [0]
         
         mode =str(mode).lower() 
@@ -3521,15 +4454,15 @@
                                        for mm in resp_obj.occam_mode]): 
             if imode ==mode : 
                 resp_occam_dtype_obj  =  resp_occam_dtype_obj [im]  
             
         #----MANAGE COUNTOUR PLOT ------------------------
          #---> get delineate rho curve --- 
         if delineate_resistivity_curve is not None : 
-            delineate_resistivity_curve = mplotus.controle_delineate_curve(
+            delineate_resistivity_curve = mplotus.control_delineate_curve(
                 res_deline=delineate_resistivity_curve)
             #assert value to put on float rounded to 1 
             # note that value of resistivity for delineate MUST 
             #be on OHM- M not log10 resistivity 
             try : 
                 # for consistency 
                 if not isinstance (delineate_resistivity_curve, list ): 
@@ -4040,15 +4973,15 @@
                     if ss=='bln_fn': 
                          mess =''.join(
                              [' ! No station station locations file '
                         'found like *bln file ! Can not plot pseudodrill and ', 
                           'pseudostratigraphy log. Please provided a station'
                               ' location file. You can use Iter2Dat model ::', 
                           'from pycsamt.modeling.occam2d import Iter2Dat:: '
-                              'or Profile module ` from pycsamt.ff.core.cs ',
+                              'or Profile module ` from pycsamt.core.cs ',
                               'import Profile` to', 
                           'build a station location file.'])
                          warnings.warn(mess)
                          self._logging.error (mess)
  
                 
             if f !=4 and f !=0:
@@ -4068,15 +5001,15 @@
             if p==0 and f==0 : 
                 mess =''.join(['None files are found ! Please provided either',
                     'Occam2D outputfiles {Mesh|Model|Data|iter} ',
                     'or Bo Yang Data File output files {Iter2dat|bln}.'])
                 warnings.warn(mess)
                 self._logging.error(mess)
         
-            raise CSex.pyCSAMTError_plot_geoinputargument(mess)
+            raise PlotError(mess)
         #----Finish ascertainement then build object and read ----
         elif p==2 or f==4 :    
             if f==4 :                       # priority to Occam2D data files 
                 print('**{0:<37} {1} {2}'.format(
                     ' Occam Input files ','=' ,
                     tuple([os.path.basename(file) for
                         file in [self.model_fn , 
@@ -4615,15 +5548,15 @@
                          bbox =dict(boxstyle='round',facecolor ='moccasin'), 
                          y=0.95)
             
             if savefig is not None :
                 plt.savefig(savefig , dpi = self.fig_dpi)
 
      
-@mdeco.geoplot1d(reason = 'zonge_engineering', color_mode='bw', 
+@geoplot1d(reason = 'zonge_engineering', color_mode='bw', 
            linebbox_kws={'boxstyle':'square','facecolor':
                          'whitesmoke', 
                           'color':'white'
                          })
 def plot_dataAndFits(data_fn =None, stations =None, **kws): 
     """ 
     Plot error Apparent resistivity and phase and error in data  
@@ -4634,42 +5567,42 @@
     :param stations: station id . Can be a list of a staion or 
         the station number. e.g. ::
         
         station ='S00' 
         sttion ='1'
         station =['s00', 13, 46]
     :param kws: keywords arguments. Please refer to 
-                :class:`pycsamt.ff.core.cs.CSAMT` for further details
+                :class:`pycsamt.core.cs.CSAMT` for further details
         
     :Returns: A list of:
         - z_lines: List of survey lines
         - z_stations: list of station to visualize 
         - z_freq: list of frequency to plot on x-axis 
         - z_appRHO: list of apparent resistivy in ohm.m to plot 
         - z_phase: list of phase in degrees 
         - z_appRho_err: list of error apparent resistivity
         - z_phase_err: list of error phase in %
         
     :Example:
         
-        >>> from pycsamt.viewer.plot import plot_dataAndFits
+        >>> from pycsamt.view.plot import plot_dataAndFits
         >>> path =r'F:\ThesisImp\avg'
         >>> pathData = [os.path.join(path, file) 
                 for file in ['K1.AVG',
                              'K4.AVG', 'K6.AVG', 'K8.AVG'
                              ]]
         >>> z_lines, z_stations, z_freq,  z_appRHO, z_phase,z_appRho_err,\
             z_phase_err=plot_dataAndFits(
                 data_fn = pathData, 
                 stations=['S00', 'S04', 's06', 's10'])
     """
  
     # manage station and create duplicate list
     if data_fn is None: 
-        raise CSex.pyCSAMTError_AVG(
+        raise TypeError(
             'No `avg` file detected. Please provide a file.')
     elif isinstance(data_fn, str): 
         data_fn = [data_fn]
     
     if stations is None : 
         _logger.debug ( 'None sation found can not be plotted.'
                        'Should be considered the default value =`S00`.')
@@ -4745,33 +5678,454 @@
         z_appRho_err.append(rho_err_)
         z_phase_err.append(phase_err_)
         
     return (z_lines, z_stations, z_freq, 
             z_appRHO, z_phase,z_appRho_err, z_phase_err)
                                                           
             
+         
+class PlotResponse(plot_response.PlotResponse):
+    """
+    plot data and response
+
+    Plots the real and imaginary impedance and induction vector if present.
+
+    :Example: ::
+
+        >>> import pycsamt.modeling.modem as modem
+        >>> dfn = r"/home/MT/ModEM/Inv1/DataFile.dat"
+        >>> rfn = r"/home/MT/ModEM/Inv1/Test_resp_000.dat"
+        >>> mrp = modem.PlotResponse(data_fn=dfn, resp_fn=rfn)
+        >>> # plot only the TE and TM modes
+        >>> mrp.plot_component = 2
+        >>> mrp.redraw_plot()
+
+    ======================== ==================================================
+    Attributes               Description
+    ======================== ==================================================
+    color_mode               [ 'color' | 'bw' ] color or black and white plots
+    cted                     color for data Z_XX and Z_XY mode
+    ctem                     color for model Z_XX and Z_XY mode
+    ctmd                     color for data Z_YX and Z_YY mode
+    ctmm                     color for model Z_YX and Z_YY mode
+    data_fn                  full path to data file
+    data_object              WSResponse instance
+    e_capsize                cap size of error bars in points (*default* is .5)
+    e_capthick               cap thickness of error bars in points (*default*
+                             is 1)
+    fig_dpi                  resolution of figure in dots-per-inch (300)
+    fig_list                 list of matplotlib.figure instances for plots
+    fig_size                 size of figure in inches (*default* is [6, 6])
+    font_size                size of font for tick labels, axes labels are
+                             font_size+2 (*default* is 7)
+    legend_border_axes_pad   padding between legend box and axes
+    legend_border_pad        padding between border of legend and symbols
+    legend_handle_text_pad   padding between text labels and symbols of legend
+    legend_label_spacing     padding between labels
+    legend_loc               location of legend
+    legend_marker_scale      scale of symbols in legend
+    lw                       line width data curves (*default* is .5)
+    ms                       size of markers (*default* is 1.5)
+    lw_r                     line width response curves (*default* is .5)
+    ms_r                     size of markers response curves (*default* is 1.5)
+    mted                     marker for data Z_XX and Z_XY mode
+    mtem                     marker for model Z_XX and Z_XY mode
+    mtmd                     marker for data Z_YX and Z_YY mode
+    mtmm                     marker for model Z_YX and Z_YY mode
+    phase_limits             limits of phase
+    plot_component           [ 2 | 4 ] 2 for TE and TM or 4 for all components
+    plot_style               [ 1 | 2 ] 1 to plot each mode in a seperate
+                             subplot and 2 to plot xx, xy and yx, yy in same
+                             plots
+    plot_type                [ '1' | list of station name ] '1' to plot all
+                             stations in data file or input a list of station
+                             names to plot if station_fn is input, otherwise
+                             input a list of integers associated with the
+                             index with in the data file, ie 2 for 2nd station
+    plot_z                   [ True | False ] *default* is True to plot
+                             impedance, False for plotting resistivity and
+                             phase
+    plot_yn                  [ 'n' | 'y' ] to plot on instantiation
+    res_limits               limits of resistivity in linear scale
+    resp_fn                  full path to response file
+    resp_object              WSResponse object for resp_fn, or list of
+                             WSResponse objects if resp_fn is a list of
+                             response files
+    station_fn               full path to station file written by WSStation
+    subplot_bottom           space between axes and bottom of figure
+    subplot_hspace           space between subplots in vertical direction
+    subplot_left             space between axes and left of figure
+    subplot_right            space between axes and right of figure
+    subplot_top              space between axes and top of figure
+    subplot_wspace           space between subplots in horizontal direction
+    ======================== ==================================================
+    """
+
+    def __init__(self, data_fn=None, resp_fn=None, **kws):
+        super ().__init__(data_fn= data_fn , resp_fn= resp_fn , **kws) 
+        self._logging=csamtpylog.get_csamtpy_logger(self.__class__.__name__)
+        
+        for key in list(kws.keys()): 
+            setattr(self, key, kws[key])
+            
+class PlotRMSMaps(plot_rms_maps.PlotRMSMaps):
+    """
+    plots the RMS as (data-model)/(error) in map view for all components
+    of the data file.  Gets this infomration from the .res file output
+    by ModEM.
+
+    .. author: `MTpy`_ of Alison Kirkby avd Jared R. Peacock (
+            https://github.com/MTgeophysics/pycsamt.git)
+      
+      
+    Arguments:
+    ----------
+        **residual_fn** : string
+                          full path to .res file
+
+    =================== =======================================================
+    Attributes                   Description
+    =================== =======================================================
+    fig                 matplotlib.figure instance for a single plot
+    fig_dpi             dots-per-inch resolution of figure *default* is 200
+    fig_num             number of fig instance *default* is 1
+    fig_size            size of figure in inches [width, height]
+                        *default* is [7,6]
+    font_size           font size of tick labels, axis labels are +2
+                        *default* is 8
+    marker              marker style for station rms,
+                        see matplotlib.line for options,
+                        *default* is 's' --> square
+    marker_size         size of marker in points. *default* is 10
+    pad_x               padding in map units from edge of the axis to stations
+                        at the extremeties in longitude.
+                        *default* is 1/2 tick_locator
+    pad_y               padding in map units from edge of the axis to stations
+                        at the extremeties in latitude.
+                        *default* is 1/2 tick_locator
+    period_index        index of the period you want to plot according to
+                        self.residual.period_list. *default* is 1
+    plot_yn             [ 'y' | 'n' ] default is 'y' to plot on instantiation
+    plot_z_list         internal variable for plotting
+    residual            modem.Data instance that holds all the information
+                        from the residual_fn given
+    residual_fn         full path to .res file
+    rms_cmap            matplotlib.cm object for coloring the markers
+    rms_cmap_dict       dictionary of color values for rms_cmap
+    rms_max             maximum rms to plot. *default* is 5.0
+    rms_min             minimum rms to plot. *default* is 1.0
+    save_path           path to save figures to. *default* is directory of
+                        residual_fn
+    subplot_bottom      spacing from axis to bottom of figure canvas.
+                        *default* is .1
+    subplot_hspace      horizontal spacing between subplots.
+                        *default* is .1
+    subplot_left        spacing from axis to left of figure canvas.
+                        *default* is .1
+    subplot_right       spacing from axis to right of figure canvas.
+                        *default* is .9
+    subplot_top         spacing from axis to top of figure canvas.
+                        *default* is .95
+    subplot_vspace      vertical spacing between subplots.
+                        *default* is .01
+    tick_locator        increment for x and y major ticks. *default* is
+                        limits/5
+    bimg                path to a geotiff to display as background of
+                        plotted maps
+    bimg_band           band of bimg to plot. *default* is None, which 
+                        will plot all available bands
+    bimg_cmap           cmap for bimg. *default* is 'viridis'. Ignored 
+                        if bimg is RBG/A
+    =================== =======================================================
+
+    =================== =======================================================
+    Methods             Description
+    =================== =======================================================
+    plot                plot rms maps for a single period
+    plot_loop           loop over all frequencies and save figures to save_path
+    read_residual_fn    read in residual_fn
+    redraw_plot         after updating attributes call redraw_plot to
+                        well redraw the plot
+    save_figure         save the figure to a file
+    =================== =======================================================
+
+
+    :Example: ::
+
+        >>> import pycsamt.modeling.modem as modem
+        >>> rms_plot = PlotRMSMaps(r"/home/ModEM/Inv1/mb_NLCG_030.res")
+        >>> # change some attributes
+        >>> rms_plot.fig_size = [6, 4]
+        >>> rms_plot.rms_max = 3
+        >>> rms_plot.redraw_plot()
+        >>> # happy with the look now loop over all periods
+        >>> rms_plot.plot_loop()
+    """
+    def __init__(self, residual_fn, **kws):
+        super ().__init__(residual_fn = residual_fn, **kws)
+        self._logging=csamtpylog.get_csamtpy_logger(self.__class__.__name__)
         
-# if __name__ == '__main__':
-#     data = '/data/avg/K1.AVG'
-#     data =r'F:\repositories\pyCSAMT\data\avg\K1.AVG'
-#     data2= r'C:\Users\Administrator\OneDrive\Python\pyCSAMT\data\avg\K1.AVG'
-#     data3=r'F:\ThesisImp\avg\K9.AVG'
-#     path =r'F:\ThesisImp\avg'
-#     pathData = [os.path.join(path, file) 
-#                 for file in ['K1.AVG',
-#                               'K4.AVG', 'K6.AVG', 'K8.AVG'
-#                               ]]
+        for key in list(kws.keys()): 
+            setattr(self, key, kws[key])
+ 
+class PlotPTMaps(phase_tensor_maps.PlotPTMaps):
+    """
+    Plot phase tensor maps including residual pt if response file is input.
+
+      .. author: `MTpy`_ of Alison Kirkby avd Jared R. Peacock (
+              https://github.com/MTgeophysics/pycsamt.git)
+
+    :Plot only data for one period: ::
+
+        >>> import pycsamt.modeling.ws3dinv as ws
+        >>> dfn = r"/home/MT/ws3dinv/Inv1/WSDataFile.dat"
+        >>> ptm = ws.PlotPTMaps(data_fn=dfn, plot_period_list=[0])
+
+    :Plot data and model response: ::
+
+        >>> import pycsamt.modeling.ws3dinv as ws
+        >>> dfn = r"/home/MT/ws3dinv/Inv1/WSDataFile.dat"
+        >>> rfn = r"/home/MT/ws3dinv/Inv1/Test_resp.00"
+        >>> mfn = r"/home/MT/ws3dinv/Inv1/Test_model.00"
+        >>> ptm = ws.PlotPTMaps(data_fn=dfn, resp_fn=rfn, model_fn=mfn,
+        >>> ...                 plot_period_list=[0])
+        >>> # adjust colorbar
+        >>> ptm.cb_res_pad = 1.25
+        >>> ptm.redraw_plot()
+
+
+    ========================== ================================================
+    Attributes                 Description
+    ========================== ================================================
+    cb_pt_pad                  percentage from top of axes to place pt
+                               color bar. *default* is 1.2
+    cb_res_pad                 percentage from bottom of axes to place
+                               resistivity color bar. *default* is 0.5
+    cb_residual_tick_step      tick step for residual pt. *default* is 3
+    cb_tick_step               tick step for phase tensor color bar,
+                               *default* is 45
+    data_obj                   data object (read in from ModEM data file)
+    data_fn                    full path to data fle
+    dscale                     scaling parameter depending on map_scale
+    ellipse_cmap               color map for pt ellipses. *default* is
+                               mt_bl2gr2rd
+    ellipse_colorby            [ 'skew' | 'skew_seg' | 'phimin' | 'phimax'|
+                                 'phidet' | 'ellipticity' ] parameter to color
+                                 ellipses by. *default* is 'phimin'
+    ellipse_range              (min, max, step) min and max of colormap, need
+                               to input step if plotting skew_seg
+    ellipse_size               relative size of ellipses in map_scale
+    ew_limits                  limits of plot in e-w direction in map_scale
+                               units.  *default* is None, scales to station
+                               area
+    fig_aspect                 aspect of figure. *default* is 1
+    fig_dpi                    resolution in dots-per-inch. *default* is 300
+    fig_list                   list of matplotlib.figure instances for each
+                               figure plotted.
+    fig_size                   [width, height] in inches of figure window
+                               *default* is [6, 6]
+    font_size                  font size of ticklabels, axes labels are
+                               font_size+2. *default* is 7
+    grid_east                  relative location of grid nodes in e-w direction
+                               in map_scale units
+    grid_north                 relative location of grid nodes in n-s direction
+                               in map_scale units
+    grid_z                     relative location of grid nodes in z direction
+                               in map_scale units
+    model_fn                 full path to initial file
+    map_scale                  [ 'km' | 'm' ] distance units of map.
+                               *default* is km
+    mesh_east                  np.meshgrid(grid_east, grid_north, indexing='ij')
+    mesh_north                 np.meshgrid(grid_east, grid_north, indexing='ij')
+    model_fn                   full path to model file
+    nodes_east                 relative distance betwen nodes in e-w direction
+                               in map_scale units
+    nodes_north                relative distance betwen nodes in n-s direction
+                               in map_scale units
+    nodes_z                    relative distance betwen nodes in z direction
+                               in map_scale units
+    ns_limits                  (min, max) limits of plot in n-s direction
+                               *default* is None, viewing area is station area
+    pad_east                   padding from extreme stations in east direction
+    pad_north                  padding from extreme stations in north direction
+    period_list                list of periods from data
+    plot_grid                  [ 'y' | 'n' ] 'y' to plot grid lines
+                               *default* is 'n'
+    plot_period_list           list of period index values to plot
+                               *default* is None
+    plot_yn                    ['y' | 'n' ] 'y' to plot on instantiation
+                               *default* is 'y'
+    res_cmap                   colormap for resisitivity values.
+                               *default* is 'jet_r'
+    res_limits                 (min, max) resistivity limits in log scale
+                               *default* is (0, 4)
+    res_model                  np.ndarray(n_north, n_east, n_vertical) of
+                               model resistivity values in linear scale
+    residual_cmap              color map for pt residuals.
+                               *default* is 'mt_wh2or'
+    resp                       np.ndarray(n_stations, n_periods, 2, 2)
+                               impedance tensors for model response
+    resp_fn                    full path to response file
+    save_path                  directory to save figures to
+    save_plots                 [ 'y' | 'n' ] 'y' to save plots to save_path
+    station_east               location of stations in east direction in
+                               map_scale units
+    station_fn                 full path to station locations file
+    station_names              station names
+    station_north              location of station in north direction in
+                               map_scale units
+    subplot_bottom             distance between axes and bottom of figure window
+    subplot_left               distance between axes and left of figure window
+    subplot_right              distance between axes and right of figure window
+    subplot_top                distance between axes and top of figure window
+    title                      titiel of plot *default* is depth of slice
+    xminorticks                location of xminorticks
+    yminorticks                location of yminorticks
+    ========================== ================================================
+    """ 
+    def __init__(self, data_fn=None, resp_fn=None, model_fn=None, **kws):
+        super ().__init__( data_fn=data_fn, resp_fn=resp_fn, model_fn=model_fn,
+                          **kws)
+        self._logging=csamtpylog.get_csamtpy_logger(self.__class__.__name__)
+        
+        for key in list(kws.keys()): 
+            setattr(self, key, kws[key])
+            
+class PlotSlices(plot_slices.PlotSlices):
+    """
+    * Plot all cartesian axis-aligned slices and be able to scroll through the model
+    * Extract arbitrary profiles (e.g. along a seismic line) from a model
+
+    .. author: `MTpy`_ of Alison Kirkby avd Jared R. Peacock (
+            https://github.com/MTgeophysics/pycsamt.git)
     
-#     z_lines, z_stations, z_freq,  z_appRHO, z_phase,z_appRho_err,\
-#             z_phase_err=plot_dataAndFits(data_fn = pathData, 
-#                                           stations=['S00', 'S04', 's08', 'S12']
-#                                           # , 'S04', 's06', 's10']
-#                                           )
+    :Example: ::
 
+        >>> import pycsamt.modeling.modem as modem
+        >>> mfn = r"/home/modem/Inv1/Modular_NLCG_100.rho"
+        >>> dfn = r"/home/modem/Inv1/ModEM_data.dat"
+        >>> pds = ws.PlotSlices(model_fn=mfn, data_fn=dfn)
+
+    ======================= ===================================================
+    Buttons                  Description
+    ======================= ===================================================
+    'e'                     moves n-s slice east by one model block
+    'w'                     moves n-s slice west by one model block
+    'n'                     moves e-w slice north by one model block
+    'm'                     moves e-w slice south by one model block
+    'd'                     moves depth slice down by one model block
+    'u'                     moves depth slice up by one model block
+    ======================= ===================================================
+
+
+    ======================= ===================================================
+    Attributes              Description
+    ======================= ===================================================
+    ax_en                   matplotlib.axes instance for depth slice  map view
+    ax_ez                   matplotlib.axes instance for e-w slice
+    ax_map                  matplotlib.axes instance for location map
+    ax_nz                   matplotlib.axes instance for n-s slice
+    climits                 (min , max) color limits on resistivity in log
+                            scale. *default* is (0, 4)
+    cmap                    name of color map for resisitiviy.
+                            *default* is 'jet_r'
+    data_fn                 full path to data file name
+    draw_colorbar           show colorbar on exported plot; default True
+    dscale                  scaling parameter depending on map_scale
+    east_line_xlist         list of line nodes of east grid for faster plotting
+    east_line_ylist         list of line nodes of east grid for faster plotting
+    ew_limits               (min, max) limits of e-w in map_scale units
+                            *default* is None and scales to station area
+    fig                     matplotlib.figure instance for figure
+    fig_aspect              aspect ratio of plots. *default* is 1
+    fig_dpi                 resolution of figure in dots-per-inch
+                            *default* is 300
+    fig_num                 figure instance number
+    fig_size                [width, height] of figure window.
+                            *default* is [6,6]
+    font_dict               dictionary of font keywords, internally created
+    font_size               size of ticklables in points, axes labes are
+                            font_size+2. *default* is 4
+    grid_east               relative location of grid nodes in e-w direction
+                            in map_scale units
+    grid_north              relative location of grid nodes in n-s direction
+                            in map_scale units
+    grid_z                  relative location of grid nodes in z direction
+                            in map_scale units
+    index_east              index value of grid_east being plotted
+    index_north             index value of grid_north being plotted
+    index_vertical          index value of grid_z being plotted
+    initial_fn              full path to initial file
+    key_press               matplotlib.canvas.connect instance
+    map_scale               [ 'm' | 'km' ] scale of map. *default* is km
+    mesh_east               np.meshgrid(grid_east, grid_north)[0]
+    mesh_en_east            np.meshgrid(grid_east, grid_north)[0]
+    mesh_en_north           np.meshgrid(grid_east, grid_north)[1]
+    mesh_ez_east            np.meshgrid(grid_east, grid_z)[0]
+    mesh_ez_vertical        np.meshgrid(grid_east, grid_z)[1]
+    mesh_north              np.meshgrid(grid_east, grid_north)[1]
+    mesh_nz_north           np.meshgrid(grid_north, grid_z)[0]
+    mesh_nz_vertical        np.meshgrid(grid_north, grid_z)[1]
+    model_fn                full path to model file
+    ms                      size of station markers in points. *default* is 2
+    nodes_east              relative distance betwen nodes in e-w direction
+                            in map_scale units
+    nodes_north             relative distance betwen nodes in n-s direction
+                            in map_scale units
+    nodes_z                 relative distance betwen nodes in z direction
+                            in map_scale units
+    north_line_xlist        list of line nodes north grid for faster plotting
+    north_line_ylist        list of line nodes north grid for faster plotting
+    ns_limits               (min, max) limits of plots in n-s direction
+                            *default* is None, set veiwing area to station area
+    plot_yn                 [ 'y' | 'n' ] 'y' to plot on instantiation
+                            *default* is 'y'
+    plot_stations           default False
+    plot_grid               show grid on exported plot; default False
+    res_model               np.ndarray(n_north, n_east, n_vertical) of
+                            model resistivity values in linear scale
+    save_format             exported format; default png
+    save_path               path to save exported plots to; default current working folder
+    station_color           color of station marker. *default* is black
+    station_dict_east       location of stations for each east grid row
+    station_dict_north      location of stations for each north grid row
+    station_east            location of stations in east direction
+    station_fn              full path to station file
+    station_font_color      color of station label
+    station_font_pad        padding between station marker and label
+    station_font_rotation   angle of station label
+    station_font_size       font size of station label
+    station_font_weight     weight of font for station label
+    station_id              [min, max] index values for station labels
+    station_marker          station marker
+    station_names           name of stations
+    station_north           location of stations in north direction
+    subplot_bottom          distance between axes and bottom of figure window
+    subplot_hspace          distance between subplots in vertical direction
+    subplot_left            distance between axes and left of figure window
+    subplot_right           distance between axes and right of figure window
+    subplot_top             distance between axes and top of figure window
+    subplot_wspace          distance between subplots in horizontal direction
+    title                   title of plot
+    xminorticks             location of xminorticks
+    yminorticks             location of yminorticks
+    z_limits                (min, max) limits in vertical direction,
+    ======================= ===================================================
+
+    """
 
+    def __init__(self, model_fn, data_fn=None, **kws):     
+        super ().__init__( model_fn=model_fn, data_fn=data_fn, **kws)
+        self._logging=csamtpylog.get_csamtpy_logger(self.__class__.__name__)
+        
+        for key in list(kws.keys()): 
+            setattr(self, key, kws[key])
+                 
+
+    
     
     
     
     
     
     
     
@@ -4823,8 +6177,7 @@
     
     
     
     
     
     
     
-
```

### Comparing `pycsamt-1.1.2/pycsamt.egg-info/SOURCES.txt` & `pycsamt-1.2.1/pycsamt.egg-info/SOURCES.txt`

 * *Files 8% similar despite different names*

```diff
@@ -1,29 +1,34 @@
-COPYING.LESSER
 LICENSE.md
 MANIFEST.in
 README.md
 pyproject.toml
 setup.py
 docs/Makefile
 docs/index.html
 docs/make.bat
-docs/pyCSAMT User Guide.pdf
+docs/user_guide.pdf
 docs/source/conf.py
-docs/source/csamt.rst
+docs/source/core.rst
+docs/source/demo.rst
 docs/source/geocore.rst
 docs/source/geodb.rst
 docs/source/index.rst
+docs/source/installation.rst
+docs/source/macros.hrst
 docs/source/modeling.rst
 docs/source/processing.rst
 docs/source/utils.rst
-docs/source/viewer.rst
+docs/source/view.rst
 pycsamt/__init__.py
 pycsamt/__main__.py
+pycsamt/_csamtpylog.py
+pycsamt/_path.py
 pycsamt/bases.py
+pycsamt/site.py
 pycsamt.egg-info/PKG-INFO
 pycsamt.egg-info/SOURCES.txt
 pycsamt.egg-info/dependency_links.txt
 pycsamt.egg-info/entry_points.txt
 pycsamt.egg-info/requires.txt
 pycsamt.egg-info/top_level.txt
 pycsamt/cli/__init__.py
@@ -38,24 +43,21 @@
 pycsamt/cli/penetration1d.py
 pycsamt/cli/penetration2d.py
 pycsamt/cli/pseudocrossresistivityandphase.py
 pycsamt/cli/pseudostratigraphic.py
 pycsamt/cli/rewriteedi.py
 pycsamt/cli/rms.py
 pycsamt/cli/staticshift.py
-pycsamt/ff/__init__.py
-pycsamt/ff/site.py
-pycsamt/ff/core/__init__.py
-pycsamt/ff/core/avg.py
-pycsamt/ff/core/cs.py
-pycsamt/ff/core/edi.py
-pycsamt/ff/core/j.py
-pycsamt/ff/core/z.py
-pycsamt/ff/processing/__init__.py
-pycsamt/ff/processing/corr.py
+pycsamt/core/__init__.py
+pycsamt/core/avg.py
+pycsamt/core/cs.py
+pycsamt/core/edi.py
+pycsamt/core/j.py
+pycsamt/core/wfem.py
+pycsamt/core/z.py
 pycsamt/geodrill/__init__.py
 pycsamt/geodrill/_dictapp.py
 pycsamt/geodrill/geocore.py
 pycsamt/geodrill/geodatabase.py
 pycsamt/geodrill/ml.py
 pycsamt/geodrill/requestmanager.py
 pycsamt/geodrill/strata.py
@@ -82,25 +84,29 @@
 pycsamt/gui/wa2j.py
 pycsamt/gui/wi2d.py
 pycsamt/gui/wrap_console_scripts.py
 pycsamt/gui/write_avg2j.py
 pycsamt/metadata/e.g.data.json
 pycsamt/metadata/e.g.data.yml
 pycsamt/modeling/__init__.py
+pycsamt/modeling/modem.py
 pycsamt/modeling/occam2d.py
+pycsamt/processing/__init__.py
+pycsamt/processing/corr.py
+pycsamt/processing/ctools.py
 pycsamt/utils/__init__.py
-pycsamt/utils/_csamtpylog.py
 pycsamt/utils/_p.py
+pycsamt/utils/_set_gdal.py
 pycsamt/utils/avg_utils.py
 pycsamt/utils/decorator.py
 pycsamt/utils/exceptions.py
 pycsamt/utils/func_utils.py
 pycsamt/utils/geo_utils.py
 pycsamt/utils/gis_tools.py
 pycsamt/utils/ml_utils.py
 pycsamt/utils/mtcalculator.py
-pycsamt/utils/p.configlog.yml
 pycsamt/utils/plot_utils.py
 pycsamt/utils/plotdecorator.py
 pycsamt/utils/zcalculator.py
-pycsamt/viewer/__init__.py
-pycsamt/viewer/plot.py
+pycsamt/view/__init__.py
+pycsamt/view/mpl.rcParams_infos.py
+pycsamt/view/plot.py
```

### Comparing `pycsamt-1.1.2/pycsamt.egg-info/entry_points.txt` & `pycsamt-1.2.1/pycsamt.egg-info/entry_points.txt`

 * *Files 1% similar despite different names*

```diff
@@ -17,10 +17,10 @@
 pseudostratigraphic = pycsamt.cli.pseudostratigraphic:main
 rewriteedi = pycsamt.cli.rewriteedi:main
 rms = pycsamt.cli.rms:main
 staticshift = pycsamt.cli.staticshift:main
 write_avg2edi = pycsamt.gui.wa2edi:main
 write_avg2j = pycsamt.gui.wa2j:main
 write_drillhole = pycsamt.gui.cmake_dh:main
-write_occam2golden= pycsamt.gui.gs2f:mainwrite_iter2dat = pycsamt.gui.wi2d:main
+write_iter2dat = pycsamt.gui.wi2d:main
+write_occam2golden = pycsamt.gui.gs2f:main
 write_occam2oasis = pycsamt.gui.oas2f:main
-
```

### Comparing `pycsamt-1.1.2/setup.py` & `pycsamt-1.2.1/setup.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,130 +1,125 @@
 #!/usr/bin/env python
 #https://github.com/pypa/sampleproject/blob/main/setup.py
 # See:
 # https://packaging.python.org/guides/distributing-packages-using-setuptools/
 # https://github.com/pypa/sampleproject
 
-import pycsamt
 import os 
-
 # Check for setuptools package:
-
 try:
     from setuptools import setup
 except ImportError:
     setuptools = False
     from distutils.core import setup
 else:
     setuptools = True
-
 # LONG_DESCRIPTION = """
-# pyCSAMT is a far field basic  open source software of controlled source audio-frequency magnetotellurics 
-# for standard data processing , modeling and geophysical interpretation  enhancement.  
+# pyCSAMT is a far field basic  open source software of controlled 
+# source audio-frequency magnetotellurics 
+# for standard data processing , modeling and geophysical interpretation 
+# enhancement.  
 # """
-with open(os.path.join(os.path.abspath('.'), 
-                       'project_description.md'), 'r') as fm:
+with open(os.path.join(os.path.abspath('.'), 'README.md'), 'r') as fm:
     # LONG_DESCRIPTION ="""{}""".format(
     #     ' '.join([descp for descp in fm.readlines() ]))
     LONG_DESCRIPTION =fm.read()
-
+try: 
+    import pycsamt  # noqa
+    VERSION = pycsamt.__version__
+except: VERSION ='1.2.1'
 # The advantage of setuptools is that EXE wrappers are created on Windows,
 # which allows Tab-completion for the script names from the system Scripts
 # folder.
 # Add names of scripts here. You can also specify the function to call
 # by adding :func_name after the module name, and the name of the script
 # can be customized before the equals sign. Actually some scripts may not work 
 # because scripts is under designing with Tkinter  graphical interface 
 # scripts were pseudocreated for waiting their implementations 
 
 setup_kwargs = {}
 setup_kwargs['entry_points'] = {
                     'console_scripts':[
-                             'occam2d_build_in = pycsamt.gui.oc2d_bdin:main',
-                             'write_avg2edi= pycsamt.gui.wa2edi:main',
-                             'write_avg2j= pycsamt.gui.wa2j:main',
-                             'corrected_edi = pycsamt.gui.corrected_edi:main',
-                             'plot_model_oc2d = pycsamt.gui.p_moc2d:main',
-                             'plot_pseudolog = pycsamt.gui.p2log:main',
-                             'write_occam2oasis= pycsamt.gui.oas2f:main',
-                             'write_occam2golden= pycsamt.gui.gs2f:main'
-                             'write_iter2dat = pycsamt.gui.wi2d:main',
-                             'write_drillhole= pycsamt.gui.cmake_dh:main', 
-                             'correctedi = pycsamt.cli.correctedi:main', 
-                             'avg2edi= pycsamt.cli.avg2edi:main', 
-                             'j2edi=pycsamt.cli.j2edi:main', 
-                             'misfit2d=pycsamt.cli.misfit2d:main', 
-                             'nm=pycsamt.cli.nm:main', 
-                             'penetration1d=pycsamt.cli.penetration1d:main', 
-                             'penetration2d=pycsamt.cli.penetration2d:main', 
-                             'pseudostratigraphic=pycsamt.cli.pseudostratigraphic:main', 
-                             'rewriteedi=pycsamt.cli.rewriteedi:main', 
-                             'rms=pycsamt.cli.rms:main',
-                             'myconfigfile=pycsamt.cli.myconfigfile:main', 
-                             'pseudocrossresistivityandphase=pycsamt.cli.pseudocrossresistivityandphase:main', 
-                             'staticshift=pycsamt.cli.staticshift:main', 
-                             'fitforward=pycsamt.cli.fitforward:main', 
-                             'occambuildinputs=pycsamt.cli.occambuildinputs:main'
-                     ]
-     }
-                     
-                        
-
+    'occam2d_build_in = pycsamt.gui.oc2d_bdin:main',
+    'write_avg2edi= pycsamt.gui.wa2edi:main',
+    'write_avg2j= pycsamt.gui.wa2j:main',
+    'corrected_edi = pycsamt.gui.corrected_edi:main',
+    'plot_model_oc2d = pycsamt.gui.p_moc2d:main',
+    'plot_pseudolog = pycsamt.gui.p2log:main',
+    'write_occam2oasis= pycsamt.gui.oas2f:main',
+    'write_occam2golden= pycsamt.gui.gs2f:main',
+    'write_iter2dat = pycsamt.gui.wi2d:main',
+    'write_drillhole= pycsamt.gui.cmake_dh:main', 
+    'correctedi = pycsamt.cli.correctedi:main', 
+    'avg2edi= pycsamt.cli.avg2edi:main', 
+    'j2edi=pycsamt.cli.j2edi:main', 
+    'misfit2d=pycsamt.cli.misfit2d:main', 
+    'nm=pycsamt.cli.nm:main', 
+    'penetration1d=pycsamt.cli.penetration1d:main', 
+    'penetration2d=pycsamt.cli.penetration2d:main', 
+    'pseudostratigraphic=pycsamt.cli.pseudostratigraphic:main', 
+    'rewriteedi=pycsamt.cli.rewriteedi:main', 
+    'rms=pycsamt.cli.rms:main',
+    'myconfigfile=pycsamt.cli.myconfigfile:main', 
+    'pseudocrossresistivityandphase=pycsamt.cli.pseudocrossresistivityandphase:main', 
+    'staticshift=pycsamt.cli.staticshift:main', 
+    'fitforward=pycsamt.cli.fitforward:main', 
+    'occambuildinputs=pycsamt.cli.occambuildinputs:main'
+    ]
+}                
 # But many people will not have setuptools installed, so we need to handle
 # the default Python installation, which only has Distutils:
-
 if setuptools is False:
     # Different script specification style for ordinary Distutils:
     setup_kwargs['scripts'] = [
         s.split(' = ')[1].replace('.', '/').split(':')[0] + '.py' for s in 
         setup_kwargs['entry_points']['console_scripts']]
     del setup_kwargs['entry_points']
 
     # "You must explicitly list all packages in packages: the Distutils will not
     # recursively scan your source tree looking for any directory with an
     # __init__.py file"
-
 setup_kwargs['packages'] = [ 
-                            'pycsamt',
-                            'pycsamt.ff',
-                            'pycsamt.ff.core',
-                            'pycsamt.gui',
-                            'pycsamt.cli',
-                            'pycsamt.ff.processing',
-                            'pycsamt.geodrill',
-                            'pycsamt.viewer',
-                            'pycsamt.modeling',
-                            'pycsamt.utils',
-                            ]
+    'pycsamt',
+    'pycsamt.core',
+    'pycsamt.gui',
+    'pycsamt.cli',
+    'pycsamt.processing',
+    'pycsamt.geodrill',
+    'pycsamt.view',
+    'pycsamt.modeling',
+    'pycsamt.utils',
+]
 # force install pycsamt. Once pycsamt is installed , pyyaml and pyproj 
 # should already installed too. 
      
-setup_kwargs['install_requires'] = ['numpy>=1.8.1',
-                                     'scipy>=0.14.0',
-                                     'matplotlib',
-                                     'mtpy >=1.1.0',
-                                     'pyyaml',
-                                     'pyproj',
-                                     'configparser', 
-                                     'tqdm']
+setup_kwargs['install_requires'] = [
+    'numpy>=1.8.1',
+    'scipy>=0.14.0',
+    'matplotlib',
+    'mtpy >=1.1.0',
+    'pyyaml',
+    'pyproj',
+    'configparser', 
+    'tqdm'
+]
                                      
 setup_kwargs['python_requires'] ='>=3.7'
-
 authors =["Kouadio K. Laurent, ", 'Rong Liu, ', 
           'Binbin Mi, ','Chum-ning Liu, ', 'Albert O. Malory.']
 authors_emails =['etanoyau@gmail.com,', 'liurongkaoyang@126.com,',
                 'mibinbin@zju.edu.cn,', 'lifuming001@163.com,','amalory@zju.edu.cn']
 setup(
  	name="pycsamt",
- 	version=pycsamt.__version__,
+ 	version=VERSION,
  	author=' '.join([aa for aa in authors]),
     author_email='kkouao@zju.edu.cn',
     maintainer="Kouadio K. Laurent",
     maintainer_email='etanoyau@gmail.com',
- 	description="A Python open-source toolkit for Controlled Source Audio-frequency Magnetotelluric ",
+ 	description="A Python open-source toolkit Audio-frequency Magnetotelluric ",
  	long_description=LONG_DESCRIPTION,
     long_description_content_type="text/markdown",
     url="https://github.com/WEgeophysics/pyCSAMT",
     project_urls={
         "API Documentation"  : "https://pycsamt.readthedocs.io/en/master/",
         "Home page" : "https://github.com/WEgeophysics/pyCSAMT/wiki",
         "Bugs tracker": "https://github.com/WEgeophysics/pyCSAMT/issues",
@@ -132,43 +127,46 @@
         "User guide" : "https://github.com/WEgeophysics/pyCSAMT/blob/develop/docs/pyCSAMT%20User%20Guide.pdf",
         },
  	#data_files=[('', ['pycsamt/utils/epsg.npy',]),], #this will install datafiles in wearied palce such as ~/.local/
  	include_package_data=True,
  	license="GNU LESSER GENERAL PUBLIC LICENSE v3",
  	classifiers=[
         "Development Status :: 3 - Alpha",
-        "Intended Audience :: Developers",
+        "Intended Audience :: Science/Research",
         # "Topic :: Software Development :: Build Tools",
         #"License :: OSI Approved :: GNU License",
-        "Programming Language :: Python :: 3.8",
+        "Topic :: Software Development",
+        'Topic :: Scientific/Engineering',
+        'Programming Language :: Python :: 3.7',
+        'Programming Language :: Python :: 3.8',
+        'Programming Language :: Python :: 3.9',
         "Operating System :: OS Independent",
         ],
     keywords="hydrogeophysic, groundwater, exploration, csamt",
     #package_dir={"": "pyCSAMT"},  # Optional
     package_data={'pycsamt': [
-                            'utils/p.configlog.yml', 
-                            'utils/espg.npy',
-                            'geodrill/_geocodes/*.csv', 
-                            'geodrill/_geocodes/__memory.pkl', 
-                            'geodrill/_geomemo/*.sq3', 
-                            'metadata/e.g.data.json', 
-                            'metadata/e.g.data.yml', 
-                            '_loggerfiles/*.txt',
-                            
-                            ], 
-                    "":[
-                        'data/occam2d/*', 
-                        'data/drill_example_files/*', 
-                        'data/avg/K1.avg', 
-                        'data/avg/K1.stn', 
-                        'data/avg/K2.avg', 
-                        'data/avg/K2.stn',
-                        ]
-                  },
-    
+        'utils/p.configlog.yml', 
+        'utils/espg.npy',
+        'geodrill/_geocodes/*.csv', 
+        'geodrill/_geocodes/__memory.pkl', 
+        'geodrill/_geomemo/*.sq3', 
+        'metadata/e.g.data.json', 
+        'metadata/e.g.data.yml', 
+        '_loggerfiles/*.txt',
+         ], 
+                "":[
+        'data/occam2d/*', 
+        'data/drill_example_files/*', 
+        'data/avg/K1.avg', 
+        'data/avg/K1.stn', 
+        'data/avg/K2.avg', 
+        'data/avg/K2.stn',
+        'project_description.md',
+        ]
+     },
  	**setup_kwargs
 )
```

